var qL=Object.defineProperty;var HL=(n,e,t)=>e in n?qL(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Or=(n,e,t)=>(HL(n,typeof e!="symbol"?e+"":e,t),t),sA=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var D=(n,e,t)=>(sA(n,e,"read from private field"),t?t.call(n):e.get(n)),Pe=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Ie=(n,e,t,i)=>(sA(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var da=(n,e,t,i)=>({set _(c){Ie(n,e,c,t)},get _(){return D(n,e,i)}}),We=(n,e,t)=>(sA(n,e,"access private method"),t);function WL(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const c in i)if(c!=="default"&&!(c in n)){const a=Object.getOwnPropertyDescriptor(i,c);a&&Object.defineProperty(n,c,a.get?a:{enumerable:!0,get:()=>i[c]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const a of c)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(c){const a={};return c.integrity&&(a.integrity=c.integrity),c.referrerPolicy&&(a.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?a.credentials="include":c.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(c){if(c.ep)return;c.ep=!0;const a=t(c);fetch(c.href,a)}})();var mM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function P5(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function GL(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var c=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,c.get?c:{enumerable:!0,get:function(){return n[i]}})}),t}var gM={exports:{}},NE={},yM={exports:{}},gi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V_=Symbol.for("react.element"),KL=Symbol.for("react.portal"),XL=Symbol.for("react.fragment"),ZL=Symbol.for("react.strict_mode"),YL=Symbol.for("react.profiler"),JL=Symbol.for("react.provider"),QL=Symbol.for("react.context"),ej=Symbol.for("react.forward_ref"),tj=Symbol.for("react.suspense"),nj=Symbol.for("react.memo"),rj=Symbol.for("react.lazy"),VP=Symbol.iterator;function ij(n){return n===null||typeof n!="object"?null:(n=VP&&n[VP]||n["@@iterator"],typeof n=="function"?n:null)}var bM={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vM=Object.assign,_M={};function E0(n,e,t){this.props=n,this.context=e,this.refs=_M,this.updater=t||bM}E0.prototype.isReactComponent={};E0.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};E0.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function wM(){}wM.prototype=E0.prototype;function T5(n,e,t){this.props=n,this.context=e,this.refs=_M,this.updater=t||bM}var O5=T5.prototype=new wM;O5.constructor=T5;vM(O5,E0.prototype);O5.isPureReactComponent=!0;var qP=Array.isArray,xM=Object.prototype.hasOwnProperty,M5={current:null},SM={key:!0,ref:!0,__self:!0,__source:!0};function EM(n,e,t){var i,c={},a=null,l=null;if(e!=null)for(i in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(a=""+e.key),e)xM.call(e,i)&&!SM.hasOwnProperty(i)&&(c[i]=e[i]);var r=arguments.length-2;if(r===1)c.children=t;else if(1<r){for(var h=Array(r),m=0;m<r;m++)h[m]=arguments[m+2];c.children=h}if(n&&n.defaultProps)for(i in r=n.defaultProps,r)c[i]===void 0&&(c[i]=r[i]);return{$$typeof:V_,type:n,key:a,ref:l,props:c,_owner:M5.current}}function oj(n,e){return{$$typeof:V_,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function C5(n){return typeof n=="object"&&n!==null&&n.$$typeof===V_}function sj(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var HP=/\/+/g;function aA(n,e){return typeof n=="object"&&n!==null&&n.key!=null?sj(""+n.key):e.toString(36)}function hx(n,e,t,i,c){var a=typeof n;(a==="undefined"||a==="boolean")&&(n=null);var l=!1;if(n===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(n.$$typeof){case V_:case KL:l=!0}}if(l)return l=n,c=c(l),n=i===""?"."+aA(l,0):i,qP(c)?(t="",n!=null&&(t=n.replace(HP,"$&/")+"/"),hx(c,e,t,"",function(m){return m})):c!=null&&(C5(c)&&(c=oj(c,t+(!c.key||l&&l.key===c.key?"":(""+c.key).replace(HP,"$&/")+"/")+n)),e.push(c)),1;if(l=0,i=i===""?".":i+":",qP(n))for(var r=0;r<n.length;r++){a=n[r];var h=i+aA(a,r);l+=hx(a,e,t,h,c)}else if(h=ij(n),typeof h=="function")for(n=h.call(n),r=0;!(a=n.next()).done;)a=a.value,h=i+aA(a,r++),l+=hx(a,e,t,h,c);else if(a==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function Lw(n,e,t){if(n==null)return n;var i=[],c=0;return hx(n,i,"","",function(a){return e.call(t,a,c++)}),i}function aj(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var xa={current:null},fx={transition:null},lj={ReactCurrentDispatcher:xa,ReactCurrentBatchConfig:fx,ReactCurrentOwner:M5};gi.Children={map:Lw,forEach:function(n,e,t){Lw(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Lw(n,function(){e++}),e},toArray:function(n){return Lw(n,function(e){return e})||[]},only:function(n){if(!C5(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};gi.Component=E0;gi.Fragment=XL;gi.Profiler=YL;gi.PureComponent=T5;gi.StrictMode=ZL;gi.Suspense=tj;gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lj;gi.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=vM({},n.props),c=n.key,a=n.ref,l=n._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,l=M5.current),e.key!==void 0&&(c=""+e.key),n.type&&n.type.defaultProps)var r=n.type.defaultProps;for(h in e)xM.call(e,h)&&!SM.hasOwnProperty(h)&&(i[h]=e[h]===void 0&&r!==void 0?r[h]:e[h])}var h=arguments.length-2;if(h===1)i.children=t;else if(1<h){r=Array(h);for(var m=0;m<h;m++)r[m]=arguments[m+2];i.children=r}return{$$typeof:V_,type:n.type,key:c,ref:a,props:i,_owner:l}};gi.createContext=function(n){return n={$$typeof:QL,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:JL,_context:n},n.Consumer=n};gi.createElement=EM;gi.createFactory=function(n){var e=EM.bind(null,n);return e.type=n,e};gi.createRef=function(){return{current:null}};gi.forwardRef=function(n){return{$$typeof:ej,render:n}};gi.isValidElement=C5;gi.lazy=function(n){return{$$typeof:rj,_payload:{_status:-1,_result:n},_init:aj}};gi.memo=function(n,e){return{$$typeof:nj,type:n,compare:e===void 0?null:e}};gi.startTransition=function(n){var e=fx.transition;fx.transition={};try{n()}finally{fx.transition=e}};gi.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};gi.useCallback=function(n,e){return xa.current.useCallback(n,e)};gi.useContext=function(n){return xa.current.useContext(n)};gi.useDebugValue=function(){};gi.useDeferredValue=function(n){return xa.current.useDeferredValue(n)};gi.useEffect=function(n,e){return xa.current.useEffect(n,e)};gi.useId=function(){return xa.current.useId()};gi.useImperativeHandle=function(n,e,t){return xa.current.useImperativeHandle(n,e,t)};gi.useInsertionEffect=function(n,e){return xa.current.useInsertionEffect(n,e)};gi.useLayoutEffect=function(n,e){return xa.current.useLayoutEffect(n,e)};gi.useMemo=function(n,e){return xa.current.useMemo(n,e)};gi.useReducer=function(n,e,t){return xa.current.useReducer(n,e,t)};gi.useRef=function(n){return xa.current.useRef(n)};gi.useState=function(n){return xa.current.useState(n)};gi.useSyncExternalStore=function(n,e,t){return xa.current.useSyncExternalStore(n,e,t)};gi.useTransition=function(){return xa.current.useTransition()};gi.version="18.2.0";yM.exports=gi;var Wt=yM.exports;const lu=P5(Wt),cj=WL({__proto__:null,default:lu},[Wt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uj=Wt,hj=Symbol.for("react.element"),fj=Symbol.for("react.fragment"),dj=Object.prototype.hasOwnProperty,pj=uj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mj={key:!0,ref:!0,__self:!0,__source:!0};function AM(n,e,t){var i,c={},a=null,l=null;t!==void 0&&(a=""+t),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(l=e.ref);for(i in e)dj.call(e,i)&&!mj.hasOwnProperty(i)&&(c[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)c[i]===void 0&&(c[i]=e[i]);return{$$typeof:hj,type:n,key:a,ref:l,props:c,_owner:pj.current}}NE.Fragment=fj;NE.jsx=AM;NE.jsxs=AM;gM.exports=NE;var Qe=gM.exports,YA={},kM={exports:{}},xl={},PM={exports:{}},TM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(pe,U){var B=pe.length;pe.push(U);e:for(;0<B;){var N=B-1>>>1,z=pe[N];if(0<c(z,U))pe[N]=U,pe[B]=z,B=N;else break e}}function t(pe){return pe.length===0?null:pe[0]}function i(pe){if(pe.length===0)return null;var U=pe[0],B=pe.pop();if(B!==U){pe[0]=B;e:for(var N=0,z=pe.length,H=z>>>1;N<H;){var Y=2*(N+1)-1,fe=pe[Y],Re=Y+1,Oe=pe[Re];if(0>c(fe,B))Re<z&&0>c(Oe,fe)?(pe[N]=Oe,pe[Re]=B,N=Re):(pe[N]=fe,pe[Y]=B,N=Y);else if(Re<z&&0>c(Oe,B))pe[N]=Oe,pe[Re]=B,N=Re;else break e}}return U}function c(pe,U){var B=pe.sortIndex-U.sortIndex;return B!==0?B:pe.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,r=l.now();n.unstable_now=function(){return l.now()-r}}var h=[],m=[],v=1,g=null,_=3,E=!1,b=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(pe){for(var U=t(m);U!==null;){if(U.callback===null)i(m);else if(U.startTime<=pe)i(m),U.sortIndex=U.expirationTime,e(h,U);else break;U=t(m)}}function A(pe){if(p=!1,w(pe),!b)if(t(h)!==null)b=!0,de(P);else{var U=t(m);U!==null&&be(A,U.startTime-pe)}}function P(pe,U){b=!1,p&&(p=!1,y(M),M=-1),E=!0;var B=_;try{for(w(U),g=t(h);g!==null&&(!(g.expirationTime>U)||pe&&!G());){var N=g.callback;if(typeof N=="function"){g.callback=null,_=g.priorityLevel;var z=N(g.expirationTime<=U);U=n.unstable_now(),typeof z=="function"?g.callback=z:g===t(h)&&i(h),w(U)}else i(h);g=t(h)}if(g!==null)var H=!0;else{var Y=t(m);Y!==null&&be(A,Y.startTime-U),H=!1}return H}finally{g=null,_=B,E=!1}}var T=!1,R=null,M=-1,L=5,W=-1;function G(){return!(n.unstable_now()-W<L)}function re(){if(R!==null){var pe=n.unstable_now();W=pe;var U=!0;try{U=R(!0,pe)}finally{U?Q():(T=!1,R=null)}}else T=!1}var Q;if(typeof f=="function")Q=function(){f(re)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ae=oe.port2;oe.port1.onmessage=re,Q=function(){ae.postMessage(null)}}else Q=function(){x(re,0)};function de(pe){R=pe,T||(T=!0,Q())}function be(pe,U){M=x(function(){pe(n.unstable_now())},U)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(pe){pe.callback=null},n.unstable_continueExecution=function(){b||E||(b=!0,de(P))},n.unstable_forceFrameRate=function(pe){0>pe||125<pe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<pe?Math.floor(1e3/pe):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(pe){switch(_){case 1:case 2:case 3:var U=3;break;default:U=_}var B=_;_=U;try{return pe()}finally{_=B}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(pe,U){switch(pe){case 1:case 2:case 3:case 4:case 5:break;default:pe=3}var B=_;_=pe;try{return U()}finally{_=B}},n.unstable_scheduleCallback=function(pe,U,B){var N=n.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?N+B:N):B=N,pe){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=B+z,pe={id:v++,callback:U,priorityLevel:pe,startTime:B,expirationTime:z,sortIndex:-1},B>N?(pe.sortIndex=B,e(m,pe),t(h)===null&&pe===t(m)&&(p?(y(M),M=-1):p=!0,be(A,B-N))):(pe.sortIndex=z,e(h,pe),b||E||(b=!0,de(P))),pe},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(pe){var U=_;return function(){var B=_;_=U;try{return pe.apply(this,arguments)}finally{_=B}}}})(TM);PM.exports=TM;var gj=PM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OM=Wt,wl=gj;function _n(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var MM=new Set,lv={};function xm(n,e){g0(n,e),g0(n+"Capture",e)}function g0(n,e){for(lv[n]=e,n=0;n<e.length;n++)MM.add(e[n])}var _h=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),JA=Object.prototype.hasOwnProperty,yj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,WP={},GP={};function bj(n){return JA.call(GP,n)?!0:JA.call(WP,n)?!1:yj.test(n)?GP[n]=!0:(WP[n]=!0,!1)}function vj(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function _j(n,e,t,i){if(e===null||typeof e>"u"||vj(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Sa(n,e,t,i,c,a,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=c,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=a,this.removeEmptyString=l}var Fs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Fs[n]=new Sa(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Fs[e]=new Sa(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Fs[n]=new Sa(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Fs[n]=new Sa(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Fs[n]=new Sa(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Fs[n]=new Sa(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Fs[n]=new Sa(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Fs[n]=new Sa(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Fs[n]=new Sa(n,5,!1,n.toLowerCase(),null,!1,!1)});var I5=/[\-:]([a-z])/g;function R5(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(I5,R5);Fs[e]=new Sa(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(I5,R5);Fs[e]=new Sa(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(I5,R5);Fs[e]=new Sa(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Fs[n]=new Sa(n,1,!1,n.toLowerCase(),null,!1,!1)});Fs.xlinkHref=new Sa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Fs[n]=new Sa(n,1,!1,n.toLowerCase(),null,!0,!0)});function D5(n,e,t,i){var c=Fs.hasOwnProperty(e)?Fs[e]:null;(c!==null?c.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_j(e,t,c,i)&&(t=null),i||c===null?bj(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):c.mustUseProperty?n[c.propertyName]=t===null?c.type===3?!1:"":t:(e=c.attributeName,i=c.attributeNamespace,t===null?n.removeAttribute(e):(c=c.type,t=c===3||c===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Ph=OM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jw=Symbol.for("react.element"),pg=Symbol.for("react.portal"),mg=Symbol.for("react.fragment"),L5=Symbol.for("react.strict_mode"),QA=Symbol.for("react.profiler"),CM=Symbol.for("react.provider"),IM=Symbol.for("react.context"),j5=Symbol.for("react.forward_ref"),e6=Symbol.for("react.suspense"),t6=Symbol.for("react.suspense_list"),N5=Symbol.for("react.memo"),ef=Symbol.for("react.lazy"),RM=Symbol.for("react.offscreen"),KP=Symbol.iterator;function mb(n){return n===null||typeof n!="object"?null:(n=KP&&n[KP]||n["@@iterator"],typeof n=="function"?n:null)}var go=Object.assign,lA;function Ob(n){if(lA===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);lA=e&&e[1]||""}return`
`+lA+n}var cA=!1;function uA(n,e){if(!n||cA)return"";cA=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var i=m}Reflect.construct(n,[],e)}else{try{e.call()}catch(m){i=m}n.call(e.prototype)}else{try{throw Error()}catch(m){i=m}n()}}catch(m){if(m&&i&&typeof m.stack=="string"){for(var c=m.stack.split(`
`),a=i.stack.split(`
`),l=c.length-1,r=a.length-1;1<=l&&0<=r&&c[l]!==a[r];)r--;for(;1<=l&&0<=r;l--,r--)if(c[l]!==a[r]){if(l!==1||r!==1)do if(l--,r--,0>r||c[l]!==a[r]){var h=`
`+c[l].replace(" at new "," at ");return n.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",n.displayName)),h}while(1<=l&&0<=r);break}}}finally{cA=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Ob(n):""}function wj(n){switch(n.tag){case 5:return Ob(n.type);case 16:return Ob("Lazy");case 13:return Ob("Suspense");case 19:return Ob("SuspenseList");case 0:case 2:case 15:return n=uA(n.type,!1),n;case 11:return n=uA(n.type.render,!1),n;case 1:return n=uA(n.type,!0),n;default:return""}}function n6(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case mg:return"Fragment";case pg:return"Portal";case QA:return"Profiler";case L5:return"StrictMode";case e6:return"Suspense";case t6:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case IM:return(n.displayName||"Context")+".Consumer";case CM:return(n._context.displayName||"Context")+".Provider";case j5:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case N5:return e=n.displayName||null,e!==null?e:n6(n.type)||"Memo";case ef:e=n._payload,n=n._init;try{return n6(n(e))}catch{}}return null}function xj(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return n6(e);case 8:return e===L5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function cd(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function DM(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Sj(n){var e=DM(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var c=t.get,a=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return c.call(this)},set:function(l){i=""+l,a.call(this,l)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(l){i=""+l},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Nw(n){n._valueTracker||(n._valueTracker=Sj(n))}function LM(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=DM(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function a2(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function r6(n,e){var t=e.checked;return go({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function XP(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=cd(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jM(n,e){e=e.checked,e!=null&&D5(n,"checked",e,!1)}function i6(n,e){jM(n,e);var t=cd(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?o6(n,e.type,t):e.hasOwnProperty("defaultValue")&&o6(n,e.type,cd(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function ZP(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function o6(n,e,t){(e!=="number"||a2(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Mb=Array.isArray;function Tg(n,e,t,i){if(n=n.options,e){e={};for(var c=0;c<t.length;c++)e["$"+t[c]]=!0;for(t=0;t<n.length;t++)c=e.hasOwnProperty("$"+n[t].value),n[t].selected!==c&&(n[t].selected=c),c&&i&&(n[t].defaultSelected=!0)}else{for(t=""+cd(t),e=null,c=0;c<n.length;c++){if(n[c].value===t){n[c].selected=!0,i&&(n[c].defaultSelected=!0);return}e!==null||n[c].disabled||(e=n[c])}e!==null&&(e.selected=!0)}}function s6(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_n(91));return go({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function YP(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(_n(92));if(Mb(t)){if(1<t.length)throw Error(_n(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:cd(t)}}function NM(n,e){var t=cd(e.value),i=cd(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function JP(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function $M(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function a6(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?$M(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var $w,BM=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,c){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,c)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for($w=$w||document.createElement("div"),$w.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$w.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function cv(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Yb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ej=["Webkit","ms","Moz","O"];Object.keys(Yb).forEach(function(n){Ej.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Yb[e]=Yb[n]})});function FM(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Yb.hasOwnProperty(n)&&Yb[n]?(""+e).trim():e+"px"}function zM(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,c=FM(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,c):n[t]=c}}var Aj=go({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function l6(n,e){if(e){if(Aj[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_n(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_n(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_n(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_n(62))}}function c6(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var u6=null;function $5(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var h6=null,Og=null,Mg=null;function QP(n){if(n=W_(n)){if(typeof h6!="function")throw Error(_n(280));var e=n.stateNode;e&&(e=UE(e),h6(n.stateNode,n.type,e))}}function UM(n){Og?Mg?Mg.push(n):Mg=[n]:Og=n}function VM(){if(Og){var n=Og,e=Mg;if(Mg=Og=null,QP(n),e)for(n=0;n<e.length;n++)QP(e[n])}}function qM(n,e){return n(e)}function HM(){}var hA=!1;function WM(n,e,t){if(hA)return n(e,t);hA=!0;try{return qM(n,e,t)}finally{hA=!1,(Og!==null||Mg!==null)&&(HM(),VM())}}function uv(n,e){var t=n.stateNode;if(t===null)return null;var i=UE(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(_n(231,e,typeof t));return t}var f6=!1;if(_h)try{var gb={};Object.defineProperty(gb,"passive",{get:function(){f6=!0}}),window.addEventListener("test",gb,gb),window.removeEventListener("test",gb,gb)}catch{f6=!1}function kj(n,e,t,i,c,a,l,r,h){var m=Array.prototype.slice.call(arguments,3);try{e.apply(t,m)}catch(v){this.onError(v)}}var Jb=!1,l2=null,c2=!1,d6=null,Pj={onError:function(n){Jb=!0,l2=n}};function Tj(n,e,t,i,c,a,l,r,h){Jb=!1,l2=null,kj.apply(Pj,arguments)}function Oj(n,e,t,i,c,a,l,r,h){if(Tj.apply(this,arguments),Jb){if(Jb){var m=l2;Jb=!1,l2=null}else throw Error(_n(198));c2||(c2=!0,d6=m)}}function Sm(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function GM(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function eT(n){if(Sm(n)!==n)throw Error(_n(188))}function Mj(n){var e=n.alternate;if(!e){if(e=Sm(n),e===null)throw Error(_n(188));return e!==n?null:n}for(var t=n,i=e;;){var c=t.return;if(c===null)break;var a=c.alternate;if(a===null){if(i=c.return,i!==null){t=i;continue}break}if(c.child===a.child){for(a=c.child;a;){if(a===t)return eT(c),n;if(a===i)return eT(c),e;a=a.sibling}throw Error(_n(188))}if(t.return!==i.return)t=c,i=a;else{for(var l=!1,r=c.child;r;){if(r===t){l=!0,t=c,i=a;break}if(r===i){l=!0,i=c,t=a;break}r=r.sibling}if(!l){for(r=a.child;r;){if(r===t){l=!0,t=a,i=c;break}if(r===i){l=!0,i=a,t=c;break}r=r.sibling}if(!l)throw Error(_n(189))}}if(t.alternate!==i)throw Error(_n(190))}if(t.tag!==3)throw Error(_n(188));return t.stateNode.current===t?n:e}function KM(n){return n=Mj(n),n!==null?XM(n):null}function XM(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=XM(n);if(e!==null)return e;n=n.sibling}return null}var ZM=wl.unstable_scheduleCallback,tT=wl.unstable_cancelCallback,Cj=wl.unstable_shouldYield,Ij=wl.unstable_requestPaint,Oo=wl.unstable_now,Rj=wl.unstable_getCurrentPriorityLevel,B5=wl.unstable_ImmediatePriority,YM=wl.unstable_UserBlockingPriority,u2=wl.unstable_NormalPriority,Dj=wl.unstable_LowPriority,JM=wl.unstable_IdlePriority,$E=null,cu=null;function Lj(n){if(cu&&typeof cu.onCommitFiberRoot=="function")try{cu.onCommitFiberRoot($E,n,void 0,(n.current.flags&128)===128)}catch{}}var xc=Math.clz32?Math.clz32:$j,jj=Math.log,Nj=Math.LN2;function $j(n){return n>>>=0,n===0?32:31-(jj(n)/Nj|0)|0}var Bw=64,Fw=4194304;function Cb(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function h2(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,c=n.suspendedLanes,a=n.pingedLanes,l=t&268435455;if(l!==0){var r=l&~c;r!==0?i=Cb(r):(a&=l,a!==0&&(i=Cb(a)))}else l=t&~c,l!==0?i=Cb(l):a!==0&&(i=Cb(a));if(i===0)return 0;if(e!==0&&e!==i&&!(e&c)&&(c=i&-i,a=e&-e,c>=a||c===16&&(a&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-xc(e),c=1<<t,i|=n[t],e&=~c;return i}function Bj(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fj(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,c=n.expirationTimes,a=n.pendingLanes;0<a;){var l=31-xc(a),r=1<<l,h=c[l];h===-1?(!(r&t)||r&i)&&(c[l]=Bj(r,e)):h<=e&&(n.expiredLanes|=r),a&=~r}}function p6(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function QM(){var n=Bw;return Bw<<=1,!(Bw&4194240)&&(Bw=64),n}function fA(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function q_(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-xc(e),n[e]=t}function zj(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var c=31-xc(t),a=1<<c;e[c]=0,i[c]=-1,n[c]=-1,t&=~a}}function F5(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-xc(t),c=1<<i;c&e|n[i]&e&&(n[i]|=e),t&=~c}}var Ri=0;function eC(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var tC,z5,nC,rC,iC,m6=!1,zw=[],Jf=null,Qf=null,ed=null,hv=new Map,fv=new Map,nf=[],Uj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nT(n,e){switch(n){case"focusin":case"focusout":Jf=null;break;case"dragenter":case"dragleave":Qf=null;break;case"mouseover":case"mouseout":ed=null;break;case"pointerover":case"pointerout":hv.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fv.delete(e.pointerId)}}function yb(n,e,t,i,c,a){return n===null||n.nativeEvent!==a?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:a,targetContainers:[c]},e!==null&&(e=W_(e),e!==null&&z5(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,c!==null&&e.indexOf(c)===-1&&e.push(c),n)}function Vj(n,e,t,i,c){switch(e){case"focusin":return Jf=yb(Jf,n,e,t,i,c),!0;case"dragenter":return Qf=yb(Qf,n,e,t,i,c),!0;case"mouseover":return ed=yb(ed,n,e,t,i,c),!0;case"pointerover":var a=c.pointerId;return hv.set(a,yb(hv.get(a)||null,n,e,t,i,c)),!0;case"gotpointercapture":return a=c.pointerId,fv.set(a,yb(fv.get(a)||null,n,e,t,i,c)),!0}return!1}function oC(n){var e=zd(n.target);if(e!==null){var t=Sm(e);if(t!==null){if(e=t.tag,e===13){if(e=GM(t),e!==null){n.blockedOn=e,iC(n.priority,function(){nC(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function dx(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=g6(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);u6=i,t.target.dispatchEvent(i),u6=null}else return e=W_(t),e!==null&&z5(e),n.blockedOn=t,!1;e.shift()}return!0}function rT(n,e,t){dx(n)&&t.delete(e)}function qj(){m6=!1,Jf!==null&&dx(Jf)&&(Jf=null),Qf!==null&&dx(Qf)&&(Qf=null),ed!==null&&dx(ed)&&(ed=null),hv.forEach(rT),fv.forEach(rT)}function bb(n,e){n.blockedOn===e&&(n.blockedOn=null,m6||(m6=!0,wl.unstable_scheduleCallback(wl.unstable_NormalPriority,qj)))}function dv(n){function e(c){return bb(c,n)}if(0<zw.length){bb(zw[0],n);for(var t=1;t<zw.length;t++){var i=zw[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Jf!==null&&bb(Jf,n),Qf!==null&&bb(Qf,n),ed!==null&&bb(ed,n),hv.forEach(e),fv.forEach(e),t=0;t<nf.length;t++)i=nf[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<nf.length&&(t=nf[0],t.blockedOn===null);)oC(t),t.blockedOn===null&&nf.shift()}var Cg=Ph.ReactCurrentBatchConfig,f2=!0;function Hj(n,e,t,i){var c=Ri,a=Cg.transition;Cg.transition=null;try{Ri=1,U5(n,e,t,i)}finally{Ri=c,Cg.transition=a}}function Wj(n,e,t,i){var c=Ri,a=Cg.transition;Cg.transition=null;try{Ri=4,U5(n,e,t,i)}finally{Ri=c,Cg.transition=a}}function U5(n,e,t,i){if(f2){var c=g6(n,e,t,i);if(c===null)xA(n,e,i,d2,t),nT(n,i);else if(Vj(c,n,e,t,i))i.stopPropagation();else if(nT(n,i),e&4&&-1<Uj.indexOf(n)){for(;c!==null;){var a=W_(c);if(a!==null&&tC(a),a=g6(n,e,t,i),a===null&&xA(n,e,i,d2,t),a===c)break;c=a}c!==null&&i.stopPropagation()}else xA(n,e,i,null,t)}}var d2=null;function g6(n,e,t,i){if(d2=null,n=$5(i),n=zd(n),n!==null)if(e=Sm(n),e===null)n=null;else if(t=e.tag,t===13){if(n=GM(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return d2=n,null}function sC(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rj()){case B5:return 1;case YM:return 4;case u2:case Dj:return 16;case JM:return 536870912;default:return 16}default:return 16}}var Xf=null,V5=null,px=null;function aC(){if(px)return px;var n,e=V5,t=e.length,i,c="value"in Xf?Xf.value:Xf.textContent,a=c.length;for(n=0;n<t&&e[n]===c[n];n++);var l=t-n;for(i=1;i<=l&&e[t-i]===c[a-i];i++);return px=c.slice(n,1<i?1-i:void 0)}function mx(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Uw(){return!0}function iT(){return!1}function Sl(n){function e(t,i,c,a,l){this._reactName=t,this._targetInst=c,this.type=i,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var r in n)n.hasOwnProperty(r)&&(t=n[r],this[r]=t?t(a):a[r]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Uw:iT,this.isPropagationStopped=iT,this}return go(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Uw)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Uw)},persist:function(){},isPersistent:Uw}),e}var A0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},q5=Sl(A0),H_=go({},A0,{view:0,detail:0}),Gj=Sl(H_),dA,pA,vb,BE=go({},H_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:H5,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==vb&&(vb&&n.type==="mousemove"?(dA=n.screenX-vb.screenX,pA=n.screenY-vb.screenY):pA=dA=0,vb=n),dA)},movementY:function(n){return"movementY"in n?n.movementY:pA}}),oT=Sl(BE),Kj=go({},BE,{dataTransfer:0}),Xj=Sl(Kj),Zj=go({},H_,{relatedTarget:0}),mA=Sl(Zj),Yj=go({},A0,{animationName:0,elapsedTime:0,pseudoElement:0}),Jj=Sl(Yj),Qj=go({},A0,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),eN=Sl(Qj),tN=go({},A0,{data:0}),sT=Sl(tN),nN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},iN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oN(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=iN[n])?!!e[n]:!1}function H5(){return oN}var sN=go({},H_,{key:function(n){if(n.key){var e=nN[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=mx(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?rN[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:H5,charCode:function(n){return n.type==="keypress"?mx(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?mx(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),aN=Sl(sN),lN=go({},BE,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),aT=Sl(lN),cN=go({},H_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:H5}),uN=Sl(cN),hN=go({},A0,{propertyName:0,elapsedTime:0,pseudoElement:0}),fN=Sl(hN),dN=go({},BE,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),pN=Sl(dN),mN=[9,13,27,32],W5=_h&&"CompositionEvent"in window,Qb=null;_h&&"documentMode"in document&&(Qb=document.documentMode);var gN=_h&&"TextEvent"in window&&!Qb,lC=_h&&(!W5||Qb&&8<Qb&&11>=Qb),lT=" ",cT=!1;function cC(n,e){switch(n){case"keyup":return mN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uC(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var gg=!1;function yN(n,e){switch(n){case"compositionend":return uC(e);case"keypress":return e.which!==32?null:(cT=!0,lT);case"textInput":return n=e.data,n===lT&&cT?null:n;default:return null}}function bN(n,e){if(gg)return n==="compositionend"||!W5&&cC(n,e)?(n=aC(),px=V5=Xf=null,gg=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lC&&e.locale!=="ko"?null:e.data;default:return null}}var vN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uT(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!vN[n.type]:e==="textarea"}function hC(n,e,t,i){UM(i),e=p2(e,"onChange"),0<e.length&&(t=new q5("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var ev=null,pv=null;function _N(n){xC(n,0)}function FE(n){var e=vg(n);if(LM(e))return n}function wN(n,e){if(n==="change")return e}var fC=!1;if(_h){var gA;if(_h){var yA="oninput"in document;if(!yA){var hT=document.createElement("div");hT.setAttribute("oninput","return;"),yA=typeof hT.oninput=="function"}gA=yA}else gA=!1;fC=gA&&(!document.documentMode||9<document.documentMode)}function fT(){ev&&(ev.detachEvent("onpropertychange",dC),pv=ev=null)}function dC(n){if(n.propertyName==="value"&&FE(pv)){var e=[];hC(e,pv,n,$5(n)),WM(_N,e)}}function xN(n,e,t){n==="focusin"?(fT(),ev=e,pv=t,ev.attachEvent("onpropertychange",dC)):n==="focusout"&&fT()}function SN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return FE(pv)}function EN(n,e){if(n==="click")return FE(e)}function AN(n,e){if(n==="input"||n==="change")return FE(e)}function kN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ec=typeof Object.is=="function"?Object.is:kN;function mv(n,e){if(Ec(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var c=t[i];if(!JA.call(e,c)||!Ec(n[c],e[c]))return!1}return!0}function dT(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function pT(n,e){var t=dT(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=dT(t)}}function pC(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?pC(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function mC(){for(var n=window,e=a2();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=a2(n.document)}return e}function G5(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function PN(n){var e=mC(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&pC(t.ownerDocument.documentElement,t)){if(i!==null&&G5(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var c=t.textContent.length,a=Math.min(i.start,c);i=i.end===void 0?a:Math.min(i.end,c),!n.extend&&a>i&&(c=i,i=a,a=c),c=pT(t,a);var l=pT(t,i);c&&l&&(n.rangeCount!==1||n.anchorNode!==c.node||n.anchorOffset!==c.offset||n.focusNode!==l.node||n.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(c.node,c.offset),n.removeAllRanges(),a>i?(n.addRange(e),n.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var TN=_h&&"documentMode"in document&&11>=document.documentMode,yg=null,y6=null,tv=null,b6=!1;function mT(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;b6||yg==null||yg!==a2(i)||(i=yg,"selectionStart"in i&&G5(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),tv&&mv(tv,i)||(tv=i,i=p2(y6,"onSelect"),0<i.length&&(e=new q5("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=yg)))}function Vw(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var bg={animationend:Vw("Animation","AnimationEnd"),animationiteration:Vw("Animation","AnimationIteration"),animationstart:Vw("Animation","AnimationStart"),transitionend:Vw("Transition","TransitionEnd")},bA={},gC={};_h&&(gC=document.createElement("div").style,"AnimationEvent"in window||(delete bg.animationend.animation,delete bg.animationiteration.animation,delete bg.animationstart.animation),"TransitionEvent"in window||delete bg.transitionend.transition);function zE(n){if(bA[n])return bA[n];if(!bg[n])return n;var e=bg[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in gC)return bA[n]=e[t];return n}var yC=zE("animationend"),bC=zE("animationiteration"),vC=zE("animationstart"),_C=zE("transitionend"),wC=new Map,gT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dd(n,e){wC.set(n,e),xm(e,[n])}for(var vA=0;vA<gT.length;vA++){var _A=gT[vA],ON=_A.toLowerCase(),MN=_A[0].toUpperCase()+_A.slice(1);dd(ON,"on"+MN)}dd(yC,"onAnimationEnd");dd(bC,"onAnimationIteration");dd(vC,"onAnimationStart");dd("dblclick","onDoubleClick");dd("focusin","onFocus");dd("focusout","onBlur");dd(_C,"onTransitionEnd");g0("onMouseEnter",["mouseout","mouseover"]);g0("onMouseLeave",["mouseout","mouseover"]);g0("onPointerEnter",["pointerout","pointerover"]);g0("onPointerLeave",["pointerout","pointerover"]);xm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xm("onBeforeInput",["compositionend","keypress","textInput","paste"]);xm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ib="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ib));function yT(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,Oj(i,e,void 0,n),n.currentTarget=null}function xC(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],c=i.event;i=i.listeners;e:{var a=void 0;if(e)for(var l=i.length-1;0<=l;l--){var r=i[l],h=r.instance,m=r.currentTarget;if(r=r.listener,h!==a&&c.isPropagationStopped())break e;yT(c,r,m),a=h}else for(l=0;l<i.length;l++){if(r=i[l],h=r.instance,m=r.currentTarget,r=r.listener,h!==a&&c.isPropagationStopped())break e;yT(c,r,m),a=h}}}if(c2)throw n=d6,c2=!1,d6=null,n}function Zi(n,e){var t=e[S6];t===void 0&&(t=e[S6]=new Set);var i=n+"__bubble";t.has(i)||(SC(e,n,2,!1),t.add(i))}function wA(n,e,t){var i=0;e&&(i|=4),SC(t,n,i,e)}var qw="_reactListening"+Math.random().toString(36).slice(2);function gv(n){if(!n[qw]){n[qw]=!0,MM.forEach(function(t){t!=="selectionchange"&&(CN.has(t)||wA(t,!1,n),wA(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[qw]||(e[qw]=!0,wA("selectionchange",!1,e))}}function SC(n,e,t,i){switch(sC(e)){case 1:var c=Hj;break;case 4:c=Wj;break;default:c=U5}t=c.bind(null,e,t,n),c=void 0,!f6||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(c=!0),i?c!==void 0?n.addEventListener(e,t,{capture:!0,passive:c}):n.addEventListener(e,t,!0):c!==void 0?n.addEventListener(e,t,{passive:c}):n.addEventListener(e,t,!1)}function xA(n,e,t,i,c){var a=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var l=i.tag;if(l===3||l===4){var r=i.stateNode.containerInfo;if(r===c||r.nodeType===8&&r.parentNode===c)break;if(l===4)for(l=i.return;l!==null;){var h=l.tag;if((h===3||h===4)&&(h=l.stateNode.containerInfo,h===c||h.nodeType===8&&h.parentNode===c))return;l=l.return}for(;r!==null;){if(l=zd(r),l===null)return;if(h=l.tag,h===5||h===6){i=a=l;continue e}r=r.parentNode}}i=i.return}WM(function(){var m=a,v=$5(t),g=[];e:{var _=wC.get(n);if(_!==void 0){var E=q5,b=n;switch(n){case"keypress":if(mx(t)===0)break e;case"keydown":case"keyup":E=aN;break;case"focusin":b="focus",E=mA;break;case"focusout":b="blur",E=mA;break;case"beforeblur":case"afterblur":E=mA;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=oT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=Xj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=uN;break;case yC:case bC:case vC:E=Jj;break;case _C:E=fN;break;case"scroll":E=Gj;break;case"wheel":E=pN;break;case"copy":case"cut":case"paste":E=eN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=aT}var p=(e&4)!==0,x=!p&&n==="scroll",y=p?_!==null?_+"Capture":null:_;p=[];for(var f=m,w;f!==null;){w=f;var A=w.stateNode;if(w.tag===5&&A!==null&&(w=A,y!==null&&(A=uv(f,y),A!=null&&p.push(yv(f,A,w)))),x)break;f=f.return}0<p.length&&(_=new E(_,b,null,t,v),g.push({event:_,listeners:p}))}}if(!(e&7)){e:{if(_=n==="mouseover"||n==="pointerover",E=n==="mouseout"||n==="pointerout",_&&t!==u6&&(b=t.relatedTarget||t.fromElement)&&(zd(b)||b[wh]))break e;if((E||_)&&(_=v.window===v?v:(_=v.ownerDocument)?_.defaultView||_.parentWindow:window,E?(b=t.relatedTarget||t.toElement,E=m,b=b?zd(b):null,b!==null&&(x=Sm(b),b!==x||b.tag!==5&&b.tag!==6)&&(b=null)):(E=null,b=m),E!==b)){if(p=oT,A="onMouseLeave",y="onMouseEnter",f="mouse",(n==="pointerout"||n==="pointerover")&&(p=aT,A="onPointerLeave",y="onPointerEnter",f="pointer"),x=E==null?_:vg(E),w=b==null?_:vg(b),_=new p(A,f+"leave",E,t,v),_.target=x,_.relatedTarget=w,A=null,zd(v)===m&&(p=new p(y,f+"enter",b,t,v),p.target=w,p.relatedTarget=x,A=p),x=A,E&&b)t:{for(p=E,y=b,f=0,w=p;w;w=rg(w))f++;for(w=0,A=y;A;A=rg(A))w++;for(;0<f-w;)p=rg(p),f--;for(;0<w-f;)y=rg(y),w--;for(;f--;){if(p===y||y!==null&&p===y.alternate)break t;p=rg(p),y=rg(y)}p=null}else p=null;E!==null&&bT(g,_,E,p,!1),b!==null&&x!==null&&bT(g,x,b,p,!0)}}e:{if(_=m?vg(m):window,E=_.nodeName&&_.nodeName.toLowerCase(),E==="select"||E==="input"&&_.type==="file")var P=wN;else if(uT(_))if(fC)P=AN;else{P=SN;var T=xN}else(E=_.nodeName)&&E.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(P=EN);if(P&&(P=P(n,m))){hC(g,P,t,v);break e}T&&T(n,_,m),n==="focusout"&&(T=_._wrapperState)&&T.controlled&&_.type==="number"&&o6(_,"number",_.value)}switch(T=m?vg(m):window,n){case"focusin":(uT(T)||T.contentEditable==="true")&&(yg=T,y6=m,tv=null);break;case"focusout":tv=y6=yg=null;break;case"mousedown":b6=!0;break;case"contextmenu":case"mouseup":case"dragend":b6=!1,mT(g,t,v);break;case"selectionchange":if(TN)break;case"keydown":case"keyup":mT(g,t,v)}var R;if(W5)e:{switch(n){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else gg?cC(n,t)&&(M="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(M="onCompositionStart");M&&(lC&&t.locale!=="ko"&&(gg||M!=="onCompositionStart"?M==="onCompositionEnd"&&gg&&(R=aC()):(Xf=v,V5="value"in Xf?Xf.value:Xf.textContent,gg=!0)),T=p2(m,M),0<T.length&&(M=new sT(M,n,null,t,v),g.push({event:M,listeners:T}),R?M.data=R:(R=uC(t),R!==null&&(M.data=R)))),(R=gN?yN(n,t):bN(n,t))&&(m=p2(m,"onBeforeInput"),0<m.length&&(v=new sT("onBeforeInput","beforeinput",null,t,v),g.push({event:v,listeners:m}),v.data=R))}xC(g,e)})}function yv(n,e,t){return{instance:n,listener:e,currentTarget:t}}function p2(n,e){for(var t=e+"Capture",i=[];n!==null;){var c=n,a=c.stateNode;c.tag===5&&a!==null&&(c=a,a=uv(n,t),a!=null&&i.unshift(yv(n,a,c)),a=uv(n,e),a!=null&&i.push(yv(n,a,c))),n=n.return}return i}function rg(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function bT(n,e,t,i,c){for(var a=e._reactName,l=[];t!==null&&t!==i;){var r=t,h=r.alternate,m=r.stateNode;if(h!==null&&h===i)break;r.tag===5&&m!==null&&(r=m,c?(h=uv(t,a),h!=null&&l.unshift(yv(t,h,r))):c||(h=uv(t,a),h!=null&&l.push(yv(t,h,r)))),t=t.return}l.length!==0&&n.push({event:e,listeners:l})}var IN=/\r\n?/g,RN=/\u0000|\uFFFD/g;function vT(n){return(typeof n=="string"?n:""+n).replace(IN,`
`).replace(RN,"")}function Hw(n,e,t){if(e=vT(e),vT(n)!==e&&t)throw Error(_n(425))}function m2(){}var v6=null,_6=null;function w6(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var x6=typeof setTimeout=="function"?setTimeout:void 0,DN=typeof clearTimeout=="function"?clearTimeout:void 0,_T=typeof Promise=="function"?Promise:void 0,LN=typeof queueMicrotask=="function"?queueMicrotask:typeof _T<"u"?function(n){return _T.resolve(null).then(n).catch(jN)}:x6;function jN(n){setTimeout(function(){throw n})}function SA(n,e){var t=e,i=0;do{var c=t.nextSibling;if(n.removeChild(t),c&&c.nodeType===8)if(t=c.data,t==="/$"){if(i===0){n.removeChild(c),dv(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=c}while(t);dv(e)}function td(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function wT(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var k0=Math.random().toString(36).slice(2),su="__reactFiber$"+k0,bv="__reactProps$"+k0,wh="__reactContainer$"+k0,S6="__reactEvents$"+k0,NN="__reactListeners$"+k0,$N="__reactHandles$"+k0;function zd(n){var e=n[su];if(e)return e;for(var t=n.parentNode;t;){if(e=t[wh]||t[su]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=wT(n);n!==null;){if(t=n[su])return t;n=wT(n)}return e}n=t,t=n.parentNode}return null}function W_(n){return n=n[su]||n[wh],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function vg(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(_n(33))}function UE(n){return n[bv]||null}var E6=[],_g=-1;function pd(n){return{current:n}}function Qi(n){0>_g||(n.current=E6[_g],E6[_g]=null,_g--)}function qi(n,e){_g++,E6[_g]=n.current,n.current=e}var ud={},oa=pd(ud),$a=pd(!1),dm=ud;function y0(n,e){var t=n.type.contextTypes;if(!t)return ud;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var c={},a;for(a in t)c[a]=e[a];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=c),c}function Ba(n){return n=n.childContextTypes,n!=null}function g2(){Qi($a),Qi(oa)}function xT(n,e,t){if(oa.current!==ud)throw Error(_n(168));qi(oa,e),qi($a,t)}function EC(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var c in i)if(!(c in e))throw Error(_n(108,xj(n)||"Unknown",c));return go({},t,i)}function y2(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ud,dm=oa.current,qi(oa,n),qi($a,$a.current),!0}function ST(n,e,t){var i=n.stateNode;if(!i)throw Error(_n(169));t?(n=EC(n,e,dm),i.__reactInternalMemoizedMergedChildContext=n,Qi($a),Qi(oa),qi(oa,n)):Qi($a),qi($a,t)}var Bu=null,VE=!1,EA=!1;function AC(n){Bu===null?Bu=[n]:Bu.push(n)}function BN(n){VE=!0,AC(n)}function md(){if(!EA&&Bu!==null){EA=!0;var n=0,e=Ri;try{var t=Bu;for(Ri=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Bu=null,VE=!1}catch(c){throw Bu!==null&&(Bu=Bu.slice(n+1)),ZM(B5,md),c}finally{Ri=e,EA=!1}}return null}var wg=[],xg=0,b2=null,v2=0,Fl=[],zl=0,pm=null,yh=1,bh="";function Rd(n,e){wg[xg++]=v2,wg[xg++]=b2,b2=n,v2=e}function kC(n,e,t){Fl[zl++]=yh,Fl[zl++]=bh,Fl[zl++]=pm,pm=n;var i=yh;n=bh;var c=32-xc(i)-1;i&=~(1<<c),t+=1;var a=32-xc(e)+c;if(30<a){var l=c-c%5;a=(i&(1<<l)-1).toString(32),i>>=l,c-=l,yh=1<<32-xc(e)+c|t<<c|i,bh=a+n}else yh=1<<a|t<<c|i,bh=n}function K5(n){n.return!==null&&(Rd(n,1),kC(n,1,0))}function X5(n){for(;n===b2;)b2=wg[--xg],wg[xg]=null,v2=wg[--xg],wg[xg]=null;for(;n===pm;)pm=Fl[--zl],Fl[zl]=null,bh=Fl[--zl],Fl[zl]=null,yh=Fl[--zl],Fl[zl]=null}var _l=null,yl=null,oo=!1,wc=null;function PC(n,e){var t=Vl(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function ET(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,_l=n,yl=td(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,_l=n,yl=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=pm!==null?{id:yh,overflow:bh}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Vl(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,_l=n,yl=null,!0):!1;default:return!1}}function A6(n){return(n.mode&1)!==0&&(n.flags&128)===0}function k6(n){if(oo){var e=yl;if(e){var t=e;if(!ET(n,e)){if(A6(n))throw Error(_n(418));e=td(t.nextSibling);var i=_l;e&&ET(n,e)?PC(i,t):(n.flags=n.flags&-4097|2,oo=!1,_l=n)}}else{if(A6(n))throw Error(_n(418));n.flags=n.flags&-4097|2,oo=!1,_l=n}}}function AT(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;_l=n}function Ww(n){if(n!==_l)return!1;if(!oo)return AT(n),oo=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!w6(n.type,n.memoizedProps)),e&&(e=yl)){if(A6(n))throw TC(),Error(_n(418));for(;e;)PC(n,e),e=td(e.nextSibling)}if(AT(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(_n(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){yl=td(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}yl=null}}else yl=_l?td(n.stateNode.nextSibling):null;return!0}function TC(){for(var n=yl;n;)n=td(n.nextSibling)}function b0(){yl=_l=null,oo=!1}function Z5(n){wc===null?wc=[n]:wc.push(n)}var FN=Ph.ReactCurrentBatchConfig;function rc(n,e){if(n&&n.defaultProps){e=go({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var _2=pd(null),w2=null,Sg=null,Y5=null;function J5(){Y5=Sg=w2=null}function Q5(n){var e=_2.current;Qi(_2),n._currentValue=e}function P6(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Ig(n,e){w2=n,Y5=Sg=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Na=!0),n.firstContext=null)}function Wl(n){var e=n._currentValue;if(Y5!==n)if(n={context:n,memoizedValue:e,next:null},Sg===null){if(w2===null)throw Error(_n(308));Sg=n,w2.dependencies={lanes:0,firstContext:n}}else Sg=Sg.next=n;return e}var Ud=null;function e8(n){Ud===null?Ud=[n]:Ud.push(n)}function OC(n,e,t,i){var c=e.interleaved;return c===null?(t.next=t,e8(e)):(t.next=c.next,c.next=t),e.interleaved=t,xh(n,i)}function xh(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var tf=!1;function t8(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function MC(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function vh(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function nd(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Ai&2){var c=i.pending;return c===null?e.next=e:(e.next=c.next,c.next=e),i.pending=e,xh(n,t)}return c=i.interleaved,c===null?(e.next=e,e8(i)):(e.next=c.next,c.next=e),i.interleaved=e,xh(n,t)}function gx(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,F5(n,t)}}function kT(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var c=null,a=null;if(t=t.firstBaseUpdate,t!==null){do{var l={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};a===null?c=a=l:a=a.next=l,t=t.next}while(t!==null);a===null?c=a=e:a=a.next=e}else c=a=e;t={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:a,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function x2(n,e,t,i){var c=n.updateQueue;tf=!1;var a=c.firstBaseUpdate,l=c.lastBaseUpdate,r=c.shared.pending;if(r!==null){c.shared.pending=null;var h=r,m=h.next;h.next=null,l===null?a=m:l.next=m,l=h;var v=n.alternate;v!==null&&(v=v.updateQueue,r=v.lastBaseUpdate,r!==l&&(r===null?v.firstBaseUpdate=m:r.next=m,v.lastBaseUpdate=h))}if(a!==null){var g=c.baseState;l=0,v=m=h=null,r=a;do{var _=r.lane,E=r.eventTime;if((i&_)===_){v!==null&&(v=v.next={eventTime:E,lane:0,tag:r.tag,payload:r.payload,callback:r.callback,next:null});e:{var b=n,p=r;switch(_=e,E=t,p.tag){case 1:if(b=p.payload,typeof b=="function"){g=b.call(E,g,_);break e}g=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=p.payload,_=typeof b=="function"?b.call(E,g,_):b,_==null)break e;g=go({},g,_);break e;case 2:tf=!0}}r.callback!==null&&r.lane!==0&&(n.flags|=64,_=c.effects,_===null?c.effects=[r]:_.push(r))}else E={eventTime:E,lane:_,tag:r.tag,payload:r.payload,callback:r.callback,next:null},v===null?(m=v=E,h=g):v=v.next=E,l|=_;if(r=r.next,r===null){if(r=c.shared.pending,r===null)break;_=r,r=_.next,_.next=null,c.lastBaseUpdate=_,c.shared.pending=null}}while(!0);if(v===null&&(h=g),c.baseState=h,c.firstBaseUpdate=m,c.lastBaseUpdate=v,e=c.shared.interleaved,e!==null){c=e;do l|=c.lane,c=c.next;while(c!==e)}else a===null&&(c.shared.lanes=0);gm|=l,n.lanes=l,n.memoizedState=g}}function PT(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],c=i.callback;if(c!==null){if(i.callback=null,i=t,typeof c!="function")throw Error(_n(191,c));c.call(i)}}}var CC=new OM.Component().refs;function T6(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:go({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var qE={isMounted:function(n){return(n=n._reactInternals)?Sm(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=wa(),c=id(n),a=vh(i,c);a.payload=e,t!=null&&(a.callback=t),e=nd(n,a,c),e!==null&&(Sc(e,n,c,i),gx(e,n,c))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=wa(),c=id(n),a=vh(i,c);a.tag=1,a.payload=e,t!=null&&(a.callback=t),e=nd(n,a,c),e!==null&&(Sc(e,n,c,i),gx(e,n,c))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=wa(),i=id(n),c=vh(t,i);c.tag=2,e!=null&&(c.callback=e),e=nd(n,c,i),e!==null&&(Sc(e,n,i,t),gx(e,n,i))}};function TT(n,e,t,i,c,a,l){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,a,l):e.prototype&&e.prototype.isPureReactComponent?!mv(t,i)||!mv(c,a):!0}function IC(n,e,t){var i=!1,c=ud,a=e.contextType;return typeof a=="object"&&a!==null?a=Wl(a):(c=Ba(e)?dm:oa.current,i=e.contextTypes,a=(i=i!=null)?y0(n,c):ud),e=new e(t,a),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qE,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=c,n.__reactInternalMemoizedMaskedChildContext=a),e}function OT(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&qE.enqueueReplaceState(e,e.state,null)}function O6(n,e,t,i){var c=n.stateNode;c.props=t,c.state=n.memoizedState,c.refs=CC,t8(n);var a=e.contextType;typeof a=="object"&&a!==null?c.context=Wl(a):(a=Ba(e)?dm:oa.current,c.context=y0(n,a)),c.state=n.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(T6(n,e,a,t),c.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(e=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),e!==c.state&&qE.enqueueReplaceState(c,c.state,null),x2(n,t,c,i),c.state=n.memoizedState),typeof c.componentDidMount=="function"&&(n.flags|=4194308)}function _b(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(_n(309));var i=t.stateNode}if(!i)throw Error(_n(147,n));var c=i,a=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(l){var r=c.refs;r===CC&&(r=c.refs={}),l===null?delete r[a]:r[a]=l},e._stringRef=a,e)}if(typeof n!="string")throw Error(_n(284));if(!t._owner)throw Error(_n(290,n))}return n}function Gw(n,e){throw n=Object.prototype.toString.call(e),Error(_n(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function MT(n){var e=n._init;return e(n._payload)}function RC(n){function e(y,f){if(n){var w=y.deletions;w===null?(y.deletions=[f],y.flags|=16):w.push(f)}}function t(y,f){if(!n)return null;for(;f!==null;)e(y,f),f=f.sibling;return null}function i(y,f){for(y=new Map;f!==null;)f.key!==null?y.set(f.key,f):y.set(f.index,f),f=f.sibling;return y}function c(y,f){return y=od(y,f),y.index=0,y.sibling=null,y}function a(y,f,w){return y.index=w,n?(w=y.alternate,w!==null?(w=w.index,w<f?(y.flags|=2,f):w):(y.flags|=2,f)):(y.flags|=1048576,f)}function l(y){return n&&y.alternate===null&&(y.flags|=2),y}function r(y,f,w,A){return f===null||f.tag!==6?(f=CA(w,y.mode,A),f.return=y,f):(f=c(f,w),f.return=y,f)}function h(y,f,w,A){var P=w.type;return P===mg?v(y,f,w.props.children,A,w.key):f!==null&&(f.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===ef&&MT(P)===f.type)?(A=c(f,w.props),A.ref=_b(y,f,w),A.return=y,A):(A=xx(w.type,w.key,w.props,null,y.mode,A),A.ref=_b(y,f,w),A.return=y,A)}function m(y,f,w,A){return f===null||f.tag!==4||f.stateNode.containerInfo!==w.containerInfo||f.stateNode.implementation!==w.implementation?(f=IA(w,y.mode,A),f.return=y,f):(f=c(f,w.children||[]),f.return=y,f)}function v(y,f,w,A,P){return f===null||f.tag!==7?(f=hm(w,y.mode,A,P),f.return=y,f):(f=c(f,w),f.return=y,f)}function g(y,f,w){if(typeof f=="string"&&f!==""||typeof f=="number")return f=CA(""+f,y.mode,w),f.return=y,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case jw:return w=xx(f.type,f.key,f.props,null,y.mode,w),w.ref=_b(y,null,f),w.return=y,w;case pg:return f=IA(f,y.mode,w),f.return=y,f;case ef:var A=f._init;return g(y,A(f._payload),w)}if(Mb(f)||mb(f))return f=hm(f,y.mode,w,null),f.return=y,f;Gw(y,f)}return null}function _(y,f,w,A){var P=f!==null?f.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return P!==null?null:r(y,f,""+w,A);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case jw:return w.key===P?h(y,f,w,A):null;case pg:return w.key===P?m(y,f,w,A):null;case ef:return P=w._init,_(y,f,P(w._payload),A)}if(Mb(w)||mb(w))return P!==null?null:v(y,f,w,A,null);Gw(y,w)}return null}function E(y,f,w,A,P){if(typeof A=="string"&&A!==""||typeof A=="number")return y=y.get(w)||null,r(f,y,""+A,P);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case jw:return y=y.get(A.key===null?w:A.key)||null,h(f,y,A,P);case pg:return y=y.get(A.key===null?w:A.key)||null,m(f,y,A,P);case ef:var T=A._init;return E(y,f,w,T(A._payload),P)}if(Mb(A)||mb(A))return y=y.get(w)||null,v(f,y,A,P,null);Gw(f,A)}return null}function b(y,f,w,A){for(var P=null,T=null,R=f,M=f=0,L=null;R!==null&&M<w.length;M++){R.index>M?(L=R,R=null):L=R.sibling;var W=_(y,R,w[M],A);if(W===null){R===null&&(R=L);break}n&&R&&W.alternate===null&&e(y,R),f=a(W,f,M),T===null?P=W:T.sibling=W,T=W,R=L}if(M===w.length)return t(y,R),oo&&Rd(y,M),P;if(R===null){for(;M<w.length;M++)R=g(y,w[M],A),R!==null&&(f=a(R,f,M),T===null?P=R:T.sibling=R,T=R);return oo&&Rd(y,M),P}for(R=i(y,R);M<w.length;M++)L=E(R,y,M,w[M],A),L!==null&&(n&&L.alternate!==null&&R.delete(L.key===null?M:L.key),f=a(L,f,M),T===null?P=L:T.sibling=L,T=L);return n&&R.forEach(function(G){return e(y,G)}),oo&&Rd(y,M),P}function p(y,f,w,A){var P=mb(w);if(typeof P!="function")throw Error(_n(150));if(w=P.call(w),w==null)throw Error(_n(151));for(var T=P=null,R=f,M=f=0,L=null,W=w.next();R!==null&&!W.done;M++,W=w.next()){R.index>M?(L=R,R=null):L=R.sibling;var G=_(y,R,W.value,A);if(G===null){R===null&&(R=L);break}n&&R&&G.alternate===null&&e(y,R),f=a(G,f,M),T===null?P=G:T.sibling=G,T=G,R=L}if(W.done)return t(y,R),oo&&Rd(y,M),P;if(R===null){for(;!W.done;M++,W=w.next())W=g(y,W.value,A),W!==null&&(f=a(W,f,M),T===null?P=W:T.sibling=W,T=W);return oo&&Rd(y,M),P}for(R=i(y,R);!W.done;M++,W=w.next())W=E(R,y,M,W.value,A),W!==null&&(n&&W.alternate!==null&&R.delete(W.key===null?M:W.key),f=a(W,f,M),T===null?P=W:T.sibling=W,T=W);return n&&R.forEach(function(re){return e(y,re)}),oo&&Rd(y,M),P}function x(y,f,w,A){if(typeof w=="object"&&w!==null&&w.type===mg&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case jw:e:{for(var P=w.key,T=f;T!==null;){if(T.key===P){if(P=w.type,P===mg){if(T.tag===7){t(y,T.sibling),f=c(T,w.props.children),f.return=y,y=f;break e}}else if(T.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===ef&&MT(P)===T.type){t(y,T.sibling),f=c(T,w.props),f.ref=_b(y,T,w),f.return=y,y=f;break e}t(y,T);break}else e(y,T);T=T.sibling}w.type===mg?(f=hm(w.props.children,y.mode,A,w.key),f.return=y,y=f):(A=xx(w.type,w.key,w.props,null,y.mode,A),A.ref=_b(y,f,w),A.return=y,y=A)}return l(y);case pg:e:{for(T=w.key;f!==null;){if(f.key===T)if(f.tag===4&&f.stateNode.containerInfo===w.containerInfo&&f.stateNode.implementation===w.implementation){t(y,f.sibling),f=c(f,w.children||[]),f.return=y,y=f;break e}else{t(y,f);break}else e(y,f);f=f.sibling}f=IA(w,y.mode,A),f.return=y,y=f}return l(y);case ef:return T=w._init,x(y,f,T(w._payload),A)}if(Mb(w))return b(y,f,w,A);if(mb(w))return p(y,f,w,A);Gw(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,f!==null&&f.tag===6?(t(y,f.sibling),f=c(f,w),f.return=y,y=f):(t(y,f),f=CA(w,y.mode,A),f.return=y,y=f),l(y)):t(y,f)}return x}var v0=RC(!0),DC=RC(!1),G_={},uu=pd(G_),vv=pd(G_),_v=pd(G_);function Vd(n){if(n===G_)throw Error(_n(174));return n}function n8(n,e){switch(qi(_v,e),qi(vv,n),qi(uu,G_),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:a6(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=a6(e,n)}Qi(uu),qi(uu,e)}function _0(){Qi(uu),Qi(vv),Qi(_v)}function LC(n){Vd(_v.current);var e=Vd(uu.current),t=a6(e,n.type);e!==t&&(qi(vv,n),qi(uu,t))}function r8(n){vv.current===n&&(Qi(uu),Qi(vv))}var po=pd(0);function S2(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var AA=[];function i8(){for(var n=0;n<AA.length;n++)AA[n]._workInProgressVersionPrimary=null;AA.length=0}var yx=Ph.ReactCurrentDispatcher,kA=Ph.ReactCurrentBatchConfig,mm=0,mo=null,es=null,ws=null,E2=!1,nv=!1,wv=0,zN=0;function Xs(){throw Error(_n(321))}function o8(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ec(n[t],e[t]))return!1;return!0}function s8(n,e,t,i,c,a){if(mm=a,mo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yx.current=n===null||n.memoizedState===null?HN:WN,n=t(i,c),nv){a=0;do{if(nv=!1,wv=0,25<=a)throw Error(_n(301));a+=1,ws=es=null,e.updateQueue=null,yx.current=GN,n=t(i,c)}while(nv)}if(yx.current=A2,e=es!==null&&es.next!==null,mm=0,ws=es=mo=null,E2=!1,e)throw Error(_n(300));return n}function a8(){var n=wv!==0;return wv=0,n}function Uc(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ws===null?mo.memoizedState=ws=n:ws=ws.next=n,ws}function Gl(){if(es===null){var n=mo.alternate;n=n!==null?n.memoizedState:null}else n=es.next;var e=ws===null?mo.memoizedState:ws.next;if(e!==null)ws=e,es=n;else{if(n===null)throw Error(_n(310));es=n,n={memoizedState:es.memoizedState,baseState:es.baseState,baseQueue:es.baseQueue,queue:es.queue,next:null},ws===null?mo.memoizedState=ws=n:ws=ws.next=n}return ws}function xv(n,e){return typeof e=="function"?e(n):e}function PA(n){var e=Gl(),t=e.queue;if(t===null)throw Error(_n(311));t.lastRenderedReducer=n;var i=es,c=i.baseQueue,a=t.pending;if(a!==null){if(c!==null){var l=c.next;c.next=a.next,a.next=l}i.baseQueue=c=a,t.pending=null}if(c!==null){a=c.next,i=i.baseState;var r=l=null,h=null,m=a;do{var v=m.lane;if((mm&v)===v)h!==null&&(h=h.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),i=m.hasEagerState?m.eagerState:n(i,m.action);else{var g={lane:v,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};h===null?(r=h=g,l=i):h=h.next=g,mo.lanes|=v,gm|=v}m=m.next}while(m!==null&&m!==a);h===null?l=i:h.next=r,Ec(i,e.memoizedState)||(Na=!0),e.memoizedState=i,e.baseState=l,e.baseQueue=h,t.lastRenderedState=i}if(n=t.interleaved,n!==null){c=n;do a=c.lane,mo.lanes|=a,gm|=a,c=c.next;while(c!==n)}else c===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function TA(n){var e=Gl(),t=e.queue;if(t===null)throw Error(_n(311));t.lastRenderedReducer=n;var i=t.dispatch,c=t.pending,a=e.memoizedState;if(c!==null){t.pending=null;var l=c=c.next;do a=n(a,l.action),l=l.next;while(l!==c);Ec(a,e.memoizedState)||(Na=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),t.lastRenderedState=a}return[a,i]}function jC(){}function NC(n,e){var t=mo,i=Gl(),c=e(),a=!Ec(i.memoizedState,c);if(a&&(i.memoizedState=c,Na=!0),i=i.queue,l8(FC.bind(null,t,i,n),[n]),i.getSnapshot!==e||a||ws!==null&&ws.memoizedState.tag&1){if(t.flags|=2048,Sv(9,BC.bind(null,t,i,c,e),void 0,null),xs===null)throw Error(_n(349));mm&30||$C(t,e,c)}return c}function $C(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=mo.updateQueue,e===null?(e={lastEffect:null,stores:null},mo.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function BC(n,e,t,i){e.value=t,e.getSnapshot=i,zC(e)&&UC(n)}function FC(n,e,t){return t(function(){zC(e)&&UC(n)})}function zC(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ec(n,t)}catch{return!0}}function UC(n){var e=xh(n,1);e!==null&&Sc(e,n,1,-1)}function CT(n){var e=Uc();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xv,lastRenderedState:n},e.queue=n,n=n.dispatch=qN.bind(null,mo,n),[e.memoizedState,n]}function Sv(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=mo.updateQueue,e===null?(e={lastEffect:null,stores:null},mo.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function VC(){return Gl().memoizedState}function bx(n,e,t,i){var c=Uc();mo.flags|=n,c.memoizedState=Sv(1|e,t,void 0,i===void 0?null:i)}function HE(n,e,t,i){var c=Gl();i=i===void 0?null:i;var a=void 0;if(es!==null){var l=es.memoizedState;if(a=l.destroy,i!==null&&o8(i,l.deps)){c.memoizedState=Sv(e,t,a,i);return}}mo.flags|=n,c.memoizedState=Sv(1|e,t,a,i)}function IT(n,e){return bx(8390656,8,n,e)}function l8(n,e){return HE(2048,8,n,e)}function qC(n,e){return HE(4,2,n,e)}function HC(n,e){return HE(4,4,n,e)}function WC(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function GC(n,e,t){return t=t!=null?t.concat([n]):null,HE(4,4,WC.bind(null,e,n),t)}function c8(){}function KC(n,e){var t=Gl();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&o8(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function XC(n,e){var t=Gl();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&o8(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function ZC(n,e,t){return mm&21?(Ec(t,e)||(t=QM(),mo.lanes|=t,gm|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Na=!0),n.memoizedState=t)}function UN(n,e){var t=Ri;Ri=t!==0&&4>t?t:4,n(!0);var i=kA.transition;kA.transition={};try{n(!1),e()}finally{Ri=t,kA.transition=i}}function YC(){return Gl().memoizedState}function VN(n,e,t){var i=id(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},JC(n))QC(e,t);else if(t=OC(n,e,t,i),t!==null){var c=wa();Sc(t,n,i,c),eI(t,e,i)}}function qN(n,e,t){var i=id(n),c={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(JC(n))QC(e,c);else{var a=n.alternate;if(n.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var l=e.lastRenderedState,r=a(l,t);if(c.hasEagerState=!0,c.eagerState=r,Ec(r,l)){var h=e.interleaved;h===null?(c.next=c,e8(e)):(c.next=h.next,h.next=c),e.interleaved=c;return}}catch{}finally{}t=OC(n,e,c,i),t!==null&&(c=wa(),Sc(t,n,i,c),eI(t,e,i))}}function JC(n){var e=n.alternate;return n===mo||e!==null&&e===mo}function QC(n,e){nv=E2=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function eI(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,F5(n,t)}}var A2={readContext:Wl,useCallback:Xs,useContext:Xs,useEffect:Xs,useImperativeHandle:Xs,useInsertionEffect:Xs,useLayoutEffect:Xs,useMemo:Xs,useReducer:Xs,useRef:Xs,useState:Xs,useDebugValue:Xs,useDeferredValue:Xs,useTransition:Xs,useMutableSource:Xs,useSyncExternalStore:Xs,useId:Xs,unstable_isNewReconciler:!1},HN={readContext:Wl,useCallback:function(n,e){return Uc().memoizedState=[n,e===void 0?null:e],n},useContext:Wl,useEffect:IT,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,bx(4194308,4,WC.bind(null,e,n),t)},useLayoutEffect:function(n,e){return bx(4194308,4,n,e)},useInsertionEffect:function(n,e){return bx(4,2,n,e)},useMemo:function(n,e){var t=Uc();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Uc();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=VN.bind(null,mo,n),[i.memoizedState,n]},useRef:function(n){var e=Uc();return n={current:n},e.memoizedState=n},useState:CT,useDebugValue:c8,useDeferredValue:function(n){return Uc().memoizedState=n},useTransition:function(){var n=CT(!1),e=n[0];return n=UN.bind(null,n[1]),Uc().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=mo,c=Uc();if(oo){if(t===void 0)throw Error(_n(407));t=t()}else{if(t=e(),xs===null)throw Error(_n(349));mm&30||$C(i,e,t)}c.memoizedState=t;var a={value:t,getSnapshot:e};return c.queue=a,IT(FC.bind(null,i,a,n),[n]),i.flags|=2048,Sv(9,BC.bind(null,i,a,t,e),void 0,null),t},useId:function(){var n=Uc(),e=xs.identifierPrefix;if(oo){var t=bh,i=yh;t=(i&~(1<<32-xc(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=wv++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=zN++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},WN={readContext:Wl,useCallback:KC,useContext:Wl,useEffect:l8,useImperativeHandle:GC,useInsertionEffect:qC,useLayoutEffect:HC,useMemo:XC,useReducer:PA,useRef:VC,useState:function(){return PA(xv)},useDebugValue:c8,useDeferredValue:function(n){var e=Gl();return ZC(e,es.memoizedState,n)},useTransition:function(){var n=PA(xv)[0],e=Gl().memoizedState;return[n,e]},useMutableSource:jC,useSyncExternalStore:NC,useId:YC,unstable_isNewReconciler:!1},GN={readContext:Wl,useCallback:KC,useContext:Wl,useEffect:l8,useImperativeHandle:GC,useInsertionEffect:qC,useLayoutEffect:HC,useMemo:XC,useReducer:TA,useRef:VC,useState:function(){return TA(xv)},useDebugValue:c8,useDeferredValue:function(n){var e=Gl();return es===null?e.memoizedState=n:ZC(e,es.memoizedState,n)},useTransition:function(){var n=TA(xv)[0],e=Gl().memoizedState;return[n,e]},useMutableSource:jC,useSyncExternalStore:NC,useId:YC,unstable_isNewReconciler:!1};function w0(n,e){try{var t="",i=e;do t+=wj(i),i=i.return;while(i);var c=t}catch(a){c=`
Error generating stack: `+a.message+`
`+a.stack}return{value:n,source:e,stack:c,digest:null}}function OA(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function M6(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var KN=typeof WeakMap=="function"?WeakMap:Map;function tI(n,e,t){t=vh(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){P2||(P2=!0,F6=i),M6(n,e)},t}function nI(n,e,t){t=vh(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var c=e.value;t.payload=function(){return i(c)},t.callback=function(){M6(n,e)}}var a=n.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){M6(n,e),typeof i!="function"&&(rd===null?rd=new Set([this]):rd.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),t}function RT(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new KN;var c=new Set;i.set(e,c)}else c=i.get(e),c===void 0&&(c=new Set,i.set(e,c));c.has(t)||(c.add(t),n=l$.bind(null,n,e,t),e.then(n,n))}function DT(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function LT(n,e,t,i,c){return n.mode&1?(n.flags|=65536,n.lanes=c,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=vh(-1,1),e.tag=2,nd(t,e,1))),t.lanes|=1),n)}var XN=Ph.ReactCurrentOwner,Na=!1;function _a(n,e,t,i){e.child=n===null?DC(e,null,t,i):v0(e,n.child,t,i)}function jT(n,e,t,i,c){t=t.render;var a=e.ref;return Ig(e,c),i=s8(n,e,t,i,a,c),t=a8(),n!==null&&!Na?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~c,Sh(n,e,c)):(oo&&t&&K5(e),e.flags|=1,_a(n,e,i,c),e.child)}function NT(n,e,t,i,c){if(n===null){var a=t.type;return typeof a=="function"&&!y8(a)&&a.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=a,rI(n,e,a,i,c)):(n=xx(t.type,null,i,e,e.mode,c),n.ref=e.ref,n.return=e,e.child=n)}if(a=n.child,!(n.lanes&c)){var l=a.memoizedProps;if(t=t.compare,t=t!==null?t:mv,t(l,i)&&n.ref===e.ref)return Sh(n,e,c)}return e.flags|=1,n=od(a,i),n.ref=e.ref,n.return=e,e.child=n}function rI(n,e,t,i,c){if(n!==null){var a=n.memoizedProps;if(mv(a,i)&&n.ref===e.ref)if(Na=!1,e.pendingProps=i=a,(n.lanes&c)!==0)n.flags&131072&&(Na=!0);else return e.lanes=n.lanes,Sh(n,e,c)}return C6(n,e,t,i,c)}function iI(n,e,t){var i=e.pendingProps,c=i.children,a=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qi(Ag,ml),ml|=t;else{if(!(t&1073741824))return n=a!==null?a.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,qi(Ag,ml),ml|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=a!==null?a.baseLanes:t,qi(Ag,ml),ml|=i}else a!==null?(i=a.baseLanes|t,e.memoizedState=null):i=t,qi(Ag,ml),ml|=i;return _a(n,e,c,t),e.child}function oI(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function C6(n,e,t,i,c){var a=Ba(t)?dm:oa.current;return a=y0(e,a),Ig(e,c),t=s8(n,e,t,i,a,c),i=a8(),n!==null&&!Na?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~c,Sh(n,e,c)):(oo&&i&&K5(e),e.flags|=1,_a(n,e,t,c),e.child)}function $T(n,e,t,i,c){if(Ba(t)){var a=!0;y2(e)}else a=!1;if(Ig(e,c),e.stateNode===null)vx(n,e),IC(e,t,i),O6(e,t,i,c),i=!0;else if(n===null){var l=e.stateNode,r=e.memoizedProps;l.props=r;var h=l.context,m=t.contextType;typeof m=="object"&&m!==null?m=Wl(m):(m=Ba(t)?dm:oa.current,m=y0(e,m));var v=t.getDerivedStateFromProps,g=typeof v=="function"||typeof l.getSnapshotBeforeUpdate=="function";g||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(r!==i||h!==m)&&OT(e,l,i,m),tf=!1;var _=e.memoizedState;l.state=_,x2(e,i,l,c),h=e.memoizedState,r!==i||_!==h||$a.current||tf?(typeof v=="function"&&(T6(e,t,v,i),h=e.memoizedState),(r=tf||TT(e,t,r,i,_,h,m))?(g||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=h),l.props=i,l.state=h,l.context=m,i=r):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{l=e.stateNode,MC(n,e),r=e.memoizedProps,m=e.type===e.elementType?r:rc(e.type,r),l.props=m,g=e.pendingProps,_=l.context,h=t.contextType,typeof h=="object"&&h!==null?h=Wl(h):(h=Ba(t)?dm:oa.current,h=y0(e,h));var E=t.getDerivedStateFromProps;(v=typeof E=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(r!==g||_!==h)&&OT(e,l,i,h),tf=!1,_=e.memoizedState,l.state=_,x2(e,i,l,c);var b=e.memoizedState;r!==g||_!==b||$a.current||tf?(typeof E=="function"&&(T6(e,t,E,i),b=e.memoizedState),(m=tf||TT(e,t,m,i,_,b,h)||!1)?(v||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(i,b,h),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(i,b,h)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||r===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||r===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=b),l.props=i,l.state=b,l.context=h,i=m):(typeof l.componentDidUpdate!="function"||r===n.memoizedProps&&_===n.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||r===n.memoizedProps&&_===n.memoizedState||(e.flags|=1024),i=!1)}return I6(n,e,t,i,a,c)}function I6(n,e,t,i,c,a){oI(n,e);var l=(e.flags&128)!==0;if(!i&&!l)return c&&ST(e,t,!1),Sh(n,e,a);i=e.stateNode,XN.current=e;var r=l&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&l?(e.child=v0(e,n.child,null,a),e.child=v0(e,null,r,a)):_a(n,e,r,a),e.memoizedState=i.state,c&&ST(e,t,!0),e.child}function sI(n){var e=n.stateNode;e.pendingContext?xT(n,e.pendingContext,e.pendingContext!==e.context):e.context&&xT(n,e.context,!1),n8(n,e.containerInfo)}function BT(n,e,t,i,c){return b0(),Z5(c),e.flags|=256,_a(n,e,t,i),e.child}var R6={dehydrated:null,treeContext:null,retryLane:0};function D6(n){return{baseLanes:n,cachePool:null,transitions:null}}function aI(n,e,t){var i=e.pendingProps,c=po.current,a=!1,l=(e.flags&128)!==0,r;if((r=l)||(r=n!==null&&n.memoizedState===null?!1:(c&2)!==0),r?(a=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(c|=1),qi(po,c&1),n===null)return k6(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=i.children,n=i.fallback,a?(i=e.mode,a=e.child,l={mode:"hidden",children:l},!(i&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=KE(l,i,0,null),n=hm(n,i,t,null),a.return=e,n.return=e,a.sibling=n,e.child=a,e.child.memoizedState=D6(t),e.memoizedState=R6,n):u8(e,l));if(c=n.memoizedState,c!==null&&(r=c.dehydrated,r!==null))return ZN(n,e,l,i,r,c,t);if(a){a=i.fallback,l=e.mode,c=n.child,r=c.sibling;var h={mode:"hidden",children:i.children};return!(l&1)&&e.child!==c?(i=e.child,i.childLanes=0,i.pendingProps=h,e.deletions=null):(i=od(c,h),i.subtreeFlags=c.subtreeFlags&14680064),r!==null?a=od(r,a):(a=hm(a,l,t,null),a.flags|=2),a.return=e,i.return=e,i.sibling=a,e.child=i,i=a,a=e.child,l=n.child.memoizedState,l=l===null?D6(t):{baseLanes:l.baseLanes|t,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=n.childLanes&~t,e.memoizedState=R6,i}return a=n.child,n=a.sibling,i=od(a,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function u8(n,e){return e=KE({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Kw(n,e,t,i){return i!==null&&Z5(i),v0(e,n.child,null,t),n=u8(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function ZN(n,e,t,i,c,a,l){if(t)return e.flags&256?(e.flags&=-257,i=OA(Error(_n(422))),Kw(n,e,l,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(a=i.fallback,c=e.mode,i=KE({mode:"visible",children:i.children},c,0,null),a=hm(a,c,l,null),a.flags|=2,i.return=e,a.return=e,i.sibling=a,e.child=i,e.mode&1&&v0(e,n.child,null,l),e.child.memoizedState=D6(l),e.memoizedState=R6,a);if(!(e.mode&1))return Kw(n,e,l,null);if(c.data==="$!"){if(i=c.nextSibling&&c.nextSibling.dataset,i)var r=i.dgst;return i=r,a=Error(_n(419)),i=OA(a,i,void 0),Kw(n,e,l,i)}if(r=(l&n.childLanes)!==0,Na||r){if(i=xs,i!==null){switch(l&-l){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(i.suspendedLanes|l)?0:c,c!==0&&c!==a.retryLane&&(a.retryLane=c,xh(n,c),Sc(i,n,c,-1))}return g8(),i=OA(Error(_n(421))),Kw(n,e,l,i)}return c.data==="$?"?(e.flags|=128,e.child=n.child,e=c$.bind(null,n),c._reactRetry=e,null):(n=a.treeContext,yl=td(c.nextSibling),_l=e,oo=!0,wc=null,n!==null&&(Fl[zl++]=yh,Fl[zl++]=bh,Fl[zl++]=pm,yh=n.id,bh=n.overflow,pm=e),e=u8(e,i.children),e.flags|=4096,e)}function FT(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),P6(n.return,e,t)}function MA(n,e,t,i,c){var a=n.memoizedState;a===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:c}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=t,a.tailMode=c)}function lI(n,e,t){var i=e.pendingProps,c=i.revealOrder,a=i.tail;if(_a(n,e,i.children,t),i=po.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&FT(n,t,e);else if(n.tag===19)FT(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(qi(po,i),!(e.mode&1))e.memoizedState=null;else switch(c){case"forwards":for(t=e.child,c=null;t!==null;)n=t.alternate,n!==null&&S2(n)===null&&(c=t),t=t.sibling;t=c,t===null?(c=e.child,e.child=null):(c=t.sibling,t.sibling=null),MA(e,!1,c,t,a);break;case"backwards":for(t=null,c=e.child,e.child=null;c!==null;){if(n=c.alternate,n!==null&&S2(n)===null){e.child=c;break}n=c.sibling,c.sibling=t,t=c,c=n}MA(e,!0,t,null,a);break;case"together":MA(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vx(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Sh(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),gm|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(_n(153));if(e.child!==null){for(n=e.child,t=od(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=od(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function YN(n,e,t){switch(e.tag){case 3:sI(e),b0();break;case 5:LC(e);break;case 1:Ba(e.type)&&y2(e);break;case 4:n8(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,c=e.memoizedProps.value;qi(_2,i._currentValue),i._currentValue=c;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(qi(po,po.current&1),e.flags|=128,null):t&e.child.childLanes?aI(n,e,t):(qi(po,po.current&1),n=Sh(n,e,t),n!==null?n.sibling:null);qi(po,po.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return lI(n,e,t);e.flags|=128}if(c=e.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),qi(po,po.current),i)break;return null;case 22:case 23:return e.lanes=0,iI(n,e,t)}return Sh(n,e,t)}var cI,L6,uI,hI;cI=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};L6=function(){};uI=function(n,e,t,i){var c=n.memoizedProps;if(c!==i){n=e.stateNode,Vd(uu.current);var a=null;switch(t){case"input":c=r6(n,c),i=r6(n,i),a=[];break;case"select":c=go({},c,{value:void 0}),i=go({},i,{value:void 0}),a=[];break;case"textarea":c=s6(n,c),i=s6(n,i),a=[];break;default:typeof c.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=m2)}l6(t,i);var l;t=null;for(m in c)if(!i.hasOwnProperty(m)&&c.hasOwnProperty(m)&&c[m]!=null)if(m==="style"){var r=c[m];for(l in r)r.hasOwnProperty(l)&&(t||(t={}),t[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(lv.hasOwnProperty(m)?a||(a=[]):(a=a||[]).push(m,null));for(m in i){var h=i[m];if(r=c!=null?c[m]:void 0,i.hasOwnProperty(m)&&h!==r&&(h!=null||r!=null))if(m==="style")if(r){for(l in r)!r.hasOwnProperty(l)||h&&h.hasOwnProperty(l)||(t||(t={}),t[l]="");for(l in h)h.hasOwnProperty(l)&&r[l]!==h[l]&&(t||(t={}),t[l]=h[l])}else t||(a||(a=[]),a.push(m,t)),t=h;else m==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,r=r?r.__html:void 0,h!=null&&r!==h&&(a=a||[]).push(m,h)):m==="children"?typeof h!="string"&&typeof h!="number"||(a=a||[]).push(m,""+h):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(lv.hasOwnProperty(m)?(h!=null&&m==="onScroll"&&Zi("scroll",n),a||r===h||(a=[])):(a=a||[]).push(m,h))}t&&(a=a||[]).push("style",t);var m=a;(e.updateQueue=m)&&(e.flags|=4)}};hI=function(n,e,t,i){t!==i&&(e.flags|=4)};function wb(n,e){if(!oo)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Zs(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var c=n.child;c!==null;)t|=c.lanes|c.childLanes,i|=c.subtreeFlags&14680064,i|=c.flags&14680064,c.return=n,c=c.sibling;else for(c=n.child;c!==null;)t|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=n,c=c.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function JN(n,e,t){var i=e.pendingProps;switch(X5(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zs(e),null;case 1:return Ba(e.type)&&g2(),Zs(e),null;case 3:return i=e.stateNode,_0(),Qi($a),Qi(oa),i8(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Ww(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wc!==null&&(V6(wc),wc=null))),L6(n,e),Zs(e),null;case 5:r8(e);var c=Vd(_v.current);if(t=e.type,n!==null&&e.stateNode!=null)uI(n,e,t,i,c),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(_n(166));return Zs(e),null}if(n=Vd(uu.current),Ww(e)){i=e.stateNode,t=e.type;var a=e.memoizedProps;switch(i[su]=e,i[bv]=a,n=(e.mode&1)!==0,t){case"dialog":Zi("cancel",i),Zi("close",i);break;case"iframe":case"object":case"embed":Zi("load",i);break;case"video":case"audio":for(c=0;c<Ib.length;c++)Zi(Ib[c],i);break;case"source":Zi("error",i);break;case"img":case"image":case"link":Zi("error",i),Zi("load",i);break;case"details":Zi("toggle",i);break;case"input":XP(i,a),Zi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Zi("invalid",i);break;case"textarea":YP(i,a),Zi("invalid",i)}l6(t,a),c=null;for(var l in a)if(a.hasOwnProperty(l)){var r=a[l];l==="children"?typeof r=="string"?i.textContent!==r&&(a.suppressHydrationWarning!==!0&&Hw(i.textContent,r,n),c=["children",r]):typeof r=="number"&&i.textContent!==""+r&&(a.suppressHydrationWarning!==!0&&Hw(i.textContent,r,n),c=["children",""+r]):lv.hasOwnProperty(l)&&r!=null&&l==="onScroll"&&Zi("scroll",i)}switch(t){case"input":Nw(i),ZP(i,a,!0);break;case"textarea":Nw(i),JP(i);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(i.onclick=m2)}i=c,e.updateQueue=i,i!==null&&(e.flags|=4)}else{l=c.nodeType===9?c:c.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=$M(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=l.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=l.createElement(t,{is:i.is}):(n=l.createElement(t),t==="select"&&(l=n,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):n=l.createElementNS(n,t),n[su]=e,n[bv]=i,cI(n,e,!1,!1),e.stateNode=n;e:{switch(l=c6(t,i),t){case"dialog":Zi("cancel",n),Zi("close",n),c=i;break;case"iframe":case"object":case"embed":Zi("load",n),c=i;break;case"video":case"audio":for(c=0;c<Ib.length;c++)Zi(Ib[c],n);c=i;break;case"source":Zi("error",n),c=i;break;case"img":case"image":case"link":Zi("error",n),Zi("load",n),c=i;break;case"details":Zi("toggle",n),c=i;break;case"input":XP(n,i),c=r6(n,i),Zi("invalid",n);break;case"option":c=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},c=go({},i,{value:void 0}),Zi("invalid",n);break;case"textarea":YP(n,i),c=s6(n,i),Zi("invalid",n);break;default:c=i}l6(t,c),r=c;for(a in r)if(r.hasOwnProperty(a)){var h=r[a];a==="style"?zM(n,h):a==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&BM(n,h)):a==="children"?typeof h=="string"?(t!=="textarea"||h!=="")&&cv(n,h):typeof h=="number"&&cv(n,""+h):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(lv.hasOwnProperty(a)?h!=null&&a==="onScroll"&&Zi("scroll",n):h!=null&&D5(n,a,h,l))}switch(t){case"input":Nw(n),ZP(n,i,!1);break;case"textarea":Nw(n),JP(n);break;case"option":i.value!=null&&n.setAttribute("value",""+cd(i.value));break;case"select":n.multiple=!!i.multiple,a=i.value,a!=null?Tg(n,!!i.multiple,a,!1):i.defaultValue!=null&&Tg(n,!!i.multiple,i.defaultValue,!0);break;default:typeof c.onClick=="function"&&(n.onclick=m2)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zs(e),null;case 6:if(n&&e.stateNode!=null)hI(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(_n(166));if(t=Vd(_v.current),Vd(uu.current),Ww(e)){if(i=e.stateNode,t=e.memoizedProps,i[su]=e,(a=i.nodeValue!==t)&&(n=_l,n!==null))switch(n.tag){case 3:Hw(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Hw(i.nodeValue,t,(n.mode&1)!==0)}a&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[su]=e,e.stateNode=i}return Zs(e),null;case 13:if(Qi(po),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(oo&&yl!==null&&e.mode&1&&!(e.flags&128))TC(),b0(),e.flags|=98560,a=!1;else if(a=Ww(e),i!==null&&i.dehydrated!==null){if(n===null){if(!a)throw Error(_n(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(_n(317));a[su]=e}else b0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zs(e),a=!1}else wc!==null&&(V6(wc),wc=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||po.current&1?ts===0&&(ts=3):g8())),e.updateQueue!==null&&(e.flags|=4),Zs(e),null);case 4:return _0(),L6(n,e),n===null&&gv(e.stateNode.containerInfo),Zs(e),null;case 10:return Q5(e.type._context),Zs(e),null;case 17:return Ba(e.type)&&g2(),Zs(e),null;case 19:if(Qi(po),a=e.memoizedState,a===null)return Zs(e),null;if(i=(e.flags&128)!==0,l=a.rendering,l===null)if(i)wb(a,!1);else{if(ts!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(l=S2(n),l!==null){for(e.flags|=128,wb(a,!1),i=l.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)a=t,n=i,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=n,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,n=l.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return qi(po,po.current&1|2),e.child}n=n.sibling}a.tail!==null&&Oo()>x0&&(e.flags|=128,i=!0,wb(a,!1),e.lanes=4194304)}else{if(!i)if(n=S2(l),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),wb(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!oo)return Zs(e),null}else 2*Oo()-a.renderingStartTime>x0&&t!==1073741824&&(e.flags|=128,i=!0,wb(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(t=a.last,t!==null?t.sibling=l:e.child=l,a.last=l)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Oo(),e.sibling=null,t=po.current,qi(po,i?t&1|2:t&1),e):(Zs(e),null);case 22:case 23:return m8(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?ml&1073741824&&(Zs(e),e.subtreeFlags&6&&(e.flags|=8192)):Zs(e),null;case 24:return null;case 25:return null}throw Error(_n(156,e.tag))}function QN(n,e){switch(X5(e),e.tag){case 1:return Ba(e.type)&&g2(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return _0(),Qi($a),Qi(oa),i8(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return r8(e),null;case 13:if(Qi(po),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(_n(340));b0()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Qi(po),null;case 4:return _0(),null;case 10:return Q5(e.type._context),null;case 22:case 23:return m8(),null;case 24:return null;default:return null}}var Xw=!1,ia=!1,e$=typeof WeakSet=="function"?WeakSet:Set,ur=null;function Eg(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){xo(n,e,i)}else t.current=null}function j6(n,e,t){try{t()}catch(i){xo(n,e,i)}}var zT=!1;function t$(n,e){if(v6=f2,n=mC(),G5(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var c=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{t.nodeType,a.nodeType}catch{t=null;break e}var l=0,r=-1,h=-1,m=0,v=0,g=n,_=null;t:for(;;){for(var E;g!==t||c!==0&&g.nodeType!==3||(r=l+c),g!==a||i!==0&&g.nodeType!==3||(h=l+i),g.nodeType===3&&(l+=g.nodeValue.length),(E=g.firstChild)!==null;)_=g,g=E;for(;;){if(g===n)break t;if(_===t&&++m===c&&(r=l),_===a&&++v===i&&(h=l),(E=g.nextSibling)!==null)break;g=_,_=g.parentNode}g=E}t=r===-1||h===-1?null:{start:r,end:h}}else t=null}t=t||{start:0,end:0}}else t=null;for(_6={focusedElem:n,selectionRange:t},f2=!1,ur=e;ur!==null;)if(e=ur,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ur=n;else for(;ur!==null;){e=ur;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var p=b.memoizedProps,x=b.memoizedState,y=e.stateNode,f=y.getSnapshotBeforeUpdate(e.elementType===e.type?p:rc(e.type,p),x);y.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_n(163))}}catch(A){xo(e,e.return,A)}if(n=e.sibling,n!==null){n.return=e.return,ur=n;break}ur=e.return}return b=zT,zT=!1,b}function rv(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&n)===n){var a=c.destroy;c.destroy=void 0,a!==void 0&&j6(e,t,a)}c=c.next}while(c!==i)}}function WE(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function N6(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function fI(n){var e=n.alternate;e!==null&&(n.alternate=null,fI(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[su],delete e[bv],delete e[S6],delete e[NN],delete e[$N])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function dI(n){return n.tag===5||n.tag===3||n.tag===4}function UT(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||dI(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function $6(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=m2));else if(i!==4&&(n=n.child,n!==null))for($6(n,e,t),n=n.sibling;n!==null;)$6(n,e,t),n=n.sibling}function B6(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(B6(n,e,t),n=n.sibling;n!==null;)B6(n,e,t),n=n.sibling}var js=null,vc=!1;function Yh(n,e,t){for(t=t.child;t!==null;)pI(n,e,t),t=t.sibling}function pI(n,e,t){if(cu&&typeof cu.onCommitFiberUnmount=="function")try{cu.onCommitFiberUnmount($E,t)}catch{}switch(t.tag){case 5:ia||Eg(t,e);case 6:var i=js,c=vc;js=null,Yh(n,e,t),js=i,vc=c,js!==null&&(vc?(n=js,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):js.removeChild(t.stateNode));break;case 18:js!==null&&(vc?(n=js,t=t.stateNode,n.nodeType===8?SA(n.parentNode,t):n.nodeType===1&&SA(n,t),dv(n)):SA(js,t.stateNode));break;case 4:i=js,c=vc,js=t.stateNode.containerInfo,vc=!0,Yh(n,e,t),js=i,vc=c;break;case 0:case 11:case 14:case 15:if(!ia&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){c=i=i.next;do{var a=c,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&j6(t,e,l),c=c.next}while(c!==i)}Yh(n,e,t);break;case 1:if(!ia&&(Eg(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(r){xo(t,e,r)}Yh(n,e,t);break;case 21:Yh(n,e,t);break;case 22:t.mode&1?(ia=(i=ia)||t.memoizedState!==null,Yh(n,e,t),ia=i):Yh(n,e,t);break;default:Yh(n,e,t)}}function VT(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new e$),e.forEach(function(i){var c=u$.bind(null,n,i);t.has(i)||(t.add(i),i.then(c,c))})}}function tc(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var c=t[i];try{var a=n,l=e,r=l;e:for(;r!==null;){switch(r.tag){case 5:js=r.stateNode,vc=!1;break e;case 3:js=r.stateNode.containerInfo,vc=!0;break e;case 4:js=r.stateNode.containerInfo,vc=!0;break e}r=r.return}if(js===null)throw Error(_n(160));pI(a,l,c),js=null,vc=!1;var h=c.alternate;h!==null&&(h.return=null),c.return=null}catch(m){xo(c,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mI(e,n),e=e.sibling}function mI(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(tc(e,n),$c(n),i&4){try{rv(3,n,n.return),WE(3,n)}catch(p){xo(n,n.return,p)}try{rv(5,n,n.return)}catch(p){xo(n,n.return,p)}}break;case 1:tc(e,n),$c(n),i&512&&t!==null&&Eg(t,t.return);break;case 5:if(tc(e,n),$c(n),i&512&&t!==null&&Eg(t,t.return),n.flags&32){var c=n.stateNode;try{cv(c,"")}catch(p){xo(n,n.return,p)}}if(i&4&&(c=n.stateNode,c!=null)){var a=n.memoizedProps,l=t!==null?t.memoizedProps:a,r=n.type,h=n.updateQueue;if(n.updateQueue=null,h!==null)try{r==="input"&&a.type==="radio"&&a.name!=null&&jM(c,a),c6(r,l);var m=c6(r,a);for(l=0;l<h.length;l+=2){var v=h[l],g=h[l+1];v==="style"?zM(c,g):v==="dangerouslySetInnerHTML"?BM(c,g):v==="children"?cv(c,g):D5(c,v,g,m)}switch(r){case"input":i6(c,a);break;case"textarea":NM(c,a);break;case"select":var _=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!a.multiple;var E=a.value;E!=null?Tg(c,!!a.multiple,E,!1):_!==!!a.multiple&&(a.defaultValue!=null?Tg(c,!!a.multiple,a.defaultValue,!0):Tg(c,!!a.multiple,a.multiple?[]:"",!1))}c[bv]=a}catch(p){xo(n,n.return,p)}}break;case 6:if(tc(e,n),$c(n),i&4){if(n.stateNode===null)throw Error(_n(162));c=n.stateNode,a=n.memoizedProps;try{c.nodeValue=a}catch(p){xo(n,n.return,p)}}break;case 3:if(tc(e,n),$c(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{dv(e.containerInfo)}catch(p){xo(n,n.return,p)}break;case 4:tc(e,n),$c(n);break;case 13:tc(e,n),$c(n),c=n.child,c.flags&8192&&(a=c.memoizedState!==null,c.stateNode.isHidden=a,!a||c.alternate!==null&&c.alternate.memoizedState!==null||(d8=Oo())),i&4&&VT(n);break;case 22:if(v=t!==null&&t.memoizedState!==null,n.mode&1?(ia=(m=ia)||v,tc(e,n),ia=m):tc(e,n),$c(n),i&8192){if(m=n.memoizedState!==null,(n.stateNode.isHidden=m)&&!v&&n.mode&1)for(ur=n,v=n.child;v!==null;){for(g=ur=v;ur!==null;){switch(_=ur,E=_.child,_.tag){case 0:case 11:case 14:case 15:rv(4,_,_.return);break;case 1:Eg(_,_.return);var b=_.stateNode;if(typeof b.componentWillUnmount=="function"){i=_,t=_.return;try{e=i,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(p){xo(i,t,p)}}break;case 5:Eg(_,_.return);break;case 22:if(_.memoizedState!==null){HT(g);continue}}E!==null?(E.return=_,ur=E):HT(g)}v=v.sibling}e:for(v=null,g=n;;){if(g.tag===5){if(v===null){v=g;try{c=g.stateNode,m?(a=c.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(r=g.stateNode,h=g.memoizedProps.style,l=h!=null&&h.hasOwnProperty("display")?h.display:null,r.style.display=FM("display",l))}catch(p){xo(n,n.return,p)}}}else if(g.tag===6){if(v===null)try{g.stateNode.nodeValue=m?"":g.memoizedProps}catch(p){xo(n,n.return,p)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===n)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===n)break e;for(;g.sibling===null;){if(g.return===null||g.return===n)break e;v===g&&(v=null),g=g.return}v===g&&(v=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:tc(e,n),$c(n),i&4&&VT(n);break;case 21:break;default:tc(e,n),$c(n)}}function $c(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(dI(t)){var i=t;break e}t=t.return}throw Error(_n(160))}switch(i.tag){case 5:var c=i.stateNode;i.flags&32&&(cv(c,""),i.flags&=-33);var a=UT(n);B6(n,a,c);break;case 3:case 4:var l=i.stateNode.containerInfo,r=UT(n);$6(n,r,l);break;default:throw Error(_n(161))}}catch(h){xo(n,n.return,h)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function n$(n,e,t){ur=n,gI(n)}function gI(n,e,t){for(var i=(n.mode&1)!==0;ur!==null;){var c=ur,a=c.child;if(c.tag===22&&i){var l=c.memoizedState!==null||Xw;if(!l){var r=c.alternate,h=r!==null&&r.memoizedState!==null||ia;r=Xw;var m=ia;if(Xw=l,(ia=h)&&!m)for(ur=c;ur!==null;)l=ur,h=l.child,l.tag===22&&l.memoizedState!==null?WT(c):h!==null?(h.return=l,ur=h):WT(c);for(;a!==null;)ur=a,gI(a),a=a.sibling;ur=c,Xw=r,ia=m}qT(n)}else c.subtreeFlags&8772&&a!==null?(a.return=c,ur=a):qT(n)}}function qT(n){for(;ur!==null;){var e=ur;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ia||WE(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!ia)if(t===null)i.componentDidMount();else{var c=e.elementType===e.type?t.memoizedProps:rc(e.type,t.memoizedProps);i.componentDidUpdate(c,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&PT(e,a,i);break;case 3:var l=e.updateQueue;if(l!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}PT(e,l,t)}break;case 5:var r=e.stateNode;if(t===null&&e.flags&4){t=r;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&t.focus();break;case"img":h.src&&(t.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var v=m.memoizedState;if(v!==null){var g=v.dehydrated;g!==null&&dv(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_n(163))}ia||e.flags&512&&N6(e)}catch(_){xo(e,e.return,_)}}if(e===n){ur=null;break}if(t=e.sibling,t!==null){t.return=e.return,ur=t;break}ur=e.return}}function HT(n){for(;ur!==null;){var e=ur;if(e===n){ur=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ur=t;break}ur=e.return}}function WT(n){for(;ur!==null;){var e=ur;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{WE(4,e)}catch(h){xo(e,t,h)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var c=e.return;try{i.componentDidMount()}catch(h){xo(e,c,h)}}var a=e.return;try{N6(e)}catch(h){xo(e,a,h)}break;case 5:var l=e.return;try{N6(e)}catch(h){xo(e,l,h)}}}catch(h){xo(e,e.return,h)}if(e===n){ur=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ur=r;break}ur=e.return}}var r$=Math.ceil,k2=Ph.ReactCurrentDispatcher,h8=Ph.ReactCurrentOwner,ql=Ph.ReactCurrentBatchConfig,Ai=0,xs=null,zo=null,$s=0,ml=0,Ag=pd(0),ts=0,Ev=null,gm=0,GE=0,f8=0,iv=null,ja=null,d8=0,x0=1/0,ju=null,P2=!1,F6=null,rd=null,Zw=!1,Zf=null,T2=0,ov=0,z6=null,_x=-1,wx=0;function wa(){return Ai&6?Oo():_x!==-1?_x:_x=Oo()}function id(n){return n.mode&1?Ai&2&&$s!==0?$s&-$s:FN.transition!==null?(wx===0&&(wx=QM()),wx):(n=Ri,n!==0||(n=window.event,n=n===void 0?16:sC(n.type)),n):1}function Sc(n,e,t,i){if(50<ov)throw ov=0,z6=null,Error(_n(185));q_(n,t,i),(!(Ai&2)||n!==xs)&&(n===xs&&(!(Ai&2)&&(GE|=t),ts===4&&rf(n,$s)),Fa(n,i),t===1&&Ai===0&&!(e.mode&1)&&(x0=Oo()+500,VE&&md()))}function Fa(n,e){var t=n.callbackNode;Fj(n,e);var i=h2(n,n===xs?$s:0);if(i===0)t!==null&&tT(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&tT(t),e===1)n.tag===0?BN(GT.bind(null,n)):AC(GT.bind(null,n)),LN(function(){!(Ai&6)&&md()}),t=null;else{switch(eC(i)){case 1:t=B5;break;case 4:t=YM;break;case 16:t=u2;break;case 536870912:t=JM;break;default:t=u2}t=EI(t,yI.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function yI(n,e){if(_x=-1,wx=0,Ai&6)throw Error(_n(327));var t=n.callbackNode;if(Rg()&&n.callbackNode!==t)return null;var i=h2(n,n===xs?$s:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=O2(n,i);else{e=i;var c=Ai;Ai|=2;var a=vI();(xs!==n||$s!==e)&&(ju=null,x0=Oo()+500,um(n,e));do try{s$();break}catch(r){bI(n,r)}while(!0);J5(),k2.current=a,Ai=c,zo!==null?e=0:(xs=null,$s=0,e=ts)}if(e!==0){if(e===2&&(c=p6(n),c!==0&&(i=c,e=U6(n,c))),e===1)throw t=Ev,um(n,0),rf(n,i),Fa(n,Oo()),t;if(e===6)rf(n,i);else{if(c=n.current.alternate,!(i&30)&&!i$(c)&&(e=O2(n,i),e===2&&(a=p6(n),a!==0&&(i=a,e=U6(n,a))),e===1))throw t=Ev,um(n,0),rf(n,i),Fa(n,Oo()),t;switch(n.finishedWork=c,n.finishedLanes=i,e){case 0:case 1:throw Error(_n(345));case 2:Dd(n,ja,ju);break;case 3:if(rf(n,i),(i&130023424)===i&&(e=d8+500-Oo(),10<e)){if(h2(n,0)!==0)break;if(c=n.suspendedLanes,(c&i)!==i){wa(),n.pingedLanes|=n.suspendedLanes&c;break}n.timeoutHandle=x6(Dd.bind(null,n,ja,ju),e);break}Dd(n,ja,ju);break;case 4:if(rf(n,i),(i&4194240)===i)break;for(e=n.eventTimes,c=-1;0<i;){var l=31-xc(i);a=1<<l,l=e[l],l>c&&(c=l),i&=~a}if(i=c,i=Oo()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*r$(i/1960))-i,10<i){n.timeoutHandle=x6(Dd.bind(null,n,ja,ju),i);break}Dd(n,ja,ju);break;case 5:Dd(n,ja,ju);break;default:throw Error(_n(329))}}}return Fa(n,Oo()),n.callbackNode===t?yI.bind(null,n):null}function U6(n,e){var t=iv;return n.current.memoizedState.isDehydrated&&(um(n,e).flags|=256),n=O2(n,e),n!==2&&(e=ja,ja=t,e!==null&&V6(e)),n}function V6(n){ja===null?ja=n:ja.push.apply(ja,n)}function i$(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var c=t[i],a=c.getSnapshot;c=c.value;try{if(!Ec(a(),c))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function rf(n,e){for(e&=~f8,e&=~GE,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-xc(e),i=1<<t;n[t]=-1,e&=~i}}function GT(n){if(Ai&6)throw Error(_n(327));Rg();var e=h2(n,0);if(!(e&1))return Fa(n,Oo()),null;var t=O2(n,e);if(n.tag!==0&&t===2){var i=p6(n);i!==0&&(e=i,t=U6(n,i))}if(t===1)throw t=Ev,um(n,0),rf(n,e),Fa(n,Oo()),t;if(t===6)throw Error(_n(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Dd(n,ja,ju),Fa(n,Oo()),null}function p8(n,e){var t=Ai;Ai|=1;try{return n(e)}finally{Ai=t,Ai===0&&(x0=Oo()+500,VE&&md())}}function ym(n){Zf!==null&&Zf.tag===0&&!(Ai&6)&&Rg();var e=Ai;Ai|=1;var t=ql.transition,i=Ri;try{if(ql.transition=null,Ri=1,n)return n()}finally{Ri=i,ql.transition=t,Ai=e,!(Ai&6)&&md()}}function m8(){ml=Ag.current,Qi(Ag)}function um(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,DN(t)),zo!==null)for(t=zo.return;t!==null;){var i=t;switch(X5(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&g2();break;case 3:_0(),Qi($a),Qi(oa),i8();break;case 5:r8(i);break;case 4:_0();break;case 13:Qi(po);break;case 19:Qi(po);break;case 10:Q5(i.type._context);break;case 22:case 23:m8()}t=t.return}if(xs=n,zo=n=od(n.current,null),$s=ml=e,ts=0,Ev=null,f8=GE=gm=0,ja=iv=null,Ud!==null){for(e=0;e<Ud.length;e++)if(t=Ud[e],i=t.interleaved,i!==null){t.interleaved=null;var c=i.next,a=t.pending;if(a!==null){var l=a.next;a.next=c,i.next=l}t.pending=i}Ud=null}return n}function bI(n,e){do{var t=zo;try{if(J5(),yx.current=A2,E2){for(var i=mo.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}E2=!1}if(mm=0,ws=es=mo=null,nv=!1,wv=0,h8.current=null,t===null||t.return===null){ts=1,Ev=e,zo=null;break}e:{var a=n,l=t.return,r=t,h=e;if(e=$s,r.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var m=h,v=r,g=v.tag;if(!(v.mode&1)&&(g===0||g===11||g===15)){var _=v.alternate;_?(v.updateQueue=_.updateQueue,v.memoizedState=_.memoizedState,v.lanes=_.lanes):(v.updateQueue=null,v.memoizedState=null)}var E=DT(l);if(E!==null){E.flags&=-257,LT(E,l,r,a,e),E.mode&1&&RT(a,m,e),e=E,h=m;var b=e.updateQueue;if(b===null){var p=new Set;p.add(h),e.updateQueue=p}else b.add(h);break e}else{if(!(e&1)){RT(a,m,e),g8();break e}h=Error(_n(426))}}else if(oo&&r.mode&1){var x=DT(l);if(x!==null){!(x.flags&65536)&&(x.flags|=256),LT(x,l,r,a,e),Z5(w0(h,r));break e}}a=h=w0(h,r),ts!==4&&(ts=2),iv===null?iv=[a]:iv.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var y=tI(a,h,e);kT(a,y);break e;case 1:r=h;var f=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof f.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(rd===null||!rd.has(w)))){a.flags|=65536,e&=-e,a.lanes|=e;var A=nI(a,r,e);kT(a,A);break e}}a=a.return}while(a!==null)}wI(t)}catch(P){e=P,zo===t&&t!==null&&(zo=t=t.return);continue}break}while(!0)}function vI(){var n=k2.current;return k2.current=A2,n===null?A2:n}function g8(){(ts===0||ts===3||ts===2)&&(ts=4),xs===null||!(gm&268435455)&&!(GE&268435455)||rf(xs,$s)}function O2(n,e){var t=Ai;Ai|=2;var i=vI();(xs!==n||$s!==e)&&(ju=null,um(n,e));do try{o$();break}catch(c){bI(n,c)}while(!0);if(J5(),Ai=t,k2.current=i,zo!==null)throw Error(_n(261));return xs=null,$s=0,ts}function o$(){for(;zo!==null;)_I(zo)}function s$(){for(;zo!==null&&!Cj();)_I(zo)}function _I(n){var e=SI(n.alternate,n,ml);n.memoizedProps=n.pendingProps,e===null?wI(n):zo=e,h8.current=null}function wI(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=QN(t,e),t!==null){t.flags&=32767,zo=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ts=6,zo=null;return}}else if(t=JN(t,e,ml),t!==null){zo=t;return}if(e=e.sibling,e!==null){zo=e;return}zo=e=n}while(e!==null);ts===0&&(ts=5)}function Dd(n,e,t){var i=Ri,c=ql.transition;try{ql.transition=null,Ri=1,a$(n,e,t,i)}finally{ql.transition=c,Ri=i}return null}function a$(n,e,t,i){do Rg();while(Zf!==null);if(Ai&6)throw Error(_n(327));t=n.finishedWork;var c=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(_n(177));n.callbackNode=null,n.callbackPriority=0;var a=t.lanes|t.childLanes;if(zj(n,a),n===xs&&(zo=xs=null,$s=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Zw||(Zw=!0,EI(u2,function(){return Rg(),null})),a=(t.flags&15990)!==0,t.subtreeFlags&15990||a){a=ql.transition,ql.transition=null;var l=Ri;Ri=1;var r=Ai;Ai|=4,h8.current=null,t$(n,t),mI(t,n),PN(_6),f2=!!v6,_6=v6=null,n.current=t,n$(t),Ij(),Ai=r,Ri=l,ql.transition=a}else n.current=t;if(Zw&&(Zw=!1,Zf=n,T2=c),a=n.pendingLanes,a===0&&(rd=null),Lj(t.stateNode),Fa(n,Oo()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)c=e[t],i(c.value,{componentStack:c.stack,digest:c.digest});if(P2)throw P2=!1,n=F6,F6=null,n;return T2&1&&n.tag!==0&&Rg(),a=n.pendingLanes,a&1?n===z6?ov++:(ov=0,z6=n):ov=0,md(),null}function Rg(){if(Zf!==null){var n=eC(T2),e=ql.transition,t=Ri;try{if(ql.transition=null,Ri=16>n?16:n,Zf===null)var i=!1;else{if(n=Zf,Zf=null,T2=0,Ai&6)throw Error(_n(331));var c=Ai;for(Ai|=4,ur=n.current;ur!==null;){var a=ur,l=a.child;if(ur.flags&16){var r=a.deletions;if(r!==null){for(var h=0;h<r.length;h++){var m=r[h];for(ur=m;ur!==null;){var v=ur;switch(v.tag){case 0:case 11:case 15:rv(8,v,a)}var g=v.child;if(g!==null)g.return=v,ur=g;else for(;ur!==null;){v=ur;var _=v.sibling,E=v.return;if(fI(v),v===m){ur=null;break}if(_!==null){_.return=E,ur=_;break}ur=E}}}var b=a.alternate;if(b!==null){var p=b.child;if(p!==null){b.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}ur=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,ur=l;else e:for(;ur!==null;){if(a=ur,a.flags&2048)switch(a.tag){case 0:case 11:case 15:rv(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,ur=y;break e}ur=a.return}}var f=n.current;for(ur=f;ur!==null;){l=ur;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,ur=w;else e:for(l=f;ur!==null;){if(r=ur,r.flags&2048)try{switch(r.tag){case 0:case 11:case 15:WE(9,r)}}catch(P){xo(r,r.return,P)}if(r===l){ur=null;break e}var A=r.sibling;if(A!==null){A.return=r.return,ur=A;break e}ur=r.return}}if(Ai=c,md(),cu&&typeof cu.onPostCommitFiberRoot=="function")try{cu.onPostCommitFiberRoot($E,n)}catch{}i=!0}return i}finally{Ri=t,ql.transition=e}}return!1}function KT(n,e,t){e=w0(t,e),e=tI(n,e,1),n=nd(n,e,1),e=wa(),n!==null&&(q_(n,1,e),Fa(n,e))}function xo(n,e,t){if(n.tag===3)KT(n,n,t);else for(;e!==null;){if(e.tag===3){KT(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(rd===null||!rd.has(i))){n=w0(t,n),n=nI(e,n,1),e=nd(e,n,1),n=wa(),e!==null&&(q_(e,1,n),Fa(e,n));break}}e=e.return}}function l$(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=wa(),n.pingedLanes|=n.suspendedLanes&t,xs===n&&($s&t)===t&&(ts===4||ts===3&&($s&130023424)===$s&&500>Oo()-d8?um(n,0):f8|=t),Fa(n,e)}function xI(n,e){e===0&&(n.mode&1?(e=Fw,Fw<<=1,!(Fw&130023424)&&(Fw=4194304)):e=1);var t=wa();n=xh(n,e),n!==null&&(q_(n,e,t),Fa(n,t))}function c$(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),xI(n,t)}function u$(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,c=n.memoizedState;c!==null&&(t=c.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(_n(314))}i!==null&&i.delete(e),xI(n,t)}var SI;SI=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||$a.current)Na=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Na=!1,YN(n,e,t);Na=!!(n.flags&131072)}else Na=!1,oo&&e.flags&1048576&&kC(e,v2,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;vx(n,e),n=e.pendingProps;var c=y0(e,oa.current);Ig(e,t),c=s8(null,e,i,n,c,t);var a=a8();return e.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ba(i)?(a=!0,y2(e)):a=!1,e.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,t8(e),c.updater=qE,e.stateNode=c,c._reactInternals=e,O6(e,i,n,t),e=I6(null,e,i,!0,a,t)):(e.tag=0,oo&&a&&K5(e),_a(null,e,c,t),e=e.child),e;case 16:i=e.elementType;e:{switch(vx(n,e),n=e.pendingProps,c=i._init,i=c(i._payload),e.type=i,c=e.tag=f$(i),n=rc(i,n),c){case 0:e=C6(null,e,i,n,t);break e;case 1:e=$T(null,e,i,n,t);break e;case 11:e=jT(null,e,i,n,t);break e;case 14:e=NT(null,e,i,rc(i.type,n),t);break e}throw Error(_n(306,i,""))}return e;case 0:return i=e.type,c=e.pendingProps,c=e.elementType===i?c:rc(i,c),C6(n,e,i,c,t);case 1:return i=e.type,c=e.pendingProps,c=e.elementType===i?c:rc(i,c),$T(n,e,i,c,t);case 3:e:{if(sI(e),n===null)throw Error(_n(387));i=e.pendingProps,a=e.memoizedState,c=a.element,MC(n,e),x2(e,i,null,t);var l=e.memoizedState;if(i=l.element,a.isDehydrated)if(a={element:i,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){c=w0(Error(_n(423)),e),e=BT(n,e,i,t,c);break e}else if(i!==c){c=w0(Error(_n(424)),e),e=BT(n,e,i,t,c);break e}else for(yl=td(e.stateNode.containerInfo.firstChild),_l=e,oo=!0,wc=null,t=DC(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(b0(),i===c){e=Sh(n,e,t);break e}_a(n,e,i,t)}e=e.child}return e;case 5:return LC(e),n===null&&k6(e),i=e.type,c=e.pendingProps,a=n!==null?n.memoizedProps:null,l=c.children,w6(i,c)?l=null:a!==null&&w6(i,a)&&(e.flags|=32),oI(n,e),_a(n,e,l,t),e.child;case 6:return n===null&&k6(e),null;case 13:return aI(n,e,t);case 4:return n8(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=v0(e,null,i,t):_a(n,e,i,t),e.child;case 11:return i=e.type,c=e.pendingProps,c=e.elementType===i?c:rc(i,c),jT(n,e,i,c,t);case 7:return _a(n,e,e.pendingProps,t),e.child;case 8:return _a(n,e,e.pendingProps.children,t),e.child;case 12:return _a(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,c=e.pendingProps,a=e.memoizedProps,l=c.value,qi(_2,i._currentValue),i._currentValue=l,a!==null)if(Ec(a.value,l)){if(a.children===c.children&&!$a.current){e=Sh(n,e,t);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var r=a.dependencies;if(r!==null){l=a.child;for(var h=r.firstContext;h!==null;){if(h.context===i){if(a.tag===1){h=vh(-1,t&-t),h.tag=2;var m=a.updateQueue;if(m!==null){m=m.shared;var v=m.pending;v===null?h.next=h:(h.next=v.next,v.next=h),m.pending=h}}a.lanes|=t,h=a.alternate,h!==null&&(h.lanes|=t),P6(a.return,t,e),r.lanes|=t;break}h=h.next}}else if(a.tag===10)l=a.type===e.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(_n(341));l.lanes|=t,r=l.alternate,r!==null&&(r.lanes|=t),P6(l,t,e),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===e){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}_a(n,e,c.children,t),e=e.child}return e;case 9:return c=e.type,i=e.pendingProps.children,Ig(e,t),c=Wl(c),i=i(c),e.flags|=1,_a(n,e,i,t),e.child;case 14:return i=e.type,c=rc(i,e.pendingProps),c=rc(i.type,c),NT(n,e,i,c,t);case 15:return rI(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,c=e.pendingProps,c=e.elementType===i?c:rc(i,c),vx(n,e),e.tag=1,Ba(i)?(n=!0,y2(e)):n=!1,Ig(e,t),IC(e,i,c),O6(e,i,c,t),I6(null,e,i,!0,n,t);case 19:return lI(n,e,t);case 22:return iI(n,e,t)}throw Error(_n(156,e.tag))};function EI(n,e){return ZM(n,e)}function h$(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vl(n,e,t,i){return new h$(n,e,t,i)}function y8(n){return n=n.prototype,!(!n||!n.isReactComponent)}function f$(n){if(typeof n=="function")return y8(n)?1:0;if(n!=null){if(n=n.$$typeof,n===j5)return 11;if(n===N5)return 14}return 2}function od(n,e){var t=n.alternate;return t===null?(t=Vl(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function xx(n,e,t,i,c,a){var l=2;if(i=n,typeof n=="function")y8(n)&&(l=1);else if(typeof n=="string")l=5;else e:switch(n){case mg:return hm(t.children,c,a,e);case L5:l=8,c|=8;break;case QA:return n=Vl(12,t,e,c|2),n.elementType=QA,n.lanes=a,n;case e6:return n=Vl(13,t,e,c),n.elementType=e6,n.lanes=a,n;case t6:return n=Vl(19,t,e,c),n.elementType=t6,n.lanes=a,n;case RM:return KE(t,c,a,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case CM:l=10;break e;case IM:l=9;break e;case j5:l=11;break e;case N5:l=14;break e;case ef:l=16,i=null;break e}throw Error(_n(130,n==null?n:typeof n,""))}return e=Vl(l,t,e,c),e.elementType=n,e.type=i,e.lanes=a,e}function hm(n,e,t,i){return n=Vl(7,n,i,e),n.lanes=t,n}function KE(n,e,t,i){return n=Vl(22,n,i,e),n.elementType=RM,n.lanes=t,n.stateNode={isHidden:!1},n}function CA(n,e,t){return n=Vl(6,n,null,e),n.lanes=t,n}function IA(n,e,t){return e=Vl(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function d$(n,e,t,i,c){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fA(0),this.expirationTimes=fA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fA(0),this.identifierPrefix=i,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function b8(n,e,t,i,c,a,l,r,h){return n=new d$(n,e,t,r,h),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Vl(3,null,null,e),n.current=a,a.stateNode=n,a.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},t8(a),n}function p$(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pg,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function AI(n){if(!n)return ud;n=n._reactInternals;e:{if(Sm(n)!==n||n.tag!==1)throw Error(_n(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ba(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_n(171))}if(n.tag===1){var t=n.type;if(Ba(t))return EC(n,t,e)}return e}function kI(n,e,t,i,c,a,l,r,h){return n=b8(t,i,!0,n,c,a,l,r,h),n.context=AI(null),t=n.current,i=wa(),c=id(t),a=vh(i,c),a.callback=e??null,nd(t,a,c),n.current.lanes=c,q_(n,c,i),Fa(n,i),n}function XE(n,e,t,i){var c=e.current,a=wa(),l=id(c);return t=AI(t),e.context===null?e.context=t:e.pendingContext=t,e=vh(a,l),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=nd(c,e,l),n!==null&&(Sc(n,c,l,a),gx(n,c,l)),l}function M2(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function XT(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function v8(n,e){XT(n,e),(n=n.alternate)&&XT(n,e)}function m$(){return null}var PI=typeof reportError=="function"?reportError:function(n){console.error(n)};function _8(n){this._internalRoot=n}ZE.prototype.render=_8.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(_n(409));XE(n,e,null,null)};ZE.prototype.unmount=_8.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ym(function(){XE(null,n,null,null)}),e[wh]=null}};function ZE(n){this._internalRoot=n}ZE.prototype.unstable_scheduleHydration=function(n){if(n){var e=rC();n={blockedOn:null,target:n,priority:e};for(var t=0;t<nf.length&&e!==0&&e<nf[t].priority;t++);nf.splice(t,0,n),t===0&&oC(n)}};function w8(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function YE(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ZT(){}function g$(n,e,t,i,c){if(c){if(typeof i=="function"){var a=i;i=function(){var m=M2(l);a.call(m)}}var l=kI(e,i,n,0,null,!1,!1,"",ZT);return n._reactRootContainer=l,n[wh]=l.current,gv(n.nodeType===8?n.parentNode:n),ym(),l}for(;c=n.lastChild;)n.removeChild(c);if(typeof i=="function"){var r=i;i=function(){var m=M2(h);r.call(m)}}var h=b8(n,0,!1,null,null,!1,!1,"",ZT);return n._reactRootContainer=h,n[wh]=h.current,gv(n.nodeType===8?n.parentNode:n),ym(function(){XE(e,h,t,i)}),h}function JE(n,e,t,i,c){var a=t._reactRootContainer;if(a){var l=a;if(typeof c=="function"){var r=c;c=function(){var h=M2(l);r.call(h)}}XE(e,l,n,c)}else l=g$(t,e,n,c,i);return M2(l)}tC=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Cb(e.pendingLanes);t!==0&&(F5(e,t|1),Fa(e,Oo()),!(Ai&6)&&(x0=Oo()+500,md()))}break;case 13:ym(function(){var i=xh(n,1);if(i!==null){var c=wa();Sc(i,n,1,c)}}),v8(n,1)}};z5=function(n){if(n.tag===13){var e=xh(n,134217728);if(e!==null){var t=wa();Sc(e,n,134217728,t)}v8(n,134217728)}};nC=function(n){if(n.tag===13){var e=id(n),t=xh(n,e);if(t!==null){var i=wa();Sc(t,n,e,i)}v8(n,e)}};rC=function(){return Ri};iC=function(n,e){var t=Ri;try{return Ri=n,e()}finally{Ri=t}};h6=function(n,e,t){switch(e){case"input":if(i6(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var c=UE(i);if(!c)throw Error(_n(90));LM(i),i6(i,c)}}}break;case"textarea":NM(n,t);break;case"select":e=t.value,e!=null&&Tg(n,!!t.multiple,e,!1)}};qM=p8;HM=ym;var y$={usingClientEntryPoint:!1,Events:[W_,vg,UE,UM,VM,p8]},xb={findFiberByHostInstance:zd,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},b$={bundleType:xb.bundleType,version:xb.version,rendererPackageName:xb.rendererPackageName,rendererConfig:xb.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ph.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=KM(n),n===null?null:n.stateNode},findFiberByHostInstance:xb.findFiberByHostInstance||m$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yw.isDisabled&&Yw.supportsFiber)try{$E=Yw.inject(b$),cu=Yw}catch{}}xl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y$;xl.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w8(e))throw Error(_n(200));return p$(n,e,null,t)};xl.createRoot=function(n,e){if(!w8(n))throw Error(_n(299));var t=!1,i="",c=PI;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(c=e.onRecoverableError)),e=b8(n,1,!1,null,null,t,!1,i,c),n[wh]=e.current,gv(n.nodeType===8?n.parentNode:n),new _8(e)};xl.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(_n(188)):(n=Object.keys(n).join(","),Error(_n(268,n)));return n=KM(e),n=n===null?null:n.stateNode,n};xl.flushSync=function(n){return ym(n)};xl.hydrate=function(n,e,t){if(!YE(e))throw Error(_n(200));return JE(null,n,e,!0,t)};xl.hydrateRoot=function(n,e,t){if(!w8(n))throw Error(_n(405));var i=t!=null&&t.hydratedSources||null,c=!1,a="",l=PI;if(t!=null&&(t.unstable_strictMode===!0&&(c=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),e=kI(e,null,n,1,t??null,c,!1,a,l),n[wh]=e.current,gv(n),i)for(n=0;n<i.length;n++)t=i[n],c=t._getVersion,c=c(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,c]:e.mutableSourceEagerHydrationData.push(t,c);return new ZE(e)};xl.render=function(n,e,t){if(!YE(e))throw Error(_n(200));return JE(null,n,e,!1,t)};xl.unmountComponentAtNode=function(n){if(!YE(n))throw Error(_n(40));return n._reactRootContainer?(ym(function(){JE(null,null,n,!1,function(){n._reactRootContainer=null,n[wh]=null})}),!0):!1};xl.unstable_batchedUpdates=p8;xl.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!YE(t))throw Error(_n(200));if(n==null||n._reactInternals===void 0)throw Error(_n(38));return JE(n,e,t,!1,i)};xl.version="18.2.0-next-9e3b772b8-20220608";function TI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(TI)}catch(n){console.error(n)}}TI(),kM.exports=xl;var v$=kM.exports,YT=v$;YA.createRoot=YT.createRoot,YA.hydrateRoot=YT.hydrateRoot;/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Av(){return Av=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Av.apply(this,arguments)}var Yf;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Yf||(Yf={}));const JT="popstate";function _$(n){n===void 0&&(n={});function e(i,c){let{pathname:a,search:l,hash:r}=i.location;return q6("",{pathname:a,search:l,hash:r},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(i,c){return typeof c=="string"?c:C2(c)}return x$(e,t,null,n)}function Mo(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function x8(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function w$(){return Math.random().toString(36).substr(2,8)}function QT(n,e){return{usr:n.state,key:n.key,idx:e}}function q6(n,e,t,i){return t===void 0&&(t=null),Av({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?P0(e):e,{state:t,key:e&&e.key||i||w$()})}function C2(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function P0(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function x$(n,e,t,i){i===void 0&&(i={});let{window:c=document.defaultView,v5Compat:a=!1}=i,l=c.history,r=Yf.Pop,h=null,m=v();m==null&&(m=0,l.replaceState(Av({},l.state,{idx:m}),""));function v(){return(l.state||{idx:null}).idx}function g(){r=Yf.Pop;let x=v(),y=x==null?null:x-m;m=x,h&&h({action:r,location:p.location,delta:y})}function _(x,y){r=Yf.Push;let f=q6(p.location,x,y);t&&t(f,x),m=v()+1;let w=QT(f,m),A=p.createHref(f);try{l.pushState(w,"",A)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;c.location.assign(A)}a&&h&&h({action:r,location:p.location,delta:1})}function E(x,y){r=Yf.Replace;let f=q6(p.location,x,y);t&&t(f,x),m=v();let w=QT(f,m),A=p.createHref(f);l.replaceState(w,"",A),a&&h&&h({action:r,location:p.location,delta:0})}function b(x){let y=c.location.origin!=="null"?c.location.origin:c.location.href,f=typeof x=="string"?x:C2(x);return Mo(y,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,y)}let p={get action(){return r},get location(){return n(c,l)},listen(x){if(h)throw new Error("A history only accepts one active listener");return c.addEventListener(JT,g),h=x,()=>{c.removeEventListener(JT,g),h=null}},createHref(x){return e(c,x)},createURL:b,encodeLocation(x){let y=b(x);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:_,replace:E,go(x){return l.go(x)}};return p}var eO;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(eO||(eO={}));function S$(n,e,t){t===void 0&&(t="/");let i=typeof e=="string"?P0(e):e,c=S8(i.pathname||"/",t);if(c==null)return null;let a=OI(n);E$(a);let l=null;for(let r=0;l==null&&r<a.length;++r)l=R$(a[r],j$(c));return l}function OI(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let c=(a,l,r)=>{let h={relativePath:r===void 0?a.path||"":r,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};h.relativePath.startsWith("/")&&(Mo(h.relativePath.startsWith(i),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(i.length));let m=sd([i,h.relativePath]),v=t.concat(h);a.children&&a.children.length>0&&(Mo(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),OI(a.children,e,v,m)),!(a.path==null&&!a.index)&&e.push({path:m,score:C$(m,a.index),routesMeta:v})};return n.forEach((a,l)=>{var r;if(a.path===""||!((r=a.path)!=null&&r.includes("?")))c(a,l);else for(let h of MI(a.path))c(a,l,h)}),e}function MI(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,c=t.endsWith("?"),a=t.replace(/\?$/,"");if(i.length===0)return c?[a,""]:[a];let l=MI(i.join("/")),r=[];return r.push(...l.map(h=>h===""?a:[a,h].join("/"))),c&&r.push(...l),r.map(h=>n.startsWith("/")&&h===""?"/":h)}function E$(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:I$(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const A$=/^:[\w-]+$/,k$=3,P$=2,T$=1,O$=10,M$=-2,tO=n=>n==="*";function C$(n,e){let t=n.split("/"),i=t.length;return t.some(tO)&&(i+=M$),e&&(i+=P$),t.filter(c=>!tO(c)).reduce((c,a)=>c+(A$.test(a)?k$:a===""?T$:O$),i)}function I$(n,e){return n.length===e.length&&n.slice(0,-1).every((i,c)=>i===e[c])?n[n.length-1]-e[e.length-1]:0}function R$(n,e){let{routesMeta:t}=n,i={},c="/",a=[];for(let l=0;l<t.length;++l){let r=t[l],h=l===t.length-1,m=c==="/"?e:e.slice(c.length)||"/",v=D$({path:r.relativePath,caseSensitive:r.caseSensitive,end:h},m);if(!v)return null;Object.assign(i,v.params);let g=r.route;a.push({params:i,pathname:sd([c,v.pathname]),pathnameBase:z$(sd([c,v.pathnameBase])),route:g}),v.pathnameBase!=="/"&&(c=sd([c,v.pathnameBase]))}return a}function D$(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=L$(n.path,n.caseSensitive,n.end),c=e.match(t);if(!c)return null;let a=c[0],l=a.replace(/(.)\/+$/,"$1"),r=c.slice(1);return{params:i.reduce((m,v,g)=>{let{paramName:_,isOptional:E}=v;if(_==="*"){let p=r[g]||"";l=a.slice(0,a.length-p.length).replace(/(.)\/+$/,"$1")}const b=r[g];return E&&!b?m[_]=void 0:m[_]=N$(b||"",_),m},{}),pathname:a,pathnameBase:l,pattern:n}}function L$(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),x8(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],c="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,r,h)=>(i.push({paramName:r,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),c+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?c+="\\/*$":n!==""&&n!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,e?void 0:"i"),i]}function j$(n){try{return decodeURI(n)}catch(e){return x8(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function N$(n,e){try{return decodeURIComponent(n)}catch(t){return x8(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),n}}function S8(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function $$(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:c=""}=typeof n=="string"?P0(n):n;return{pathname:t?t.startsWith("/")?t:B$(t,e):e,search:U$(i),hash:V$(c)}}function B$(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(c=>{c===".."?t.length>1&&t.pop():c!=="."&&t.push(c)}),t.length>1?t.join("/"):"/"}function RA(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function F$(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function E8(n,e){let t=F$(n);return e?t.map((i,c)=>c===n.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function A8(n,e,t,i){i===void 0&&(i=!1);let c;typeof n=="string"?c=P0(n):(c=Av({},n),Mo(!c.pathname||!c.pathname.includes("?"),RA("?","pathname","search",c)),Mo(!c.pathname||!c.pathname.includes("#"),RA("#","pathname","hash",c)),Mo(!c.search||!c.search.includes("#"),RA("#","search","hash",c)));let a=n===""||c.pathname==="",l=a?"/":c.pathname,r;if(l==null)r=t;else{let g=e.length-1;if(!i&&l.startsWith("..")){let _=l.split("/");for(;_[0]==="..";)_.shift(),g-=1;c.pathname=_.join("/")}r=g>=0?e[g]:"/"}let h=$$(c,r),m=l&&l!=="/"&&l.endsWith("/"),v=(a||l===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(m||v)&&(h.pathname+="/"),h}const sd=n=>n.join("/").replace(/\/\/+/g,"/"),z$=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),U$=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,V$=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function q$(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const CI=["post","put","patch","delete"];new Set(CI);const H$=["get",...CI];new Set(H$);/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function kv(){return kv=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},kv.apply(this,arguments)}const k8=Wt.createContext(null),W$=Wt.createContext(null),gd=Wt.createContext(null),QE=Wt.createContext(null),yd=Wt.createContext({outlet:null,matches:[],isDataRoute:!1}),II=Wt.createContext(null);function G$(n,e){let{relative:t}=e===void 0?{}:e;T0()||Mo(!1);let{basename:i,navigator:c}=Wt.useContext(gd),{hash:a,pathname:l,search:r}=DI(n,{relative:t}),h=l;return i!=="/"&&(h=l==="/"?i:sd([i,l])),c.createHref({pathname:h,search:r,hash:a})}function T0(){return Wt.useContext(QE)!=null}function K_(){return T0()||Mo(!1),Wt.useContext(QE).location}function RI(n){Wt.useContext(gd).static||Wt.useLayoutEffect(n)}function X_(){let{isDataRoute:n}=Wt.useContext(yd);return n?sB():K$()}function K$(){T0()||Mo(!1);let n=Wt.useContext(k8),{basename:e,future:t,navigator:i}=Wt.useContext(gd),{matches:c}=Wt.useContext(yd),{pathname:a}=K_(),l=JSON.stringify(E8(c,t.v7_relativeSplatPath)),r=Wt.useRef(!1);return RI(()=>{r.current=!0}),Wt.useCallback(function(m,v){if(v===void 0&&(v={}),!r.current)return;if(typeof m=="number"){i.go(m);return}let g=A8(m,JSON.parse(l),a,v.relative==="path");n==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:sd([e,g.pathname])),(v.replace?i.replace:i.push)(g,v.state,v)},[e,i,l,a,n])}function DI(n,e){let{relative:t}=e===void 0?{}:e,{future:i}=Wt.useContext(gd),{matches:c}=Wt.useContext(yd),{pathname:a}=K_(),l=JSON.stringify(E8(c,i.v7_relativeSplatPath));return Wt.useMemo(()=>A8(n,JSON.parse(l),a,t==="path"),[n,l,a,t])}function X$(n,e){return Z$(n,e)}function Z$(n,e,t,i){T0()||Mo(!1);let{navigator:c}=Wt.useContext(gd),{matches:a}=Wt.useContext(yd),l=a[a.length-1],r=l?l.params:{};l&&l.pathname;let h=l?l.pathnameBase:"/";l&&l.route;let m=K_(),v;if(e){var g;let x=typeof e=="string"?P0(e):e;h==="/"||(g=x.pathname)!=null&&g.startsWith(h)||Mo(!1),v=x}else v=m;let _=v.pathname||"/",E=h==="/"?_:_.slice(h.length)||"/",b=S$(n,{pathname:E}),p=tB(b&&b.map(x=>Object.assign({},x,{params:Object.assign({},r,x.params),pathname:sd([h,c.encodeLocation?c.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?h:sd([h,c.encodeLocation?c.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),a,t,i);return e&&p?Wt.createElement(QE.Provider,{value:{location:kv({pathname:"/",search:"",hash:"",state:null,key:"default"},v),navigationType:Yf.Pop}},p):p}function Y$(){let n=oB(),e=q$(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Wt.createElement(Wt.Fragment,null,Wt.createElement("h2",null,"Unexpected Application Error!"),Wt.createElement("h3",{style:{fontStyle:"italic"}},e),t?Wt.createElement("pre",{style:c},t):null,null)}const J$=Wt.createElement(Y$,null);class Q$ extends Wt.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?Wt.createElement(yd.Provider,{value:this.props.routeContext},Wt.createElement(II.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function eB(n){let{routeContext:e,match:t,children:i}=n,c=Wt.useContext(k8);return c&&c.static&&c.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=t.route.id),Wt.createElement(yd.Provider,{value:e},i)}function tB(n,e,t,i){var c;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var a;if((a=t)!=null&&a.errors)n=t.matches;else return null}let l=n,r=(c=t)==null?void 0:c.errors;if(r!=null){let v=l.findIndex(g=>g.route.id&&(r==null?void 0:r[g.route.id]));v>=0||Mo(!1),l=l.slice(0,Math.min(l.length,v+1))}let h=!1,m=-1;if(t&&i&&i.v7_partialHydration)for(let v=0;v<l.length;v++){let g=l[v];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(m=v),g.route.id){let{loaderData:_,errors:E}=t,b=g.route.loader&&_[g.route.id]===void 0&&(!E||E[g.route.id]===void 0);if(g.route.lazy||b){h=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}return l.reduceRight((v,g,_)=>{let E,b=!1,p=null,x=null;t&&(E=r&&g.route.id?r[g.route.id]:void 0,p=g.route.errorElement||J$,h&&(m<0&&_===0?(aB("route-fallback",!1),b=!0,x=null):m===_&&(b=!0,x=g.route.hydrateFallbackElement||null)));let y=e.concat(l.slice(0,_+1)),f=()=>{let w;return E?w=p:b?w=x:g.route.Component?w=Wt.createElement(g.route.Component,null):g.route.element?w=g.route.element:w=v,Wt.createElement(eB,{match:g,routeContext:{outlet:v,matches:y,isDataRoute:t!=null},children:w})};return t&&(g.route.ErrorBoundary||g.route.errorElement||_===0)?Wt.createElement(Q$,{location:t.location,revalidation:t.revalidation,component:p,error:E,children:f(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):f()},null)}var LI=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(LI||{}),I2=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(I2||{});function nB(n){let e=Wt.useContext(k8);return e||Mo(!1),e}function rB(n){let e=Wt.useContext(W$);return e||Mo(!1),e}function iB(n){let e=Wt.useContext(yd);return e||Mo(!1),e}function jI(n){let e=iB(),t=e.matches[e.matches.length-1];return t.route.id||Mo(!1),t.route.id}function oB(){var n;let e=Wt.useContext(II),t=rB(I2.UseRouteError),i=jI(I2.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function sB(){let{router:n}=nB(LI.UseNavigateStable),e=jI(I2.UseNavigateStable),t=Wt.useRef(!1);return RI(()=>{t.current=!0}),Wt.useCallback(function(c,a){a===void 0&&(a={}),t.current&&(typeof c=="number"?n.navigate(c):n.navigate(c,kv({fromRouteId:e},a)))},[n,e])}const nO={};function aB(n,e,t){!e&&!nO[n]&&(nO[n]=!0)}function ig(n){let{to:e,replace:t,state:i,relative:c}=n;T0()||Mo(!1);let{future:a,static:l}=Wt.useContext(gd),{matches:r}=Wt.useContext(yd),{pathname:h}=K_(),m=X_(),v=A8(e,E8(r,a.v7_relativeSplatPath),h,c==="path"),g=JSON.stringify(v);return Wt.useEffect(()=>m(JSON.parse(g),{replace:t,state:i,relative:c}),[m,g,c,t,i]),null}function Iu(n){Mo(!1)}function lB(n){let{basename:e="/",children:t=null,location:i,navigationType:c=Yf.Pop,navigator:a,static:l=!1,future:r}=n;T0()&&Mo(!1);let h=e.replace(/^\/*/,"/"),m=Wt.useMemo(()=>({basename:h,navigator:a,static:l,future:kv({v7_relativeSplatPath:!1},r)}),[h,r,a,l]);typeof i=="string"&&(i=P0(i));let{pathname:v="/",search:g="",hash:_="",state:E=null,key:b="default"}=i,p=Wt.useMemo(()=>{let x=S8(v,h);return x==null?null:{location:{pathname:x,search:g,hash:_,state:E,key:b},navigationType:c}},[h,v,g,_,E,b,c]);return p==null?null:Wt.createElement(gd.Provider,{value:m},Wt.createElement(QE.Provider,{children:t,value:p}))}function cB(n){let{children:e,location:t}=n;return X$(H6(e),t)}new Promise(()=>{});function H6(n,e){e===void 0&&(e=[]);let t=[];return Wt.Children.forEach(n,(i,c)=>{if(!Wt.isValidElement(i))return;let a=[...e,c];if(i.type===Wt.Fragment){t.push.apply(t,H6(i.props.children,a));return}i.type!==Iu&&Mo(!1),!i.props.index||!i.props.children||Mo(!1);let l={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=H6(i.props.children,a)),t.push(l)}),t}/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function W6(){return W6=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},W6.apply(this,arguments)}function uB(n,e){if(n==null)return{};var t={},i=Object.keys(n),c,a;for(a=0;a<i.length;a++)c=i[a],!(e.indexOf(c)>=0)&&(t[c]=n[c]);return t}function hB(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function fB(n,e){return n.button===0&&(!e||e==="_self")&&!hB(n)}const dB=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],pB="startTransition",rO=cj[pB];function mB(n){let{basename:e,children:t,future:i,window:c}=n,a=Wt.useRef();a.current==null&&(a.current=_$({window:c,v5Compat:!0}));let l=a.current,[r,h]=Wt.useState({action:l.action,location:l.location}),{v7_startTransition:m}=i||{},v=Wt.useCallback(g=>{m&&rO?rO(()=>h(g)):h(g)},[h,m]);return Wt.useLayoutEffect(()=>l.listen(v),[l,v]),Wt.createElement(lB,{basename:e,children:t,location:r.location,navigationType:r.action,navigator:l,future:i})}const gB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,NI=Wt.forwardRef(function(e,t){let{onClick:i,relative:c,reloadDocument:a,replace:l,state:r,target:h,to:m,preventScrollReset:v,unstable_viewTransition:g}=e,_=uB(e,dB),{basename:E}=Wt.useContext(gd),b,p=!1;if(typeof m=="string"&&yB.test(m)&&(b=m,gB))try{let w=new URL(window.location.href),A=m.startsWith("//")?new URL(w.protocol+m):new URL(m),P=S8(A.pathname,E);A.origin===w.origin&&P!=null?m=P+A.search+A.hash:p=!0}catch{}let x=G$(m,{relative:c}),y=bB(m,{replace:l,state:r,target:h,preventScrollReset:v,relative:c,unstable_viewTransition:g});function f(w){i&&i(w),w.defaultPrevented||y(w)}return Wt.createElement("a",W6({},_,{href:b||x,onClick:p||a?i:f,ref:t,target:h}))});var iO;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(iO||(iO={}));var oO;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(oO||(oO={}));function bB(n,e){let{target:t,replace:i,state:c,preventScrollReset:a,relative:l,unstable_viewTransition:r}=e===void 0?{}:e,h=X_(),m=K_(),v=DI(n,{relative:l});return Wt.useCallback(g=>{if(fB(g,t)){g.preventDefault();let _=i!==void 0?i:C2(m)===C2(v);h(n,{replace:_,state:c,preventScrollReset:a,relative:l,unstable_viewTransition:r})}},[m,h,v,i,c,t,n,a,l,r])}const vB="/assets/bgimage-NuihB1Nb.jpg",_B=()=>{const n=X_(),e=()=>{n("/login")};return Qe.jsxs("div",{className:"w-full",children:[Qe.jsx("nav",{className:"bg-gray-800 p-4 w-full fixed top-0 left-0",children:Qe.jsxs("div",{className:"w-full flex justify-between items-center px-6",children:[Qe.jsx("h1",{className:"text-5xl font-extrabold  tracking-wide uppercase bg-gradient-to-r from-red-500 to-green-400 text-transparent bg-clip-text",children:"Welcome To Print-On-The-Go"}),Qe.jsx("button",{onClick:e,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Login"})]})}),Qe.jsx("div",{className:"w-full h-[calc(100vh-4rem)] bg-cover bg-center mt-[4rem]",style:{backgroundImage:`url(${vB})`}})]})};let wB={data:""},xB=n=>typeof window=="object"?((n?n.querySelector("#_goober"):window._goober)||Object.assign((n||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:n||wB,SB=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,EB=/\/\*[^]*?\*\/|  +/g,sO=/\n+/g,of=(n,e)=>{let t="",i="",c="";for(let a in n){let l=n[a];a[0]=="@"?a[1]=="i"?t=a+" "+l+";":i+=a[1]=="f"?of(l,a):a+"{"+of(l,a[1]=="k"?"":e)+"}":typeof l=="object"?i+=of(l,e?e.replace(/([^,])+/g,r=>a.replace(/(^:.*)|([^,])+/g,h=>/&/.test(h)?h.replace(/&/g,r):r?r+" "+h:h)):a):l!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),c+=of.p?of.p(a,l):a+":"+l+";")}return t+(e&&c?e+"{"+c+"}":c)+i},Cu={},$I=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+$I(n[t]);return e}return n},AB=(n,e,t,i,c)=>{let a=$I(n),l=Cu[a]||(Cu[a]=(h=>{let m=0,v=11;for(;m<h.length;)v=101*v+h.charCodeAt(m++)>>>0;return"go"+v})(a));if(!Cu[l]){let h=a!==n?n:(m=>{let v,g,_=[{}];for(;v=SB.exec(m.replace(EB,""));)v[4]?_.shift():v[3]?(g=v[3].replace(sO," ").trim(),_.unshift(_[0][g]=_[0][g]||{})):_[0][v[1]]=v[2].replace(sO," ").trim();return _[0]})(n);Cu[l]=of(c?{["@keyframes "+l]:h}:h,t?"":"."+l)}let r=t&&Cu.g?Cu.g:null;return t&&(Cu.g=Cu[l]),((h,m,v,g)=>{g?m.data=m.data.replace(g,h):m.data.indexOf(h)===-1&&(m.data=v?h+m.data:m.data+h)})(Cu[l],e,i,r),l},kB=(n,e,t)=>n.reduce((i,c,a)=>{let l=e[a];if(l&&l.call){let r=l(t),h=r&&r.props&&r.props.className||/^go/.test(r)&&r;l=h?"."+h:r&&typeof r=="object"?r.props?"":of(r,""):r===!1?"":r}return i+c+(l??"")},"");function e3(n){let e=this||{},t=n.call?n(e.p):n;return AB(t.unshift?t.raw?kB(t,[].slice.call(arguments,1),e.p):t.reduce((i,c)=>Object.assign(i,c&&c.call?c(e.p):c),{}):t,xB(e.target),e.g,e.o,e.k)}let BI,G6,K6;e3.bind({g:1});let Eh=e3.bind({k:1});function PB(n,e,t,i){of.p=e,BI=n,G6=t,K6=i}function bd(n,e){let t=this||{};return function(){let i=arguments;function c(a,l){let r=Object.assign({},a),h=r.className||c.className;t.p=Object.assign({theme:G6&&G6()},r),t.o=/ *go\d+/.test(h),r.className=e3.apply(t,i)+(h?" "+h:""),e&&(r.ref=l);let m=n;return n[0]&&(m=r.as||n,delete r.as),K6&&m[0]&&K6(r),BI(m,r)}return e?e(c):c}}var TB=n=>typeof n=="function",R2=(n,e)=>TB(n)?n(e):n,OB=(()=>{let n=0;return()=>(++n).toString()})(),FI=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),MB=20,Sx=new Map,CB=1e3,aO=n=>{if(Sx.has(n))return;let e=setTimeout(()=>{Sx.delete(n),Em({type:4,toastId:n})},CB);Sx.set(n,e)},IB=n=>{let e=Sx.get(n);e&&clearTimeout(e)},X6=(n,e)=>{switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,MB)};case 1:return e.toast.id&&IB(e.toast.id),{...n,toasts:n.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:t}=e;return n.toasts.find(a=>a.id===t.id)?X6(n,{type:1,toast:t}):X6(n,{type:0,toast:t});case 3:let{toastId:i}=e;return i?aO(i):n.toasts.forEach(a=>{aO(a.id)}),{...n,toasts:n.toasts.map(a=>a.id===i||i===void 0?{...a,visible:!1}:a)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let c=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+c}))}}},Ex=[],Ax={toasts:[],pausedAt:void 0},Em=n=>{Ax=X6(Ax,n),Ex.forEach(e=>{e(Ax)})},RB={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},DB=(n={})=>{let[e,t]=Wt.useState(Ax);Wt.useEffect(()=>(Ex.push(t),()=>{let c=Ex.indexOf(t);c>-1&&Ex.splice(c,1)}),[e]);let i=e.toasts.map(c=>{var a,l;return{...n,...n[c.type],...c,duration:c.duration||((a=n[c.type])==null?void 0:a.duration)||(n==null?void 0:n.duration)||RB[c.type],style:{...n.style,...(l=n[c.type])==null?void 0:l.style,...c.style}}});return{...e,toasts:i}},LB=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||OB()}),Z_=n=>(e,t)=>{let i=LB(e,n,t);return Em({type:2,toast:i}),i.id},bl=(n,e)=>Z_("blank")(n,e);bl.error=Z_("error");bl.success=Z_("success");bl.loading=Z_("loading");bl.custom=Z_("custom");bl.dismiss=n=>{Em({type:3,toastId:n})};bl.remove=n=>Em({type:4,toastId:n});bl.promise=(n,e,t)=>{let i=bl.loading(e.loading,{...t,...t==null?void 0:t.loading});return n.then(c=>(bl.success(R2(e.success,c),{id:i,...t,...t==null?void 0:t.success}),c)).catch(c=>{bl.error(R2(e.error,c),{id:i,...t,...t==null?void 0:t.error})}),n};var jB=(n,e)=>{Em({type:1,toast:{id:n,height:e}})},NB=()=>{Em({type:5,time:Date.now()})},$B=n=>{let{toasts:e,pausedAt:t}=DB(n);Wt.useEffect(()=>{if(t)return;let a=Date.now(),l=e.map(r=>{if(r.duration===1/0)return;let h=(r.duration||0)+r.pauseDuration-(a-r.createdAt);if(h<0){r.visible&&bl.dismiss(r.id);return}return setTimeout(()=>bl.dismiss(r.id),h)});return()=>{l.forEach(r=>r&&clearTimeout(r))}},[e,t]);let i=Wt.useCallback(()=>{t&&Em({type:6,time:Date.now()})},[t]),c=Wt.useCallback((a,l)=>{let{reverseOrder:r=!1,gutter:h=8,defaultPosition:m}=l||{},v=e.filter(E=>(E.position||m)===(a.position||m)&&E.height),g=v.findIndex(E=>E.id===a.id),_=v.filter((E,b)=>b<g&&E.visible).length;return v.filter(E=>E.visible).slice(...r?[_+1]:[0,_]).reduce((E,b)=>E+(b.height||0)+h,0)},[e]);return{toasts:e,handlers:{updateHeight:jB,startPause:NB,endPause:i,calculateOffset:c}}},BB=Eh`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,FB=Eh`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,zB=Eh`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,UB=bd("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${BB} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${FB} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${zB} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,VB=Eh`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,qB=bd("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${VB} 1s linear infinite;
`,HB=Eh`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,WB=Eh`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,GB=bd("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${HB} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${WB} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,KB=bd("div")`
  position: absolute;
`,XB=bd("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,ZB=Eh`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,YB=bd("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${ZB} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,JB=({toast:n})=>{let{icon:e,type:t,iconTheme:i}=n;return e!==void 0?typeof e=="string"?Wt.createElement(YB,null,e):e:t==="blank"?null:Wt.createElement(XB,null,Wt.createElement(qB,{...i}),t!=="loading"&&Wt.createElement(KB,null,t==="error"?Wt.createElement(UB,{...i}):Wt.createElement(GB,{...i})))},QB=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,eF=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,tF="0%{opacity:0;} 100%{opacity:1;}",nF="0%{opacity:1;} 100%{opacity:0;}",rF=bd("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,iF=bd("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,oF=(n,e)=>{let t=n.includes("top")?1:-1,[i,c]=FI()?[tF,nF]:[QB(t),eF(t)];return{animation:e?`${Eh(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Eh(c)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},sF=Wt.memo(({toast:n,position:e,style:t,children:i})=>{let c=n.height?oF(n.position||e||"top-center",n.visible):{opacity:0},a=Wt.createElement(JB,{toast:n}),l=Wt.createElement(iF,{...n.ariaProps},R2(n.message,n));return Wt.createElement(rF,{className:n.className,style:{...c,...t,...n.style}},typeof i=="function"?i({icon:a,message:l}):Wt.createElement(Wt.Fragment,null,a,l))});PB(Wt.createElement);var aF=({id:n,className:e,style:t,onHeightUpdate:i,children:c})=>{let a=Wt.useCallback(l=>{if(l){let r=()=>{let h=l.getBoundingClientRect().height;i(n,h)};r(),new MutationObserver(r).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[n,i]);return Wt.createElement("div",{ref:a,className:e,style:t},c)},lF=(n,e)=>{let t=n.includes("top"),i=t?{top:0}:{bottom:0},c=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:FI()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...i,...c}},cF=e3`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Jw=16,uF=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:i,children:c,containerStyle:a,containerClassName:l})=>{let{toasts:r,handlers:h}=$B(t);return Wt.createElement("div",{style:{position:"fixed",zIndex:9999,top:Jw,left:Jw,right:Jw,bottom:Jw,pointerEvents:"none",...a},className:l,onMouseEnter:h.startPause,onMouseLeave:h.endPause},r.map(m=>{let v=m.position||e,g=h.calculateOffset(m,{reverseOrder:n,gutter:i,defaultPosition:e}),_=lF(v,g);return Wt.createElement(aF,{id:m.id,key:m.id,onHeightUpdate:h.updateHeight,className:m.visible?cF:"",style:_},m.type==="custom"?R2(m.message,m):c?c(m):Wt.createElement(sF,{toast:m,position:v}))}))},Hl=bl;const zI=Wt.createContext(),Th=()=>Wt.useContext(zI),hF=({children:n})=>{const[e,t]=Wt.useState(JSON.parse(localStorage.getItem("chat-user"))||null);return Qe.jsx(zI.Provider,{value:{authUser:e,setAuthUser:t},children:n})},fF=()=>{const[n,e]=Wt.useState(!1),{setAuthUser:t}=Th();return{loading:n,login:async(c,a)=>{if(dF(c,a)){e(!0);try{const h=await(await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:c,password:a})})).json();if(h.error)throw new Error(h.error);localStorage.setItem("chat-user",JSON.stringify(h)),t(h)}catch(r){Hl.error(r.message)}finally{e(!1)}}}}};function dF(n,e){return!n||!e?(Hl.error("Please fill in all fields"),!1):!0}const UI="/assets/loginImg-BChOrkYg.jpeg",pF=()=>{const[n,e]=Wt.useState(""),[t,i]=Wt.useState(""),{loading:c,login:a}=fF(),l=async r=>{r.preventDefault(),await a(n,t)};return Qe.jsx("div",{className:"min-h-screen w-full bg-cover bg-center flex items-center justify-center",style:{backgroundImage:`url(${UI})`,backgroungSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},children:Qe.jsx("div",{className:"flex flex-col items-center justify-center shadow-xl min-w-96 mx-auto",children:Qe.jsxs("div",{className:"w-full p-6 rounded-lg shadow-md bg-white border border-gray-300",children:[Qe.jsxs("h1",{className:"text-3xl font-semibold text-center text-gray-700",children:["Login",Qe.jsx("span",{className:"text-blue-500",children:" PrintOnGo"})]}),Qe.jsxs("form",{onSubmit:l,children:[Qe.jsxs("div",{children:[Qe.jsx("label",{className:"label p-2",children:Qe.jsx("span",{className:"text-base label-text text-gray-700",children:"Username"})}),Qe.jsx("input",{type:"text",placeholder:"Enter username",className:"w-full input input-bordered !bg-gray-100 h-10 border-gray-300",value:n,onChange:r=>e(r.target.value)})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{className:"label",children:Qe.jsx("span",{className:"text-base label-text  text-gray-700",children:"Password"})}),Qe.jsx("input",{type:"password",placeholder:"Enter Password",className:"w-full input input-bordered !bg-gray-100 h-10 border-gray-300",value:t,onChange:r=>i(r.target.value)})]}),Qe.jsxs(NI,{to:"/signup",className:"text-sm text-blue-600 hover:underline mt-2 inline-block",children:["Don't"," have an account?"]}),Qe.jsx("div",{children:Qe.jsx("button",{className:"btn btn-block btn-sm mt-2 bg-blue-500 text-white hover:bg-blue-600",disabled:c,children:c?Qe.jsx("span",{className:"loading loading-spinner "}):"Login"})})]})]})})})};var lO={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let c=n.charCodeAt(i);c<128?e[t++]=c:c<2048?(e[t++]=c>>6|192,e[t++]=c&63|128):(c&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(c=65536+((c&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=c>>18|240,e[t++]=c>>12&63|128,e[t++]=c>>6&63|128,e[t++]=c&63|128):(e[t++]=c>>12|224,e[t++]=c>>6&63|128,e[t++]=c&63|128)}return e},mF=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const c=n[t++];if(c<128)e[i++]=String.fromCharCode(c);else if(c>191&&c<224){const a=n[t++];e[i++]=String.fromCharCode((c&31)<<6|a&63)}else if(c>239&&c<365){const a=n[t++],l=n[t++],r=n[t++],h=((c&7)<<18|(a&63)<<12|(l&63)<<6|r&63)-65536;e[i++]=String.fromCharCode(55296+(h>>10)),e[i++]=String.fromCharCode(56320+(h&1023))}else{const a=n[t++],l=n[t++];e[i++]=String.fromCharCode((c&15)<<12|(a&63)<<6|l&63)}}return e.join("")},qI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let c=0;c<n.length;c+=3){const a=n[c],l=c+1<n.length,r=l?n[c+1]:0,h=c+2<n.length,m=h?n[c+2]:0,v=a>>2,g=(a&3)<<4|r>>4;let _=(r&15)<<2|m>>6,E=m&63;h||(E=64,l||(_=64)),i.push(t[v],t[g],t[_],t[E])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(VI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mF(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let c=0;c<n.length;){const a=t[n.charAt(c++)],r=c<n.length?t[n.charAt(c)]:0;++c;const m=c<n.length?t[n.charAt(c)]:64;++c;const g=c<n.length?t[n.charAt(c)]:64;if(++c,a==null||r==null||m==null||g==null)throw new gF;const _=a<<2|r>>4;if(i.push(_),m!==64){const E=r<<4&240|m>>2;if(i.push(E),g!==64){const b=m<<6&192|g;i.push(b)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class gF extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yF=function(n){const e=VI(n);return qI.encodeByteArray(e,!0)},D2=function(n){return yF(n).replace(/\./g,"")},bF=function(n){try{return qI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F=()=>vF().__FIREBASE_DEFAULTS__,wF=()=>{if(typeof process>"u"||typeof lO>"u")return;const n=lO.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},xF=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&bF(n[1]);return e&&JSON.parse(e)},HI=()=>{try{return _F()||wF()||xF()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},SF=n=>{var e,t;return(t=(e=HI())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},EF=n=>{const e=SF(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},WI=()=>{var n;return(n=HI())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",c=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:c,exp:c+3600,auth_time:c,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[D2(JSON.stringify(t)),D2(JSON.stringify(l)),""].join(".")}function PF(){try{return typeof indexedDB=="object"}catch{return!1}}function TF(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",c=self.indexedDB.open(i);c.onsuccess=()=>{c.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},c.onupgradeneeded=()=>{t=!1},c.onerror=()=>{var a;e(((a=c.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF="FirebaseError";class O0 extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=OF,Object.setPrototypeOf(this,O0.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,GI.prototype.create)}}class GI{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},c=`${this.service}/${e}`,a=this.errors[e],l=a?MF(a,i):"Error",r=`${this.serviceName}: ${l} (${c}).`;return new O0(c,r,i)}}function MF(n,e){return n.replace(CF,(t,i)=>{const c=e[i];return c!=null?String(c):`<${i}?>`})}const CF=/\{\$([^}]+)}/g;function Z6(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const c of t){if(!i.includes(c))return!1;const a=n[c],l=e[c];if(cO(a)&&cO(l)){if(!Z6(a,l))return!1}else if(a!==l)return!1}for(const c of i)if(!t.includes(c))return!1;return!0}function cO(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(n){return n&&n._delegate?n._delegate:n}class Pv{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new AF;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const c=this.getOrInitializeService({instanceIdentifier:t});c&&i.resolve(c)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),c=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(a){if(c)return null;throw a}else{if(c)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(DF(e))try{this.getOrInitializeService({instanceIdentifier:Ld})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:c});i.resolve(a)}catch{}}}}clearInstance(e=Ld){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ld){return this.instances.has(e)}getOptions(e=Ld){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const c=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,l]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(a);i===r&&l.resolve(c)}return c}onInit(e,t){var i;const c=this.normalizeInstanceIdentifier(t),a=(i=this.onInitCallbacks.get(c))!==null&&i!==void 0?i:new Set;a.add(e),this.onInitCallbacks.set(c,a);const l=this.instances.get(c);return l&&e(l,c),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const c of i)try{c(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:RF(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ld){return this.component?this.component.multipleInstances?e:Ld:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function RF(n){return n===Ld?void 0:n}function DF(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new IF(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ji;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ji||(Ji={}));const jF={debug:Ji.DEBUG,verbose:Ji.VERBOSE,info:Ji.INFO,warn:Ji.WARN,error:Ji.ERROR,silent:Ji.SILENT},NF=Ji.INFO,$F={[Ji.DEBUG]:"log",[Ji.VERBOSE]:"log",[Ji.INFO]:"info",[Ji.WARN]:"warn",[Ji.ERROR]:"error"},BF=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),c=$F[e];if(c)console[c](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class FF{constructor(e){this.name=e,this._logLevel=NF,this._logHandler=BF,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ji))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ji.DEBUG,...e),this._logHandler(this,Ji.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ji.VERBOSE,...e),this._logHandler(this,Ji.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ji.INFO,...e),this._logHandler(this,Ji.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ji.WARN,...e),this._logHandler(this,Ji.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ji.ERROR,...e),this._logHandler(this,Ji.ERROR,...e)}}const zF=(n,e)=>e.some(t=>n instanceof t);let uO,hO;function UF(){return uO||(uO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function VF(){return hO||(hO=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const KI=new WeakMap,Y6=new WeakMap,XI=new WeakMap,DA=new WeakMap,P8=new WeakMap;function qF(n){const e=new Promise((t,i)=>{const c=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(ad(n.result)),c()},l=()=>{i(n.error),c()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&KI.set(t,n)}).catch(()=>{}),P8.set(e,n),e}function HF(n){if(Y6.has(n))return;const e=new Promise((t,i)=>{const c=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),c()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),c()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Y6.set(n,e)}let J6={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Y6.get(n);if(e==="objectStoreNames")return n.objectStoreNames||XI.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ad(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function WF(n){J6=n(J6)}function GF(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(LA(this),e,...t);return XI.set(i,e.sort?e.sort():[e]),ad(i)}:VF().includes(n)?function(...e){return n.apply(LA(this),e),ad(KI.get(this))}:function(...e){return ad(n.apply(LA(this),e))}}function KF(n){return typeof n=="function"?GF(n):(n instanceof IDBTransaction&&HF(n),zF(n,UF())?new Proxy(n,J6):n)}function ad(n){if(n instanceof IDBRequest)return qF(n);if(DA.has(n))return DA.get(n);const e=KF(n);return e!==n&&(DA.set(n,e),P8.set(e,n)),e}const LA=n=>P8.get(n);function XF(n,e,{blocked:t,upgrade:i,blocking:c,terminated:a}={}){const l=indexedDB.open(n,e),r=ad(l);return i&&l.addEventListener("upgradeneeded",h=>{i(ad(l.result),h.oldVersion,h.newVersion,ad(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),r.then(h=>{a&&h.addEventListener("close",()=>a()),c&&h.addEventListener("versionchange",m=>c(m.oldVersion,m.newVersion,m))}).catch(()=>{}),r}const ZF=["get","getKey","getAll","getAllKeys","count"],YF=["put","add","delete","clear"],jA=new Map;function fO(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(jA.get(e))return jA.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,c=YF.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(c||ZF.includes(t)))return;const a=async function(l,...r){const h=this.transaction(l,c?"readwrite":"readonly");let m=h.store;return i&&(m=m.index(r.shift())),(await Promise.all([m[t](...r),c&&h.done]))[0]};return jA.set(e,a),a}WF(n=>({...n,get:(e,t,i)=>fO(e,t)||n.get(e,t,i),has:(e,t)=>!!fO(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(QF(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function QF(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Q6="@firebase/app",dO="0.10.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new FF("@firebase/app"),ez="@firebase/app-compat",tz="@firebase/analytics-compat",nz="@firebase/analytics",rz="@firebase/app-check-compat",iz="@firebase/app-check",oz="@firebase/auth",sz="@firebase/auth-compat",az="@firebase/database",lz="@firebase/data-connect",cz="@firebase/database-compat",uz="@firebase/functions",hz="@firebase/functions-compat",fz="@firebase/installations",dz="@firebase/installations-compat",pz="@firebase/messaging",mz="@firebase/messaging-compat",gz="@firebase/performance",yz="@firebase/performance-compat",bz="@firebase/remote-config",vz="@firebase/remote-config-compat",_z="@firebase/storage",wz="@firebase/storage-compat",xz="@firebase/firestore",Sz="@firebase/vertexai",Ez="@firebase/firestore-compat",Az="firebase",kz="11.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4="[DEFAULT]",Pz={[Q6]:"fire-core",[ez]:"fire-core-compat",[nz]:"fire-analytics",[tz]:"fire-analytics-compat",[iz]:"fire-app-check",[rz]:"fire-app-check-compat",[oz]:"fire-auth",[sz]:"fire-auth-compat",[az]:"fire-rtdb",[lz]:"fire-data-connect",[cz]:"fire-rtdb-compat",[uz]:"fire-fn",[hz]:"fire-fn-compat",[fz]:"fire-iid",[dz]:"fire-iid-compat",[pz]:"fire-fcm",[mz]:"fire-fcm-compat",[gz]:"fire-perf",[yz]:"fire-perf-compat",[bz]:"fire-rc",[vz]:"fire-rc-compat",[_z]:"fire-gcs",[wz]:"fire-gcs-compat",[xz]:"fire-fst",[Ez]:"fire-fst-compat",[Sz]:"fire-vertex","fire-js":"fire-js",[Az]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=new Map,Tz=new Map,t4=new Map;function pO(n,e){try{n.container.addComponent(e)}catch(t){Ah.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function j2(n){const e=n.name;if(t4.has(e))return Ah.debug(`There were multiple attempts to register component ${e}.`),!1;t4.set(e,n);for(const t of L2.values())pO(t,n);for(const t of Tz.values())pO(t,n);return!0}function Oz(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ld=new GI("app","Firebase",Mz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Pv("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ld.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iz=kz;function ZI(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:e4,automaticDataCollectionEnabled:!1},e),c=i.name;if(typeof c!="string"||!c)throw ld.create("bad-app-name",{appName:String(c)});if(t||(t=WI()),!t)throw ld.create("no-options");const a=L2.get(c);if(a){if(Z6(t,a.options)&&Z6(i,a.config))return a;throw ld.create("duplicate-app",{appName:c})}const l=new LF(c);for(const h of t4.values())l.addComponent(h);const r=new Cz(t,i,l);return L2.set(c,r),r}function Rz(n=e4){const e=L2.get(n);if(!e&&n===e4&&WI())return ZI();if(!e)throw ld.create("no-app",{appName:n});return e}function Dg(n,e,t){var i;let c=(i=Pz[n])!==null&&i!==void 0?i:n;t&&(c+=`-${t}`);const a=c.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const r=[`Unable to register library "${c}" with version "${e}":`];a&&r.push(`library name "${c}" contains illegal characters (whitespace or "/")`),a&&l&&r.push("and"),l&&r.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ah.warn(r.join(" "));return}j2(new Pv(`${c}-version`,()=>({library:c,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dz="firebase-heartbeat-database",Lz=1,Tv="firebase-heartbeat-store";let NA=null;function YI(){return NA||(NA=XF(Dz,Lz,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Tv)}catch(t){console.warn(t)}}}}).catch(n=>{throw ld.create("idb-open",{originalErrorMessage:n.message})})),NA}async function jz(n){try{const t=(await YI()).transaction(Tv),i=await t.objectStore(Tv).get(JI(n));return await t.done,i}catch(e){if(e instanceof O0)Ah.warn(e.message);else{const t=ld.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ah.warn(t.message)}}}async function mO(n,e){try{const i=(await YI()).transaction(Tv,"readwrite");await i.objectStore(Tv).put(e,JI(n)),await i.done}catch(t){if(t instanceof O0)Ah.warn(t.message);else{const i=ld.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ah.warn(i.message)}}}function JI(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz=1024,$z=30*24*60*60*1e3;class Bz{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new zz(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=gO();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:c}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(l=>{const r=new Date(l.date).valueOf();return Date.now()-r<=$z}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Ah.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=gO(),{heartbeatsToSend:i,unsentEntries:c}=Fz(this._heartbeatsCache.heartbeats),a=D2(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Ah.warn(t),""}}}function gO(){return new Date().toISOString().substring(0,10)}function Fz(n,e=Nz){const t=[];let i=n.slice();for(const c of n){const a=t.find(l=>l.agent===c.agent);if(a){if(a.dates.push(c.date),yO(t)>e){a.dates.pop();break}}else if(t.push({agent:c.agent,dates:[c.date]}),yO(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class zz{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PF()?TF().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await jz(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const c=await this.read();return mO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:c.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const c=await this.read();return mO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:c.lastSentHeartbeatDate,heartbeats:[...c.heartbeats,...e.heartbeats]})}else return}}function yO(n){return D2(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(n){j2(new Pv("platform-logger",e=>new JF(e),"PRIVATE")),j2(new Pv("heartbeat",e=>new Bz(e),"PRIVATE")),Dg(Q6,dO,n),Dg(Q6,dO,"esm2017"),Dg("fire-js","")}Uz("");var Vz="firebase",qz="11.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dg(Vz,qz,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI="firebasestorage.googleapis.com",eR="storageBucket",Hz=2*60*1e3,Wz=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo extends O0{constructor(e,t,i=0){super($A(e),`Firebase Storage: ${t} (${$A(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Eo.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return $A(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var So;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(So||(So={}));function $A(n){return"storage/"+n}function T8(){const n="An unknown error occurred, please check the error payload for server response.";return new Eo(So.UNKNOWN,n)}function Gz(n){return new Eo(So.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Kz(n){return new Eo(So.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Xz(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Eo(So.UNAUTHENTICATED,n)}function Zz(){return new Eo(So.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Yz(n){return new Eo(So.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Jz(){return new Eo(So.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Qz(){return new Eo(So.CANCELED,"User canceled the upload/download.")}function eU(n){return new Eo(So.INVALID_URL,"Invalid URL '"+n+"'.")}function tU(n){return new Eo(So.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function nU(){return new Eo(So.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+eR+"' property when initializing the app?")}function rU(){return new Eo(So.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function iU(){return new Eo(So.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function oU(n){return new Eo(So.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function n4(n){return new Eo(So.INVALID_ARGUMENT,n)}function tR(){return new Eo(So.APP_DELETED,"The Firebase app was deleted.")}function sU(n){return new Eo(So.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function sv(n,e){return new Eo(So.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Sb(n){throw new Eo(So.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=vl.makeFromUrl(e,t)}catch{return new vl(e,"")}if(i.path==="")return i;throw tU(e)}static makeFromUrl(e,t){let i=null;const c="([A-Za-z0-9.\\-_]+)";function a(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const l="(/(.*))?$",r=new RegExp("^gs://"+c+l,"i"),h={bucket:1,path:3};function m(A){A.path_=decodeURIComponent(A.path)}const v="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",E=new RegExp(`^https?://${g}/${v}/b/${c}/o${_}`,"i"),b={bucket:1,path:3},p=t===QI?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",y=new RegExp(`^https?://${p}/${c}/${x}`,"i"),w=[{regex:r,indices:h,postModify:a},{regex:E,indices:b,postModify:m},{regex:y,indices:{bucket:1,path:2},postModify:m}];for(let A=0;A<w.length;A++){const P=w[A],T=P.regex.exec(e);if(T){const R=T[P.indices.bucket];let M=T[P.indices.path];M||(M=""),i=new vl(R,M),P.postModify(i);break}}if(i==null)throw eU(e);return i}}class aU{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lU(n,e,t){let i=1,c=null,a=null,l=!1,r=0;function h(){return r===2}let m=!1;function v(...x){m||(m=!0,e.apply(null,x))}function g(x){c=setTimeout(()=>{c=null,n(E,h())},x)}function _(){a&&clearTimeout(a)}function E(x,...y){if(m){_();return}if(x){_(),v.call(null,x,...y);return}if(h()||l){_(),v.call(null,x,...y);return}i<64&&(i*=2);let w;r===1?(r=2,w=0):w=(i+Math.random())*1e3,g(w)}let b=!1;function p(x){b||(b=!0,_(),!m&&(c!==null?(x||(r=2),clearTimeout(c),g(0)):x||(r=1)))}return g(0),a=setTimeout(()=>{l=!0,p(!0)},t),p}function cU(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uU(n){return n!==void 0}function hU(n){return typeof n=="object"&&!Array.isArray(n)}function O8(n){return typeof n=="string"||n instanceof String}function bO(n){return M8()&&n instanceof Blob}function M8(){return typeof Blob<"u"}function vO(n,e,t,i){if(i<e)throw n4(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw n4(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function nR(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const c=e(i)+"="+e(n[i]);t=t+c+"&"}return t=t.slice(0,-1),t}var fm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(fm||(fm={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fU(n,e){const t=n>=500&&n<600,c=[408,429].indexOf(n)!==-1,a=e.indexOf(n)!==-1;return t||c||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(e,t,i,c,a,l,r,h,m,v,g,_=!0){this.url_=e,this.method_=t,this.headers_=i,this.body_=c,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=r,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=v,this.connectionFactory_=g,this.retry=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((E,b)=>{this.resolve_=E,this.reject_=b,this.start_()})}start_(){const e=(i,c)=>{if(c){i(!1,new Qw(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=r=>{const h=r.loaded,m=r.lengthComputable?r.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,m)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const r=a.getErrorCode()===fm.NO_ERROR,h=a.getStatus();if(!r||fU(h,this.additionalRetryCodes_)&&this.retry){const v=a.getErrorCode()===fm.ABORT;i(!1,new Qw(!1,null,v));return}const m=this.successCodes_.indexOf(h)!==-1;i(!0,new Qw(m,a))})},t=(i,c)=>{const a=this.resolve_,l=this.reject_,r=c.connection;if(c.wasSuccessCode)try{const h=this.callback_(r,r.getResponse());uU(h)?a(h):a()}catch(h){l(h)}else if(r!==null){const h=T8();h.serverResponse=r.getErrorText(),this.errorCallback_?l(this.errorCallback_(r,h)):l(h)}else if(c.canceled){const h=this.appDelete_?tR():Qz();l(h)}else{const h=Jz();l(h)}};this.canceled_?t(!1,new Qw(!1,null,!0)):this.backoffId_=lU(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&cU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Qw{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function pU(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function mU(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function gU(n,e){e&&(n["X-Firebase-GMPID"]=e)}function yU(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function bU(n,e,t,i,c,a,l=!0){const r=nR(n.urlParams),h=n.url+r,m=Object.assign({},n.headers);return gU(m,e),pU(m,t),mU(m,a),yU(m,i),new dU(h,n.method,m,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,c,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vU(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function _U(...n){const e=vU();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(M8())return new Blob(n);throw new Eo(So.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function wU(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xU(n){if(typeof atob>"u")throw oU("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class BA{constructor(e,t){this.data=e,this.contentType=t||null}}function SU(n,e){switch(n){case au.RAW:return new BA(rR(e));case au.BASE64:case au.BASE64URL:return new BA(iR(n,e));case au.DATA_URL:return new BA(AU(e),kU(e))}throw T8()}function rR(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const a=i,l=n.charCodeAt(++t);i=65536|(a&1023)<<10|l&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function EU(n){let e;try{e=decodeURIComponent(n)}catch{throw sv(au.DATA_URL,"Malformed data URL.")}return rR(e)}function iR(n,e){switch(n){case au.BASE64:{const c=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(c||a)throw sv(n,"Invalid character '"+(c?"-":"_")+"' found: is it base64url encoded?");break}case au.BASE64URL:{const c=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(c||a)throw sv(n,"Invalid character '"+(c?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=xU(e)}catch(c){throw c.message.includes("polyfill")?c:sv(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let c=0;c<t.length;c++)i[c]=t.charCodeAt(c);return i}class oR{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw sv(au.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=PU(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function AU(n){const e=new oR(n);return e.base64?iR(au.BASE64,e.rest):EU(e.rest)}function kU(n){return new oR(n).contentType}function PU(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,t){let i=0,c="";bO(e)?(this.data_=e,i=e.size,c=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=c}size(){return this.size_}type(){return this.type_}slice(e,t){if(bO(this.data_)){const i=this.data_,c=wU(i,e,t);return c===null?null:new sf(c)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new sf(i,!0)}}static getBlob(...e){if(M8()){const t=e.map(i=>i instanceof sf?i.data_:i);return new sf(_U.apply(null,t))}else{const t=e.map(l=>O8(l)?SU(au.RAW,l).data:l.data_);let i=0;t.forEach(l=>{i+=l.byteLength});const c=new Uint8Array(i);let a=0;return t.forEach(l=>{for(let r=0;r<l.length;r++)c[a++]=l[r]}),new sf(c,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sR(n){let e;try{e=JSON.parse(n)}catch{return null}return hU(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function OU(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function aR(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MU(n,e){return e}class pa{constructor(e,t,i,c){this.server=e,this.local=t||e,this.writable=!!i,this.xform=c||MU}}let ex=null;function CU(n){return!O8(n)||n.length<2?n:aR(n)}function lR(){if(ex)return ex;const n=[];n.push(new pa("bucket")),n.push(new pa("generation")),n.push(new pa("metageneration")),n.push(new pa("name","fullPath",!0));function e(a,l){return CU(l)}const t=new pa("name");t.xform=e,n.push(t);function i(a,l){return l!==void 0?Number(l):l}const c=new pa("size");return c.xform=i,n.push(c),n.push(new pa("timeCreated")),n.push(new pa("updated")),n.push(new pa("md5Hash",null,!0)),n.push(new pa("cacheControl",null,!0)),n.push(new pa("contentDisposition",null,!0)),n.push(new pa("contentEncoding",null,!0)),n.push(new pa("contentLanguage",null,!0)),n.push(new pa("contentType",null,!0)),n.push(new pa("metadata","customMetadata",!0)),ex=n,ex}function IU(n,e){function t(){const i=n.bucket,c=n.fullPath,a=new vl(i,c);return e._makeStorageReference(a)}Object.defineProperty(n,"ref",{get:t})}function RU(n,e,t){const i={};i.type="file";const c=t.length;for(let a=0;a<c;a++){const l=t[a];i[l.local]=l.xform(i,e[l.server])}return IU(i,n),i}function cR(n,e,t){const i=sR(e);return i===null?null:RU(n,i,t)}function DU(n,e,t,i){const c=sR(e);if(c===null||!O8(c.downloadTokens))return null;const a=c.downloadTokens;if(a.length===0)return null;const l=encodeURIComponent;return a.split(",").map(m=>{const v=n.bucket,g=n.fullPath,_="/b/"+l(v)+"/o/"+l(g),E=t3(_,t,i),b=nR({alt:"media",token:m});return E+b})[0]}function LU(n,e){const t={},i=e.length;for(let c=0;c<i;c++){const a=e[c];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}class C8{constructor(e,t,i,c){this.url=e,this.method=t,this.handler=i,this.timeout=c,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(n){if(!n)throw T8()}function jU(n,e){function t(i,c){const a=cR(n,c,e);return uR(a!==null),a}return t}function NU(n,e){function t(i,c){const a=cR(n,c,e);return uR(a!==null),DU(a,c,n.host,n._protocol)}return t}function hR(n){function e(t,i){let c;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?c=Zz():c=Xz():t.getStatus()===402?c=Kz(n.bucket):t.getStatus()===403?c=Yz(n.path):c=i,c.status=t.getStatus(),c.serverResponse=i.serverResponse,c}return e}function fR(n){const e=hR(n);function t(i,c){let a=e(i,c);return i.getStatus()===404&&(a=Gz(n.path)),a.serverResponse=c.serverResponse,a}return t}function $U(n,e,t){const i=e.fullServerUrl(),c=t3(i,n.host,n._protocol),a="GET",l=n.maxOperationRetryTime,r=new C8(c,a,NU(n,t),l);return r.errorHandler=fR(e),r}function BU(n,e){const t=e.fullServerUrl(),i=t3(t,n.host,n._protocol),c="DELETE",a=n.maxOperationRetryTime;function l(h,m){}const r=new C8(i,c,l,a);return r.successCodes=[200,204],r.errorHandler=fR(e),r}function FU(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function zU(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=FU(null,e)),i}function UU(n,e,t,i,c){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function r(){let w="";for(let A=0;A<2;A++)w=w+Math.random().toString().slice(2);return w}const h=r();l["Content-Type"]="multipart/related; boundary="+h;const m=zU(e,i,c),v=LU(m,t),g="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+v+`\r
--`+h+`\r
Content-Type: `+m.contentType+`\r
\r
`,_=`\r
--`+h+"--",E=sf.getBlob(g,i,_);if(E===null)throw rU();const b={name:m.fullPath},p=t3(a,n.host,n._protocol),x="POST",y=n.maxUploadRetryTime,f=new C8(p,x,jU(n,t),y);return f.urlParams=b,f.headers=l,f.body=E.uploadData(),f.errorHandler=hR(e),f}class VU{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fm.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=fm.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=fm.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,c){if(this.sent_)throw Sb("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const a in c)c.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,c[a].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sb("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sb("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sb("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sb("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class qU extends VU{initXhr(){this.xhr_.responseType="text"}}function I8(){return new qU}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e,t){this._service=e,t instanceof vl?this._location=t:this._location=vl.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new bm(e,t)}get root(){const e=new vl(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return aR(this._location.path)}get storage(){return this._service}get parent(){const e=TU(this._location.path);if(e===null)return null;const t=new vl(this._location.bucket,e);return new bm(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw sU(e)}}function HU(n,e,t){n._throwIfRoot("uploadBytes");const i=UU(n.storage,n._location,lR(),new sf(e,!0),t);return n.storage.makeRequestWithTokens(i,I8).then(c=>({metadata:c,ref:n}))}function WU(n){n._throwIfRoot("getDownloadURL");const e=$U(n.storage,n._location,lR());return n.storage.makeRequestWithTokens(e,I8).then(t=>{if(t===null)throw iU();return t})}function GU(n){n._throwIfRoot("deleteObject");const e=BU(n.storage,n._location);return n.storage.makeRequestWithTokens(e,I8)}function KU(n,e){const t=OU(n._location.path,e),i=new vl(n._location.bucket,t);return new bm(n.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XU(n){return/^[A-Za-z]+:\/\//.test(n)}function ZU(n,e){return new bm(n,e)}function dR(n,e){if(n instanceof R8){const t=n;if(t._bucket==null)throw nU();const i=new bm(t,t._bucket);return e!=null?dR(i,e):i}else return e!==void 0?KU(n,e):n}function YU(n,e){if(e&&XU(e)){if(n instanceof R8)return ZU(n,e);throw n4("To use ref(service, url), the first argument must be a Storage instance.")}else return dR(n,e)}function _O(n,e){const t=e==null?void 0:e[eR];return t==null?null:vl.makeFromBucketSpec(t,n)}function JU(n,e,t,i={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:c}=i;c&&(n._overrideAuthToken=typeof c=="string"?c:kF(c,n.app.options.projectId))}class R8{constructor(e,t,i,c,a){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=c,this._firebaseVersion=a,this._bucket=null,this._host=QI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Hz,this._maxUploadRetryTime=Wz,this._requests=new Set,c!=null?this._bucket=vl.makeFromBucketSpec(c,this._host):this._bucket=_O(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=vl.makeFromBucketSpec(this._url,e):this._bucket=_O(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){vO("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){vO("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new bm(this,e)}_makeRequest(e,t,i,c,a=!0){if(this._deleted)return new aU(tR());{const l=bU(e,this._appId,i,c,t,this._firebaseVersion,a);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[i,c]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,c).getPromise()}}const wO="@firebase/storage",xO="0.13.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR="storage";function mR(n,e,t){return n=Y_(n),HU(n,e,t)}function gR(n){return n=Y_(n),WU(n)}function QU(n){return n=Y_(n),GU(n)}function D8(n,e){return n=Y_(n),YU(n,e)}function eV(n=Rz(),e){n=Y_(n);const i=Oz(n,pR).getImmediate({identifier:e}),c=EF("storage");return c&&tV(i,...c),i}function tV(n,e,t,i={}){JU(n,e,t,i)}function nV(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),c=n.getProvider("app-check-internal");return new R8(t,i,c,e,Iz)}function rV(){j2(new Pv(pR,nV,"PUBLIC").setMultipleInstances(!0)),Dg(wO,xO,""),Dg(wO,xO,"esm2017")}rV();const iV={apiKey:"AIzaSyCN-j--c24WDwOj7E-BPlq7KnYBSKQEYkg",authDomain:"college-management-19336.firebaseapp.com",projectId:"college-management-19336",storageBucket:"college-management-19336.appspot.com",messagingSenderId:"793585418128",appId:"1:793585418128:web:97cac6ff6593e3a7c7bd15"},oV=ZI(iV),L8=eV(oV),Ms=[];for(let n=0;n<256;++n)Ms.push((n+256).toString(16).slice(1));function sV(n,e=0){return(Ms[n[e+0]]+Ms[n[e+1]]+Ms[n[e+2]]+Ms[n[e+3]]+"-"+Ms[n[e+4]]+Ms[n[e+5]]+"-"+Ms[n[e+6]]+Ms[n[e+7]]+"-"+Ms[n[e+8]]+Ms[n[e+9]]+"-"+Ms[n[e+10]]+Ms[n[e+11]]+Ms[n[e+12]]+Ms[n[e+13]]+Ms[n[e+14]]+Ms[n[e+15]]).toLowerCase()}let FA;const aV=new Uint8Array(16);function lV(){if(!FA){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");FA=crypto.getRandomValues.bind(crypto)}return FA(aV)}const cV=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),SO={randomUUID:cV};function yR(n,e,t){if(SO.randomUUID&&!e&&!n)return SO.randomUUID();n=n||{};const i=n.random||(n.rng||lV)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(let c=0;c<16;++c)e[t+c]=i[c];return e}return sV(i)}const uV=()=>{const[n,e]=Wt.useState(!1),{setAuthUser:t}=Th();return{loading:n,signup:async({fullName:c,username:a,password:l,confirmPassword:r,role:h,profilePic:m,latitude:v,longitude:g,address:_})=>{if(hV({fullName:c,username:a,password:l,confirmPassword:r,role:h,profilePic:m,latitude:v,longitude:g,address:_})){e(!0);try{const p=await(await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:c,username:a,password:l,confirmPassword:r,role:h,profilePic:m,latitude:v,longitude:g,address:_})})).json();if(p.error)throw new Error(p.error);localStorage.setItem("chat-user",JSON.stringify(p)),t(p)}catch(b){Hl.error(b.message)}finally{e(!1)}}}}};function hV({fullName:n,username:e,password:t,confirmPassword:i}){return!n||!e||!t||!i?(Hl.error("Please fill in all fields"),!1):t!==i?(Hl.error("Passwords do not match"),!1):t.length<6?(Hl.error("Password must be at least 6 characters"),!1):!0}function fV(n,c){var t,i,c=(c=c===void 0?{}:c).insertAt;n&&typeof document<"u"&&(t=document.head||document.getElementsByTagName("head")[0],(i=document.createElement("style")).type="text/css",c==="top"&&t.firstChild?t.insertBefore(i,t.firstChild):t.appendChild(i),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n)))}var dV=".autocomplete{color:#474d43;display:flex;flex-direction:column;width:25.5rem}.autocomplete .autocomplete-form{align-items:center;background-color:#fff;border-radius:5px;box-shadow:0 2px 5px -1px rgba(50,50,93,.25),0 1px 3px -1px rgba(0,0,0,.3);display:flex;padding:.25rem .5rem;transition:box-shadow .3s cubic-bezier(.4,0,.2,1) 0ms}.autocomplete .autocomplete-input-wrapper{cursor:text;flex:1;font-size:1rem;font-weight:400;margin-left:.5rem}.autocomplete .autocomplete-input-wrapper input{border:0;color:inherit;font:inherit;height:1.4375em;padding-bottom:5px;padding-top:4px;width:100%}.autocomplete .autocomplete-input-wrapper input:focus{outline:0}.autocomplete .autocomplete-divider{border-color:#959d99;border-width:0 thin 0 0;height:2em;margin:.25rem}.autocomplete .autocomplete-button{background-color:transparent;border:0;border-radius:50%;color:#959d99;cursor:pointer;display:inline-flex;font-size:1.5rem;padding:.625rem;transition:background-color .15s cubic-bezier(.4,0,.2,1) 0ms}.autocomplete .autocomplete-button:hover{background-color:rgba(0,0,0,.1)}.autocomplete .autocomplete-button svg{fill:currentColor;height:1em;width:1em}.autocomplete .autocomplete-list-wrapper{background-color:#fff;border-radius:4px;box-shadow:0 2px 5px -1px rgba(50,50,93,.25),0 1px 3px -1px rgba(0,0,0,.3);color:inherit;display:none;transition:box-shadow .3s cubic-bezier(.4,0,.2,1) 0ms}.autocomplete .autocomplete-list-wrapper.active{display:block}.autocomplete .autocomplete-list-wrapper ul{list-style:none;margin:0;max-height:40em;overflow:auto;padding:.5rem 0}.autocomplete .autocomplete-list-wrapper ul li{cursor:pointer;overflow:hidden;padding:.375rem 1rem}.autocomplete .autocomplete-list-wrapper ul li.selected,.autocomplete .autocomplete-list-wrapper ul li:hover{background:rgba(0,0,0,.1)}.autocomplete .autocomplete-list-wrapper .autocomplete-options::-webkit-scrollbar{width:7px}.autocomplete .autocomplete-list-wrapper .autocomplete-options::-webkit-scrollbar-track{background:#f1f1f1;border-radius:25px}.autocomplete .autocomplete-list-wrapper .autocomplete-options::-webkit-scrollbar-thumb{background:#ccc;border-radius:25px}.autocomplete .autocomplete-list-wrapper .autocomplete-options::-webkit-scrollbar-thumb:hover{background:#b3b3b3}";function pV(n,e){const[t,i]=Wt.useState(n);return Wt.useEffect(()=>{const c=setTimeout(()=>i(n),e||500);return()=>{clearTimeout(c)}},[n,e]),t}fV(dV);const mV={lat:"0",lon:"0",type:"0",class:"0",osm_id:0,licence:"0",osm_type:"0",place_id:0,importance:0,display_name:"",boundingbox:[]};function gV({value:n,styles:e,classes:t,onChange:i,debounce:c=500,placeholder:a="Search",noOptionName:l="No locations found",openStreetMapUrl:r="https://nominatim.openstreetmap.org",language:h="en"}){const[m,v]=Wt.useState(!1),g=Wt.useRef(null),_=Wt.useRef(null),[E,b]=Wt.useState(""),p=pV(E,c),[x,y]=Wt.useState([]),[f,w]=Wt.useState(null),A=()=>{v(!0)},P=()=>{v(!1)},T=(Wt.useEffect(()=>{function M(L){var W;(W=_.current)!=null&&W.contains(L==null?void 0:L.target)||P()}return document.addEventListener("click",M,!0),()=>{document.removeEventListener("click",M,!0)}},[_]),Wt.useEffect(()=>{n&&g.current&&(w(n),b(n.display_name),g.current.value=n.display_name)},[n]),Wt.useCallback((M="")=>{M&&fetch(r+`/search?format=json&accept-language=${h}&q=`+M).then(L=>L.json()).then(L=>y(L.filter((W,G,re)=>re.findIndex(Q=>Q.display_name===W.display_name)===G))).catch(()=>y([]))},[r,h]));Wt.useEffect(()=>{p&&(A(),T(p))},[p,T]);const R=M=>{w(M),g.current&&(g.current.value=M.display_name),i(M),P()};return Qe.jsxs("div",{ref:_,className:(c=t==null?void 0:t.root)!=null?c:"autocomplete",style:Object.assign({},(c=e==null?void 0:e.root)!=null?c:{}),children:[Qe.jsxs("form",{className:(c=t==null?void 0:t.form)!=null?c:"autocomplete-form",style:Object.assign({},(c=e==null?void 0:e.form)!=null?c:{}),children:[Qe.jsx("div",{className:(c=t==null?void 0:t.inputWrapper)!=null?c:"autocomplete-input-wrapper",style:Object.assign({},(c=e==null?void 0:e.inputWrapper)!=null?c:{}),children:Qe.jsx("input",{type:"text",ref:g,placeholder:a,onClick:A,onKeyUp:M=>{b(M.target.value)},className:(c=t==null?void 0:t.input)!=null?c:"",style:Object.assign({},(a=e==null?void 0:e.input)!=null?a:{})})}),Qe.jsx("hr",{className:(c=t==null?void 0:t.divider)!=null?c:"autocomplete-divider",style:Object.assign({},(a=e==null?void 0:e.divider)!=null?a:{}),role:"none"}),Qe.jsx("button",{tabIndex:0,type:"button",onClick:()=>{g.current&&(A(),b(g.current.value))},style:Object.assign({},(c=e==null?void 0:e.button)!=null?c:{}),className:(a=t==null?void 0:t.button)!=null?a:"autocomplete-button",children:Qe.jsx("svg",{children:Qe.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})})})]}),Qe.jsx("div",{style:Object.assign({},(c=e==null?void 0:e.listWrapper)!=null?c:{}),className:`${(a=t==null?void 0:t.listWrapper)!=null?a:"autocomplete-list-wrapper"} `+(m?"active":""),children:Qe.jsx("ul",{role:"menu",style:Object.assign({},(c=e==null?void 0:e.options)!=null?c:{}),className:(a=t==null?void 0:t.options)!=null?a:"autocomplete-options",children:(0<x.length?x:[Object.assign(Object.assign({},mV),{display_name:l})]).map(M=>Qe.jsx("li",{role:"menuitem",onClick:()=>R(M),onKeyDown:()=>R(M),className:M.osm_id===(f==null?void 0:f.osm_id)?"selected":"",children:M.display_name},M.osm_id))})})]})}var yV={exports:{}};/*! For license information please see browser.umd.js.LICENSE.txt */(function(n,e){(function(t,i){n.exports=i()})(typeof self<"u"?self:mM,()=>(()=>{var t={5507:(a,l,r)=>{a.exports=r(1735)},1735:(a,l,r)=>{var h=r(365).Buffer;function m(p){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},m(p)}function v(p,x,y){return x=_(x),function(f,w){if(w&&(m(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,g()?Reflect.construct(x,y||[],_(p).constructor):x.apply(p,y))}function g(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(g=function(){return!!p})()}function _(p){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},_(p)}function E(p,x){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},E(p,x)}r(9906).set(r(6333));var b=r(7646);b.setBrowser(!0),l.Error=r(4888),l.Schema=r(5506),l.Types=r(8941),l.VirtualType=r(9546),l.SchemaType=r(3207),l.utils=r(6872),l.Document=b(),l.model=function(p,x){var y=function(f){function w(P,T){return function(R,M){if(!(R instanceof M))throw new TypeError("Cannot call a class as a function")}(this,w),v(this,w,[P,x,T])}return function(P,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(T&&T.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),Object.defineProperty(P,"prototype",{writable:!1}),T&&E(P,T)}(w,f),A=w,Object.defineProperty(A,"prototype",{writable:!1}),A;var A}(l.Document);return y.modelName=p,y},typeof window<"u"&&(window.mongoose=a.exports,window.Buffer=h)},3434:(a,l,r)=>{var h=r(8727),m=r(9620).EventEmitter,v=r(4888),g=r(5506),_=r(6079),E=v.ValidationError,b=r(8859),p=r(5721);function x(y,f,w,A,P){if(!(this instanceof x))return new x(y,f,w,A,P);if(p(f)&&!f.instanceOfSchema&&(f=new g(f)),f=this.schema||f,!this.schema&&f.options._id&&(y=y||{})._id===void 0&&(y._id=new _),!f)throw new v.MissingSchemaError;for(var T in this.$__setSchema(f),h.call(this,y,w,A,P),b(this,f,{decorateDoc:!0}),f.methods)this[T]=f.methods[T];for(var R in f.statics)this[R]=f.statics[R]}x.prototype=Object.create(h.prototype),x.prototype.constructor=x,x.events=new m,x.$emitter=new m,["on","once","emit","listeners","removeListener","setMaxListeners","removeAllListeners","addListener"].forEach(function(y){x[y]=function(){return x.$emitter[y].apply(x.$emitter,arguments)}}),x.ValidationError=E,a.exports=x},6787:(a,l,r)=>{function h(W,G){var re=typeof Symbol<"u"&&W[Symbol.iterator]||W["@@iterator"];if(!re){if(Array.isArray(W)||(re=function(pe,U){if(pe){if(typeof pe=="string")return m(pe,U);var B=Object.prototype.toString.call(pe).slice(8,-1);return B==="Object"&&pe.constructor&&(B=pe.constructor.name),B==="Map"||B==="Set"?Array.from(pe):B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B)?m(pe,U):void 0}}(W))||G&&W&&typeof W.length=="number"){re&&(W=re);var Q=0,oe=function(){};return{s:oe,n:function(){return Q>=W.length?{done:!0}:{done:!1,value:W[Q++]}},e:function(pe){throw pe},f:oe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ae,de=!0,be=!1;return{s:function(){re=re.call(W)},n:function(){var pe=re.next();return de=pe.done,pe},e:function(pe){be=!0,ae=pe},f:function(){try{de||re.return==null||re.return()}finally{if(be)throw ae}}}}function m(W,G){(G==null||G>W.length)&&(G=W.length);for(var re=0,Q=new Array(G);re<G;re++)Q[re]=W[re];return Q}function v(W){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},v(W)}var g=r(1795),_=r(3328),E=r(5251),b=r(9739),p=r(6495),x=r(9981),y=r(2392),f=r(7906),w=r(8751),A=r(5721),P=r(6584),T=r(6872),R=["Polygon","MultiPolygon"];function M(W,G,re){if(Array.isArray(W))W.forEach(function(be,pe){if(Array.isArray(be)||A(be))return M(be,G,re);W[pe]=G.castForQuery(null,be,re)});else for(var Q=Object.keys(W),oe=Q.length;oe--;){var ae=Q[oe],de=W[ae];Array.isArray(de)||A(de)?(M(de,G,re),W[ae]=de):W[ae]=G.castForQuery({val:de,context:re})}}function L(W,G,re,Q){if("strictQuery"in W)return W.strictQuery;if("strictQuery"in G)return G.strictQuery;var oe=Q&&Q.mongooseCollection&&Q.mongooseCollection.conn&&Q.mongooseCollection.conn.base&&Q.mongooseCollection.conn.base.options;return oe&&"strictQuery"in oe?oe.strictQuery:re.strictQuery}a.exports=function W(G,re,Q,oe){if(Array.isArray(re))throw new Error("Query filter must be an object, got an array ",w.inspect(re));if(re==null)return re;G!=null&&G.discriminators!=null&&re[G.options.discriminatorKey]!=null&&(G=y(G,re[G.options.discriminatorKey])||G);var ae,de,be,pe,U,B,N=Object.keys(re),z=N.length;for(Q=Q||{};z--;)if(B=re[pe=N[z]],pe==="$or"||pe==="$nor"||pe==="$and"){if(!Array.isArray(B))throw new g("Array",B,pe);for(var H=0;H<B.length;++H){if(B[H]==null||v(B[H])!=="object")throw new g("Object",B[H],pe+"."+H);var Y=B[H][G.options.discriminatorKey];if(Y==null)B[H]=W(G,B[H],Q,oe);else{var fe=y(oe.schema,Y);B[H]=W(fe||G,B[H],Q,oe)}}}else{if(pe==="$where"){if((U=v(B))!=="string"&&U!=="function")throw new Error("Must have a string or function for $where");U==="function"&&(re[pe]=B.toString());continue}if(pe==="$expr"){B=b(B,G);continue}if(pe==="$elemMatch")B=W(G,B,Q,oe);else if(pe==="$text")B=p(B,pe);else{if(!G)continue;if(!(de=G.path(pe)))for(var Re=pe.split("."),Oe=Re.length;Oe--;){var De=Re.slice(0,Oe).join("."),ot=Re.slice(Oe).join("."),X=G.path(De),ee=X&&X.schema&&X.schema.options&&X.schema.options.discriminatorKey;if(X!=null&&(X.schema&&X.schema.discriminators)!=null&&ee!=null&&ot!==ee){var Le=x(re,De+"."+ee),Be=X.schema.discriminators;typeof Le=="string"&&Be[Le]!=null?de=Be[Le].path(ot):Le!=null&&Object.keys(Le).length===1&&Array.isArray(Le.$in)&&Le.$in.length===1&&typeof Le.$in[0]=="string"&&Be[Le.$in[0]]!=null&&(de=Be[Le.$in[0]].path(ot))}}if(de){if(B==null)continue;if(T.isPOJO(B))if(Object.keys(B).some(f))for(var se=Object.keys(B),_e=void 0,te=se.length;te--;)if(be=B[_e=se[te]],_e==="$elemMatch")be&&de!=null&&de.schema!=null?W(de.schema,be,Q,oe):be&&de!=null&&de.$isMongooseArray&&(T.isPOJO(be)&&be.$not!=null?W(G,be,Q,oe):B[_e]=de.castForQuery(_e,be,oe));else if(_e==="$not"){if(be&&de){if((ae=Object.keys(be)).length&&f(ae[0]))for(var $e in be)be[$e]=de.castForQuery($e,be[$e],oe);else B[_e]=de.castForQuery(_e,be,oe);continue}}else B[_e]=de.castForQuery(_e,be,oe);else re[pe]=de.castForQuery(null,B,oe);else if(Array.isArray(B)&&["Buffer","Array"].indexOf(de.instance)===-1){var ge,le=[],ze=h(B);try{for(ze.s();!(ge=ze.n()).done;){var Je=ge.value;le.push(de.castForQuery(null,Je,oe))}}catch(rn){ze.e(rn)}finally{ze.f()}re[pe]={$in:le}}else re[pe]=de.castForQuery(null,B,oe)}else{for(var et=pe.split("."),ft=et.length,wt=void 0,It=void 0,Ct=void 0;ft--&&(wt=et.slice(0,ft).join("."),!(de=G.path(wt))););if(de){if(de.caster&&de.caster.schema){(Ct={})[It=et.slice(ft).join(".")]=B;var tn=W(de.caster.schema,Ct,Q,oe)[It];tn===void 0?delete re[pe]:re[pe]=tn}else re[pe]=B;continue}if(A(B)){var xt="";if(B.$near?xt="$near":B.$nearSphere?xt="$nearSphere":B.$within?xt="$within":B.$geoIntersects?xt="$geoIntersects":B.$geoWithin&&(xt="$geoWithin"),xt){var Ht=new E.Number("__QueryCasting__"),en=B[xt];if(B.$maxDistance!=null&&(B.$maxDistance=Ht.castForQuery(null,B.$maxDistance,oe)),B.$minDistance!=null&&(B.$minDistance=Ht.castForQuery(null,B.$minDistance,oe)),xt==="$within"){var kn=en.$center||en.$centerSphere||en.$box||en.$polygon;if(!kn)throw new Error("Bad $within parameter: "+JSON.stringify(B));en=kn}else if(xt==="$near"&&typeof en.type=="string"&&Array.isArray(en.coordinates))en=en.coordinates;else if((xt==="$near"||xt==="$nearSphere"||xt==="$geoIntersects")&&en.$geometry&&typeof en.$geometry.type=="string"&&Array.isArray(en.$geometry.coordinates))en.$maxDistance!=null&&(en.$maxDistance=Ht.castForQuery(null,en.$maxDistance,oe)),en.$minDistance!=null&&(en.$minDistance=Ht.castForQuery(null,en.$minDistance,oe)),P(en.$geometry)&&(en.$geometry=en.$geometry.toObject({transform:!1,virtuals:!1})),en=en.$geometry.coordinates;else if(xt==="$geoWithin")if(en.$geometry){P(en.$geometry)&&(en.$geometry=en.$geometry.toObject({virtuals:!1}));var Dn=en.$geometry.type;if(R.indexOf(Dn)===-1)throw new Error('Invalid geoJSON type for $geoWithin "'+Dn+'", must be "Polygon" or "MultiPolygon"');en=en.$geometry.coordinates}else en=en.$box||en.$polygon||en.$center||en.$centerSphere,P(en)&&(en=en.toObject({virtuals:!1}));M(en,Ht,oe);continue}}if(G.nested[pe])continue;var Ft="strict"in Q?Q.strict:G.options.strict,Tt=L(Q,G._userProvidedOptions,G.options,oe);if(Q.upsert&&Ft)throw Ft==="throw"?new _(pe):new _(pe,'Path "'+pe+'" is not in schema, strict mode is `true`, and upsert is `true`.');if(Tt==="throw")throw new _(pe,'Path "'+pe+`" is not in schema and strictQuery is 'throw'.`);Tt&&delete re[pe]}}}return re}},3087:(a,l,r)=>{var h=r(9373),m=r(4029).Long;a.exports=function(v){return v==null?v:v===""?null:typeof v=="bigint"?v:v instanceof m?v.toBigInt():typeof v=="string"||typeof v=="number"?BigInt(v):void h.ok(!1)}},6670:(a,l,r)=>{var h=r(1795);a.exports=function(m,v){if(a.exports.convertToTrue.has(m))return!0;if(a.exports.convertToFalse.has(m))return!1;if(m==null)return m;throw new h("boolean",m,v)},a.exports.convertToTrue=new Set([!0,"true",1,"1","yes"]),a.exports.convertToFalse=new Set([!1,"false",0,"0","no"])},195:(a,l,r)=>{var h=r(9373);a.exports=function(m){return m==null||m===""?null:m instanceof Date?(h.ok(!isNaN(m.valueOf())),m):(h.ok(typeof m!="boolean"),v=m instanceof Number||typeof m=="number"?new Date(m):typeof m=="string"&&!isNaN(Number(m))&&(Number(m)>=275761||Number(m)<-271820)?new Date(Number(m)):typeof m.valueOf=="function"?new Date(m.valueOf()):new Date(m),isNaN(v.valueOf())?void h.ok(!1):v);var v}},6209:(a,l,r)=>{var h=r(365).Buffer;function m(_){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},m(_)}var v=r(5003),g=r(9373);a.exports=function(_){return _==null?_:m(_)==="object"&&typeof _.$numberDecimal=="string"?v.fromString(_.$numberDecimal):_ instanceof v?_:typeof _=="string"?v.fromString(_):typeof h=="function"&&h.isBuffer(_)||typeof Uint8Array=="function"&&_ instanceof Uint8Array?new v(_):typeof _=="number"?v.fromString(String(_)):typeof _.valueOf=="function"&&typeof _.valueOf()=="string"?v.fromString(_.valueOf()):void g.ok(!1)}},3065:(a,l,r)=>{var h=r(9373);a.exports=function(m){return m==null?m:m===""?null:(typeof m!="string"&&typeof m!="boolean"||(m=Number(m)),h.ok(!isNaN(m)),m instanceof Number?m.valueOf():typeof m=="number"?m:Array.isArray(m)||typeof m.valueOf!="function"?m.toString&&!Array.isArray(m)&&m.toString()==Number(m)?Number(m):void h.ok(!1):Number(m.valueOf()))}},4731:(a,l,r)=>{var h=r(1563),m=r(6079);a.exports=function(v){if(v==null||h(v,"ObjectId"))return v;if(v._id){if(h(v._id,"ObjectId"))return v._id;if(v._id.toString instanceof Function)return new m(v._id.toString())}return v.toString instanceof Function?new m(v.toString()):new m(v)}},2417:(a,l,r)=>{var h=r(1795);a.exports=function(m,v){if(m==null)return m;if(m._id&&typeof m._id=="string")return m._id;if(m.toString&&m.toString!==Object.prototype.toString&&!Array.isArray(m))return m.toString();throw new h("string",m,v)}},8727:(a,l,r)=>{function h(){h=function(){return ve};var Ae,ve={},he=Object.prototype,me=he.hasOwnProperty,we=Object.defineProperty||function(nn,on,bn){nn[on]=bn.value},je=typeof Symbol=="function"?Symbol:{},qe=je.iterator||"@@iterator",Fe=je.asyncIterator||"@@asyncIterator",Xe=je.toStringTag||"@@toStringTag";function Ge(nn,on,bn){return Object.defineProperty(nn,on,{value:bn,enumerable:!0,configurable:!0,writable:!0}),nn[on]}try{Ge({},"")}catch{Ge=function(on,bn,ir){return on[bn]=ir}}function rt(nn,on,bn,ir){var On=on&&on.prototype instanceof Zt?on:Zt,Ar=Object.create(On.prototype),zr=new oi(ir||[]);return we(Ar,"_invoke",{value:hr(nn,bn,zr)}),Ar}function bt(nn,on,bn){try{return{type:"normal",arg:nn.call(on,bn)}}catch(ir){return{type:"throw",arg:ir}}}ve.wrap=rt;var at="suspendedStart",Et="suspendedYield",jt="executing",Kt="completed",Yt={};function Zt(){}function Jt(){}function ln(){}var vn={};Ge(vn,qe,function(){return this});var wn=Object.getPrototypeOf,cn=wn&&wn(wn(eo([])));cn&&cn!==he&&me.call(cn,qe)&&(vn=cn);var xn=ln.prototype=Zt.prototype=Object.create(vn);function cr(nn){["next","throw","return"].forEach(function(on){Ge(nn,on,function(bn){return this._invoke(on,bn)})})}function br(nn,on){function bn(On,Ar,zr,kr){var ui=bt(nn[On],nn,Ar);if(ui.type!=="throw"){var Jr=ui.arg,Xr=Jr.value;return Xr&&x(Xr)=="object"&&me.call(Xr,"__await")?on.resolve(Xr.__await).then(function(wi){bn("next",wi,zr,kr)},function(wi){bn("throw",wi,zr,kr)}):on.resolve(Xr).then(function(wi){Jr.value=wi,zr(Jr)},function(wi){return bn("throw",wi,zr,kr)})}kr(ui.arg)}var ir;we(this,"_invoke",{value:function(On,Ar){function zr(){return new on(function(kr,ui){bn(On,Ar,kr,ui)})}return ir=ir?ir.then(zr,zr):zr()}})}function hr(nn,on,bn){var ir=at;return function(On,Ar){if(ir===jt)throw new Error("Generator is already running");if(ir===Kt){if(On==="throw")throw Ar;return{value:Ae,done:!0}}for(bn.method=On,bn.arg=Ar;;){var zr=bn.delegate;if(zr){var kr=pr(zr,bn);if(kr){if(kr===Yt)continue;return kr}}if(bn.method==="next")bn.sent=bn._sent=bn.arg;else if(bn.method==="throw"){if(ir===at)throw ir=Kt,bn.arg;bn.dispatchException(bn.arg)}else bn.method==="return"&&bn.abrupt("return",bn.arg);ir=jt;var ui=bt(nn,on,bn);if(ui.type==="normal"){if(ir=bn.done?Kt:Et,ui.arg===Yt)continue;return{value:ui.arg,done:bn.done}}ui.type==="throw"&&(ir=Kt,bn.method="throw",bn.arg=ui.arg)}}}function pr(nn,on){var bn=on.method,ir=nn.iterator[bn];if(ir===Ae)return on.delegate=null,bn==="throw"&&nn.iterator.return&&(on.method="return",on.arg=Ae,pr(nn,on),on.method==="throw")||bn!=="return"&&(on.method="throw",on.arg=new TypeError("The iterator does not provide a '"+bn+"' method")),Yt;var On=bt(ir,nn.iterator,on.arg);if(On.type==="throw")return on.method="throw",on.arg=On.arg,on.delegate=null,Yt;var Ar=On.arg;return Ar?Ar.done?(on[nn.resultName]=Ar.value,on.next=nn.nextLoc,on.method!=="return"&&(on.method="next",on.arg=Ae),on.delegate=null,Yt):Ar:(on.method="throw",on.arg=new TypeError("iterator result is not an object"),on.delegate=null,Yt)}function Kr(nn){var on={tryLoc:nn[0]};1 in nn&&(on.catchLoc=nn[1]),2 in nn&&(on.finallyLoc=nn[2],on.afterLoc=nn[3]),this.tryEntries.push(on)}function mn(nn){var on=nn.completion||{};on.type="normal",delete on.arg,nn.completion=on}function oi(nn){this.tryEntries=[{tryLoc:"root"}],nn.forEach(Kr,this),this.reset(!0)}function eo(nn){if(nn||nn===""){var on=nn[qe];if(on)return on.call(nn);if(typeof nn.next=="function")return nn;if(!isNaN(nn.length)){var bn=-1,ir=function On(){for(;++bn<nn.length;)if(me.call(nn,bn))return On.value=nn[bn],On.done=!1,On;return On.value=Ae,On.done=!0,On};return ir.next=ir}}throw new TypeError(x(nn)+" is not iterable")}return Jt.prototype=ln,we(xn,"constructor",{value:ln,configurable:!0}),we(ln,"constructor",{value:Jt,configurable:!0}),Jt.displayName=Ge(ln,Xe,"GeneratorFunction"),ve.isGeneratorFunction=function(nn){var on=typeof nn=="function"&&nn.constructor;return!!on&&(on===Jt||(on.displayName||on.name)==="GeneratorFunction")},ve.mark=function(nn){return Object.setPrototypeOf?Object.setPrototypeOf(nn,ln):(nn.__proto__=ln,Ge(nn,Xe,"GeneratorFunction")),nn.prototype=Object.create(xn),nn},ve.awrap=function(nn){return{__await:nn}},cr(br.prototype),Ge(br.prototype,Fe,function(){return this}),ve.AsyncIterator=br,ve.async=function(nn,on,bn,ir,On){On===void 0&&(On=Promise);var Ar=new br(rt(nn,on,bn,ir),On);return ve.isGeneratorFunction(on)?Ar:Ar.next().then(function(zr){return zr.done?zr.value:Ar.next()})},cr(xn),Ge(xn,Xe,"Generator"),Ge(xn,qe,function(){return this}),Ge(xn,"toString",function(){return"[object Generator]"}),ve.keys=function(nn){var on=Object(nn),bn=[];for(var ir in on)bn.push(ir);return bn.reverse(),function On(){for(;bn.length;){var Ar=bn.pop();if(Ar in on)return On.value=Ar,On.done=!1,On}return On.done=!0,On}},ve.values=eo,oi.prototype={constructor:oi,reset:function(nn){if(this.prev=0,this.next=0,this.sent=this._sent=Ae,this.done=!1,this.delegate=null,this.method="next",this.arg=Ae,this.tryEntries.forEach(mn),!nn)for(var on in this)on.charAt(0)==="t"&&me.call(this,on)&&!isNaN(+on.slice(1))&&(this[on]=Ae)},stop:function(){this.done=!0;var nn=this.tryEntries[0].completion;if(nn.type==="throw")throw nn.arg;return this.rval},dispatchException:function(nn){if(this.done)throw nn;var on=this;function bn(ui,Jr){return Ar.type="throw",Ar.arg=nn,on.next=ui,Jr&&(on.method="next",on.arg=Ae),!!Jr}for(var ir=this.tryEntries.length-1;ir>=0;--ir){var On=this.tryEntries[ir],Ar=On.completion;if(On.tryLoc==="root")return bn("end");if(On.tryLoc<=this.prev){var zr=me.call(On,"catchLoc"),kr=me.call(On,"finallyLoc");if(zr&&kr){if(this.prev<On.catchLoc)return bn(On.catchLoc,!0);if(this.prev<On.finallyLoc)return bn(On.finallyLoc)}else if(zr){if(this.prev<On.catchLoc)return bn(On.catchLoc,!0)}else{if(!kr)throw new Error("try statement without catch or finally");if(this.prev<On.finallyLoc)return bn(On.finallyLoc)}}}},abrupt:function(nn,on){for(var bn=this.tryEntries.length-1;bn>=0;--bn){var ir=this.tryEntries[bn];if(ir.tryLoc<=this.prev&&me.call(ir,"finallyLoc")&&this.prev<ir.finallyLoc){var On=ir;break}}On&&(nn==="break"||nn==="continue")&&On.tryLoc<=on&&on<=On.finallyLoc&&(On=null);var Ar=On?On.completion:{};return Ar.type=nn,Ar.arg=on,On?(this.method="next",this.next=On.finallyLoc,Yt):this.complete(Ar)},complete:function(nn,on){if(nn.type==="throw")throw nn.arg;return nn.type==="break"||nn.type==="continue"?this.next=nn.arg:nn.type==="return"?(this.rval=this.arg=nn.arg,this.method="return",this.next="end"):nn.type==="normal"&&on&&(this.next=on),Yt},finish:function(nn){for(var on=this.tryEntries.length-1;on>=0;--on){var bn=this.tryEntries[on];if(bn.finallyLoc===nn)return this.complete(bn.completion,bn.afterLoc),mn(bn),Yt}},catch:function(nn){for(var on=this.tryEntries.length-1;on>=0;--on){var bn=this.tryEntries[on];if(bn.tryLoc===nn){var ir=bn.completion;if(ir.type==="throw"){var On=ir.arg;mn(bn)}return On}}throw new Error("illegal catch attempt")},delegateYield:function(nn,on,bn){return this.delegate={iterator:eo(nn),resultName:on,nextLoc:bn},this.method==="next"&&(this.arg=Ae),Yt}},ve}function m(Ae,ve,he,me,we,je,qe){try{var Fe=Ae[je](qe),Xe=Fe.value}catch(Ge){return void he(Ge)}Fe.done?ve(Xe):Promise.resolve(Xe).then(me,we)}function v(Ae){return function(){var ve=this,he=arguments;return new Promise(function(me,we){var je=Ae.apply(ve,he);function qe(Xe){m(je,me,we,qe,Fe,"next",Xe)}function Fe(Xe){m(je,me,we,qe,Fe,"throw",Xe)}qe(void 0)})}}function g(Ae,ve){var he=Object.keys(Ae);if(Object.getOwnPropertySymbols){var me=Object.getOwnPropertySymbols(Ae);ve&&(me=me.filter(function(we){return Object.getOwnPropertyDescriptor(Ae,we).enumerable})),he.push.apply(he,me)}return he}function _(Ae){for(var ve=1;ve<arguments.length;ve++){var he=arguments[ve]!=null?arguments[ve]:{};ve%2?g(Object(he),!0).forEach(function(me){E(Ae,me,he[me])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ae,Object.getOwnPropertyDescriptors(he)):g(Object(he)).forEach(function(me){Object.defineProperty(Ae,me,Object.getOwnPropertyDescriptor(he,me))})}return Ae}function E(Ae,ve,he){return ve=function(me){var we=function(je,qe){if(x(je)!="object"||!je)return je;var Fe=je[Symbol.toPrimitive];if(Fe!==void 0){var Xe=Fe.call(je,"string");if(x(Xe)!="object")return Xe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(je)}(me);return x(we)=="symbol"?we:String(we)}(ve),ve in Ae?Object.defineProperty(Ae,ve,{value:he,enumerable:!0,configurable:!0,writable:!0}):Ae[ve]=he,Ae}function b(Ae,ve){var he=typeof Symbol<"u"&&Ae[Symbol.iterator]||Ae["@@iterator"];if(!he){if(Array.isArray(Ae)||(he=function(Xe,Ge){if(Xe){if(typeof Xe=="string")return p(Xe,Ge);var rt=Object.prototype.toString.call(Xe).slice(8,-1);return rt==="Object"&&Xe.constructor&&(rt=Xe.constructor.name),rt==="Map"||rt==="Set"?Array.from(Xe):rt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rt)?p(Xe,Ge):void 0}}(Ae))||ve&&Ae&&typeof Ae.length=="number"){he&&(Ae=he);var me=0,we=function(){};return{s:we,n:function(){return me>=Ae.length?{done:!0}:{done:!1,value:Ae[me++]}},e:function(Xe){throw Xe},f:we}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var je,qe=!0,Fe=!1;return{s:function(){he=he.call(Ae)},n:function(){var Xe=he.next();return qe=Xe.done,Xe},e:function(Xe){Fe=!0,je=Xe},f:function(){try{qe||he.return==null||he.return()}finally{if(Fe)throw je}}}}function p(Ae,ve){(ve==null||ve>Ae.length)&&(ve=Ae.length);for(var he=0,me=new Array(ve);he<ve;he++)me[he]=Ae[he];return me}function x(Ae){return x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ve){return typeof ve}:function(ve){return ve&&typeof Symbol=="function"&&ve.constructor===Symbol&&ve!==Symbol.prototype?"symbol":typeof ve},x(Ae)}var y,f,w,A=r(9620).EventEmitter,P=r(6379),T=r(4888),R=r(3861),M=r(4107),L=r(900),W=r(7962),G=r(5506),re=r(3328),Q=r(122),oe=r(2037),ae=r(7427),de=r(2874),be=r(4134),pe=r(1973),U=r(8724).M,B=r(8724).c,N=r(2829).x,z=r(9981),H=r(111),Y=r(37),fe=r(9728),Re=r(719),Oe=r(1490),De=r(2183),ot=r(9098),X=r(8751).inspect,ee=r(4962).h,Le=r(5837),Be=r(8535),se=r(3564),_e=r(7530),te=r(6872),$e=r(5543),ge=te.deepEqual,le=te.isMongooseObject,ze=r(8770).arrayAtomicsBackupSymbol,Je=r(8770).arrayAtomicsSymbol,et=r(8770).documentArrayParent,ft=r(8770).documentIsModified,wt=r(8770).documentModifiedPaths,It=r(8770).documentSchemaSymbol,Ct=r(8770).getSymbol,tn=r(8770).populateModelSymbol,xt=r(8770).scopeSymbol,Ht=r(8107).schemaMixedSymbol,en=r(251),kn=r(9585),Dn=r(8770).sessionNewDocuments,Ft=te.specialProperties;function Tt(Ae,ve,he,me){if(x(he)==="object"&&he!=null&&(he=(me=he).skipId),me=Object.assign({},me),this.$__schema==null){var we=te.isObject(ve)&&!ve.instanceOfSchema?new G(ve):ve;this.$__setSchema(we),ve=he,he=me,me=arguments[4]||{}}if(this.$__=new P,me.isNew!=null&&me.isNew!==!0&&(this.$isNew=me.isNew),me.priorDoc!=null&&(this.$__.priorDoc=me.priorDoc),he&&(this.$__.skipId=he),Ae!=null&&x(Ae)!=="object")throw new L(Ae,"obj","Document");var je=!0;me.defaults!==void 0&&(this.$__.defaults=me.defaults,je=me.defaults);var qe=this.$__schema;typeof ve=="boolean"||ve==="throw"?(ve!==!0&&(this.$__.strictMode=ve),ve=void 0):qe.options.strict!==!0&&(this.$__.strictMode=qe.options.strict);var Fe,Xe=b(qe.requiredPaths(!0));try{for(Xe.s();!(Fe=Xe.n()).done;){var Ge=Fe.value;this.$__.activePaths.require(Ge)}}catch(Et){Xe.e(Et)}finally{Xe.f()}var rt=null;te.isPOJO(ve)&&Object.keys(ve).length>0&&(rt=ot(ve),this.$__.selected=ve,this.$__.exclude=rt);var bt=rt===!1&&ve?ae(ve):null;if(this._doc==null&&(this.$__buildDoc(Ae,ve,he,rt,bt,!1),je&&de(this,ve,rt,bt,!0,null)),Ae&&(this.$__original_set?this.$__original_set(Ae,void 0,!0,me):this.$set(Ae,void 0,!0,me),Ae instanceof Tt&&(this.$isNew=Ae.$isNew)),me.willInit&&je?me.skipDefaults&&(this.$__.skipDefaults=me.skipDefaults):je&&de(this,ve,rt,bt,!1,me.skipDefaults),!this.$__.strictMode&&Ae){var at=this;Object.keys(this._doc).forEach(function(Et){Et in qe.tree||Et in qe.methods||Et in qe.virtuals||Et.startsWith("$")||B({prop:Et,subprops:null,prototype:at})})}(function(Et){var jt=Et.$__schema&&Et.$__schema.callQueue;if(jt.length){var Kt,Yt=b(jt);try{for(Yt.s();!(Kt=Yt.n()).done;){var Zt=Kt.value;Zt[0]!=="pre"&&Zt[0]!=="post"&&Zt[0]!=="on"&&Et[Zt[0]].apply(Et,Zt[1])}}catch(Jt){Yt.e(Jt)}finally{Yt.f()}}})(this)}for(var rn in Tt.prototype.$isMongooseDocumentPrototype=!0,Object.defineProperty(Tt.prototype,"isNew",{get:function(){return this.$isNew},set:function(Ae){this.$isNew=Ae}}),Object.defineProperty(Tt.prototype,"errors",{get:function(){return this.$errors},set:function(Ae){this.$errors=Ae}}),Tt.prototype.$isNew=!0,te.each(["on","once","emit","listeners","removeListener","setMaxListeners","removeAllListeners","addListener"],function(Ae){Tt.prototype[Ae]=function(){if(!this.$__.emitter){if(Ae==="emit")return;this.$__.emitter=new A,this.$__.emitter.setMaxListeners(0)}return this.$__.emitter[Ae].apply(this.$__.emitter,arguments)},Tt.prototype["$".concat(Ae)]=Tt.prototype[Ae]}),Tt.prototype.constructor=Tt,A.prototype)Tt[rn]=A.prototype[rn];function dt(Ae,ve,he){if(Ae!=null)for(var me=Object.keys(he.$__schema.paths),we=me.length,je=ve.indexOf(".")===-1?[ve]:ve.split("."),qe=0;qe<we;++qe){var Fe="",Xe=me[qe];if(Xe.startsWith(ve+".")){var Ge=he.$__schema.paths[Xe],rt=Ge.splitPath().slice(je.length),bt=rt.length;if(Ge.defaultValue!==void 0)for(var at=Ae,Et=0;Et<bt&&at!=null;++Et){var jt=rt[Et];if(Et===bt-1){if(at[jt]!==void 0)break;try{var Kt=Ge.getDefault(he,!1);Kt!==void 0&&(at[jt]=Kt)}catch(Yt){he.invalidate(ve+"."+Fe,Yt);break}break}Fe+=(Fe.length?".":"")+jt,at[jt]=at[jt]||{},at=at[jt]}}}}function qn(Ae,ve,he,me,we){we=we||"",ve.$__!=null&&(ve=ve._doc);for(var je,qe,Fe,Xe=Object.keys(ve),Ge=Xe.length,rt=0,bt=Ae.$__.strictMode,at=Ae.$__schema;rt<Ge;)Et(rt++);function Et(jt){if((Fe=Xe[jt])!=="__proto__"&&Fe!=="constructor"&&(qe=we+Fe,je=at.path(qe),!at.$isRootDiscriminator||Ae.$__isSelected(qe)))if(!je&&te.isPOJO(ve[Fe]))he[Fe]||(he[Fe]={},bt||Fe in at.tree||Fe in at.methods||Fe in at.virtuals||(Ae[Fe]=he[Fe])),qn(Ae,ve[Fe],he[Fe],me,qe+".");else if(je){if(he.hasOwnProperty(Fe)&&ve[Fe]!==void 0&&delete he[Fe],ve[Fe]===null)he[Fe]=je._castNullish(null);else if(ve[Fe]!==void 0){var Kt=ve[Fe].$__==null?null:ve[Fe].$__.wasPopulated;if(je&&!Kt)try{me&&me.setters?he[Fe]=je.applySetters(ve[Fe],Ae,!1):he[Fe]=je.cast(ve[Fe],Ae,!0)}catch(Yt){Ae.invalidate(Yt.path,new oe({path:Yt.path,message:Yt.message,type:"cast",value:Yt.value,reason:Yt}))}else he[Fe]=ve[Fe]}Ae.$isModified(qe)||Ae.$__.activePaths.init(qe)}else he[Fe]=ve[Fe],bt||we||(Ae[Fe]=ve[Fe])}}function fn(Ae){if(Ae==null)return!0;if(x(Ae)!=="object"||Array.isArray(Ae))return!1;for(var ve=0,he=Object.keys(Ae);ve<he.length;ve++)if(!fn(Ae[he[ve]]))return!1;return!0}function dr(Ae,ve,he){var me={};(function(Wn){var hi=Object.keys(Wn.$__.activePaths.getStatePaths("require")),pi=0,ns=hi.length;for(pi=0;pi<ns;++pi){var ki=hi[pi],Di=Wn.$__schema.path(ki);if(Di!=null&&typeof Di.originalRequiredValue=="function"){Wn.$__.cachedRequired=Wn.$__.cachedRequired||{};try{Wn.$__.cachedRequired[ki]=Di.originalRequiredValue.call(Wn,Wn)}catch(Hi){Wn.invalidate(ki,Hi)}}}})(Ae);var we=new Set(Object.keys(Ae.$__.activePaths.getStatePaths("require")).filter(function(Wn){return!(!Ae.$__isSelected(Wn)&&!Ae.$isModified(Wn))&&(Ae.$__.cachedRequired==null||!(Wn in Ae.$__.cachedRequired)||Ae.$__.cachedRequired[Wn])}));function je(Wn){we.add(Wn)}Object.keys(Ae.$__.activePaths.getStatePaths("init")).forEach(je),Object.keys(Ae.$__.activePaths.getStatePaths("modify")).forEach(je),Object.keys(Ae.$__.activePaths.getStatePaths("default")).forEach(je);var qe,Fe=Ae.$getAllSubdocs(),Xe=Ae.modifiedPaths(),Ge=b(Fe);try{for(Ge.s();!(qe=Ge.n()).done;){var rt=qe.value;if(rt.$basePath){var bt,at=rt.$isSingleNested?rt.$__pathRelativeToParent():rt.$__fullPathWithIndexes(),Et=b(rt.modifiedPaths());try{for(Et.s();!(bt=Et.n()).done;){var jt=bt.value;we.delete(at+"."+jt)}}catch(Wn){Et.e(Wn)}finally{Et.f()}!Ae.$isModified(at,null,Xe)||Ae.isDirectModified(at)||Ae.$isDefault(at)||(we.add(at),Ae.$__.pathsToScopes==null&&(Ae.$__.pathsToScopes={}),Ae.$__.pathsToScopes[at]=rt.$isDocumentArrayElement?rt.__parentArray:rt.$parent(),me[at]={skipSchemaValidators:!0},rt.$isDocumentArrayElement&&rt.__index!=null&&(me[at].index=rt.__index))}}}catch(Wn){Ge.e(Wn)}finally{Ge.f()}var Kt,Yt=b(we);try{for(Yt.s();!(Kt=Yt.n()).done;){var Zt=Kt.value,Jt=Ae.$__schema.path(Zt);if(Jt){if(Jt.$isMongooseDocumentArray){var ln,vn=b(we);try{for(vn.s();!(ln=vn.n()).done;){var wn=ln.value;(wn==null||wn.startsWith(Jt.path+"."))&&we.delete(wn)}}catch(Wn){vn.e(Wn)}finally{vn.f()}}(Jt.caster||Jt.validators.length!==0||Jt.$parentSchemaDocArray)&&(!Jt.$isMongooseArray||Jt.$isMongooseDocumentArray||Jt.$embeddedSchemaType.$isMongooseArray||Jt.validators.length!==0||Jt.$embeddedSchemaType.validators.length!==0)||we.delete(Zt)}}}catch(Wn){Yt.e(Wn)}finally{Yt.f()}var cn,xn=b(we);try{for(xn.s();!(cn=xn.n()).done;){var cr=cn.value;Ae.$__schema.singleNestedPaths.hasOwnProperty(cr)&&we.delete(cr)}}catch(Wn){xn.e(Wn)}finally{xn.f()}Array.isArray(ve)?we=function(Wn,hi){var pi,ns=new Set(hi),ki=new Map([]),Di=b(hi);try{for(Di.s();!(pi=Di.n()).done;){var Hi=pi.value;if(Hi.indexOf(".")!==-1)for(var Ur=Hi.split("."),Io=Ur[0],rs=1;rs<Ur.length;++rs)ki.set(Io,Hi),Io=Io+"."+Ur[rs]}}catch(Ao){Di.e(Ao)}finally{Di.f()}var ao,qo=new Set,yo=b(Wn);try{for(yo.s();!(ao=yo.n()).done;){var lo=ao.value;ns.has(lo)?qo.add(lo):ki.has(lo)&&qo.add(ki.get(lo))}}catch(Ao){yo.e(Ao)}finally{yo.f()}return qo}(we,ve):Array.isArray(he)&&(we=function(Wn,hi){return hi=new Set(hi),Wn=Array.from(Wn).filter(function(pi){return!hi.has(pi)}),new Set(Wn)}(we,he));var br,hr=b(we);try{for(hr.s();!(br=hr.n()).done;){var pr=br.value,Kr=Ae.$__schema.path(pr);Kr&&Kr.$isMongooseArray&&(Array.isArray(Kr)||!Kr.$isMongooseDocumentArray||Kr&&Kr.schemaOptions&&Kr.schemaOptions.required)&&(!Kr.$isMongooseArray||Kr.$isMongooseDocumentArray||Kr.$embeddedSchemaType.$isMongooseArray||Kr.$embeddedSchemaType.validators.length!==0)&&mn(Ae.$__getValue(pr),we,pr)}}catch(Wn){hr.e(Wn)}finally{hr.f()}function mn(Wn,hi,pi){if(Wn!=null)for(var ns=Wn.length,ki=0;ki<ns;++ki)Array.isArray(Wn[ki])?mn(Wn[ki],hi,pi+"."+ki):hi.add(pi+"."+ki)}var oi,eo={skipArrays:!0},nn=b(we);try{for(nn.s();!(oi=nn.n()).done;){var on=oi.value;if(Ae.$__schema.nested[on]){var bn=Ae.$__getValue(on);le(bn)&&(bn=bn.toObject({transform:!1}));var ir=N(bn,on,eo,Ae.$__schema);Object.keys(ir).forEach(je)}}}catch(Wn){nn.e(Wn)}finally{nn.f()}var On,Ar=b(we);try{for(Ar.s();!(On=Ar.n()).done;){var zr=On.value,kr=Ae.$__schema.path(zr);if(kr&&(kr.$parentSchemaDocArray&&typeof kr.$parentSchemaDocArray.path=="string"&&we.add(kr.$parentSchemaDocArray.path),kr.$isSchemaMap)){var ui=Ae.$__getValue(zr);if(ui!=null){var Jr,Xr=b(ui.keys());try{for(Xr.s();!(Jr=Xr.n()).done;){var wi=Jr.value;we.add(zr+"."+wi)}}catch(Wn){Xr.e(Wn)}finally{Xr.f()}}}}}catch(Wn){Ar.e(Wn)}finally{Ar.f()}return[we=Array.from(we),me]}function Xn(Ae,ve,he,me){var we,je,qe,Fe=Ae.$__schema,Xe=Object.keys(Fe.virtuals),Ge=Xe.length,rt=Ge,bt=Ae._doc,at=typeof(me&&me.aliases)!="boolean"||me.aliases,Et=null;if(Array.isArray(he.virtuals))Et=new Set(he.virtuals);else if(he.virtuals&&he.virtuals.pathsToSkip){Et=new Set(Xe);for(var jt=0;jt<he.virtuals.pathsToSkip.length;jt++)Et.has(he.virtuals.pathsToSkip[jt])&&Et.delete(he.virtuals.pathsToSkip[jt])}if(!bt)return ve;for(he=he||{},Ge=0;Ge<rt;++Ge)if(we=Xe[Ge],(Et==null||Et.has(we))&&(at||!Fe.aliases.hasOwnProperty(we))){if(je=we,he.path!=null){if(!we.startsWith(he.path+"."))continue;je=we.substring(he.path.length+1)}var Kt=je.split(".");if((qe=pe(Ae.get(we),he))!==void 0){var Yt=Kt.length;bt=ve;for(var Zt=0;Zt<Yt-1;++Zt)bt[Kt[Zt]]=bt[Kt[Zt]]||{},bt=bt[Kt[Zt]];bt[Kt[Yt-1]]=qe}}return ve}function Ir(Ae,ve){if($e(ve))throw new Error("`transform` function must be synchronous, but the transform on path `"+Ae+"` returned a promise.")}Tt.prototype.$__schema,Tt.prototype.schema,Object.defineProperty(Tt.prototype,"$locals",{configurable:!1,enumerable:!1,get:function(){return this.$__.locals==null&&(this.$__.locals={}),this.$__.locals},set:function(Ae){this.$__.locals=Ae}}),Tt.prototype.isNew,Object.defineProperty(Tt.prototype,"$where",{configurable:!1,enumerable:!1,writable:!0}),Tt.prototype.id,Tt.prototype.$errors,Object.defineProperty(Tt.prototype,"$op",{get:function(){return this.$__.op||null},set:function(Ae){this.$__.op=Ae}}),Tt.prototype.$__buildDoc=function(Ae,ve,he,me,we){for(var je={},qe=Object.keys(this.$__schema.paths).filter(function(Jt){return!Jt.includes("$*")}),Fe=qe.length,Xe=0;Xe<Fe;++Xe){var Ge=qe[Xe];if(!(Ge==="_id"&&(he||Ae&&"_id"in Ae)))for(var rt=this.$__schema.paths[Ge].splitPath(),bt=rt.length,at=bt-1,Et="",jt=je,Kt=!1,Yt=0;Yt<bt;++Yt){var Zt=rt[Yt];if(Et.length?Et+="."+Zt:Et=Zt,me===!0){if(Et in ve)break}else if(me===!1&&ve&&!Kt){if(Et in ve)Kt=!0;else if(!we[Et])break}Yt<at&&(jt=jt[Zt]||(jt[Zt]={}))}}this._doc=je},Tt.prototype.toBSON=function(){return this.toObject(ee)},Tt.prototype.init=function(Ae,ve,he){return typeof ve=="function"&&(he=ve,ve=null),this.$__init(Ae,ve),he&&he(null,this),this},Tt.prototype.$init=function(){return this.constructor.prototype.init.apply(this,arguments)},Tt.prototype.$__init=function(Ae,ve){if(this.$isNew=!1,ve=ve||{},Ae._id!=null&&ve.populated&&ve.populated.length){var he,me=String(Ae._id),we=b(ve.populated);try{for(we.s();!(he=we.n()).done;){var je=he.value;if(je.isVirtual?this.$populated(je.path,te.getValue(je.path,Ae),je):this.$populated(je.path,je._docs[me],je),je._childDocs!=null){var qe,Fe=b(je._childDocs);try{for(Fe.s();!(qe=Fe.n()).done;){var Xe=qe.value;Xe!=null&&Xe.$__!=null&&(Xe.$__.parent=this)}}catch(rt){Fe.e(rt)}finally{Fe.f()}je._childDocs=[]}}}catch(rt){we.e(rt)}finally{we.f()}}qn(this,Ae,this._doc,ve),Le(this,ve.populated),this.$emit("init",this),this.constructor.emit("init",this);var Ge=this.$__.exclude===!1&&this.$__.selected?ae(this.$__.selected):null;return de(this,this.$__.selected,this.$__.exclude,Ge,!1,this.$__.skipDefaults),this},Tt.prototype.updateOne=function(Ae,ve,he){var me=this.constructor.updateOne({_id:this._id},Ae,ve),we=this;return me.pre(function(je){we.constructor._middleware.execPre("updateOne",we,[we],je)}),me.post(function(je){we.constructor._middleware.execPost("updateOne",we,[we],{},je)}),this.$session()!=null&&("session"in me.options||(me.options.session=this.$session())),he!=null?me.exec(he):me},Tt.prototype.replaceOne=function(){var Ae=Array.prototype.slice.call(arguments);return Ae.unshift({_id:this._id}),this.constructor.replaceOne.apply(this.constructor,Ae)},Tt.prototype.$session=function(Ae){if(arguments.length===0)return this.$__.session!=null&&this.$__.session.hasEnded?(this.$__.session=null,null):this.$__.session;if(Ae!=null&&Ae.hasEnded)throw new T("Cannot set a document's session to a session that has ended. Make sure you haven't called `endSession()` on the session you are passing to `$session()`.");if(Ae!=null||this.$__.session!=null){if(this.$__.session=Ae,!this.$isSubdocument){var ve,he=b(this.$getAllSubdocs());try{for(he.s();!(ve=he.n()).done;)ve.value.$session(Ae)}catch(me){he.e(me)}finally{he.f()}}return Ae}},Tt.prototype.$timestamps=function(Ae){return arguments.length===0?this.$__.timestamps!=null?this.$__.timestamps:this.$__schema?this.$__schema.options.timestamps:void 0:(Ae!==this.$timestamps()&&(this.$__.timestamps=Ae),this)},Tt.prototype.overwrite=function(Ae){for(var ve=0,he=Array.from(new Set(Object.keys(this._doc).concat(Object.keys(Ae))));ve<he.length;ve++){var me=he[ve];me!=="_id"&&(this.$__schema.options.versionKey&&me===this.$__schema.options.versionKey||this.$__schema.options.discriminatorKey&&me===this.$__schema.options.discriminatorKey||this.$set(me,Ae[me]))}return this},Tt.prototype.$set=function(Ae,ve,he,me){var we=this;te.isPOJO(he)&&(me=he,he=void 0);var je,qe,Fe,Xe,Ge=me&&me.merge,rt=he&&he!==!0,bt=he===!0,at=0,Et=me&&"strict"in me,jt=Et?me.strict:this.$__.strictMode;if(rt&&((this.$__.adhocPaths||(this.$__.adhocPaths={}))[Ae]=this.$__schema.interpretAsType(Ae,he,this.$__schema.options)),Ae==null){var Kt=[ve,Ae];Ae=Kt[0],ve=Kt[1]}else if(typeof Ae!="string"){if(Ae instanceof Tt&&(Ae=Ae.$__isNested?Ae.toObject():Ae._doc),Ae==null){var Yt=[ve,Ae];Ae=Yt[0],ve=Yt[1]}Xe=ve?ve+".":"";var Zt=(je=Y(this.$__schema,Ae)).length,Jt=me&&me._skipMinimizeTopLevel||!1;if(Zt===0&&Jt)return delete me._skipMinimizeTopLevel,ve&&this.$set(ve,{}),this;me=Object.assign({},me,{_skipMinimizeTopLevel:!1});for(var ln=0;ln<Zt;++ln){Fe=je[ln];var vn=Xe?Xe+Fe:Fe;qe=this.$__schema.pathType(vn);var wn=Ae[Fe];if(he!==!0||Xe||wn==null||qe!=="nested"||this._doc[Fe]==null||delete this._doc[Fe],te.isNonBuiltinObject(wn)&&qe==="nested")this.$set(vn,wn,bt,Object.assign({},me,{_skipMarkModified:!0})),dt(this.$get(vn),vn,this);else if(jt){if(bt&&wn===void 0&&this.$get(vn)!==void 0)continue;if(qe==="adhocOrUndefined"&&(qe=H(this,vn,{typeOnly:!0})),qe==="real"||qe==="virtual")this.$set(vn,wn,bt,me);else if(qe==="nested"&&wn instanceof Tt)this.$set(vn,wn.toObject({transform:!1}),bt,me);else{if(jt==="throw")throw qe==="nested"?new M(Fe,wn):new re(Fe);qe==="nested"&&wn==null&&this.$set(vn,wn,bt,me)}}else wn!==void 0&&this.$set(vn,wn,bt,me)}for(var cn={},xn=Object.keys(this.$__schema.tree),cr=0,br=xn.length;cr<br;++cr)(Fe=xn[cr])&&this._doc.hasOwnProperty(Fe)&&(cn[Fe]=void 0);return this._doc=Object.assign(cn,this._doc),this}var hr=this.$__schema.pathType(Ae),pr=null;if(hr==="adhocOrUndefined"&&(pr=Ae.indexOf(".")===-1?[Ae]:Ae.split("."),hr=H(this,pr,{typeOnly:!0})),hr==="adhocOrUndefined"&&!Et){pr==null&&(pr=Ae.indexOf(".")===-1?[Ae]:Ae.split("."));var Kr=fe(this.$__schema,pr);Kr!==void 0&&(jt=Kr)}ve=Re(ve,!0);var mn,oi=we.$__.priorDoc!=null?we.$__.priorDoc.$__getValue(Ae):bt?void 0:we.$__getValue(Ae);if(hr==="nested"&&ve){if(x(ve)==="object"&&ve!=null){if(ve.$__!=null&&(ve=ve.toObject(ee)),ve==null)return this.invalidate(Ae,new T.CastError("Object",ve,Ae)),this;var eo=this.$isModified(Ae),nn=this.$__.savedState!=null&&this.$__.savedState.hasOwnProperty(Ae);if(this.$__.savedState!=null&&!this.$isNew&&!this.$__.savedState.hasOwnProperty(Ae)){var on=this.$__getValue(Ae);this.$__.savedState[Ae]=on;for(var bn=0,ir=Object.keys(on||{});bn<ir.length;bn++){var On=ir[bn];this.$__.savedState[Ae+"."+On]=on[On]}}if(Ge)return this.$set(ve,Ae,bt);this.$__setValue(Ae,null),be(this,Ae);var Ar=Y(this.$__schema,ve,Ae);this.$__setValue(Ae,{});var zr,kr=b(Ar);try{for(kr.s();!(zr=kr.n()).done;){var ui=zr.value;this.$set(Ae+"."+ui,ve[ui],bt,_(_({},me),{},{_skipMarkModified:!0}))}}catch(Mr){kr.e(Mr)}finally{kr.f()}return oi==null||eo&&!nn||!te.deepEqual(nn?this.$__.savedState[Ae]:oi,ve)?this.markModified(Ae):this.unmarkModified(Ae),this}return this.invalidate(Ae,new T.CastError("Object",ve,Ae)),this}if(pr==null&&(pr=Ae.indexOf(".")===-1?[Ae]:Ae.split(".")),typeof this.$__schema.aliases[pr[0]]=="string"&&(pr[0]=this.$__schema.aliases[pr[0]]),hr==="adhocOrUndefined"&&jt){var Jr;for(at=0;at<pr.length;++at){var Xr=pr.slice(0,at+1).join(".");if(at+1<pr.length&&this.$__schema.pathType(Xr)==="virtual")return se.set(Ae,ve,this),this;if((mn=this.$__schema.path(Xr))!=null){if(mn instanceof R){Jr=!0;break}if(mn.$isSchemaMap&&mn.$__schemaType instanceof R&&at<pr.length-1){Jr=!0,mn=mn.$__schemaType;break}}}if(mn==null&&(mn=H(this,Ae)),!Jr&&!mn){if(jt==="throw")throw new re(Ae);return this}}else{if(hr==="virtual")return(mn=this.$__schema.virtualpath(Ae)).applySetters(ve,this),this;mn=this.$__path(Ae)}var wi,Wn=this._doc,hi="";for(at=0;at<pr.length-1;++at)Wn=Wn[pr[at]],hi+=(hi.length!==0?".":"")+pr[at],Wn||(this.$set(hi,{}),this.$__isSelected(hi)||this.unmarkModified(hi),Wn=this.$__getValue(hi));if(pr.length<=1)wi=Ae;else{var pi=pr.length;for(at=0;at<pi;++at){var ns=pr.slice(0,at+1).join(".");if(this.$get(ns,null,{getters:!1})===null){wi=ns;break}}wi||(wi=Ae)}if(!mn)return this.$__set(wi,Ae,me,bt,pr,mn,ve,oi),hr==="nested"&&ve==null&&be(this,Ae),this;if((mn.$isSingleNested||mn.$isMongooseArray)&&function(Mr,ke){if(Mr.$__.validationError){for(var Ve=0,nt=Object.keys(Mr.$__.validationError.errors);Ve<nt.length;Ve++){var ut=nt[Ve];ut.startsWith(ke+".")&&delete Mr.$__.validationError.errors[ut]}Object.keys(Mr.$__.validationError.errors).length===0&&(Mr.$__.validationError=null)}}(this,Ae),ve!=null&&Ge&&mn.$isSingleNested){ve instanceof Tt&&(ve=ve.toObject({virtuals:!1,transform:!1}));for(var ki=0,Di=Object.keys(ve);ki<Di.length;ki++){var Hi=Di[ki];this.$set(Ae+"."+Hi,ve[Hi],bt,me)}return this}var Ur=!0;try{var Io,rs=function(){if(mn.options==null||!(ve instanceof Tt))return!1;var Mr=ve.constructor,ke=mn.options.ref;if(ke!=null&&(ke===Mr.modelName||ke===Mr.baseModelName))return!0;var Ve=mn.options.refPath;if(Ve==null)return!1;var nt=ve.get(Ve);return nt===Mr.modelName||nt===Mr.baseModelName}(),ao=!1;if(rs&&ve instanceof Tt&&(!ve.$__.wasPopulated||te.deepEqual(ve.$__.wasPopulated.value,ve._id))){var qo=mn&&mn.$isSingleNested?mn.cast(ve,this):ve._id;this.$populated(Ae,qo,E({},tn,ve.constructor)),ve.$__.wasPopulated={value:qo},ao=!0}var yo=this.$__schema.options.typeKey;if(mn.options&&Array.isArray(mn.options[yo])&&mn.options[yo].length&&mn.options[yo][0].ref&&function(Mr,ke){if(!Array.isArray(Mr)||Mr.length===0)return!1;var Ve,nt=b(Mr);try{for(nt.s();!(Ve=nt.n()).done;){var ut=Ve.value;if(!(ut instanceof Tt)||ut.constructor.modelName==null||ut.constructor.modelName!=ke&&ut.constructor.baseModelName!=ke)return!1}}catch(_t){nt.e(_t)}finally{nt.f()}return!0}(ve,mn.options[yo][0].ref)){Io=E({},tn,ve[0].constructor),this.$populated(Ae,ve.map(function(Mr){return Mr._id}),Io);var lo,Ao=b(ve);try{for(Ao.s();!(lo=Ao.n()).done;){var Ss=lo.value;Ss.$__.wasPopulated={value:Ss._id}}}catch(Mr){Ao.e(Mr)}finally{Ao.f()}ao=!0}if(!rs||!mn.$isSingleNested||!ve.$__){var Ho=this;this.$__schema.singleNestedPaths[Ae]!=null&&pr.length>1&&(Ho=kn(this,pr,this.schema)),ve=me!=null&&me.overwriteImmutable?mn.applySetters(ve,Ho,!1,oi,{overwriteImmutable:!0}):mn.applySetters(ve,Ho,!1,oi)}if(Array.isArray(ve)&&!Array.isArray(mn)&&mn.$isMongooseDocumentArray&&ve.length!==0&&ve[0]!=null&&ve[0].$__!=null&&ve[0].$__.populated!=null){for(var Kl=Object.keys(ve[0].$__.populated),za=function(){var Mr=co[Ua];we.$populated(Ae+"."+Mr,ve.map(function(ke){return ke.$populated(Mr)}),ve[0].$__.populated[Mr].options)},Ua=0,co=Kl;Ua<co.length;Ua++)za();ao=!0}if(!ao&&this.$__.populated){if(Array.isArray(ve)&&this.$__.populated[Ae])for(var Wo=0;Wo<ve.length;++Wo)ve[Wo]instanceof Tt&&ve.set(Wo,ve[Wo]._id,!0);delete this.$__.populated[Ae]}ve!=null&&mn.$isSingleNested&&function(Mr,ke,Ve){var nt=ke.schema;if(nt!=null)for(var ut=0,_t=Object.keys(nt.paths);ut<_t.length;ut++){var St=_t[ut],Dt=nt.paths[St];if(Dt.$immutableSetter!=null){var Mt=Ve==null?void 0:Ve.$__getValue(St);Dt.$immutableSetter.call(Mr,Mt)}}}(ve,mn,oi),this.$markValid(Ae)}catch(Mr){Mr instanceof T.StrictModeError&&Mr.isImmutableError?this.invalidate(Ae,Mr):Mr instanceof T.CastError?(this.invalidate(Mr.path,Mr),Mr.$originalErrorPath&&this.invalidate(Ae,new T.CastError(mn.instance,ve,Ae,Mr.$originalErrorPath))):this.invalidate(Ae,new T.CastError(mn.instance,ve,Ae,Mr)),Ur=!1}if(Ur){var Wi,Ui=null,Gi=null;if(!bt){var sa=this.$isSubdocument?this.ownerDocument():this;Ui=sa.$__.savedState,Gi=this.$isSubdocument?this.$__.fullPath+"."+Ae:Ae,sa.$__saveInitialState(Gi)}this.$__set(wi,Ae,me,bt,pr,mn,ve,oi);var Va=!((Wi=this.$__.session)===null||Wi===void 0||!Wi.transaction),Xl=this.$__.session&&this.$__.session[Dn]&&this.$__.session[Dn].has(this)&&this.$__.session[Dn].get(this).modifiedPaths&&!this.$__.session[Dn].get(this).modifiedPaths.has(Gi);Ui!=null&&Ui.hasOwnProperty(Gi)&&(!Va||Xl)&&te.deepEqual(ve,Ui[Gi])&&this.unmarkModified(Ae)}return mn.$isSingleNested&&(this.isDirectModified(Ae)||ve==null)&&be(this,Ae),this},Tt.prototype.set=Tt.prototype.$set,Tt.prototype.$__shouldModify=function(Ae,ve,he,me,we,je,qe,Fe){return!(he&&he._skipMarkModified||!this.$isNew&&!(ve in this.$__.activePaths.getStatePaths("modify"))&&(qe!==void 0||this.$__isSelected(ve))&&(qe===void 0&&ve in this.$__.activePaths.getStatePaths("default")||this.$populated(ve)&&qe instanceof Tt&&ge(qe._id,Fe)||ge(qe,Fe!==void 0?Fe:te.getValue(ve,this))&&(me||qe==null||!(ve in this.$__.activePaths.getStatePaths("default"))||!ge(qe,je.getDefault(this,me)))))},Tt.prototype.$__set=function(Ae,ve,he,me,we,je,qe,Fe){w=w||r(7734),this.$__shouldModify(Ae,ve,he,me,we,je,qe,Fe)?(this.$__.primitiveAtomics&&this.$__.primitiveAtomics[ve]&&(delete this.$__.primitiveAtomics[ve],Object.keys(this.$__.primitiveAtomics).length===0&&delete this.$__.primitiveAtomics),this.markModified(Ae),f||(f=r(8268)),qe&&te.isMongooseArray(qe)&&(qe._registerAtomic("$set",qe),te.isMongooseDocumentArray(qe)&&qe.forEach(function(Kt){Kt&&Kt.__parentArray&&(Kt.__parentArray=qe)}))):Array.isArray(qe)&&Array.isArray(Fe)&&te.isMongooseArray(qe)&&te.isMongooseArray(Fe)&&(qe[Je]=Fe[Je],qe[ze]=Fe[ze],te.isMongooseDocumentArray(qe)&&qe.forEach(function(Kt){Kt!=null&&(Kt.$isNew=!1)}));for(var Xe=this._doc,Ge=0,rt=we.length,bt="";Ge<rt;Ge++){var at=Ge+1===rt;if(bt+=bt?"."+we[Ge]:we[Ge],Ft.has(we[Ge]))return;if(at)Xe instanceof Map?Xe.set(we[Ge],qe):Xe.$isSingleNested?(we[Ge]in Xe||(Xe[we[Ge]]=qe),Xe._doc[we[Ge]]=qe):Xe[we[Ge]]=qe;else{var Et=Xe instanceof Map,jt=Et?Xe.get(we[Ge]):Xe[we[Ge]];te.isPOJO(jt)||jt&&jt instanceof w||jt&&!Array.isArray(jt)&&jt.$isSingleNested||jt&&Array.isArray(jt)||jt==null&&(jt={},Et?Xe.set(we[Ge],jt):Xe[we[Ge]]=jt),Xe=jt}}},Tt.prototype.$__getValue=function(Ae){return te.getValue(Ae,this._doc)},Tt.prototype.$inc=function(Ae,ve){var he=this;if(ve==null&&(ve=1),Array.isArray(Ae))return Ae.forEach(function(Xe){return he.$inc(Xe,ve)}),this;var me=this.$__path(Ae);if(me==null){if(this.$__.strictMode==="throw")throw new re(Ae);if(this.$__.strictMode===!0)return this}else if(me.instance!=="Number")return this.invalidate(Ae,new T.CastError(me.instance,ve,Ae)),this;var we=this.$__getValue(Ae)||0,je=!1,qe=null,Fe=ve;try{ve=me.cast(ve),Fe=(qe=me.applySetters(we+ve,this))-we,je=!0}catch(Xe){this.invalidate(Ae,new T.CastError("number",ve,Ae,Xe))}return je&&(this.$__.primitiveAtomics=this.$__.primitiveAtomics||{},this.$__.primitiveAtomics[Ae]==null?this.$__.primitiveAtomics[Ae]={$inc:Fe}:this.$__.primitiveAtomics[Ae].$inc+=Fe,this.markModified(Ae),this.$__setValue(Ae,qe)),this},Tt.prototype.$__setValue=function(Ae,ve){return te.setValue(Ae,ve,this._doc),this},Tt.prototype.get=function(Ae,ve,he){var me;he==null&&(he={}),ve&&(me=this.$__schema.interpretAsType(Ae,ve,this.$__schema.options));var we=he.noDottedPath,je=we?this.$__schema.paths[Ae]:this.$__path(Ae);if(je==null&&(je=this.$__schema.virtualpath(Ae))!=null)return je.applyGetters(void 0,this);if(we){var qe=this._doc[Ae];return me&&(qe=me.cast(qe)),je!=null&&he.getters!==!1?je.applyGetters(qe,this):qe}if(je!=null&&je.instance==="Mixed"){var Fe=this.$__schema.virtualpath(Ae);Fe!=null&&(je=Fe)}var Xe=Ae.indexOf(".")!==-1,Ge=this._doc,rt=Xe?Ae.split("."):[Ae];typeof this.$__schema.aliases[rt[0]]=="string"&&(rt[0]=this.$__schema.aliases[rt[0]]);for(var bt=0,at=rt.length;bt<at;bt++)Ge&&Ge._doc&&(Ge=Ge._doc),Ge=Ge==null?void 0:Ge instanceof Map?Ge.get(rt[bt],{getters:!1}):bt===at-1?te.getValue(rt[bt],Ge):Ge[rt[bt]];if(me&&(Ge=me.cast(Ge)),je!=null&&he.getters!==!1)Ge=je.applyGetters(Ge,this);else if(this.$__schema.nested[Ae]&&he.virtuals)return Xn(this,pe(Ge)||{},{path:Ae});return Ge},Tt.prototype[Ct]=Tt.prototype.get,Tt.prototype.$get=Tt.prototype.get,Tt.prototype.$__path=function(Ae){var ve=this.$__.adhocPaths;return(ve&&ve.hasOwnProperty(Ae)?ve[Ae]:null)||this.$__schema.path(Ae)},Tt.prototype.markModified=function(Ae,ve){this.$__saveInitialState(Ae),this.$__.activePaths.modify(Ae),ve==null||this.$isSubdocument||(this.$__.pathsToScopes=this.$__pathsToScopes||{},this.$__.pathsToScopes[Ae]=ve)},Tt.prototype.$__saveInitialState=function(Ae){var ve=this.$__.savedState,he=Ae;if(ve!=null){var me=he.indexOf("."),we=me===-1?he:he.slice(0,me);ve.hasOwnProperty(we)||(ve[we]=pe(this.$__getValue(we)))}},Tt.prototype.unmarkModified=function(Ae){this.$__.activePaths.init(Ae),this.$__.pathsToScopes!=null&&delete this.$__.pathsToScopes[Ae]},Tt.prototype.$ignore=function(Ae){this.$__.activePaths.ignore(Ae)},Tt.prototype.directModifiedPaths=function(){return Object.keys(this.$__.activePaths.getStatePaths("modify"))},Tt.prototype.$isEmpty=function(Ae){var ve={minimize:!0,virtuals:!1,getters:!1,transform:!1};if(arguments.length!==0){var he=this.$get(Ae);return he==null||x(he)==="object"&&(te.isPOJO(he)?fn(he):Object.keys(he.toObject(ve)).length===0)}return Object.keys(this.toObject(ve)).length===0},Tt.prototype.modifiedPaths=function(Ae){Ae=Ae||{};var ve=Object.keys(this.$__.activePaths.getStatePaths("modify")),he=new Set,me=0,we=0,je=ve.length;for(me=0;me<je;++me){var qe=ve[me],Fe=en(qe),Xe=Fe.length;for(we=0;we<Xe;++we)he.add(Fe[we]);if(Ae.includeChildren){var Ge=0,rt=this.$get(qe);if(x(rt)==="object"&&rt!==null){rt._doc&&(rt=rt._doc);var bt=rt.length;if(Array.isArray(rt))for(Ge=0;Ge<bt;++Ge){var at=qe+"."+Ge;if(!he.has(at)&&(he.add(at),rt[Ge]!=null&&rt[Ge].$__)){var Et=rt[Ge].modifiedPaths(),jt=0,Kt=Et.length;for(jt=0;jt<Kt;++jt)he.add(at+"."+Et[jt])}}else{var Yt=Object.keys(rt),Zt=0,Jt=Yt.length;for(Zt=0;Zt<Jt;++Zt)he.add(qe+"."+Yt[Zt])}}}}return Array.from(he)},Tt.prototype[wt]=Tt.prototype.modifiedPaths,Tt.prototype.isModified=function(Ae,ve,he){var me=this;if(Ae){var we=ve&&ve.ignoreAtomics,je=this.$__.activePaths.states.modify;if(je==null)return!1;typeof Ae=="string"&&(Ae=Ae.indexOf(" ")===-1?[Ae]:Ae.split(" "));var qe,Fe=b(Ae);try{for(Fe.s();!(qe=Fe.n()).done;)if(je[qe.value]!=null)return!0}catch(bt){Fe.e(bt)}finally{Fe.f()}var Xe=he||this[wt](),Ge=Ae.some(function(bt){return!!~Xe.indexOf(bt)}),rt=Object.keys(je);return we&&(rt=rt.filter(function(bt){var at=me.$__getValue(bt);return at==null||at[Je]==null||at[Je].$set!==void 0})),Ge||Ae.some(function(bt){return rt.some(function(at){return at===bt||bt.startsWith(at+".")})})}return this.$__.activePaths.some("modify")},Tt.prototype.$isModified=Tt.prototype.isModified,Tt.prototype[ft]=Tt.prototype.isModified,Tt.prototype.$isDefault=function(Ae){var ve=this;if(Ae==null)return this.$__.activePaths.some("default");if(typeof Ae=="string"&&Ae.indexOf(" ")===-1)return this.$__.activePaths.getStatePaths("default").hasOwnProperty(Ae);var he=Ae;return Array.isArray(he)||(he=he.split(" ")),he.some(function(me){return ve.$__.activePaths.getStatePaths("default").hasOwnProperty(me)})},Tt.prototype.$isDeleted=function(Ae){return arguments.length===0?!!this.$__.isDeleted:(this.$__.isDeleted=!!Ae,this)},Tt.prototype.isDirectModified=function(Ae){var ve=this;if(Ae==null)return this.$__.activePaths.some("modify");if(typeof Ae=="string"&&Ae.indexOf(" ")===-1)return this.$__.activePaths.getStatePaths("modify").hasOwnProperty(Ae);var he=Ae;return Array.isArray(he)||(he=he.split(" ")),he.some(function(me){return ve.$__.activePaths.getStatePaths("modify").hasOwnProperty(me)})},Tt.prototype.isInit=function(Ae){var ve=this;if(Ae==null)return this.$__.activePaths.some("init");if(typeof Ae=="string"&&Ae.indexOf(" ")===-1)return this.$__.activePaths.getStatePaths("init").hasOwnProperty(Ae);var he=Ae;return Array.isArray(he)||(he=he.split(" ")),he.some(function(me){return ve.$__.activePaths.getStatePaths("init").hasOwnProperty(me)})},Tt.prototype.isSelected=function(Ae){var ve=this;if(this.$__.selected==null)return!0;if(!Ae)return!1;if(Ae==="_id")return this.$__.selected._id!==0;if(Ae.indexOf(" ")!==-1&&(Ae=Ae.split(" ")),Array.isArray(Ae))return Ae.some(function(bt){return ve.$__isSelected(bt)});var he=Object.keys(this.$__.selected),me=null;if(he.length===1&&he[0]==="_id")return this.$__.selected._id===0;for(var we=0,je=he;we<je.length;we++){var qe=je[we];if(qe!=="_id"&&De(this.$__.selected[qe])){me=!!this.$__.selected[qe];break}}if(me===null)return!0;if(Ae in this.$__.selected)return me;for(var Fe=Ae+".",Xe=0,Ge=he;Xe<Ge.length;Xe++){var rt=Ge[Xe];if(rt!=="_id"){if(rt.startsWith(Fe))return me||rt!==Fe;if(Fe.startsWith(rt+"."))return me}}return!me},Tt.prototype.$__isSelected=Tt.prototype.isSelected,Tt.prototype.isDirectSelected=function(Ae){var ve=this;if(this.$__.selected==null)return!0;if(Ae==="_id")return this.$__.selected._id!==0;if(Ae.indexOf(" ")!==-1&&(Ae=Ae.split(" ")),Array.isArray(Ae))return Ae.some(function(Fe){return ve.isDirectSelected(Fe)});var he=Object.keys(this.$__.selected),me=null;if(he.length===1&&he[0]==="_id")return this.$__.selected._id===0;for(var we=0,je=he;we<je.length;we++){var qe=je[we];if(qe!=="_id"&&De(this.$__.selected[qe])){me=!!this.$__.selected[qe];break}}return me===null||(this.$__.selected.hasOwnProperty(Ae)?me:!me)},Tt.prototype.validate=function(){var Ae=v(h().mark(function ve(he,me){var we,je,qe=this,Fe=arguments;return h().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:if(typeof he!="function"&&typeof me!="function"&&typeof Fe[2]!="function"){Xe.next=2;break}throw new T("Document.prototype.validate() no longer accepts a callback");case 2:if(this.$op="validate",this.$isSubdocument!=null||(this.$__.validating?we=new W(this,{parentStack:me&&me.parentStack,conflictStack:this.$__.validating.stack}):this.$__.validating=new W(this,{parentStack:me&&me.parentStack})),Fe.length===1&&(x(Fe[0])!=="object"||Array.isArray(Fe[0])||(me=Fe[0],he=null)),me&&typeof me.pathsToSkip=="string"&&(je=me.pathsToSkip.indexOf(" ")===-1,me.pathsToSkip=je?[me.pathsToSkip]:me.pathsToSkip.split(" ")),we==null){Xe.next=8;break}throw we;case 8:return Xe.abrupt("return",new Promise(function(Ge,rt){qe.$__validate(he,me,function(bt){if(qe.$op=null,qe.$__.validating=null,bt!=null)return rt(bt);Ge()})}));case 9:case"end":return Xe.stop()}},ve,this)}));return function(ve,he){return Ae.apply(this,arguments)}}(),Tt.prototype.$validate=Tt.prototype.validate,Tt.prototype.$__validate=function(Ae,ve,he){var me=this;typeof Ae=="function"?(he=Ae,ve=null,Ae=null):typeof ve=="function"&&(he=ve,ve=null);var we,je=ve&&x(ve)==="object"&&"validateModifiedOnly"in ve,qe=ve&&ve.pathsToSkip||null;we=je?!!ve.validateModifiedOnly:this.$__schema.options.validateModifiedOnly;var Fe=this,Xe=function(){var Jt=me.$__.validationError;if(me.$__.validationError=null,me.$__.validating=null,we&&Jt!=null){for(var ln=0,vn=Object.keys(Jt.errors);ln<vn.length;ln++){var wn=vn[ln];me.$isModified(wn)||delete Jt.errors[wn]}Object.keys(Jt.errors).length===0&&(Jt=void 0)}if(me.$__.cachedRequired={},me.$emit("validate",Fe),me.constructor.emit("validate",Fe),Jt){for(var cn in Jt.errors)!me[et]&&Jt.errors[cn]instanceof T.CastError&&me.invalidate(cn,Jt.errors[cn]);return Jt}},Ge=dr(this,Ae,qe),rt=we?Ge[0].filter(function(Jt){return me.$isModified(Jt)}):Ge[0],bt=Ge[1];if(typeof Ae=="string"&&(Ae=Ae.split(" ")),rt.length===0)return Oe(function(){var Jt=Xe();if(Jt)return Fe.$__schema.s.hooks.execPost("validate:error",Fe,[Fe],{error:Jt},function(ln){he(ln)});he(null,Fe)});var at,Et={},jt=0,Kt=b(rt);try{for(Kt.s();!(at=Kt.n()).done;)Yt(at.value)}catch(Jt){Kt.e(Jt)}finally{Kt.f()}function Yt(Jt){Jt==null||Et[Jt]||(Et[Jt]=!0,jt++,Oe(function(){var ln=Fe.$__schema.path(Jt);if(!ln)return--jt||Zt();if(Fe.$isValid(Jt)){if(ln[Ht]!=null&&Jt!==ln.path)return--jt||Zt();var vn,wn=Fe.$__getValue(Jt);(vn=Fe.$populated(Jt))?wn=vn:wn!=null&&wn.$__!=null&&wn.$__.wasPopulated&&(wn=wn._id);var cn=Fe.$__.pathsToScopes!=null&&Jt in Fe.$__.pathsToScopes?Fe.$__.pathsToScopes[Jt]:Fe,xn=_(_({},bt[Jt]),{},{path:Jt,validateModifiedOnly:we});ln.doValidate(wn,function(cr){if(cr){if((ln.$isSingleNested||ln.$isArraySubdocument||ln.$isMongooseDocumentArray)&&cr instanceof Q)return--jt||Zt();Fe.invalidate(Jt,cr,void 0,!0)}--jt||Zt()},cn,xn)}else--jt||Zt()}))}function Zt(){var Jt=Xe();if(Jt)return Fe.$__schema.s.hooks.execPost("validate:error",Fe,[Fe],{error:Jt},function(ln){he(ln)});he(null,Fe)}},Tt.prototype.validateSync=function(Ae,ve){var he,me=this,we=this;arguments.length!==1||x(arguments[0])!=="object"||Array.isArray(arguments[0])||(ve=arguments[0],Ae=null),he=ve&&x(ve)==="object"&&"validateModifiedOnly"in ve?!!ve.validateModifiedOnly:this.$__schema.options.validateModifiedOnly;var je=ve&&ve.pathsToSkip;if(typeof Ae=="string"){var qe=Ae.indexOf(" ")===-1;Ae=qe?[Ae]:Ae.split(" ")}else typeof je=="string"&&je.indexOf(" ")!==-1&&(je=je.split(" "));for(var Fe=dr(this,Ae,je),Xe=he?Fe[0].filter(function(ln){return me.$isModified(ln)}):Fe[0],Ge=Fe[1],rt={},bt=0,at=Xe.length;bt<at;++bt){var Et=Xe[bt];if(!rt[Et]){rt[Et]=!0;var jt=we.$__schema.path(Et);if(jt&&we.$isValid(Et)){var Kt=we.$__getValue(Et),Yt=jt.doValidateSync(Kt,we,{skipSchemaValidators:Ge[Et],path:Et,validateModifiedOnly:he});if(Yt){if((jt.$isSingleNested||jt.$isArraySubdocument||jt.$isMongooseDocumentArray)&&Yt instanceof Q)continue;we.invalidate(Et,Yt,void 0,!0)}}}}var Zt=we.$__.validationError;if(we.$__.validationError=void 0,we.$emit("validate",we),we.constructor.emit("validate",we),Zt)for(var Jt in Zt.errors)Zt.errors[Jt]instanceof T.CastError&&we.invalidate(Jt,Zt.errors[Jt]);return Zt},Tt.prototype.invalidate=function(Ae,ve,he,me){if(this.$__.validationError||(this.$__.validationError=new Q(this)),!this.$__.validationError.errors[Ae])return ve&&typeof ve!="string"||(ve=new oe({path:Ae,message:ve,type:me||"user defined",value:he})),this.$__.validationError===ve||this.$__.validationError.addError(Ae,ve),this.$__.validationError},Tt.prototype.$markValid=function(Ae){this.$__.validationError&&this.$__.validationError.errors[Ae]&&(delete this.$__.validationError.errors[Ae],Object.keys(this.$__.validationError.errors).length===0&&(this.$__.validationError=null))},Tt.prototype.$isValid=function(Ae){var ve=this;return this.$__.validationError==null||Object.keys(this.$__.validationError.errors).length===0||Ae!=null&&(Ae.indexOf(" ")!==-1&&(Ae=Ae.split(" ")),Array.isArray(Ae)?Ae.some(function(he){return ve.$__.validationError.errors[he]==null}):this.$__.validationError.errors[Ae]==null)},Tt.prototype.$__reset=function(){var Ae,ve=this,he=this.$parent()===this?this.$getAllSubdocs():[],me=new Set,we=b(he);try{for(we.s();!(Ae=we.n()).done;){var je=Ae.value,qe=je.$__fullPathWithIndexes();if(je.$__reset(),this.isModified(qe)||bt(qe))if(je.$isDocumentArrayElement)me.add(je.parentArray());else{var Fe=je.$parent();Fe===this?this.$__.activePaths.clearPath(je.$basePath):Fe!=null&&Fe.$isSubdocument&&Fe.$__reset()}}}catch(at){we.e(at)}finally{we.f()}var Xe,Ge=b(me);try{for(Ge.s();!(Xe=Ge.n()).done;){var rt=Xe.value;this.$__.activePaths.clearPath(rt.$path()),rt[ze]=rt[Je],rt[Je]={}}}catch(at){Ge.e(at)}finally{Ge.f()}function bt(at){at=at.indexOf(".")===-1?[at]:at.split(".");for(var Et="",jt=0;jt<at.length;++jt)if(Et+=(Et.length?".":"")+at[jt],ve.$__.activePaths[Et]==="init")return!0;return!1}return this.$__dirty().forEach(function(at){var Et=at.value;Et&&Et[Je]&&(Et[ze]=Et[Je],Et[Je]={})}),this.$__.backup={},this.$__.backup.activePaths={modify:Object.assign({},this.$__.activePaths.getStatePaths("modify")),default:Object.assign({},this.$__.activePaths.getStatePaths("default"))},this.$__.backup.validationError=this.$__.validationError,this.$__.backup.errors=this.$errors,this.$__.activePaths.clear("modify"),this.$__.activePaths.clear("default"),this.$__.validationError=void 0,this.$errors=void 0,ve=this,this.$__schema.requiredPaths().forEach(function(at){ve.$__.activePaths.require(at)}),this},Tt.prototype.$__undoReset=function(){if(this.$__.backup!=null&&this.$__.backup.activePaths!=null){this.$__.activePaths.states.modify=this.$__.backup.activePaths.modify,this.$__.activePaths.states.default=this.$__.backup.activePaths.default,this.$__.validationError=this.$__.backup.validationError,this.$errors=this.$__.backup.errors;var Ae,ve=b(this.$__dirty());try{for(ve.s();!(Ae=ve.n()).done;){var he=Ae.value.value;he&&he[Je]&&he[ze]&&(he[Je]=he[ze])}}catch(je){ve.e(je)}finally{ve.f()}var me,we=b(this.$getAllSubdocs());try{for(we.s();!(me=we.n()).done;)me.value.$__undoReset()}catch(je){we.e(je)}finally{we.f()}}},Tt.prototype.$__dirty=function(){var Ae=this,ve=this.$__.activePaths.map("modify",function(we){return{path:we,value:Ae.$__getValue(we),schema:Ae.$__path(we)}});ve=ve.concat(this.$__.activePaths.map("default",function(we){if(we!=="_id"&&Ae.$__getValue(we)!=null)return{path:we,value:Ae.$__getValue(we),schema:Ae.$__path(we)}}));var he=new Map(ve.filter(function(we){return we!=null}).map(function(we){return[we.path,we.value]})),me=[];return ve.forEach(function(we){if(we){for(var je=null,qe=en(we.path),Fe=0;Fe<qe.length-1;Fe++)if(he.has(qe[Fe])){je=he.get(qe[Fe]);break}je==null?me.push(we):je!=null&&je[Je]!=null&&je.hasAtomics()&&(je[Je]={},je[Je].$set=je)}}),me},Tt.prototype.$__setSchema=function(Ae){U(Ae.tree,this,void 0,Ae.options);for(var ve=0,he=Object.keys(Ae.virtuals);ve<he.length;ve++){var me=he[ve];Ae.virtuals[me]._applyDefaultGetters()}Ae.path("schema")==null&&(this.schema=Ae),this.$__schema=Ae,this[It]=Ae},Tt.prototype.$__getArrayPathsToValidate=function(){return y||(y=r(5357)),this.$__.activePaths.map("init","modify",(function(Ae){return this.$__getValue(Ae)}).bind(this)).filter(function(Ae){return Ae&&Array.isArray(Ae)&&te.isMongooseDocumentArray(Ae)&&Ae.length}).reduce(function(Ae,ve){return Ae.concat(ve)},[]).filter(function(Ae){return Ae})},Tt.prototype.$getAllSubdocs=function(){function Ae(we,je,qe){var Fe=we,Xe=!1;if(qe&&(we instanceof Tt&&we[It].paths[qe]?Fe=we._doc[qe]:we instanceof Tt&&we[It].nested[qe]?(Fe=we._doc[qe],Xe=!0):Fe=we[qe]),Fe instanceof w)je.push(Fe);else if(Fe instanceof Map)je=Array.from(Fe.keys()).reduce(function(at,Et){return Ae(Fe.get(Et),at,null)},je);else if(Fe&&!Array.isArray(Fe)&&Fe.$isSingleNested)je=Object.keys(Fe._doc).reduce(function(at,Et){return Ae(Fe,at,Et)},je),je.push(Fe);else if(Fe&&te.isMongooseDocumentArray(Fe))Fe.forEach(function(at){at&&at._doc&&(je=Object.keys(at._doc).reduce(function(Et,jt){return Ae(at._doc,Et,jt)},je),at instanceof w&&je.push(at))});else if(Xe&&Fe!=null)for(var Ge=0,rt=Object.keys(Fe);Ge<rt.length;Ge++){var bt=rt[Ge];Ae(Fe,je,bt)}return je}y||(y=r(5357)),w=w||r(7734);for(var ve=[],he=0,me=Object.keys(this._doc);he<me.length;he++)Ae(this,ve,me[he]);return ve},Tt.prototype.$__handleReject=function(Ae){this.$listeners("error").length?this.$emit("error",Ae):this.constructor.listeners&&this.constructor.listeners("error").length&&this.constructor.emit("error",Ae)},Tt.prototype.$toObject=function(Ae,ve){var he,me,we,je={transform:!0,flattenDecimals:!0},qe=ve?"toJSON":"toObject",Fe=this.constructor&&this.constructor.base&&this.constructor.base.options&&z(this.constructor.base.options,qe)||{},Xe=this.$__schema&&this.$__schema.options||{};je=_(_(_({},je),Fe),Xe[qe]),(Ae=te.isPOJO(Ae)?_({},Ae):{})._calledWithOptions=Ae._calledWithOptions||_({},Ae),he=Ae._calledWithOptions.minimize!=null?Ae.minimize:je.minimize!=null?je.minimize:Xe.minimize,me=Ae._calledWithOptions.flattenMaps!=null?Ae.flattenMaps:je.flattenMaps!=null?je.flattenMaps:Xe.flattenMaps,we=Ae._calledWithOptions.flattenObjectIds!=null?Ae.flattenObjectIds:je.flattenObjectIds!=null?je.flattenObjectIds:Xe.flattenObjectIds;var Ge=Object.assign({},Ae,{_isNested:!0,json:ve,minimize:he,flattenMaps:me,flattenObjectIds:we,_seen:Ae&&Ae._seen||new Map});if(te.hasUserDefinedProperty(Ae,"getters")&&(Ge.getters=Ae.getters),te.hasUserDefinedProperty(Ae,"virtuals")&&(Ge.virtuals=Ae.virtuals),(Ae.depopulate||Ae._parentOptions&&Ae._parentOptions.depopulate)&&Ae._isNested&&this.$__.wasPopulated)return pe(this.$__.wasPopulated.value||this._id,Ge);(Ae=_(_({},je),Ae))._isNested=!0,Ae.json=ve,Ae.minimize=he,Ge._parentOptions=Ae,Ge._skipSingleNestedGetters=!1;var rt=Object.assign({},Ge);rt._skipSingleNestedGetters=!0;var bt=Ae.transform,at=pe(this._doc,Ge)||{};Ae.getters&&(function(Yt,Zt,Jt){var ln,vn,wn=Yt.$__schema,cn=Object.keys(wn.paths),xn=cn.length,cr=Yt._doc;if(!cr)return Zt;for(;xn--;){var br=(ln=cn[xn]).split("."),hr=br.length,pr=hr-1,Kr=Zt,mn=void 0;if(cr=Yt._doc,Yt.$__isSelected(ln))for(var oi=0;oi<hr;++oi){if(vn=cr[mn=br[oi]],oi===pr){var eo=Yt.$get(ln);if(Kr[mn]=pe(eo,Jt),Array.isArray(Kr[mn])&&wn.paths[ln].$embeddedSchemaType)for(var nn=0;nn<Kr[mn].length;++nn)Kr[mn][nn]=wn.paths[ln].$embeddedSchemaType.applyGetters(Kr[mn][nn],Yt)}else{if(vn==null){mn in cr&&(Kr[mn]=vn);break}Kr=Kr[mn]||(Kr[mn]={})}cr=vn}}}(this,at,rt),Ae.minimize&&(at=Be(at)||{})),(Ae.virtuals||Ae.getters&&Ae.virtuals!==!1)&&Xn(this,at,rt,Ae),Ae.versionKey===!1&&this.$__schema.options.versionKey&&delete at[this.$__schema.options.versionKey];var Et=Ae.transform;if(Et&&function(Yt,Zt){var Jt=Yt.$__schema,ln=Object.keys(Jt.paths||{});if(!Yt._doc)return Zt;for(var vn=0,wn=ln;vn<wn.length;vn++){var cn=wn[vn],xn=Jt.paths[cn];if(typeof xn.options.transform=="function"){var cr=Yt.$get(cn);if(cr===void 0)continue;var br=xn.options.transform.call(Yt,cr);Ir(cn,br),te.setValue(cn,br,Zt)}else if(xn.$embeddedSchemaType!=null&&typeof xn.$embeddedSchemaType.options.transform=="function"){var hr=Yt.$get(cn);if(hr===void 0)continue;for(var pr=[].concat(hr),Kr=xn.$embeddedSchemaType.options.transform,mn=0;mn<pr.length;++mn){var oi=Kr.call(Yt,pr[mn]);pr[mn]=oi,Ir(cn,oi)}Zt[cn]=pr}}}(this,at),Ae.useProjection&&function(Yt,Zt){var Jt=Yt.$__schema,ln=Object.keys(Jt.paths||{});if(!Yt._doc)return Zt;var vn=Yt.$__.selected;if(vn===void 0&&(vn={},_e.applyPaths(vn,Jt)),vn==null||Object.keys(vn).length===0)return Zt;for(var wn=0,cn=ln;wn<cn.length;wn++){var xn=cn[wn];vn[xn]==null||vn[xn]||delete Zt[xn]}}(this,at),Et===!0||Xe.toObject&&Et){var jt=Ae.json?Xe.toJSON:Xe.toObject;jt&&(Et=typeof Ae.transform=="function"?Ae.transform:jt.transform)}else Ae.transform=bt;if(typeof Et=="function"){var Kt=Et(this,at,Ae);Kt!==void 0&&(at=Kt)}return at},Tt.prototype.toObject=function(Ae){return this.$toObject(Ae)},Tt.prototype.toJSON=function(Ae){return this.$toObject(Ae,!0)},Tt.prototype.ownerDocument=function(){return this},Tt.prototype.parent=function(){return this.$isSubdocument||this.$__.wasPopulated?this.$__.parent:this},Tt.prototype.$parent=Tt.prototype.parent,Tt.prototype.inspect=function(Ae){var ve;te.isPOJO(Ae)&&((ve=Ae).minimize=!1);var he=this.toObject(ve);return he??"MongooseDocument { "+he+" }"},X.custom&&(Tt.prototype[X.custom]=Tt.prototype.inspect),Tt.prototype.toString=function(){var Ae=this.inspect();return typeof Ae=="string"?Ae:X(Ae)},Tt.prototype.equals=function(Ae){if(!Ae)return!1;var ve=this.$__getValue("_id"),he=Ae.$__!=null?Ae.$__getValue("_id"):Ae;return ve||he?ve&&ve.equals?ve.equals(he):ve===he:ge(this,Ae)},Tt.prototype.populate=function(){var Ae=v(h().mark(function ve(){var he,me,we,je,qe,Fe,Xe,Ge,rt,bt,at=arguments;return h().wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:if(he={},typeof(me=Array.prototype.slice.call(at))[me.length-1]!="function"){Et.next=4;break}throw new T("Document.prototype.populate() no longer accepts a callback");case 4:if(me.length!==0){we=te.populate.apply(null,me),je=b(we);try{for(je.s();!(qe=je.n()).done;)Fe=qe.value,he[Fe.path]=Fe}catch(jt){je.e(jt)}finally{je.f()}}return Xe=te.object.vals(he),Ge=this.constructor,this.$__isNested&&(Ge=this.$__[xt].constructor,rt=this.$__.nestedPath,Xe.forEach(function(jt){jt.path=rt+"."+jt.path})),this.$session()!=null&&(bt=this.$session(),Xe.forEach(function(jt){jt.options!=null?"session"in jt.options||(jt.options.session=bt):jt.options={session:bt}})),Xe.forEach(function(jt){jt._localModel=Ge}),Et.abrupt("return",Ge.populate(this,Xe));case 11:case"end":return Et.stop()}},ve,this)}));return function(){return Ae.apply(this,arguments)}}(),Tt.prototype.$getPopulatedDocs=function(){var Ae=[];this.$__.populated!=null&&(Ae=Ae.concat(Object.keys(this.$__.populated)));var ve,he=[],me=b(Ae);try{for(me.s();!(ve=me.n()).done;){var we=ve.value,je=this.$get(we);Array.isArray(je)?he=he.concat(je):je instanceof Tt&&he.push(je)}}catch(qe){me.e(qe)}finally{me.f()}return he},Tt.prototype.populated=function(Ae,ve,he){if(ve==null||ve===!0){if(!this.$__.populated||typeof Ae!="string")return;var me=Ae.endsWith(".$*")?Ae.replace(/\.\$\*$/,""):Ae,we=this.$__.populated[me];return we?ve===!0?we:we.value:void 0}this.$__.populated||(this.$__.populated={}),this.$__.populated[Ae]={value:ve,options:he};for(var je=Ae.split("."),qe=0;qe<je.length-1;++qe){var Fe=je.slice(0,qe+1).join("."),Xe=this.$get(Fe);if(Xe!=null&&Xe.$__!=null&&this.$populated(Fe)){var Ge=je.slice(qe+1).join(".");Xe.$populated(Ge,ve,he);break}}return ve},Tt.prototype.$populated=Tt.prototype.populated,Tt.prototype.$assertPopulated=function(Ae,ve){var he=this;if(Array.isArray(Ae))return Ae.forEach(function(me){return he.$assertPopulated(me,ve)}),this;if(arguments.length>1&&this.$set(ve),!this.$populated(Ae))throw new T('Expected path "'.concat(Ae,'" to be populated'));return this},Tt.prototype.depopulate=function(Ae){var ve;typeof Ae=="string"&&(Ae=Ae.indexOf(" ")===-1?[Ae]:Ae.split(" "));var he=this.$$populatedVirtuals?Object.keys(this.$$populatedVirtuals):[],me=this.$__&&this.$__.populated||{};if(arguments.length===0){var we,je=b(he);try{for(je.s();!(we=je.n()).done;){var qe=we.value;delete this.$$populatedVirtuals[qe],delete this._doc[qe],delete me[qe]}}catch(Et){je.e(Et)}finally{je.f()}for(var Fe=0,Xe=Object.keys(me);Fe<Xe.length;Fe++){var Ge=Xe[Fe];(ve=this.$populated(Ge))&&(delete me[Ge],te.setValue(Ge,ve,this._doc))}return this}var rt,bt=b(Ae);try{for(bt.s();!(rt=bt.n()).done;){var at=rt.value;ve=this.$populated(at),delete me[at],he.indexOf(at)!==-1?(delete this.$$populatedVirtuals[at],delete this._doc[at]):ve&&te.setValue(at,ve,this._doc)}}catch(Et){bt.e(Et)}finally{bt.f()}return this},Tt.prototype.$__fullPath=function(Ae){return Ae||""},Tt.prototype.getChanges=function(){var Ae=this.$__delta();return Ae?Ae[1]:{}},Tt.prototype.$clone=function(){var Ae=new this.constructor;if(Ae.$isNew=this.$isNew,this._doc&&(Ae._doc=pe(this._doc)),this.$__){var ve,he=new this.$__.constructor,me=b(Object.getOwnPropertyNames(this.$__));try{for(me.s();!(ve=me.n()).done;){var we=ve.value;we!=="activePaths"&&(he[we]=pe(this.$__[we]))}}catch(je){me.e(je)}finally{me.f()}Object.assign(he.activePaths,pe(_({},this.$__.activePaths))),Ae.$__=he}return Ae},Tt.ValidationError=Q,a.exports=Tt},7646:(a,l,r)=>{var h=r(8727),m=r(3434),v=!1;a.exports=function(){return v?m:h},a.exports.setBrowser=function(g){v=g}},9906:a=>{var l=null;a.exports.get=function(){return l},a.exports.set=function(r){l=r}},6333:(a,l)=>{l.Collection=function(){throw new Error("Cannot create a collection from browser library")},l.Connection=function(){throw new Error("Cannot create a connection from browser library")}},1795:(a,l,r)=>{function h(R){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},h(R)}function m(R,M){for(var L=0;L<M.length;L++){var W=M[L];W.enumerable=W.enumerable||!1,W.configurable=!0,"value"in W&&(W.writable=!0),Object.defineProperty(R,v(W.key),W)}}function v(R){var M=function(L,W){if(h(L)!="object"||!L)return L;var G=L[Symbol.toPrimitive];if(G!==void 0){var re=G.call(L,"string");if(h(re)!="object")return re;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(R);return h(M)=="symbol"?M:String(M)}function g(R,M,L){return M=b(M),_(R,E()?Reflect.construct(M,L||[],b(R).constructor):M.apply(R,L))}function _(R,M){if(M&&(h(M)==="object"||typeof M=="function"))return M;if(M!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}(R)}function E(){try{var R=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(E=function(){return!!R})()}function b(R){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(M){return M.__proto__||Object.getPrototypeOf(M)},b(R)}function p(R,M){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(L,W){return L.__proto__=W,L},p(R,M)}var x=r(5202),y=r(8751),f=function(R){function M(G,re,Q,oe,ae){var de;if(function(pe,U){if(!(pe instanceof U))throw new TypeError("Cannot call a class as a function")}(this,M),arguments.length>0){var be=A(re);(de=g(this,M,[T(null,G,re,Q,P(ae),be,oe)])).init(G,re,Q,oe,ae)}else de=g(this,M,[T()]);return _(de)}var L,W;return function(G,re){if(typeof re!="function"&&re!==null)throw new TypeError("Super expression must either be null or a function");G.prototype=Object.create(re&&re.prototype,{constructor:{value:G,writable:!0,configurable:!0}}),Object.defineProperty(G,"prototype",{writable:!1}),re&&p(G,re)}(M,R),L=M,(W=[{key:"toJSON",value:function(){return{stringValue:this.stringValue,valueType:this.valueType,kind:this.kind,value:this.value,path:this.path,reason:this.reason,name:this.name,message:this.message}}},{key:"init",value:function(G,re,Q,oe,ae){this.stringValue=w(re),this.messageFormat=P(ae),this.kind=G,this.value=re,this.path=Q,this.reason=oe,this.valueType=A(re)}},{key:"copy",value:function(G){this.messageFormat=G.messageFormat,this.stringValue=G.stringValue,this.kind=G.kind,this.value=G.value,this.path=G.path,this.reason=G.reason,this.message=G.message,this.valueType=G.valueType}},{key:"setModel",value:function(G){this.model=G,this.message=T(G,this.kind,this.value,this.path,this.messageFormat,this.valueType)}}])&&m(L.prototype,W),Object.defineProperty(L,"prototype",{writable:!1}),M}(x);function w(R){var M=y.inspect(R);return(M=M.replace(/^'|'$/g,'"')).startsWith('"')||(M='"'+M+'"'),M}function A(R){if(R==null)return""+R;var M=h(R);return M!=="object"||typeof R.constructor!="function"?M:R.constructor.name}function P(R){var M=R&&R._castErrorMessage||null;if(typeof M=="string"||typeof M=="function")return M}function T(R,M,L,W,G,re,Q){if(typeof G=="string"){var oe=w(L),ae=G.replace("{KIND}",M).replace("{VALUE}",oe).replace("{PATH}",W);return R!=null&&(ae=ae.replace("{MODEL}",R.modelName)),ae}if(typeof G=="function")return G(L,W,R,M);var de="Cast to "+M+" failed for value "+w(L)+(re?" (type "+re+")":"")+' at path "'+W+'"';return R!=null&&(de+=' for model "'+R.modelName+'"'),Q!=null&&typeof Q.constructor=="function"&&Q.constructor.name!=="AssertionError"&&Q.constructor.name!=="Error"&&(de+=' because of "'+Q.constructor.name+'"'),de}Object.defineProperty(f.prototype,"name",{value:"CastError"}),a.exports=f},6067:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,p),m(this,p,["For your own good, using `document.save()` to update an array which was selected using an $elemMatch projection OR populated using skip, limit, query conditions, or exclusion of the _id field when the operation results in a $pop or $set of the entire array is not supported. The following path(s) would have been modified unsafely:\n  "+y.join(`
  `)+`
Use Model.updateOne() to update these arrays instead.`])}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"DivergentArrayError"}),a.exports=E},4888:(a,l,r)=>{var h=r(5202);a.exports=h,h.messages=r(983),h.Messages=h.messages,h.DocumentNotFoundError=r(3640),h.CastError=r(1795),h.ValidationError=r(122),h.ValidatorError=r(2037),h.VersionError=r(8809),h.ParallelSaveError=r(5007),h.OverwriteModelError=r(5676),h.MissingSchemaError=r(1511),h.MongooseServerSelectionError=r(1870),h.DivergentArrayError=r(6067),h.StrictModeError=r(3328),h.StrictPopulateError=r(8967)},3346:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y,f){return function(w,A){if(!(w instanceof A))throw new TypeError("Cannot call a class as a function")}(this,p),m(this,p,['Cannot create use schema for property "'.concat(y,'" because the schema has the ').concat(f," option enabled.")])}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"InvalidSchemaOptionError"}),a.exports=E},983:(a,l)=>{var r=a.exports={};r.DocumentNotFoundError=null,r.general={},r.general.default="Validator failed for path `{PATH}` with value `{VALUE}`",r.general.required="Path `{PATH}` is required.",r.Number={},r.Number.min="Path `{PATH}` ({VALUE}) is less than minimum allowed value ({MIN}).",r.Number.max="Path `{PATH}` ({VALUE}) is more than maximum allowed value ({MAX}).",r.Number.enum="`{VALUE}` is not a valid enum value for path `{PATH}`.",r.Date={},r.Date.min="Path `{PATH}` ({VALUE}) is before minimum allowed value ({MIN}).",r.Date.max="Path `{PATH}` ({VALUE}) is after maximum allowed value ({MAX}).",r.String={},r.String.enum="`{VALUE}` is not a valid enum value for path `{PATH}`.",r.String.match="Path `{PATH}` is invalid ({VALUE}).",r.String.minlength="Path `{PATH}` (`{VALUE}`) is shorter than the minimum allowed length ({MINLENGTH}).",r.String.maxlength="Path `{PATH}` (`{VALUE}`) is longer than the maximum allowed length ({MAXLENGTH})."},1511:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,p),m(this,p,[`Schema hasn't been registered for model "`+y+`".
Use mongoose.model(name, schema)`])}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"MissingSchemaError"}),a.exports=E},5202:a=>{function l(_){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},l(_)}function r(_){var E=typeof Map=="function"?new Map:void 0;return r=function(b){if(b===null||!function(x){try{return Function.toString.call(x).indexOf("[native code]")!==-1}catch{return typeof x=="function"}}(b))return b;if(typeof b!="function")throw new TypeError("Super expression must either be null or a function");if(E!==void 0){if(E.has(b))return E.get(b);E.set(b,p)}function p(){return function(x,y,f){if(h())return Reflect.construct.apply(null,arguments);var w=[null];w.push.apply(w,y);var A=new(x.bind.apply(x,w));return f&&m(A,f.prototype),A}(b,arguments,v(this).constructor)}return p.prototype=Object.create(b.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),m(p,b)},r(_)}function h(){try{var _=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(h=function(){return!!_})()}function m(_,E){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(b,p){return b.__proto__=p,b},m(_,E)}function v(_){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(E){return E.__proto__||Object.getPrototypeOf(E)},v(_)}var g=function(_){function E(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,E),p=this,y=arguments,x=v(x=E),function(f,w){if(w&&(l(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,h()?Reflect.construct(x,y||[],v(p).constructor):x.apply(p,y));var p,x,y}return function(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(x&&x.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),Object.defineProperty(p,"prototype",{writable:!1}),x&&m(p,x)}(E,_),b=E,Object.defineProperty(b,"prototype",{writable:!1}),b;var b}(r(Error));Object.defineProperty(g.prototype,"name",{value:"MongooseError"}),a.exports=g},3640:(a,l,r)=>{function h(x){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},h(x)}function m(x,y,f){return y=g(y),function(w,A){if(A&&(h(A)==="object"||typeof A=="function"))return A;if(A!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}(w)}(x,v()?Reflect.construct(y,f||[],g(x).constructor):y.apply(x,f))}function v(){try{var x=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!x})()}function g(x){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},g(x)}function _(x,y){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(f,w){return f.__proto__=w,f},_(x,y)}var E=r(4888),b=r(8751),p=function(x){function y(w,A,P,T){var R;(function(L,W){if(!(L instanceof W))throw new TypeError("Cannot call a class as a function")})(this,y);var M=E.messages;return(R=m(this,y,[M.DocumentNotFoundError!=null?typeof M.DocumentNotFoundError=="function"?M.DocumentNotFoundError(w,A):M.DocumentNotFoundError:'No document found for query "'+b.inspect(w)+'" on model "'+A+'"'])).result=T,R.numAffected=P,R.filter=w,R.query=w,R}return function(w,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(A&&A.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),Object.defineProperty(w,"prototype",{writable:!1}),A&&_(w,A)}(y,x),f=y,Object.defineProperty(f,"prototype",{writable:!1}),f;var f}(E);Object.defineProperty(p.prototype,"name",{value:"DocumentNotFoundError"}),a.exports=p},4107:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y,f){var w;(function(P,T){if(!(P instanceof T))throw new TypeError("Cannot call a class as a function")})(this,p);var A=Array.isArray(f)?"array":"primitive value";return(w=m(this,p,["Tried to set nested object field `"+y+"` to ".concat(A," `")+f+"`"])).path=y,w}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"ObjectExpectedError"}),a.exports=E},900:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y,f,w){return function(A,P){if(!(A instanceof P))throw new TypeError("Cannot call a class as a function")}(this,p),m(this,p,['Parameter "'+f+'" to '+w+'() must be an object, got "'+y.toString()+'" (type '+h(y)+")"])}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"ObjectParameterError"}),a.exports=E},5676:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,p),m(this,p,["Cannot overwrite `"+y+"` model once compiled."])}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"OverwriteModelError"}),a.exports=E},5007:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,p),m(this,p,["Can't save() the same doc multiple times in parallel. Document: "+y._id])}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"ParallelSaveError"}),a.exports=E},7962:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,p),m(this,p,["Can't validate() the same doc multiple times in parallel. Document: "+y._id])}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(5202));Object.defineProperty(E.prototype,"name",{value:"ParallelValidateError"}),a.exports=E},1870:(a,l,r)=>{function h(A){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},h(A)}function m(A,P){for(var T=0;T<P.length;T++){var R=P[T];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(A,v(R.key),R)}}function v(A){var P=function(T,R){if(h(T)!="object"||!T)return T;var M=T[Symbol.toPrimitive];if(M!==void 0){var L=M.call(T,"string");if(h(L)!="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(T)}(A);return h(P)=="symbol"?P:String(P)}function g(A,P,T){return P=E(P),function(R,M){if(M&&(h(M)==="object"||typeof M=="function"))return M;if(M!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}(R)}(A,_()?Reflect.construct(P,T||[],E(A).constructor):P.apply(A,T))}function _(){try{var A=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_=function(){return!!A})()}function E(A){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(P){return P.__proto__||Object.getPrototypeOf(P)},E(A)}function b(A,P){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(T,R){return T.__proto__=R,T},b(A,P)}var p=r(5202),x=r(5285),y=r(2082),f=r(3871),w=function(A){function P(){return function(M,L){if(!(M instanceof L))throw new TypeError("Cannot call a class as a function")}(this,P),g(this,P,arguments)}var T,R;return function(M,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function");M.prototype=Object.create(L&&L.prototype,{constructor:{value:M,writable:!0,configurable:!0}}),Object.defineProperty(M,"prototype",{writable:!1}),L&&b(M,L)}(P,A),T=P,(R=[{key:"assimilateError",value:function(M){var L=M.reason,W=y(L)&&x(L)&&M.message.indexOf("bad auth")===-1&&M.message.indexOf("Authentication failed")===-1;for(var G in W?this.message="Could not connect to any servers in your MongoDB Atlas cluster. One common reason is that you're trying to access the database from an IP that isn't whitelisted. Make sure your current IP address is on your Atlas cluster's IP whitelist: https://www.mongodb.com/docs/atlas/security-whitelist/":f(L)?this.message="Mongoose is connecting with SSL enabled, but the server is not accepting SSL connections. Please ensure that the MongoDB server you are connecting to is configured to accept SSL connections. Learn more: https://mongoosejs.com/docs/tutorials/ssl.html":this.message=M.message,M)G!=="name"&&(this[G]=M[G]);return this}}])&&m(T.prototype,R),Object.defineProperty(T,"prototype",{writable:!1}),P}(p);Object.defineProperty(w.prototype,"name",{value:"MongooseServerSelectionError"}),a.exports=w},3328:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y,f,w){var A;return function(P,T){if(!(P instanceof T))throw new TypeError("Cannot call a class as a function")}(this,p),(A=m(this,p,[f=f||"Field `"+y+"` is not in schema and strict mode is set to throw."])).isImmutableError=!!w,A.path=y,A}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"StrictModeError"}),a.exports=E},8967:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y,f){var w;return function(A,P){if(!(A instanceof P))throw new TypeError("Cannot call a class as a function")}(this,p),(w=m(this,p,[f=f||"Cannot populate path `"+y+"` because it is not in your schema. Set the `strictPopulate` option to false to override."])).path=y,w}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"StrictPopulateError"}),a.exports=E},122:(a,l,r)=>{function h(A){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},h(A)}function m(A,P){for(var T=0;T<P.length;T++){var R=P[T];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(A,v(R.key),R)}}function v(A){var P=function(T,R){if(h(T)!="object"||!T)return T;var M=T[Symbol.toPrimitive];if(M!==void 0){var L=M.call(T,"string");if(h(L)!="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(T)}(A);return h(P)=="symbol"?P:String(P)}function g(A,P,T){return P=E(P),function(R,M){if(M&&(h(M)==="object"||typeof M=="function"))return M;if(M!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}(R)}(A,_()?Reflect.construct(P,T||[],E(A).constructor):P.apply(A,T))}function _(){try{var A=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_=function(){return!!A})()}function E(A){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(P){return P.__proto__||Object.getPrototypeOf(P)},E(A)}function b(A,P){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(T,R){return T.__proto__=R,T},b(A,P)}var p=r(5202),x=r(1981),y=r(8751),f=r(198),w=function(A){function P(M){var L,W;return function(G,re){if(!(G instanceof re))throw new TypeError("Cannot call a class as a function")}(this,P),(L=g(this,P,[W=x(M)==="model"?M.constructor.modelName+" validation failed":"Validation failed"])).errors={},L._message=W,M&&(M.$errors=L.errors),L}var T,R;return function(M,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function");M.prototype=Object.create(L&&L.prototype,{constructor:{value:M,writable:!0,configurable:!0}}),Object.defineProperty(M,"prototype",{writable:!1}),L&&b(M,L)}(P,A),T=P,(R=[{key:"toString",value:function(){return this.name+": "+f(this)}},{key:"inspect",value:function(){return Object.assign(new Error(this.message),this)}},{key:"addError",value:function(M,L){if(L instanceof P)for(var W=L.errors,G=0,re=Object.keys(W);G<re.length;G++){var Q=re[G];this.addError("".concat(M,".").concat(Q),W[Q])}else this.errors[M]=L,this.message=this._message+": "+f(this)}}])&&m(T.prototype,R),Object.defineProperty(T,"prototype",{writable:!1}),P}(p);y.inspect.custom&&(w.prototype[y.inspect.custom]=w.prototype.inspect),Object.defineProperty(w.prototype,"toJSON",{enumerable:!1,writable:!1,configurable:!0,value:function(){return Object.assign({},this,{name:this.name,message:this.message})}}),Object.defineProperty(w.prototype,"name",{value:"ValidationError"}),a.exports=w},2037:(a,l,r)=>{function h(f){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},h(f)}function m(f,w){for(var A=0;A<w.length;A++){var P=w[A];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(f,v(P.key),P)}}function v(f){var w=function(A,P){if(h(A)!="object"||!A)return A;var T=A[Symbol.toPrimitive];if(T!==void 0){var R=T.call(A,"string");if(h(R)!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(A)}(f);return h(w)=="symbol"?w:String(w)}function g(f,w,A){return w=E(w),function(P,T){if(T&&(h(T)==="object"||typeof T=="function"))return T;if(T!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}(P)}(f,_()?Reflect.construct(w,A||[],E(f).constructor):w.apply(f,A))}function _(){try{var f=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_=function(){return!!f})()}function E(f){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(w){return w.__proto__||Object.getPrototypeOf(w)},E(f)}function b(f,w){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(A,P){return A.__proto__=P,A},b(f,w)}var p=r(4888),x=function(f){function w(T,R){var M;(function(G,re){if(!(G instanceof re))throw new TypeError("Cannot call a class as a function")})(this,w);var L=T.message;L||(L=p.messages.general.default);var W=y(L,T,R);return M=g(this,w,[W]),T=Object.assign({},T,{message:W}),M.properties=T,M.kind=T.type,M.path=T.path,M.value=T.value,M.reason=T.reason,M}var A,P;return function(T,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");T.prototype=Object.create(R&&R.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),Object.defineProperty(T,"prototype",{writable:!1}),R&&b(T,R)}(w,f),A=w,(P=[{key:"toString",value:function(){return this.message}},{key:"toJSON",value:function(){return Object.assign({name:this.name,message:this.message},this)}}])&&m(A.prototype,P),Object.defineProperty(A,"prototype",{writable:!1}),w}(p);function y(f,w,A){if(typeof f=="function")return f(w,A);for(var P=0,T=Object.keys(w);P<T.length;P++){var R=T[P];R!=="message"&&(f=f.replace("{"+R.toUpperCase()+"}",w[R]))}return f}Object.defineProperty(x.prototype,"name",{value:"ValidatorError"}),Object.defineProperty(x.prototype,"properties",{enumerable:!1,writable:!0,value:null}),x.prototype.formatMessage=y,a.exports=x},8809:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p,x){return p=g(p),function(y,f){if(f&&(h(f)==="object"||typeof f=="function"))return f;if(f!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(y)}(b,v()?Reflect.construct(p,x||[],g(b).constructor):p.apply(b,x))}function v(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!b})()}function g(b){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},g(b)}function _(b,p){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(x,y){return x.__proto__=y,x},_(b,p)}var E=function(b){function p(y,f,w){var A;(function(T,R){if(!(T instanceof R))throw new TypeError("Cannot call a class as a function")})(this,p);var P=w.join(", ");return(A=m(this,p,['No matching document found for id "'+y._id+'" version '+f+' modifiedPaths "'+P+'"'])).version=f,A.modifiedPaths=w,A}return function(y,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(f&&f.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),Object.defineProperty(y,"prototype",{writable:!1}),f&&_(y,f)}(p,b),x=p,Object.defineProperty(x,"prototype",{writable:!1}),x;var x}(r(4888));Object.defineProperty(E.prototype,"name",{value:"VersionError"}),a.exports=E},6069:a=>{a.exports=function l(r){if(!Array.isArray(r))return{min:0,max:0,containsNonArrayItem:!0};if(r.length===0)return{min:1,max:1,containsNonArrayItem:!1};if(r.length===1&&!Array.isArray(r[0]))return{min:1,max:1,containsNonArrayItem:!1};for(var h=l(r[0]),m=1;m<r.length;++m){var v=l(r[m]);v.min<h.min&&(h.min=v.min),v.max>h.max&&(h.max=v.max),h.containsNonArrayItem=h.containsNonArrayItem||v.containsNonArrayItem}return h.min=h.min+1,h.max=h.max+1,h}},1973:(a,l,r)=>{function h(T){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},h(T)}var m=r(5003),v=r(6079),g=r(2862),_=r(6584),E=r(6749),b=r(1563),p=r(7339).isMongooseArray,x=r(5721),y=r(4673),f=r(8770),w=r(3636).trustedSymbol;function A(T,R,M){if(T==null)return T;if(Array.isArray(T))return function(re,Q){var oe=0,ae=re.length,de=new Array(ae);for(oe=0;oe<ae;++oe)de[oe]=A(re[oe],Q,!0);return de}(p(T)?T.__array:T,R);if(_(T)){R&&R._skipSingleNestedGetters&&T.$isSingleNested&&(R=Object.assign({},R,{getters:!1}));var L,W=T.$isSingleNested;return y(T)&&T.$__!=null&&T._doc!=null?T._doc:(L=R&&R.json&&typeof T.toJSON=="function"?T.toJSON(R):T.toObject(R),R&&R.minimize&&!T.constructor.$__required&&W&&Object.keys(L).length===0?void 0:L)}var G=T.constructor;if(G)switch(E(G)){case"Object":return P(T,R,M);case"Date":return new G(+T);case"RegExp":return function(re){var Q=new RegExp(re.source,re.flags);return Q.lastIndex!==re.lastIndex&&(Q.lastIndex=re.lastIndex),Q}(T)}return b(T,"ObjectId")?R&&R.flattenObjectIds?T.toJSON():new v(T.id):b(T,"Decimal128")?R&&R.flattenDecimals?T.toJSON():m.fromString(T.toString()):!G&&x(T)?P(T,R,M):h(T)==="object"&&T[f.schemaTypeSymbol]?T.clone():R&&R.bson&&typeof T.toBSON=="function"?T:typeof T.valueOf=="function"?T.valueOf():P(T,R,M)}function P(T,R,M){var L,W=R&&R.minimize,G=R&&R.omitUndefined,re=R&&R._seen,Q={};if(re&&re.has(T))return re.get(T);re&&re.set(T,Q),w in T&&(Q[w]=T[w]);var oe=0,ae="",de=Object.keys(T),be=de.length;for(oe=0;oe<be;++oe)if(!g.has(ae=de[oe])){var pe=A(T[ae],R,!1);W!==!1&&!G||pe!==void 0?W===!0&&pe===void 0||(L||(L=!0),Q[ae]=pe):delete Q[ae]}return W&&!M?L&&Q:Q}a.exports=A},2829:(a,l,r)=>{var h=r(365).Buffer;function m(b){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},m(b)}var v=r(4029).Binary,g=r(1563),_=r(6584);r(4888),r(8751);function E(b){return b&&m(b)==="object"&&!(b instanceof Date)&&!g(b,"ObjectId")&&(!Array.isArray(b)||b.length!==0)&&!(b instanceof h)&&!g(b,"Decimal128")&&!(b instanceof v)}l.x=function b(p,x,y,f){var w,A=(w=p&&_(p)&&!h.isBuffer(p)?Object.keys(p.toObject({transform:!1,virtuals:!1})||{}):Object.keys(p||{})).length,P={};x=x?x+".":"";for(var T=0;T<A;++T){var R=w[T],M=p[R];P[x+R]=M;var L=f&&f.path&&f.path(x+R),W=f&&f.nested&&f.nested[x+R];if(!L||L.instance!=="Mixed"){if(E(M)){if(y&&y.skipArrays&&Array.isArray(M))continue;var G=b(M,x+R,y,f);for(var re in G)P[re]=G[re];Array.isArray(M)&&(P[x+R]=M)}if(W)for(var Q=0,oe=Object.keys(f.paths);Q<oe.length;Q++){var ae=oe[Q];ae.startsWith(x+R+".")&&!P.hasOwnProperty(ae)&&(P[ae]=void 0)}}}return P}},2794:(a,l,r)=>{var h=r(1563);a.exports=function(m,v){return typeof m=="string"&&typeof v=="string"||typeof m=="number"&&typeof v=="number"?m===v:!(!h(m,"ObjectId")||!h(v,"ObjectId"))&&m.toString()===v.toString()}},4531:a=>{a.exports=function(l,r,h,m,v){var g=Object.keys(l).reduce(function(E,b){return E||b.startsWith(r+".")},!1),_=r+"."+h.options.discriminatorKey;g||v.length!==1||v[0]!==_||m.splice(m.indexOf(_),1)}},8413:(a,l,r)=>{var h=r(7291);a.exports=function(m,v,g){var _=m.schema.options.discriminatorKey,E=v!=null&&v[_];if(E==null&&(E=g),m.discriminators&&E!=null)if(m.discriminators[E])m=m.discriminators[E];else{var b=h(m.discriminators,E);b&&(m=b)}return m}},7291:(a,l,r)=>{var h=r(2794);a.exports=function(m,v){if(m==null)return null;for(var g=0,_=Object.keys(m);g<_.length;g++){var E=m[_[g]];if(E.schema&&E.schema.discriminatorMapping&&h(E.schema.discriminatorMapping.value,v))return E}return null}},2392:(a,l,r)=>{var h=r(2794);a.exports=function(m,v){if(m==null||m.discriminators==null)return null;for(var g=0,_=Object.keys(m.discriminators);g<_.length;g++){var E=_[g],b=m.discriminators[E];if(b.discriminatorMapping!=null&&h(b.discriminatorMapping.value,v))return b}return null}},2462:(a,l,r)=>{var h=r(4913),m=r(2862),v=r(1563),g=r(6079),_=r(5721);a.exports=function E(b,p,x,y){var f,w=Object.keys(p),A=0,P=w.length;if(x=x||"",!(y=y||new WeakSet).has(p)){for(y.add(p);A<P;)if(f=w[A++],(x||f!=="discriminators"&&f!=="base"&&f!=="_applyDiscriminators"&&f!=="_userProvidedOptions"&&f!=="options"&&f!=="tree")&&!(x==="tree"&&p!=null&&p.instanceOfSchema||m.has(f))){if(b[f]==null)b[f]=p[f];else if(_(p[f])){if(_(b[f])||(b[f]={}),p[f]!=null){if(p[f].$isSingleNested&&b[f].$isMongooseDocumentArray||p[f].$isMongooseDocumentArray&&b[f].$isSingleNested||p[f].$isMongooseDocumentArrayElement&&b[f].$isMongooseDocumentArrayElement)continue;if(p[f].instanceOfSchema){b[f].instanceOfSchema?h(b[f],p[f].clone(),!0):b[f]=p[f].clone();continue}if(v(p[f],"ObjectId")){b[f]=new g(p[f]);continue}}E(b[f],p[f],x?x+"."+f:f,y)}}p!=null&&p.instanceOfSchema&&(b.tree=Object.assign({},p.tree,b.tree))}}},2874:(a,l,r)=>{var h=r(7368);function m(v,g){v.$__.activePaths.default(g),v.$isSubdocument&&v.$isSingleNested&&v.$parent()!=null&&v.$parent().$__.activePaths.default(v.$__pathRelativeToParent(g))}a.exports=function(v,g,_,E,b,p){for(var x=Object.keys(v.$__schema.paths),y=x.length,f=0;f<y;++f){var w=void 0,A="",P=x[f];if(P!=="_id"||!v.$__.skipId)for(var T=v.$__schema.paths[P],R=T.splitPath(),M=R.length,L=!1,W=v._doc,G=0;G<M&&W!=null;++G){var re=R[G];if(A+=(A.length?".":"")+re,_===!0){if(A in g)break}else if(_===!1&&g&&!L){var Q=T.$isSingleNested||T.$isMongooseDocumentArray;if(A in g&&!h(g[A])||G===M-1&&Q&&E!=null&&E[A])L=!0;else if(E!=null&&!E[A])break}if(G===M-1){if(W[re]!==void 0)break;if(b!=null){if(typeof T.defaultValue=="function"){if(!T.defaultValue.$runBeforeSetters&&b||T.defaultValue.$runBeforeSetters&&!b)break}else if(!b)continue}if(p&&p[A])break;if(g&&_!==null){if(_===!0){if(P in g)continue;try{w=T.getDefault(v,!1)}catch(oe){v.invalidate(P,oe);break}w!==void 0&&(W[re]=w,m(v,P))}else if(L){try{w=T.getDefault(v,!1)}catch(oe){v.invalidate(P,oe);break}w!==void 0&&(W[re]=w,m(v,P))}}else{try{w=T.getDefault(v,!1)}catch(oe){v.invalidate(P,oe);break}w!==void 0&&(W[re]=w,m(v,P))}}else W=W[re]}}}},4134:a=>{a.exports=function(l,r,h){var m=(h=h||{}).skipDocArrays,v=0;if(!l)return v;for(var g=0,_=Object.keys(l.$__.activePaths.getStatePaths("modify"));g<_.length;g++){var E=_[g];if(m){var b=l.$__schema.path(E);if(b&&b.$isMongooseDocumentArray)continue}if(E.startsWith(r+".")&&(l.$__.activePaths.clearPath(E),++v,l.$isSubdocument)){var p=l.ownerDocument(),x=l.$__fullPath(E);p.$__.activePaths.clearPath(x)}}return v}},8724:(a,l,r)=>{var h,m=r(1973),v=r(8770).documentSchemaSymbol,g=r(4962).h,_=r(6872),E=r(8770).getSymbol,b=r(8770).scopeSymbol,p=_.isPOJO;l.M=f,l.c=w;var x=Object.freeze({minimize:!0,virtuals:!1,getters:!1,transform:!1}),y=Object.freeze({noDottedPath:!0});function f(A,P,T,R){h=h||r(8727);for(var M=R.typeKey,L=0,W=Object.keys(A);L<W.length;L++){var G=W[L],re=A[G];w({prop:G,subprops:p(re)&&Object.keys(re).length>0&&(!re[M]||M==="type"&&p(re.type)&&re.type.type)?re:null,prototype:P,prefix:T,options:R})}}function w(A){var P=A.prop,T=A.subprops,R=A.prototype,M=A.prefix,L=A.options;h=h||r(8727);var W=(M?M+".":"")+P,G=(M=M||"")?Object.freeze({}):y;T?Object.defineProperty(R,P,{enumerable:!0,configurable:!0,get:function(){var re,Q,oe=this;if(this.$__.getters||(this.$__.getters={}),!this.$__.getters[W]){var ae=Object.create(h.prototype,(re=this,Q={},Object.getOwnPropertyNames(re).forEach(function(de){["isNew","$__","$errors","errors","_doc","$locals","$op","__parentArray","__index","$isDocumentArrayElement"].indexOf(de)===-1||(Q[de]=Object.getOwnPropertyDescriptor(re,de),Q[de].enumerable=!1)}),Q));M||(ae.$__[b]=this),ae.$__.nestedPath=W,Object.defineProperty(ae,"schema",{enumerable:!1,configurable:!0,writable:!1,value:R.schema}),Object.defineProperty(ae,"$__schema",{enumerable:!1,configurable:!0,writable:!1,value:R.schema}),Object.defineProperty(ae,v,{enumerable:!1,configurable:!0,writable:!1,value:R.schema}),Object.defineProperty(ae,"toObject",{enumerable:!1,configurable:!0,writable:!1,value:function(){return m(oe.get(W,null,{virtuals:this&&this.schema&&this.schema.options&&this.schema.options.toObject&&this.schema.options.toObject.virtuals||null}))}}),Object.defineProperty(ae,"$__get",{enumerable:!1,configurable:!0,writable:!1,value:function(){return oe.get(W,null,{virtuals:this&&this.schema&&this.schema.options&&this.schema.options.toObject&&this.schema.options.toObject.virtuals||null})}}),Object.defineProperty(ae,"toJSON",{enumerable:!1,configurable:!0,writable:!1,value:function(){return oe.get(W,null,{virtuals:this&&this.schema&&this.schema.options&&this.schema.options.toJSON&&this.schema.options.toJSON.virtuals||null})}}),Object.defineProperty(ae,"$__isNested",{enumerable:!1,configurable:!0,writable:!1,value:!0}),Object.defineProperty(ae,"$isEmpty",{enumerable:!1,configurable:!0,writable:!1,value:function(){return Object.keys(this.get(W,null,x)||{}).length===0}}),Object.defineProperty(ae,"$__parent",{enumerable:!1,configurable:!0,writable:!1,value:this}),f(T,ae,W,L),this.$__.getters[W]=ae}return this.$__.getters[W]},set:function(re){re!=null&&re.$__isNested?re=re.$__get():re instanceof h&&!re.$__isNested&&(re=re.$toObject(g)),(this.$__[b]||this).$set(W,re)}}):Object.defineProperty(R,P,{enumerable:!0,configurable:!0,get:function(){return this[E].call(this.$__[b]||this,W,null,G)},set:function(re){this.$set.call(this.$__[b]||this,W,re)}})}},9585:a=>{a.exports=function(l,r,h){for(var m=r[0],v=h,g=l,_=0;_<r.length-1;++_){var E=v.path(m);if(E&&E.schema){var b=g.get(m);if(v=E.schema,m=r[_+1],Array.isArray(b)&&!isNaN(m)&&(b=b[m],m=""),b==null)break;g=b}else m+=m.length?"."+r[_+1]:r[_+1]}return g}},111:(a,l,r)=>{var h=r(9981),m=r(2392);a.exports=function v(g,_,E){for(var b=(E=E||{}).typeOnly,p=Array.isArray(_)?_:_.indexOf(".")===-1?[_]:_.split("."),x=null,y="adhocOrUndefined",f=m(g.schema,g.get(g.schema.options.discriminatorKey))||g.schema,w=0;w<p.length;++w){var A=p.slice(0,w+1).join(".");if((x=f.path(A))!=null){if(x.instance==="Mixed")return b?"real":x;if(y=f.pathType(A),(x.$isSingleNested||x.$isMongooseDocumentArrayElement)&&x.schema.discriminators!=null){var P=x.schema.discriminators,T=g.get(A+"."+h(x,"schema.options.discriminatorKey"));if(T==null||P[T]==null)continue;var R=p.slice(w+1).join(".");return v(g.get(A),R,E)}}else y="adhocOrUndefined"}return b?y:x}},719:(a,l,r)=>{function h(E,b){var p=Object.keys(E);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(E);b&&(x=x.filter(function(y){return Object.getOwnPropertyDescriptor(E,y).enumerable})),p.push.apply(p,x)}return p}function m(E){for(var b=1;b<arguments.length;b++){var p=arguments[b]!=null?arguments[b]:{};b%2?h(Object(p),!0).forEach(function(x){var y,f,w,A;y=E,f=x,w=p[x],A=function(P,T){if(v(P)!="object"||!P)return P;var R=P[Symbol.toPrimitive];if(R!==void 0){var M=R.call(P,"string");if(v(M)!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(P)}(f),(f=v(A)=="symbol"?A:String(A))in y?Object.defineProperty(y,f,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[f]=w}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(p)):h(Object(p)).forEach(function(x){Object.defineProperty(E,x,Object.getOwnPropertyDescriptor(p,x))})}return E}function v(E){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},v(E)}var g=r(6872),_=new Set(["__index","__parentArray","_doc"]);a.exports=function(E,b){if(g.isPOJO(E)&&E.$__!=null&&E._doc!=null){if(b){for(var p={},x=0,y=Object.keys(E);x<y.length;x++){var f=y[x];v(f)!=="symbol"&&f[0]!=="$"&&(_.has(f)||(p[f]=E[f]))}return m(m({},E._doc),p)}return E._doc}return E}},9449:a=>{function l(r,h){(h==null||h>r.length)&&(h=r.length);for(var m=0,v=new Array(h);m<h;m++)v[m]=r[m];return v}a.exports=function(r,h,m){if(r.length===0)return m();var v,g=r.length,_=null,E=function(b,p){var x=typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(!x){if(Array.isArray(b)||(x=function(T,R){if(T){if(typeof T=="string")return l(T,R);var M=Object.prototype.toString.call(T).slice(8,-1);return M==="Object"&&T.constructor&&(M=T.constructor.name),M==="Map"||M==="Set"?Array.from(T):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?l(T,R):void 0}}(b))||p&&b&&typeof b.length=="number"){x&&(b=x);var y=0,f=function(){};return{s:f,n:function(){return y>=b.length?{done:!0}:{done:!1,value:b[y++]}},e:function(T){throw T},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w,A=!0,P=!1;return{s:function(){x=x.call(b)},n:function(){var T=x.next();return A=T.done,T},e:function(T){P=!0,w=T},f:function(){try{A||x.return==null||x.return()}finally{if(P)throw w}}}}(r);try{for(E.s();!(v=E.n()).done;)h(v.value,function(b){if(_==null)return b!=null?m(_=b):--g<=0?m():void 0})}catch(b){E.e(b)}finally{E.f()}}},198:a=>{a.exports=function(l){for(var r,h=Object.keys(l.errors||{}),m=h.length,v=[],g=0;g<m;++g)r=h[g],l!==l.errors[r]&&v.push(r+": "+l.errors[r].message);return v.join(", ")}},9981:a=>{function l(h,m){(m==null||m>h.length)&&(m=h.length);for(var v=0,g=new Array(m);v<m;v++)g[v]=h[v];return g}function r(h,m){return h==null?h:h instanceof Map?h.get(m):h[m]}a.exports=function(h,m,v){var g,_=!1;if(typeof m=="string"){if(m.indexOf(".")===-1){var E=r(h,m);return E??v}g=m.split(".")}else if(_=!0,(g=m).length===1){var b=r(h,g[0]);return b??v}var p,x=m,y=h,f=function(A,P){var T=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!T){if(Array.isArray(A)||(T=function(re,Q){if(re){if(typeof re=="string")return l(re,Q);var oe=Object.prototype.toString.call(re).slice(8,-1);return oe==="Object"&&re.constructor&&(oe=re.constructor.name),oe==="Map"||oe==="Set"?Array.from(re):oe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(oe)?l(re,Q):void 0}}(A))||P&&A&&typeof A.length=="number"){T&&(A=T);var R=0,M=function(){};return{s:M,n:function(){return R>=A.length?{done:!0}:{done:!1,value:A[R++]}},e:function(re){throw re},f:M}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L,W=!0,G=!1;return{s:function(){T=T.call(A)},n:function(){var re=T.next();return W=re.done,re},e:function(re){G=!0,L=re},f:function(){try{W||T.return==null||T.return()}finally{if(G)throw L}}}}(g);try{for(f.s();!(p=f.n()).done;){var w=p.value;if(y==null)return v;if(!_&&y[x]!=null)return y[x];y=r(y,w),_||(x=x.substr(w.length+1))}}catch(A){f.e(A)}finally{f.f()}return y??v}},1981:a=>{a.exports=function(l){if(l!=null&&typeof l.constructor=="function")return l.constructor.name}},6749:a=>{var l=/^function\s*([^\s(]+)/;a.exports=function(r){return r.name||(r.toString().trim().match(l)||[])[1]}},1490:a=>{var l={env:{}}!==void 0&&typeof{env:{}}.nextTick=="function"?{env:{}}.nextTick.bind({env:{}}):function(r){return setTimeout(r,0)};a.exports=function(r){return l(r)}},1605:a=>{a.exports=function(l,r){var h=l.discriminatorMapping&&l.discriminatorMapping.value;if(h&&!("sparse"in r)){var m=l.options.discriminatorKey;r.partialFilterExpression=r.partialFilterExpression||{},r.partialFilterExpression[m]=h}return r}},8857:a=>{a.exports=function(l){return typeof l=="function"&&l.constructor&&l.constructor.name==="AsyncFunction"}},1563:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(r,h){return l(r)==="object"&&r!==null&&r._bsontype===h}},6584:(a,l,r)=>{var h=r(7339).isMongooseArray;a.exports=function(m){return m!=null&&(h(m)||m.$__!=null||m.isMongooseBuffer||m.$isMongooseMap)}},5721:(a,l,r)=>{var h=r(365).Buffer;a.exports=function(m){return h.isBuffer(m)||Object.prototype.toString.call(m)==="[object Object]"}},4673:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(r){if(r==null||l(r)!=="object")return!1;var h=Object.getPrototypeOf(r);return!h||h.constructor.name==="Object"}},5543:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(r){return!!r&&(l(r)==="object"||typeof r=="function")&&typeof r.then=="function"}},9130:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(r){for(var h=Object.keys(r),m=!0,v=0,g=h.length;v<g;++v)if(l(r[h[v]])==="object"&&r[h[v]]!==null){m=!1;break}return m}},8535:(a,l,r)=>{var h=r(6872).isPOJO;a.exports=function m(v){for(var g,_,E,b=Object.keys(v),p=b.length;p--;)E=v[_=b[p]],h(E)&&(v[_]=m(E)),v[_]!==void 0?g=!0:delete v[_];return g?v:void 0}},8859:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x){var y=Object.keys(p);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(p);x&&(f=f.filter(function(w){return Object.getOwnPropertyDescriptor(p,w).enumerable})),y.push.apply(y,f)}return y}function v(p){for(var x=1;x<arguments.length;x++){var y=arguments[x]!=null?arguments[x]:{};x%2?m(Object(y),!0).forEach(function(f){var w,A,P,T;w=p,A=f,P=y[f],T=function(R,M){if(h(R)!="object"||!R)return R;var L=R[Symbol.toPrimitive];if(L!==void 0){var W=L.call(R,"string");if(h(W)!="object")return W;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(R)}(A),(A=h(T)=="symbol"?T:String(T))in w?Object.defineProperty(w,A,{value:P,enumerable:!0,configurable:!0,writable:!0}):w[A]=P}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(y)):m(Object(y)).forEach(function(f){Object.defineProperty(p,f,Object.getOwnPropertyDescriptor(y,f))})}return p}var g=r(8107),_=r(8486);a.exports=b,b.middlewareFunctions=["deleteOne","save","validate","remove","updateOne","init"];var E=new Set(b.middlewareFunctions.flatMap(function(p){return[p,"$__".concat(p)]}));function b(p,x,y){var f={useErrorHandlers:!0,numCallbackParams:1,nullResultByDefault:!0,contextParameter:!0},w=(y=y||{}).decorateDoc?p:p.prototype;p.$appliedHooks=!0;for(var A=0,P=Object.keys(x.paths);A<P.length;A++){var T=P[A],R=x.paths[T],M=null;if(R.$isSingleNested)M=R.caster;else{if(!R.$isMongooseDocumentArray)continue;M=R.Constructor}if(!M.$appliedHooks&&(b(M,R.schema,v(v({},y),{},{isChildSchema:!0})),M.discriminators!=null))for(var L=0,W=Object.keys(M.discriminators);L<W.length;L++){var G=W[L];b(M.discriminators[G],M.discriminators[G].schema,y)}}var re=x.s.hooks.filter(function(H){return H.name==="updateOne"||H.name==="deleteOne"?!!H.document:H.name==="remove"||H.name==="init"?H.document==null||!!H.document:H.query==null&&H.document==null||H.document!==!1}).filter(function(H){return!x.methods[H.name]||!H.fn[g.builtInMiddleware]});p._middleware=re,w.$__originalValidate=w.$__originalValidate||w.$__validate;for(var Q=0,oe=y&&y.isChildSchema?["save","validate","deleteOne"]:["save","validate"];Q<oe.length;Q++){var ae=oe[Q],de=ae==="validate"?"$__originalValidate":"$__".concat(ae),be=re.createWrapper(ae,w[de],null,f);w["$__".concat(ae)]=be}w.$__init=re.createWrapperSync("init",w.$__init,null,f);for(var pe=Object.keys(x.methods),U=Object.assign({},f,{checkForPromise:!0}),B=function(){var H=z[N];if(E.has(H)||!re.hasHooks(H))return 0;var Y=w[H];w[H]=function(){var fe=this,Re=Array.prototype.slice.call(arguments),Oe=Re.slice(-1).pop(),De=typeof Oe=="function"?Re.slice(0,Re.length-1):Re;return _(Oe,function(ot){return fe["$__".concat(H)].apply(fe,De.concat([ot]))},p.events)},w["$__".concat(H)]=re.createWrapper(H,Y,null,U)},N=0,z=pe;N<z.length;N++)B()}},9181:(a,l,r)=>{function h(f,w){var A=typeof Symbol<"u"&&f[Symbol.iterator]||f["@@iterator"];if(!A){if(Array.isArray(f)||(A=function(W,G){if(W){if(typeof W=="string")return m(W,G);var re=Object.prototype.toString.call(W).slice(8,-1);return re==="Object"&&W.constructor&&(re=W.constructor.name),re==="Map"||re==="Set"?Array.from(W):re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re)?m(W,G):void 0}}(f))||w&&f&&typeof f.length=="number"){A&&(f=A);var P=0,T=function(){};return{s:T,n:function(){return P>=f.length?{done:!0}:{done:!1,value:f[P++]}},e:function(W){throw W},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var R,M=!0,L=!1;return{s:function(){A=A.call(f)},n:function(){var W=A.next();return M=W.done,W},e:function(W){L=!0,R=W},f:function(){try{M||A.return==null||A.return()}finally{if(L)throw R}}}}function m(f,w){(w==null||w>f.length)&&(w=f.length);for(var A=0,P=new Array(w);A<w;A++)P[A]=f[A];return P}var v=r(3861),g=r(6956),_=r(1973),E=r(8724).c,b=r(9981),p=r(6872),x=r(2462),y={toJSON:!0,toObject:!0,_id:!0,id:!0,virtuals:!0,methods:!0};a.exports=function(f,w,A,P,T,R){if(!A||!A.instanceOfSchema)throw new Error("You must pass a valid discriminator Schema");if(R=R==null||R,f.schema.discriminatorMapping&&!f.schema.discriminatorMapping.isRoot)throw new Error('Discriminator "'+w+'" can only be a discriminator of the root model');if(T){var M=b(f.base,"options.applyPluginsToDiscriminators",!1)||!R;f.base._applyPlugins(A,{skipTopLevel:!M})}else R||g(A);var L=f.schema.options.discriminatorKey,W=f.schema.path(L);if(W!=null)p.hasUserDefinedProperty(W.options,"select")||(W.options.select=!0),W.options.$skipDiscriminatorCheck=!0;else{var G={};G[L]={default:void 0,select:!0,$skipDiscriminatorCheck:!0},G[L][f.schema.options.typeKey]=String,f.schema.add(G),E({prop:L,prototype:f.prototype,options:f.schema.options})}if(A.path(L)&&A.path(L).options.$skipDiscriminatorCheck!==!0)throw new Error('Discriminator "'+w+'" cannot have field with name "'+L+'"');var re=w;if((typeof P=="string"&&P.length||P!=null)&&(re=P),function(Q,oe){Q._baseSchema=oe,oe.paths._id&&oe.paths._id.options&&!oe.paths._id.options.auto&&Q.remove("_id");for(var ae=[],de=0,be=Object.keys(oe.paths);de<be.length;de++){var pe=be[de];if(Q.nested[pe])ae.push(pe);else if(pe.indexOf(".")!==-1){var U,B="",N=h(pe.split(".").slice(0,-1));try{for(N.s();!(U=N.n()).done;){var z=U.value;B+=(B.length?".":"")+z,(Q.paths[B]instanceof v||Q.singleNestedPaths[B]instanceof v)&&ae.push(pe)}}catch(le){N.e(le)}finally{N.f()}}}x(Q,oe);for(var H=0,Y=ae;H<Y.length;H++){var fe=Y[H];delete Q.paths[fe]}Q.childSchemas.forEach(function(le){le.model.prototype.$__setSchema(le.schema)});var Re={};Re[L]={default:re,select:!0,set:function(le){if(le===re||Array.isArray(re)&&p.deepEqual(le,re))return re;throw new Error(`Can't set discriminator key "`+L+'"')},$skipDiscriminatorCheck:!0},Re[L][Q.options.typeKey]=W?W.options[Q.options.typeKey]:String,Q.add(Re),Q.discriminatorMapping={key:L,value:re,isRoot:!1},oe.options.collection&&(Q.options.collection=oe.options.collection);var Oe=Q.options.toJSON,De=Q.options.toObject,ot=Q.options._id,X=Q.options.id,ee=Object.keys(Q.options);Q.options.discriminatorKey=oe.options.discriminatorKey;for(var Le=Q._userProvidedOptions,Be=0,se=ee;Be<se.length;Be++){var _e=se[Be];if(!y[_e]&&_e in Le&&!p.deepEqual(Q.options[_e],oe.options[_e]))throw new Error("Can't customize discriminator option "+_e+" (can only modify "+Object.keys(y).join(", ")+")")}Q.options=_(oe.options);for(var te=0,$e=Object.keys(Le);te<$e.length;te++){var ge=$e[te];Q.options[ge]=Le[ge]}Oe&&(Q.options.toJSON=Oe),De&&(Q.options.toObject=De),ot!==void 0&&(Q.options._id=ot),Q.options.id=X,R&&(Q.s.hooks=f.schema.s.hooks.merge(Q.s.hooks)),T&&(Q.plugins=Array.prototype.slice.call(oe.plugins)),Q.callQueue=oe.callQueue.concat(Q.callQueue),delete Q._requiredpaths}(A,f.schema),f.discriminators||(f.discriminators={}),f.schema.discriminatorMapping||(f.schema.discriminatorMapping={key:L,value:null,isRoot:!0}),f.schema.discriminators||(f.schema.discriminators={}),f.schema.discriminators[w]=A,f.discriminators[w]&&!A.options.overwriteModels)throw new Error('Discriminator with name "'+w+'" already exists');return A}},251:a=>{var l=/\./g;a.exports=function(r){if(r.indexOf(".")===-1)return[r];for(var h=r.split(l),m=h.length,v=new Array(m),g="",_=0;_<m;++_)g+=g.length!==0?"."+h[_]:h[_],v[_]=g;return v}},5837:(a,l,r)=>{function h(v,g){(g==null||g>v.length)&&(g=v.length);for(var _=0,E=new Array(g);_<g;_++)E[_]=v[_];return E}var m=r(6872);a.exports=function(v,g){if(v._id!=null&&g!=null&&g.length!==0){var _,E=String(v._id),b=function(T,R){var M=typeof Symbol<"u"&&T[Symbol.iterator]||T["@@iterator"];if(!M){if(Array.isArray(T)||(M=function(oe,ae){if(oe){if(typeof oe=="string")return h(oe,ae);var de=Object.prototype.toString.call(oe).slice(8,-1);return de==="Object"&&oe.constructor&&(de=oe.constructor.name),de==="Map"||de==="Set"?Array.from(oe):de==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(de)?h(oe,ae):void 0}}(T))||R&&T&&typeof T.length=="number"){M&&(T=M);var L=0,W=function(){};return{s:W,n:function(){return L>=T.length?{done:!0}:{done:!1,value:T[L++]}},e:function(oe){throw oe},f:W}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G,re=!0,Q=!1;return{s:function(){M=M.call(T)},n:function(){var oe=M.next();return re=oe.done,oe},e:function(oe){Q=!0,G=oe},f:function(){try{re||M.return==null||M.return()}finally{if(Q)throw G}}}}(g);try{for(b.s();!(_=b.n()).done;){var p=_.value;if(!p.isVirtual)for(var x=p.path.split("."),y=0;y<x.length-1;++y){var f=x.slice(0,y+1).join("."),w=x.slice(y+1).join("."),A=v.get(f);if(A!=null&&m.isMongooseDocumentArray(A)){for(var P=0;P<A.length;++P)A[P]&&A[P].populated(w,p._docs[E]==null?void 0:p._docs[E][P],p);break}}}}catch(T){b.e(T)}finally{b.f()}}}},6870:(a,l,r)=>{var h=r(5202),m=r(8751);a.exports=function(v,g){if(typeof v!="string"&&typeof v!="function")throw new h('Invalid ref at path "'+g+'". Got '+m.inspect(v,{depth:0}))}},7427:a=>{a.exports=function(l){for(var r={},h=0,m=Object.keys(l);h<m.length;h++){var v=m[h];if(v.indexOf(".")!==-1)for(var g=v.split("."),_=g[0],E=0;E<g.length;++E)r[_]=1,E+1<g.length&&(_=_+"."+g[E+1]);else r[v]=1}return r}},2183:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(r){return r==null||l(r)!=="object"||!("$meta"in r)&&!("$slice"in r)}},9098:(a,l,r)=>{function h(v){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},h(v)}var m=r(2183);a.exports=function v(g){if(g==null)return null;var _=Object.keys(g),E=null;if(_.length===1&&_[0]==="_id")E=!g._id;else for(var b=0;b<_.length;++b){var p=_[b];if(p!=="_id"&&m(g[p])){E=g[p]!=null&&h(g[p])==="object"?v(g[p]):!g[p];break}}return E}},7368:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(r){return r!=null&&l(r)==="object"&&r.$slice==null&&r.$elemMatch==null&&r.$meta==null&&r.$==null}},23:a=>{a.exports=function(l,r){for(var h,m,v,g=r.split("."),_="",E=0;E<g.length;++E)if(l[_+=_.length?".":""+g[E]]){for(v=(m=Object.keys(l)).length,h=0;h<v;++h)m[E].indexOf(_+".")!==0||m[E].indexOf(r);return!0}return!1}},8486:(a,l,r)=>{var h=r(1490),m=Symbol("mongoose#emitted");a.exports=function(v,g,_,E){if(typeof v=="function")try{return g(function(b){if(b==null)v.apply(this,arguments);else{_!=null&&_.listeners!=null&&_.listeners("error").length>0&&!b[m]&&(b[m]=!0,_.emit("error",b));try{v(b)}catch(p){return h(function(){throw p})}}})}catch(b){return _!=null&&_.listeners!=null&&_.listeners("error").length>0&&!b[m]&&(b[m]=!0,_.emit("error",b)),v(b)}return new(E=E||r.g.Promise)(function(b,p){g(function(x,y){return x!=null?(_!=null&&_.listeners!=null&&_.listeners("error").length>0&&!x[m]&&(x[m]=!0,_.emit("error",x)),p(x)):arguments.length>2?b(Array.prototype.slice.call(arguments,1)):void b(y)})})}},5130:(a,l,r)=>{a.exports=m;var h=r(9853);function m(v,g){var _=g.schema.s.hooks.filter(function(E){var b=function(p){var x={};return p.hasOwnProperty("query")&&(x.query=p.query),p.hasOwnProperty("document")&&(x.document=p.document),x}(E);return E.name==="validate"?!!b.query:E.name==="deleteOne"||E.name==="updateOne"?!!b.query||Object.keys(b).length===0:E.query==null&&E.document==null||!!E.query});v.prototype._queryMiddleware=_}m.middlewareFunctions=h.concat(["validate"])},9739:(a,l,r)=>{function h(L){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},h(L)}var m=r(1795),v=r(3328),g=r(3065),_=new Set(["$and","$or"]),E=new Set(["$cmp","$eq","$lt","$lte","$gt","$gte"]),b=new Set(["$multiply","$divide","$log","$mod","$trunc","$avg","$max","$min","$stdDevPop","$stdDevSamp","$sum"]),p=new Set(["$abs","$exp","$ceil","$floor","$ln","$log10","$sqrt","$sin","$cos","$tan","$asin","$acos","$atan","$atan2","$asinh","$acosh","$atanh","$sinh","$cosh","$tanh","$degreesToRadians","$radiansToDegrees"]),x=new Set(["$arrayElemAt","$first","$last"]),y=new Set(["$year","$month","$week","$dayOfMonth","$dayOfYear","$hour","$minute","$second","$isoDayOfWeek","$isoWeekYear","$isoWeek","$millisecond"]),f=new Set(["$not"]);function w(L,W,G){if(R(L)||L===null)return L;L.$cond!=null?Array.isArray(L.$cond)?L.$cond=L.$cond.map(function(de){return w(de,W,G)}):(L.$cond.if=w(L.$cond.if,W,G),L.$cond.then=w(L.$cond.then,W,G),L.$cond.else=w(L.$cond.else,W,G)):L.$ifNull!=null?L.$ifNull.map(function(de){return w(de,W,G)}):L.$switch!=null&&(L.branches.map(function(de){return w(de,W,G)}),L.default=w(L.default,W,G));for(var re=0,Q=Object.keys(L);re<Q.length;re++){var oe=Q[re];_.has(oe)?L[oe]=L[oe].map(function(de){return w(de,W,G)}):E.has(oe)?L[oe]=T(L[oe],W,G):b.has(oe)?L[oe]=P(L[oe]):p.has(oe)?L[oe]=A(L[oe]):f.has(oe)&&(L[oe]=w(L[oe],W,G))}if(L.$in&&(L.$in=function(de,be,pe){var U=de[1];if(!R(U))return de;var B=de[0],N=be.path(U.slice(1));if(N!==null){if(!N.$isMongooseArray)throw new Error("Path must be an array for $in");return[N.$isMongooseDocumentArray?N.$embeddedSchemaType.cast(B):N.caster.cast(B),U]}if(pe===!1)return de;if(pe==="throw")throw new v("$in")}(L.$in,W,G)),L.$size&&(L.$size=A(L.$size)),L.$round){var ae=L.$round;if(!Array.isArray(ae)||ae.length<1||ae.length>2)throw new m("Array",ae,"$round");L.$round=ae.map(function(de){return A(de)})}return function(de){for(var be=Object.keys(de),pe=0,U=be.length;pe<U;++pe)de[be[pe]]===void 0&&delete de[be[pe]]}(L),L}function A(L){if(!M(L))return L;try{return g(L)}catch{throw new m("Number",L)}}function P(L){if(!Array.isArray(L)){if(!M(L))return L;try{return g(L)}catch{throw new m("Number",L)}}return L.map(function(W){if(!M(W))return W;try{return g(W)}catch{throw new m("Number",W)}})}function T(L,W,G){if(!Array.isArray(L)||L.length!==2)throw new Error("Comparison operator must be an array of length 2");L[0]=w(L[0],W,G);var re=L[0];if(M(L[1])){var Q=null,oe=null,ae=null;if(R(re))Q=re.slice(1),oe=W.path(Q);else if(h(re)==="object"&&re!=null)for(var de=0,be=Object.keys(re);de<be.length;de++){var pe=be[de];y.has(pe)&&R(re[pe])?(Q=re[pe].slice(1)+"."+pe,ae=g):x.has(pe)&&R(re[pe])&&(Q=re[pe].slice(1)+"."+pe,(oe=W.path(re[pe].slice(1)))!=null&&(oe.$isMongooseDocumentArray?oe=oe.$embeddedSchemaType:oe.$isMongooseArray&&(oe=oe.caster)))}var U=h(L[1])==="object"&&L[1]!=null&&L[1].$literal!=null;if(oe!=null)L[1]=U?{$literal:oe.cast(L[1].$literal)}:oe.cast(L[1]);else if(ae!=null)if(U)try{L[1]={$literal:ae(L[1].$literal)}}catch{throw new m(ae.name.replace(/^cast/,""),L[1],Q+".$literal")}else try{L[1]=ae(L[1])}catch{throw new m(ae.name.replace(/^cast/,""),L[1],Q)}else{if(Q!=null&&G===!0)return;if(Q!=null&&G==="throw")throw new v(Q)}}else L[1]=w(L[1]);return L}function R(L){return typeof L=="string"&&L[0]==="$"}function M(L){return!(typeof L=="string"&&L[0]==="$"||h(L)==="object"&&L!==null&&Object.keys(L).find(function(W){return W[0]==="$"})&&L.$literal==null)}a.exports=function(L,W,G){if(h(L)!=="object"||L===null)throw new Error("`$expr` must be an object");return w(L,W,G)}},1428:a=>{a.exports=function(l){switch(l){case"p":l="primary";break;case"pp":l="primaryPreferred";break;case"s":l="secondary";break;case"sp":l="secondaryPreferred";break;case"n":l="nearest"}return l}},7906:a=>{var l=new Set(["$ref","$id","$db"]);a.exports=function(r){return r[0]==="$"&&!l.has(r)}},3636:(a,l)=>{function r(m){return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},r(m)}var h=Symbol("mongoose#trustedSymbol");l.trustedSymbol=h,l.trusted=function(m){return m==null||r(m)!=="object"||(m[h]=!0),m}},9853:a=>{a.exports=Object.freeze(["countDocuments","distinct","estimatedDocumentCount","find","findOne","findOneAndReplace","findOneAndUpdate","replaceOne","updateMany","updateOne","deleteMany","deleteOne","findOneAndDelete"])},4133:a=>{a.exports=function(l){var r={_id:{auto:!0}};r._id[l.options.typeKey]="ObjectId",l.add(r)}},6956:(a,l,r)=>{var h=r(4292);a.exports=function(m){for(var v=0,g=Object.values(h);v<g.length;v++)(0,g[v])(m,{deduplicate:!0});m.plugins=Object.values(h).map(function(_){return{fn:_,opts:{deduplicate:!0}}}).concat(m.plugins)}},7658:a=>{a.exports=function(l){return l.replace(/\.\$(\[[^\]]*\])?(?=\.)/g,".0").replace(/\.\$(\[[^\]]*\])?$/g,".0")}},5379:(a,l,r)=>{var h=r(9981),m=r(5721),v=r(1605);a.exports=function(g){var _=[],E=new WeakMap,b=g.constructor.indexTypes,p=new Map;return function x(y,f,w){if(!E.has(y)){E.set(y,!0),f=f||"";for(var A=0,P=Object.keys(y.paths);A<P.length;A++){var T=P[A],R=y.paths[T];if(w==null||!w.paths[T]){if(R.$isMongooseDocumentArray||R.$isSingleNested){if(h(R,"options.excludeIndexes")!==!0&&h(R,"schemaOptions.excludeIndexes")!==!0&&h(R,"schema.options.excludeIndexes")!==!0&&x(R.schema,f+T+"."),R.schema.discriminators!=null)for(var M=R.schema.discriminators,L=0,W=Object.keys(M);L<W.length;L++)x(M[W[L]],f+T+".",R.schema);if(R.$isMongooseDocumentArray)continue}var G=R._index||R.caster&&R.caster._index;if(G!==!1&&G!=null){var re={},Q=m(G),oe=Q?G:{},ae=typeof G=="string"?G:!!Q&&G.type;if(ae&&b.indexOf(ae)!==-1)re[f+T]=ae;else if(oe.text)re[f+T]="text",delete oe.text;else{var de;de=G==="descending"||G==="desc"||G!=="ascending"&&G!=="asc"&&Number(G)===-1,re[f+T]=de?-1:1}delete oe.type,"background"in oe||(oe.background=!0),y.options.autoIndex!=null&&(oe._autoIndex=y.options.autoIndex);var be=oe&&oe.name;typeof be=="string"&&p.has(be)?Object.assign(p.get(be),re):(_.push([re,oe]),p.set(be,re))}}}E.delete(y),f?function(pe,U){for(var B=pe._indexes,N=B.length,z=0;z<N;++z){for(var H=B[z][0],Y=B[z][1],fe=Object.keys(H),Re=fe.length,Oe={},De=0;De<Re;++De){var ot=fe[De];Oe[U+ot]=H[ot]}var X=Object.assign({},Y);if(Y!=null&&Y.partialFilterExpression!=null){X.partialFilterExpression={};for(var ee=Y.partialFilterExpression,Le=0,Be=Object.keys(ee);Le<Be.length;Le++){var se=Be[Le];X.partialFilterExpression[U+se]=ee[se]}}_.push([Oe,X])}}(y,f):(y._indexes.forEach(function(pe){var U=pe[1];"background"in U||(U.background=!0),v(y,U)}),_=_.concat(y._indexes))}}(g),_}},37:(a,l,r)=>{function h(g,_){var E=typeof Symbol<"u"&&g[Symbol.iterator]||g["@@iterator"];if(!E){if(Array.isArray(g)||(E=function(w,A){if(w){if(typeof w=="string")return m(w,A);var P=Object.prototype.toString.call(w).slice(8,-1);return P==="Object"&&w.constructor&&(P=w.constructor.name),P==="Map"||P==="Set"?Array.from(w):P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P)?m(w,A):void 0}}(g))||_&&g&&typeof g.length=="number"){E&&(g=E);var b=0,p=function(){};return{s:p,n:function(){return b>=g.length?{done:!0}:{done:!1,value:g[b++]}},e:function(w){throw w},f:p}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var x,y=!0,f=!1;return{s:function(){E=E.call(g)},n:function(){var w=E.next();return y=w.done,w},e:function(w){f=!0,x=w},f:function(){try{y||E.return==null||E.return()}finally{if(f)throw x}}}}function m(g,_){(_==null||_>g.length)&&(_=g.length);for(var E=0,b=new Array(_);E<_;E++)b[E]=g[E];return b}var v=r(9981);a.exports=function(g,_,E){var b,p=E!=null?Object.keys(v(g.tree,E,{})):Object.keys(g.tree),x=new Set(Object.keys(_));if(x.size>1){b=new Set;var y,f=h(p);try{for(f.s();!(y=f.n()).done;){var w=y.value;x.has(w)&&b.add(w)}}catch(R){f.e(R)}finally{f.f()}var A,P=h(x);try{for(P.s();!(A=P.n()).done;){var T=A.value;b.has(T)||b.add(T)}}catch(R){P.e(R)}finally{P.f()}b=Array.from(b)}else b=Array.from(x);return b}},9728:a=>{a.exports=function(l,r){if(r.length!==1){for(var h=r[0],m=void 0,v=0;v<r.length-1;++v){var g=l.path(h);g&&g.schema?(m=g.schema.options.strict,l=g.schema,h=g.$isMongooseDocumentArray&&!isNaN(r[v+1])?"":r[v+1]):h+=h.length?"."+r[v+1]:r[v+1]}return m}}},9691:(a,l,r)=>{var h=r(4133);a.exports=function(m,v){return v==null||v._id==null||(m=m.clone(),v._id?m.paths._id||(h(m),m.options._id=!0):(m.remove("_id"),m.options._id=!1)),m}},6370:a=>{a.exports=function(l,r){return l==null?null:typeof l=="boolean"?r:typeof l[r]=="boolean"?l[r]?r:null:r in l?l[r]:r}},1879:a=>{function l(){return this._id!=null?String(this._id):null}a.exports=function(r){return!r.paths.id&&r.paths._id&&r.options.id&&(r.aliases&&r.aliases.id||r.virtual("id").get(l)),r}},4913:a=>{function l(r,h){(h==null||h>r.length)&&(h=r.length);for(var m=0,v=new Array(h);m<h;m++)v[m]=r[m];return v}a.exports=function(r,h,m){for(var v={},g=0,_=Object.keys(h.tree);g<_.length;g++){var E=_[g];m&&(r.paths[E]||r.nested[E]||r.singleNestedPaths[E])||(v[E]=h.tree[E])}r.options._isMerging=!0,r.add(v,null),delete r.options._isMerging,r.callQueue=r.callQueue.concat(h.callQueue),r.method(h.methods),r.static(h.statics);for(var b=0,p=Object.entries(h._userProvidedOptions);b<p.length;b++){var x=(w=p[b],A=2,function(R){if(Array.isArray(R))return R}(w)||function(R,M){var L=R==null?null:typeof Symbol<"u"&&R[Symbol.iterator]||R["@@iterator"];if(L!=null){var W,G,re,Q,oe=[],ae=!0,de=!1;try{if(re=(L=L.call(R)).next,M===0){if(Object(L)!==L)return;ae=!1}else for(;!(ae=(W=re.call(L)).done)&&(oe.push(W.value),oe.length!==M);ae=!0);}catch(be){de=!0,G=be}finally{try{if(!ae&&L.return!=null&&(Q=L.return(),Object(Q)!==Q))return}finally{if(de)throw G}}return oe}}(w,A)||function(R,M){if(R){if(typeof R=="string")return l(R,M);var L=Object.prototype.toString.call(R).slice(8,-1);return L==="Object"&&R.constructor&&(L=R.constructor.name),L==="Map"||L==="Set"?Array.from(R):L==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L)?l(R,M):void 0}}(w,A)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),y=x[0],f=x[1];y in r._userProvidedOptions||r.set(y,f)}var w,A;for(var P in h.query)r.query[P]=h.query[P];for(var T in h.virtuals)r.virtuals[T]=h.virtuals[T].clone();r._indexes=r._indexes.concat(h._indexes||[]),r.s.hooks.merge(h.s.hooks,!1)}},8828:(a,l,r)=>{var h=r(3328);a.exports=function(m){var v,g;m.$immutable?(m.$immutableSetter=(v=m.path,g=m.options.immutable,function(_,E,b,p){if(this==null||this.$__==null||this.isNew||p&&p.overwriteImmutable||!(typeof g=="function"?g.call(this,this):g))return _;var x=this.$__.priorDoc!=null?this.$__.priorDoc.$__getValue(v):this.$__getValue(v);if(this.$__.strictMode==="throw"&&_!==x)throw new h(v,"Path `"+v+"` is immutable and strict mode is set to throw.",!0);return x}),m.set(m.$immutableSetter)):m.$immutableSetter&&(m.setters=m.setters.filter(function(_){return _!==m.$immutableSetter}),delete m.$immutableSetter)}},2862:a=>{a.exports=new Set(["__proto__","constructor","prototype"])},8770:(a,l)=>{l.arrayAtomicsBackupSymbol=Symbol("mongoose#Array#atomicsBackup"),l.arrayAtomicsSymbol=Symbol("mongoose#Array#_atomics"),l.arrayParentSymbol=Symbol("mongoose#Array#_parent"),l.arrayPathSymbol=Symbol("mongoose#Array#_path"),l.arraySchemaSymbol=Symbol("mongoose#Array#_schema"),l.documentArrayParent=Symbol("mongoose#documentArrayParent"),l.documentIsSelected=Symbol("mongoose#Document#isSelected"),l.documentIsModified=Symbol("mongoose#Document#isModified"),l.documentModifiedPaths=Symbol("mongoose#Document#modifiedPaths"),l.documentSchemaSymbol=Symbol("mongoose#Document#schema"),l.getSymbol=Symbol("mongoose#Document#get"),l.modelSymbol=Symbol("mongoose#Model"),l.objectIdSymbol=Symbol("mongoose#ObjectId"),l.populateModelSymbol=Symbol("mongoose#PopulateOptions#Model"),l.schemaTypeSymbol=Symbol("mongoose#schemaType"),l.sessionNewDocuments=Symbol("mongoose#ClientSession#newDocuments"),l.scopeSymbol=Symbol("mongoose#Document#scope"),l.validatorErrorSymbol=Symbol("mongoose#validatorError")},4922:a=>{a.exports=function(l,r,h,m,v){var g=r!=null&&r.updatedAt===!1,_=r!=null&&r.createdAt===!1,E=h!=null?h():l.ownerDocument().constructor.base.now();if(!_&&(l.isNew||l.$isSubdocument)&&m&&!l.$__getValue(m)&&l.$__isSelected(m)&&l.$set(m,E,void 0,{overwriteImmutable:!0}),!g&&v&&(l.isNew||l.$isModified())){var b=E;l.isNew&&m!=null&&(b=l.$__getValue(m)),l.$set(v,b)}}},3767:(a,l,r)=>{function h(f){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},h(f)}function m(f,w){(w==null||w>f.length)&&(w=f.length);for(var A=0,P=new Array(w);A<w;A++)P[A]=f[A];return P}function v(f,w,A){var P;return P=function(T,R){if(h(T)!="object"||!T)return T;var M=T[Symbol.toPrimitive];if(M!==void 0){var L=M.call(T,"string");if(h(L)!="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(T)}(w),(w=h(P)=="symbol"?P:String(P))in f?Object.defineProperty(f,w,{value:A,enumerable:!0,configurable:!0,writable:!0}):f[w]=A,f}var g=r(4843),_=r(6434),E=r(9981),b=r(6370),p=r(4922),x=r(8107),y=new Set(["replaceOne","findOneAndReplace"]);a.exports=function(f,w){var A=f.childSchemas.find(function(Q){return!!Q.schema.options.timestamps});if(w||A){var P=b(w,"createdAt"),T=b(w,"updatedAt"),R=w!=null&&w.hasOwnProperty("currentTime")?w.currentTime:null,M={};if(f.$timestamps={createdAt:P,updatedAt:T},P&&!f.paths[P]){var L=f.base!=null?f.base.get("timestamps.createdAt.immutable"):null,W=L==null||L;M[P]=v(v({},f.options.typeKey||"type",Date),"immutable",W)}T&&!f.paths[T]&&(M[T]=Date),f.add(M),f.pre("save",function(Q){var oe=E(this,"$__.saveOptions.timestamps");if(oe===!1)return Q();p(this,oe,R,P,T),Q()}),f.methods.initializeTimestamps=function(){var Q=R!=null?R():this.constructor.base.now();if(P&&!this.get(P)&&this.$set(P,Q),T&&!this.get(T)&&this.$set(T,Q),this.$isSubdocument)return this;var oe,ae=function(be,pe){var U=typeof Symbol<"u"&&be[Symbol.iterator]||be["@@iterator"];if(!U){if(Array.isArray(be)||(U=function(fe,Re){if(fe){if(typeof fe=="string")return m(fe,Re);var Oe=Object.prototype.toString.call(fe).slice(8,-1);return Oe==="Object"&&fe.constructor&&(Oe=fe.constructor.name),Oe==="Map"||Oe==="Set"?Array.from(fe):Oe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Oe)?m(fe,Re):void 0}}(be))||pe&&be&&typeof be.length=="number"){U&&(be=U);var B=0,N=function(){};return{s:N,n:function(){return B>=be.length?{done:!0}:{done:!1,value:be[B++]}},e:function(fe){throw fe},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var z,H=!0,Y=!1;return{s:function(){U=U.call(be)},n:function(){var fe=U.next();return H=fe.done,fe},e:function(fe){Y=!0,z=fe},f:function(){try{H||U.return==null||U.return()}finally{if(Y)throw z}}}}(this.$getAllSubdocs());try{for(ae.s();!(oe=ae.n()).done;){var de=oe.value;de.initializeTimestamps&&de.initializeTimestamps()}}catch(be){ae.e(be)}finally{ae.f()}return this},re[x.builtInMiddleware]=!0;var G={query:!0,model:!1};f.pre("findOneAndReplace",G,re),f.pre("findOneAndUpdate",G,re),f.pre("replaceOne",G,re),f.pre("update",G,re),f.pre("updateOne",G,re),f.pre("updateMany",G,re)}function re(Q){var oe=R!=null?R():this.model.base.now();y.has(this.op)&&this.getUpdate()==null&&this.setUpdate({}),_(oe,P,T,this.getUpdate(),this._mongooseOptions,y.has(this.op)),g(oe,this.getUpdate(),this.model.schema),Q()}}},5285:(a,l,r)=>{var h=r(1981);a.exports=function(m){if(h(m)!=="TopologyDescription")return!1;var v=Array.from(m.servers.values());return v.length>0&&v.every(function(g){return g.type==="Unknown"})}},2082:(a,l,r)=>{function h(v,g){(g==null||g>v.length)&&(g=v.length);for(var _=0,E=new Array(g);_<g;_++)E[_]=v[_];return E}var m=r(1981);a.exports=function(v){if(m(v)!=="TopologyDescription"||v.servers.size===0)return!1;var g,_=function(b,p){var x=typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(!x){if(Array.isArray(b)||(x=function(T,R){if(T){if(typeof T=="string")return h(T,R);var M=Object.prototype.toString.call(T).slice(8,-1);return M==="Object"&&T.constructor&&(M=T.constructor.name),M==="Map"||M==="Set"?Array.from(T):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?h(T,R):void 0}}(b))||p&&b&&typeof b.length=="number"){x&&(b=x);var y=0,f=function(){};return{s:f,n:function(){return y>=b.length?{done:!0}:{done:!1,value:b[y++]}},e:function(T){throw T},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w,A=!0,P=!1;return{s:function(){x=x.call(b)},n:function(){var T=x.next();return A=T.done,T},e:function(T){P=!0,w=T},f:function(){try{A||x.return==null||x.return()}finally{if(P)throw w}}}}(v.servers.values());try{for(_.s();!(g=_.n()).done;){var E=g.value;if(E.host.endsWith(".mongodb.net")===!1||E.port!==27017)return!1}}catch(b){_.e(b)}finally{_.f()}return!0}},3871:(a,l,r)=>{var h=r(1981);a.exports=function(m){if(h(m)!=="TopologyDescription")return!1;var v=Array.from(m.servers.values());return v.length>0&&v.every(function(g){return g.error&&g.error.message.indexOf("Client network socket disconnected before secure TLS connection was established")!==-1})}},4843:(a,l,r)=>{function h(b,p){var x=typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(!x){if(Array.isArray(b)||(x=function(T,R){if(T){if(typeof T=="string")return m(T,R);var M=Object.prototype.toString.call(T).slice(8,-1);return M==="Object"&&T.constructor&&(M=T.constructor.name),M==="Map"||M==="Set"?Array.from(T):M==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M)?m(T,R):void 0}}(b))||p&&b&&typeof b.length=="number"){x&&(b=x);var y=0,f=function(){};return{s:f,n:function(){return y>=b.length?{done:!0}:{done:!1,value:b[y++]}},e:function(T){throw T},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var w,A=!0,P=!1;return{s:function(){x=x.call(b)},n:function(){var T=x.next();return A=T.done,T},e:function(T){P=!0,w=T},f:function(){try{A||x.return==null||x.return()}finally{if(P)throw w}}}}function m(b,p){(p==null||p>b.length)&&(p=b.length);for(var x=0,y=new Array(p);x<p;x++)y[x]=b[x];return y}var v=r(7658),g=r(6370);function _(b,p,x){if(p!=null){var y=Object.keys(p).some(function(Q){return Q[0]==="$"});if(y){if(p.$push&&re(p.$push),p.$addToSet&&re(p.$addToSet),p.$set!=null)for(var f=0,w=Object.keys(p.$set);f<w.length;f++){var A=w[f];E(x,A,p.$set,b)}if(p.$setOnInsert!=null)for(var P=0,T=Object.keys(p.$setOnInsert);P<T.length;P++){var R=T[P];E(x,R,p.$setOnInsert,b)}}var M,L=Object.keys(p).filter(function(Q){return Q[0]!=="$"}),W=h(L);try{for(W.s();!(M=W.n()).done;){var G=M.value;E(x,G,p,b)}}catch(Q){W.e(Q)}finally{W.f()}}function re(Q){for(var oe=function(){var be=de[ae],pe=x.path(be.replace(/\.\$\./i,".").replace(/.\$$/,""));if(Q[be]&&pe&&pe.$isMongooseDocumentArray&&pe.schema.options.timestamps){var U=pe.schema.options.timestamps,B=g(U,"createdAt"),N=g(U,"updatedAt");Q[be].$each?Q[be].$each.forEach(function(z){N!=null&&(z[N]=b),B!=null&&(z[B]=b),_(b,z,pe.schema)}):(N!=null&&(Q[be][N]=b),B!=null&&(Q[be][B]=b),_(b,Q[be],pe.schema))}},ae=0,de=Object.keys(Q);ae<de.length;ae++)oe()}}function E(b,p,x,y){var f=v(p),w=b.path(f);if(w){for(var A=[],P=f.split("."),T=P.length-1;T>0;--T){var R=b.path(P.slice(0,T).join("."));R!=null&&(R.$isMongooseDocumentArray||R.$isSingleNested)&&A.push({parentPath:p.split(".").slice(0,T).join("."),parentSchemaType:R})}if(Array.isArray(x[p])&&w.$isMongooseDocumentArray)(function(B,N,z){var H=N.schema.options.timestamps,Y=B.length;if(H)for(var fe=g(H,"createdAt"),Re=g(H,"updatedAt"),Oe=0;Oe<Y;++Oe)Re!=null&&(B[Oe][Re]=z),fe!=null&&(B[Oe][fe]=z),_(z,B[Oe],N.schema);else for(var De=0;De<Y;++De)_(z,B[De],N.schema)})(x[p],w,y);else if(x[p]&&w.$isSingleNested)(function(B,N,z){var H=N.schema.options.timestamps;if(H){var Y=g(H,"createdAt"),fe=g(H,"updatedAt");fe!=null&&(B[fe]=z),Y!=null&&(B[Y]=z),_(z,B,N.schema)}else _(z,B,N.schema)})(x[p],w,y);else if(A.length>0){var M,L=h(A);try{for(L.s();!(M=L.n()).done;){var W=M.value,G=W.parentPath,re=W.parentSchemaType,Q=re.schema.options.timestamps,oe=g(Q,"updatedAt");if(Q&&oe!=null){if(re.$isSingleNested)x[G+"."+oe]=y;else if(re.$isMongooseDocumentArray){var ae=p.substring(G.length+1);if(/^\d+$/.test(ae)){x[G+"."+ae][oe]=y;continue}var de=ae.indexOf(".");x[G+"."+(ae=de!==-1?ae.substring(0,de):ae)+"."+oe]=y}}}}catch(B){L.e(B)}finally{L.f()}}else if(w.schema!=null&&w.schema!=b&&x[p]){var be=w.schema.options.timestamps,pe=g(be,"createdAt"),U=g(be,"updatedAt");if(!be)return;U!=null&&(x[p][U]=y),pe!=null&&(x[p][pe]=y)}}}a.exports=_},6434:(a,l,r)=>{function h(g){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},h(g)}function m(g,_,E){var b;return b=function(p,x){if(h(p)!="object"||!p)return p;var y=p[Symbol.toPrimitive];if(y!==void 0){var f=y.call(p,"string");if(h(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(p)}(_),(_=h(b)=="symbol"?b:String(b))in g?Object.defineProperty(g,_,{value:E,enumerable:!0,configurable:!0,writable:!0}):g[_]=E,g}var v=r(9981);a.exports=function(g,_,E,b,p,x){var y=b,f=y,w=v(p,"timestamps",!0);if(!w||y==null)return b;var A=w!=null&&w.createdAt===!1,P=w!=null&&w.updatedAt===!1;if(x)return b&&b.$set&&(b=b.$set,y.$set={},f=y.$set),P||!E||b[E]||(f[E]=g),A||!_||b[_]||(f[_]=g),y;if(b=b||{},Array.isArray(y))return E==null||y.push({$set:m({},E,g)}),y;if(y.$set=y.$set||{},!P&&E&&(!b.$currentDate||!b.$currentDate[E])){var T=!1;if(E.indexOf(".")!==-1)for(var R=E.split("."),M=1;M<R.length;++M){var L=R.slice(-M).join("."),W=R.slice(0,-M).join(".");if(b[W]!=null){b[W][L]=g,T=!0;break}if(b.$set&&b.$set[W]){b.$set[W][L]=g,T=!0;break}}T||(y.$set[E]=g),y.hasOwnProperty(E)&&delete y[E]}if(!A&&_){b[_]&&delete b[_],b.$set&&b.$set[_]&&delete b.$set[_];var G=!1;if(_.indexOf(".")!==-1)for(var re=_.split("."),Q=1;Q<re.length;++Q){var oe=re.slice(-Q).join("."),ae=re.slice(0,-Q).join(".");if(b[ae]!=null){b[ae][oe]=g,G=!0;break}if(b.$set&&b.$set[ae]){b.$set[ae][oe]=g,G=!0;break}}G||(y.$setOnInsert=y.$setOnInsert||{},y.$setOnInsert[_]=g)}return Object.keys(y.$set).length===0&&delete y.$set,y}},6379:(a,l,r)=>{var h=r(8970).ctor("require","modify","init","default","ignore");function m(){this.activePaths=new h}a.exports=m,m.prototype.strictMode=!0,m.prototype.fullPath=void 0,m.prototype.selected=void 0,m.prototype.shardval=void 0,m.prototype.saveError=void 0,m.prototype.validationError=void 0,m.prototype.adhocPaths=void 0,m.prototype.removing=void 0,m.prototype.inserting=void 0,m.prototype.saving=void 0,m.prototype.version=void 0,m.prototype._id=void 0,m.prototype.ownerDocument=void 0,m.prototype.populate=void 0,m.prototype.populated=void 0,m.prototype.primitiveAtomics=void 0,m.prototype.wasPopulated=!1,m.prototype.scope=void 0,m.prototype.session=null,m.prototype.pathsToScopes=null,m.prototype.cachedRequired=null},4962:(a,l)=>{l.h={transform:!1,virtuals:!1,getters:!1,_skipDepopulateTopLevel:!0,depopulate:!0,flattenDecimals:!1,useProjection:!1}},7556:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p){for(var x=0;x<p.length;x++){var y=p[x];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(b,g(y.key),y)}}function v(b,p,x){return p&&m(b.prototype,p),x&&m(b,x),Object.defineProperty(b,"prototype",{writable:!1}),b}function g(b){var p=function(x,y){if(h(x)!="object"||!x)return x;var f=x[Symbol.toPrimitive];if(f!==void 0){var w=f.call(x,"string");if(h(w)!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(x)}(b);return h(p)=="symbol"?p:String(p)}var _=r(1973),E=v(function b(p){if(function(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")}(this,b),this._docs={},this._childDocs=[],p!=null&&(p=_(p),Object.assign(this,p),h(p.subPopulate)==="object"&&(this.populate=p.subPopulate),p.perDocumentLimit!=null&&p.limit!=null))throw new Error("Can not use `limit` and `perDocumentLimit` at the same time. Path: `"+p.path+"`.")});a.exports=E},3439:a=>{a.exports=Object.freeze({enumerable:!0,configurable:!0,writable:!0,value:void 0})},1033:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"enum",b),Object.defineProperty(E.prototype,"of",b),Object.defineProperty(E.prototype,"castNonArrays",b),a.exports=E},6618:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"subtype",b),a.exports=E},2114:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"min",b),Object.defineProperty(E.prototype,"max",b),Object.defineProperty(E.prototype,"expires",b),a.exports=E},6673:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"excludeIndexes",b),Object.defineProperty(E.prototype,"_id",b),a.exports=E},233:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"of",b),a.exports=E},5702:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"min",b),Object.defineProperty(E.prototype,"max",b),Object.defineProperty(E.prototype,"enum",b),Object.defineProperty(E.prototype,"populate",b),a.exports=E},3203:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"auto",b),Object.defineProperty(E.prototype,"populate",b),a.exports=E},4576:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"enum",b),Object.defineProperty(E.prototype,"match",b),Object.defineProperty(E.prototype,"lowercase",b),Object.defineProperty(E.prototype,"trim",b),Object.defineProperty(E.prototype,"uppercase",b),Object.defineProperty(E.prototype,"minLength",b),Object.defineProperty(E.prototype,"minlength",b),Object.defineProperty(E.prototype,"maxLength",b),Object.defineProperty(E.prototype,"maxlength",b),Object.defineProperty(E.prototype,"populate",b),a.exports=E},843:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x,y){return x=g(x),function(f,w){if(w&&(h(w)==="object"||typeof w=="function"))return w;if(w!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}(f)}(p,v()?Reflect.construct(x,y||[],g(p).constructor):x.apply(p,y))}function v(){try{var p=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!p})()}function g(p){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(p)}function _(p,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,f){return y.__proto__=f,y},_(p,x)}var E=function(p){function x(){return function(f,w){if(!(f instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),m(this,x,arguments)}return function(f,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(w&&w.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),w&&_(f,w)}(x,p),y=x,Object.defineProperty(y,"prototype",{writable:!1}),y;var y}(r(7820)),b=r(3439);Object.defineProperty(E.prototype,"_id",b),a.exports=E},7820:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}function m(p,x){for(var y=0;y<x.length;y++){var f=x[y];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(p,g(f.key),f)}}function v(p,x,y){return x&&m(p.prototype,x),y&&m(p,y),Object.defineProperty(p,"prototype",{writable:!1}),p}function g(p){var x=function(y,f){if(h(y)!="object"||!y)return y;var w=y[Symbol.toPrimitive];if(w!==void 0){var A=w.call(y,"string");if(h(A)!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(y)}(p);return h(x)=="symbol"?x:String(x)}var _=r(1973),E=v(function p(x){if(function(y,f){if(!(y instanceof f))throw new TypeError("Cannot call a class as a function")}(this,p),x==null)return this;Object.assign(this,_(x))}),b=r(3439);Object.defineProperty(E.prototype,"type",b),Object.defineProperty(E.prototype,"validate",b),Object.defineProperty(E.prototype,"cast",b),Object.defineProperty(E.prototype,"required",b),Object.defineProperty(E.prototype,"default",b),Object.defineProperty(E.prototype,"ref",b),Object.defineProperty(E.prototype,"refPath",b),Object.defineProperty(E.prototype,"select",b),Object.defineProperty(E.prototype,"index",b),Object.defineProperty(E.prototype,"unique",b),Object.defineProperty(E.prototype,"immutable",b),Object.defineProperty(E.prototype,"sparse",b),Object.defineProperty(E.prototype,"text",b),Object.defineProperty(E.prototype,"transform",b),a.exports=E},3819:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p){for(var x=0;x<p.length;x++){var y=p[x];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(b,g(y.key),y)}}function v(b,p,x){return p&&m(b.prototype,p),x&&m(b,x),Object.defineProperty(b,"prototype",{writable:!1}),b}function g(b){var p=function(x,y){if(h(x)!="object"||!x)return x;var f=x[Symbol.toPrimitive];if(f!==void 0){var w=f.call(x,"string");if(h(w)!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(x)}(b);return h(p)=="symbol"?p:String(p)}var _=r(3439),E=v(function b(p){(function(x,y){if(!(x instanceof y))throw new TypeError("Cannot call a class as a function")})(this,b),Object.assign(this,p),p!=null&&p.options!=null&&(this.options=Object.assign({},p.options))});Object.defineProperty(E.prototype,"ref",_),Object.defineProperty(E.prototype,"refPath",_),Object.defineProperty(E.prototype,"localField",_),Object.defineProperty(E.prototype,"foreignField",_),Object.defineProperty(E.prototype,"justOne",_),Object.defineProperty(E.prototype,"count",_),Object.defineProperty(E.prototype,"match",_),Object.defineProperty(E.prototype,"options",_),Object.defineProperty(E.prototype,"skip",_),Object.defineProperty(E.prototype,"limit",_),Object.defineProperty(E.prototype,"perDocumentLimit",_),a.exports=E},4292:(a,l,r)=>{l.saveSubdocs=r(535),l.sharding=r(7472),l.trackTransaction=r(442),l.validateBeforeSave=r(9888)},535:(a,l,r)=>{var h=r(9449);a.exports=function(m){m.s.hooks.pre("save",!1,function(v){if(this.$isSubdocument)v();else{var g=this,_=this.$getAllSubdocs();_.length?h(_,function(E,b){E.$__schema.s.hooks.execPre("save",E,function(p){b(p)})},function(E){if(E)return g.$__schema.s.hooks.execPost("save:error",g,[g],{error:E},function(b){v(b)});v()}):v()}},null,!0),m.s.hooks.post("save",function(v,g){if(this.$isSubdocument)g();else{var _=this,E=this.$getAllSubdocs();E.length?h(E,function(b,p){b.$__schema.s.hooks.execPost("save",b,[b],function(x){p(x)})},function(b){if(b)return _.$__schema.s.hooks.execPost("save:error",_,[_],{error:b},function(p){g(p)});g()}):g()}},null,!0)}},7472:(a,l,r)=>{var h=r(8770).objectIdSymbol,m=r(6872);function v(){var _,E;if(this.$__.shardval){E=(_=Object.keys(this.$__.shardval)).length,this.$where=this.$where||{};for(var b=0;b<E;++b)this.$where[_[b]]=this.$__.shardval[_[b]]}}function g(){var _=this.$__schema.options.shardKey||this.$__schema.options.shardkey;if(m.isPOJO(_))for(var E,b=this.$__.shardval={},p=Object.keys(_),x=p.length,y=0;y<x;++y)(E=this.$__getValue(p[y]))==null?b[p[y]]=E:m.isMongooseObject(E)?b[p[y]]=E.toObject({depopulate:!0,_isNested:!0}):E instanceof Date||E[h]?b[p[y]]=E:typeof E.valueOf=="function"?b[p[y]]=E.valueOf():b[p[y]]=E}a.exports=function(_){_.post("init",function(){return g.call(this),this}),_.pre("save",function(E){v.call(this),E()}),_.pre("remove",function(E){v.call(this),E()}),_.post("save",function(){g.call(this)})},a.exports.storeShard=g},442:(a,l,r)=>{function h(p,x){var y=typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(!y){if(Array.isArray(p)||(y=function(R,M){if(R){if(typeof R=="string")return m(R,M);var L=Object.prototype.toString.call(R).slice(8,-1);return L==="Object"&&R.constructor&&(L=R.constructor.name),L==="Map"||L==="Set"?Array.from(R):L==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L)?m(R,M):void 0}}(p))||x&&p&&typeof p.length=="number"){y&&(p=y);var f=0,w=function(){};return{s:w,n:function(){return f>=p.length?{done:!0}:{done:!1,value:p[f++]}},e:function(R){throw R},f:w}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var A,P=!0,T=!1;return{s:function(){y=y.call(p)},n:function(){var R=y.next();return P=R.done,R},e:function(R){T=!0,A=R},f:function(){try{P||y.return==null||y.return()}finally{if(T)throw A}}}}function m(p,x){(x==null||x>p.length)&&(x=p.length);for(var y=0,f=new Array(x);y<x;y++)f[y]=p[y];return f}var v=r(8770).arrayAtomicsSymbol,g=r(8770).sessionNewDocuments,_=r(6872);function E(p,x){var y=new Map;x=x||new Map;var f,w=h(Object.keys(p.$__.activePaths.init).concat(Object.keys(p.$__.activePaths.modify)));try{for(w.s();!(f=w.n()).done;){var A=f.value,P=p.$__getValue(A);if(P!=null&&Array.isArray(P)&&_.isMongooseDocumentArray(P)&&P.length&&P[v]!=null&&Object.keys(P[v]).length!==0){var T=x.get(A)||{};y.set(A,b(T,P[v]))}}}catch(Q){w.e(Q)}finally{w.f()}var R,M=h(p.$__dirty());try{for(M.s();!(R=M.n()).done;){var L=R.value,W=L.path,G=L.value;if(G!=null&&G[v]!=null&&Object.keys(G[v]).length!==0){var re=x.get(W)||{};y.set(W,b(re,G[v]))}}}catch(Q){M.e(Q)}finally{M.f()}return y}function b(p,x){return p=p||{},x.$pullAll!=null&&(p.$pullAll=(p.$pullAll||[]).concat(x.$pullAll)),x.$push!=null&&(p.$push=p.$push||{},p.$push.$each=(p.$push.$each||[]).concat(x.$push.$each)),x.$addToSet!=null&&(p.$addToSet=(p.$addToSet||[]).concat(x.$addToSet)),x.$set!=null&&(p.$set=Object.assign(p.$set||{},x.$set)),p}a.exports=function(p){p.pre("save",function(){var x=this.$session();if(x!=null&&x.transaction!=null&&x[g]!=null)if(x[g].has(this)){for(var y=x[g].get(this),f=0,w=Object.keys(this.$__.activePaths.getStatePaths("modify"));f<w.length;f++){var A=w[f];y.modifiedPaths.add(A)}y.atomics=E(this,y.atomics)}else{var P={};this.isNew&&(P.isNew=!0),this.$__schema.options.versionKey&&(P.versionKey=this.get(this.$__schema.options.versionKey)),P.modifiedPaths=new Set(Object.keys(this.$__.activePaths.getStatePaths("modify"))),P.atomics=E(this),x[g].set(this,P)}})}},9888:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(r){r.pre("save",!1,function(h,m){var v=this,g=this;if(this.$isSubdocument)return h();if(m&&l(m)==="object"&&"validateBeforeSave"in m?m.validateBeforeSave:this.$__schema.options.validateBeforeSave){var _=m&&l(m)==="object"&&"validateModifiedOnly"in m?{validateModifiedOnly:m.validateModifiedOnly}:null;this.$validate(_).then(function(){v.$op="save",h()},function(E){g.$__schema.s.hooks.execPost("save:error",g,[g],{error:E},function(b){g.$op="save",h(b)})})}else h()},null,!0)}},7530:(a,l,r)=>{function h(f){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},h(f)}function m(f,w){var A=typeof Symbol<"u"&&f[Symbol.iterator]||f["@@iterator"];if(!A){if(Array.isArray(f)||(A=function(W,G){if(W){if(typeof W=="string")return v(W,G);var re=Object.prototype.toString.call(W).slice(8,-1);return re==="Object"&&W.constructor&&(re=W.constructor.name),re==="Map"||re==="Set"?Array.from(W):re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re)?v(W,G):void 0}}(f))||w&&f&&typeof f.length=="number"){A&&(f=A);var P=0,T=function(){};return{s:T,n:function(){return P>=f.length?{done:!0}:{done:!1,value:f[P++]}},e:function(W){throw W},f:T}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var R,M=!0,L=!1;return{s:function(){A=A.call(f)},n:function(){var W=A.next();return M=W.done,W},e:function(W){L=!0,R=W},f:function(){try{M||A.return==null||A.return()}finally{if(L)throw R}}}}function v(f,w){(w==null||w>f.length)&&(w=f.length);for(var A=0,P=new Array(w);A<w;A++)P[A]=f[A];return P}var g=r(4531),_=r(9981),E=r(7291),b=r(2183),p=r(1973),x=r(23);function y(f){return function(w){w.options||(w.options={}),f!=null&&Array.isArray(f.virtuals)&&((f=Object.assign({},f)).virtuals=f.virtuals.filter(function(A){return typeof A=="string"&&A.startsWith(w.path+".")}).map(function(A){return A.slice(w.path.length+1)})),w.options.lean=f}}l.preparePopulationOptions=function(f,w){var A=f.options.populate,P=Object.keys(A).reduce(function(T,R){return T.concat([A[R]])},[]);return w.lean!=null&&P.filter(function(T){return(T&&T.options&&T.options.lean)==null}).forEach(y(w.lean)),P.forEach(function(T){T._localModel=f.model}),P},l.preparePopulationOptionsMQ=function(f,w){var A=f._mongooseOptions.populate,P=Object.keys(A).reduce(function(M,L){return M.concat([A[L]])},[]);w.lean!=null&&P.filter(function(M){return(M&&M.options&&M.options.lean)==null}).forEach(y(w.lean));var T=f&&f.options&&f.options.session||null;T!=null&&P.forEach(function(M){M.options!=null?"session"in M.options||(M.options.session=T):M.options={session:T}});var R=f._fieldsForExec();return P.forEach(function(M){M._queryProjection=R}),P.forEach(function(M){M._localModel=f.model}),P},l.createModel=function(f,w,A,P,T){f.hooks.execPreSync("createModel",w);var R=f.schema?f.schema.discriminatorMapping:null,M=R&&R.isRoot?R.key:null,L=w[M];if(M&&L&&f.discriminators){var W=f.discriminators[L]||E(f.discriminators,L);if(W){var G=p(P);return l.applyPaths(G,W.schema),new W(void 0,G,!0)}}var re={skipId:!0,isNew:!1,willInit:!0};return T!=null&&"defaults"in T&&(re.defaults=T.defaults),new f(void 0,A,re)},l.createModelAndInit=function(f,w,A,P,T,R,M){var L=R?{populated:R}:void 0,W=l.createModel(f,w,A,P,T);try{W.$init(w,L,M)}catch(G){M(G,W)}},l.applyPaths=function(f,w){var A,P,T=new Set;if(f){P=Object.keys(f);for(var R=[],M=0;M<P.length;++M){var L=P[M];P[M][0]==="-"&&(delete f[L],L==="-_id"?f._id=0:R.push(L.slice(1)))}P=Object.keys(f);for(var W=0;W<P.length;++W)if(P[W][0]!=="+"){var G=f[P[W]];if(b(G)&&!(P[W]==="_id"&&P.length>1)&&(!(P[W]===w.options.discriminatorKey&&P.length>1&&G!=null)||G)){A=!G;break}}for(var re=0,Q=R;re<Q.length;re++){var oe=Q[re],ae=w.path(oe);ae&&ae.selected&&A===!1?ae&&ae.selected&&A===!1&&T.add(oe):(f[oe]=0,A=!0)}}var de=[],be=[],pe=[];switch(function Le(Be,se){if(se||(se=""),pe.indexOf(Be)!==-1)return[];pe.push(Be);var _e=[];return Be.eachPath(function(te,$e){if(se&&(te=se+"."+te),$e.$isSchemaMap||te.endsWith(".$*")){var ge=f&&"+"+te in f;$e.options&&$e.options.select===!1&&!ge&&be.push(te)}else{var le=ee(te,$e);if(le!=null||Array.isArray($e)||!$e.$isMongooseArray||$e.$isMongooseDocumentArray||(le=ee(te,$e.caster)),le!=null&&_e.push(le),$e.schema){var ze=Le($e.schema,te);A===!1&&g(f,te,$e.schema,de,ze)}}}),pe.pop(),_e}(w),A){case!0:var U,B=m(be);try{for(B.s();!(U=B.n()).done;){var N=U.value;f[N]=0}}catch(Le){B.e(Le)}finally{B.f()}break;case!1:w&&w.paths._id&&w.paths._id.options&&w.paths._id.options.select===!1&&(f._id=0);var z,H=m(de);try{for(H.s();!(z=H.n()).done;){var Y=z.value;T.has(Y)||x(f,Y)||(f[Y]=f[Y]||1)}}catch(Le){H.e(Le)}finally{H.f()}break;case void 0:if(f==null)break;for(var fe=0,Re=Object.keys(f||{});fe<Re.length;fe++){var Oe=Re[fe];Oe.startsWith("+")&&delete f[Oe]}var De,ot=m(be);try{for(ot.s();!(De=ot.n()).done;){var X=De.value;f[X]==null&&(f[X]=0)}}catch(Le){ot.e(Le)}finally{ot.f()}}function ee(Le,Be){if(f!=null&&typeof Be.selected=="boolean"&&(Be.selected!==!1||!f[Le]))if(A||!Be.selected||Le!==w.options.discriminatorKey||f[Le]==null||f[Le]){if(A!==!1||!Be.selected||f[Le]==null||f[Le]){var se="+"+Le;if(f&&se in f)return delete f[se],void(A===!1&&P.length>1&&!~P.indexOf(Le)&&(f[Le]=1));for(var _e=Le.split("."),te="",$e=0;$e<_e.length;++$e)if(te+=te.length?"."+_e[$e]:_e[$e],be.indexOf(te)!==-1)return;if(!A&&Be&&Be.options&&Be.options.$skipDiscriminatorCheck)for(var ge="",le=0;le<_e.length;++le){ge+=(ge.length===0?"":".")+_e[le];var ze=_(f,ge,!1)||_(f,ge+".$",!1);if(ze&&h(ze)!=="object")return}return(Be.selected?de:be).push(Le),Le}delete f[Le]}else delete f[Le]}}},5506:(a,l,r)=>{var h=r(365).Buffer;function m(ge,le){var ze=Object.keys(ge);if(Object.getOwnPropertySymbols){var Je=Object.getOwnPropertySymbols(ge);le&&(Je=Je.filter(function(et){return Object.getOwnPropertyDescriptor(ge,et).enumerable})),ze.push.apply(ze,Je)}return ze}function v(ge,le,ze){var Je;return Je=function(et,ft){if(g(et)!="object"||!et)return et;var wt=et[Symbol.toPrimitive];if(wt!==void 0){var It=wt.call(et,"string");if(g(It)!="object")return It;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(et)}(le),(le=g(Je)=="symbol"?Je:String(Je))in ge?Object.defineProperty(ge,le,{value:ze,enumerable:!0,configurable:!0,writable:!0}):ge[le]=ze,ge}function g(ge){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(le){return typeof le}:function(le){return le&&typeof Symbol=="function"&&le.constructor===Symbol&&le!==Symbol.prototype?"symbol":typeof le},g(ge)}function _(ge,le){return function(ze){if(Array.isArray(ze))return ze}(ge)||function(ze,Je){var et=ze==null?null:typeof Symbol<"u"&&ze[Symbol.iterator]||ze["@@iterator"];if(et!=null){var ft,wt,It,Ct,tn=[],xt=!0,Ht=!1;try{if(It=(et=et.call(ze)).next,Je===0){if(Object(et)!==et)return;xt=!1}else for(;!(xt=(ft=It.call(et)).done)&&(tn.push(ft.value),tn.length!==Je);xt=!0);}catch(en){Ht=!0,wt=en}finally{try{if(!xt&&et.return!=null&&(Ct=et.return(),Object(Ct)!==Ct))return}finally{if(Ht)throw wt}}return tn}}(ge,le)||b(ge,le)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function E(ge,le){var ze=typeof Symbol<"u"&&ge[Symbol.iterator]||ge["@@iterator"];if(!ze){if(Array.isArray(ge)||(ze=b(ge))||le&&ge&&typeof ge.length=="number"){ze&&(ge=ze);var Je=0,et=function(){};return{s:et,n:function(){return Je>=ge.length?{done:!0}:{done:!1,value:ge[Je++]}},e:function(Ct){throw Ct},f:et}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft,wt=!0,It=!1;return{s:function(){ze=ze.call(ge)},n:function(){var Ct=ze.next();return wt=Ct.done,Ct},e:function(Ct){It=!0,ft=Ct},f:function(){try{wt||ze.return==null||ze.return()}finally{if(It)throw ft}}}}function b(ge,le){if(ge){if(typeof ge=="string")return p(ge,le);var ze=Object.prototype.toString.call(ge).slice(8,-1);return ze==="Object"&&ge.constructor&&(ze=ge.constructor.name),ze==="Map"||ze==="Set"?Array.from(ge):ze==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ze)?p(ge,le):void 0}}function p(ge,le){(le==null||le>ge.length)&&(le=ge.length);for(var ze=0,Je=new Array(le);ze<le;ze++)Je[ze]=ge[ze];return Je}var x,y=r(9620).EventEmitter,f=r(3138),w=r(5202),A=r(3207),P=r(7820),T=r(3819),R=r(9546),M=r(4133),L=r(1973),W=r(9981),G=r(1981),re=r(5379),Q=r(1428),oe=r(1879),ae=r(4913),de=r(3564),be=r(3767),pe=r(6872),U=r(6870),B=r(8751),N=/\.\d+(\.|$)/,z=r(5130).middlewareFunctions,H=r(8859).middlewareFunctions,Y=z.concat(H).reduce(function(ge,le){return ge.add(le)},new Set),fe=pe.isPOJO,Re=0,Oe=/^\d+$/;function De(ge,le){if(!(this instanceof De))return new De(ge,le);if(this.obj=ge,this.paths={},this.aliases={},this.subpaths={},this.virtuals={},this.singleNestedPaths={},this.nested={},this.inherits={},this.callQueue=[],this._indexes=[],this._searchIndexes=[],this.methods=le&&le.methods||{},this.methodOptions={},this.statics=le&&le.statics||{},this.tree={},this.query=le&&le.query||{},this.childSchemas=[],this.plugins=[],this.$id=++Re,this.mapPaths=[],this.s={hooks:new f},this.options=this.defaultOptions(le),Array.isArray(ge)){var ze,Je=E(ge);try{for(Je.s();!(ze=Je.n()).done;){var et=ze.value;this.add(et)}}catch(en){Je.e(en)}finally{Je.f()}}else ge&&this.add(ge);if(le&&le.virtuals)for(var ft=le.virtuals,wt=0,It=Object.keys(ft);wt<It.length;wt++){var Ct=It[wt],tn=ft[Ct].options?ft[Ct].options:void 0,xt=this.virtual(Ct,tn);ft[Ct].get&&xt.get(ft[Ct].get),ft[Ct].set&&xt.set(ft[Ct].set)}var Ht=ge&&ge._id&&pe.isObject(ge._id);!this.paths._id&&this.options._id&&!Ht&&M(this),this.setupTimestamp(this.options.timestamps)}function ot(ge,le){for(var ze=0,Je=Object.keys(le);ze<Je.length;ze++){var et=Je[ze],ft=null;if(le[et]!=null)ft=le[et];else{var wt=W(ge.paths[et],"options");if(wt==null)continue;ft=wt.alias}if(ft){var It=ge.paths[et].path;if(Array.isArray(ft)){var Ct,tn=E(ft);try{for(tn.s();!(Ct=tn.n()).done;){var xt=Ct.value;if(typeof xt!="string")throw new Error("Invalid value for alias option on "+It+", got "+xt);ge.aliases[xt]=It,ge.virtual(xt).get(function(Ht){return function(){return typeof this.get=="function"?this.get(Ht):this[Ht]}}(It)).set(function(Ht){return function(en){return this.$set(Ht,en)}}(It))}}catch(Ht){tn.e(Ht)}finally{tn.f()}}else{if(typeof ft!="string")throw new Error("Invalid value for alias option on "+It+", got "+ft);ge.aliases[ft]=It,ge.virtual(ft).get(function(Ht){return function(){return typeof this.get=="function"?this.get(Ht):this[Ht]}}(It)).set(function(Ht){return function(en){return this.$set(Ht,en)}}(It))}}}}De.prototype=Object.create(y.prototype),De.prototype.constructor=De,De.prototype.instanceOfSchema=!0,Object.defineProperty(De.prototype,"$schemaType",{configurable:!1,enumerable:!1,writable:!0}),Object.defineProperty(De.prototype,"childSchemas",{configurable:!1,enumerable:!0,writable:!0}),Object.defineProperty(De.prototype,"virtuals",{configurable:!1,enumerable:!0,writable:!0}),De.prototype.obj,De.prototype.paths,De.prototype.tree,De.prototype.clone=function(){var ge=this,le=this._clone();return le.on("init",function(ze){return ge.emit("init",ze)}),le},De.prototype._clone=function(ge){var le=new(ge=ge||(this.base==null?De:this.base.Schema))({},this._userProvidedOptions);le.base=this.base,le.obj=this.obj,le.options=L(this.options),le.callQueue=this.callQueue.map(function(dt){return dt}),le.methods=L(this.methods),le.methodOptions=L(this.methodOptions),le.statics=L(this.statics),le.query=L(this.query),le.plugins=Array.prototype.slice.call(this.plugins),le._indexes=L(this._indexes),le._searchIndexes=L(this._searchIndexes),le.s.hooks=this.s.hooks.clone(),le.tree=L(this.tree),le.paths=Object.fromEntries(Object.entries(this.paths).map(function(dt){var qn=_(dt,2);return[qn[0],qn[1].clone()]})),le.nested=L(this.nested),le.subpaths=L(this.subpaths);for(var ze=0,Je=Object.values(le.paths);ze<Je.length;ze++){var et=Je[ze];if(et.$isSingleNested){for(var ft=et.path,wt=0,It=Object.keys(et.schema.paths);wt<It.length;wt++){var Ct=It[wt];le.singleNestedPaths[ft+"."+Ct]=et.schema.paths[Ct]}for(var tn=0,xt=Object.keys(et.schema.singleNestedPaths);tn<xt.length;tn++){var Ht=xt[tn];le.singleNestedPaths[ft+"."+Ht]=et.schema.singleNestedPaths[Ht]}for(var en=0,kn=Object.keys(et.schema.subpaths);en<kn.length;en++){var Dn=kn[en];le.singleNestedPaths[ft+"."+Dn]=et.schema.subpaths[Dn]}for(var Ft=0,Tt=Object.keys(et.schema.nested);Ft<Tt.length;Ft++){var rn=Tt[Ft];le.singleNestedPaths[ft+"."+rn]="nested"}}}return le.childSchemas=function(dt){for(var qn=[],fn=0,dr=Object.keys(dt.paths);fn<dr.length;fn++){var Xn=dr[fn],Ir=dt.paths[Xn];(Ir.$isMongooseDocumentArray||Ir.$isSingleNested)&&qn.push({schema:Ir.schema,model:Ir.caster})}return qn}(le),le.virtuals=L(this.virtuals),le.$globalPluginsApplied=this.$globalPluginsApplied,le.$isRootDiscriminator=this.$isRootDiscriminator,le.$implicitlyCreated=this.$implicitlyCreated,le.$id=++Re,le.$originalSchemaId=this.$id,le.mapPaths=[].concat(this.mapPaths),this.discriminatorMapping!=null&&(le.discriminatorMapping=Object.assign({},this.discriminatorMapping)),this.discriminators!=null&&(le.discriminators=Object.assign({},this.discriminators)),this._applyDiscriminators!=null&&(le._applyDiscriminators=new Map(this._applyDiscriminators)),le.aliases=Object.assign({},this.aliases),le},De.prototype.pick=function(ge,le){var ze=new De({},le||this.options);if(!Array.isArray(ge))throw new w('Schema#pick() only accepts an array argument, got "'+g(ge)+'"');var Je,et=E(ge);try{for(et.s();!(Je=et.n()).done;){var ft=Je.value;if(this.nested[ft])ze.add(v({},ft,W(this.tree,ft)));else{var wt=this.path(ft);if(wt==null)throw new w("Path `"+ft+"` is not in the schema");ze.add(v({},ft,wt))}}}catch(It){et.e(It)}finally{et.f()}return ze},De.prototype.omit=function(ge,le){var ze=new De(this,le||this.options);if(!Array.isArray(ge))throw new w('Schema#omit() only accepts an array argument, got "'+g(ge)+'"');for(var Je in ze.remove(ge),ze.singleNestedPaths)ge.includes(Je)&&delete ze.singleNestedPaths[Je];return ze},De.prototype.defaultOptions=function(ge){this._userProvidedOptions=ge==null?{}:L(ge);var le=this.base&&this.base.options||{};if(ge=function(ze){for(var Je=1;Je<arguments.length;Je++){var et=arguments[Je]!=null?arguments[Je]:{};Je%2?m(Object(et),!0).forEach(function(ft){v(ze,ft,et[ft])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ze,Object.getOwnPropertyDescriptors(et)):m(Object(et)).forEach(function(ft){Object.defineProperty(ze,ft,Object.getOwnPropertyDescriptor(et,ft))})}return ze}({strict:!("strict"in le)||le.strict,strictQuery:"strictQuery"in le&&le.strictQuery,bufferCommands:!0,capped:!1,versionKey:"__v",optimisticConcurrency:!1,minimize:!0,autoIndex:null,discriminatorKey:"__t",shardKey:null,read:null,validateBeforeSave:!0,validateModifiedOnly:!1,_id:!0,id:!("id"in le)||le.id,typeKey:"type"},ge),ge.versionKey&&typeof ge.versionKey!="string")throw new w("`versionKey` must be falsy or string, got `"+g(ge.versionKey)+"`");if(typeof ge.read=="string"?ge.read=Q(ge.read):Array.isArray(ge.read)&&typeof ge.read[0]=="string"&&(ge.read={mode:Q(ge.read[0]),tags:ge.read[1]}),ge.optimisticConcurrency&&!ge.versionKey)throw new w("Must set `versionKey` if using `optimisticConcurrency`");return ge},De.prototype.discriminator=function(ge,le){return this._applyDiscriminators=this._applyDiscriminators||new Map,this._applyDiscriminators.set(ge,le),this},De.prototype.add=function(ge,le){if(ge instanceof De||ge!=null&&ge.instanceOfSchema)return ae(this,ge),this;if(ge._id===!1&&le==null&&(this.options._id=!1),(le=le||"")==="__proto__."||le==="constructor."||le==="prototype.")return this;for(var ze=Object.keys(ge),Je=this.options.typeKey,et=0,ft=ze;et<ft.length;et++){var wt=ft[et];if(!pe.specialProperties.has(wt)){var It=le+wt,Ct=ge[wt];if(Ct==null)throw new TypeError("Invalid value for schema path `"+It+'`, got value "'+Ct+'"');if(wt!=="_id"||Ct!==!1){var tn=!1;if(typeof Ct=="string"&&(tn=(this.base!=null?this.base.Schema.Types:De.Types)[Ct.charAt(0).toUpperCase()+Ct.substring(1)]!=null),wt!=="_id"&&(g(Ct)!=="object"&&typeof Ct!="function"&&!tn||Ct==null))throw new TypeError("Invalid schema configuration: `".concat(Ct,"` is not ")+"a valid type at path `".concat(wt,"`. See ")+"https://bit.ly/mongoose-schematypes for a list of valid schema types.");if(Ct instanceof R||(Ct.constructor&&Ct.constructor.name||null)==="VirtualType")this.virtual(Ct);else{if(Array.isArray(Ct)&&Ct.length===1&&Ct[0]==null)throw new TypeError("Invalid value for schema Array path `"+It+'`, got value "'+Ct[0]+'"');if(fe(Ct)||Ct instanceof P)if(Object.keys(Ct).length<1)le&&(this.nested[le.substring(0,le.length-1)]=!0),this.path(It,Ct);else if(!Ct[Je]||Je==="type"&&fe(Ct.type)&&Ct.type.type)this.nested[It]=!0,this.add(Ct,It+".");else{var xt=Ct[Je];if(fe(xt)&&Object.keys(xt).length>0){le&&(this.nested[le.substring(0,le.length-1)]=!0);var Ht={};this._userProvidedOptions.typeKey&&(Ht.typeKey=this._userProvidedOptions.typeKey),this._userProvidedOptions.strict!=null&&(Ht.strict=this._userProvidedOptions.strict),this._userProvidedOptions.toObject!=null&&(Ht.toObject=pe.omit(this._userProvidedOptions.toObject,["transform"])),this._userProvidedOptions.toJSON!=null&&(Ht.toJSON=pe.omit(this._userProvidedOptions.toJSON,["transform"]));var en=new De(xt,Ht);en.$implicitlyCreated=!0;var kn=Object.assign({},Ct,v({},Je,en));this.path(le+wt,kn)}else if(le&&(this.nested[le.substring(0,le.length-1)]=!0),this.path(le+wt,Ct),Ct!=null&&!Ct.instanceOfSchema&&pe.isPOJO(Ct.discriminators)){var Dn=this.path(le+wt);for(var Ft in Ct.discriminators)Dn.discriminator(Ft,Ct.discriminators[Ft])}}else if(le&&(this.nested[le.substring(0,le.length-1)]=!0),this.path(le+wt,Ct),Ct[0]!=null&&!Ct[0].instanceOfSchema&&pe.isPOJO(Ct[0].discriminators)){var Tt=this.path(le+wt);for(var rn in Ct[0].discriminators)Tt.discriminator(rn,Ct[0].discriminators[rn])}}}}}var dt=Object.fromEntries(Object.entries(ge).map(function(qn){var fn=_(qn,1)[0];return[le+fn,null]}));return ot(this,dt),this},De.prototype.alias=function(ge,le){return ot(this,v({},ge,le)),this},De.prototype.removeIndex=function(ge){if(arguments.length>1)throw new Error("removeIndex() takes only 1 argument");if(g(ge)!=="object"&&typeof ge!="string")throw new Error("removeIndex() may only take either an object or a string as an argument");if(g(ge)==="object")for(var le=this._indexes.length-1;le>=0;--le)B.isDeepStrictEqual(this._indexes[le][0],ge)&&this._indexes.splice(le,1);else for(var ze=this._indexes.length-1;ze>=0;--ze)this._indexes[ze][1]!=null&&this._indexes[ze][1].name===ge&&this._indexes.splice(ze,1);return this},De.prototype.clearIndexes=function(){return this._indexes.length=0,this},De.prototype.searchIndex=function(ge){return this._searchIndexes.push(ge),this},De.reserved=Object.create(null),De.prototype.reserved=De.reserved;var X=De.reserved;function ee(ge){return/\.\d+/.test(ge)?ge.replace(/\.\d+\./g,".$.").replace(/\.\d+$/,".$"):ge}function Le(ge,le){if(ge.mapPaths.length===0)return null;var ze,Je=E(ge.mapPaths);try{for(Je.s();!(ze=Je.n()).done;){var et=ze.value.path;if(new RegExp("^"+et.replace(/\.\$\*/g,"\\.[^.]+")+"$").test(le))return ge.paths[et]}}catch(ft){Je.e(ft)}finally{Je.f()}return null}function Be(ge,le,ze){var Je=le.split(/\.(\d+)\.|\.(\d+)$/).filter(Boolean);if(Je.length<2)return ge.paths.hasOwnProperty(Je[0])?ge.paths[Je[0]]:"adhocOrUndefined";var et=ge.path(Je[0]),ft=!1;if(!et)return"adhocOrUndefined";for(var wt=Je.length-1,It=1;It<Je.length;++It){ft=!1;var Ct=Je[It];if(It===wt&&et&&!/\D/.test(Ct)){et=et.$isMongooseDocumentArray?et.$embeddedSchemaType:et instanceof x.Array?et.caster:void 0;break}if(/\D/.test(Ct)){if(!et||!et.schema){et=void 0;break}ft=et.schema.pathType(Ct)==="nested",et=et.schema.path(Ct)}else et instanceof x.Array&&It!==wt&&(et=et.caster)}return ge.subpaths[ze]=et,et?"real":ft?"nested":"adhocOrUndefined"}function se(ge,le){var ze,Je=E(ge.childSchemas);try{for(Je.s();!(ze=Je.n()).done;){var et=ze.value.schema;et.$implicitlyCreated&&(Object.assign(et.options,le),se(et,le))}}catch(ft){Je.e(ft)}finally{Je.f()}}X.prototype=X.emit=X.listeners=X.removeListener=X.collection=X.errors=X.get=X.init=X.isModified=X.isNew=X.populated=X.remove=X.save=X.toObject=X.validate=1,X.collection=1,De.prototype.path=function(ge,le){if(le===void 0){var ze=ee(ge),Je=function(cn,xn,cr){return cn.paths.hasOwnProperty(xn)?cn.paths[xn]:cn.subpaths.hasOwnProperty(cr)?cn.subpaths[cr]:cn.singleNestedPaths.hasOwnProperty(cr)&&g(cn.singleNestedPaths[cr])==="object"?cn.singleNestedPaths[cr]:null}(this,ge,ze);if(Je!=null)return Je;var et=Le(this,ge);return et??((Je=this.hasMixedParent(ze))!=null?Je:N.test(ge)?function(cn,xn,cr){return Be(cn,xn,cr),cn.subpaths[cr]}(this,ge,ze):void 0)}var ft=ge.split(".")[0];if(X[ft]&&!this.options.suppressReservedKeysWarning){var wt="`".concat(ft,"` is a reserved schema pathname and may break some functionality. ")+"You are allowed to use it, but use at your own risk. To disable this warning pass `suppressReservedKeysWarning` as a schema option.";pe.warn(wt)}g(le)==="object"&&pe.hasUserDefinedProperty(le,"ref")&&U(le.ref,ge);var It,Ct=ge.split(/\./),tn=Ct.pop(),xt=this.tree,Ht="",en=E(Ct);try{for(en.s();!(It=en.n()).done;){var kn=It.value;if(pe.specialProperties.has(kn))throw new Error("Cannot set special property `"+kn+"` on a schema");if(Ht=Ht+=(Ht.length>0?".":"")+kn,xt[kn]||(this.nested[Ht]=!0,xt[kn]={}),g(xt[kn])!=="object"){var Dn="Cannot set nested path `"+ge+"`. Parent path `"+Ht+"` already set to type "+xt[kn].name+".";throw new Error(Dn)}xt=xt[kn]}}catch(cn){en.e(cn)}finally{en.f()}xt[tn]=L(le),this.paths[ge]=this.interpretAsType(ge,le,this.options);var Ft=this.paths[ge];if(Ft.$isSchemaMap){var Tt=ge+".$*";this.paths[Tt]=Ft.$__schemaType,this.mapPaths.push(this.paths[Tt])}if(Ft.$isSingleNested){for(var rn=0,dt=Object.keys(Ft.schema.paths);rn<dt.length;rn++){var qn=dt[rn];this.singleNestedPaths[ge+"."+qn]=Ft.schema.paths[qn]}for(var fn=0,dr=Object.keys(Ft.schema.singleNestedPaths);fn<dr.length;fn++){var Xn=dr[fn];this.singleNestedPaths[ge+"."+Xn]=Ft.schema.singleNestedPaths[Xn]}for(var Ir=0,Ae=Object.keys(Ft.schema.subpaths);Ir<Ae.length;Ir++){var ve=Ae[Ir];this.singleNestedPaths[ge+"."+ve]=Ft.schema.subpaths[ve]}for(var he=0,me=Object.keys(Ft.schema.nested);he<me.length;he++){var we=me[he];this.singleNestedPaths[ge+"."+we]="nested"}Object.defineProperty(Ft.schema,"base",{configurable:!0,enumerable:!1,writable:!1,value:this.base}),Ft.caster.base=this.base,this.childSchemas.push({schema:Ft.schema,model:Ft.caster})}else Ft.$isMongooseDocumentArray&&(Object.defineProperty(Ft.schema,"base",{configurable:!0,enumerable:!1,writable:!1,value:this.base}),Ft.casterConstructor.base=this.base,this.childSchemas.push({schema:Ft.schema,model:Ft.casterConstructor}));if(Ft.$isMongooseArray&&Ft.caster instanceof A){for(var je=ge,qe=Ft;qe.$isMongooseArray;)je+=".$",qe.$isMongooseDocumentArray?(qe.$embeddedSchemaType._arrayPath=je,qe.$embeddedSchemaType._arrayParentPath=ge,qe=qe.$embeddedSchemaType):(qe.caster._arrayPath=je,qe.caster._arrayParentPath=ge,qe=qe.caster),this.subpaths[je]=qe;for(var Fe=0,Xe=[];Fe<Xe.length;Fe++){var Ge=Xe[Fe];this.subpaths[Ge.path]=Ge}}if(Ft.$isMongooseDocumentArray){for(var rt=0,bt=Object.keys(Ft.schema.paths);rt<bt.length;rt++){var at=bt[rt],Et=Ft.schema.paths[at];this.subpaths[ge+"."+at]=Et,g(Et)==="object"&&Et!=null&&Et.$parentSchemaDocArray==null&&(Et.$parentSchemaDocArray=Ft)}for(var jt=0,Kt=Object.keys(Ft.schema.subpaths);jt<Kt.length;jt++){var Yt=Kt[jt],Zt=Ft.schema.subpaths[Yt];this.subpaths[ge+"."+Yt]=Zt,g(Zt)==="object"&&Zt!=null&&Zt.$parentSchemaDocArray==null&&(Zt.$parentSchemaDocArray=Ft)}for(var Jt=0,ln=Object.keys(Ft.schema.singleNestedPaths);Jt<ln.length;Jt++){var vn=ln[Jt],wn=Ft.schema.singleNestedPaths[vn];this.subpaths[ge+"."+vn]=wn,g(wn)==="object"&&wn!=null&&wn.$parentSchemaDocArray==null&&(wn.$parentSchemaDocArray=Ft)}}return this},Object.defineProperty(De.prototype,"base",{configurable:!0,enumerable:!1,writable:!0,value:null}),De.prototype.interpretAsType=function(ge,le,ze){if(le instanceof A){if(le.path===ge)return le;var Je=le.clone();return Je.path=ge,Je}var et=this.base!=null?this.base.Schema.Types:De.Types,ft=this.base!=null?this.base.Types:r(8941);if(!(pe.isPOJO(le)||le instanceof P)&&pe.getFunctionName(le.constructor)!=="Object"){var wt=le;(le={})[ze.typeKey]=wt}var It,Ct=le[ze.typeKey]&&(le[ze.typeKey]instanceof Function||ze.typeKey!=="type"||!le.type.type)?le[ze.typeKey]:{};if(pe.isPOJO(Ct)||Ct==="mixed")return new et.Mixed(ge,le);if(Array.isArray(Ct)||Ct===Array||Ct==="array"||Ct===et.Array){var tn=Ct===Array||Ct==="array"?le.cast||le.of:Ct[0];if(tn&&tn.instanceOfSchema){if(!(tn instanceof De)){if(!this.options._isMerging)throw new TypeError("Schema for array path `"+ge+"` is from a different copy of the Mongoose module. Please make sure you're using the same version of Mongoose everywhere with `npm list mongoose`. If you are still getting this error, please add `new Schema()` around the path: "+"".concat(ge,": new Schema(...)"));tn=new De(tn)}return new et.DocumentArray(ge,tn,le)}if(tn&&tn[ze.typeKey]&&tn[ze.typeKey].instanceOfSchema){if(!(tn[ze.typeKey]instanceof De)){if(!this.options._isMerging)throw new TypeError("Schema for array path `"+ge+"` is from a different copy of the Mongoose module. Please make sure you're using the same version of Mongoose everywhere with `npm list mongoose`. If you are still getting this error, please add `new Schema()` around the path: "+"".concat(ge,": new Schema(...)"));tn[ze.typeKey]=new De(tn[ze.typeKey])}return new et.DocumentArray(ge,tn[ze.typeKey],le,tn)}if(Array.isArray(tn))return new et.Array(ge,this.interpretAsType(ge,tn,ze),le);var xt=tn==null||!tn[ze.typeKey]||ze.typeKey==="type"&&tn.type.type?tn:tn[ze.typeKey];if(typeof tn=="string")tn=et[tn.charAt(0).toUpperCase()+tn.substring(1)];else if(pe.isPOJO(xt)){if(Object.keys(xt).length){var Ht={minimize:ze.minimize};ze.typeKey&&(Ht.typeKey=ze.typeKey),ze.hasOwnProperty("strict")&&(Ht.strict=ze.strict),ze.hasOwnProperty("strictQuery")&&(Ht.strictQuery=ze.strictQuery),ze.hasOwnProperty("toObject")&&(Ht.toObject=pe.omit(ze.toObject,["transform"])),ze.hasOwnProperty("toJSON")&&(Ht.toJSON=pe.omit(ze.toJSON,["transform"])),this._userProvidedOptions.hasOwnProperty("_id")?Ht._id=this._userProvidedOptions._id:De.Types.DocumentArray.defaultOptions._id!=null&&(Ht._id=De.Types.DocumentArray.defaultOptions._id);var en=new De(xt,Ht);return en.$implicitlyCreated=!0,new et.DocumentArray(ge,en,le)}return new et.Array(ge,et.Mixed,le)}if(tn){if(Ct=!tn[ze.typeKey]||ze.typeKey==="type"&&tn.type.type?tn:tn[ze.typeKey],Array.isArray(Ct))return new et.Array(ge,this.interpretAsType(ge,Ct,ze),le);if((It=typeof Ct=="string"?Ct:Ct.schemaName||pe.getFunctionName(Ct))==="ClockDate"&&(It="Date"),It===void 0)throw new TypeError("Invalid schema configuration: "+"Could not determine the embedded type for array `".concat(ge,"`. ")+"See https://mongoosejs.com/docs/guide.html#definition for more info on supported schema syntaxes.");if(!et.hasOwnProperty(It))throw new TypeError("Invalid schema configuration: "+"`".concat(It,"` is not a valid type within the array `").concat(ge,"`.")+"See https://bit.ly/mongoose-schematypes for a list of valid schema types.")}return new et.Array(ge,tn||et.Mixed,le,ze)}if(Ct&&Ct.instanceOfSchema)return new et.Subdocument(Ct,ge,le);if((It=h.isBuffer(Ct)?"Buffer":typeof Ct=="function"||g(Ct)==="object"?Ct.schemaName||pe.getFunctionName(Ct):Ct===ft.ObjectId?"ObjectId":Ct===ft.Decimal128?"Decimal128":Ct==null?""+Ct:Ct.toString())&&(It=It.charAt(0).toUpperCase()+It.substring(1)),It==="ObjectID"&&(It="ObjectId"),It==="ClockDate"&&(It="Date"),It===void 0)throw new TypeError("Invalid schema configuration: `".concat(ge,"` schematype definition is ")+"invalid. See https://mongoosejs.com/docs/guide.html#definition for more info on supported schema syntaxes.");if(et[It]==null)throw new TypeError("Invalid schema configuration: `".concat(It,"` is not ")+"a valid type at path `".concat(ge,"`. See ")+"https://bit.ly/mongoose-schematypes for a list of valid schema types.");var kn=new et[It](ge,le);return kn.$isSchemaMap&&function(Dn,Ft,Tt,rn,dt){var qn=Tt+".$*",fn={type:{}};pe.hasUserDefinedProperty(rn,"of")&&((fn=pe.isPOJO(rn.of)&&Object.keys(rn.of).length>0&&!pe.hasUserDefinedProperty(rn.of,Dn.options.typeKey)?v({},Dn.options.typeKey,new De(rn.of)):pe.isPOJO(rn.of)?Object.assign({},rn.of):v({},Dn.options.typeKey,rn.of))[Dn.options.typeKey]&&fn[Dn.options.typeKey].instanceOfSchema&&fn[Dn.options.typeKey].eachPath(function(dr,Xn){if(Xn.options.select===!0||Xn.options.select===!1)throw new w('Cannot use schema-level projections (`select: true` or `select: false`) within maps at path "'+Tt+"."+dr+'"')}),pe.hasUserDefinedProperty(rn,"ref")&&(fn.ref=rn.ref)),Ft.$__schemaType=Dn.interpretAsType(qn,fn,dt)}(this,kn,ge,le,ze),kn},De.prototype.eachPath=function(ge){for(var le=Object.keys(this.paths),ze=le.length,Je=0;Je<ze;++Je)ge(le[Je],this.paths[le[Je]]);return this},De.prototype.requiredPaths=function(ge){if(this._requiredpaths&&!ge)return this._requiredpaths;for(var le=Object.keys(this.paths),ze=le.length,Je=[];ze--;){var et=le[ze];this.paths[et].isRequired&&Je.push(et)}return this._requiredpaths=Je,this._requiredpaths},De.prototype.indexedPaths=function(){return this._indexedpaths||(this._indexedpaths=this.indexes()),this._indexedpaths},De.prototype.pathType=function(ge){if(this.paths.hasOwnProperty(ge))return"real";if(this.virtuals.hasOwnProperty(ge))return"virtual";if(this.nested.hasOwnProperty(ge))return"nested";var le=ee(ge);if(this.subpaths.hasOwnProperty(le)||this.subpaths.hasOwnProperty(ge))return"real";var ze=this.singleNestedPaths.hasOwnProperty(le)||this.singleNestedPaths.hasOwnProperty(ge);return ze?ze==="nested"?"nested":"real":Le(this,ge)!=null?"real":/\.\d+\.|\.\d+$/.test(ge)?Be(this,ge,le):"adhocOrUndefined"},De.prototype.hasMixedParent=function(ge){var le=ge.split(/\./g);ge="";for(var ze=0;ze<le.length;++ze)if(ge=ze>0?ge+"."+le[ze]:le[ze],this.paths.hasOwnProperty(ge)&&this.paths[ge]instanceof x.Mixed)return this.paths[ge];return null},De.prototype.setupTimestamp=function(ge){return be(this,ge)},De.prototype.queue=function(ge,le){return this.callQueue.push([ge,le]),this},De.prototype.pre=function(ge){if(ge instanceof RegExp){var le,ze=Array.prototype.slice.call(arguments,1),Je=E(Y);try{for(Je.s();!(le=Je.n()).done;){var et=le.value;ge.test(et)&&this.pre.apply(this,[et].concat(ze))}}catch(tn){Je.e(tn)}finally{Je.f()}return this}if(Array.isArray(ge)){var ft,wt=Array.prototype.slice.call(arguments,1),It=E(ge);try{for(It.s();!(ft=It.n()).done;){var Ct=ft.value;this.pre.apply(this,[Ct].concat(wt))}}catch(tn){It.e(tn)}finally{It.f()}return this}return this.s.hooks.pre.apply(this.s.hooks,arguments),this},De.prototype.post=function(ge){if(ge instanceof RegExp){var le,ze=Array.prototype.slice.call(arguments,1),Je=E(Y);try{for(Je.s();!(le=Je.n()).done;){var et=le.value;ge.test(et)&&this.post.apply(this,[et].concat(ze))}}catch(tn){Je.e(tn)}finally{Je.f()}return this}if(Array.isArray(ge)){var ft,wt=Array.prototype.slice.call(arguments,1),It=E(ge);try{for(It.s();!(ft=It.n()).done;){var Ct=ft.value;this.post.apply(this,[Ct].concat(wt))}}catch(tn){It.e(tn)}finally{It.f()}return this}return this.s.hooks.post.apply(this.s.hooks,arguments),this},De.prototype.plugin=function(ge,le){if(typeof ge!="function")throw new Error('First param to `schema.plugin()` must be a function, got "'+g(ge)+'"');if(le&&le.deduplicate){var ze,Je=E(this.plugins);try{for(Je.s();!(ze=Je.n()).done;)if(ze.value.fn===ge)return this}catch(et){Je.e(et)}finally{Je.f()}}return this.plugins.push({fn:ge,opts:le}),ge(this,le),this},De.prototype.method=function(ge,le,ze){if(typeof ge!="string")for(var Je in ge)this.methods[Je]=ge[Je],this.methodOptions[Je]=L(ze);else this.methods[ge]=le,this.methodOptions[ge]=L(ze);return this},De.prototype.static=function(ge,le){if(typeof ge!="string")for(var ze in ge)this.statics[ze]=ge[ze];else this.statics[ge]=le;return this},De.prototype.index=function(ge,le){for(var ze in ge||(ge={}),le||(le={}),le.expires&&pe.expires(le),ge)this.aliases[ze]&&(ge=pe.renameObjKey(ge,ze,this.aliases[ze]));for(var Je=0,et=Object.keys(ge);Je<et.length;Je++){var ft=et[Je];ge[ft]==="ascending"||ge[ft]==="asc"?ge[ft]=1:ge[ft]!=="descending"&&ge[ft]!=="desc"||(ge[ft]=-1)}return this._indexes.push([ge,le]),this},De.prototype.set=function(ge,le,ze){if(arguments.length===1)return this.options[ge];switch(ge){case"read":typeof le=="string"?this.options[ge]={mode:Q(le),tags:ze}:Array.isArray(le)&&typeof le[0]=="string"?this.options[ge]={mode:Q(le[0]),tags:le[1]}:this.options[ge]=le,this._userProvidedOptions[ge]=this.options[ge];break;case"timestamps":this.setupTimestamp(le),this.options[ge]=le,this._userProvidedOptions[ge]=this.options[ge];break;case"_id":this.options[ge]=le,this._userProvidedOptions[ge]=this.options[ge],le&&!this.paths._id?M(this):!le&&this.paths._id!=null&&this.paths._id.auto&&this.remove("_id");break;default:this.options[ge]=le,this._userProvidedOptions[ge]=this.options[ge]}return ge==="strict"&&se(this,{strict:le}),ge==="strictQuery"&&se(this,{strictQuery:le}),this},De.prototype.get=function(ge){return this.options[ge]};var _e="2d 2dsphere hashed text".split(" ");function te(ge,le){var ze,Je=le.split("."),et=Je.pop(),ft=ge.tree,wt=E(Je);try{for(wt.s();!(ze=wt.n()).done;)ft=ft[ze.value]}catch(It){wt.e(It)}finally{wt.f()}delete ft[et]}function $e(ge){return ge.startsWith("$[")&&ge.endsWith("]")}Object.defineProperty(De,"indexTypes",{get:function(){return _e},set:function(){throw new Error("Cannot overwrite Schema.indexTypes")}}),De.prototype.indexes=function(){return re(this)},De.prototype.virtual=function(ge,le){if(ge instanceof R||G(ge)==="VirtualType")return this.virtual(ge.path,ge.options);if(le=new T(le),pe.hasUserDefinedProperty(le,["ref","refPath"])){if(le.localField==null)throw new Error("Reference virtuals require `localField` option");if(le.foreignField==null)throw new Error("Reference virtuals require `foreignField` option");this.pre("init",function(tn){if(de.has(ge,tn)){var xt=de.get(ge,tn);this.$$populatedVirtuals||(this.$$populatedVirtuals={}),le.justOne||le.count?this.$$populatedVirtuals[ge]=Array.isArray(xt)?xt[0]:xt:this.$$populatedVirtuals[ge]=Array.isArray(xt)?xt:xt==null?[]:[xt],de.unset(ge,tn)}});var ze=this.virtual(ge);ze.options=le,ze.set(function(tn){this.$$populatedVirtuals||(this.$$populatedVirtuals={}),le.justOne||le.count?(this.$$populatedVirtuals[ge]=Array.isArray(tn)?tn[0]:tn,g(this.$$populatedVirtuals[ge])!=="object"&&(this.$$populatedVirtuals[ge]=le.count?tn:null)):(this.$$populatedVirtuals[ge]=Array.isArray(tn)?tn:tn==null?[]:[tn],this.$$populatedVirtuals[ge]=this.$$populatedVirtuals[ge].filter(function(xt){return xt&&g(xt)==="object"}))}),typeof le.get=="function"&&ze.get(le.get);for(var Je=ge.split("."),et=Je[0],ft=0;ft<Je.length-1;++ft)if(this.paths[et]!=null){if(this.paths[et].$isMongooseDocumentArray||this.paths[et].$isSingleNested){var wt=Je.slice(ft+1).join(".");this.paths[et].schema.virtual(wt,le);break}et+="."+Je[ft+1]}return ze}var It=this.virtuals,Ct=ge.split(".");if(this.pathType(ge)==="real")throw new Error('Virtual path "'+ge+'" conflicts with a real path in the schema');return It[ge]=Ct.reduce(function(tn,xt,Ht){return tn[xt]||(tn[xt]=Ht===Ct.length-1?new R(le,ge):{}),tn[xt]},this.tree),It[ge]},De.prototype.virtualpath=function(ge){return this.virtuals.hasOwnProperty(ge)?this.virtuals[ge]:null},De.prototype.remove=function(ge){return typeof ge=="string"&&(ge=[ge]),Array.isArray(ge)&&ge.forEach(function(le){if(this.path(le)!=null||this.nested[le]){if(this.nested[le]){var ze,Je=E(Object.keys(this.paths).concat(Object.keys(this.nested)));try{for(Je.s();!(ze=Je.n()).done;){var et=ze.value;et.startsWith(le+".")&&(delete this.paths[et],delete this.nested[et],te(this,et))}}catch(ft){Je.e(ft)}finally{Je.f()}return delete this.nested[le],void te(this,le)}delete this.paths[le],te(this,le)}},this),this},De.prototype.removeVirtual=function(ge){if(typeof ge=="string"&&(ge=[ge]),Array.isArray(ge)){var le,ze=E(ge);try{for(ze.s();!(le=ze.n()).done;){var Je=le.value;if(this.virtuals[Je]==null)throw new w('Attempting to remove virtual "'.concat(Je,'" that does not exist.'))}}catch(It){ze.e(It)}finally{ze.f()}var et,ft=E(ge);try{for(ft.s();!(et=ft.n()).done;){var wt=et.value;delete this.paths[wt],delete this.virtuals[wt],wt.indexOf(".")!==-1?de.unset(wt,this.tree):delete this.tree[wt]}}catch(It){ft.e(It)}finally{ft.f()}}return this},De.prototype.loadClass=function(ge,le){return ge===Object.prototype||ge===Function.prototype||ge.prototype.hasOwnProperty("$isMongooseModelPrototype")||ge.prototype.hasOwnProperty("$isMongooseDocumentPrototype")||(this.loadClass(Object.getPrototypeOf(ge),le),le||Object.getOwnPropertyNames(ge).forEach(function(ze){if(!ze.match(/^(length|name|prototype|constructor|__proto__)$/)){var Je=Object.getOwnPropertyDescriptor(ge,ze);Je.hasOwnProperty("value")&&this.static(ze,Je.value)}},this),Object.getOwnPropertyNames(ge.prototype).forEach(function(ze){if(!ze.match(/^(constructor)$/)){var Je=Object.getOwnPropertyDescriptor(ge.prototype,ze);le||typeof Je.value=="function"&&this.method(ze,Je.value),typeof Je.get=="function"&&(this.virtuals[ze]&&(this.virtuals[ze].getters=[]),this.virtual(ze).get(Je.get)),typeof Je.set=="function"&&(this.virtuals[ze]&&(this.virtuals[ze].setters=[]),this.virtual(ze).set(Je.set))}},this)),this},De.prototype._getSchema=function(ge){var le=this.path(ge),ze=[];if(le)return le.$fullPath=ge,le;for(var Je=ge.split("."),et=0;et<Je.length;++et)(Je[et]==="$"||$e(Je[et]))&&(Je[et]="0"),Oe.test(Je[et])&&(Je[et]="$");return function ft(wt,It){for(var Ct,tn,xt=wt.length+1;xt--;)if(tn=wt.slice(0,xt).join("."),Ct=It.path(tn)){if(ze.push(tn),Ct.caster){if(Ct.caster instanceof x.Mixed)return Ct.caster.$fullPath=ze.join("."),Ct.caster;if(xt!==wt.length&&Ct.schema){var Ht=void 0;return wt[xt]==="$"||$e(wt[xt])?xt+1===wt.length?Ct.$embeddedSchemaType:((Ht=ft(wt.slice(xt+1),Ct.schema))&&(Ht.$parentSchemaDocArray=Ht.$parentSchemaDocArray||(Ct.schema.$isSingleNested?null:Ct)),Ht):((Ht=ft(wt.slice(xt),Ct.schema))&&(Ht.$parentSchemaDocArray=Ht.$parentSchemaDocArray||(Ct.schema.$isSingleNested?null:Ct)),Ht)}}else if(Ct.$isSchemaMap){if(xt>=wt.length)return Ct;if(xt+1>=wt.length||Ct.$__schemaType instanceof x.Mixed)return Ct.$__schemaType;if(Ct.$__schemaType.schema!=null)return ft(wt.slice(xt+1),Ct.$__schemaType.schema)}return Ct.$fullPath=ze.join("."),Ct}}(Je,this)},De.prototype._getPathType=function(ge){return this.path(ge)?"real":function le(ze,Je){for(var et,ft,wt=ze.length+1;wt--;){if(ft=ze.slice(0,wt).join("."),et=Je.path(ft))return et.caster?et.caster instanceof x.Mixed?{schema:et,pathType:"mixed"}:wt!==ze.length&&et.schema?ze[wt]==="$"||$e(ze[wt])?wt===ze.length-1?{schema:et,pathType:"nested"}:le(ze.slice(wt+1),et.schema):le(ze.slice(wt),et.schema):{schema:et,pathType:et.$isSingleNested?"nested":"array"}:{schema:et,pathType:"real"};if(wt===ze.length&&Je.nested[ft])return{schema:Je,pathType:"nested"}}return{schema:et||Je,pathType:"undefined"}}(ge.split("."),this)},De.prototype._preCompile=function(){oe(this)},a.exports=l=De,De.Types=x=r(5251),l.ObjectId=x.ObjectId},94:(a,l,r)=>{function h(be,pe){(pe==null||pe>be.length)&&(pe=be.length);for(var U=0,B=new Array(pe);U<pe;U++)B[U]=be[U];return B}function m(be){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(pe){return typeof pe}:function(pe){return pe&&typeof Symbol=="function"&&pe.constructor===Symbol&&pe!==Symbol.prototype?"symbol":typeof pe},m(be)}var v,g,_=r(8702),E=r(3053),b=r(5202),p=r(1033),x=r(3207),y=x.CastError,f=r(3861),w=r(6069),A=r(6787),P=r(1973),T=r(7906),R=r(8751),M=r(6872),L=r(1521).W,W=r(5008),G=r(7291),re=Symbol("mongoose#isNestedArray"),Q=Object.freeze({});function oe(be,pe,U,B){g||(g=r(8941).Embedded);var N,z,H="type";if(B&&B.typeKey&&(H=B.typeKey),this.schemaOptions=B,pe){var Y={};M.isPOJO(pe)&&(pe[H]?(delete(Y=P(pe))[H],pe=pe[H]):pe=f),U!=null&&U.ref!=null&&Y.ref==null&&(Y.ref=U.ref),pe===Object&&(pe=f);var fe=typeof pe=="string"?pe:M.getFunctionName(pe),Re=r(5251),Oe=Re.hasOwnProperty(fe)?Re[fe]:pe;if(this.casterConstructor=Oe,this.casterConstructor instanceof oe&&(this.casterConstructor[re]=!0),typeof Oe!="function"||Oe.$isArraySubdocument||Oe.$isSchemaMap)this.caster=Oe,this.caster instanceof g||(this.caster.path=be);else{var De=this.caster instanceof g?null:be;this.caster=new Oe(De,Y)}this.$embeddedSchemaType=this.caster}if(this.$isMongooseArray=!0,x.call(this,be,U,"Array"),this.defaultValue!=null&&(N=this.defaultValue,z=typeof N=="function"),!("defaultValue"in this)||this.defaultValue!==void 0){var ot=function(){return z?N.call(this):N!=null?[].concat(N):[]};ot.$runBeforeSetters=!z,this.default(ot)}}oe.schemaName="Array",oe.options={castNonArrays:!0},oe.defaultOptions={},oe.set=x.set,oe.setters=[],oe.get=x.get,oe.prototype=Object.create(x.prototype),oe.prototype.constructor=oe,oe.prototype.OptionsConstructor=p,oe._checkRequired=x.prototype.checkRequired,oe.checkRequired=x.checkRequired,oe.prototype.checkRequired=function(be,pe){return m(be)==="object"&&x._isRef(this,be,pe,!0)?!!be:(typeof this.constructor.checkRequired=="function"?this.constructor.checkRequired():oe.checkRequired())(be)},oe.prototype.enum=function(){for(var be=this;;){var pe=be&&be.caster&&be.caster.instance;if(pe!=="Array"){if(pe!=="String"&&pe!=="Number")throw new Error("`enum` can only be set on an array of strings or numbers , not "+pe);break}be=be.caster}var U=arguments;return!Array.isArray(arguments)&&M.isObject(arguments)&&(U=M.object.vals(U)),be.caster.enum.apply(be.caster,U),this},oe.prototype.applyGetters=function(be,pe){return pe!=null&&pe.$__!=null&&pe.$populated(this.path)?be:x.prototype.applyGetters.call(this,be,pe)},oe.prototype._applySetters=function(be,pe,U,B){if(this.casterConstructor.$isMongooseArray&&oe.options.castNonArrays&&!this[re]){for(var N=0,z=this;z!=null&&z.$isMongooseArray&&!z.$isMongooseDocumentArray;)++N,z=z.casterConstructor;if(be!=null&&be.length!==0){var H=w(be);if(H.min===H.max&&H.max<N&&H.containsNonArrayItem)for(var Y=H.max;Y<N;++Y)be=[be]}}return x.prototype._applySetters.call(this,be,pe,U,B)},oe.prototype.cast=function(be,pe,U,B,N){var z,H;if(v||(v=r(8941).Array),Array.isArray(be)){if(!be.length&&pe){var Y=pe.schema.indexedPaths(),fe=this.path;for(z=0,H=Y.length;z<H;++z){var Re=Y[z][0][fe];if(Re==="2dsphere"||Re==="2d")return}var Oe=this.path.endsWith(".coordinates")?this.path.substring(0,this.path.lastIndexOf(".")):null;if(Oe!=null){for(z=0,H=Y.length;z<H;++z)if(Y[z][0][Oe]==="2dsphere")return}}N=N||Q;var De=M.isMongooseArray(be)?be.__array:be,ot=N.path||this.path;if(N.arrayPathIndex!=null&&(ot+="."+N.arrayPathIndex),De=(be=v(De,ot,pe,this)).__array,U&&pe!=null&&pe.$__!=null&&pe.$populated(this.path))return be;var X=this.caster,ee=X.$isMongooseArray;if(X&&this.casterConstructor!==f)try{var Le=De.length;for(z=0;z<Le;z++){var Be={};ee&&(N.arrayPath!=null||X._arrayParentPath!=null)&&(Be.arrayPathIndex=z),De[z]=X.applySetters(De[z],pe,U,void 0,Be)}}catch(_e){throw new y("["+_e.kind+"]",R.inspect(be),this.path+"."+z,_e,this)}return be}var se=this.options.castNonArrays!=null?this.options.castNonArrays:oe.options.castNonArrays;if(U||se)return pe&&U&&pe.markModified(this.path),this.cast([be],pe,U);throw new y("Array",R.inspect(be),this.path,null,this)},oe.prototype._castForPopulate=function(be,pe){if(v||(v=r(8941).Array),Array.isArray(be)){var U,B=be.__array?be.__array:be,N=B.length,z=this.caster;if(z&&this.casterConstructor!==f)try{for(U=0;U<N;U++){var H={};z.$isMongooseArray&&z._arrayParentPath!=null&&(H.arrayPathIndex=U),B[U]=z.cast(B[U],pe,!1,void 0,H)}}catch(Y){throw new y("["+Y.kind+"]",R.inspect(be),this.path+"."+U,Y,this)}return be}throw new y("Array",R.inspect(be),this.path,null,this)},oe.prototype.$toObject=oe.prototype.toObject,oe.prototype.discriminator=function(){for(var be,pe=this;pe.$isMongooseArray&&!pe.$isMongooseDocumentArray;)if((pe=pe.casterConstructor)==null||typeof pe=="function")throw new b("You can only add an embedded discriminator on a document array, "+this.path+" is a plain array");return(be=pe).discriminator.apply(be,arguments)},oe.prototype.clone=function(){var be=Object.assign({},this.options),pe=new this.constructor(this.path,this.caster,be,this.schemaOptions);return pe.validators=this.validators.slice(),this.requiredValidator!==void 0&&(pe.requiredValidator=this.requiredValidator),pe},oe.prototype._castForQuery=function(be,pe){var U=this,B=this.casterConstructor;if(be&&B.discriminators&&B.schema&&B.schema.options&&B.schema.options.discriminatorKey)if(typeof be[B.schema.options.discriminatorKey]=="string"&&B.discriminators[be[B.schema.options.discriminatorKey]])B=B.discriminators[be[B.schema.options.discriminatorKey]];else{var N=G(B.discriminators,be[B.schema.options.discriminatorKey]);N&&(B=N)}var z=this.casterConstructor.prototype,H=z&&z.castForQuery,Y=z&&z.cast,fe=B.castForQuery,Re=this.caster;return Array.isArray(be)?(this.setters.reverse().forEach(function(Oe){be=Oe.call(U,be,U)}),be=be.map(function(Oe){return M.isObject(Oe)&&Oe.$elemMatch?Oe:H?Oe=H.call(Re,null,Oe,pe):Y?Oe=Y.call(Re,Oe):fe?Oe=fe.call(Re,null,Oe,pe):Oe!=null?Oe=new B(Oe):Oe})):H?be=H.call(Re,null,be,pe):Y?be=Y.call(Re,be):fe?be=fe.call(Re,null,be,pe):be!=null&&(be=new B(be)),be},oe.prototype.castForQuery=function(be,pe,U){var B;if(be!=null){if(!(B=this.$conditionalHandlers[be]))throw new Error("Can't use "+be+" with Array.");return B.call(this,pe,U)}return this._castForQuery(pe,U)};var ae=oe.prototype.$conditionalHandlers={};function de(be){return function(pe,U){if(!Array.isArray(pe))throw new TypeError("conditional "+be+" requires an array");var B,N=[],z=function(fe,Re){var Oe=typeof Symbol<"u"&&fe[Symbol.iterator]||fe["@@iterator"];if(!Oe){if(Array.isArray(fe)||(Oe=function(Be,se){if(Be){if(typeof Be=="string")return h(Be,se);var _e=Object.prototype.toString.call(Be).slice(8,-1);return _e==="Object"&&Be.constructor&&(_e=Be.constructor.name),_e==="Map"||_e==="Set"?Array.from(Be):_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e)?h(Be,se):void 0}}(fe))||Re&&fe&&typeof fe.length=="number"){Oe&&(fe=Oe);var De=0,ot=function(){};return{s:ot,n:function(){return De>=fe.length?{done:!0}:{done:!1,value:fe[De++]}},e:function(Be){throw Be},f:ot}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var X,ee=!0,Le=!1;return{s:function(){Oe=Oe.call(fe)},n:function(){var Be=Oe.next();return ee=Be.done,Be},e:function(Be){Le=!0,X=Be},f:function(){try{ee||Oe.return==null||Oe.return()}finally{if(Le)throw X}}}}(pe);try{for(z.s();!(B=z.n()).done;){var H,Y=B.value;N.push(A((H=this.casterConstructor.schema)!==null&&H!==void 0?H:U.schema,Y,null,this&&this.$$context))}}catch(fe){z.e(fe)}finally{z.f()}return N}}ae.$all=function(be,pe){var U=this;return Array.isArray(be)||(be=[be]),be=be.map(function(B){if(!M.isObject(B))return B;if(B.$elemMatch!=null)return{$elemMatch:A(U.casterConstructor.schema,B.$elemMatch,null,U&&U.$$context)};var N={};return N[U.path]=B,A(U.casterConstructor.schema,N,null,U&&U.$$context)[U.path]},this),this.castForQuery(null,be,pe)},ae.$options=String,ae.$elemMatch=function(be,pe){for(var U,B=Object.keys(be),N=B.length,z=0;z<N;++z){var H=B[z],Y=be[H];T(H)&&Y!=null&&(be[H]=this.castForQuery(H,Y,pe))}var fe=this&&this.casterConstructor&&this.casterConstructor.schema&&this.casterConstructor.schema.options&&this.casterConstructor.schema.options.discriminatorKey,Re=this&&this.casterConstructor&&this.casterConstructor.schema&&this.casterConstructor.schema.discriminators||{};if(fe!=null&&be[fe]!=null&&Re[be[fe]]!=null)return A(Re[be[fe]],be,null,this&&this.$$context);var Oe=(U=this.casterConstructor.schema)!==null&&U!==void 0?U:pe.schema;return A(Oe,be,null,this&&this.$$context)},ae.$geoIntersects=W.cast$geoIntersects,ae.$or=de("$or"),ae.$and=de("$and"),ae.$nor=de("$nor"),ae.$near=ae.$nearSphere=W.cast$near,ae.$within=ae.$geoWithin=W.cast$within,ae.$size=ae.$minDistance=ae.$maxDistance=L,ae.$exists=_,ae.$type=E,ae.$eq=ae.$gt=ae.$gte=ae.$lt=ae.$lte=ae.$not=ae.$regex=ae.$ne=oe.prototype._castForQuery,ae.$nin=x.prototype.$conditionalHandlers.$nin,ae.$in=x.prototype.$conditionalHandlers.$in,a.exports=oe},6795:(a,l,r)=>{function h(x){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},h(x)}function m(x,y){var f=Object.keys(x);if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(x);y&&(w=w.filter(function(A){return Object.getOwnPropertyDescriptor(x,A).enumerable})),f.push.apply(f,w)}return f}function v(x){for(var y=1;y<arguments.length;y++){var f=arguments[y]!=null?arguments[y]:{};y%2?m(Object(f),!0).forEach(function(w){var A,P,T,R;A=x,P=w,T=f[w],R=function(M,L){if(h(M)!="object"||!M)return M;var W=M[Symbol.toPrimitive];if(W!==void 0){var G=W.call(M,"string");if(h(G)!="object")return G;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(M)}(P),(P=h(R)=="symbol"?R:String(R))in A?Object.defineProperty(A,P,{value:T,enumerable:!0,configurable:!0,writable:!0}):A[P]=T}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(f)):m(Object(f)).forEach(function(w){Object.defineProperty(x,w,Object.getOwnPropertyDescriptor(f,w))})}return x}var g=r(1795),_=r(3207),E=r(3087);function b(x,y){_.call(this,x,y,"BigInt")}function p(x,y){return this.castForQuery(null,x,y)}b.schemaName="BigInt",b.defaultOptions={},b.prototype=Object.create(_.prototype),b.prototype.constructor=b,b._cast=E,b.set=_.set,b.setters=[],b.get=_.get,b.cast=function(x){return arguments.length===0||(x===!1&&(x=this._defaultCaster),this._cast=x),this._cast},b._checkRequired=function(x){return x!=null},b.checkRequired=_.checkRequired,b.prototype.checkRequired=function(x){return this.constructor._checkRequired(x)},b.prototype.cast=function(x){var y;y=typeof this._castFunction=="function"?this._castFunction:typeof this.constructor.cast=="function"?this.constructor.cast():b.cast();try{return y(x)}catch(f){throw new g("BigInt",x,this.path,f,this)}},b.$conditionalHandlers=v(v({},_.prototype.$conditionalHandlers),{},{$gt:p,$gte:p,$lt:p,$lte:p}),b.prototype.castForQuery=function(x,y,f){var w;if(x!=null)return(w=b.$conditionalHandlers[x])?w.call(this,y):this.applySetters(null,y,f);try{return this.applySetters(y,f)}catch(A){throw A instanceof g&&A.path===this.path&&this.$fullPath!=null&&(A.path=this.$fullPath),A}},b.prototype._castNullish=function(x){return x===void 0||(typeof this.constructor.cast=="function"?this.constructor.cast():b.cast()),x},a.exports=b},6470:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}function m(b,p){var x=Object.keys(b);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(b);p&&(y=y.filter(function(f){return Object.getOwnPropertyDescriptor(b,f).enumerable})),x.push.apply(x,y)}return x}var v=r(1795),g=r(3207),_=r(6670);function E(b,p){g.call(this,b,p,"Boolean")}E.schemaName="Boolean",E.defaultOptions={},E.prototype=Object.create(g.prototype),E.prototype.constructor=E,E._cast=_,E.set=g.set,E.setters=[],E.get=g.get,E.cast=function(b){return arguments.length===0||(b===!1&&(b=this._defaultCaster),this._cast=b),this._cast},E._defaultCaster=function(b){if(b!=null&&typeof b!="boolean")throw new Error;return b},E._checkRequired=function(b){return b===!0||b===!1},E.checkRequired=g.checkRequired,E.prototype.checkRequired=function(b){return this.constructor._checkRequired(b)},Object.defineProperty(E,"convertToTrue",{get:function(){return _.convertToTrue},set:function(b){_.convertToTrue=b}}),Object.defineProperty(E,"convertToFalse",{get:function(){return _.convertToFalse},set:function(b){_.convertToFalse=b}}),E.prototype.cast=function(b){var p;p=typeof this._castFunction=="function"?this._castFunction:typeof this.constructor.cast=="function"?this.constructor.cast():E.cast();try{return p(b)}catch(x){throw new v("Boolean",b,this.path,x,this)}},E.$conditionalHandlers=function(b){for(var p=1;p<arguments.length;p++){var x=arguments[p]!=null?arguments[p]:{};p%2?m(Object(x),!0).forEach(function(y){var f,w,A,P;f=b,w=y,A=x[y],P=function(T,R){if(h(T)!="object"||!T)return T;var M=T[Symbol.toPrimitive];if(M!==void 0){var L=M.call(T,"string");if(h(L)!="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(T)}(w),(w=h(P)=="symbol"?P:String(P))in f?Object.defineProperty(f,w,{value:A,enumerable:!0,configurable:!0,writable:!0}):f[w]=A}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(x)):m(Object(x)).forEach(function(y){Object.defineProperty(b,y,Object.getOwnPropertyDescriptor(x,y))})}return b}({},g.prototype.$conditionalHandlers),E.prototype.castForQuery=function(b,p,x){var y;if(b!=null)return(y=E.$conditionalHandlers[b])?y.call(this,p):this.applySetters(null,p,x);try{return this.applySetters(p,x)}catch(f){throw f instanceof v&&f.path===this.path&&this.$fullPath!=null&&(f.path=this.$fullPath),f}},E.prototype._castNullish=function(b){if(b===void 0)return b;var p=typeof this.constructor.cast=="function"?this.constructor.cast():E.cast();return p==null?b:!(p.convertToFalse instanceof Set&&p.convertToFalse.has(b))&&(!!(p.convertToTrue instanceof Set&&p.convertToTrue.has(b))||b)},a.exports=E},8800:(a,l,r)=>{var h=r(365).Buffer;function m(P,T){var R=Object.keys(P);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(P);T&&(M=M.filter(function(L){return Object.getOwnPropertyDescriptor(P,L).enumerable})),R.push.apply(R,M)}return R}function v(P){for(var T=1;T<arguments.length;T++){var R=arguments[T]!=null?arguments[T]:{};T%2?m(Object(R),!0).forEach(function(M){var L,W,G,re;L=P,W=M,G=R[M],re=function(Q,oe){if(g(Q)!="object"||!Q)return Q;var ae=Q[Symbol.toPrimitive];if(ae!==void 0){var de=ae.call(Q,"string");if(g(de)!="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Q)}(W),(W=g(re)=="symbol"?re:String(re))in L?Object.defineProperty(L,W,{value:G,enumerable:!0,configurable:!0,writable:!0}):L[W]=G}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(R)):m(Object(R)).forEach(function(M){Object.defineProperty(P,M,Object.getOwnPropertyDescriptor(R,M))})}return P}function g(P){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},g(P)}var _=r(4051),E=r(6618),b=r(3207),p=r(4282),x=r(6872),y=_.Binary,f=b.CastError;function w(P,T){b.call(this,P,T,"Buffer")}function A(P,T){return this.castForQuery(null,P,T)}w.schemaName="Buffer",w.defaultOptions={},w.prototype=Object.create(b.prototype),w.prototype.constructor=w,w.prototype.OptionsConstructor=E,w._checkRequired=function(P){return!(!P||!P.length)},w.set=b.set,w.setters=[],w.get=b.get,w.checkRequired=b.checkRequired,w.prototype.checkRequired=function(P,T){return b._isRef(this,P,T,!0)?!!P:this.constructor._checkRequired(P)},w.prototype.cast=function(P,T,R){var M;if(b._isRef(this,P,T,R)){if(P&&P.isMongooseBuffer)return P;if(h.isBuffer(P))return P&&P.isMongooseBuffer||(P=new _(P,[this.path,T]),this.options.subtype!=null&&(P._subtype=this.options.subtype)),P;if(P instanceof y){if(M=new _(P.value(!0),[this.path,T]),typeof P.sub_type!="number")throw new f("Buffer",P,this.path,null,this);return M._subtype=P.sub_type,M}if(P==null||x.isNonBuiltinObject(P))return this._castRef(P,T,R)}if(P&&P._id&&(P=P._id),P&&P.isMongooseBuffer)return P;if(h.isBuffer(P))return P&&P.isMongooseBuffer||(P=new _(P,[this.path,T]),this.options.subtype!=null&&(P._subtype=this.options.subtype)),P;if(P instanceof y){if(M=new _(P.value(!0),[this.path,T]),typeof P.sub_type!="number")throw new f("Buffer",P,this.path,null,this);return M._subtype=P.sub_type,M}if(P===null)return P;var L=g(P);if(L==="string"||L==="number"||Array.isArray(P)||L==="object"&&P.type==="Buffer"&&Array.isArray(P.data))return L==="number"&&(P=[P]),M=new _(P,[this.path,T]),this.options.subtype!=null&&(M._subtype=this.options.subtype),M;throw new f("Buffer",P,this.path,null,this)},w.prototype.subtype=function(P){return this.options.subtype=P,this},w.prototype.$conditionalHandlers=v(v({},b.prototype.$conditionalHandlers),{},{$bitsAllClear:p,$bitsAnyClear:p,$bitsAllSet:p,$bitsAnySet:p,$gt:A,$gte:A,$lt:A,$lte:A}),w.prototype.castForQuery=function(P,T,R){var M,L;if(P!=null){if(!(M=this.$conditionalHandlers[P]))throw new Error("Can't use "+P+" with Buffer.");return M.call(this,T)}try{L=this.applySetters(T,R)}catch(W){throw W instanceof f&&W.path===this.path&&this.$fullPath!=null&&(W.path=this.$fullPath),W}return L&&L.toObject({transform:!1,virtuals:!1})},a.exports=w},6535:(a,l,r)=>{function h(A,P){var T=Object.keys(A);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(A);P&&(R=R.filter(function(M){return Object.getOwnPropertyDescriptor(A,M).enumerable})),T.push.apply(T,R)}return T}function m(A){for(var P=1;P<arguments.length;P++){var T=arguments[P]!=null?arguments[P]:{};P%2?h(Object(T),!0).forEach(function(R){var M,L,W,G;M=A,L=R,W=T[R],G=function(re,Q){if(v(re)!="object"||!re)return re;var oe=re[Symbol.toPrimitive];if(oe!==void 0){var ae=oe.call(re,"string");if(v(ae)!="object")return ae;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(re)}(L),(L=v(G)=="symbol"?G:String(G))in M?Object.defineProperty(M,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):M[L]=W}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(T)):h(Object(T)).forEach(function(R){Object.defineProperty(A,R,Object.getOwnPropertyDescriptor(T,R))})}return A}function v(A){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},v(A)}var g=r(4888),_=r(2114),E=r(3207),b=r(195),p=r(1981),x=r(6872),y=E.CastError;function f(A,P){E.call(this,A,P,"Date")}function w(A){return this.cast(A)}f.schemaName="Date",f.defaultOptions={},f.prototype=Object.create(E.prototype),f.prototype.constructor=f,f.prototype.OptionsConstructor=_,f._cast=b,f.set=E.set,f.setters=[],f.get=E.get,f.cast=function(A){return arguments.length===0||(A===!1&&(A=this._defaultCaster),this._cast=A),this._cast},f._defaultCaster=function(A){if(A!=null&&!(A instanceof Date))throw new Error;return A},f.prototype.expires=function(A){return p(this._index)!=="Object"&&(this._index={}),this._index.expires=A,x.expires(this._index),this},f._checkRequired=function(A){return A instanceof Date},f.checkRequired=E.checkRequired,f.prototype.checkRequired=function(A,P){return v(A)==="object"&&E._isRef(this,A,P,!0)?A!=null:(typeof this.constructor.checkRequired=="function"?this.constructor.checkRequired():f.checkRequired())(A)},f.prototype.min=function(A,P){if(this.minValidator&&(this.validators=this.validators.filter(function(M){return M.validator!==this.minValidator},this)),A){var T=P||g.messages.Date.min;typeof T=="string"&&(T=T.replace(/{MIN}/,A===Date.now?"Date.now()":A.toString()));var R=this;this.validators.push({validator:this.minValidator=function(M){var L=A;typeof A=="function"&&A!==Date.now&&(L=L.call(this));var W=L===Date.now?L():R.cast(L);return M===null||M.valueOf()>=W.valueOf()},message:T,type:"min",min:A})}return this},f.prototype.max=function(A,P){if(this.maxValidator&&(this.validators=this.validators.filter(function(M){return M.validator!==this.maxValidator},this)),A){var T=P||g.messages.Date.max;typeof T=="string"&&(T=T.replace(/{MAX}/,A===Date.now?"Date.now()":A.toString()));var R=this;this.validators.push({validator:this.maxValidator=function(M){var L=A;typeof L=="function"&&L!==Date.now&&(L=L.call(this));var W=L===Date.now?L():R.cast(L);return M===null||M.valueOf()<=W.valueOf()},message:T,type:"max",max:A})}return this},f.prototype.cast=function(A){var P;P=typeof this._castFunction=="function"?this._castFunction:typeof this.constructor.cast=="function"?this.constructor.cast():f.cast();try{return P(A)}catch(T){throw new y("date",A,this.path,T,this)}},f.prototype.$conditionalHandlers=m(m({},E.prototype.$conditionalHandlers),{},{$gt:w,$gte:w,$lt:w,$lte:w}),f.prototype.castForQuery=function(A,P,T){if(A==null)try{return this.applySetters(P,T)}catch(M){throw M instanceof y&&M.path===this.path&&this.$fullPath!=null&&(M.path=this.$fullPath),M}var R=this.$conditionalHandlers[A];if(!R)throw new Error("Can't use "+A+" with Date.");return R.call(this,P)},a.exports=f},6621:(a,l,r)=>{function h(y){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},h(y)}function m(y,f){var w=Object.keys(y);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(y);f&&(A=A.filter(function(P){return Object.getOwnPropertyDescriptor(y,P).enumerable})),w.push.apply(w,A)}return w}function v(y){for(var f=1;f<arguments.length;f++){var w=arguments[f]!=null?arguments[f]:{};f%2?m(Object(w),!0).forEach(function(A){var P,T,R,M;P=y,T=A,R=w[A],M=function(L,W){if(h(L)!="object"||!L)return L;var G=L[Symbol.toPrimitive];if(G!==void 0){var re=G.call(L,"string");if(h(re)!="object")return re;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(T),(T=h(M)=="symbol"?M:String(M))in P?Object.defineProperty(P,T,{value:R,enumerable:!0,configurable:!0,writable:!0}):P[T]=R}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(w)):m(Object(w)).forEach(function(A){Object.defineProperty(y,A,Object.getOwnPropertyDescriptor(w,A))})}return y}var g=r(3207),_=g.CastError,E=r(6209),b=r(1563);function p(y,f){g.call(this,y,f,"Decimal128")}function x(y){return this.cast(y)}p.schemaName="Decimal128",p.defaultOptions={},p.prototype=Object.create(g.prototype),p.prototype.constructor=p,p._cast=E,p.set=g.set,p.setters=[],p.get=g.get,p.cast=function(y){return arguments.length===0||(y===!1&&(y=this._defaultCaster),this._cast=y),this._cast},p._defaultCaster=function(y){if(y!=null&&!b(y,"Decimal128"))throw new Error;return y},p._checkRequired=function(y){return b(y,"Decimal128")},p.checkRequired=g.checkRequired,p.prototype.checkRequired=function(y,f){return g._isRef(this,y,f,!0)?!!y:(typeof this.constructor.checkRequired=="function"?this.constructor.checkRequired():p.checkRequired())(y)},p.prototype.cast=function(y,f,w){if(g._isRef(this,y,f,w))return b(y,"Decimal128")?y:this._castRef(y,f,w);var A;A=typeof this._castFunction=="function"?this._castFunction:typeof this.constructor.cast=="function"?this.constructor.cast():p.cast();try{return A(y)}catch(P){throw new _("Decimal128",y,this.path,P,this)}},p.prototype.$conditionalHandlers=v(v({},g.prototype.$conditionalHandlers),{},{$gt:x,$gte:x,$lt:x,$lte:x}),a.exports=p},56:(a,l,r)=>{var h,m,v=r(1795),g=r(1071),_=r(9620).EventEmitter,E=r(94),b=r(6673),p=r(3207),x=r(9181),y=r(9691),f=r(719),w=r(6872),A=r(8413),P=r(3346),T=r(8770).arrayAtomicsSymbol,R=r(8770).arrayPathSymbol,M=r(8770).documentArrayParent;function L(oe,ae,de,be){if(ae.options&&ae.options.timeseries)throw new P(oe,"timeseries");var pe=L.defaultOptions&&L.defaultOptions._id;pe!=null&&((be=be||{})._id=pe),be!=null&&be._id!=null?ae=y(ae,be):de!=null&&de._id!=null&&(ae=y(ae,de));var U=W(ae,de);U.prototype.$basePath=oe,E.call(this,oe,U,de),this.schema=ae,this.schemaOptions=be||{},this.$isMongooseDocumentArray=!0,this.Constructor=U,U.base=ae.base;var B=this.defaultValue;"defaultValue"in this&&B===void 0||this.default(function(){var N=B.call(this);return N==null||Array.isArray(N)||(N=[N]),N}),this.$embeddedSchemaType=new g(oe+".$",{required:this&&this.schemaOptions&&this.schemaOptions.required||!1,$parentSchemaType:this}),this.$embeddedSchemaType.caster=this.Constructor,this.$embeddedSchemaType.schema=this.schema}function W(oe,ae,de){function be(){m.apply(this,arguments),this.__parentArray!=null&&this.__parentArray.getArrayParent()!=null&&this.$session(this.__parentArray.getArrayParent().$session())}m||(m=r(7734)),oe._preCompile();var pe=de!=null?de.prototype:m.prototype;for(var U in be.prototype=Object.create(pe),be.prototype.$__setSchema(oe),be.schema=oe,be.prototype.constructor=be,be.$isArraySubdocument=!0,be.events=new _,be.base=oe.base,oe.methods)be.prototype[U]=oe.methods[U];for(var B in oe.statics)be[B]=oe.statics[B];for(var N in _.prototype)be[N]=_.prototype[N];return be.options=ae,be}L.schemaName="DocumentArray",L.options={castNonArrays:!0},L.prototype=Object.create(E.prototype),L.prototype.constructor=L,L.prototype.OptionsConstructor=b,L.prototype.discriminator=function(oe,ae,de){typeof oe=="function"&&(oe=w.getFunctionName(oe)),de=de||{};var be=w.isPOJO(de)?de.value:de,pe=typeof de.clone!="boolean"||de.clone;ae.instanceOfSchema&&pe&&(ae=ae.clone());var U=W(ae=x(this.casterConstructor,oe,ae,be),null,this.casterConstructor);U.baseCasterConstructor=this.casterConstructor;try{Object.defineProperty(U,"name",{value:oe})}catch{}return this.casterConstructor.discriminators[oe]=U,this.casterConstructor.discriminators[oe]},L.prototype.doValidate=function(oe,ae,de,be){h||(h=r(5357));var pe=this;try{p.prototype.doValidate.call(this,oe,function(U){if(U)return ae(U);var B,N=oe&&oe.length;if(!N||be&&be.updateValidator)return ae();function z(Oe){Oe!=null&&(B=Oe),--N||ae(B)}w.isMongooseDocumentArray(oe)||(oe=new h(oe,pe.path,de));for(var H=0,Y=N;H<Y;++H){var fe=oe[H];if(fe!=null){if(!(fe instanceof m)){var Re=A(pe.casterConstructor,oe[H]);fe=oe[H]=new Re(fe,oe,void 0,void 0,H)}be==null||!be.validateModifiedOnly||fe.$isModified()?fe.$__validate(z):--N||ae(B)}else--N||ae(B)}},de)}catch(U){return ae(U)}},L.prototype.doValidateSync=function(oe,ae,de){var be=p.prototype.doValidateSync.call(this,oe,ae);if(be!=null)return be;var pe=oe&&oe.length,U=null;if(pe){for(var B=0,N=pe;B<N;++B){var z=oe[B];if(z){if(!(z instanceof m)){var H=A(this.casterConstructor,oe[B]);z=oe[B]=new H(z,oe,void 0,void 0,B)}if(de==null||!de.validateModifiedOnly||z.$isModified()){var Y=z.validateSync();Y&&U==null&&(U=Y)}}}return U}},L.prototype.getDefault=function(oe,ae,de){var be=typeof this.defaultValue=="function"?this.defaultValue.call(oe):this.defaultValue;if(be==null||de&&de.skipCast)return be;h||(h=r(5357)),Array.isArray(be)||(be=[be]),be=new h(be,this.path,oe);for(var pe=0;pe<be.length;++pe){var U=new(A(this.casterConstructor,be[pe]))({},be,void 0,void 0,pe);U.$init(be[pe]),U.isNew=!0,Object.assign(U.$__.activePaths.default,U.$__.activePaths.init),U.$__.activePaths.init={},be[pe]=U}return be};var G=Object.freeze({transform:!1,virtuals:!1}),re=Object.freeze({skipId:!1,willInit:!0});function Q(oe,ae,de){if(de&&ae){for(var be,pe,U,B=oe.path+".",N=Object.keys(ae),z=N.length,H={};z--;)if((pe=N[z]).startsWith(B)){if((U=pe.substring(B.length))==="$")continue;U.startsWith("$.")&&(U=U.substring(2)),be||(be=!0),H[U]=ae[pe]}return be&&H||void 0}}L.prototype.cast=function(oe,ae,de,be,pe){if(h||(h=r(5357)),oe!=null&&oe[R]!=null&&oe===be)return oe;var U,B,N=(pe=pe||{}).path||this.path;if(!Array.isArray(oe)){if(!de&&!L.options.castNonArrays)throw new v("DocumentArray",oe,this.path,null,this);return ae&&de&&ae.markModified(N),this.cast([oe],ae,de,be,pe)}pe.skipDocumentArrayCast&&!w.isMongooseDocumentArray(oe)||(oe=new h(oe,N,ae)),be!=null&&(oe[T]=be[T]||{}),pe.arrayPathIndex!=null&&(oe[R]=N+"."+pe.arrayPathIndex);for(var z=w.isMongooseDocumentArray(oe)?oe.__array:oe,H=z.length,Y=0;Y<H;++Y)if(z[Y]){var fe=A(this.casterConstructor,z[Y]);if(z[Y].$__!=null&&!(z[Y]instanceof fe)){var Re=f(z[Y],!0);z[Y]!==Re?z[Y]=Re:z[Y]=z[Y].toObject({transform:!1,virtuals:z[Y].schema===fe.schema})}if(z[Y]instanceof m){if(z[Y][M]!==ae)if(de){var Oe=new fe(null,oe,re,U,Y);z[Y]=Oe.$init(z[Y])}else{var De=new fe(z[Y],oe,void 0,void 0,Y);z[Y]=De}z[Y].__index==null&&z[Y].$setIndex(Y)}else if(z[Y]!=null)if(de)ae?U||(U=Q(this,ae.$__.selected,de)):U=!0,B=new fe(null,oe,re,U,Y),z[Y]=B.$init(z[Y]);else if(be&&typeof be.id=="function"&&(B=be.id(z[Y]._id)),be&&B&&w.deepEqual(B.toObject(G),z[Y]))B.set(z[Y]),z[Y]=B;else try{B=new fe(z[Y],oe,void 0,void 0,Y),z[Y]=B}catch(ot){throw new v("embedded",z[Y],oe[R],ot,this)}}return oe},L.prototype.clone=function(){var oe=Object.assign({},this.options),ae=new this.constructor(this.path,this.schema,oe,this.schemaOptions);return ae.validators=this.validators.slice(),this.requiredValidator!==void 0&&(ae.requiredValidator=this.requiredValidator),ae.Constructor.discriminators=Object.assign({},this.Constructor.discriminators),ae},L.prototype.applyGetters=function(oe,ae){return p.prototype.applyGetters.call(this,oe,ae)},L.defaultOptions={},L.set=p.set,L.setters=[],L.get=p.get,a.exports=L},1071:(a,l,r)=>{var h=r(5202),m=r(3207),v=r(4877),g=r(8413);function _(E,b){if(this.$parentSchemaType=b&&b.$parentSchemaType,!this.$parentSchemaType)throw new h("Cannot create DocumentArrayElement schematype without a parent");delete b.$parentSchemaType,m.call(this,E,b,"DocumentArrayElement"),this.$isMongooseDocumentArrayElement=!0}_.schemaName="DocumentArrayElement",_.defaultOptions={},_.prototype=Object.create(m.prototype),_.prototype.constructor=_,_.prototype.cast=function(){var E;return(E=this.$parentSchemaType).cast.apply(E,arguments)[0]},_.prototype.doValidate=function(E,b,p,x){var y=g(this.caster,E);return!E||E instanceof y||(E=new y(E,p,null,null,x&&x.index!=null?x.index:null)),v.prototype.doValidate.call(this,E,b,p,x)},_.prototype.clone=function(){this.options.$parentSchemaType=this.$parentSchemaType;var E=m.prototype.clone.apply(this,arguments);return delete this.options.$parentSchemaType,E.caster=this.caster,E.schema=this.schema,E},a.exports=_},5251:(a,l,r)=>{l.Array=r(94),l.BigInt=r(6795),l.Boolean=r(6470),l.Buffer=r(8800),l.Date=r(6535),l.Decimal128=l.Decimal=r(6621),l.DocumentArray=r(56),l.Map=r(71),l.Mixed=r(3861),l.Number=r(1751),l.ObjectId=r(3248),l.String=r(6542),l.Subdocument=r(4877),l.UUID=r(2729),l.Oid=l.ObjectId,l.Object=l.Mixed,l.Bool=l.Boolean,l.ObjectID=l.ObjectId},71:(a,l,r)=>{function h(P){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},h(P)}function m(P,T){(T==null||T>P.length)&&(T=P.length);for(var R=0,M=new Array(T);R<T;R++)M[R]=P[R];return M}function v(P,T){for(var R=0;R<T.length;R++){var M=T[R];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(P,g(M.key),M)}}function g(P){var T=function(R,M){if(h(R)!="object"||!R)return R;var L=R[Symbol.toPrimitive];if(L!==void 0){var W=L.call(R,"string");if(h(W)!="object")return W;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(R)}(P);return h(T)=="symbol"?T:String(T)}function _(P,T,R){return T=p(T),function(M,L){if(L&&(h(L)==="object"||typeof L=="function"))return L;if(L!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(W){if(W===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return W}(M)}(P,E()?Reflect.construct(T,R||[],p(P).constructor):T.apply(P,R))}function E(){try{var P=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(E=function(){return!!P})()}function b(){return b=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(P,T,R){var M=function(W,G){for(;!Object.prototype.hasOwnProperty.call(W,G)&&(W=p(W))!==null;);return W}(P,T);if(M){var L=Object.getOwnPropertyDescriptor(M,T);return L.get?L.get.call(arguments.length<3?P:R):L.value}},b.apply(this,arguments)}function p(P){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(T){return T.__proto__||Object.getPrototypeOf(T)},p(P)}function x(P,T){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(R,M){return R.__proto__=M,R},x(P,T)}var y=r(3828),f=r(233),w=r(3207),A=function(P){function T(L,W){var G;return function(re,Q){if(!(re instanceof Q))throw new TypeError("Cannot call a class as a function")}(this,T),(G=_(this,T,[L,W,"Map"])).$isSchemaMap=!0,G}var R,M;return function(L,W){if(typeof W!="function"&&W!==null)throw new TypeError("Super expression must either be null or a function");L.prototype=Object.create(W&&W.prototype,{constructor:{value:L,writable:!0,configurable:!0}}),Object.defineProperty(L,"prototype",{writable:!1}),W&&x(L,W)}(T,P),R=T,(M=[{key:"set",value:function(L,W){return w.set(L,W)}},{key:"cast",value:function(L,W,G){if(L instanceof y)return L;var re=this.path;if(G){var Q=new y({},re,W,this.$__schemaType);if(L instanceof r.g.Map){var oe,ae=function(z,H){var Y=typeof Symbol<"u"&&z[Symbol.iterator]||z["@@iterator"];if(!Y){if(Array.isArray(z)||(Y=function(X,ee){if(X){if(typeof X=="string")return m(X,ee);var Le=Object.prototype.toString.call(X).slice(8,-1);return Le==="Object"&&X.constructor&&(Le=X.constructor.name),Le==="Map"||Le==="Set"?Array.from(X):Le==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Le)?m(X,ee):void 0}}(z))||H&&z&&typeof z.length=="number"){Y&&(z=Y);var fe=0,Re=function(){};return{s:Re,n:function(){return fe>=z.length?{done:!0}:{done:!1,value:z[fe++]}},e:function(X){throw X},f:Re}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Oe,De=!0,ot=!1;return{s:function(){Y=Y.call(z)},n:function(){var X=Y.next();return De=X.done,X},e:function(X){ot=!0,Oe=X},f:function(){try{De||Y.return==null||Y.return()}finally{if(ot)throw Oe}}}}(L.keys());try{for(ae.s();!(oe=ae.n()).done;){var de=oe.value,be=L.get(de);be=be==null?Q.$__schemaType._castNullish(be):Q.$__schemaType.cast(be,W,!0,null,{path:re+"."+de}),Q.$init(de,be)}}catch(z){ae.e(z)}finally{ae.f()}}else for(var pe=0,U=Object.keys(L);pe<U.length;pe++){var B=U[pe],N=L[B];N=N==null?Q.$__schemaType._castNullish(N):Q.$__schemaType.cast(N,W,!0,null,{path:re+"."+B}),Q.$init(B,N)}return Q}return new y(L,re,W,this.$__schemaType)}},{key:"clone",value:function(){var L=b(p(T.prototype),"clone",this).call(this);return this.$__schemaType!=null&&(L.$__schemaType=this.$__schemaType.clone()),L}}])&&v(R.prototype,M),Object.defineProperty(R,"prototype",{writable:!1}),T}(w);A.schemaName="Map",A.prototype.OptionsConstructor=f,A.defaultOptions={},a.exports=A},3861:(a,l,r)=>{var h=r(3207),m=r(8107),v=r(5721),g=r(6872);function _(E,b){if(b&&b.default){var p=b.default;Array.isArray(p)&&p.length===0?b.default=Array:!b.shared&&v(p)&&Object.keys(p).length===0&&(b.default=function(){return{}})}h.call(this,E,b,"Mixed"),this[m.schemaMixedSymbol]=!0}_.schemaName="Mixed",_.defaultOptions={},_.prototype=Object.create(h.prototype),_.prototype.constructor=_,_.get=h.get,_.set=h.set,_.setters=[],_.prototype.cast=function(E){return E instanceof Error?g.errorToPOJO(E):E},_.prototype.castForQuery=function(E,b){return b},a.exports=_},1751:(a,l,r)=>{function h(A,P){var T=Object.keys(A);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(A);P&&(R=R.filter(function(M){return Object.getOwnPropertyDescriptor(A,M).enumerable})),T.push.apply(T,R)}return T}function m(A){for(var P=1;P<arguments.length;P++){var T=arguments[P]!=null?arguments[P]:{};P%2?h(Object(T),!0).forEach(function(R){var M,L,W,G;M=A,L=R,W=T[R],G=function(re,Q){if(v(re)!="object"||!re)return re;var oe=re[Symbol.toPrimitive];if(oe!==void 0){var ae=oe.call(re,"string");if(v(ae)!="object")return ae;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(re)}(L),(L=v(G)=="symbol"?G:String(G))in M?Object.defineProperty(M,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):M[L]=W}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(T)):h(Object(T)).forEach(function(R){Object.defineProperty(A,R,Object.getOwnPropertyDescriptor(T,R))})}return A}function v(A){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},v(A)}var g=r(4888),_=r(5702),E=r(3207),b=r(3065),p=r(4282),x=r(6872),y=E.CastError;function f(A,P){E.call(this,A,P,"Number")}function w(A){return this.cast(A)}f.get=E.get,f.set=E.set,f.setters=[],f._cast=b,f.cast=function(A){return arguments.length===0||(A===!1&&(A=this._defaultCaster),this._cast=A),this._cast},f._defaultCaster=function(A){if(typeof A!="number")throw new Error;return A},f.schemaName="Number",f.defaultOptions={},f.prototype=Object.create(E.prototype),f.prototype.constructor=f,f.prototype.OptionsConstructor=_,f._checkRequired=function(A){return typeof A=="number"||A instanceof Number},f.checkRequired=E.checkRequired,f.prototype.checkRequired=function(A,P){return v(A)==="object"&&E._isRef(this,A,P,!0)?A!=null:(typeof this.constructor.checkRequired=="function"?this.constructor.checkRequired():f.checkRequired())(A)},f.prototype.min=function(A,P){if(this.minValidator&&(this.validators=this.validators.filter(function(R){return R.validator!==this.minValidator},this)),A!=null){var T=P||g.messages.Number.min;T=T.replace(/{MIN}/,A),this.validators.push({validator:this.minValidator=function(R){return R==null||R>=A},message:T,type:"min",min:A})}return this},f.prototype.max=function(A,P){if(this.maxValidator&&(this.validators=this.validators.filter(function(R){return R.validator!==this.maxValidator},this)),A!=null){var T=P||g.messages.Number.max;T=T.replace(/{MAX}/,A),this.validators.push({validator:this.maxValidator=function(R){return R==null||R<=A},message:T,type:"max",max:A})}return this},f.prototype.enum=function(A,P){return this.enumValidator&&(this.validators=this.validators.filter(function(T){return T.validator!==this.enumValidator},this)),Array.isArray(A)||(x.isPOJO(A)&&A.values!=null?(P=A.message,A=A.values):typeof A=="number"&&(A=Array.prototype.slice.call(arguments),P=null),x.isPOJO(A)&&(A=Object.values(A)),P=P||g.messages.Number.enum),P=P??g.messages.Number.enum,this.enumValidator=function(T){return T==null||A.indexOf(T)!==-1},this.validators.push({validator:this.enumValidator,message:P,type:"enum",enumValues:A}),this},f.prototype.cast=function(A,P,T){if(typeof A!="number"&&E._isRef(this,A,P,T)&&(A==null||x.isNonBuiltinObject(A)))return this._castRef(A,P,T);var R,M=A&&A._id!==void 0?A._id:A;R=typeof this._castFunction=="function"?this._castFunction:typeof this.constructor.cast=="function"?this.constructor.cast():f.cast();try{return R(M)}catch(L){throw new y("Number",M,this.path,L,this)}},f.prototype.$conditionalHandlers=m(m({},E.prototype.$conditionalHandlers),{},{$bitsAllClear:p,$bitsAnyClear:p,$bitsAllSet:p,$bitsAnySet:p,$gt:w,$gte:w,$lt:w,$lte:w,$mod:function(A){var P=this;return Array.isArray(A)?A.map(function(T){return P.cast(T)}):[this.cast(A)]}}),f.prototype.castForQuery=function(A,P,T){var R;if(A!=null){if(!(R=this.$conditionalHandlers[A]))throw new y("number",P,this.path,null,this);return R.call(this,P,T)}try{P=this.applySetters(P,T)}catch(M){throw M instanceof y&&M.path===this.path&&this.$fullPath!=null&&(M.path=this.$fullPath),M}return P},a.exports=f},3248:(a,l,r)=>{function h(M){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},h(M)}function m(M,L){var W=Object.keys(M);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(M);L&&(G=G.filter(function(re){return Object.getOwnPropertyDescriptor(M,re).enumerable})),W.push.apply(W,G)}return W}function v(M){for(var L=1;L<arguments.length;L++){var W=arguments[L]!=null?arguments[L]:{};L%2?m(Object(W),!0).forEach(function(G){var re,Q,oe,ae;re=M,Q=G,oe=W[G],ae=function(de,be){if(h(de)!="object"||!de)return de;var pe=de[Symbol.toPrimitive];if(pe!==void 0){var U=pe.call(de,"string");if(h(U)!="object")return U;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(de)}(Q),(Q=h(ae)=="symbol"?ae:String(ae))in re?Object.defineProperty(re,Q,{value:oe,enumerable:!0,configurable:!0,writable:!0}):re[Q]=oe}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(W)):m(Object(W)).forEach(function(G){Object.defineProperty(M,G,Object.getOwnPropertyDescriptor(W,G))})}return M}var g,_=r(3203),E=r(3207),b=r(4731),p=r(1981),x=r(6079),y=r(1563),f=r(6872),w=E.CastError;function A(M,L){var W=typeof M=="string"&&M.length===24&&/^[a-f0-9]+$/i.test(M),G=L&&L.suppressWarning;!W&&M!==void 0||G||f.warn("mongoose: To create a new ObjectId please try `Mongoose.Types.ObjectId` instead of using `Mongoose.Schema.ObjectId`. Set the `suppressWarning` option if you're trying to create a hex char path in your schema."),E.call(this,M,L,"ObjectId")}function P(M){return this.cast(M)}function T(){return new x}function R(M){return g||(g=r(8727)),this instanceof g&&M===void 0?new x:M}A.schemaName="ObjectId",A.defaultOptions={},A.prototype=Object.create(E.prototype),A.prototype.constructor=A,A.prototype.OptionsConstructor=_,A.get=E.get,A.set=E.set,A.setters=[],A.prototype.auto=function(M){return M&&(this.default(T),this.set(R)),this},A._checkRequired=function(M){return y(M,"ObjectId")},A._cast=b,A.cast=function(M){return arguments.length===0||(M===!1&&(M=this._defaultCaster),this._cast=M),this._cast},A._defaultCaster=function(M){if(!y(M,"ObjectId"))throw new Error(M+" is not an instance of ObjectId");return M},A.checkRequired=E.checkRequired,A.prototype.checkRequired=function(M,L){return E._isRef(this,M,L,!0)?!!M:(typeof this.constructor.checkRequired=="function"?this.constructor.checkRequired():A.checkRequired())(M)},A.prototype.cast=function(M,L,W){if(!y(M,"ObjectId")&&E._isRef(this,M,L,W)){if((p(M)||"").toLowerCase()==="objectid")return new x(M.toHexString());if(M==null||f.isNonBuiltinObject(M))return this._castRef(M,L,W)}var G;G=typeof this._castFunction=="function"?this._castFunction:typeof this.constructor.cast=="function"?this.constructor.cast():A.cast();try{return G(M)}catch(re){throw new w("ObjectId",M,this.path,re,this)}},A.prototype.$conditionalHandlers=v(v({},E.prototype.$conditionalHandlers),{},{$gt:P,$gte:P,$lt:P,$lte:P}),T.$runBeforeSetters=!0,a.exports=A},4282:(a,l,r)=>{var h=r(365).Buffer,m=r(1795);function v(g,_){var E=Number(_);if(isNaN(E))throw new m("number",_,g);return E}a.exports=function(g){var _=this;return Array.isArray(g)?g.map(function(E){return v(_.path,E)}):h.isBuffer(g)?g:v(_.path,g)}},8702:(a,l,r)=>{var h=r(6670);a.exports=function(m){var v=this!=null?this.path:null;return h(m,v)}},5008:(a,l,r)=>{var h=r(1521).i,m=r(1521).W;function v(_,E){switch(_.$geometry.type){case"Polygon":case"LineString":case"Point":h(_.$geometry.coordinates,E)}return g(E,_),_}function g(_,E){E.$maxDistance&&(E.$maxDistance=m.call(_,E.$maxDistance)),E.$minDistance&&(E.$minDistance=m.call(_,E.$minDistance))}l.cast$geoIntersects=function(_){if(_.$geometry)return v(_,this),_},l.cast$near=function(_){var E=r(94);if(Array.isArray(_))return h(_,this),_;if(g(this,_),_&&_.$geometry)return v(_,this);if(!Array.isArray(_))throw new TypeError("$near must be either an array or an object with a $geometry property");return E.prototype.castForQuery.call(this,null,_)},l.cast$within=function(_){var E=this;if(g(this,_),_.$box||_.$polygon){var b=_.$box?"$box":"$polygon";_[b].forEach(function(x){if(!Array.isArray(x))throw new TypeError("Invalid $within $box argument. Expected an array, received "+x);x.forEach(function(y,f){x[f]=m.call(E,y)})})}else if(_.$center||_.$centerSphere){var p=_.$center?"$center":"$centerSphere";_[p].forEach(function(x,y){Array.isArray(x)?x.forEach(function(f,w){x[w]=m.call(E,f)}):_[p][y]=m.call(E,x)})}else _.$geometry&&v(_,this);return _}},1521:(a,l,r)=>{var h=r(1751);function m(v){return h.cast()(v)}l.W=m,l.i=function v(g,_){g.forEach(function(E,b){Array.isArray(E)?v(E,_):g[b]=m.call(_,E)})}},6495:(a,l,r)=>{function h(_){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},h(_)}var m=r(1795),v=r(6670),g=r(2417);a.exports=function(_,E){if(_==null||h(_)!=="object")throw new m("$text",_,E);return _.$search!=null&&(_.$search=g(_.$search,E+".$search")),_.$language!=null&&(_.$language=g(_.$language,E+".$language")),_.$caseSensitive!=null&&(_.$caseSensitive=v(_.$caseSensitive,E+".$castSensitive")),_.$diacriticSensitive!=null&&(_.$diacriticSensitive=v(_.$diacriticSensitive,E+".$diacriticSensitive")),_}},3053:a=>{a.exports=function(l){if(Array.isArray(l)){if(!l.every(function(r){return typeof r=="number"||typeof r=="string"}))throw new Error("$type array values must be strings or numbers");return l}if(typeof l!="number"&&typeof l!="string")throw new Error("$type parameter must be number, string, or array of numbers and strings");return l}},6542:(a,l,r)=>{function h(R,M){var L=Object.keys(R);if(Object.getOwnPropertySymbols){var W=Object.getOwnPropertySymbols(R);M&&(W=W.filter(function(G){return Object.getOwnPropertyDescriptor(R,G).enumerable})),L.push.apply(L,W)}return L}function m(R){for(var M=1;M<arguments.length;M++){var L=arguments[M]!=null?arguments[M]:{};M%2?h(Object(L),!0).forEach(function(W){var G,re,Q,oe;G=R,re=W,Q=L[W],oe=function(ae,de){if(v(ae)!="object"||!ae)return ae;var be=ae[Symbol.toPrimitive];if(be!==void 0){var pe=be.call(ae,"string");if(v(pe)!="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ae)}(re),(re=v(oe)=="symbol"?oe:String(oe))in G?Object.defineProperty(G,re,{value:Q,enumerable:!0,configurable:!0,writable:!0}):G[re]=Q}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(L)):h(Object(L)).forEach(function(W){Object.defineProperty(R,W,Object.getOwnPropertyDescriptor(L,W))})}return R}function v(R){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},v(R)}function g(R,M){(M==null||M>R.length)&&(M=R.length);for(var L=0,W=new Array(M);L<M;L++)W[L]=R[L];return W}var _=r(3207),E=r(4888),b=r(4576),p=r(2417),x=r(6872),y=r(1563),f=_.CastError;function w(R,M){this.enumValues=[],this.regExp=null,_.call(this,R,M,"String")}function A(R,M){return this.castForQuery(null,R,M)}function P(R){return R==null?this._castNullish(R):this.cast(R,this)}w.schemaName="String",w.defaultOptions={},w.prototype=Object.create(_.prototype),w.prototype.constructor=w,Object.defineProperty(w.prototype,"OptionsConstructor",{configurable:!1,enumerable:!1,writable:!1,value:b}),w._cast=p,w.cast=function(R){return arguments.length===0||(R===!1&&(R=this._defaultCaster),this._cast=R),this._cast},w._defaultCaster=function(R){if(R!=null&&typeof R!="string")throw new Error;return R},w.get=_.get,w.set=_.set,w.setters=[],w._checkRequired=function(R){return(R instanceof String||typeof R=="string")&&R.length},w.checkRequired=_.checkRequired,w.prototype.enum=function(){if(this.enumValidator&&(this.validators=this.validators.filter(function(Q){return Q.validator!==this.enumValidator},this),this.enumValidator=!1),arguments[0]===void 0||arguments[0]===!1)return this;var R,M;x.isObject(arguments[0])?Array.isArray(arguments[0].values)?(R=arguments[0].values,M=arguments[0].message):(R=x.object.vals(arguments[0]),M=E.messages.String.enum):(R=arguments,M=E.messages.String.enum);var L,W=function(Q,oe){var ae=typeof Symbol<"u"&&Q[Symbol.iterator]||Q["@@iterator"];if(!ae){if(Array.isArray(Q)||(ae=function(N,z){if(N){if(typeof N=="string")return g(N,z);var H=Object.prototype.toString.call(N).slice(8,-1);return H==="Object"&&N.constructor&&(H=N.constructor.name),H==="Map"||H==="Set"?Array.from(N):H==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(H)?g(N,z):void 0}}(Q))||oe&&Q&&typeof Q.length=="number"){ae&&(Q=ae);var de=0,be=function(){};return{s:be,n:function(){return de>=Q.length?{done:!0}:{done:!1,value:Q[de++]}},e:function(N){throw N},f:be}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var pe,U=!0,B=!1;return{s:function(){ae=ae.call(Q)},n:function(){var N=ae.next();return U=N.done,N},e:function(N){B=!0,pe=N},f:function(){try{U||ae.return==null||ae.return()}finally{if(B)throw pe}}}}(R);try{for(W.s();!(L=W.n()).done;){var G=L.value;G!==void 0&&this.enumValues.push(this.cast(G))}}catch(Q){W.e(Q)}finally{W.f()}var re=this.enumValues;return this.enumValidator=function(Q){return Q==null||~re.indexOf(Q)},this.validators.push({validator:this.enumValidator,message:M,type:"enum",enumValues:re}),this},w.prototype.lowercase=function(R){var M=this;return arguments.length>0&&!R?this:this.set(function(L){return typeof L!="string"&&(L=M.cast(L)),L&&L.toLowerCase()})},w.prototype.uppercase=function(R){var M=this;return arguments.length>0&&!R?this:this.set(function(L){return typeof L!="string"&&(L=M.cast(L)),L&&L.toUpperCase()})},w.prototype.trim=function(R){var M=this;return arguments.length>0&&!R?this:this.set(function(L){return typeof L!="string"&&(L=M.cast(L)),L&&L.trim()})},w.prototype.minlength=function(R,M){if(this.minlengthValidator&&(this.validators=this.validators.filter(function(W){return W.validator!==this.minlengthValidator},this)),R!=null){var L=M||E.messages.String.minlength;L=L.replace(/{MINLENGTH}/,R),this.validators.push({validator:this.minlengthValidator=function(W){return W===null||W.length>=R},message:L,type:"minlength",minlength:R})}return this},w.prototype.minLength=w.prototype.minlength,w.prototype.maxlength=function(R,M){if(this.maxlengthValidator&&(this.validators=this.validators.filter(function(W){return W.validator!==this.maxlengthValidator},this)),R!=null){var L=M||E.messages.String.maxlength;L=L.replace(/{MAXLENGTH}/,R),this.validators.push({validator:this.maxlengthValidator=function(W){return W===null||W.length<=R},message:L,type:"maxlength",maxlength:R})}return this},w.prototype.maxLength=w.prototype.maxlength,w.prototype.match=function(R,M){var L=M||E.messages.String.match;return this.validators.push({validator:function(W){return!!R&&(R.lastIndex=0,W==null||W===""||R.test(W))},message:L,type:"regexp",regexp:R}),this},w.prototype.checkRequired=function(R,M){return v(R)==="object"&&_._isRef(this,R,M,!0)?R!=null:(typeof this.constructor.checkRequired=="function"?this.constructor.checkRequired():w.checkRequired())(R)},w.prototype.cast=function(R,M,L){if(typeof R!="string"&&_._isRef(this,R,M,L))return this._castRef(R,M,L);var W;W=typeof this._castFunction=="function"?this._castFunction:typeof this.constructor.cast=="function"?this.constructor.cast():w.cast();try{return W(R)}catch{throw new f("string",R,this.path,null,this)}};var T=m(m({},_.prototype.$conditionalHandlers),{},{$all:function(R,M){var L=this;return Array.isArray(R)?R.map(function(W){return L.castForQuery(null,W,M)}):[this.castForQuery(null,R,M)]},$gt:A,$gte:A,$lt:A,$lte:A,$options:P,$regex:function(R){return Object.prototype.toString.call(R)==="[object RegExp]"?R:P.call(this,R)},$not:A});Object.defineProperty(w.prototype,"$conditionalHandlers",{configurable:!1,enumerable:!1,writable:!1,value:Object.freeze(T)}),w.prototype.castForQuery=function(R,M,L){var W;if(R!=null){if(!(W=this.$conditionalHandlers[R]))throw new Error("Can't use "+R+" with String.");return W.call(this,M,L)}if(Object.prototype.toString.call(M)==="[object RegExp]"||y(M,"BSONRegExp"))return M;try{return this.applySetters(M,L)}catch(G){throw G instanceof f&&G.path===this.path&&this.$fullPath!=null&&(G.path=this.$fullPath),G}},a.exports=w},4877:(a,l,r)=>{function h(oe,ae){var de=Object.keys(oe);if(Object.getOwnPropertySymbols){var be=Object.getOwnPropertySymbols(oe);ae&&(be=be.filter(function(pe){return Object.getOwnPropertyDescriptor(oe,pe).enumerable})),de.push.apply(de,be)}return de}function m(oe){for(var ae=1;ae<arguments.length;ae++){var de=arguments[ae]!=null?arguments[ae]:{};ae%2?h(Object(de),!0).forEach(function(be){var pe,U,B,N;pe=oe,U=be,B=de[be],N=function(z,H){if(v(z)!="object"||!z)return z;var Y=z[Symbol.toPrimitive];if(Y!==void 0){var fe=Y.call(z,"string");if(v(fe)!="object")return fe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(z)}(U),(U=v(N)=="symbol"?N:String(N))in pe?Object.defineProperty(pe,U,{value:B,enumerable:!0,configurable:!0,writable:!0}):pe[U]=B}):Object.getOwnPropertyDescriptors?Object.defineProperties(oe,Object.getOwnPropertyDescriptors(de)):h(Object(de)).forEach(function(be){Object.defineProperty(oe,be,Object.getOwnPropertyDescriptor(de,be))})}return oe}function v(oe){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},v(oe)}var g,_=r(1795),E=r(9620).EventEmitter,b=r(4107),p=r(843),x=r(3207),y=r(2874),f=r(8702),w=r(1521).W,A=r(9181),P=r(5008),T=r(8413),R=r(9691),M=r(4962).h,L=r(9098),W=r(6872),G=r(3346);function re(oe,ae,de){if(oe.options.timeseries)throw new G(ae,"timeseries");var be=re.defaultOptions&&re.defaultOptions._id;be!=null&&((de=de||{})._id=be),oe=R(oe,de),this.caster=Q(oe,null,de),this.caster.path=ae,this.caster.prototype.$basePath=ae,this.schema=oe,this.$isSingleNested=!0,this.base=oe.base,x.call(this,ae,de,"Embedded")}function Q(oe,ae,de){g||(g=r(2591));var be=function(z,H,Y){this.$__parent=Y,g.apply(this,arguments),Y!=null&&this.$session(Y.$session())};oe._preCompile();var pe=ae!=null?ae.prototype:g.prototype;for(var U in(be.prototype=Object.create(pe)).$__setSchema(oe),be.prototype.constructor=be,be.$__required=de==null?void 0:de.required,be.base=oe.base,be.schema=oe,be.$isSingleNested=!0,be.events=new E,be.prototype.toBSON=function(){return this.toObject(M)},oe.methods)be.prototype[U]=oe.methods[U];for(var B in oe.statics)be[B]=oe.statics[B];for(var N in E.prototype)be[N]=E.prototype[N];return be}a.exports=re,re.prototype=Object.create(x.prototype),re.prototype.constructor=re,re.prototype.OptionsConstructor=p,re.prototype.$conditionalHandlers.$geoWithin=function(oe,ae){return{$geometry:this.castForQuery(null,oe.$geometry,ae)}},re.prototype.$conditionalHandlers.$near=re.prototype.$conditionalHandlers.$nearSphere=P.cast$near,re.prototype.$conditionalHandlers.$within=re.prototype.$conditionalHandlers.$geoWithin=P.cast$within,re.prototype.$conditionalHandlers.$geoIntersects=P.cast$geoIntersects,re.prototype.$conditionalHandlers.$minDistance=w,re.prototype.$conditionalHandlers.$maxDistance=w,re.prototype.$conditionalHandlers.$exists=f,re.prototype.cast=function(oe,ae,de,be,pe){if(oe&&oe.$isSingleNested&&oe.parent===ae)return oe;if(oe!=null&&(v(oe)!=="object"||Array.isArray(oe)))throw new b(this.path,oe);var U,B=this.schema.path(this.schema.options.discriminatorKey),N=B==null?null:B.getDefault(ae),z=T(this.caster,oe,N),H=ae&&ae.$__&&ae.$__.selected,Y=this.path,fe=H==null?null:Object.keys(H).reduce(function(Oe,De){return De.startsWith(Y+".")&&((Oe=Oe||{})[De.substring(Y.length+1)]=H[De]),Oe},null);if(!de)return pe=Object.assign({},pe,{priorDoc:be}),Object.keys(oe).length===0?new z({},fe,ae,void 0,pe):new z(oe,fe,ae,void 0,pe);delete(U=new z(void 0,fe,ae,!1,{defaults:!1})).$__.defaults,U.$init(oe);var Re=L(fe);return y(U,fe,Re),U},re.prototype.castForQuery=function(oe,ae,de,be){var pe;if(oe!=null){if(!(pe=this.$conditionalHandlers[oe]))throw new Error("Can't use "+oe);return pe.call(this,ae)}if(ae==null)return ae;var U=T(this.caster,ae);if(ae instanceof U)return ae;this.options.runSetters&&(ae=this._applySetters(ae,de));var B=be!=null&&be.strict!=null?be.strict:void 0;try{ae=new U(ae,B)}catch(N){throw N instanceof _?N:new _("Embedded",ae,this.path,N,this)}return ae},re.prototype.doValidate=function(oe,ae,de,be){var pe=T(this.caster,oe);if(!oe||oe instanceof pe||(oe=new pe(oe,null,de!=null&&de.$__!=null?de:null)),be&&be.skipSchemaValidators)return oe?oe.validate().then(function(){return ae(null)},function(U){return ae(U)}):ae(null);x.prototype.doValidate.call(this,oe,function(U){return U?ae(U):oe?void oe.validate().then(function(){return ae(null)},function(B){return ae(B)}):ae(null)},de,be)},re.prototype.doValidateSync=function(oe,ae,de){if(!de||!de.skipSchemaValidators){var be=x.prototype.doValidateSync.call(this,oe,ae);if(be)return be}if(oe)return oe.validateSync()},re.prototype.discriminator=function(oe,ae,de){de=de||{};var be=W.isPOJO(de)?de.value:de,pe=typeof de.clone!="boolean"||de.clone;return ae.instanceOfSchema&&pe&&(ae=ae.clone()),ae=A(this.caster,oe,ae,be),this.caster.discriminators[oe]=Q(ae,this.caster),this.caster.discriminators[oe]},re.defaultOptions={},re.set=x.set,re.setters=[],re.get=x.get,re.prototype.toJSON=function(){return{path:this.path,options:this.options}},re.prototype.clone=function(){var oe=new this.constructor(this.schema,this.path,m(m({},this.options),{},{_skipApplyDiscriminators:!0}));return oe.validators=this.validators.slice(),this.requiredValidator!==void 0&&(oe.requiredValidator=this.requiredValidator),oe.caster.discriminators=Object.assign({},this.caster.discriminators),oe}},8107:(a,l)=>{l.schemaMixedSymbol=Symbol.for("mongoose:schema_mixed"),l.builtInMiddleware=Symbol.for("mongoose:built-in-middleware")},2729:(a,l,r)=>{var h=r(365).Buffer;function m(M){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},m(M)}function v(M,L){var W=Object.keys(M);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(M);L&&(G=G.filter(function(re){return Object.getOwnPropertyDescriptor(M,re).enumerable})),W.push.apply(W,G)}return W}function g(M){for(var L=1;L<arguments.length;L++){var W=arguments[L]!=null?arguments[L]:{};L%2?v(Object(W),!0).forEach(function(G){var re,Q,oe,ae;re=M,Q=G,oe=W[G],ae=function(de,be){if(m(de)!="object"||!de)return de;var pe=de[Symbol.toPrimitive];if(pe!==void 0){var U=pe.call(de,"string");if(m(U)!="object")return U;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(de)}(Q),(Q=m(ae)=="symbol"?ae:String(ae))in re?Object.defineProperty(re,Q,{value:oe,enumerable:!0,configurable:!0,writable:!0}):re[Q]=oe}):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(W)):v(Object(W)).forEach(function(G){Object.defineProperty(M,G,Object.getOwnPropertyDescriptor(W,G))})}return M}var _=r(4051),E=r(3207),b=E.CastError,p=r(6872),x=r(4282),y=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}/i,f=_.Binary;function w(M){typeof M!="string"&&(M="");var L,W=(L=M.replace(/[{}-]/g,""))!=null&&h.from(L,"hex"),G=new _(W);return G._subtype=4,G}function A(M){var L,W;return typeof M!="string"&&M!=null?(L=(W=M)!=null&&W.toString("hex")).substring(0,8)+"-"+L.substring(8,12)+"-"+L.substring(12,16)+"-"+L.substring(16,20)+"-"+L.substring(20,32):M}function P(M,L){E.call(this,M,L,"UUID"),this.getters.push(function(W){return W!=null&&W.$__!=null?W:A(W)})}function T(M){return this.cast(M)}function R(M){var L=this;return M.map(function(W){return L.cast(W)})}P.schemaName="UUID",P.defaultOptions={},P.prototype=Object.create(E.prototype),P.prototype.constructor=P,P._cast=function(M){if(M==null)return M;function L(W){var G=new _(W);return G._subtype=4,G}if(typeof M=="string"){if(y.test(M))return w(M);throw new b(P.schemaName,M,this.path)}if(h.isBuffer(M))return L(M);if(M instanceof f)return L(M.value(!0));if(M.toString&&M.toString!==Object.prototype.toString&&y.test(M.toString()))return w(M.toString());throw new b(P.schemaName,M,this.path)},P.get=E.get,P.set=E.set,P.setters=[],P.cast=function(M){return arguments.length===0||(M===!1&&(M=this._defaultCaster),this._cast=M),this._cast},P._checkRequired=function(M){return M!=null},P.checkRequired=E.checkRequired,P.prototype.checkRequired=function(M){return h.isBuffer(M)&&(M=A(M)),M!=null&&y.test(M)},P.prototype.cast=function(M,L,W){if(p.isNonBuiltinObject(M)&&E._isRef(this,M,L,W))return this._castRef(M,L,W);var G;G=typeof this._castFunction=="function"?this._castFunction:typeof this.constructor.cast=="function"?this.constructor.cast():P.cast();try{return G(M)}catch(re){throw new b(P.schemaName,M,this.path,re,this)}},P.prototype.$conditionalHandlers=g(g({},E.prototype.$conditionalHandlers),{},{$bitsAllClear:x,$bitsAnyClear:x,$bitsAllSet:x,$bitsAnySet:x,$all:R,$gt:T,$gte:T,$in:R,$lt:T,$lte:T,$ne:T,$nin:R}),P.prototype.castForQuery=function(M,L,W){var G;if(M!=null){if(!(G=this.$conditionalHandlers[M]))throw new Error("Can't use "+M+" with UUID.");return G.call(this,L,W)}try{return this.applySetters(L,W)}catch(re){throw re instanceof b&&re.path===this.path&&this.$fullPath!=null&&(re.path=this.$fullPath),re}},a.exports=P},3207:(a,l,r)=>{var h=r(365).Buffer;function m(ae){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(de){return typeof de}:function(de){return de&&typeof Symbol=="function"&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de},m(ae)}var v=r(4888),g=r(7820),_=r(8702),E=r(3053),b=r(1973),p=r(8828),x=r(8857),y=r(9130),f=r(1490),w=r(8770).schemaTypeSymbol,A=r(6872),P=r(8770).validatorErrorSymbol,T=r(8770).documentIsModified,R=r(8770).populateModelSymbol,M=v.CastError,L=v.ValidatorError,W={_skipMarkModified:!0};function G(ae,de,be){this[w]=!0,this.path=ae,this.instance=be,this.validators=[],this.getters=this.constructor.hasOwnProperty("getters")?this.constructor.getters.slice():[],this.setters=this.constructor.hasOwnProperty("setters")?this.constructor.setters.slice():[],this.splitPath(),de=de||{};for(var pe=this.constructor.defaultOptions||{},U=0,B=Object.keys(pe);U<B.length;U++){var N=B[U];N==="validate"?this.validate(pe.validate):pe.hasOwnProperty(N)&&!Object.prototype.hasOwnProperty.call(de,N)&&(de[N]=pe[N])}de.select==null&&delete de.select;var z=this.OptionsConstructor||g;this.options=new z(de),this._index=null,A.hasUserDefinedProperty(this.options,"immutable")&&(this.$immutable=this.options.immutable,p(this));for(var H=0,Y=Object.keys(this.options);H<Y.length;H++){var fe=Y[H];if(fe!=="cast"){if(A.hasUserDefinedProperty(this.options,fe)&&typeof this[fe]=="function"){if(fe==="index"&&this._index){if(de.index===!1){var Re=this._index;if(m(Re)==="object"&&Re!=null){if(Re.unique)throw new Error('Path "'+this.path+'" may not have `index` set to false and `unique` set to true');if(Re.sparse)throw new Error('Path "'+this.path+'" may not have `index` set to false and `sparse` set to true')}this._index=!1}continue}var Oe=de[fe];if(fe==="default"){this.default(Oe);continue}var De=Array.isArray(Oe)?Oe:[Oe];this[fe].apply(this,De)}}else Array.isArray(this.options[fe])?this.castFunction.apply(this,this.options[fe]):this.castFunction(this.options[fe])}Object.defineProperty(this,"$$context",{enumerable:!1,configurable:!1,writable:!0,value:null})}function re(ae,de){if(ae!==void 0&&!ae){var be=new(de.ErrorConstructor||L)(de);return be[P]=!0,be}}function Q(ae,de){return this.castForQuery(null,ae,de)}function oe(ae,de){var be=this;return Array.isArray(ae)?ae.map(function(pe){return Array.isArray(pe)&&pe.length===0?pe:be.castForQuery(null,pe,de)}):[this.castForQuery(null,ae,de)]}G.prototype.OptionsConstructor=g,G.prototype.path,G.prototype.validators,G.prototype.isRequired,G.prototype.splitPath=function(){return this._presplitPath!=null?this._presplitPath:this.path!=null?(this._presplitPath=this.path.indexOf(".")===-1?[this.path]:this.path.split("."),this._presplitPath):void 0},G.cast=function(ae){return arguments.length===0||(ae===!1&&(ae=function(de){return de}),this._cast=ae),this._cast},G.prototype.castFunction=function(ae,de){return arguments.length===0?this._castFunction:(ae===!1&&(ae=this.constructor._defaultCaster||function(be){return be}),typeof ae=="string"?(this._castErrorMessage=ae,this._castFunction):(ae!=null&&(this._castFunction=ae),de!=null&&(this._castErrorMessage=de),this._castFunction))},G.prototype.cast=function(){throw new Error("Base SchemaType class does not implement a `cast()` function")},G.set=function(ae,de){this.hasOwnProperty("defaultOptions")||(this.defaultOptions=Object.assign({},this.defaultOptions)),this.defaultOptions[ae]=de},G.get=function(ae){this.getters=this.hasOwnProperty("getters")?this.getters:[],this.getters.push(ae)},G.prototype.default=function(ae){if(arguments.length===1){if(ae===void 0)return void(this.defaultValue=void 0);if(ae!=null&&ae.instanceOfSchema)throw new v("Cannot set default value of path `"+this.path+"` to a mongoose Schema instance.");return this.defaultValue=ae,this.defaultValue}return arguments.length>1&&(this.defaultValue=Array.prototype.slice.call(arguments)),this.defaultValue},G.prototype.index=function(ae){return this._index=ae,A.expires(this._index),this},G.prototype.unique=function(ae){if(this._index===!1){if(!ae)return;throw new Error('Path "'+this.path+'" may not have `index` set to false and `unique` set to true')}return this.options.hasOwnProperty("index")||ae!==!1?(this._index==null||this._index===!0?this._index={}:typeof this._index=="string"&&(this._index={type:this._index}),this._index.unique=ae,this):this},G.prototype.text=function(ae){if(this._index===!1){if(!ae)return this;throw new Error('Path "'+this.path+'" may not have `index` set to false and `text` set to true')}return this.options.hasOwnProperty("index")||ae!==!1?(this._index===null||this._index===void 0||typeof this._index=="boolean"?this._index={}:typeof this._index=="string"&&(this._index={type:this._index}),this._index.text=ae,this):this},G.prototype.sparse=function(ae){if(this._index===!1){if(!ae)return this;throw new Error('Path "'+this.path+'" may not have `index` set to false and `sparse` set to true')}return this.options.hasOwnProperty("index")||ae!==!1?(this._index==null||typeof this._index=="boolean"?this._index={}:typeof this._index=="string"&&(this._index={type:this._index}),this._index.sparse=ae,this):this},G.prototype.immutable=function(ae){return this.$immutable=ae,p(this),this},G.prototype.transform=function(ae){return this.options.transform=ae,this},G.prototype.set=function(ae){if(typeof ae!="function")throw new TypeError("A setter must be a function.");return this.setters.push(ae),this},G.prototype.get=function(ae){if(typeof ae!="function")throw new TypeError("A getter must be a function.");return this.getters.push(ae),this},G.prototype.validate=function(ae,de,be){var pe,U,B,N;if(typeof ae=="function"||ae&&A.getFunctionName(ae.constructor)==="RegExp")return typeof de=="function"?(pe={validator:ae,message:de}).type=be||"user defined":de instanceof Object&&!be?((pe=y(de)?Object.assign({},de):b(de)).message||(pe.message=pe.msg),pe.validator=ae,pe.type=pe.type||"user defined"):(de==null&&(de=v.messages.general.default),be||(be="user defined"),pe={message:de,type:be,validator:ae}),this.validators.push(pe),this;for(U=0,B=arguments.length;U<B;U++){if(N=arguments[U],!A.isPOJO(N)){var z="Invalid validator. Received ("+m(N)+") "+N+". See https://mongoosejs.com/docs/api/schematype.html#SchemaType.prototype.validate()";throw new Error(z)}this.validate(N.validator,N)}return this},G.prototype.required=function(ae,de){var be={};if(arguments.length>0&&ae==null)return this.validators=this.validators.filter(function(B){return B.validator!==this.requiredValidator},this),this.isRequired=!1,delete this.originalRequiredValue,this;if(m(ae)==="object"&&(de=(be=ae).message||de,ae=ae.isRequired),ae===!1)return this.validators=this.validators.filter(function(B){return B.validator!==this.requiredValidator},this),this.isRequired=!1,delete this.originalRequiredValue,this;var pe=this;this.isRequired=!0,this.requiredValidator=function(B){var N=this&&this.$__&&this.$__.cachedRequired;if(N!=null&&!this.$__isSelected(pe.path)&&!this[T](pe.path))return!0;if(N!=null&&pe.path in N){var z=!N[pe.path]||pe.checkRequired(B,this);return delete N[pe.path],z}return typeof ae=="function"&&!ae.apply(this)||pe.checkRequired(B,this)},this.originalRequiredValue=ae,typeof ae=="string"&&(de=ae,ae=void 0);var U=de||v.messages.general.required;return this.validators.unshift(Object.assign({},be,{validator:this.requiredValidator,message:U,type:"required"})),this},G.prototype.ref=function(ae){return this.options.ref=ae,this},G.prototype.getDefault=function(ae,de,be){var pe;if((pe=typeof this.defaultValue=="function"?this.defaultValue===Date.now||this.defaultValue===Array||this.defaultValue.name.toLowerCase()==="objectid"?this.defaultValue.call(ae):this.defaultValue.call(ae,ae):this.defaultValue)!=null){if(m(pe)!=="object"||this.options&&this.options.shared||(pe=b(pe)),be&&be.skipCast)return this._applySetters(pe,ae);var U=this.applySetters(pe,ae,de,void 0,W);return U&&!Array.isArray(U)&&U.$isSingleNested&&(U.$__parent=ae),U}return pe},G.prototype._applySetters=function(ae,de,be,pe,U){var B=ae;if(be)return B;for(var N=this.setters,z=N.length-1;z>=0;z--)B=N[z].call(de,B,pe,this,U);return B},G.prototype._castNullish=function(ae){return ae},G.prototype.applySetters=function(ae,de,be,pe,U){var B=this._applySetters(ae,de,be,pe,U);return B==null?this._castNullish(B):B=this.cast(B,de,be,pe,U)},G.prototype.applyGetters=function(ae,de){var be=ae,pe=this.getters,U=pe.length;if(U===0)return be;for(var B=0;B<U;++B)be=pe[B].call(de,be,this);return be},G.prototype.select=function(ae){return this.selected=!!ae,this},G.prototype.doValidate=function(ae,de,be,pe){var U=this,B=!1,N=this.path,z=this.validators.filter(function(De){return m(De)==="object"&&De!==null}),H=z.length;if(!H)return de(null);for(var Y=function(){if(B)return 0;var De,ot=z[fe],X=ot.validator,ee=y(ot)?Object.assign({},ot):b(ot);if(ee.path=pe&&pe.path?pe.path:N,ee.fullPath=U.$fullPath,ee.value=ae,X instanceof RegExp)return Oe(X.test(ae),ee,be),1;if(typeof X!="function")return 1;if(ae===void 0&&X!==U.requiredValidator)return Oe(!0,ee,be),1;try{De=ee.propsParameter?X.call(be,ae,ee):X.call(be,ae)}catch(Le){De=!1,ee.reason=Le,Le.message&&(ee.message=Le.message)}De!=null&&typeof De.then=="function"?De.then(function(Le){Oe(Le,ee,be)},function(Le){ee.reason=Le,ee.message=Le.message,Oe(De=!1,ee,be)}):Oe(De,ee,be)},fe=0,Re=z.length;fe<Re&&Y()!==0;++fe);function Oe(De,ot,X){if(!B)if(De===void 0||De)--H<=0&&f(function(){de(null)});else{var ee=ot.ErrorConstructor||L;(B=new ee(ot,X))[P]=!0,f(function(){de(B)})}}},G.prototype.doValidateSync=function(ae,de,be){var pe=this.path;if(!this.validators.length)return null;var U=this.validators;if(ae===void 0){if(this.validators.length===0||this.validators[0].type!=="required")return null;U=[this.validators[0]]}var B=null,N=0,z=U.length;for(N=0;N<z;++N){var H=U[N];if(H!==null&&m(H)==="object"){var Y=H.validator,fe=y(H)?Object.assign({},H):b(H);fe.path=be&&be.path?be.path:pe,fe.fullPath=this.$fullPath,fe.value=ae;var Re=!1;if(!x(Y)){if(Y instanceof RegExp)B=re(Y.test(ae),fe);else if(typeof Y=="function"){try{Re=fe.propsParameter?Y.call(de,ae,fe):Y.call(de,ae)}catch(Oe){Re=!1,fe.reason=Oe}if((Re==null||typeof Re.then!="function")&&(B=re(Re,fe)))break}}}}return B},G._isRef=function(ae,de,be,pe){var U=pe&&ae.options&&(ae.options.ref||ae.options.refPath);if(!U&&be&&be.$__!=null){var B=be.$__fullPath(ae.path,!0),N=be.ownerDocument();U=B!=null&&N.$populated(B)||be.$populated(ae.path)}return!!U&&(de==null||!(h.isBuffer(de)||de._bsontype==="Binary"||!A.isObject(de))||pe)},G.prototype._castRef=function(ae,de,be){if(ae==null)return ae;if(ae.$__!=null)return ae.$__.wasPopulated=ae.$__.wasPopulated||!0,ae;if(h.isBuffer(ae)||!A.isObject(ae)){if(be)return ae;throw new M(this.instance,ae,this.path,null,this)}var pe=de.$__fullPath(this.path,!0),U=de.ownerDocument().$populated(pe,!0),B=ae;return de.$__.populated&&de.$__.populated[pe]&&de.$__.populated[pe].options&&de.$__.populated[pe].options.options&&de.$__.populated[pe].options.options.lean||((B=new U.options[R](ae)).$__.wasPopulated=!0),B},G.prototype.$conditionalHandlers={$all:function(ae,de){var be=this;return Array.isArray(ae)?ae.map(function(pe){return be.castForQuery(null,pe,de)}):[this.castForQuery(null,ae,de)]},$eq:Q,$in:oe,$ne:Q,$nin:oe,$exists:_,$type:E},G.prototype.castForQuery=function(ae,de,be){var pe;if(ae!=null){if(!(pe=this.$conditionalHandlers[ae]))throw new Error("Can't use "+ae);return pe.call(this,de,be)}try{return this.applySetters(de,be)}catch(U){throw U instanceof M&&U.path===this.path&&this.$fullPath!=null&&(U.path=this.$fullPath),U}},G.checkRequired=function(ae){return arguments.length!==0&&(this._checkRequired=ae),this._checkRequired},G.prototype.checkRequired=function(ae){return ae!=null},G.prototype.clone=function(){var ae=Object.assign({},this.options),de=new this.constructor(this.path,ae,this.instance);return de.validators=this.validators.slice(),this.requiredValidator!==void 0&&(de.requiredValidator=this.requiredValidator),this.defaultValue!==void 0&&(de.defaultValue=this.defaultValue),this.$immutable!==void 0&&this.options.immutable===void 0&&(de.$immutable=this.$immutable,p(de)),this._index!==void 0&&(de._index=this._index),this.selected!==void 0&&(de.selected=this.selected),this.isRequired!==void 0&&(de.isRequired=this.isRequired),this.originalRequiredValue!==void 0&&(de.originalRequiredValue=this.originalRequiredValue),de.getters=this.getters.slice(),de.setters=this.setters.slice(),de},a.exports=l=G,l.CastError=M,l.ValidatorError=L},8970:(a,l,r)=>{r(6872);var h=a.exports=function(){};h.ctor=function(){var m=Array.prototype.slice.call(arguments),v=function(){h.apply(this,arguments),this.paths={},this.states={}};return(v.prototype=new h).stateNames=m,m.forEach(function(g){v.prototype[g]=function(_){this._changeState(_,g)}}),v},h.prototype._changeState=function(m,v){var g=this.paths[m];if(g!==v){var _=this.states[g];_&&delete _[m],this.paths[m]=v,this.states[v]=this.states[v]||{},this.states[v][m]=!0}},h.prototype.clear=function(m){if(this.states[m]!=null)for(var v,g=Object.keys(this.states[m]),_=g.length;_--;)v=g[_],delete this.states[m][v],delete this.paths[v]},h.prototype.clearPath=function(m){var v=this.paths[m];v&&(delete this.paths[m],delete this.states[v][m])},h.prototype.getStatePaths=function(m){return this.states[m]!=null?this.states[m]:{}},h.prototype.some=function(){var m=this,v=arguments.length?arguments:this.stateNames;return Array.prototype.some.call(v,function(g){return m.states[g]!=null&&Object.keys(m.states[g]).length})},h.prototype._iter=function(m){return function(){var v=Array.prototype.slice.call(arguments),g=v.pop();v.length||(v=this.stateNames);var _=this;return v.reduce(function(E,b){return _.states[b]==null?E:E.concat(Object.keys(_.states[b]))},[])[m](function(E,b,p){return g(E,b,p)})}},h.prototype.forEach=function(){return this.forEach=this._iter("forEach"),this.forEach.apply(this,arguments)},h.prototype.map=function(){return this.map=this._iter("map"),this.map.apply(this,arguments)}},8268:(a,l,r)=>{function h(w){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},h(w)}function m(w,A,P){var T;return T=function(R,M){if(h(R)!="object"||!R)return R;var L=R[Symbol.toPrimitive];if(L!==void 0){var W=L.call(R,"string");if(h(W)!="object")return W;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(R)}(A),(A=h(T)=="symbol"?T:String(T))in w?Object.defineProperty(w,A,{value:P,enumerable:!0,configurable:!0,writable:!0}):w[A]=P,w}var v=r(8727),g=r(8075),_=r(8770).arrayAtomicsSymbol,E=r(8770).arrayAtomicsBackupSymbol,b=r(8770).arrayParentSymbol,p=r(8770).arrayPathSymbol,x=r(8770).arraySchemaSymbol,y=Array.prototype.push,f=/^\d+$/;a.exports=function(w,A,P,T){var R;if(Array.isArray(w)){var M=w.length;if(M===0)R=new Array;else if(M===1)(R=new Array(1))[0]=w[0];else if(M<1e4)R=new Array,y.apply(R,w);else{R=new Array;for(var L=0;L<M;++L)y.call(R,w[L])}}else R=[];var W=m(m(m(m(m(m(m(m({},_,{}),E,void 0),p,A),x,T),b,void 0),"isMongooseArray",!0),"isMongooseArrayProxy",!0),"__array",R);w&&w[_]!=null&&(W[_]=w[_]),P!=null&&P instanceof v&&(W[b]=P,W[x]=T||P.schema.path(A));var G=new Proxy(R,{get:function(re,Q){return W.hasOwnProperty(Q)?W[Q]:g.hasOwnProperty(Q)?g[Q]:typeof Q=="string"&&f.test(Q)&&(T==null?void 0:T.$embeddedSchemaType)!=null?T.$embeddedSchemaType.applyGetters(R[Q],P):R[Q]},set:function(re,Q,oe){return typeof Q=="string"&&f.test(Q)?g.set.call(G,Q,oe,!1):W.hasOwnProperty(Q)?W[Q]=oe:R[Q]=oe,!0}});return G}},7339:(a,l)=>{l.isMongooseArray=function(r){return Array.isArray(r)&&r.isMongooseArray}},8075:(a,l,r)=>{var h=r(365).Buffer;function m(U){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},m(U)}function v(U,B){var N=typeof Symbol<"u"&&U[Symbol.iterator]||U["@@iterator"];if(!N){if(Array.isArray(U)||(N=g(U))||B&&U&&typeof U.length=="number"){N&&(U=N);var z=0,H=function(){};return{s:H,n:function(){return z>=U.length?{done:!0}:{done:!1,value:U[z++]}},e:function(Oe){throw Oe},f:H}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Y,fe=!0,Re=!1;return{s:function(){N=N.call(U)},n:function(){var Oe=N.next();return fe=Oe.done,Oe},e:function(Oe){Re=!0,Y=Oe},f:function(){try{fe||N.return==null||N.return()}finally{if(Re)throw Y}}}}function g(U,B){if(U){if(typeof U=="string")return _(U,B);var N=Object.prototype.toString.call(U).slice(8,-1);return N==="Object"&&U.constructor&&(N=U.constructor.name),N==="Map"||N==="Set"?Array.from(U):N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N)?_(U,B):void 0}}function _(U,B){(B==null||B>U.length)&&(B=U.length);for(var N=0,z=new Array(B);N<B;N++)z[N]=U[N];return z}var E=r(8727),b=r(7734),p=r(5202),x=r(4134),y=r(1973),f=r(4962).h,w=r(3564),A=r(6872),P=r(1563),T=r(8770).arrayAtomicsSymbol,R=r(8770).arrayParentSymbol,M=r(8770).arrayPathSymbol,L=r(8770).arraySchemaSymbol,W=r(8770).populateModelSymbol,G=Symbol("mongoose#Array#sliced"),re=Array.prototype.push,Q={$__getAtomics:function(){var U=[],B=Object.keys(this[T]||{}),N=B.length,z=Object.assign({},f,{_isNested:!0});if(N===0)return U[0]=["$set",this.toObject(z)],U;for(;N--;){var H=B[N],Y=this[T][H];A.isMongooseObject(Y)?Y=Y.toObject(z):Array.isArray(Y)?Y=this.toObject.call(Y,z):Y!=null&&Array.isArray(Y.$each)?Y.$each=this.toObject.call(Y.$each,z):Y!=null&&typeof Y.valueOf=="function"&&(Y=Y.valueOf()),H==="$addToSet"&&(Y={$each:Y}),U.push([H,Y])}return U},$atomics:function(){return this[T]},$parent:function(){return this[R]},$path:function(){return this[M]},$shift:function(){this._registerAtomic("$pop",-1),this._markModified();var U=this.__array;if(!U._shifted)return U._shifted=!0,[].shift.call(U)},$pop:function(){if(this._registerAtomic("$pop",1),this._markModified(),!this._popped)return this._popped=!0,[].pop.call(this)},$schema:function(){return this[L]},_cast:function(U){var B,N=!1,z=this[R];if(z&&(N=z.$populated(this[M],!0)),N&&U!=null){if((B=N.options[W])==null)throw new p("No populated model found for path `"+this[M]+"`. This is likely a bug in Mongoose, please report an issue on github.com/Automattic/mongoose.");return(h.isBuffer(U)||P(U,"ObjectId")||!A.isObject(U))&&(U={_id:U}),U.schema&&U.schema.discriminatorMapping&&U.schema.discriminatorMapping.key!==void 0||(U=new B(U)),this[L].caster.applySetters(U,z,!0)}return this[L].caster.applySetters(U,z,!1)},_mapCast:function(U,B){return this._cast(U,this.length+B)},_markModified:function(U){var B,N=this[R];if(N){if(B=this[M],arguments.length&&(B=B+"."+U),B!=null&&B.endsWith(".$"))return this;N.markModified(B,arguments.length!==0?U:N)}return this},_registerAtomic:function(U,B){if(!this[G]){if(U==="$set")return this[T]={$set:B},x(this[R],this[M]),this._markModified(),this;var N,z=this[T];if(U==="$pop"&&!("$pop"in z)){var H=this;this[R].once("save",function(){H._popped=H._shifted=null})}if(z.$set||Object.keys(z).length&&!(U in z))return this[T]={$set:this},this;if(U==="$pullAll"||U==="$addToSet")z[U]||(z[U]=[]),z[U]=z[U].concat(B);else if(U==="$pullDocs"){var Y=z.$pull||(z.$pull={});B[0]instanceof b?(N=Y.$or||(Y.$or=[]),Array.prototype.push.apply(N,B.map(function(X){return X.toObject({transform:function(ee,Le){return X==null||X.$__==null||Object.keys(X.$__.activePaths.getStatePaths("default")).forEach(function(Be){w.unset(Be,Le),oe(Le,Be)}),Le},virtuals:!1})}))):(N=Y._id||(Y._id={$in:[]})).$in=N.$in.concat(B)}else if(U==="$push")if(z.$push=z.$push||{$each:[]},B!=null&&A.hasUserDefinedProperty(B,"$each"))z.$push=B;else if(B.length===1)z.$push.$each.push(B[0]);else if(B.length<1e4){var fe;(fe=z.$push.$each).push.apply(fe,function(X){if(Array.isArray(X))return _(X)}(ot=B)||function(X){if(typeof Symbol<"u"&&X[Symbol.iterator]!=null||X["@@iterator"]!=null)return Array.from(X)}(ot)||g(ot)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())}else{var Re,Oe=v(B);try{for(Oe.s();!(Re=Oe.n()).done;){var De=Re.value;z.$push.$each.push(De)}}catch(X){Oe.e(X)}finally{Oe.f()}}else z[U]=B;return this}var ot},addToSet:function(){ae(this,arguments);var U=[].map.call(arguments,this._mapCast,this),B=[],N="";U[0]instanceof b?N="doc":U[0]instanceof Date?N="date":P(U[0],"ObjectId")&&(N="ObjectId");var z=A.isMongooseArray(U)?U.__array:U,H=A.isMongooseArray(this)?this.__array:this;return z.forEach(function(Y){var fe,Re=+Y;switch(N){case"doc":fe=this.some(function(Oe){return Oe.equals(Y)});break;case"date":fe=this.some(function(Oe){return+Oe===Re});break;case"ObjectId":fe=this.find(function(Oe){return Oe.toString()===Y.toString()});break;default:fe=~this.indexOf(Y)}fe||(this._markModified(),H.push(Y),this._registerAtomic("$addToSet",Y),[].push.call(B,Y))},this),B},hasAtomics:function(){return A.isPOJO(this[T])?Object.keys(this[T]).length:0},includes:function(U,B){return this.indexOf(U,B)!==-1},indexOf:function(U,B){P(U,"ObjectId")&&(U=U.toString()),B=B??0;for(var N=this.length,z=B;z<N;++z)if(U==this[z])return z;return-1},inspect:function(){return JSON.stringify(this)},nonAtomicPush:function(){var U=[].map.call(arguments,this._mapCast,this);this._markModified();var B=[].push.apply(this,U);return this._registerAtomic("$set",this),B},pop:function(){this._markModified();var U=[].pop.call(this);return this._registerAtomic("$set",this),U},pull:function(){var U,B=this,N=[].map.call(arguments,function(Y,fe){return B._cast(Y,fe,{defaults:!1})},this),z=this[R].get(this[M]),H=z.length;for(this._markModified();H--;)(U=z[H])instanceof E?N.some(function(Y){return U.equals(Y)})&&[].splice.call(z,H,1):~z.indexOf.call(N,U)&&[].splice.call(z,H,1);return N[0]instanceof b?this._registerAtomic("$pullDocs",N.map(function(Y){var fe=Y.$__getValue("_id");return fe===void 0||Y.$isDefault("_id")?Y:fe})):this._registerAtomic("$pullAll",N),x(this[R],this[M])>0&&this._registerAtomic("$set",this),this},push:function(){var U,B=arguments,N=B,z=B[0]!=null&&A.hasUserDefinedProperty(B[0],"$each"),H=A.isMongooseArray(this)?this.__array:this;if(z&&(N=B[0],B=B[0].$each),this[L]==null)return re.apply(this,B);ae(this,B),B=[].map.call(B,this._mapCast,this);var Y=this[T];if(this._markModified(),z){if(N.$each=B,(Y.$push&&Y.$push.$each&&Y.$push.$each.length||0)!==0&&Y.$push.$position!=N.$position)throw new p("Cannot call `Array#push()` multiple times with different `$position`");N.$position!=null?([].splice.apply(H,[N.$position,0].concat(B)),U=this.length):U=[].push.apply(H,B)}else{if((Y.$push&&Y.$push.$each&&Y.$push.$each.length||0)!==0&&Y.$push.$position!=null)throw new p("Cannot call `Array#push()` multiple times with different `$position`");N=B,U=re.apply(H,B)}return this._registerAtomic("$push",N),U},remove:function(){return this.pull.apply(this,arguments)},set:function(U,B,N){var z=this.__array;if(N)return z[U]=B,this;var H=Q._cast.call(this,B,U);return Q._markModified.call(this,U),z[U]=H,this},shift:function(){var U=A.isMongooseArray(this)?this.__array:this;this._markModified();var B=[].shift.call(U);return this._registerAtomic("$set",this),B},sort:function(){var U=A.isMongooseArray(this)?this.__array:this,B=[].sort.apply(U,arguments);return this._registerAtomic("$set",this),B},splice:function(){var U,B=A.isMongooseArray(this)?this.__array:this;if(this._markModified(),ae(this,Array.prototype.slice.call(arguments,2)),arguments.length){var N;if(this[L]==null)N=arguments;else{N=[];for(var z=0;z<arguments.length;++z)N[z]=z<2?arguments[z]:this._cast(arguments[z],arguments[0]+(z-2))}U=[].splice.apply(B,N),this._registerAtomic("$set",this)}return U},toBSON:function(){return this.toObject(f)},toObject:function(U){var B=A.isMongooseArray(this)?this.__array:this;return U&&U.depopulate?((U=y(U))._isNested=!0,[].concat(B).map(function(N){return N instanceof E?N.toObject(U):N})):[].concat(B)},$toObject:function(){return this.constructor.prototype.toObject.apply(this,arguments)},unshift:function(){var U;ae(this,arguments),U=this[L]==null?arguments:[].map.call(arguments,this._cast,this);var B=A.isMongooseArray(this)?this.__array:this;return this._markModified(),[].unshift.apply(B,U),this._registerAtomic("$set",this),this.length}};function oe(U,B,N){if(typeof B=="string"){if(B.indexOf(".")===-1)return;B=w.stringToParts(B)}(N=N||0)>=B.length||U!=null&&m(U)==="object"&&(oe(U[B[0]],B,N+1),U[B[0]]!=null&&m(U[B[0]])==="object"&&Object.keys(U[B[0]]).length===0&&delete U[B[0]])}function ae(U,B){var N,z,H,Y,fe=U==null?null:U[L]&&U[L].caster&&U[L].caster.options&&U[L].caster.options.ref||null;U.length===0&&B.length!==0&&function(Re,Oe){if(!Oe)return!1;var De,ot=v(Re);try{for(ot.s();!(De=ot.n()).done;){var X=De.value;if(X==null)return!1;var ee=X.constructor;if(!(X instanceof E)||ee.modelName!==Oe&&ee.baseModelName!==Oe)return!1}}catch(Le){ot.e(Le)}finally{ot.f()}return!0}(B,fe)&&U[R].$populated(U[M],[],(N={},z=W,H=B[0].constructor,Y=function(Re,Oe){if(m(Re)!="object"||!Re)return Re;var De=Re[Symbol.toPrimitive];if(De!==void 0){var ot=De.call(Re,"string");if(m(ot)!="object")return ot;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Re)}(z),(z=m(Y)=="symbol"?Y:String(Y))in N?Object.defineProperty(N,z,{value:H,enumerable:!0,configurable:!0,writable:!0}):N[z]=H,N))}for(var de=function(){var U=pe[be];if(Array.prototype[U]==null)return 1;Q[U]=function(){var B=A.isMongooseArray(this)?this.__array:this,N=[].concat(B);return N[U].apply(N,arguments)}},be=0,pe=["filter","flat","flatMap","map","slice"];be<pe.length;be++)de();a.exports=Q},7734:(a,l,r)=>{function h(y,f){var w=Object.keys(y);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(y);f&&(A=A.filter(function(P){return Object.getOwnPropertyDescriptor(y,P).enumerable})),w.push.apply(w,A)}return w}function m(y,f,w){return f=function(A){var P=function(T,R){if(v(T)!="object"||!T)return T;var M=T[Symbol.toPrimitive];if(M!==void 0){var L=M.call(T,"string");if(v(L)!="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(T)}(A);return v(P)=="symbol"?P:String(P)}(f),f in y?Object.defineProperty(y,f,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[f]=w,y}function v(y){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},v(y)}var g=r(9620).EventEmitter,_=r(2591),E=r(6872),b=r(8770).documentArrayParent;function p(y,f,w,A,P){var T;E.isMongooseDocumentArray(f)?(this.__parentArray=f,this[b]=f.$parent()):(this.__parentArray=void 0,this[b]=void 0),this.$setIndex(P),this.$__parent=this[b],v(w)==="object"&&w!=null?(T=function(R){for(var M=1;M<arguments.length;M++){var L=arguments[M]!=null?arguments[M]:{};M%2?h(Object(L),!0).forEach(function(W){m(R,W,L[W])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(L)):h(Object(L)).forEach(function(W){Object.defineProperty(R,W,Object.getOwnPropertyDescriptor(L,W))})}return R}({isNew:!0},w),w=void 0):T={isNew:!0},_.call(this,y,A,this[b],w,T)}for(var x in p.prototype=Object.create(_.prototype),p.prototype.constructor=p,Object.defineProperty(p.prototype,"$isSingleNested",{configurable:!1,writable:!1,value:!1}),Object.defineProperty(p.prototype,"$isDocumentArrayElement",{configurable:!1,writable:!1,value:!0}),g.prototype)p[x]=g.prototype[x];p.prototype.$setIndex=function(y){if(this.__index=y,this.$__!=null&&this.$__.validationError!=null)for(var f=0,w=Object.keys(this.$__.validationError.errors);f<w.length;f++){var A=w[f];this.invalidate(A,this.$__.validationError.errors[A])}},p.prototype.populate=function(){throw new Error('Mongoose does not support calling populate() on nested docs. Instead of `doc.arr[0].populate("path")`, use `doc.populate("arr.0.path")`')},p.prototype.$__removeFromParent=function(){var y=this._doc._id;if(!y)throw new Error("For your own good, Mongoose does not know how to remove an ArraySubdocument that has no _id");this.__parentArray.pull({_id:y})},p.prototype.$__fullPath=function(y,f){return this.__index==null?null:(this.$__.fullPath||this.ownerDocument(),f?y?this.$__.fullPath+"."+y:this.$__.fullPath:y?this.$__.fullPath+"."+this.__index+"."+y:this.$__.fullPath+"."+this.__index)},p.prototype.$__pathRelativeToParent=function(y,f){return this.__index==null?null:f?y==null?this.__parentArray.$path():this.__parentArray.$path()+"."+y:y==null?this.__parentArray.$path()+"."+this.__index:this.__parentArray.$path()+"."+this.__index+"."+y},p.prototype.$parent=function(){return this[b]},p.prototype.parentArray=function(){return this.__parentArray},a.exports=p},4051:(a,l,r)=>{var h=r(365).Buffer,m=r(4029).Binary,v=r(6872);function g(b,p,x){var y,f,w,A,P=b;return b==null&&(P=0),Array.isArray(p)?(f=p[0],w=p[1]):y=p,A=typeof P=="number"||P instanceof Number?h.alloc(P):h.from(P,y,x),v.decorate(A,g.mixin),A.isMongooseBuffer=!0,A[g.pathSymbol]=f,A[E]=w,A._subtype=0,A}var _=Symbol.for("mongoose#Buffer#_path"),E=Symbol.for("mongoose#Buffer#_parent");g.pathSymbol=_,g.mixin={_subtype:void 0,_markModified:function(){var b=this[E];return b&&b.markModified(this[g.pathSymbol]),this},write:function(){var b=h.prototype.write.apply(this,arguments);return b>0&&this._markModified(),b},copy:function(b){var p=h.prototype.copy.apply(this,arguments);return b&&b.isMongooseBuffer&&b._markModified(),p}},v.each(["writeUInt8","writeUInt16","writeUInt32","writeInt8","writeInt16","writeInt32","writeFloat","writeDouble","fill","utf8Write","binaryWrite","asciiWrite","set","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE"],function(b){h.prototype[b]&&(g.mixin[b]=function(){var p=h.prototype[b].apply(this,arguments);return this._markModified(),p})}),g.mixin.toObject=function(b){var p=typeof b=="number"?b:this._subtype||0;return new m(h.from(this),p)},g.mixin.$toObject=g.mixin.toObject,g.mixin.toBSON=function(){return new m(this,this._subtype||0)},g.mixin.equals=function(b){if(!h.isBuffer(b)||this.length!==b.length)return!1;for(var p=0;p<this.length;++p)if(this[p]!==b[p])return!1;return!0},g.mixin.subtype=function(b){if(typeof b!="number")throw new TypeError("Invalid subtype. Expected a number");this._subtype!==b&&this._markModified(),this._subtype=b},g.Binary=m,a.exports=g},5003:(a,l,r)=>{a.exports=r(4029).Decimal128},5357:(a,l,r)=>{function h(A){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},h(A)}function m(A,P,T){var R;return R=function(M,L){if(h(M)!="object"||!M)return M;var W=M[Symbol.toPrimitive];if(W!==void 0){var G=W.call(M,"string");if(h(G)!="object")return G;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(M)}(P),(P=h(R)=="symbol"?R:String(R))in A?Object.defineProperty(A,P,{value:T,enumerable:!0,configurable:!0,writable:!0}):A[P]=T,A}var v=r(8075),g=r(7532),_=r(8727),E=r(8770).arrayAtomicsSymbol,b=r(8770).arrayAtomicsBackupSymbol,p=r(8770).arrayParentSymbol,x=r(8770).arrayPathSymbol,y=r(8770).arraySchemaSymbol,f=Array.prototype.push,w=/^\d+$/;a.exports=function(A,P,T){var R=[],M=m(m(m(m(m({},E,{}),b,void 0),x,P),y,void 0),p,void 0);if(Array.isArray(A)&&(A[x]===P&&A[p]===T&&(M[E]=Object.assign({},A[E])),A.forEach(function(W){f.call(R,W)})),M[x]=P,M.__array=R,T&&T instanceof _)for(M[p]=T,M[y]=T.$__schema.path(P);M[y]!=null&&M[y].$isMongooseArray&&!M[y].$isMongooseDocumentArray;)M[y]=M[y].casterConstructor;var L=new Proxy(R,{get:function(W,G){return G==="isMongooseArray"||G==="isMongooseArrayProxy"||G==="isMongooseDocumentArray"||G==="isMongooseDocumentArrayProxy"||(M.hasOwnProperty(G)?M[G]:g.hasOwnProperty(G)?g[G]:v.hasOwnProperty(G)?v[G]:R[G])},set:function(W,G,re){return typeof G=="string"&&w.test(G)?g.set.call(L,G,re,!1):M.hasOwnProperty(G)?M[G]=re:R[G]=re,!0}});return L}},2991:(a,l)=>{l.isMongooseDocumentArray=function(r){return Array.isArray(r)&&r.isMongooseDocumentArray}},7532:(a,l,r)=>{var h=r(365).Buffer;function m(M,L){var W=typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(!W){if(Array.isArray(M)||(W=function(de,be){if(de){if(typeof de=="string")return v(de,be);var pe=Object.prototype.toString.call(de).slice(8,-1);return pe==="Object"&&de.constructor&&(pe=de.constructor.name),pe==="Map"||pe==="Set"?Array.from(de):pe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(pe)?v(de,be):void 0}}(M))||L&&M&&typeof M.length=="number"){W&&(M=W);var G=0,re=function(){};return{s:re,n:function(){return G>=M.length?{done:!0}:{done:!1,value:M[G++]}},e:function(de){throw de},f:re}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Q,oe=!0,ae=!1;return{s:function(){W=W.call(M)},n:function(){var de=W.next();return oe=de.done,de},e:function(de){ae=!0,Q=de},f:function(){try{oe||W.return==null||W.return()}finally{if(ae)throw Q}}}}function v(M,L){(L==null||L>M.length)&&(L=M.length);for(var W=0,G=new Array(L);W<L;W++)G[W]=M[W];return G}var g=r(8075),_=r(8727),E=r(4731),b=r(7291),p=r(4962).h,x=r(6872),y=r(1563),f=r(8770).arrayParentSymbol,w=r(8770).arrayPathSymbol,A=r(8770).arraySchemaSymbol,P=r(8770).documentArrayParent,T={toBSON:function(){return this.toObject(p)},getArrayParent:function(){return this[f]},_cast:function(M,L,W){if(this[A]==null)return M;var G=this[A].casterConstructor;if((G.$isMongooseDocumentArray?x.isMongooseDocumentArray(M):M instanceof G)||M&&M.constructor&&M.constructor.baseCasterConstructor===G)return M[P]&&M.__parentArray||(M[P]=this[f],M.__parentArray=this),M.$setIndex(L),M;if(M==null)return null;if((h.isBuffer(M)||y(M,"ObjectId")||!x.isObject(M))&&(M={_id:M}),M&&G.discriminators&&G.schema&&G.schema.options&&G.schema.options.discriminatorKey)if(typeof M[G.schema.options.discriminatorKey]=="string"&&G.discriminators[M[G.schema.options.discriminatorKey]])G=G.discriminators[M[G.schema.options.discriminatorKey]];else{var re=b(G.discriminators,M[G.schema.options.discriminatorKey]);re&&(G=re)}if(G.$isMongooseDocumentArray)return G.cast(M,this,void 0,void 0,L);var Q=new G(M,this,W,void 0,L);return Q.isNew=!0,Q},id:function(M){var L,W,G;try{L=E(M).toString()}catch{L=null}var re,Q=m(this);try{for(Q.s();!(re=Q.n()).done;){var oe=re.value;if(oe&&(G=oe.get("_id"))!=null){if(G instanceof _){if(W||(W=String(M)),W==G._id)return oe}else if(y(M,"ObjectId")||y(G,"ObjectId")){if(L==G)return oe}else if(M==G||x.deepEqual(M,G))return oe}}}catch(ae){Q.e(ae)}finally{Q.f()}return null},toObject:function(M){return[].concat(this.map(function(L){return L==null?null:typeof L.toObject!="function"?L:L.toObject(M)}))},$toObject:function(){return this.constructor.prototype.toObject.apply(this,arguments)},push:function(){var M=g.push.apply(this,arguments);return R(this),M},pull:function(){var M=g.pull.apply(this,arguments);return R(this),M},shift:function(){var M=g.shift.apply(this,arguments);return R(this),M},splice:function(){var M=g.splice.apply(this,arguments);return R(this),M},inspect:function(){return this.toObject()},create:function(M){var L=this[A].casterConstructor;if(M&&L.discriminators&&L.schema&&L.schema.options&&L.schema.options.discriminatorKey)if(typeof M[L.schema.options.discriminatorKey]=="string"&&L.discriminators[M[L.schema.options.discriminatorKey]])L=L.discriminators[M[L.schema.options.discriminatorKey]];else{var W=b(L.discriminators,M[L.schema.options.discriminatorKey]);W&&(L=W)}return new L(M,this)},notify:function(M){var L=this;return function W(G,re){for(var Q=(re=re||L).length;Q--;)re[Q]!=null&&(M==="save"&&(G=L[Q]),x.isMongooseArray(re[Q])?W(G,re[Q]):re[Q]&&re[Q].emit(M,G))}},set:function(M,L,W){var G=this.__array;if(W)return G[M]=L,this;var re=T._cast.call(this,L,M);return T._markModified.call(this,M),G[M]=re,this},_markModified:function(M,L){var W,G=this[f];if(G){if(W=this[w],arguments.length&&(W=L!=null?W+"."+M.__index+"."+L:W+"."+M),W!=null&&W.endsWith(".$"))return this;G.markModified(W,arguments.length!==0?M:G)}return this}};function R(M){var L=M[f];if(L&&L.$__.populated!=null){var W,G=m(Object.keys(L.$__.populated).filter(function(Q){return Q.startsWith(M[w]+".")}));try{var re=function(){var Q=W.value,oe=Q.slice((M[w]+".").length);if(!Array.isArray(L.$__.populated[Q].value))return 1;L.$__.populated[Q].value=M.map(function(ae){return ae.$populated(oe)})};for(G.s();!(W=G.n()).done;)re()}catch(Q){G.e(Q)}finally{G.f()}}}a.exports=T},8941:(a,l,r)=>{l.Array=r(8268),l.Buffer=r(4051),l.Document=l.Embedded=r(7734),l.DocumentArray=r(5357),l.Decimal128=r(5003),l.ObjectId=r(6079),l.Map=r(3828),l.Subdocument=r(2591),l.UUID=r(8369)},3828:(a,l,r)=>{function h(oe){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},h(oe)}function m(oe,ae){var de=typeof Symbol<"u"&&oe[Symbol.iterator]||oe["@@iterator"];if(!de){if(Array.isArray(oe)||(de=function(z,H){if(z){if(typeof z=="string")return v(z,H);var Y=Object.prototype.toString.call(z).slice(8,-1);return Y==="Object"&&z.constructor&&(Y=z.constructor.name),Y==="Map"||Y==="Set"?Array.from(z):Y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Y)?v(z,H):void 0}}(oe))||ae&&oe&&typeof oe.length=="number"){de&&(oe=de);var be=0,pe=function(){};return{s:pe,n:function(){return be>=oe.length?{done:!0}:{done:!1,value:oe[be++]}},e:function(z){throw z},f:pe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var U,B=!0,N=!1;return{s:function(){de=de.call(oe)},n:function(){var z=de.next();return B=z.done,z},e:function(z){N=!0,U=z},f:function(){try{B||de.return==null||de.return()}finally{if(N)throw U}}}}function v(oe,ae){(ae==null||ae>oe.length)&&(ae=oe.length);for(var de=0,be=new Array(ae);de<ae;de++)be[de]=oe[de];return be}function g(oe,ae){for(var de=0;de<ae.length;de++){var be=ae[de];be.enumerable=be.enumerable||!1,be.configurable=!0,"value"in be&&(be.writable=!0),Object.defineProperty(oe,_(be.key),be)}}function _(oe){var ae=function(de,be){if(h(de)!="object"||!de)return de;var pe=de[Symbol.toPrimitive];if(pe!==void 0){var U=pe.call(de,"string");if(h(U)!="object")return U;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(de)}(oe);return h(ae)=="symbol"?ae:String(ae)}function E(){return E=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(oe,ae,de){var be=function(U,B){for(;!Object.prototype.hasOwnProperty.call(U,B)&&(U=y(U))!==null;);return U}(oe,ae);if(be){var pe=Object.getOwnPropertyDescriptor(be,ae);return pe.get?pe.get.call(arguments.length<3?oe:de):pe.value}},E.apply(this,arguments)}function b(oe){var ae=typeof Map=="function"?new Map:void 0;return b=function(de){if(de===null||!function(pe){try{return Function.toString.call(pe).indexOf("[native code]")!==-1}catch{return typeof pe=="function"}}(de))return de;if(typeof de!="function")throw new TypeError("Super expression must either be null or a function");if(ae!==void 0){if(ae.has(de))return ae.get(de);ae.set(de,be)}function be(){return function(pe,U,B){if(p())return Reflect.construct.apply(null,arguments);var N=[null];N.push.apply(N,U);var z=new(pe.bind.apply(pe,N));return B&&x(z,B.prototype),z}(de,arguments,y(this).constructor)}return be.prototype=Object.create(de.prototype,{constructor:{value:be,enumerable:!1,writable:!0,configurable:!0}}),x(be,de)},b(oe)}function p(){try{var oe=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p=function(){return!!oe})()}function x(oe,ae){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(de,be){return de.__proto__=be,de},x(oe,ae)}function y(oe){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ae){return ae.__proto__||Object.getPrototypeOf(ae)},y(oe)}var f=r(3861),w=r(5202),A=r(1973),P=r(6872).deepEqual,T=r(1981),R=r(719),M=r(8751),L=r(2862),W=r(1563),G=r(8770).populateModelSymbol,re=function(oe){function ae(pe,U,B,N){var z,H,Y,fe;return function(Re,Oe){if(!(Re instanceof Oe))throw new TypeError("Cannot call a class as a function")}(this,ae),T(pe)==="Object"&&(pe=Object.keys(pe).reduce(function(Re,Oe){return Re.concat([[Oe,pe[Oe]]])},[])),(H=this,Y=ae,fe=[pe],Y=y(Y),z=function(Re,Oe){if(Oe&&(h(Oe)==="object"||typeof Oe=="function"))return Oe;if(Oe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(De){if(De===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return De}(Re)}(H,p()?Reflect.construct(Y,fe||[],y(H).constructor):Y.apply(H,fe))).$__parent=B!=null&&B.$__!=null?B:null,z.$__path=U,z.$__schemaType=N??new f(U),z.$__runDeferred(),z}var de,be;return function(pe,U){if(typeof U!="function"&&U!==null)throw new TypeError("Super expression must either be null or a function");pe.prototype=Object.create(U&&U.prototype,{constructor:{value:pe,writable:!0,configurable:!0}}),Object.defineProperty(pe,"prototype",{writable:!1}),U&&x(pe,U)}(ae,oe),de=ae,be=[{key:"$init",value:function(pe,U){Q(pe),E(y(ae.prototype),"set",this).call(this,pe,U),U!=null&&U.$isSingleNested&&(U.$basePath=this.$__path+"."+pe)}},{key:"$__set",value:function(pe,U){E(y(ae.prototype),"set",this).call(this,pe,U)}},{key:"get",value:function(pe,U){return W(pe,"ObjectId")&&(pe=pe.toString()),(U=U||{}).getters===!1?E(y(ae.prototype),"get",this).call(this,pe):this.$__schemaType.applyGetters(E(y(ae.prototype),"get",this).call(this,pe),this.$__parent)}},{key:"set",value:function(pe,U){if(W(pe,"ObjectId")&&(pe=pe.toString()),Q(pe),U=R(U),this.$__schemaType==null)return this.$__deferred=this.$__deferred||[],void this.$__deferred.push({key:pe,value:U});var B,N=this.$__parent,z=N!=null&&N.$__&&N.$__.populated?N.$populated(fe.call(this),!0)||N.$populated(this.$__path,!0):null,H=this.get(pe);if(z!=null){if(this.$__schemaType.$isSingleNested)throw new w("Cannot manually populate single nested subdoc underneath Map "+'at path "'.concat(this.$__path,'". Try using an array instead of a Map.'));Array.isArray(U)&&this.$__schemaType.$isMongooseArray?U=U.map(function(Re){return Re.$__==null&&(Re=new z.options[G](Re)),Re.$__.wasPopulated={value:Re._id},Re}):(U.$__==null&&(U=new z.options[G](U)),U.$__.wasPopulated={value:U._id})}else try{var Y=this.$__schemaType.$isMongooseDocumentArray||this.$__schemaType.$isSingleNested?{path:fe.call(this)}:null;U=this.$__schemaType.applySetters(U,this.$__parent,!1,this.get(pe),Y)}catch(Re){if(this.$__parent!=null&&this.$__parent.$__!=null)return void this.$__parent.invalidate(fe.call(this),Re);throw Re}function fe(){return B||(B=this.$__path+"."+pe)}E(y(ae.prototype),"set",this).call(this,pe,U),N==null||N.$__==null||P(U,H)||N.markModified(fe.call(this))}},{key:"clear",value:function(){E(y(ae.prototype),"clear",this).call(this);var pe=this.$__parent;pe!=null&&pe.markModified(this.$__path)}},{key:"delete",value:function(pe){return W(pe,"ObjectId")&&(pe=pe.toString()),this.set(pe,void 0),E(y(ae.prototype),"delete",this).call(this,pe)}},{key:"toBSON",value:function(){return new Map(this)}},{key:"toObject",value:function(pe){if(pe&&pe.flattenMaps){var U,B={},N=m(this.keys());try{for(N.s();!(U=N.n()).done;){var z=U.value;B[z]=A(this.get(z),pe)}}catch(H){N.e(H)}finally{N.f()}return B}return new Map(this)}},{key:"$toObject",value:function(){return this.constructor.prototype.toObject.apply(this,arguments)}},{key:"toJSON",value:function(pe){if(typeof(pe&&pe.flattenMaps)!="boolean"||pe.flattenMaps){var U,B={},N=m(this.keys());try{for(N.s();!(U=N.n()).done;){var z=U.value;B[z]=A(this.get(z),pe)}}catch(H){N.e(H)}finally{N.f()}return B}return new Map(this)}},{key:"inspect",value:function(){return new Map(this)}},{key:"$__runDeferred",value:function(){if(this.$__deferred){var pe,U=m(this.$__deferred);try{for(U.s();!(pe=U.n()).done;){var B=pe.value;this.set(B.key,B.value)}}catch(N){U.e(N)}finally{U.f()}this.$__deferred=null}}}],be&&g(de.prototype,be),Object.defineProperty(de,"prototype",{writable:!1}),ae}(b(Map));function Q(oe){var ae=h(oe);if(ae!=="string")throw new TypeError("Mongoose maps only support string keys, got ".concat(ae));if(oe.startsWith("$"))throw new Error('Mongoose maps do not support keys that start with "$", got "'.concat(oe,'"'));if(oe.includes("."))throw new Error('Mongoose maps do not support keys that contain ".", got "'.concat(oe,'"'));if(L.has(oe))throw new Error('Mongoose maps do not support reserved key name "'.concat(oe,'"'))}M.inspect.custom&&Object.defineProperty(re.prototype,M.inspect.custom,{enumerable:!1,writable:!1,configurable:!1,value:re.prototype.inspect}),Object.defineProperty(re.prototype,"$__set",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(re.prototype,"$__parent",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(re.prototype,"$__path",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(re.prototype,"$__schemaType",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(re.prototype,"$isMongooseMap",{enumerable:!1,writable:!1,configurable:!1,value:!0}),Object.defineProperty(re.prototype,"$__deferredCalls",{enumerable:!1,writable:!1,configurable:!1,value:!0}),a.exports=re},6079:(a,l,r)=>{var h=r(4029).ObjectId,m=r(8770).objectIdSymbol;Object.defineProperty(h.prototype,"_id",{enumerable:!1,configurable:!0,get:function(){return this}}),h.prototype.hasOwnProperty("valueOf")||(h.prototype.valueOf=function(){return this.toString()}),h.prototype[m]=!0,a.exports=h},2591:(a,l,r)=>{function h(){h=function(){return f};var y,f={},w=Object.prototype,A=w.hasOwnProperty,P=Object.defineProperty||function(Be,se,_e){Be[se]=_e.value},T=typeof Symbol=="function"?Symbol:{},R=T.iterator||"@@iterator",M=T.asyncIterator||"@@asyncIterator",L=T.toStringTag||"@@toStringTag";function W(Be,se,_e){return Object.defineProperty(Be,se,{value:_e,enumerable:!0,configurable:!0,writable:!0}),Be[se]}try{W({},"")}catch{W=function(se,_e,te){return se[_e]=te}}function G(Be,se,_e,te){var $e=se&&se.prototype instanceof pe?se:pe,ge=Object.create($e.prototype),le=new ee(te||[]);return P(ge,"_invoke",{value:Oe(Be,_e,le)}),ge}function re(Be,se,_e){try{return{type:"normal",arg:Be.call(se,_e)}}catch(te){return{type:"throw",arg:te}}}f.wrap=G;var Q="suspendedStart",oe="suspendedYield",ae="executing",de="completed",be={};function pe(){}function U(){}function B(){}var N={};W(N,R,function(){return this});var z=Object.getPrototypeOf,H=z&&z(z(Le([])));H&&H!==w&&A.call(H,R)&&(N=H);var Y=B.prototype=pe.prototype=Object.create(N);function fe(Be){["next","throw","return"].forEach(function(se){W(Be,se,function(_e){return this._invoke(se,_e)})})}function Re(Be,se){function _e($e,ge,le,ze){var Je=re(Be[$e],Be,ge);if(Je.type!=="throw"){var et=Je.arg,ft=et.value;return ft&&v(ft)=="object"&&A.call(ft,"__await")?se.resolve(ft.__await).then(function(wt){_e("next",wt,le,ze)},function(wt){_e("throw",wt,le,ze)}):se.resolve(ft).then(function(wt){et.value=wt,le(et)},function(wt){return _e("throw",wt,le,ze)})}ze(Je.arg)}var te;P(this,"_invoke",{value:function($e,ge){function le(){return new se(function(ze,Je){_e($e,ge,ze,Je)})}return te=te?te.then(le,le):le()}})}function Oe(Be,se,_e){var te=Q;return function($e,ge){if(te===ae)throw new Error("Generator is already running");if(te===de){if($e==="throw")throw ge;return{value:y,done:!0}}for(_e.method=$e,_e.arg=ge;;){var le=_e.delegate;if(le){var ze=De(le,_e);if(ze){if(ze===be)continue;return ze}}if(_e.method==="next")_e.sent=_e._sent=_e.arg;else if(_e.method==="throw"){if(te===Q)throw te=de,_e.arg;_e.dispatchException(_e.arg)}else _e.method==="return"&&_e.abrupt("return",_e.arg);te=ae;var Je=re(Be,se,_e);if(Je.type==="normal"){if(te=_e.done?de:oe,Je.arg===be)continue;return{value:Je.arg,done:_e.done}}Je.type==="throw"&&(te=de,_e.method="throw",_e.arg=Je.arg)}}}function De(Be,se){var _e=se.method,te=Be.iterator[_e];if(te===y)return se.delegate=null,_e==="throw"&&Be.iterator.return&&(se.method="return",se.arg=y,De(Be,se),se.method==="throw")||_e!=="return"&&(se.method="throw",se.arg=new TypeError("The iterator does not provide a '"+_e+"' method")),be;var $e=re(te,Be.iterator,se.arg);if($e.type==="throw")return se.method="throw",se.arg=$e.arg,se.delegate=null,be;var ge=$e.arg;return ge?ge.done?(se[Be.resultName]=ge.value,se.next=Be.nextLoc,se.method!=="return"&&(se.method="next",se.arg=y),se.delegate=null,be):ge:(se.method="throw",se.arg=new TypeError("iterator result is not an object"),se.delegate=null,be)}function ot(Be){var se={tryLoc:Be[0]};1 in Be&&(se.catchLoc=Be[1]),2 in Be&&(se.finallyLoc=Be[2],se.afterLoc=Be[3]),this.tryEntries.push(se)}function X(Be){var se=Be.completion||{};se.type="normal",delete se.arg,Be.completion=se}function ee(Be){this.tryEntries=[{tryLoc:"root"}],Be.forEach(ot,this),this.reset(!0)}function Le(Be){if(Be||Be===""){var se=Be[R];if(se)return se.call(Be);if(typeof Be.next=="function")return Be;if(!isNaN(Be.length)){var _e=-1,te=function $e(){for(;++_e<Be.length;)if(A.call(Be,_e))return $e.value=Be[_e],$e.done=!1,$e;return $e.value=y,$e.done=!0,$e};return te.next=te}}throw new TypeError(v(Be)+" is not iterable")}return U.prototype=B,P(Y,"constructor",{value:B,configurable:!0}),P(B,"constructor",{value:U,configurable:!0}),U.displayName=W(B,L,"GeneratorFunction"),f.isGeneratorFunction=function(Be){var se=typeof Be=="function"&&Be.constructor;return!!se&&(se===U||(se.displayName||se.name)==="GeneratorFunction")},f.mark=function(Be){return Object.setPrototypeOf?Object.setPrototypeOf(Be,B):(Be.__proto__=B,W(Be,L,"GeneratorFunction")),Be.prototype=Object.create(Y),Be},f.awrap=function(Be){return{__await:Be}},fe(Re.prototype),W(Re.prototype,M,function(){return this}),f.AsyncIterator=Re,f.async=function(Be,se,_e,te,$e){$e===void 0&&($e=Promise);var ge=new Re(G(Be,se,_e,te),$e);return f.isGeneratorFunction(se)?ge:ge.next().then(function(le){return le.done?le.value:ge.next()})},fe(Y),W(Y,L,"Generator"),W(Y,R,function(){return this}),W(Y,"toString",function(){return"[object Generator]"}),f.keys=function(Be){var se=Object(Be),_e=[];for(var te in se)_e.push(te);return _e.reverse(),function $e(){for(;_e.length;){var ge=_e.pop();if(ge in se)return $e.value=ge,$e.done=!1,$e}return $e.done=!0,$e}},f.values=Le,ee.prototype={constructor:ee,reset:function(Be){if(this.prev=0,this.next=0,this.sent=this._sent=y,this.done=!1,this.delegate=null,this.method="next",this.arg=y,this.tryEntries.forEach(X),!Be)for(var se in this)se.charAt(0)==="t"&&A.call(this,se)&&!isNaN(+se.slice(1))&&(this[se]=y)},stop:function(){this.done=!0;var Be=this.tryEntries[0].completion;if(Be.type==="throw")throw Be.arg;return this.rval},dispatchException:function(Be){if(this.done)throw Be;var se=this;function _e(Je,et){return ge.type="throw",ge.arg=Be,se.next=Je,et&&(se.method="next",se.arg=y),!!et}for(var te=this.tryEntries.length-1;te>=0;--te){var $e=this.tryEntries[te],ge=$e.completion;if($e.tryLoc==="root")return _e("end");if($e.tryLoc<=this.prev){var le=A.call($e,"catchLoc"),ze=A.call($e,"finallyLoc");if(le&&ze){if(this.prev<$e.catchLoc)return _e($e.catchLoc,!0);if(this.prev<$e.finallyLoc)return _e($e.finallyLoc)}else if(le){if(this.prev<$e.catchLoc)return _e($e.catchLoc,!0)}else{if(!ze)throw new Error("try statement without catch or finally");if(this.prev<$e.finallyLoc)return _e($e.finallyLoc)}}}},abrupt:function(Be,se){for(var _e=this.tryEntries.length-1;_e>=0;--_e){var te=this.tryEntries[_e];if(te.tryLoc<=this.prev&&A.call(te,"finallyLoc")&&this.prev<te.finallyLoc){var $e=te;break}}$e&&(Be==="break"||Be==="continue")&&$e.tryLoc<=se&&se<=$e.finallyLoc&&($e=null);var ge=$e?$e.completion:{};return ge.type=Be,ge.arg=se,$e?(this.method="next",this.next=$e.finallyLoc,be):this.complete(ge)},complete:function(Be,se){if(Be.type==="throw")throw Be.arg;return Be.type==="break"||Be.type==="continue"?this.next=Be.arg:Be.type==="return"?(this.rval=this.arg=Be.arg,this.method="return",this.next="end"):Be.type==="normal"&&se&&(this.next=se),be},finish:function(Be){for(var se=this.tryEntries.length-1;se>=0;--se){var _e=this.tryEntries[se];if(_e.finallyLoc===Be)return this.complete(_e.completion,_e.afterLoc),X(_e),be}},catch:function(Be){for(var se=this.tryEntries.length-1;se>=0;--se){var _e=this.tryEntries[se];if(_e.tryLoc===Be){var te=_e.completion;if(te.type==="throw"){var $e=te.arg;X(_e)}return $e}}throw new Error("illegal catch attempt")},delegateYield:function(Be,se,_e){return this.delegate={iterator:Le(Be),resultName:se,nextLoc:_e},this.method==="next"&&(this.arg=y),be}},f}function m(y,f,w,A,P,T,R){try{var M=y[T](R),L=M.value}catch(W){return void w(W)}M.done?f(L):Promise.resolve(L).then(A,P)}function v(y){return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},v(y)}var g=r(8727),_=r(1490),E=r(4962).h,b=r(8751),p=r(6872);function x(y,f,w,A,P){if(v(A)==="object"&&A!=null&&P==null&&(P=A,A=void 0),w!=null){var T={isNew:w.isNew};"defaults"in w.$__&&(T.defaults=w.$__.defaults),P=Object.assign(T,P)}P!=null&&P.path!=null&&(this.$basePath=P.path),g.call(this,y,f,A,P),delete this.$__.priorDoc}a.exports=x,x.prototype=Object.create(g.prototype),Object.defineProperty(x.prototype,"$isSubdocument",{configurable:!1,writable:!1,value:!0}),Object.defineProperty(x.prototype,"$isSingleNested",{configurable:!1,writable:!1,value:!0}),x.prototype.toBSON=function(){return this.toObject(E)},x.prototype.save=function(){var y,f=(y=h().mark(function w(A){var P=this;return h().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return(A=A||{}).suppressWarning||p.warn("mongoose: calling `save()` on a subdoc does **not** save the document to MongoDB, it only runs save middleware. Use `subdoc.save({ suppressWarning: true })` to hide this warning if you're sure this behavior is right for your app."),T.abrupt("return",new Promise(function(R,M){P.$__save(function(L){if(L!=null)return M(L);R(P)})}));case 3:case"end":return T.stop()}},w)}),function(){var w=this,A=arguments;return new Promise(function(P,T){var R=y.apply(w,A);function M(W){m(R,P,T,M,L,"next",W)}function L(W){m(R,P,T,M,L,"throw",W)}M(void 0)})});return function(w){return f.apply(this,arguments)}}(),x.prototype.$__fullPath=function(y){return this.$__.fullPath||this.ownerDocument(),y?this.$__.fullPath+"."+y:this.$__.fullPath},x.prototype.$__pathRelativeToParent=function(y){return y==null?this.$basePath:[this.$basePath,y].join(".")},x.prototype.$__save=function(y){var f=this;return _(function(){return y(null,f)})},x.prototype.$isValid=function(y){var f=this.$parent(),w=this.$__pathRelativeToParent(y);return f!=null&&w!=null?f.$isValid(w):g.prototype.$isValid.call(this,y)},x.prototype.markModified=function(y){g.prototype.markModified.call(this,y);var f=this.$parent(),w=this.$__pathRelativeToParent(y);if(f!=null&&w!=null){var A=this.$__pathRelativeToParent().replace(/\.$/,"");f.isDirectModified(A)||this.isNew||this.$__parent.markModified(w,this)}},x.prototype.isModified=function(y,f,w){var A=this,P=this.$parent();return P!=null?(Array.isArray(y)||typeof y=="string"?y=(y=Array.isArray(y)?y:y.split(" ")).map(function(T){return A.$__pathRelativeToParent(T)}).filter(function(T){return T!=null}):y||(y=this.$__pathRelativeToParent()),P.$isModified(y,f,w)):g.prototype.isModified.call(this,y,f,w)},x.prototype.$markValid=function(y){g.prototype.$markValid.call(this,y);var f=this.$parent(),w=this.$__pathRelativeToParent(y);f!=null&&w!=null&&f.$markValid(w)},x.prototype.invalidate=function(y,f,w){g.prototype.invalidate.call(this,y,f,w);var A=this.$parent(),P=this.$__pathRelativeToParent(y);if(A!=null&&P!=null)A.invalidate(P,f,w);else if(f.kind==="cast"||f.name==="CastError"||P==null)throw f;return this.ownerDocument().$__.validationError},x.prototype.$ignore=function(y){g.prototype.$ignore.call(this,y);var f=this.$parent(),w=this.$__pathRelativeToParent(y);f!=null&&w!=null&&f.$ignore(w)},x.prototype.ownerDocument=function(){if(this.$__.ownerDocument)return this.$__.ownerDocument;for(var y=this,f=[],w=new Set([y]);typeof y.$__pathRelativeToParent=="function";){f.unshift(y.$__pathRelativeToParent(void 0,!0));var A=y.$parent();if(A==null)break;if(y=A,w.has(y))throw new Error("Infinite subdocument loop: subdoc with _id "+y._id+" is a parent of itself");w.add(y)}return this.$__.fullPath=f.join("."),this.$__.ownerDocument=y,this.$__.ownerDocument},x.prototype.$__fullPathWithIndexes=function(){for(var y=this,f=[],w=new Set([y]);typeof y.$__pathRelativeToParent=="function";){f.unshift(y.$__pathRelativeToParent(void 0,!1));var A=y.$parent();if(A==null)break;if(y=A,w.has(y))throw new Error("Infinite subdocument loop: subdoc with _id "+y._id+" is a parent of itself");w.add(y)}return f.join(".")},x.prototype.parent=function(){return this.$__parent},x.prototype.$parent=x.prototype.parent,x.prototype.$__deleteOne=function(y){if(y!=null)return y(null,this)},x.prototype.$__removeFromParent=function(){this.$__parent.set(this.$basePath,null)},x.prototype.deleteOne=function(y,f){return typeof y=="function"&&(f=y,y=null),function(w){var A=w.ownerDocument();function P(){A.$removeListener("save",P),A.$removeListener("deleteOne",P),w.emit("deleteOne",w),w.constructor.emit("deleteOne",w),A=w=null}A.$on("save",P),A.$on("deleteOne",P)}(this),y&&y.noop||this.$__removeFromParent(),this.$__deleteOne(f)},x.prototype.populate=function(){throw new Error('Mongoose does not support calling populate() on nested docs. Instead of `doc.nested.populate("path")`, use `doc.populate("nested.path")`')},x.prototype.inspect=function(){return this.toObject({transform:!1,virtuals:!1,flattenDecimals:!1})},b.inspect.custom&&(x.prototype[b.inspect.custom]=x.prototype.inspect)},8369:(a,l,r)=>{a.exports=r(4029).UUID},6872:(a,l,r)=>{var h=r(365).Buffer;function m(N,z){var H=typeof Symbol<"u"&&N[Symbol.iterator]||N["@@iterator"];if(!H){if(Array.isArray(N)||(H=function(ot,X){if(ot){if(typeof ot=="string")return v(ot,X);var ee=Object.prototype.toString.call(ot).slice(8,-1);return ee==="Object"&&ot.constructor&&(ee=ot.constructor.name),ee==="Map"||ee==="Set"?Array.from(ot):ee==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ee)?v(ot,X):void 0}}(N))||z&&N&&typeof N.length=="number"){H&&(N=H);var Y=0,fe=function(){};return{s:fe,n:function(){return Y>=N.length?{done:!0}:{done:!1,value:N[Y++]}},e:function(ot){throw ot},f:fe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Re,Oe=!0,De=!1;return{s:function(){H=H.call(N)},n:function(){var ot=H.next();return Oe=ot.done,ot},e:function(ot){De=!0,Re=ot},f:function(){try{Oe||H.return==null||H.return()}finally{if(De)throw Re}}}}function v(N,z){(z==null||z>N.length)&&(z=N.length);for(var H=0,Y=new Array(z);H<z;H++)Y[H]=N[H];return Y}function g(N){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},g(N)}var _,E=r(4029).UUID,b=r(2068),p=r(3564),x=r(6079),y=r(7556),f=r(1973),w=r(1490),A=r(5721),P=r(7339),T=r(2991),R=r(1563),M=r(6749),L=r(6584),W=r(8486),G=r(4913),re=r(2862),Q=r(3636).trustedSymbol;l.specialProperties=re,l.isMongooseArray=P.isMongooseArray,l.isMongooseDocumentArray=T.isMongooseDocumentArray,l.registerMongooseArray=P.registerMongooseArray,l.registerMongooseDocumentArray=T.registerMongooseDocumentArray;var oe=/\s/,ae=/\s+/;l.toCollectionName=function(N,z){return N==="system.profile"||N==="system.indexes"?N:typeof z=="function"?z(N):N},l.deepEqual=function N(z,H){if(z===H)return!0;if(g(z)!=="object"||g(H)!=="object")return z===H;if(z instanceof Date&&H instanceof Date)return z.getTime()===H.getTime();if(R(z,"ObjectId")&&R(H,"ObjectId")||R(z,"Decimal128")&&R(H,"Decimal128"))return z.toString()===H.toString();if(z instanceof RegExp&&H instanceof RegExp)return z.source===H.source&&z.ignoreCase===H.ignoreCase&&z.multiline===H.multiline&&z.global===H.global&&z.dotAll===H.dotAll&&z.unicode===H.unicode&&z.sticky===H.sticky&&z.hasIndices===H.hasIndices;if(z==null||H==null||z.prototype!==H.prototype)return!1;if(z instanceof Map||H instanceof Map)return z instanceof Map&&H instanceof Map&&N(Array.from(z.keys()),Array.from(H.keys()))&&N(Array.from(z.values()),Array.from(H.values()));if(z instanceof Number&&H instanceof Number)return z.valueOf()===H.valueOf();if(h.isBuffer(z))return l.buffer.areEqual(z,H);if(Array.isArray(z)||Array.isArray(H)){if(!Array.isArray(z)||!Array.isArray(H))return!1;var Y=z.length;if(Y!==H.length)return!1;for(var fe=0;fe<Y;++fe)if(!N(z[fe],H[fe]))return!1;return!0}z.$__!=null?z=z._doc:L(z)&&(z=z.toObject()),H.$__!=null?H=H._doc:L(H)&&(H=H.toObject());var Re=Object.keys(z),Oe=Object.keys(H),De=Re.length;if(De!==Oe.length)return!1;for(var ot=De-1;ot>=0;ot--)if(Re[ot]!==Oe[ot])return!1;for(var X=0,ee=Re;X<ee.length;X++){var Le=ee[X];if(!N(z[Le],H[Le]))return!1}return!0},l.last=function(N){if(N.length>0)return N[N.length-1]},l.promiseOrCallback=W,l.cloneArrays=function(N){return Array.isArray(N)?N.map(function(z){return l.cloneArrays(z)}):N},l.omit=function(N,z){if(z==null)return Object.assign({},N);Array.isArray(z)||(z=[z]);var H,Y=Object.assign({},N),fe=m(z);try{for(fe.s();!(H=fe.n()).done;)delete Y[H.value]}catch(Re){fe.e(Re)}finally{fe.f()}return Y},l.merge=function N(z,H,Y,fe){Y=Y||{};var Re,Oe=Object.keys(H),De=0,ot=Oe.length;H[Q]&&(z[Q]=H[Q]),fe=fe||"";for(var X=Y.omitNested||{};De<ot;)if(Re=Oe[De++],!(Y.omit&&Y.omit[Re]||X[fe]||re.has(Re)))if(z[Re]==null)z[Re]=H[Re];else if(l.isObject(H[Re])){if(l.isObject(z[Re])||(z[Re]={}),H[Re]!=null){if(Y.isDiscriminatorSchemaMerge&&H[Re].$isSingleNested&&z[Re].$isMongooseDocumentArray||H[Re].$isMongooseDocumentArray&&z[Re].$isSingleNested)continue;if(H[Re].instanceOfSchema){z[Re].instanceOfSchema?G(z[Re],H[Re].clone(),Y.isDiscriminatorSchemaMerge):z[Re]=H[Re].clone();continue}if(R(H[Re],"ObjectId")){z[Re]=new x(H[Re]);continue}}N(z[Re],H[Re],Y,fe?fe+"."+Re:Re)}else Y.overwrite&&(z[Re]=H[Re])},l.toObject=function N(z){var H;if(_||(_=r(8727)),z==null)return z;if(z instanceof _)return z.toObject();if(Array.isArray(z)){H=[];var Y,fe=m(z);try{for(fe.s();!(Y=fe.n()).done;){var Re=Y.value;H.push(N(Re))}}catch(X){fe.e(X)}finally{fe.f()}return H}if(l.isPOJO(z)){H={},z[Q]&&(H[Q]=z[Q]);for(var Oe=0,De=Object.keys(z);Oe<De.length;Oe++){var ot=De[Oe];re.has(ot)||(H[ot]=N(z[ot]))}return H}return z},l.isObject=A,l.isPOJO=r(4673),l.isNonBuiltinObject=function(N){return!(g(N)!=="object"||l.isNativeObject(N)||l.isMongooseType(N)||N instanceof E||N==null)},l.isNativeObject=function(N){return Array.isArray(N)||N instanceof Date||N instanceof Boolean||N instanceof Number||N instanceof String},l.isEmptyObject=function(N){return N!=null&&g(N)==="object"&&Object.keys(N).length===0},l.hasKey=function(N,z){for(var H=0,Y=Object.keys(N);H<Y.length;H++){var fe=Y[H];if(fe===z||l.isPOJO(N[fe])&&l.hasKey(N[fe],z))return!0}return!1},l.tick=function(N){if(typeof N=="function")return function(){try{N.apply(this,arguments)}catch(z){w(function(){throw z})}}},l.isMongooseType=function(N){return R(N,"ObjectId")||R(N,"Decimal128")||N instanceof h},l.isMongooseObject=L,l.expires=function(N){N&&N.constructor.name==="Object"&&"expires"in N&&(N.expireAfterSeconds=typeof N.expires!="string"?N.expires:Math.round(b(N.expires)/1e3),delete N.expires)},l.populate=function(N,z,H,Y,fe,Re,Oe,De){var ot,X=null;if(arguments.length===1){if(N instanceof y)return N._docs=[],N._childDocs=[],[N];if(Array.isArray(N)){var ee=(ot=[],N.forEach(function(Le){oe.test(Le.path)?Le.path.split(ae).forEach(function(Be){var se=Object.assign({},Le);se.path=Be,ot.push(se)}):ot.push(Le)}),ot);return ee.map(function(Le){return l.populate(Le)[0]})}X=l.isObject(N)?Object.assign({},N):{path:N}}else X=g(H)==="object"?{path:N,select:z,match:H,options:Y}:{path:N,select:z,model:H,match:Y,options:fe,populate:Re,justOne:Oe,count:De};if(typeof X.path!="string")throw new TypeError("utils.populate: invalid path. Expected string. Got typeof `"+g(N)+"`");return function(Le){if(Array.isArray(Le.populate)){var Be=[];Le.populate.forEach(function(le){if(oe.test(le.path)){var ze=Object.assign({},le);ze.path.split(ae).forEach(function(Je){ze.path=Je,Be.push(l.populate(ze)[0])})}else Be.push(l.populate(le)[0])}),Le.populate=l.populate(Be)}else Le.populate!=null&&g(Le.populate)==="object"&&(Le.populate=l.populate(Le.populate));var se=[],_e=oe.test(Le.path)?Le.path.split(ae):[Le.path];Le.options!=null&&(Le.options=f(Le.options));var te,$e=m(_e);try{for($e.s();!(te=$e.n()).done;){var ge=te.value;se.push(new y(Object.assign({},Le,{path:ge})))}}catch(le){$e.e(le)}finally{$e.f()}return se}(X)},l.getValue=function(N,z,H){return p.get(N,z,be,H)};var de=Object.freeze({getters:!1});function be(N,z){var H=(N==null?void 0:N._doc)||N;return H!=null&&H.isMongooseArrayProxy&&(H=H.__array),H instanceof Map?H.get(z,de):H[z]}l.setValue=function(N,z,H,Y,fe){p.set(N,z,H,"_doc",Y,fe)},l.object={},l.object.vals=function(N){for(var z=Object.keys(N),H=z.length,Y=[];H--;)Y.push(N[z[H]]);return Y};var pe=Object.prototype.hasOwnProperty;l.object.hasOwnProperty=function(N,z){return pe.call(N,z)},l.isNullOrUndefined=function(N){return N==null},l.array={},l.array.flatten=function N(z,H,Y){return Y||(Y=[]),z.forEach(function(fe){Array.isArray(fe)?N(fe,H,Y):H&&!H(fe)||Y.push(fe)}),Y};var U=Object.prototype.hasOwnProperty;l.hasUserDefinedProperty=function(N,z){if(N==null)return!1;if(Array.isArray(z)){var H,Y=m(z);try{for(Y.s();!(H=Y.n()).done;){var fe=H.value;if(l.hasUserDefinedProperty(N,fe))return!0}}catch(Oe){Y.e(Oe)}finally{Y.f()}return!1}if(U.call(N,z))return!0;if(g(N)==="object"&&z in N){var Re=N[z];return Re!==Object.prototype[z]&&Re!==Array.prototype[z]}return!1};var B=Math.pow(2,32)-1;l.isArrayIndex=function(N){return typeof N=="number"?N>=0&&N<=B:typeof N=="string"&&!!/^\d+$/.test(N)&&(N=+N)>=0&&N<=B},l.array.unique=function(N){var z,H=new Set,Y=new Set,fe=[],Re=m(N);try{for(Re.s();!(z=Re.n()).done;){var Oe=z.value;if(typeof Oe=="number"||typeof Oe=="string"||Oe==null){if(H.has(Oe))continue;fe.push(Oe),H.add(Oe)}else if(R(Oe,"ObjectId")){if(Y.has(Oe.toString()))continue;fe.push(Oe),Y.add(Oe.toString())}else fe.push(Oe)}}catch(De){Re.e(De)}finally{Re.f()}return fe},l.buffer={},l.buffer.areEqual=function(N,z){if(!h.isBuffer(N)||!h.isBuffer(z)||N.length!==z.length)return!1;for(var H=0,Y=N.length;H<Y;++H)if(N[H]!==z[H])return!1;return!0},l.getFunctionName=M,l.decorate=function(N,z){for(var H in z)re.has(H)||(N[H]=z[H])},l.mergeClone=function(N,z){L(z)&&(z=z.toObject({transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1}));for(var H,Y=Object.keys(z),fe=Y.length,Re=0;Re<fe;)if(H=Y[Re++],!re.has(H))if(N[H]===void 0)N[H]=f(z[H],{transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1});else{var Oe=z[H];if(Oe==null||!Oe.valueOf||Oe instanceof Date||(Oe=Oe.valueOf()),l.isObject(Oe)){var De=Oe;L(Oe)&&!Oe.isMongooseBuffer&&(De=De.toObject({transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1})),Oe.isMongooseBuffer&&(De=h.from(De)),l.mergeClone(N[H],De)}else N[H]=f(Oe,{flattenDecimals:!1})}},l.each=function(N,z){var H,Y=m(N);try{for(Y.s();!(H=Y.n()).done;)z(H.value)}catch(fe){Y.e(fe)}finally{Y.f()}},l.renameObjKey=function(N,z,H){return Object.keys(N).reduce(function(Y,fe){return fe===z?Y[H]=N[z]:Y[fe]=N[fe],Y},{})},l.getOption=function(N){var z,H=m(Array.prototype.slice.call(arguments,1));try{for(H.s();!(z=H.n()).done;){var Y=z.value;if(Y!=null&&Y[N]!=null)return Y[N]}}catch(fe){H.e(fe)}finally{H.f()}return null},l.noop=function(){},l.errorToPOJO=function(N){if(!(N instanceof Error))throw new Error("`error` must be `instanceof Error`.");var z,H={},Y=m(Object.getOwnPropertyNames(N));try{for(Y.s();!(z=Y.n()).done;){var fe=z.value;H[fe]=N[fe]}}catch(Re){Y.e(Re)}finally{Y.f()}return H},l.warn=function(N){return{env:{}}.emitWarning(N,{code:"MONGOOSE"})},l.injectTimestampsOption=function(N,z){z!=null&&(N.timestamps=z)}},9546:(a,l,r)=>{function h(_,E){var b=typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(!b){if(Array.isArray(_)||(b=function(A,P){if(A){if(typeof A=="string")return m(A,P);var T=Object.prototype.toString.call(A).slice(8,-1);return T==="Object"&&A.constructor&&(T=A.constructor.name),T==="Map"||T==="Set"?Array.from(A):T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T)?m(A,P):void 0}}(_))||E&&_&&typeof _.length=="number"){b&&(_=b);var p=0,x=function(){};return{s:x,n:function(){return p>=_.length?{done:!0}:{done:!1,value:_[p++]}},e:function(A){throw A},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var y,f=!0,w=!1;return{s:function(){b=b.call(_)},n:function(){var A=b.next();return f=A.done,A},e:function(A){w=!0,y=A},f:function(){try{f||b.return==null||b.return()}finally{if(w)throw y}}}}function m(_,E){(E==null||E>_.length)&&(E=_.length);for(var b=0,p=new Array(E);b<E;b++)p[b]=_[b];return p}var v=r(6872);function g(_,E){this.path=E,this.getters=[],this.setters=[],this.options=Object.assign({},_)}g.prototype._applyDefaultGetters=function(){if(!(this.getters.length>0||this.setters.length>0)){var _="$"+this.path;this.getters.push(function(){return this.$locals[_]}),this.setters.push(function(E){this.$locals[_]=E})}},g.prototype.clone=function(){var _=new g(this.options,this.path);return _.getters=[].concat(this.getters),_.setters=[].concat(this.setters),_},g.prototype.get=function(_){return this.getters.push(_),this},g.prototype.set=function(_){return this.setters.push(_),this},g.prototype.applyGetters=function(_,E){v.hasUserDefinedProperty(this.options,["ref","refPath"])&&E.$$populatedVirtuals&&E.$$populatedVirtuals.hasOwnProperty(this.path)&&(_=E.$$populatedVirtuals[this.path]);var b,p=_,x=h(this.getters);try{for(x.s();!(b=x.n()).done;)p=b.value.call(E,p,this,E)}catch(y){x.e(y)}finally{x.f()}return p},g.prototype.applySetters=function(_,E){var b,p=_,x=h(this.setters);try{for(x.s();!(b=x.n()).done;)p=b.value.call(E,p,this,E)}catch(y){x.e(y)}finally{x.f()}return p},a.exports=g},7406:(a,l,r)=>{var h=l;h.bignum=r(815),h.define=r(8721).define,h.base=r(6002),h.constants=r(4319),h.decoders=r(4049),h.encoders=r(6860)},8721:(a,l,r)=>{var h=r(6860),m=r(4049),v=r(376);function g(_,E){this.name=_,this.body=E,this.decoders={},this.encoders={}}l.define=function(_,E){return new g(_,E)},g.prototype._createNamed=function(_){var E=this.name;function b(p){this._initNamed(p,E)}return v(b,_),b.prototype._initNamed=function(p,x){_.call(this,p,x)},new b(this)},g.prototype._getDecoder=function(_){return _=_||"der",this.decoders.hasOwnProperty(_)||(this.decoders[_]=this._createNamed(m[_])),this.decoders[_]},g.prototype.decode=function(_,E,b){return this._getDecoder(E).decode(_,b)},g.prototype._getEncoder=function(_){return _=_||"der",this.encoders.hasOwnProperty(_)||(this.encoders[_]=this._createNamed(h[_])),this.encoders[_]},g.prototype.encode=function(_,E,b){return this._getEncoder(E).encode(_,b)}},4989:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}var m=r(376),v=r(1269).b,g=r(8723).Buffer;function _(b,p){v.call(this,p),g.isBuffer(b)?(this.base=b,this.offset=0,this.length=b.length):this.error("Input not Buffer")}function E(b,p){if(Array.isArray(b))this.length=0,this.value=b.map(function(x){return E.isEncoderBuffer(x)||(x=new E(x,p)),this.length+=x.length,x},this);else if(typeof b=="number"){if(!(0<=b&&b<=255))return p.error("non-byte EncoderBuffer value");this.value=b,this.length=1}else if(typeof b=="string")this.value=b,this.length=g.byteLength(b);else{if(!g.isBuffer(b))return p.error("Unsupported type: "+h(b));this.value=b,this.length=b.length}}m(_,v),l.C=_,_.isDecoderBuffer=function(b){return b instanceof _||h(b)==="object"&&g.isBuffer(b.base)&&b.constructor.name==="DecoderBuffer"&&typeof b.offset=="number"&&typeof b.length=="number"&&typeof b.save=="function"&&typeof b.restore=="function"&&typeof b.isEmpty=="function"&&typeof b.readUInt8=="function"&&typeof b.skip=="function"&&typeof b.raw=="function"},_.prototype.save=function(){return{offset:this.offset,reporter:v.prototype.save.call(this)}},_.prototype.restore=function(b){var p=new _(this.base);return p.offset=b.offset,p.length=this.offset,this.offset=b.offset,v.prototype.restore.call(this,b.reporter),p},_.prototype.isEmpty=function(){return this.offset===this.length},_.prototype.readUInt8=function(b){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(b||"DecoderBuffer overrun")},_.prototype.skip=function(b,p){if(!(this.offset+b<=this.length))return this.error(p||"DecoderBuffer overrun");var x=new _(this.base);return x._reporterState=this._reporterState,x.offset=this.offset,x.length=this.offset+b,this.offset+=b,x},_.prototype.raw=function(b){return this.base.slice(b?b.offset:this.offset,this.length)},l.R=E,E.isEncoderBuffer=function(b){return b instanceof E||h(b)==="object"&&b.constructor.name==="EncoderBuffer"&&typeof b.length=="number"&&typeof b.join=="function"},E.prototype.join=function(b,p){return b||(b=g.alloc(this.length)),p||(p=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(x){x.join(b,p),p+=x.length}):(typeof this.value=="number"?b[p]=this.value:typeof this.value=="string"?b.write(this.value,p):g.isBuffer(this.value)&&this.value.copy(b,p),p+=this.length)),b}},6002:(a,l,r)=>{var h=l;h.Reporter=r(1269).b,h.DecoderBuffer=r(4989).C,h.EncoderBuffer=r(4989).R,h.Node=r(3304)},3304:(a,l,r)=>{function h(y){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},h(y)}var m=r(1269).b,v=r(4989).R,g=r(4989).C,_=r(1130),E=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],b=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(E);function p(y,f,w){var A={};this._baseState=A,A.name=w,A.enc=y,A.parent=f||null,A.children=null,A.tag=null,A.args=null,A.reverseArgs=null,A.choice=null,A.optional=!1,A.any=!1,A.obj=!1,A.use=null,A.useDecoder=null,A.key=null,A.default=null,A.explicit=null,A.implicit=null,A.contains=null,A.parent||(A.children=[],this._wrap())}a.exports=p;var x=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];p.prototype.clone=function(){var y=this._baseState,f={};x.forEach(function(A){f[A]=y[A]});var w=new this.constructor(f.parent);return w._baseState=f,w},p.prototype._wrap=function(){var y=this._baseState;b.forEach(function(f){this[f]=function(){var w=new this.constructor(this);return y.children.push(w),w[f].apply(w,arguments)}},this)},p.prototype._init=function(y){var f=this._baseState;_(f.parent===null),y.call(this),f.children=f.children.filter(function(w){return w._baseState.parent===this},this),_.equal(f.children.length,1,"Root node can have only one child")},p.prototype._useArgs=function(y){var f=this._baseState,w=y.filter(function(A){return A instanceof this.constructor},this);y=y.filter(function(A){return!(A instanceof this.constructor)},this),w.length!==0&&(_(f.children===null),f.children=w,w.forEach(function(A){A._baseState.parent=this},this)),y.length!==0&&(_(f.args===null),f.args=y,f.reverseArgs=y.map(function(A){if(h(A)!=="object"||A.constructor!==Object)return A;var P={};return Object.keys(A).forEach(function(T){T==(0|T)&&(T|=0);var R=A[T];P[R]=T}),P}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(y){p.prototype[y]=function(){var f=this._baseState;throw new Error(y+" not implemented for encoding: "+f.enc)}}),E.forEach(function(y){p.prototype[y]=function(){var f=this._baseState,w=Array.prototype.slice.call(arguments);return _(f.tag===null),f.tag=y,this._useArgs(w),this}}),p.prototype.use=function(y){_(y);var f=this._baseState;return _(f.use===null),f.use=y,this},p.prototype.optional=function(){return this._baseState.optional=!0,this},p.prototype.def=function(y){var f=this._baseState;return _(f.default===null),f.default=y,f.optional=!0,this},p.prototype.explicit=function(y){var f=this._baseState;return _(f.explicit===null&&f.implicit===null),f.explicit=y,this},p.prototype.implicit=function(y){var f=this._baseState;return _(f.explicit===null&&f.implicit===null),f.implicit=y,this},p.prototype.obj=function(){var y=this._baseState,f=Array.prototype.slice.call(arguments);return y.obj=!0,f.length!==0&&this._useArgs(f),this},p.prototype.key=function(y){var f=this._baseState;return _(f.key===null),f.key=y,this},p.prototype.any=function(){return this._baseState.any=!0,this},p.prototype.choice=function(y){var f=this._baseState;return _(f.choice===null),f.choice=y,this._useArgs(Object.keys(y).map(function(w){return y[w]})),this},p.prototype.contains=function(y){var f=this._baseState;return _(f.use===null),f.contains=y,this},p.prototype._decode=function(y,f){var w=this._baseState;if(w.parent===null)return y.wrapResult(w.children[0]._decode(y,f));var A,P=w.default,T=!0,R=null;if(w.key!==null&&(R=y.enterKey(w.key)),w.optional){var M=null;if(w.explicit!==null?M=w.explicit:w.implicit!==null?M=w.implicit:w.tag!==null&&(M=w.tag),M!==null||w.any){if(T=this._peekTag(y,M,w.any),y.isError(T))return T}else{var L=y.save();try{w.choice===null?this._decodeGeneric(w.tag,y,f):this._decodeChoice(y,f),T=!0}catch{T=!1}y.restore(L)}}if(w.obj&&T&&(A=y.enterObject()),T){if(w.explicit!==null){var W=this._decodeTag(y,w.explicit);if(y.isError(W))return W;y=W}var G=y.offset;if(w.use===null&&w.choice===null){var re;w.any&&(re=y.save());var Q=this._decodeTag(y,w.implicit!==null?w.implicit:w.tag,w.any);if(y.isError(Q))return Q;w.any?P=y.raw(re):y=Q}if(f&&f.track&&w.tag!==null&&f.track(y.path(),G,y.length,"tagged"),f&&f.track&&w.tag!==null&&f.track(y.path(),y.offset,y.length,"content"),w.any||(P=w.choice===null?this._decodeGeneric(w.tag,y,f):this._decodeChoice(y,f)),y.isError(P))return P;if(w.any||w.choice!==null||w.children===null||w.children.forEach(function(ae){ae._decode(y,f)}),w.contains&&(w.tag==="octstr"||w.tag==="bitstr")){var oe=new g(P);P=this._getUse(w.contains,y._reporterState.obj)._decode(oe,f)}}return w.obj&&T&&(P=y.leaveObject(A)),w.key===null||P===null&&T!==!0?R!==null&&y.exitKey(R):y.leaveKey(R,w.key,P),P},p.prototype._decodeGeneric=function(y,f,w){var A=this._baseState;return y==="seq"||y==="set"?null:y==="seqof"||y==="setof"?this._decodeList(f,y,A.args[0],w):/str$/.test(y)?this._decodeStr(f,y,w):y==="objid"&&A.args?this._decodeObjid(f,A.args[0],A.args[1],w):y==="objid"?this._decodeObjid(f,null,null,w):y==="gentime"||y==="utctime"?this._decodeTime(f,y,w):y==="null_"?this._decodeNull(f,w):y==="bool"?this._decodeBool(f,w):y==="objDesc"?this._decodeStr(f,y,w):y==="int"||y==="enum"?this._decodeInt(f,A.args&&A.args[0],w):A.use!==null?this._getUse(A.use,f._reporterState.obj)._decode(f,w):f.error("unknown tag: "+y)},p.prototype._getUse=function(y,f){var w=this._baseState;return w.useDecoder=this._use(y,f),_(w.useDecoder._baseState.parent===null),w.useDecoder=w.useDecoder._baseState.children[0],w.implicit!==w.useDecoder._baseState.implicit&&(w.useDecoder=w.useDecoder.clone(),w.useDecoder._baseState.implicit=w.implicit),w.useDecoder},p.prototype._decodeChoice=function(y,f){var w=this._baseState,A=null,P=!1;return Object.keys(w.choice).some(function(T){var R=y.save(),M=w.choice[T];try{var L=M._decode(y,f);if(y.isError(L))return!1;A={type:T,value:L},P=!0}catch{return y.restore(R),!1}return!0},this),P?A:y.error("Choice not matched")},p.prototype._createEncoderBuffer=function(y){return new v(y,this.reporter)},p.prototype._encode=function(y,f,w){var A=this._baseState;if(A.default===null||A.default!==y){var P=this._encodeValue(y,f,w);if(P!==void 0&&!this._skipDefault(P,f,w))return P}},p.prototype._encodeValue=function(y,f,w){var A=this._baseState;if(A.parent===null)return A.children[0]._encode(y,f||new m);var P=null;if(this.reporter=f,A.optional&&y===void 0){if(A.default===null)return;y=A.default}var T=null,R=!1;if(A.any)P=this._createEncoderBuffer(y);else if(A.choice)P=this._encodeChoice(y,f);else if(A.contains)T=this._getUse(A.contains,w)._encode(y,f),R=!0;else if(A.children)T=A.children.map(function(G){if(G._baseState.tag==="null_")return G._encode(null,f,y);if(G._baseState.key===null)return f.error("Child should have a key");var re=f.enterKey(G._baseState.key);if(h(y)!=="object")return f.error("Child expected, but input is not object");var Q=G._encode(y[G._baseState.key],f,y);return f.leaveKey(re),Q},this).filter(function(G){return G}),T=this._createEncoderBuffer(T);else if(A.tag==="seqof"||A.tag==="setof"){if(!A.args||A.args.length!==1)return f.error("Too many args for : "+A.tag);if(!Array.isArray(y))return f.error("seqof/setof, but data is not Array");var M=this.clone();M._baseState.implicit=null,T=this._createEncoderBuffer(y.map(function(G){var re=this._baseState;return this._getUse(re.args[0],y)._encode(G,f)},M))}else A.use!==null?P=this._getUse(A.use,w)._encode(y,f):(T=this._encodePrimitive(A.tag,y),R=!0);if(!A.any&&A.choice===null){var L=A.implicit!==null?A.implicit:A.tag,W=A.implicit===null?"universal":"context";L===null?A.use===null&&f.error("Tag could be omitted only for .use()"):A.use===null&&(P=this._encodeComposite(L,R,W,T))}return A.explicit!==null&&(P=this._encodeComposite(A.explicit,!1,"context",P)),P},p.prototype._encodeChoice=function(y,f){var w=this._baseState,A=w.choice[y.type];return A||_(!1,y.type+" not found in "+JSON.stringify(Object.keys(w.choice))),A._encode(y.value,f)},p.prototype._encodePrimitive=function(y,f){var w=this._baseState;if(/str$/.test(y))return this._encodeStr(f,y);if(y==="objid"&&w.args)return this._encodeObjid(f,w.reverseArgs[0],w.args[1]);if(y==="objid")return this._encodeObjid(f,null,null);if(y==="gentime"||y==="utctime")return this._encodeTime(f,y);if(y==="null_")return this._encodeNull();if(y==="int"||y==="enum")return this._encodeInt(f,w.args&&w.reverseArgs[0]);if(y==="bool")return this._encodeBool(f);if(y==="objDesc")return this._encodeStr(f,y);throw new Error("Unsupported tag: "+y)},p.prototype._isNumstr=function(y){return/^[0-9 ]*$/.test(y)},p.prototype._isPrintstr=function(y){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(y)}},1269:(a,l,r)=>{var h=r(376);function m(g){this._reporterState={obj:null,path:[],options:g||{},errors:[]}}function v(g,_){this.path=g,this.rethrow(_)}l.b=m,m.prototype.isError=function(g){return g instanceof v},m.prototype.save=function(){var g=this._reporterState;return{obj:g.obj,pathLen:g.path.length}},m.prototype.restore=function(g){var _=this._reporterState;_.obj=g.obj,_.path=_.path.slice(0,g.pathLen)},m.prototype.enterKey=function(g){return this._reporterState.path.push(g)},m.prototype.exitKey=function(g){var _=this._reporterState;_.path=_.path.slice(0,g-1)},m.prototype.leaveKey=function(g,_,E){var b=this._reporterState;this.exitKey(g),b.obj!==null&&(b.obj[_]=E)},m.prototype.path=function(){return this._reporterState.path.join("/")},m.prototype.enterObject=function(){var g=this._reporterState,_=g.obj;return g.obj={},_},m.prototype.leaveObject=function(g){var _=this._reporterState,E=_.obj;return _.obj=g,E},m.prototype.error=function(g){var _,E=this._reporterState,b=g instanceof v;if(_=b?g:new v(E.path.map(function(p){return"["+JSON.stringify(p)+"]"}).join(""),g.message||g,g.stack),!E.options.partial)throw _;return b||E.errors.push(_),_},m.prototype.wrapResult=function(g){var _=this._reporterState;return _.options.partial?{result:this.isError(g)?null:g,errors:_.errors}:g},h(v,Error),v.prototype.rethrow=function(g){if(this.message=g+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,v),!this.stack)try{throw new Error(this.message)}catch(_){this.stack=_.stack}return this}},2007:(a,l)=>{function r(h){var m={};return Object.keys(h).forEach(function(v){(0|v)==v&&(v|=0);var g=h[v];m[g]=v}),m}l.tagClass={0:"universal",1:"application",2:"context",3:"private"},l.tagClassByName=r(l.tagClass),l.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},l.tagByName=r(l.tag)},4319:(a,l,r)=>{var h=l;h._reverse=function(m){var v={};return Object.keys(m).forEach(function(g){(0|g)==g&&(g|=0);var _=m[g];v[_]=g}),v},h.der=r(2007)},4201:(a,l,r)=>{var h=r(376),m=r(815),v=r(4989).C,g=r(3304),_=r(2007);function E(y){this.enc="der",this.name=y.name,this.entity=y,this.tree=new b,this.tree._init(y.body)}function b(y){g.call(this,"der",y)}function p(y,f){var w=y.readUInt8(f);if(y.isError(w))return w;var A=_.tagClass[w>>6],P=(32&w)==0;if((31&w)==31){var T=w;for(w=0;(128&T)==128;){if(T=y.readUInt8(f),y.isError(T))return T;w<<=7,w|=127&T}}else w&=31;return{cls:A,primitive:P,tag:w,tagStr:_.tag[w]}}function x(y,f,w){var A=y.readUInt8(w);if(y.isError(A))return A;if(!f&&A===128)return null;if(!(128&A))return A;var P=127&A;if(P>4)return y.error("length octect is too long");A=0;for(var T=0;T<P;T++){A<<=8;var R=y.readUInt8(w);if(y.isError(R))return R;A|=R}return A}a.exports=E,E.prototype.decode=function(y,f){return v.isDecoderBuffer(y)||(y=new v(y,f)),this.tree._decode(y,f)},h(b,g),b.prototype._peekTag=function(y,f,w){if(y.isEmpty())return!1;var A=y.save(),P=p(y,'Failed to peek tag: "'+f+'"');return y.isError(P)?P:(y.restore(A),P.tag===f||P.tagStr===f||P.tagStr+"of"===f||w)},b.prototype._decodeTag=function(y,f,w){var A=p(y,'Failed to decode tag of "'+f+'"');if(y.isError(A))return A;var P=x(y,A.primitive,'Failed to get length of "'+f+'"');if(y.isError(P))return P;if(!w&&A.tag!==f&&A.tagStr!==f&&A.tagStr+"of"!==f)return y.error('Failed to match tag: "'+f+'"');if(A.primitive||P!==null)return y.skip(P,'Failed to match body of: "'+f+'"');var T=y.save(),R=this._skipUntilEnd(y,'Failed to skip indefinite length body: "'+this.tag+'"');return y.isError(R)?R:(P=y.offset-T.offset,y.restore(T),y.skip(P,'Failed to match body of: "'+f+'"'))},b.prototype._skipUntilEnd=function(y,f){for(;;){var w=p(y,f);if(y.isError(w))return w;var A=x(y,w.primitive,f);if(y.isError(A))return A;var P;if(P=w.primitive||A!==null?y.skip(A):this._skipUntilEnd(y,f),y.isError(P))return P;if(w.tagStr==="end")break}},b.prototype._decodeList=function(y,f,w,A){for(var P=[];!y.isEmpty();){var T=this._peekTag(y,"end");if(y.isError(T))return T;var R=w.decode(y,"der",A);if(y.isError(R)&&T)break;P.push(R)}return P},b.prototype._decodeStr=function(y,f){if(f==="bitstr"){var w=y.readUInt8();return y.isError(w)?w:{unused:w,data:y.raw()}}if(f==="bmpstr"){var A=y.raw();if(A.length%2==1)return y.error("Decoding of string type: bmpstr length mismatch");for(var P="",T=0;T<A.length/2;T++)P+=String.fromCharCode(A.readUInt16BE(2*T));return P}if(f==="numstr"){var R=y.raw().toString("ascii");return this._isNumstr(R)?R:y.error("Decoding of string type: numstr unsupported characters")}if(f==="octstr"||f==="objDesc")return y.raw();if(f==="printstr"){var M=y.raw().toString("ascii");return this._isPrintstr(M)?M:y.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(f)?y.raw().toString():y.error("Decoding of string type: "+f+" unsupported")},b.prototype._decodeObjid=function(y,f,w){for(var A,P=[],T=0,R=0;!y.isEmpty();)T<<=7,T|=127&(R=y.readUInt8()),!(128&R)&&(P.push(T),T=0);128&R&&P.push(T);var M=P[0]/40|0,L=P[0]%40;if(A=w?P:[M,L].concat(P.slice(1)),f){var W=f[A.join(" ")];W===void 0&&(W=f[A.join(".")]),W!==void 0&&(A=W)}return A},b.prototype._decodeTime=function(y,f){var w,A,P,T,R,M,L=y.raw().toString();if(f==="gentime")w=0|L.slice(0,4),A=0|L.slice(4,6),P=0|L.slice(6,8),T=0|L.slice(8,10),R=0|L.slice(10,12),M=0|L.slice(12,14);else{if(f!=="utctime")return y.error("Decoding "+f+" time is not supported yet");w=0|L.slice(0,2),A=0|L.slice(2,4),P=0|L.slice(4,6),T=0|L.slice(6,8),R=0|L.slice(8,10),M=0|L.slice(10,12),w=w<70?2e3+w:1900+w}return Date.UTC(w,A-1,P,T,R,M,0)},b.prototype._decodeNull=function(){return null},b.prototype._decodeBool=function(y){var f=y.readUInt8();return y.isError(f)?f:f!==0},b.prototype._decodeInt=function(y,f){var w=y.raw(),A=new m(w);return f&&(A=f[A.toString(10)]||A),A},b.prototype._use=function(y,f){return typeof y=="function"&&(y=y(f)),y._getDecoder("der").tree}},4049:(a,l,r)=>{var h=l;h.der=r(4201),h.pem=r(618)},618:(a,l,r)=>{var h=r(376),m=r(8723).Buffer,v=r(4201);function g(_){v.call(this,_),this.enc="pem"}h(g,v),a.exports=g,g.prototype.decode=function(_,E){for(var b=_.toString().split(/[\r\n]+/g),p=E.label.toUpperCase(),x=/^-----(BEGIN|END) ([^-]+)-----$/,y=-1,f=-1,w=0;w<b.length;w++){var A=b[w].match(x);if(A!==null&&A[2]===p){if(y!==-1){if(A[1]!=="END")break;f=w;break}if(A[1]!=="BEGIN")break;y=w}}if(y===-1||f===-1)throw new Error("PEM section not found for: "+p);var P=b.slice(y+1,f).join("");P.replace(/[^a-z0-9+/=]+/gi,"");var T=m.from(P,"base64");return v.prototype.decode.call(this,T,E)}},1889:(a,l,r)=>{var h=r(376),m=r(8723).Buffer,v=r(3304),g=r(2007);function _(p){this.enc="der",this.name=p.name,this.entity=p,this.tree=new E,this.tree._init(p.body)}function E(p){v.call(this,"der",p)}function b(p){return p<10?"0"+p:p}a.exports=_,_.prototype.encode=function(p,x){return this.tree._encode(p,x).join()},h(E,v),E.prototype._encodeComposite=function(p,x,y,f){var w=function(W,G,re,Q){var oe;if(W==="seqof"?W="seq":W==="setof"&&(W="set"),g.tagByName.hasOwnProperty(W))oe=g.tagByName[W];else{if(typeof W!="number"||(0|W)!==W)return Q.error("Unknown tag: "+W);oe=W}return oe>=31?Q.error("Multi-octet tag encoding unsupported"):(G||(oe|=32),oe|=g.tagClassByName[re||"universal"]<<6)}(p,x,y,this.reporter);if(f.length<128){var A=m.alloc(2);return A[0]=w,A[1]=f.length,this._createEncoderBuffer([A,f])}for(var P=1,T=f.length;T>=256;T>>=8)P++;var R=m.alloc(2+P);R[0]=w,R[1]=128|P;for(var M=1+P,L=f.length;L>0;M--,L>>=8)R[M]=255&L;return this._createEncoderBuffer([R,f])},E.prototype._encodeStr=function(p,x){if(x==="bitstr")return this._createEncoderBuffer([0|p.unused,p.data]);if(x==="bmpstr"){for(var y=m.alloc(2*p.length),f=0;f<p.length;f++)y.writeUInt16BE(p.charCodeAt(f),2*f);return this._createEncoderBuffer(y)}return x==="numstr"?this._isNumstr(p)?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: numstr supports only digits and space"):x==="printstr"?this._isPrintstr(p)?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(x)||x==="objDesc"?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: "+x+" unsupported")},E.prototype._encodeObjid=function(p,x,y){if(typeof p=="string"){if(!x)return this.reporter.error("string objid given, but no values map found");if(!x.hasOwnProperty(p))return this.reporter.error("objid not found in values map");p=x[p].split(/[\s.]+/g);for(var f=0;f<p.length;f++)p[f]|=0}else if(Array.isArray(p)){p=p.slice();for(var w=0;w<p.length;w++)p[w]|=0}if(!Array.isArray(p))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(p));if(!y){if(p[1]>=40)return this.reporter.error("Second objid identifier OOB");p.splice(0,2,40*p[0]+p[1])}for(var A=0,P=0;P<p.length;P++){var T=p[P];for(A++;T>=128;T>>=7)A++}for(var R=m.alloc(A),M=R.length-1,L=p.length-1;L>=0;L--){var W=p[L];for(R[M--]=127&W;(W>>=7)>0;)R[M--]=128|127&W}return this._createEncoderBuffer(R)},E.prototype._encodeTime=function(p,x){var y,f=new Date(p);return x==="gentime"?y=[b(f.getUTCFullYear()),b(f.getUTCMonth()+1),b(f.getUTCDate()),b(f.getUTCHours()),b(f.getUTCMinutes()),b(f.getUTCSeconds()),"Z"].join(""):x==="utctime"?y=[b(f.getUTCFullYear()%100),b(f.getUTCMonth()+1),b(f.getUTCDate()),b(f.getUTCHours()),b(f.getUTCMinutes()),b(f.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+x+" time is not supported yet"),this._encodeStr(y,"octstr")},E.prototype._encodeNull=function(){return this._createEncoderBuffer("")},E.prototype._encodeInt=function(p,x){if(typeof p=="string"){if(!x)return this.reporter.error("String int or enum given, but no values map");if(!x.hasOwnProperty(p))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(p));p=x[p]}if(typeof p!="number"&&!m.isBuffer(p)){var y=p.toArray();!p.sign&&128&y[0]&&y.unshift(0),p=m.from(y)}if(m.isBuffer(p)){var f=p.length;p.length===0&&f++;var w=m.alloc(f);return p.copy(w),p.length===0&&(w[0]=0),this._createEncoderBuffer(w)}if(p<128)return this._createEncoderBuffer(p);if(p<256)return this._createEncoderBuffer([0,p]);for(var A=1,P=p;P>=256;P>>=8)A++;for(var T=new Array(A),R=T.length-1;R>=0;R--)T[R]=255&p,p>>=8;return 128&T[0]&&T.unshift(0),this._createEncoderBuffer(m.from(T))},E.prototype._encodeBool=function(p){return this._createEncoderBuffer(p?255:0)},E.prototype._use=function(p,x){return typeof p=="function"&&(p=p(x)),p._getEncoder("der").tree},E.prototype._skipDefault=function(p,x,y){var f,w=this._baseState;if(w.default===null)return!1;var A=p.join();if(w.defaultBuffer===void 0&&(w.defaultBuffer=this._encodeValue(w.default,x,y).join()),A.length!==w.defaultBuffer.length)return!1;for(f=0;f<A.length;f++)if(A[f]!==w.defaultBuffer[f])return!1;return!0}},6860:(a,l,r)=>{var h=l;h.der=r(1889),h.pem=r(1610)},1610:(a,l,r)=>{var h=r(376),m=r(1889);function v(g){m.call(this,g),this.enc="pem"}h(v,m),a.exports=v,v.prototype.encode=function(g,_){for(var E=m.prototype.encode.call(this,g).toString("base64"),b=["-----BEGIN "+_.label+"-----"],p=0;p<E.length;p+=64)b.push(E.slice(p,p+64));return b.push("-----END "+_.label+"-----"),b.join(`
`)}},9373:(a,l,r)=>{function h(Y){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(fe){return typeof fe}:function(fe){return fe&&typeof Symbol=="function"&&fe.constructor===Symbol&&fe!==Symbol.prototype?"symbol":typeof fe},h(Y)}function m(Y){return m=typeof Symbol=="function"&&h(Symbol.iterator)==="symbol"?function(fe){return h(fe)}:function(fe){return fe&&typeof Symbol=="function"&&fe.constructor===Symbol&&fe!==Symbol.prototype?"symbol":h(fe)},m(Y)}var v,g,_=r(9978).codes,E=_.ERR_AMBIGUOUS_ARGUMENT,b=_.ERR_INVALID_ARG_TYPE,p=_.ERR_INVALID_ARG_VALUE,x=_.ERR_INVALID_RETURN_VALUE,y=_.ERR_MISSING_ARGS,f=r(1935),w=r(8751).inspect,A=r(8751).types,P=A.isPromise,T=A.isRegExp,R=Object.assign?Object.assign:r(8028).assign,M=Object.is?Object.is:r(4710);function L(){var Y=r(9015);v=Y.isDeepEqual,g=Y.isDeepStrictEqual}var W=!1,G=a.exports=ae,re={};function Q(Y){throw Y.message instanceof Error?Y.message:new f(Y)}function oe(Y,fe,Re,Oe){if(!Re){var De=!1;if(fe===0)De=!0,Oe="No value argument passed to `assert.ok()`";else if(Oe instanceof Error)throw Oe;var ot=new f({actual:Re,expected:!0,message:Oe,operator:"==",stackStartFn:Y});throw ot.generatedMessage=De,ot}}function ae(){for(var Y=arguments.length,fe=new Array(Y),Re=0;Re<Y;Re++)fe[Re]=arguments[Re];oe.apply(void 0,[ae,fe.length].concat(fe))}G.fail=function Y(fe,Re,Oe,De,ot){var X,ee=arguments.length;if(ee===0?X="Failed":ee===1?(Oe=fe,fe=void 0):(W===!1&&(W=!0,({env:{}}.emitWarning?{env:{}}.emitWarning:console.warn.bind(console))("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")),ee===2&&(De="!=")),Oe instanceof Error)throw Oe;var Le={actual:fe,expected:Re,operator:De===void 0?"fail":De,stackStartFn:ot||Y};Oe!==void 0&&(Le.message=Oe);var Be=new f(Le);throw X&&(Be.message=X,Be.generatedMessage=!0),Be},G.AssertionError=f,G.ok=ae,G.equal=function Y(fe,Re,Oe){if(arguments.length<2)throw new y("actual","expected");fe!=Re&&Q({actual:fe,expected:Re,message:Oe,operator:"==",stackStartFn:Y})},G.notEqual=function Y(fe,Re,Oe){if(arguments.length<2)throw new y("actual","expected");fe==Re&&Q({actual:fe,expected:Re,message:Oe,operator:"!=",stackStartFn:Y})},G.deepEqual=function Y(fe,Re,Oe){if(arguments.length<2)throw new y("actual","expected");v===void 0&&L(),v(fe,Re)||Q({actual:fe,expected:Re,message:Oe,operator:"deepEqual",stackStartFn:Y})},G.notDeepEqual=function Y(fe,Re,Oe){if(arguments.length<2)throw new y("actual","expected");v===void 0&&L(),v(fe,Re)&&Q({actual:fe,expected:Re,message:Oe,operator:"notDeepEqual",stackStartFn:Y})},G.deepStrictEqual=function Y(fe,Re,Oe){if(arguments.length<2)throw new y("actual","expected");v===void 0&&L(),g(fe,Re)||Q({actual:fe,expected:Re,message:Oe,operator:"deepStrictEqual",stackStartFn:Y})},G.notDeepStrictEqual=function Y(fe,Re,Oe){if(arguments.length<2)throw new y("actual","expected");v===void 0&&L(),g(fe,Re)&&Q({actual:fe,expected:Re,message:Oe,operator:"notDeepStrictEqual",stackStartFn:Y})},G.strictEqual=function Y(fe,Re,Oe){if(arguments.length<2)throw new y("actual","expected");M(fe,Re)||Q({actual:fe,expected:Re,message:Oe,operator:"strictEqual",stackStartFn:Y})},G.notStrictEqual=function Y(fe,Re,Oe){if(arguments.length<2)throw new y("actual","expected");M(fe,Re)&&Q({actual:fe,expected:Re,message:Oe,operator:"notStrictEqual",stackStartFn:Y})};var de=function Y(fe,Re,Oe){var De=this;(function(ot,X){if(!(ot instanceof X))throw new TypeError("Cannot call a class as a function")})(this,Y),Re.forEach(function(ot){ot in fe&&(Oe!==void 0&&typeof Oe[ot]=="string"&&T(fe[ot])&&fe[ot].test(Oe[ot])?De[ot]=Oe[ot]:De[ot]=fe[ot])})};function be(Y,fe,Re,Oe){if(typeof fe!="function"){if(T(fe))return fe.test(Y);if(arguments.length===2)throw new b("expected",["Function","RegExp"],fe);if(m(Y)!=="object"||Y===null){var De=new f({actual:Y,expected:fe,message:Re,operator:"deepStrictEqual",stackStartFn:Oe});throw De.operator=Oe.name,De}var ot=Object.keys(fe);if(fe instanceof Error)ot.push("name","message");else if(ot.length===0)throw new p("error",fe,"may not be an empty object");return v===void 0&&L(),ot.forEach(function(X){typeof Y[X]=="string"&&T(fe[X])&&fe[X].test(Y[X])||function(ee,Le,Be,se,_e,te){if(!(Be in ee)||!g(ee[Be],Le[Be])){if(!se){var $e=new de(ee,_e),ge=new de(Le,_e,ee),le=new f({actual:$e,expected:ge,operator:"deepStrictEqual",stackStartFn:te});throw le.actual=ee,le.expected=Le,le.operator=te.name,le}Q({actual:ee,expected:Le,message:se,operator:te.name,stackStartFn:te})}}(Y,fe,X,Re,ot,Oe)}),!0}return fe.prototype!==void 0&&Y instanceof fe||!Error.isPrototypeOf(fe)&&fe.call({},Y)===!0}function pe(Y){if(typeof Y!="function")throw new b("fn","Function",Y);try{Y()}catch(fe){return fe}return re}function U(Y){return P(Y)||Y!==null&&m(Y)==="object"&&typeof Y.then=="function"&&typeof Y.catch=="function"}function B(Y){return Promise.resolve().then(function(){var fe;if(typeof Y=="function"){if(!U(fe=Y()))throw new x("instance of Promise","promiseFn",fe)}else{if(!U(Y))throw new b("promiseFn",["Function","Promise"],Y);fe=Y}return Promise.resolve().then(function(){return fe}).then(function(){return re}).catch(function(Re){return Re})})}function N(Y,fe,Re,Oe){if(typeof Re=="string"){if(arguments.length===4)throw new b("error",["Object","Error","Function","RegExp"],Re);if(m(fe)==="object"&&fe!==null){if(fe.message===Re)throw new E("error/message",'The error message "'.concat(fe.message,'" is identical to the message.'))}else if(fe===Re)throw new E("error/message",'The error "'.concat(fe,'" is identical to the message.'));Oe=Re,Re=void 0}else if(Re!=null&&m(Re)!=="object"&&typeof Re!="function")throw new b("error",["Object","Error","Function","RegExp"],Re);if(fe===re){var De="";Re&&Re.name&&(De+=" (".concat(Re.name,")")),De+=Oe?": ".concat(Oe):".";var ot=Y.name==="rejects"?"rejection":"exception";Q({actual:void 0,expected:Re,operator:Y.name,message:"Missing expected ".concat(ot).concat(De),stackStartFn:Y})}if(Re&&!be(fe,Re,Oe,Y))throw fe}function z(Y,fe,Re,Oe){if(fe!==re){if(typeof Re=="string"&&(Oe=Re,Re=void 0),!Re||be(fe,Re)){var De=Oe?": ".concat(Oe):".",ot=Y.name==="doesNotReject"?"rejection":"exception";Q({actual:fe,expected:Re,operator:Y.name,message:"Got unwanted ".concat(ot).concat(De,`
`)+'Actual message: "'.concat(fe&&fe.message,'"'),stackStartFn:Y})}throw fe}}function H(){for(var Y=arguments.length,fe=new Array(Y),Re=0;Re<Y;Re++)fe[Re]=arguments[Re];oe.apply(void 0,[H,fe.length].concat(fe))}G.throws=function Y(fe){for(var Re=arguments.length,Oe=new Array(Re>1?Re-1:0),De=1;De<Re;De++)Oe[De-1]=arguments[De];N.apply(void 0,[Y,pe(fe)].concat(Oe))},G.rejects=function Y(fe){for(var Re=arguments.length,Oe=new Array(Re>1?Re-1:0),De=1;De<Re;De++)Oe[De-1]=arguments[De];return B(fe).then(function(ot){return N.apply(void 0,[Y,ot].concat(Oe))})},G.doesNotThrow=function Y(fe){for(var Re=arguments.length,Oe=new Array(Re>1?Re-1:0),De=1;De<Re;De++)Oe[De-1]=arguments[De];z.apply(void 0,[Y,pe(fe)].concat(Oe))},G.doesNotReject=function Y(fe){for(var Re=arguments.length,Oe=new Array(Re>1?Re-1:0),De=1;De<Re;De++)Oe[De-1]=arguments[De];return B(fe).then(function(ot){return z.apply(void 0,[Y,ot].concat(Oe))})},G.ifError=function Y(fe){if(fe!=null){var Re="ifError got unwanted exception: ";m(fe)==="object"&&typeof fe.message=="string"?fe.message.length===0&&fe.constructor?Re+=fe.constructor.name:Re+=fe.message:Re+=w(fe);var Oe=new f({actual:fe,expected:null,operator:"ifError",message:Re,stackStartFn:Y}),De=fe.stack;if(typeof De=="string"){var ot=De.split(`
`);ot.shift();for(var X=Oe.stack.split(`
`),ee=0;ee<ot.length;ee++){var Le=X.indexOf(ot[ee]);if(Le!==-1){X=X.slice(0,Le);break}}Oe.stack="".concat(X.join(`
`),`
`).concat(ot.join(`
`))}throw Oe}},G.strict=R(H,G,{equal:G.strictEqual,deepEqual:G.deepStrictEqual,notEqual:G.notStrictEqual,notDeepEqual:G.notDeepStrictEqual}),G.strict.strict=G.strict},1935:(a,l,r)=>{function h(Q){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(oe){return typeof oe}:function(oe){return oe&&typeof Symbol=="function"&&oe.constructor===Symbol&&oe!==Symbol.prototype?"symbol":typeof oe},h(Q)}function m(Q,oe,ae){return oe in Q?Object.defineProperty(Q,oe,{value:ae,enumerable:!0,configurable:!0,writable:!0}):Q[oe]=ae,Q}function v(Q,oe){for(var ae=0;ae<oe.length;ae++){var de=oe[ae];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(Q,de.key,de)}}function g(Q,oe){return!oe||y(oe)!=="object"&&typeof oe!="function"?_(Q):oe}function _(Q){if(Q===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Q}function E(Q){var oe=typeof Map=="function"?new Map:void 0;return E=function(ae){if(ae===null||(de=ae,Function.toString.call(de).indexOf("[native code]")===-1))return ae;var de;if(typeof ae!="function")throw new TypeError("Super expression must either be null or a function");if(oe!==void 0){if(oe.has(ae))return oe.get(ae);oe.set(ae,be)}function be(){return b(ae,arguments,x(this).constructor)}return be.prototype=Object.create(ae.prototype,{constructor:{value:be,enumerable:!1,writable:!0,configurable:!0}}),p(be,ae)},E(Q)}function b(Q,oe,ae){return b=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}()?Reflect.construct:function(de,be,pe){var U=[null];U.push.apply(U,be);var B=new(Function.bind.apply(de,U));return pe&&p(B,pe.prototype),B},b.apply(null,arguments)}function p(Q,oe){return p=Object.setPrototypeOf||function(ae,de){return ae.__proto__=de,ae},p(Q,oe)}function x(Q){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(oe){return oe.__proto__||Object.getPrototypeOf(oe)},x(Q)}function y(Q){return y=typeof Symbol=="function"&&h(Symbol.iterator)==="symbol"?function(oe){return h(oe)}:function(oe){return oe&&typeof Symbol=="function"&&oe.constructor===Symbol&&oe!==Symbol.prototype?"symbol":h(oe)},y(Q)}var f=r(8751).inspect,w=r(9978).codes.ERR_INVALID_ARG_TYPE;function A(Q,oe,ae){return(ae===void 0||ae>Q.length)&&(ae=Q.length),Q.substring(ae-oe.length,ae)===oe}var P="",T="",R="",M="",L={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"};function W(Q){var oe=Object.keys(Q),ae=Object.create(Object.getPrototypeOf(Q));return oe.forEach(function(de){ae[de]=Q[de]}),Object.defineProperty(ae,"message",{value:Q.message}),ae}function G(Q){return f(Q,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}var re=function(Q){function oe(be){var pe;if(function(X,ee){if(!(X instanceof ee))throw new TypeError("Cannot call a class as a function")}(this,oe),y(be)!=="object"||be===null)throw new w("options","Object",be);var U=be.message,B=be.operator,N=be.stackStartFn,z=be.actual,H=be.expected,Y=Error.stackTraceLimit;if(Error.stackTraceLimit=0,U!=null)pe=g(this,x(oe).call(this,String(U)));else if({env:{}}.stderr&&{env:{}}.stderr.isTTY&&({env:{}}.stderr&&{env:{}}.stderr.getColorDepth&&{env:{}}.stderr.getColorDepth()!==1?(P="\x1B[34m",T="\x1B[32m",M="\x1B[39m",R="\x1B[31m"):(P="",T="",M="",R="")),y(z)==="object"&&z!==null&&y(H)==="object"&&H!==null&&"stack"in z&&z instanceof Error&&"stack"in H&&H instanceof Error&&(z=W(z),H=W(H)),B==="deepStrictEqual"||B==="strictEqual")pe=g(this,x(oe).call(this,function(X,ee,Le){var Be="",se="",_e=0,te="",$e=!1,ge=G(X),le=ge.split(`
`),ze=G(ee).split(`
`),Je=0,et="";if(Le==="strictEqual"&&y(X)==="object"&&y(ee)==="object"&&X!==null&&ee!==null&&(Le="strictEqualObject"),le.length===1&&ze.length===1&&le[0]!==ze[0]){var ft=le[0].length+ze[0].length;if(ft<=10){if(!(y(X)==="object"&&X!==null||y(ee)==="object"&&ee!==null||X===0&&ee===0))return"".concat(L[Le],`

`)+"".concat(le[0]," !== ").concat(ze[0],`
`)}else if(Le!=="strictEqualObject"&&ft<({env:{}}.stderr&&{env:{}}.stderr.isTTY?{env:{}}.stderr.columns:80)){for(;le[0][Je]===ze[0][Je];)Je++;Je>2&&(et=`
  `.concat(function(rn,dt){if(dt=Math.floor(dt),rn.length==0||dt==0)return"";var qn=rn.length*dt;for(dt=Math.floor(Math.log(dt)/Math.log(2));dt;)rn+=rn,dt--;return rn+rn.substring(0,qn-rn.length)}(" ",Je),"^"),Je=0)}}for(var wt=le[le.length-1],It=ze[ze.length-1];wt===It&&(Je++<2?te=`
  `.concat(wt).concat(te):Be=wt,le.pop(),ze.pop(),le.length!==0&&ze.length!==0);)wt=le[le.length-1],It=ze[ze.length-1];var Ct=Math.max(le.length,ze.length);if(Ct===0){var tn=ge.split(`
`);if(tn.length>30)for(tn[26]="".concat(P,"...").concat(M);tn.length>27;)tn.pop();return"".concat(L.notIdentical,`

`).concat(tn.join(`
`),`
`)}Je>3&&(te=`
`.concat(P,"...").concat(M).concat(te),$e=!0),Be!==""&&(te=`
  `.concat(Be).concat(te),Be="");var xt=0,Ht=L[Le]+`
`.concat(T,"+ actual").concat(M," ").concat(R,"- expected").concat(M),en=" ".concat(P,"...").concat(M," Lines skipped");for(Je=0;Je<Ct;Je++){var kn=Je-_e;if(le.length<Je+1)kn>1&&Je>2&&(kn>4?(se+=`
`.concat(P,"...").concat(M),$e=!0):kn>3&&(se+=`
  `.concat(ze[Je-2]),xt++),se+=`
  `.concat(ze[Je-1]),xt++),_e=Je,Be+=`
`.concat(R,"-").concat(M," ").concat(ze[Je]),xt++;else if(ze.length<Je+1)kn>1&&Je>2&&(kn>4?(se+=`
`.concat(P,"...").concat(M),$e=!0):kn>3&&(se+=`
  `.concat(le[Je-2]),xt++),se+=`
  `.concat(le[Je-1]),xt++),_e=Je,se+=`
`.concat(T,"+").concat(M," ").concat(le[Je]),xt++;else{var Dn=ze[Je],Ft=le[Je],Tt=Ft!==Dn&&(!A(Ft,",")||Ft.slice(0,-1)!==Dn);Tt&&A(Dn,",")&&Dn.slice(0,-1)===Ft&&(Tt=!1,Ft+=","),Tt?(kn>1&&Je>2&&(kn>4?(se+=`
`.concat(P,"...").concat(M),$e=!0):kn>3&&(se+=`
  `.concat(le[Je-2]),xt++),se+=`
  `.concat(le[Je-1]),xt++),_e=Je,se+=`
`.concat(T,"+").concat(M," ").concat(Ft),Be+=`
`.concat(R,"-").concat(M," ").concat(Dn),xt+=2):(se+=Be,Be="",kn!==1&&Je!==0||(se+=`
  `.concat(Ft),xt++))}if(xt>20&&Je<Ct-2)return"".concat(Ht).concat(en,`
`).concat(se,`
`).concat(P,"...").concat(M).concat(Be,`
`)+"".concat(P,"...").concat(M)}return"".concat(Ht).concat($e?en:"",`
`).concat(se).concat(Be).concat(te).concat(et)}(z,H,B)));else if(B==="notDeepStrictEqual"||B==="notStrictEqual"){var fe=L[B],Re=G(z).split(`
`);if(B==="notStrictEqual"&&y(z)==="object"&&z!==null&&(fe=L.notStrictEqualObject),Re.length>30)for(Re[26]="".concat(P,"...").concat(M);Re.length>27;)Re.pop();pe=Re.length===1?g(this,x(oe).call(this,"".concat(fe," ").concat(Re[0]))):g(this,x(oe).call(this,"".concat(fe,`

`).concat(Re.join(`
`),`
`)))}else{var Oe=G(z),De="",ot=L[B];B==="notDeepEqual"||B==="notEqual"?(Oe="".concat(L[B],`

`).concat(Oe)).length>1024&&(Oe="".concat(Oe.slice(0,1021),"...")):(De="".concat(G(H)),Oe.length>512&&(Oe="".concat(Oe.slice(0,509),"...")),De.length>512&&(De="".concat(De.slice(0,509),"...")),B==="deepEqual"||B==="equal"?Oe="".concat(ot,`

`).concat(Oe,`

should equal

`):De=" ".concat(B," ").concat(De)),pe=g(this,x(oe).call(this,"".concat(Oe).concat(De)))}return Error.stackTraceLimit=Y,pe.generatedMessage=!U,Object.defineProperty(_(pe),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),pe.code="ERR_ASSERTION",pe.actual=z,pe.expected=H,pe.operator=B,Error.captureStackTrace&&Error.captureStackTrace(_(pe),N),pe.stack,pe.name="AssertionError",g(pe)}var ae,de;return function(be,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");be.prototype=Object.create(pe&&pe.prototype,{constructor:{value:be,writable:!0,configurable:!0}}),pe&&p(be,pe)}(oe,Q),ae=oe,de=[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:f.custom,value:function(be,pe){return f(this,function(U){for(var B=1;B<arguments.length;B++){var N=arguments[B]!=null?arguments[B]:{},z=Object.keys(N);typeof Object.getOwnPropertySymbols=="function"&&(z=z.concat(Object.getOwnPropertySymbols(N).filter(function(H){return Object.getOwnPropertyDescriptor(N,H).enumerable}))),z.forEach(function(H){m(U,H,N[H])})}return U}({},pe,{customInspect:!1,depth:0}))}}],de&&v(ae.prototype,de),oe}(E(Error));a.exports=re},9978:(a,l,r)=>{function h(y){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},h(y)}function m(y){return m=typeof Symbol=="function"&&h(Symbol.iterator)==="symbol"?function(f){return h(f)}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":h(f)},m(y)}function v(y){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)},v(y)}function g(y,f){return g=Object.setPrototypeOf||function(w,A){return w.__proto__=A,w},g(y,f)}var _,E,b={};function p(y,f,w){w||(w=Error);var A=function(P){function T(R,M,L){var W;return function(G,re){if(!(G instanceof re))throw new TypeError("Cannot call a class as a function")}(this,T),W=function(G,re){return!re||m(re)!=="object"&&typeof re!="function"?function(Q){if(Q===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Q}(G):re}(this,v(T).call(this,function(G,re,Q){return typeof f=="string"?f:f(G,re,Q)}(R,M,L))),W.code=y,W}return function(R,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(M&&M.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),M&&g(R,M)}(T,P),T}(w);b[y]=A}function x(y,f){if(Array.isArray(y)){var w=y.length;return y=y.map(function(A){return String(A)}),w>2?"one of ".concat(f," ").concat(y.slice(0,w-1).join(", "),", or ")+y[w-1]:w===2?"one of ".concat(f," ").concat(y[0]," or ").concat(y[1]):"of ".concat(f," ").concat(y[0])}return"of ".concat(f," ").concat(String(y))}p("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),p("ERR_INVALID_ARG_TYPE",function(y,f,w){var A,P,T,R,M;if(_===void 0&&(_=r(9373)),_(typeof y=="string","'name' must be a string"),typeof f=="string"&&(P="not ",f.substr(0,4)===P)?(A="must not be",f=f.replace(/^not /,"")):A="must be",function(W,G,re){return(re===void 0||re>W.length)&&(re=W.length),W.substring(re-9,re)===G}(y," argument"))T="The ".concat(y," ").concat(A," ").concat(x(f,"type"));else{var L=(typeof M!="number"&&(M=0),M+1>(R=y).length||R.indexOf(".",M)===-1?"argument":"property");T='The "'.concat(y,'" ').concat(L," ").concat(A," ").concat(x(f,"type"))}return T+". Received type ".concat(m(w))},TypeError),p("ERR_INVALID_ARG_VALUE",function(y,f){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";E===void 0&&(E=r(8751));var A=E.inspect(f);return A.length>128&&(A="".concat(A.slice(0,128),"...")),"The argument '".concat(y,"' ").concat(w,". Received ").concat(A)},TypeError),p("ERR_INVALID_RETURN_VALUE",function(y,f,w){var A;return A=w&&w.constructor&&w.constructor.name?"instance of ".concat(w.constructor.name):"type ".concat(m(w)),"Expected ".concat(y,' to be returned from the "').concat(f,'"')+" function but got ".concat(A,".")},TypeError),p("ERR_MISSING_ARGS",function(){for(var y=arguments.length,f=new Array(y),w=0;w<y;w++)f[w]=arguments[w];_===void 0&&(_=r(9373)),_(f.length>0,"At least one arg needs to be specified");var A="The ",P=f.length;switch(f=f.map(function(T){return'"'.concat(T,'"')}),P){case 1:A+="".concat(f[0]," argument");break;case 2:A+="".concat(f[0]," and ").concat(f[1]," arguments");break;default:A+=f.slice(0,P-1).join(", "),A+=", and ".concat(f[P-1]," arguments")}return"".concat(A," must be specified")},TypeError),a.exports.codes=b},9015:(a,l,r)=>{function h(te){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($e){return typeof $e}:function($e){return $e&&typeof Symbol=="function"&&$e.constructor===Symbol&&$e!==Symbol.prototype?"symbol":typeof $e},h(te)}function m(te,$e){return function(ge){if(Array.isArray(ge))return ge}(te)||function(ge,le){var ze=[],Je=!0,et=!1,ft=void 0;try{for(var wt,It=ge[Symbol.iterator]();!(Je=(wt=It.next()).done)&&(ze.push(wt.value),!le||ze.length!==le);Je=!0);}catch(Ct){et=!0,ft=Ct}finally{try{Je||It.return==null||It.return()}finally{if(et)throw ft}}return ze}(te,$e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(te){return v=typeof Symbol=="function"&&h(Symbol.iterator)==="symbol"?function($e){return h($e)}:function($e){return $e&&typeof Symbol=="function"&&$e.constructor===Symbol&&$e!==Symbol.prototype?"symbol":h($e)},v(te)}var g=/a/g.flags!==void 0,_=function(te){var $e=[];return te.forEach(function(ge){return $e.push(ge)}),$e},E=function(te){var $e=[];return te.forEach(function(ge,le){return $e.push([le,ge])}),$e},b=Object.is?Object.is:r(4710),p=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},x=Number.isNaN?Number.isNaN:r(2191);function y(te){return te.call.bind(te)}var f=y(Object.prototype.hasOwnProperty),w=y(Object.prototype.propertyIsEnumerable),A=y(Object.prototype.toString),P=r(8751).types,T=P.isAnyArrayBuffer,R=P.isArrayBufferView,M=P.isDate,L=P.isMap,W=P.isRegExp,G=P.isSet,re=P.isNativeError,Q=P.isBoxedPrimitive,oe=P.isNumberObject,ae=P.isStringObject,de=P.isBooleanObject,be=P.isBigIntObject,pe=P.isSymbolObject,U=P.isFloat32Array,B=P.isFloat64Array;function N(te){if(te.length===0||te.length>10)return!0;for(var $e=0;$e<te.length;$e++){var ge=te.charCodeAt($e);if(ge<48||ge>57)return!0}return te.length===10&&te>=Math.pow(2,32)}function z(te){return Object.keys(te).filter(N).concat(p(te).filter(Object.prototype.propertyIsEnumerable.bind(te)))}function H(te,$e){if(te===$e)return 0;for(var ge=te.length,le=$e.length,ze=0,Je=Math.min(ge,le);ze<Je;++ze)if(te[ze]!==$e[ze]){ge=te[ze],le=$e[ze];break}return ge<le?-1:le<ge?1:0}var Y=0,fe=1,Re=2,Oe=3;function De(te,$e,ge,le){if(te===$e)return te!==0||!ge||b(te,$e);if(ge){if(v(te)!=="object")return typeof te=="number"&&x(te)&&x($e);if(v($e)!=="object"||te===null||$e===null||Object.getPrototypeOf(te)!==Object.getPrototypeOf($e))return!1}else{if(te===null||v(te)!=="object")return($e===null||v($e)!=="object")&&te==$e;if($e===null||v($e)!=="object")return!1}var ze,Je,et,ft,wt=A(te);if(wt!==A($e))return!1;if(Array.isArray(te)){if(te.length!==$e.length)return!1;var It=z(te),Ct=z($e);return It.length===Ct.length&&X(te,$e,ge,le,fe,It)}if(wt==="[object Object]"&&(!L(te)&&L($e)||!G(te)&&G($e)))return!1;if(M(te)){if(!M($e)||Date.prototype.getTime.call(te)!==Date.prototype.getTime.call($e))return!1}else if(W(te)){if(!W($e)||(et=te,ft=$e,!(g?et.source===ft.source&&et.flags===ft.flags:RegExp.prototype.toString.call(et)===RegExp.prototype.toString.call(ft))))return!1}else if(re(te)||te instanceof Error){if(te.message!==$e.message||te.name!==$e.name)return!1}else{if(R(te)){if(ge||!U(te)&&!B(te)){if(!function(Ht,en){return Ht.byteLength===en.byteLength&&H(new Uint8Array(Ht.buffer,Ht.byteOffset,Ht.byteLength),new Uint8Array(en.buffer,en.byteOffset,en.byteLength))===0}(te,$e))return!1}else if(!function(Ht,en){if(Ht.byteLength!==en.byteLength)return!1;for(var kn=0;kn<Ht.byteLength;kn++)if(Ht[kn]!==en[kn])return!1;return!0}(te,$e))return!1;var tn=z(te),xt=z($e);return tn.length===xt.length&&X(te,$e,ge,le,Y,tn)}if(G(te))return!(!G($e)||te.size!==$e.size)&&X(te,$e,ge,le,Re);if(L(te))return!(!L($e)||te.size!==$e.size)&&X(te,$e,ge,le,Oe);if(T(te)){if(Je=$e,(ze=te).byteLength!==Je.byteLength||H(new Uint8Array(ze),new Uint8Array(Je))!==0)return!1}else if(Q(te)&&!function(Ht,en){return oe(Ht)?oe(en)&&b(Number.prototype.valueOf.call(Ht),Number.prototype.valueOf.call(en)):ae(Ht)?ae(en)&&String.prototype.valueOf.call(Ht)===String.prototype.valueOf.call(en):de(Ht)?de(en)&&Boolean.prototype.valueOf.call(Ht)===Boolean.prototype.valueOf.call(en):be(Ht)?be(en)&&BigInt.prototype.valueOf.call(Ht)===BigInt.prototype.valueOf.call(en):pe(en)&&Symbol.prototype.valueOf.call(Ht)===Symbol.prototype.valueOf.call(en)}(te,$e))return!1}return X(te,$e,ge,le,Y)}function ot(te,$e){return $e.filter(function(ge){return w(te,ge)})}function X(te,$e,ge,le,ze,Je){if(arguments.length===5){Je=Object.keys(te);var et=Object.keys($e);if(Je.length!==et.length)return!1}for(var ft=0;ft<Je.length;ft++)if(!f($e,Je[ft]))return!1;if(ge&&arguments.length===5){var wt=p(te);if(wt.length!==0){var It=0;for(ft=0;ft<wt.length;ft++){var Ct=wt[ft];if(w(te,Ct)){if(!w($e,Ct))return!1;Je.push(Ct),It++}else if(w($e,Ct))return!1}var tn=p($e);if(wt.length!==tn.length&&ot($e,tn).length!==It)return!1}else{var xt=p($e);if(xt.length!==0&&ot($e,xt).length!==0)return!1}}if(Je.length===0&&(ze===Y||ze===fe&&te.length===0||te.size===0))return!0;if(le===void 0)le={val1:new Map,val2:new Map,position:0};else{var Ht=le.val1.get(te);if(Ht!==void 0){var en=le.val2.get($e);if(en!==void 0)return Ht===en}le.position++}le.val1.set(te,le.position),le.val2.set($e,le.position);var kn=function(Dn,Ft,Tt,rn,dt,qn){var fn=0;if(qn===Re){if(!function(Ae,ve,he,me){for(var we=null,je=_(Ae),qe=0;qe<je.length;qe++){var Fe=je[qe];if(v(Fe)==="object"&&Fe!==null)we===null&&(we=new Set),we.add(Fe);else if(!ve.has(Fe)){if(he||!Be(Ae,ve,Fe))return!1;we===null&&(we=new Set),we.add(Fe)}}if(we!==null){for(var Xe=_(ve),Ge=0;Ge<Xe.length;Ge++){var rt=Xe[Ge];if(v(rt)==="object"&&rt!==null){if(!ee(we,rt,he,me))return!1}else if(!he&&!Ae.has(rt)&&!ee(we,rt,he,me))return!1}return we.size===0}return!0}(Dn,Ft,Tt,dt))return!1}else if(qn===Oe){if(!function(Ae,ve,he,me){for(var we=null,je=E(Ae),qe=0;qe<je.length;qe++){var Fe=m(je[qe],2),Xe=Fe[0],Ge=Fe[1];if(v(Xe)==="object"&&Xe!==null)we===null&&(we=new Set),we.add(Xe);else{var rt=ve.get(Xe);if(rt===void 0&&!ve.has(Xe)||!De(Ge,rt,he,me)){if(he||!se(Ae,ve,Xe,Ge,me))return!1;we===null&&(we=new Set),we.add(Xe)}}}if(we!==null){for(var bt=E(ve),at=0;at<bt.length;at++){var Et=m(bt[at],2),jt=(Xe=Et[0],Et[1]);if(v(Xe)==="object"&&Xe!==null){if(!_e(we,Ae,Xe,jt,he,me))return!1}else if(!(he||Ae.has(Xe)&&De(Ae.get(Xe),jt,!1,me)||_e(we,Ae,Xe,jt,!1,me)))return!1}return we.size===0}return!0}(Dn,Ft,Tt,dt))return!1}else if(qn===fe)for(;fn<Dn.length;fn++){if(!f(Dn,fn)){if(f(Ft,fn))return!1;for(var dr=Object.keys(Dn);fn<dr.length;fn++){var Xn=dr[fn];if(!f(Ft,Xn)||!De(Dn[Xn],Ft[Xn],Tt,dt))return!1}return dr.length===Object.keys(Ft).length}if(!f(Ft,fn)||!De(Dn[fn],Ft[fn],Tt,dt))return!1}for(fn=0;fn<rn.length;fn++){var Ir=rn[fn];if(!De(Dn[Ir],Ft[Ir],Tt,dt))return!1}return!0}(te,$e,ge,Je,le,ze);return le.val1.delete(te),le.val2.delete($e),kn}function ee(te,$e,ge,le){for(var ze=_(te),Je=0;Je<ze.length;Je++){var et=ze[Je];if(De($e,et,ge,le))return te.delete(et),!0}return!1}function Le(te){switch(v(te)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":te=+te;case"number":if(x(te))return!1}return!0}function Be(te,$e,ge){var le=Le(ge);return le??($e.has(le)&&!te.has(le))}function se(te,$e,ge,le,ze){var Je=Le(ge);if(Je!=null)return Je;var et=$e.get(Je);return!(et===void 0&&!$e.has(Je)||!De(le,et,!1,ze))&&!te.has(Je)&&De(le,et,!1,ze)}function _e(te,$e,ge,le,ze,Je){for(var et=_(te),ft=0;ft<et.length;ft++){var wt=et[ft];if(De(ge,wt,ze,Je)&&De(le,$e.get(wt),ze,Je))return te.delete(wt),!0}return!1}a.exports={isDeepEqual:function(te,$e){return De(te,$e,!1)},isDeepStrictEqual:function(te,$e){return De(te,$e,!0)}}},7943:(a,l)=>{l.byteLength=function(b){var p=_(b),x=p[0],y=p[1];return 3*(x+y)/4-y},l.toByteArray=function(b){var p,x,y=_(b),f=y[0],w=y[1],A=new m(function(R,M,L){return 3*(M+L)/4-L}(0,f,w)),P=0,T=w>0?f-4:f;for(x=0;x<T;x+=4)p=h[b.charCodeAt(x)]<<18|h[b.charCodeAt(x+1)]<<12|h[b.charCodeAt(x+2)]<<6|h[b.charCodeAt(x+3)],A[P++]=p>>16&255,A[P++]=p>>8&255,A[P++]=255&p;return w===2&&(p=h[b.charCodeAt(x)]<<2|h[b.charCodeAt(x+1)]>>4,A[P++]=255&p),w===1&&(p=h[b.charCodeAt(x)]<<10|h[b.charCodeAt(x+1)]<<4|h[b.charCodeAt(x+2)]>>2,A[P++]=p>>8&255,A[P++]=255&p),A},l.fromByteArray=function(b){for(var p,x=b.length,y=x%3,f=[],w=16383,A=0,P=x-y;A<P;A+=w)f.push(E(b,A,A+w>P?P:A+w));return y===1?(p=b[x-1],f.push(r[p>>2]+r[p<<4&63]+"==")):y===2&&(p=(b[x-2]<<8)+b[x-1],f.push(r[p>>10]+r[p>>4&63]+r[p<<2&63]+"=")),f.join("")};for(var r=[],h=[],m=typeof Uint8Array<"u"?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0;g<64;++g)r[g]=v[g],h[v.charCodeAt(g)]=g;function _(b){var p=b.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=b.indexOf("=");return x===-1&&(x=p),[x,x===p?0:4-x%4]}function E(b,p,x){for(var y,f,w=[],A=p;A<x;A+=3)y=(b[A]<<16&16711680)+(b[A+1]<<8&65280)+(255&b[A+2]),w.push(r[(f=y)>>18&63]+r[f>>12&63]+r[f>>6&63]+r[63&f]);return w.join("")}h[45]=62,h[95]=63},815:function(a,l,r){function h(m){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},h(m)}(function(m,v){function g(U,B){if(!U)throw new Error(B||"Assertion failed")}function _(U,B){U.super_=B;var N=function(){};N.prototype=B.prototype,U.prototype=new N,U.prototype.constructor=U}function E(U,B,N){if(E.isBN(U))return U;this.negative=0,this.words=null,this.length=0,this.red=null,U!==null&&(B!=="le"&&B!=="be"||(N=B,B=10),this._init(U||0,B||10,N||"be"))}var b;h(m)==="object"?m.exports=E:v.BN=E,E.BN=E,E.wordSize=26;try{b=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:r(6601).Buffer}catch{}function p(U,B){var N=U.charCodeAt(B);return N>=48&&N<=57?N-48:N>=65&&N<=70?N-55:N>=97&&N<=102?N-87:void g(!1,"Invalid character in "+U)}function x(U,B,N){var z=p(U,N);return N-1>=B&&(z|=p(U,N-1)<<4),z}function y(U,B,N,z){for(var H=0,Y=0,fe=Math.min(U.length,N),Re=B;Re<fe;Re++){var Oe=U.charCodeAt(Re)-48;H*=z,Y=Oe>=49?Oe-49+10:Oe>=17?Oe-17+10:Oe,g(Oe>=0&&Y<z,"Invalid character"),H+=Y}return H}function f(U,B){U.words=B.words,U.length=B.length,U.negative=B.negative,U.red=B.red}if(E.isBN=function(U){return U instanceof E||U!==null&&h(U)==="object"&&U.constructor.wordSize===E.wordSize&&Array.isArray(U.words)},E.max=function(U,B){return U.cmp(B)>0?U:B},E.min=function(U,B){return U.cmp(B)<0?U:B},E.prototype._init=function(U,B,N){if(typeof U=="number")return this._initNumber(U,B,N);if(h(U)==="object")return this._initArray(U,B,N);B==="hex"&&(B=16),g(B===(0|B)&&B>=2&&B<=36);var z=0;(U=U.toString().replace(/\s+/g,""))[0]==="-"&&(z++,this.negative=1),z<U.length&&(B===16?this._parseHex(U,z,N):(this._parseBase(U,B,z),N==="le"&&this._initArray(this.toArray(),B,N)))},E.prototype._initNumber=function(U,B,N){U<0&&(this.negative=1,U=-U),U<67108864?(this.words=[67108863&U],this.length=1):U<4503599627370496?(this.words=[67108863&U,U/67108864&67108863],this.length=2):(g(U<9007199254740992),this.words=[67108863&U,U/67108864&67108863,1],this.length=3),N==="le"&&this._initArray(this.toArray(),B,N)},E.prototype._initArray=function(U,B,N){if(g(typeof U.length=="number"),U.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(U.length/3),this.words=new Array(this.length);for(var z=0;z<this.length;z++)this.words[z]=0;var H,Y,fe=0;if(N==="be")for(z=U.length-1,H=0;z>=0;z-=3)Y=U[z]|U[z-1]<<8|U[z-2]<<16,this.words[H]|=Y<<fe&67108863,this.words[H+1]=Y>>>26-fe&67108863,(fe+=24)>=26&&(fe-=26,H++);else if(N==="le")for(z=0,H=0;z<U.length;z+=3)Y=U[z]|U[z+1]<<8|U[z+2]<<16,this.words[H]|=Y<<fe&67108863,this.words[H+1]=Y>>>26-fe&67108863,(fe+=24)>=26&&(fe-=26,H++);return this._strip()},E.prototype._parseHex=function(U,B,N){this.length=Math.ceil((U.length-B)/6),this.words=new Array(this.length);for(var z=0;z<this.length;z++)this.words[z]=0;var H,Y=0,fe=0;if(N==="be")for(z=U.length-1;z>=B;z-=2)H=x(U,B,z)<<Y,this.words[fe]|=67108863&H,Y>=18?(Y-=18,fe+=1,this.words[fe]|=H>>>26):Y+=8;else for(z=(U.length-B)%2==0?B+1:B;z<U.length;z+=2)H=x(U,B,z)<<Y,this.words[fe]|=67108863&H,Y>=18?(Y-=18,fe+=1,this.words[fe]|=H>>>26):Y+=8;this._strip()},E.prototype._parseBase=function(U,B,N){this.words=[0],this.length=1;for(var z=0,H=1;H<=67108863;H*=B)z++;z--,H=H/B|0;for(var Y=U.length-N,fe=Y%z,Re=Math.min(Y,Y-fe)+N,Oe=0,De=N;De<Re;De+=z)Oe=y(U,De,De+z,B),this.imuln(H),this.words[0]+Oe<67108864?this.words[0]+=Oe:this._iaddn(Oe);if(fe!==0){var ot=1;for(Oe=y(U,De,U.length,B),De=0;De<fe;De++)ot*=B;this.imuln(ot),this.words[0]+Oe<67108864?this.words[0]+=Oe:this._iaddn(Oe)}this._strip()},E.prototype.copy=function(U){U.words=new Array(this.length);for(var B=0;B<this.length;B++)U.words[B]=this.words[B];U.length=this.length,U.negative=this.negative,U.red=this.red},E.prototype._move=function(U){f(U,this)},E.prototype.clone=function(){var U=new E(null);return this.copy(U),U},E.prototype._expand=function(U){for(;this.length<U;)this.words[this.length++]=0;return this},E.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},E.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{E.prototype[Symbol.for("nodejs.util.inspect.custom")]=w}catch{E.prototype.inspect=w}else E.prototype.inspect=w;function w(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var A=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],P=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],T=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function R(U,B,N){N.negative=B.negative^U.negative;var z=U.length+B.length|0;N.length=z,z=z-1|0;var H=0|U.words[0],Y=0|B.words[0],fe=H*Y,Re=67108863&fe,Oe=fe/67108864|0;N.words[0]=Re;for(var De=1;De<z;De++){for(var ot=Oe>>>26,X=67108863&Oe,ee=Math.min(De,B.length-1),Le=Math.max(0,De-U.length+1);Le<=ee;Le++){var Be=De-Le|0;ot+=(fe=(H=0|U.words[Be])*(Y=0|B.words[Le])+X)/67108864|0,X=67108863&fe}N.words[De]=0|X,Oe=0|ot}return Oe!==0?N.words[De]=0|Oe:N.length--,N._strip()}E.prototype.toString=function(U,B){var N;if(B=0|B||1,(U=U||10)===16||U==="hex"){N="";for(var z=0,H=0,Y=0;Y<this.length;Y++){var fe=this.words[Y],Re=(16777215&(fe<<z|H)).toString(16);H=fe>>>24-z&16777215,(z+=2)>=26&&(z-=26,Y--),N=H!==0||Y!==this.length-1?A[6-Re.length]+Re+N:Re+N}for(H!==0&&(N=H.toString(16)+N);N.length%B!=0;)N="0"+N;return this.negative!==0&&(N="-"+N),N}if(U===(0|U)&&U>=2&&U<=36){var Oe=P[U],De=T[U];N="";var ot=this.clone();for(ot.negative=0;!ot.isZero();){var X=ot.modrn(De).toString(U);N=(ot=ot.idivn(De)).isZero()?X+N:A[Oe-X.length]+X+N}for(this.isZero()&&(N="0"+N);N.length%B!=0;)N="0"+N;return this.negative!==0&&(N="-"+N),N}g(!1,"Base should be between 2 and 36")},E.prototype.toNumber=function(){var U=this.words[0];return this.length===2?U+=67108864*this.words[1]:this.length===3&&this.words[2]===1?U+=4503599627370496+67108864*this.words[1]:this.length>2&&g(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-U:U},E.prototype.toJSON=function(){return this.toString(16,2)},b&&(E.prototype.toBuffer=function(U,B){return this.toArrayLike(b,U,B)}),E.prototype.toArray=function(U,B){return this.toArrayLike(Array,U,B)},E.prototype.toArrayLike=function(U,B,N){this._strip();var z=this.byteLength(),H=N||Math.max(1,z);g(z<=H,"byte array longer than desired length"),g(H>0,"Requested array length <= 0");var Y=function(fe,Re){return fe.allocUnsafe?fe.allocUnsafe(Re):new fe(Re)}(U,H);return this["_toArrayLike"+(B==="le"?"LE":"BE")](Y,z),Y},E.prototype._toArrayLikeLE=function(U,B){for(var N=0,z=0,H=0,Y=0;H<this.length;H++){var fe=this.words[H]<<Y|z;U[N++]=255&fe,N<U.length&&(U[N++]=fe>>8&255),N<U.length&&(U[N++]=fe>>16&255),Y===6?(N<U.length&&(U[N++]=fe>>24&255),z=0,Y=0):(z=fe>>>24,Y+=2)}if(N<U.length)for(U[N++]=z;N<U.length;)U[N++]=0},E.prototype._toArrayLikeBE=function(U,B){for(var N=U.length-1,z=0,H=0,Y=0;H<this.length;H++){var fe=this.words[H]<<Y|z;U[N--]=255&fe,N>=0&&(U[N--]=fe>>8&255),N>=0&&(U[N--]=fe>>16&255),Y===6?(N>=0&&(U[N--]=fe>>24&255),z=0,Y=0):(z=fe>>>24,Y+=2)}if(N>=0)for(U[N--]=z;N>=0;)U[N--]=0},Math.clz32?E.prototype._countBits=function(U){return 32-Math.clz32(U)}:E.prototype._countBits=function(U){var B=U,N=0;return B>=4096&&(N+=13,B>>>=13),B>=64&&(N+=7,B>>>=7),B>=8&&(N+=4,B>>>=4),B>=2&&(N+=2,B>>>=2),N+B},E.prototype._zeroBits=function(U){if(U===0)return 26;var B=U,N=0;return!(8191&B)&&(N+=13,B>>>=13),!(127&B)&&(N+=7,B>>>=7),!(15&B)&&(N+=4,B>>>=4),!(3&B)&&(N+=2,B>>>=2),!(1&B)&&N++,N},E.prototype.bitLength=function(){var U=this.words[this.length-1],B=this._countBits(U);return 26*(this.length-1)+B},E.prototype.zeroBits=function(){if(this.isZero())return 0;for(var U=0,B=0;B<this.length;B++){var N=this._zeroBits(this.words[B]);if(U+=N,N!==26)break}return U},E.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},E.prototype.toTwos=function(U){return this.negative!==0?this.abs().inotn(U).iaddn(1):this.clone()},E.prototype.fromTwos=function(U){return this.testn(U-1)?this.notn(U).iaddn(1).ineg():this.clone()},E.prototype.isNeg=function(){return this.negative!==0},E.prototype.neg=function(){return this.clone().ineg()},E.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},E.prototype.iuor=function(U){for(;this.length<U.length;)this.words[this.length++]=0;for(var B=0;B<U.length;B++)this.words[B]=this.words[B]|U.words[B];return this._strip()},E.prototype.ior=function(U){return g((this.negative|U.negative)==0),this.iuor(U)},E.prototype.or=function(U){return this.length>U.length?this.clone().ior(U):U.clone().ior(this)},E.prototype.uor=function(U){return this.length>U.length?this.clone().iuor(U):U.clone().iuor(this)},E.prototype.iuand=function(U){var B;B=this.length>U.length?U:this;for(var N=0;N<B.length;N++)this.words[N]=this.words[N]&U.words[N];return this.length=B.length,this._strip()},E.prototype.iand=function(U){return g((this.negative|U.negative)==0),this.iuand(U)},E.prototype.and=function(U){return this.length>U.length?this.clone().iand(U):U.clone().iand(this)},E.prototype.uand=function(U){return this.length>U.length?this.clone().iuand(U):U.clone().iuand(this)},E.prototype.iuxor=function(U){var B,N;this.length>U.length?(B=this,N=U):(B=U,N=this);for(var z=0;z<N.length;z++)this.words[z]=B.words[z]^N.words[z];if(this!==B)for(;z<B.length;z++)this.words[z]=B.words[z];return this.length=B.length,this._strip()},E.prototype.ixor=function(U){return g((this.negative|U.negative)==0),this.iuxor(U)},E.prototype.xor=function(U){return this.length>U.length?this.clone().ixor(U):U.clone().ixor(this)},E.prototype.uxor=function(U){return this.length>U.length?this.clone().iuxor(U):U.clone().iuxor(this)},E.prototype.inotn=function(U){g(typeof U=="number"&&U>=0);var B=0|Math.ceil(U/26),N=U%26;this._expand(B),N>0&&B--;for(var z=0;z<B;z++)this.words[z]=67108863&~this.words[z];return N>0&&(this.words[z]=~this.words[z]&67108863>>26-N),this._strip()},E.prototype.notn=function(U){return this.clone().inotn(U)},E.prototype.setn=function(U,B){g(typeof U=="number"&&U>=0);var N=U/26|0,z=U%26;return this._expand(N+1),this.words[N]=B?this.words[N]|1<<z:this.words[N]&~(1<<z),this._strip()},E.prototype.iadd=function(U){var B,N,z;if(this.negative!==0&&U.negative===0)return this.negative=0,B=this.isub(U),this.negative^=1,this._normSign();if(this.negative===0&&U.negative!==0)return U.negative=0,B=this.isub(U),U.negative=1,B._normSign();this.length>U.length?(N=this,z=U):(N=U,z=this);for(var H=0,Y=0;Y<z.length;Y++)B=(0|N.words[Y])+(0|z.words[Y])+H,this.words[Y]=67108863&B,H=B>>>26;for(;H!==0&&Y<N.length;Y++)B=(0|N.words[Y])+H,this.words[Y]=67108863&B,H=B>>>26;if(this.length=N.length,H!==0)this.words[this.length]=H,this.length++;else if(N!==this)for(;Y<N.length;Y++)this.words[Y]=N.words[Y];return this},E.prototype.add=function(U){var B;return U.negative!==0&&this.negative===0?(U.negative=0,B=this.sub(U),U.negative^=1,B):U.negative===0&&this.negative!==0?(this.negative=0,B=U.sub(this),this.negative=1,B):this.length>U.length?this.clone().iadd(U):U.clone().iadd(this)},E.prototype.isub=function(U){if(U.negative!==0){U.negative=0;var B=this.iadd(U);return U.negative=1,B._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(U),this.negative=1,this._normSign();var N,z,H=this.cmp(U);if(H===0)return this.negative=0,this.length=1,this.words[0]=0,this;H>0?(N=this,z=U):(N=U,z=this);for(var Y=0,fe=0;fe<z.length;fe++)Y=(B=(0|N.words[fe])-(0|z.words[fe])+Y)>>26,this.words[fe]=67108863&B;for(;Y!==0&&fe<N.length;fe++)Y=(B=(0|N.words[fe])+Y)>>26,this.words[fe]=67108863&B;if(Y===0&&fe<N.length&&N!==this)for(;fe<N.length;fe++)this.words[fe]=N.words[fe];return this.length=Math.max(this.length,fe),N!==this&&(this.negative=1),this._strip()},E.prototype.sub=function(U){return this.clone().isub(U)};var M=function(U,B,N){var z,H,Y,fe=U.words,Re=B.words,Oe=N.words,De=0,ot=0|fe[0],X=8191&ot,ee=ot>>>13,Le=0|fe[1],Be=8191&Le,se=Le>>>13,_e=0|fe[2],te=8191&_e,$e=_e>>>13,ge=0|fe[3],le=8191&ge,ze=ge>>>13,Je=0|fe[4],et=8191&Je,ft=Je>>>13,wt=0|fe[5],It=8191&wt,Ct=wt>>>13,tn=0|fe[6],xt=8191&tn,Ht=tn>>>13,en=0|fe[7],kn=8191&en,Dn=en>>>13,Ft=0|fe[8],Tt=8191&Ft,rn=Ft>>>13,dt=0|fe[9],qn=8191&dt,fn=dt>>>13,dr=0|Re[0],Xn=8191&dr,Ir=dr>>>13,Ae=0|Re[1],ve=8191&Ae,he=Ae>>>13,me=0|Re[2],we=8191&me,je=me>>>13,qe=0|Re[3],Fe=8191&qe,Xe=qe>>>13,Ge=0|Re[4],rt=8191&Ge,bt=Ge>>>13,at=0|Re[5],Et=8191&at,jt=at>>>13,Kt=0|Re[6],Yt=8191&Kt,Zt=Kt>>>13,Jt=0|Re[7],ln=8191&Jt,vn=Jt>>>13,wn=0|Re[8],cn=8191&wn,xn=wn>>>13,cr=0|Re[9],br=8191&cr,hr=cr>>>13;N.negative=U.negative^B.negative,N.length=19;var pr=(De+(z=Math.imul(X,Xn))|0)+((8191&(H=(H=Math.imul(X,Ir))+Math.imul(ee,Xn)|0))<<13)|0;De=((Y=Math.imul(ee,Ir))+(H>>>13)|0)+(pr>>>26)|0,pr&=67108863,z=Math.imul(Be,Xn),H=(H=Math.imul(Be,Ir))+Math.imul(se,Xn)|0,Y=Math.imul(se,Ir);var Kr=(De+(z=z+Math.imul(X,ve)|0)|0)+((8191&(H=(H=H+Math.imul(X,he)|0)+Math.imul(ee,ve)|0))<<13)|0;De=((Y=Y+Math.imul(ee,he)|0)+(H>>>13)|0)+(Kr>>>26)|0,Kr&=67108863,z=Math.imul(te,Xn),H=(H=Math.imul(te,Ir))+Math.imul($e,Xn)|0,Y=Math.imul($e,Ir),z=z+Math.imul(Be,ve)|0,H=(H=H+Math.imul(Be,he)|0)+Math.imul(se,ve)|0,Y=Y+Math.imul(se,he)|0;var mn=(De+(z=z+Math.imul(X,we)|0)|0)+((8191&(H=(H=H+Math.imul(X,je)|0)+Math.imul(ee,we)|0))<<13)|0;De=((Y=Y+Math.imul(ee,je)|0)+(H>>>13)|0)+(mn>>>26)|0,mn&=67108863,z=Math.imul(le,Xn),H=(H=Math.imul(le,Ir))+Math.imul(ze,Xn)|0,Y=Math.imul(ze,Ir),z=z+Math.imul(te,ve)|0,H=(H=H+Math.imul(te,he)|0)+Math.imul($e,ve)|0,Y=Y+Math.imul($e,he)|0,z=z+Math.imul(Be,we)|0,H=(H=H+Math.imul(Be,je)|0)+Math.imul(se,we)|0,Y=Y+Math.imul(se,je)|0;var oi=(De+(z=z+Math.imul(X,Fe)|0)|0)+((8191&(H=(H=H+Math.imul(X,Xe)|0)+Math.imul(ee,Fe)|0))<<13)|0;De=((Y=Y+Math.imul(ee,Xe)|0)+(H>>>13)|0)+(oi>>>26)|0,oi&=67108863,z=Math.imul(et,Xn),H=(H=Math.imul(et,Ir))+Math.imul(ft,Xn)|0,Y=Math.imul(ft,Ir),z=z+Math.imul(le,ve)|0,H=(H=H+Math.imul(le,he)|0)+Math.imul(ze,ve)|0,Y=Y+Math.imul(ze,he)|0,z=z+Math.imul(te,we)|0,H=(H=H+Math.imul(te,je)|0)+Math.imul($e,we)|0,Y=Y+Math.imul($e,je)|0,z=z+Math.imul(Be,Fe)|0,H=(H=H+Math.imul(Be,Xe)|0)+Math.imul(se,Fe)|0,Y=Y+Math.imul(se,Xe)|0;var eo=(De+(z=z+Math.imul(X,rt)|0)|0)+((8191&(H=(H=H+Math.imul(X,bt)|0)+Math.imul(ee,rt)|0))<<13)|0;De=((Y=Y+Math.imul(ee,bt)|0)+(H>>>13)|0)+(eo>>>26)|0,eo&=67108863,z=Math.imul(It,Xn),H=(H=Math.imul(It,Ir))+Math.imul(Ct,Xn)|0,Y=Math.imul(Ct,Ir),z=z+Math.imul(et,ve)|0,H=(H=H+Math.imul(et,he)|0)+Math.imul(ft,ve)|0,Y=Y+Math.imul(ft,he)|0,z=z+Math.imul(le,we)|0,H=(H=H+Math.imul(le,je)|0)+Math.imul(ze,we)|0,Y=Y+Math.imul(ze,je)|0,z=z+Math.imul(te,Fe)|0,H=(H=H+Math.imul(te,Xe)|0)+Math.imul($e,Fe)|0,Y=Y+Math.imul($e,Xe)|0,z=z+Math.imul(Be,rt)|0,H=(H=H+Math.imul(Be,bt)|0)+Math.imul(se,rt)|0,Y=Y+Math.imul(se,bt)|0;var nn=(De+(z=z+Math.imul(X,Et)|0)|0)+((8191&(H=(H=H+Math.imul(X,jt)|0)+Math.imul(ee,Et)|0))<<13)|0;De=((Y=Y+Math.imul(ee,jt)|0)+(H>>>13)|0)+(nn>>>26)|0,nn&=67108863,z=Math.imul(xt,Xn),H=(H=Math.imul(xt,Ir))+Math.imul(Ht,Xn)|0,Y=Math.imul(Ht,Ir),z=z+Math.imul(It,ve)|0,H=(H=H+Math.imul(It,he)|0)+Math.imul(Ct,ve)|0,Y=Y+Math.imul(Ct,he)|0,z=z+Math.imul(et,we)|0,H=(H=H+Math.imul(et,je)|0)+Math.imul(ft,we)|0,Y=Y+Math.imul(ft,je)|0,z=z+Math.imul(le,Fe)|0,H=(H=H+Math.imul(le,Xe)|0)+Math.imul(ze,Fe)|0,Y=Y+Math.imul(ze,Xe)|0,z=z+Math.imul(te,rt)|0,H=(H=H+Math.imul(te,bt)|0)+Math.imul($e,rt)|0,Y=Y+Math.imul($e,bt)|0,z=z+Math.imul(Be,Et)|0,H=(H=H+Math.imul(Be,jt)|0)+Math.imul(se,Et)|0,Y=Y+Math.imul(se,jt)|0;var on=(De+(z=z+Math.imul(X,Yt)|0)|0)+((8191&(H=(H=H+Math.imul(X,Zt)|0)+Math.imul(ee,Yt)|0))<<13)|0;De=((Y=Y+Math.imul(ee,Zt)|0)+(H>>>13)|0)+(on>>>26)|0,on&=67108863,z=Math.imul(kn,Xn),H=(H=Math.imul(kn,Ir))+Math.imul(Dn,Xn)|0,Y=Math.imul(Dn,Ir),z=z+Math.imul(xt,ve)|0,H=(H=H+Math.imul(xt,he)|0)+Math.imul(Ht,ve)|0,Y=Y+Math.imul(Ht,he)|0,z=z+Math.imul(It,we)|0,H=(H=H+Math.imul(It,je)|0)+Math.imul(Ct,we)|0,Y=Y+Math.imul(Ct,je)|0,z=z+Math.imul(et,Fe)|0,H=(H=H+Math.imul(et,Xe)|0)+Math.imul(ft,Fe)|0,Y=Y+Math.imul(ft,Xe)|0,z=z+Math.imul(le,rt)|0,H=(H=H+Math.imul(le,bt)|0)+Math.imul(ze,rt)|0,Y=Y+Math.imul(ze,bt)|0,z=z+Math.imul(te,Et)|0,H=(H=H+Math.imul(te,jt)|0)+Math.imul($e,Et)|0,Y=Y+Math.imul($e,jt)|0,z=z+Math.imul(Be,Yt)|0,H=(H=H+Math.imul(Be,Zt)|0)+Math.imul(se,Yt)|0,Y=Y+Math.imul(se,Zt)|0;var bn=(De+(z=z+Math.imul(X,ln)|0)|0)+((8191&(H=(H=H+Math.imul(X,vn)|0)+Math.imul(ee,ln)|0))<<13)|0;De=((Y=Y+Math.imul(ee,vn)|0)+(H>>>13)|0)+(bn>>>26)|0,bn&=67108863,z=Math.imul(Tt,Xn),H=(H=Math.imul(Tt,Ir))+Math.imul(rn,Xn)|0,Y=Math.imul(rn,Ir),z=z+Math.imul(kn,ve)|0,H=(H=H+Math.imul(kn,he)|0)+Math.imul(Dn,ve)|0,Y=Y+Math.imul(Dn,he)|0,z=z+Math.imul(xt,we)|0,H=(H=H+Math.imul(xt,je)|0)+Math.imul(Ht,we)|0,Y=Y+Math.imul(Ht,je)|0,z=z+Math.imul(It,Fe)|0,H=(H=H+Math.imul(It,Xe)|0)+Math.imul(Ct,Fe)|0,Y=Y+Math.imul(Ct,Xe)|0,z=z+Math.imul(et,rt)|0,H=(H=H+Math.imul(et,bt)|0)+Math.imul(ft,rt)|0,Y=Y+Math.imul(ft,bt)|0,z=z+Math.imul(le,Et)|0,H=(H=H+Math.imul(le,jt)|0)+Math.imul(ze,Et)|0,Y=Y+Math.imul(ze,jt)|0,z=z+Math.imul(te,Yt)|0,H=(H=H+Math.imul(te,Zt)|0)+Math.imul($e,Yt)|0,Y=Y+Math.imul($e,Zt)|0,z=z+Math.imul(Be,ln)|0,H=(H=H+Math.imul(Be,vn)|0)+Math.imul(se,ln)|0,Y=Y+Math.imul(se,vn)|0;var ir=(De+(z=z+Math.imul(X,cn)|0)|0)+((8191&(H=(H=H+Math.imul(X,xn)|0)+Math.imul(ee,cn)|0))<<13)|0;De=((Y=Y+Math.imul(ee,xn)|0)+(H>>>13)|0)+(ir>>>26)|0,ir&=67108863,z=Math.imul(qn,Xn),H=(H=Math.imul(qn,Ir))+Math.imul(fn,Xn)|0,Y=Math.imul(fn,Ir),z=z+Math.imul(Tt,ve)|0,H=(H=H+Math.imul(Tt,he)|0)+Math.imul(rn,ve)|0,Y=Y+Math.imul(rn,he)|0,z=z+Math.imul(kn,we)|0,H=(H=H+Math.imul(kn,je)|0)+Math.imul(Dn,we)|0,Y=Y+Math.imul(Dn,je)|0,z=z+Math.imul(xt,Fe)|0,H=(H=H+Math.imul(xt,Xe)|0)+Math.imul(Ht,Fe)|0,Y=Y+Math.imul(Ht,Xe)|0,z=z+Math.imul(It,rt)|0,H=(H=H+Math.imul(It,bt)|0)+Math.imul(Ct,rt)|0,Y=Y+Math.imul(Ct,bt)|0,z=z+Math.imul(et,Et)|0,H=(H=H+Math.imul(et,jt)|0)+Math.imul(ft,Et)|0,Y=Y+Math.imul(ft,jt)|0,z=z+Math.imul(le,Yt)|0,H=(H=H+Math.imul(le,Zt)|0)+Math.imul(ze,Yt)|0,Y=Y+Math.imul(ze,Zt)|0,z=z+Math.imul(te,ln)|0,H=(H=H+Math.imul(te,vn)|0)+Math.imul($e,ln)|0,Y=Y+Math.imul($e,vn)|0,z=z+Math.imul(Be,cn)|0,H=(H=H+Math.imul(Be,xn)|0)+Math.imul(se,cn)|0,Y=Y+Math.imul(se,xn)|0;var On=(De+(z=z+Math.imul(X,br)|0)|0)+((8191&(H=(H=H+Math.imul(X,hr)|0)+Math.imul(ee,br)|0))<<13)|0;De=((Y=Y+Math.imul(ee,hr)|0)+(H>>>13)|0)+(On>>>26)|0,On&=67108863,z=Math.imul(qn,ve),H=(H=Math.imul(qn,he))+Math.imul(fn,ve)|0,Y=Math.imul(fn,he),z=z+Math.imul(Tt,we)|0,H=(H=H+Math.imul(Tt,je)|0)+Math.imul(rn,we)|0,Y=Y+Math.imul(rn,je)|0,z=z+Math.imul(kn,Fe)|0,H=(H=H+Math.imul(kn,Xe)|0)+Math.imul(Dn,Fe)|0,Y=Y+Math.imul(Dn,Xe)|0,z=z+Math.imul(xt,rt)|0,H=(H=H+Math.imul(xt,bt)|0)+Math.imul(Ht,rt)|0,Y=Y+Math.imul(Ht,bt)|0,z=z+Math.imul(It,Et)|0,H=(H=H+Math.imul(It,jt)|0)+Math.imul(Ct,Et)|0,Y=Y+Math.imul(Ct,jt)|0,z=z+Math.imul(et,Yt)|0,H=(H=H+Math.imul(et,Zt)|0)+Math.imul(ft,Yt)|0,Y=Y+Math.imul(ft,Zt)|0,z=z+Math.imul(le,ln)|0,H=(H=H+Math.imul(le,vn)|0)+Math.imul(ze,ln)|0,Y=Y+Math.imul(ze,vn)|0,z=z+Math.imul(te,cn)|0,H=(H=H+Math.imul(te,xn)|0)+Math.imul($e,cn)|0,Y=Y+Math.imul($e,xn)|0;var Ar=(De+(z=z+Math.imul(Be,br)|0)|0)+((8191&(H=(H=H+Math.imul(Be,hr)|0)+Math.imul(se,br)|0))<<13)|0;De=((Y=Y+Math.imul(se,hr)|0)+(H>>>13)|0)+(Ar>>>26)|0,Ar&=67108863,z=Math.imul(qn,we),H=(H=Math.imul(qn,je))+Math.imul(fn,we)|0,Y=Math.imul(fn,je),z=z+Math.imul(Tt,Fe)|0,H=(H=H+Math.imul(Tt,Xe)|0)+Math.imul(rn,Fe)|0,Y=Y+Math.imul(rn,Xe)|0,z=z+Math.imul(kn,rt)|0,H=(H=H+Math.imul(kn,bt)|0)+Math.imul(Dn,rt)|0,Y=Y+Math.imul(Dn,bt)|0,z=z+Math.imul(xt,Et)|0,H=(H=H+Math.imul(xt,jt)|0)+Math.imul(Ht,Et)|0,Y=Y+Math.imul(Ht,jt)|0,z=z+Math.imul(It,Yt)|0,H=(H=H+Math.imul(It,Zt)|0)+Math.imul(Ct,Yt)|0,Y=Y+Math.imul(Ct,Zt)|0,z=z+Math.imul(et,ln)|0,H=(H=H+Math.imul(et,vn)|0)+Math.imul(ft,ln)|0,Y=Y+Math.imul(ft,vn)|0,z=z+Math.imul(le,cn)|0,H=(H=H+Math.imul(le,xn)|0)+Math.imul(ze,cn)|0,Y=Y+Math.imul(ze,xn)|0;var zr=(De+(z=z+Math.imul(te,br)|0)|0)+((8191&(H=(H=H+Math.imul(te,hr)|0)+Math.imul($e,br)|0))<<13)|0;De=((Y=Y+Math.imul($e,hr)|0)+(H>>>13)|0)+(zr>>>26)|0,zr&=67108863,z=Math.imul(qn,Fe),H=(H=Math.imul(qn,Xe))+Math.imul(fn,Fe)|0,Y=Math.imul(fn,Xe),z=z+Math.imul(Tt,rt)|0,H=(H=H+Math.imul(Tt,bt)|0)+Math.imul(rn,rt)|0,Y=Y+Math.imul(rn,bt)|0,z=z+Math.imul(kn,Et)|0,H=(H=H+Math.imul(kn,jt)|0)+Math.imul(Dn,Et)|0,Y=Y+Math.imul(Dn,jt)|0,z=z+Math.imul(xt,Yt)|0,H=(H=H+Math.imul(xt,Zt)|0)+Math.imul(Ht,Yt)|0,Y=Y+Math.imul(Ht,Zt)|0,z=z+Math.imul(It,ln)|0,H=(H=H+Math.imul(It,vn)|0)+Math.imul(Ct,ln)|0,Y=Y+Math.imul(Ct,vn)|0,z=z+Math.imul(et,cn)|0,H=(H=H+Math.imul(et,xn)|0)+Math.imul(ft,cn)|0,Y=Y+Math.imul(ft,xn)|0;var kr=(De+(z=z+Math.imul(le,br)|0)|0)+((8191&(H=(H=H+Math.imul(le,hr)|0)+Math.imul(ze,br)|0))<<13)|0;De=((Y=Y+Math.imul(ze,hr)|0)+(H>>>13)|0)+(kr>>>26)|0,kr&=67108863,z=Math.imul(qn,rt),H=(H=Math.imul(qn,bt))+Math.imul(fn,rt)|0,Y=Math.imul(fn,bt),z=z+Math.imul(Tt,Et)|0,H=(H=H+Math.imul(Tt,jt)|0)+Math.imul(rn,Et)|0,Y=Y+Math.imul(rn,jt)|0,z=z+Math.imul(kn,Yt)|0,H=(H=H+Math.imul(kn,Zt)|0)+Math.imul(Dn,Yt)|0,Y=Y+Math.imul(Dn,Zt)|0,z=z+Math.imul(xt,ln)|0,H=(H=H+Math.imul(xt,vn)|0)+Math.imul(Ht,ln)|0,Y=Y+Math.imul(Ht,vn)|0,z=z+Math.imul(It,cn)|0,H=(H=H+Math.imul(It,xn)|0)+Math.imul(Ct,cn)|0,Y=Y+Math.imul(Ct,xn)|0;var ui=(De+(z=z+Math.imul(et,br)|0)|0)+((8191&(H=(H=H+Math.imul(et,hr)|0)+Math.imul(ft,br)|0))<<13)|0;De=((Y=Y+Math.imul(ft,hr)|0)+(H>>>13)|0)+(ui>>>26)|0,ui&=67108863,z=Math.imul(qn,Et),H=(H=Math.imul(qn,jt))+Math.imul(fn,Et)|0,Y=Math.imul(fn,jt),z=z+Math.imul(Tt,Yt)|0,H=(H=H+Math.imul(Tt,Zt)|0)+Math.imul(rn,Yt)|0,Y=Y+Math.imul(rn,Zt)|0,z=z+Math.imul(kn,ln)|0,H=(H=H+Math.imul(kn,vn)|0)+Math.imul(Dn,ln)|0,Y=Y+Math.imul(Dn,vn)|0,z=z+Math.imul(xt,cn)|0,H=(H=H+Math.imul(xt,xn)|0)+Math.imul(Ht,cn)|0,Y=Y+Math.imul(Ht,xn)|0;var Jr=(De+(z=z+Math.imul(It,br)|0)|0)+((8191&(H=(H=H+Math.imul(It,hr)|0)+Math.imul(Ct,br)|0))<<13)|0;De=((Y=Y+Math.imul(Ct,hr)|0)+(H>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,z=Math.imul(qn,Yt),H=(H=Math.imul(qn,Zt))+Math.imul(fn,Yt)|0,Y=Math.imul(fn,Zt),z=z+Math.imul(Tt,ln)|0,H=(H=H+Math.imul(Tt,vn)|0)+Math.imul(rn,ln)|0,Y=Y+Math.imul(rn,vn)|0,z=z+Math.imul(kn,cn)|0,H=(H=H+Math.imul(kn,xn)|0)+Math.imul(Dn,cn)|0,Y=Y+Math.imul(Dn,xn)|0;var Xr=(De+(z=z+Math.imul(xt,br)|0)|0)+((8191&(H=(H=H+Math.imul(xt,hr)|0)+Math.imul(Ht,br)|0))<<13)|0;De=((Y=Y+Math.imul(Ht,hr)|0)+(H>>>13)|0)+(Xr>>>26)|0,Xr&=67108863,z=Math.imul(qn,ln),H=(H=Math.imul(qn,vn))+Math.imul(fn,ln)|0,Y=Math.imul(fn,vn),z=z+Math.imul(Tt,cn)|0,H=(H=H+Math.imul(Tt,xn)|0)+Math.imul(rn,cn)|0,Y=Y+Math.imul(rn,xn)|0;var wi=(De+(z=z+Math.imul(kn,br)|0)|0)+((8191&(H=(H=H+Math.imul(kn,hr)|0)+Math.imul(Dn,br)|0))<<13)|0;De=((Y=Y+Math.imul(Dn,hr)|0)+(H>>>13)|0)+(wi>>>26)|0,wi&=67108863,z=Math.imul(qn,cn),H=(H=Math.imul(qn,xn))+Math.imul(fn,cn)|0,Y=Math.imul(fn,xn);var Wn=(De+(z=z+Math.imul(Tt,br)|0)|0)+((8191&(H=(H=H+Math.imul(Tt,hr)|0)+Math.imul(rn,br)|0))<<13)|0;De=((Y=Y+Math.imul(rn,hr)|0)+(H>>>13)|0)+(Wn>>>26)|0,Wn&=67108863;var hi=(De+(z=Math.imul(qn,br))|0)+((8191&(H=(H=Math.imul(qn,hr))+Math.imul(fn,br)|0))<<13)|0;return De=((Y=Math.imul(fn,hr))+(H>>>13)|0)+(hi>>>26)|0,hi&=67108863,Oe[0]=pr,Oe[1]=Kr,Oe[2]=mn,Oe[3]=oi,Oe[4]=eo,Oe[5]=nn,Oe[6]=on,Oe[7]=bn,Oe[8]=ir,Oe[9]=On,Oe[10]=Ar,Oe[11]=zr,Oe[12]=kr,Oe[13]=ui,Oe[14]=Jr,Oe[15]=Xr,Oe[16]=wi,Oe[17]=Wn,Oe[18]=hi,De!==0&&(Oe[19]=De,N.length++),N};function L(U,B,N){N.negative=B.negative^U.negative,N.length=U.length+B.length;for(var z=0,H=0,Y=0;Y<N.length-1;Y++){var fe=H;H=0;for(var Re=67108863&z,Oe=Math.min(Y,B.length-1),De=Math.max(0,Y-U.length+1);De<=Oe;De++){var ot=Y-De,X=(0|U.words[ot])*(0|B.words[De]),ee=67108863&X;Re=67108863&(ee=ee+Re|0),H+=(fe=(fe=fe+(X/67108864|0)|0)+(ee>>>26)|0)>>>26,fe&=67108863}N.words[Y]=Re,z=fe,fe=H}return z!==0?N.words[Y]=z:N.length--,N._strip()}function W(U,B,N){return L(U,B,N)}Math.imul||(M=R),E.prototype.mulTo=function(U,B){var N=this.length+U.length;return this.length===10&&U.length===10?M(this,U,B):N<63?R(this,U,B):N<1024?L(this,U,B):W(this,U,B)},E.prototype.mul=function(U){var B=new E(null);return B.words=new Array(this.length+U.length),this.mulTo(U,B)},E.prototype.mulf=function(U){var B=new E(null);return B.words=new Array(this.length+U.length),W(this,U,B)},E.prototype.imul=function(U){return this.clone().mulTo(U,this)},E.prototype.imuln=function(U){var B=U<0;B&&(U=-U),g(typeof U=="number"),g(U<67108864);for(var N=0,z=0;z<this.length;z++){var H=(0|this.words[z])*U,Y=(67108863&H)+(67108863&N);N>>=26,N+=H/67108864|0,N+=Y>>>26,this.words[z]=67108863&Y}return N!==0&&(this.words[z]=N,this.length++),B?this.ineg():this},E.prototype.muln=function(U){return this.clone().imuln(U)},E.prototype.sqr=function(){return this.mul(this)},E.prototype.isqr=function(){return this.imul(this.clone())},E.prototype.pow=function(U){var B=function(Y){for(var fe=new Array(Y.bitLength()),Re=0;Re<fe.length;Re++){var Oe=Re/26|0,De=Re%26;fe[Re]=Y.words[Oe]>>>De&1}return fe}(U);if(B.length===0)return new E(1);for(var N=this,z=0;z<B.length&&B[z]===0;z++,N=N.sqr());if(++z<B.length)for(var H=N.sqr();z<B.length;z++,H=H.sqr())B[z]!==0&&(N=N.mul(H));return N},E.prototype.iushln=function(U){g(typeof U=="number"&&U>=0);var B,N=U%26,z=(U-N)/26,H=67108863>>>26-N<<26-N;if(N!==0){var Y=0;for(B=0;B<this.length;B++){var fe=this.words[B]&H,Re=(0|this.words[B])-fe<<N;this.words[B]=Re|Y,Y=fe>>>26-N}Y&&(this.words[B]=Y,this.length++)}if(z!==0){for(B=this.length-1;B>=0;B--)this.words[B+z]=this.words[B];for(B=0;B<z;B++)this.words[B]=0;this.length+=z}return this._strip()},E.prototype.ishln=function(U){return g(this.negative===0),this.iushln(U)},E.prototype.iushrn=function(U,B,N){var z;g(typeof U=="number"&&U>=0),z=B?(B-B%26)/26:0;var H=U%26,Y=Math.min((U-H)/26,this.length),fe=67108863^67108863>>>H<<H,Re=N;if(z-=Y,z=Math.max(0,z),Re){for(var Oe=0;Oe<Y;Oe++)Re.words[Oe]=this.words[Oe];Re.length=Y}if(Y!==0)if(this.length>Y)for(this.length-=Y,Oe=0;Oe<this.length;Oe++)this.words[Oe]=this.words[Oe+Y];else this.words[0]=0,this.length=1;var De=0;for(Oe=this.length-1;Oe>=0&&(De!==0||Oe>=z);Oe--){var ot=0|this.words[Oe];this.words[Oe]=De<<26-H|ot>>>H,De=ot&fe}return Re&&De!==0&&(Re.words[Re.length++]=De),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},E.prototype.ishrn=function(U,B,N){return g(this.negative===0),this.iushrn(U,B,N)},E.prototype.shln=function(U){return this.clone().ishln(U)},E.prototype.ushln=function(U){return this.clone().iushln(U)},E.prototype.shrn=function(U){return this.clone().ishrn(U)},E.prototype.ushrn=function(U){return this.clone().iushrn(U)},E.prototype.testn=function(U){g(typeof U=="number"&&U>=0);var B=U%26,N=(U-B)/26,z=1<<B;return!(this.length<=N||!(this.words[N]&z))},E.prototype.imaskn=function(U){g(typeof U=="number"&&U>=0);var B=U%26,N=(U-B)/26;if(g(this.negative===0,"imaskn works only with positive numbers"),this.length<=N)return this;if(B!==0&&N++,this.length=Math.min(N,this.length),B!==0){var z=67108863^67108863>>>B<<B;this.words[this.length-1]&=z}return this._strip()},E.prototype.maskn=function(U){return this.clone().imaskn(U)},E.prototype.iaddn=function(U){return g(typeof U=="number"),g(U<67108864),U<0?this.isubn(-U):this.negative!==0?this.length===1&&(0|this.words[0])<=U?(this.words[0]=U-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(U),this.negative=1,this):this._iaddn(U)},E.prototype._iaddn=function(U){this.words[0]+=U;for(var B=0;B<this.length&&this.words[B]>=67108864;B++)this.words[B]-=67108864,B===this.length-1?this.words[B+1]=1:this.words[B+1]++;return this.length=Math.max(this.length,B+1),this},E.prototype.isubn=function(U){if(g(typeof U=="number"),g(U<67108864),U<0)return this.iaddn(-U);if(this.negative!==0)return this.negative=0,this.iaddn(U),this.negative=1,this;if(this.words[0]-=U,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var B=0;B<this.length&&this.words[B]<0;B++)this.words[B]+=67108864,this.words[B+1]-=1;return this._strip()},E.prototype.addn=function(U){return this.clone().iaddn(U)},E.prototype.subn=function(U){return this.clone().isubn(U)},E.prototype.iabs=function(){return this.negative=0,this},E.prototype.abs=function(){return this.clone().iabs()},E.prototype._ishlnsubmul=function(U,B,N){var z,H,Y=U.length+N;this._expand(Y);var fe=0;for(z=0;z<U.length;z++){H=(0|this.words[z+N])+fe;var Re=(0|U.words[z])*B;fe=((H-=67108863&Re)>>26)-(Re/67108864|0),this.words[z+N]=67108863&H}for(;z<this.length-N;z++)fe=(H=(0|this.words[z+N])+fe)>>26,this.words[z+N]=67108863&H;if(fe===0)return this._strip();for(g(fe===-1),fe=0,z=0;z<this.length;z++)fe=(H=-(0|this.words[z])+fe)>>26,this.words[z]=67108863&H;return this.negative=1,this._strip()},E.prototype._wordDiv=function(U,B){var N=(this.length,U.length),z=this.clone(),H=U,Y=0|H.words[H.length-1];(N=26-this._countBits(Y))!=0&&(H=H.ushln(N),z.iushln(N),Y=0|H.words[H.length-1]);var fe,Re=z.length-H.length;if(B!=="mod"){(fe=new E(null)).length=Re+1,fe.words=new Array(fe.length);for(var Oe=0;Oe<fe.length;Oe++)fe.words[Oe]=0}var De=z.clone()._ishlnsubmul(H,1,Re);De.negative===0&&(z=De,fe&&(fe.words[Re]=1));for(var ot=Re-1;ot>=0;ot--){var X=67108864*(0|z.words[H.length+ot])+(0|z.words[H.length+ot-1]);for(X=Math.min(X/Y|0,67108863),z._ishlnsubmul(H,X,ot);z.negative!==0;)X--,z.negative=0,z._ishlnsubmul(H,1,ot),z.isZero()||(z.negative^=1);fe&&(fe.words[ot]=X)}return fe&&fe._strip(),z._strip(),B!=="div"&&N!==0&&z.iushrn(N),{div:fe||null,mod:z}},E.prototype.divmod=function(U,B,N){return g(!U.isZero()),this.isZero()?{div:new E(0),mod:new E(0)}:this.negative!==0&&U.negative===0?(Y=this.neg().divmod(U,B),B!=="mod"&&(z=Y.div.neg()),B!=="div"&&(H=Y.mod.neg(),N&&H.negative!==0&&H.iadd(U)),{div:z,mod:H}):this.negative===0&&U.negative!==0?(Y=this.divmod(U.neg(),B),B!=="mod"&&(z=Y.div.neg()),{div:z,mod:Y.mod}):this.negative&U.negative?(Y=this.neg().divmod(U.neg(),B),B!=="div"&&(H=Y.mod.neg(),N&&H.negative!==0&&H.isub(U)),{div:Y.div,mod:H}):U.length>this.length||this.cmp(U)<0?{div:new E(0),mod:this}:U.length===1?B==="div"?{div:this.divn(U.words[0]),mod:null}:B==="mod"?{div:null,mod:new E(this.modrn(U.words[0]))}:{div:this.divn(U.words[0]),mod:new E(this.modrn(U.words[0]))}:this._wordDiv(U,B);var z,H,Y},E.prototype.div=function(U){return this.divmod(U,"div",!1).div},E.prototype.mod=function(U){return this.divmod(U,"mod",!1).mod},E.prototype.umod=function(U){return this.divmod(U,"mod",!0).mod},E.prototype.divRound=function(U){var B=this.divmod(U);if(B.mod.isZero())return B.div;var N=B.div.negative!==0?B.mod.isub(U):B.mod,z=U.ushrn(1),H=U.andln(1),Y=N.cmp(z);return Y<0||H===1&&Y===0?B.div:B.div.negative!==0?B.div.isubn(1):B.div.iaddn(1)},E.prototype.modrn=function(U){var B=U<0;B&&(U=-U),g(U<=67108863);for(var N=67108864%U,z=0,H=this.length-1;H>=0;H--)z=(N*z+(0|this.words[H]))%U;return B?-z:z},E.prototype.modn=function(U){return this.modrn(U)},E.prototype.idivn=function(U){var B=U<0;B&&(U=-U),g(U<=67108863);for(var N=0,z=this.length-1;z>=0;z--){var H=(0|this.words[z])+67108864*N;this.words[z]=H/U|0,N=H%U}return this._strip(),B?this.ineg():this},E.prototype.divn=function(U){return this.clone().idivn(U)},E.prototype.egcd=function(U){g(U.negative===0),g(!U.isZero());var B=this,N=U.clone();B=B.negative!==0?B.umod(U):B.clone();for(var z=new E(1),H=new E(0),Y=new E(0),fe=new E(1),Re=0;B.isEven()&&N.isEven();)B.iushrn(1),N.iushrn(1),++Re;for(var Oe=N.clone(),De=B.clone();!B.isZero();){for(var ot=0,X=1;!(B.words[0]&X)&&ot<26;++ot,X<<=1);if(ot>0)for(B.iushrn(ot);ot-- >0;)(z.isOdd()||H.isOdd())&&(z.iadd(Oe),H.isub(De)),z.iushrn(1),H.iushrn(1);for(var ee=0,Le=1;!(N.words[0]&Le)&&ee<26;++ee,Le<<=1);if(ee>0)for(N.iushrn(ee);ee-- >0;)(Y.isOdd()||fe.isOdd())&&(Y.iadd(Oe),fe.isub(De)),Y.iushrn(1),fe.iushrn(1);B.cmp(N)>=0?(B.isub(N),z.isub(Y),H.isub(fe)):(N.isub(B),Y.isub(z),fe.isub(H))}return{a:Y,b:fe,gcd:N.iushln(Re)}},E.prototype._invmp=function(U){g(U.negative===0),g(!U.isZero());var B=this,N=U.clone();B=B.negative!==0?B.umod(U):B.clone();for(var z,H=new E(1),Y=new E(0),fe=N.clone();B.cmpn(1)>0&&N.cmpn(1)>0;){for(var Re=0,Oe=1;!(B.words[0]&Oe)&&Re<26;++Re,Oe<<=1);if(Re>0)for(B.iushrn(Re);Re-- >0;)H.isOdd()&&H.iadd(fe),H.iushrn(1);for(var De=0,ot=1;!(N.words[0]&ot)&&De<26;++De,ot<<=1);if(De>0)for(N.iushrn(De);De-- >0;)Y.isOdd()&&Y.iadd(fe),Y.iushrn(1);B.cmp(N)>=0?(B.isub(N),H.isub(Y)):(N.isub(B),Y.isub(H))}return(z=B.cmpn(1)===0?H:Y).cmpn(0)<0&&z.iadd(U),z},E.prototype.gcd=function(U){if(this.isZero())return U.abs();if(U.isZero())return this.abs();var B=this.clone(),N=U.clone();B.negative=0,N.negative=0;for(var z=0;B.isEven()&&N.isEven();z++)B.iushrn(1),N.iushrn(1);for(;;){for(;B.isEven();)B.iushrn(1);for(;N.isEven();)N.iushrn(1);var H=B.cmp(N);if(H<0){var Y=B;B=N,N=Y}else if(H===0||N.cmpn(1)===0)break;B.isub(N)}return N.iushln(z)},E.prototype.invm=function(U){return this.egcd(U).a.umod(U)},E.prototype.isEven=function(){return(1&this.words[0])==0},E.prototype.isOdd=function(){return(1&this.words[0])==1},E.prototype.andln=function(U){return this.words[0]&U},E.prototype.bincn=function(U){g(typeof U=="number");var B=U%26,N=(U-B)/26,z=1<<B;if(this.length<=N)return this._expand(N+1),this.words[N]|=z,this;for(var H=z,Y=N;H!==0&&Y<this.length;Y++){var fe=0|this.words[Y];H=(fe+=H)>>>26,fe&=67108863,this.words[Y]=fe}return H!==0&&(this.words[Y]=H,this.length++),this},E.prototype.isZero=function(){return this.length===1&&this.words[0]===0},E.prototype.cmpn=function(U){var B,N=U<0;if(this.negative!==0&&!N)return-1;if(this.negative===0&&N)return 1;if(this._strip(),this.length>1)B=1;else{N&&(U=-U),g(U<=67108863,"Number is too big");var z=0|this.words[0];B=z===U?0:z<U?-1:1}return this.negative!==0?0|-B:B},E.prototype.cmp=function(U){if(this.negative!==0&&U.negative===0)return-1;if(this.negative===0&&U.negative!==0)return 1;var B=this.ucmp(U);return this.negative!==0?0|-B:B},E.prototype.ucmp=function(U){if(this.length>U.length)return 1;if(this.length<U.length)return-1;for(var B=0,N=this.length-1;N>=0;N--){var z=0|this.words[N],H=0|U.words[N];if(z!==H){z<H?B=-1:z>H&&(B=1);break}}return B},E.prototype.gtn=function(U){return this.cmpn(U)===1},E.prototype.gt=function(U){return this.cmp(U)===1},E.prototype.gten=function(U){return this.cmpn(U)>=0},E.prototype.gte=function(U){return this.cmp(U)>=0},E.prototype.ltn=function(U){return this.cmpn(U)===-1},E.prototype.lt=function(U){return this.cmp(U)===-1},E.prototype.lten=function(U){return this.cmpn(U)<=0},E.prototype.lte=function(U){return this.cmp(U)<=0},E.prototype.eqn=function(U){return this.cmpn(U)===0},E.prototype.eq=function(U){return this.cmp(U)===0},E.red=function(U){return new be(U)},E.prototype.toRed=function(U){return g(!this.red,"Already a number in reduction context"),g(this.negative===0,"red works only with positives"),U.convertTo(this)._forceRed(U)},E.prototype.fromRed=function(){return g(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},E.prototype._forceRed=function(U){return this.red=U,this},E.prototype.forceRed=function(U){return g(!this.red,"Already a number in reduction context"),this._forceRed(U)},E.prototype.redAdd=function(U){return g(this.red,"redAdd works only with red numbers"),this.red.add(this,U)},E.prototype.redIAdd=function(U){return g(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,U)},E.prototype.redSub=function(U){return g(this.red,"redSub works only with red numbers"),this.red.sub(this,U)},E.prototype.redISub=function(U){return g(this.red,"redISub works only with red numbers"),this.red.isub(this,U)},E.prototype.redShl=function(U){return g(this.red,"redShl works only with red numbers"),this.red.shl(this,U)},E.prototype.redMul=function(U){return g(this.red,"redMul works only with red numbers"),this.red._verify2(this,U),this.red.mul(this,U)},E.prototype.redIMul=function(U){return g(this.red,"redMul works only with red numbers"),this.red._verify2(this,U),this.red.imul(this,U)},E.prototype.redSqr=function(){return g(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},E.prototype.redISqr=function(){return g(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},E.prototype.redSqrt=function(){return g(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},E.prototype.redInvm=function(){return g(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},E.prototype.redNeg=function(){return g(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},E.prototype.redPow=function(U){return g(this.red&&!U.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,U)};var G={k256:null,p224:null,p192:null,p25519:null};function re(U,B){this.name=U,this.p=new E(B,16),this.n=this.p.bitLength(),this.k=new E(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function Q(){re.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function oe(){re.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function ae(){re.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function de(){re.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function be(U){if(typeof U=="string"){var B=E._prime(U);this.m=B.p,this.prime=B}else g(U.gtn(1),"modulus must be greater than 1"),this.m=U,this.prime=null}function pe(U){be.call(this,U),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new E(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}re.prototype._tmp=function(){var U=new E(null);return U.words=new Array(Math.ceil(this.n/13)),U},re.prototype.ireduce=function(U){var B,N=U;do this.split(N,this.tmp),B=(N=(N=this.imulK(N)).iadd(this.tmp)).bitLength();while(B>this.n);var z=B<this.n?-1:N.ucmp(this.p);return z===0?(N.words[0]=0,N.length=1):z>0?N.isub(this.p):N.strip!==void 0?N.strip():N._strip(),N},re.prototype.split=function(U,B){U.iushrn(this.n,0,B)},re.prototype.imulK=function(U){return U.imul(this.k)},_(Q,re),Q.prototype.split=function(U,B){for(var N=4194303,z=Math.min(U.length,9),H=0;H<z;H++)B.words[H]=U.words[H];if(B.length=z,U.length<=9)return U.words[0]=0,void(U.length=1);var Y=U.words[9];for(B.words[B.length++]=Y&N,H=10;H<U.length;H++){var fe=0|U.words[H];U.words[H-10]=(fe&N)<<4|Y>>>22,Y=fe}Y>>>=22,U.words[H-10]=Y,Y===0&&U.length>10?U.length-=10:U.length-=9},Q.prototype.imulK=function(U){U.words[U.length]=0,U.words[U.length+1]=0,U.length+=2;for(var B=0,N=0;N<U.length;N++){var z=0|U.words[N];B+=977*z,U.words[N]=67108863&B,B=64*z+(B/67108864|0)}return U.words[U.length-1]===0&&(U.length--,U.words[U.length-1]===0&&U.length--),U},_(oe,re),_(ae,re),_(de,re),de.prototype.imulK=function(U){for(var B=0,N=0;N<U.length;N++){var z=19*(0|U.words[N])+B,H=67108863&z;z>>>=26,U.words[N]=H,B=z}return B!==0&&(U.words[U.length++]=B),U},E._prime=function(U){if(G[U])return G[U];var B;if(U==="k256")B=new Q;else if(U==="p224")B=new oe;else if(U==="p192")B=new ae;else{if(U!=="p25519")throw new Error("Unknown prime "+U);B=new de}return G[U]=B,B},be.prototype._verify1=function(U){g(U.negative===0,"red works only with positives"),g(U.red,"red works only with red numbers")},be.prototype._verify2=function(U,B){g((U.negative|B.negative)==0,"red works only with positives"),g(U.red&&U.red===B.red,"red works only with red numbers")},be.prototype.imod=function(U){return this.prime?this.prime.ireduce(U)._forceRed(this):(f(U,U.umod(this.m)._forceRed(this)),U)},be.prototype.neg=function(U){return U.isZero()?U.clone():this.m.sub(U)._forceRed(this)},be.prototype.add=function(U,B){this._verify2(U,B);var N=U.add(B);return N.cmp(this.m)>=0&&N.isub(this.m),N._forceRed(this)},be.prototype.iadd=function(U,B){this._verify2(U,B);var N=U.iadd(B);return N.cmp(this.m)>=0&&N.isub(this.m),N},be.prototype.sub=function(U,B){this._verify2(U,B);var N=U.sub(B);return N.cmpn(0)<0&&N.iadd(this.m),N._forceRed(this)},be.prototype.isub=function(U,B){this._verify2(U,B);var N=U.isub(B);return N.cmpn(0)<0&&N.iadd(this.m),N},be.prototype.shl=function(U,B){return this._verify1(U),this.imod(U.ushln(B))},be.prototype.imul=function(U,B){return this._verify2(U,B),this.imod(U.imul(B))},be.prototype.mul=function(U,B){return this._verify2(U,B),this.imod(U.mul(B))},be.prototype.isqr=function(U){return this.imul(U,U.clone())},be.prototype.sqr=function(U){return this.mul(U,U)},be.prototype.sqrt=function(U){if(U.isZero())return U.clone();var B=this.m.andln(3);if(g(B%2==1),B===3){var N=this.m.add(new E(1)).iushrn(2);return this.pow(U,N)}for(var z=this.m.subn(1),H=0;!z.isZero()&&z.andln(1)===0;)H++,z.iushrn(1);g(!z.isZero());var Y=new E(1).toRed(this),fe=Y.redNeg(),Re=this.m.subn(1).iushrn(1),Oe=this.m.bitLength();for(Oe=new E(2*Oe*Oe).toRed(this);this.pow(Oe,Re).cmp(fe)!==0;)Oe.redIAdd(fe);for(var De=this.pow(Oe,z),ot=this.pow(U,z.addn(1).iushrn(1)),X=this.pow(U,z),ee=H;X.cmp(Y)!==0;){for(var Le=X,Be=0;Le.cmp(Y)!==0;Be++)Le=Le.redSqr();g(Be<ee);var se=this.pow(De,new E(1).iushln(ee-Be-1));ot=ot.redMul(se),De=se.redSqr(),X=X.redMul(De),ee=Be}return ot},be.prototype.invm=function(U){var B=U._invmp(this.m);return B.negative!==0?(B.negative=0,this.imod(B).redNeg()):this.imod(B)},be.prototype.pow=function(U,B){if(B.isZero())return new E(1).toRed(this);if(B.cmpn(1)===0)return U.clone();var N=new Array(16);N[0]=new E(1).toRed(this),N[1]=U;for(var z=2;z<N.length;z++)N[z]=this.mul(N[z-1],U);var H=N[0],Y=0,fe=0,Re=B.bitLength()%26;for(Re===0&&(Re=26),z=B.length-1;z>=0;z--){for(var Oe=B.words[z],De=Re-1;De>=0;De--){var ot=Oe>>De&1;H!==N[0]&&(H=this.sqr(H)),ot!==0||Y!==0?(Y<<=1,Y|=ot,(++fe==4||z===0&&De===0)&&(H=this.mul(H,N[Y]),fe=0,Y=0)):fe=0}Re=26}return H},be.prototype.convertTo=function(U){var B=U.umod(this.m);return B===U?B.clone():B},be.prototype.convertFrom=function(U){var B=U.clone();return B.red=null,B},E.mont=function(U){return new pe(U)},_(pe,be),pe.prototype.convertTo=function(U){return this.imod(U.ushln(this.shift))},pe.prototype.convertFrom=function(U){var B=this.imod(U.mul(this.rinv));return B.red=null,B},pe.prototype.imul=function(U,B){if(U.isZero()||B.isZero())return U.words[0]=0,U.length=1,U;var N=U.imul(B),z=N.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),H=N.isub(z).iushrn(this.shift),Y=H;return H.cmp(this.m)>=0?Y=H.isub(this.m):H.cmpn(0)<0&&(Y=H.iadd(this.m)),Y._forceRed(this)},pe.prototype.mul=function(U,B){if(U.isZero()||B.isZero())return new E(0)._forceRed(this);var N=U.mul(B),z=N.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),H=N.isub(z).iushrn(this.shift),Y=H;return H.cmp(this.m)>=0?Y=H.isub(this.m):H.cmpn(0)<0&&(Y=H.iadd(this.m)),Y._forceRed(this)},pe.prototype.invm=function(U){return this.imod(U._invmp(this.m).mul(this.r2))._forceRed(this)}})(a=r.nmd(a),this)},7179:(a,l,r)=>{function h(_){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},h(_)}var m;function v(_){this.rand=_}if(a.exports=function(_){return m||(m=new v(null)),m.generate(_)},a.exports.Rand=v,v.prototype.generate=function(_){return this._rand(_)},v.prototype._rand=function(_){if(this.rand.getBytes)return this.rand.getBytes(_);for(var E=new Uint8Array(_),b=0;b<E.length;b++)E[b]=this.rand.getByte();return E},(typeof self>"u"?"undefined":h(self))==="object")self.crypto&&self.crypto.getRandomValues?v.prototype._rand=function(_){var E=new Uint8Array(_);return self.crypto.getRandomValues(E),E}:self.msCrypto&&self.msCrypto.getRandomValues?v.prototype._rand=function(_){var E=new Uint8Array(_);return self.msCrypto.getRandomValues(E),E}:(typeof window>"u"?"undefined":h(window))==="object"&&(v.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var g=r(9214);if(typeof g.randomBytes!="function")throw new Error("Not supported");v.prototype._rand=function(_){return g.randomBytes(_)}}catch{}},7463:(a,l,r)=>{var h=r(9047).Buffer;function m(p){h.isBuffer(p)||(p=h.from(p));for(var x=p.length/4|0,y=new Array(x),f=0;f<x;f++)y[f]=p.readUInt32BE(4*f);return y}function v(p){for(;0<p.length;p++)p[0]=0}function g(p,x,y,f,w){for(var A,P,T,R,M=y[0],L=y[1],W=y[2],G=y[3],re=p[0]^x[0],Q=p[1]^x[1],oe=p[2]^x[2],ae=p[3]^x[3],de=4,be=1;be<w;be++)A=M[re>>>24]^L[Q>>>16&255]^W[oe>>>8&255]^G[255&ae]^x[de++],P=M[Q>>>24]^L[oe>>>16&255]^W[ae>>>8&255]^G[255&re]^x[de++],T=M[oe>>>24]^L[ae>>>16&255]^W[re>>>8&255]^G[255&Q]^x[de++],R=M[ae>>>24]^L[re>>>16&255]^W[Q>>>8&255]^G[255&oe]^x[de++],re=A,Q=P,oe=T,ae=R;return A=(f[re>>>24]<<24|f[Q>>>16&255]<<16|f[oe>>>8&255]<<8|f[255&ae])^x[de++],P=(f[Q>>>24]<<24|f[oe>>>16&255]<<16|f[ae>>>8&255]<<8|f[255&re])^x[de++],T=(f[oe>>>24]<<24|f[ae>>>16&255]<<16|f[re>>>8&255]<<8|f[255&Q])^x[de++],R=(f[ae>>>24]<<24|f[re>>>16&255]<<16|f[Q>>>8&255]<<8|f[255&oe])^x[de++],[A>>>=0,P>>>=0,T>>>=0,R>>>=0]}var _=[0,1,2,4,8,16,32,64,128,27,54],E=function(){for(var p=new Array(256),x=0;x<256;x++)p[x]=x<128?x<<1:x<<1^283;for(var y=[],f=[],w=[[],[],[],[]],A=[[],[],[],[]],P=0,T=0,R=0;R<256;++R){var M=T^T<<1^T<<2^T<<3^T<<4;M=M>>>8^255&M^99,y[P]=M,f[M]=P;var L=p[P],W=p[L],G=p[W],re=257*p[M]^16843008*M;w[0][P]=re<<24|re>>>8,w[1][P]=re<<16|re>>>16,w[2][P]=re<<8|re>>>24,w[3][P]=re,re=16843009*G^65537*W^257*L^16843008*P,A[0][M]=re<<24|re>>>8,A[1][M]=re<<16|re>>>16,A[2][M]=re<<8|re>>>24,A[3][M]=re,P===0?P=T=1:(P=L^p[p[p[G^L]]],T^=p[p[T]])}return{SBOX:y,INV_SBOX:f,SUB_MIX:w,INV_SUB_MIX:A}}();function b(p){this._key=m(p),this._reset()}b.blockSize=16,b.keySize=32,b.prototype.blockSize=b.blockSize,b.prototype.keySize=b.keySize,b.prototype._reset=function(){for(var p=this._key,x=p.length,y=x+6,f=4*(y+1),w=[],A=0;A<x;A++)w[A]=p[A];for(A=x;A<f;A++){var P=w[A-1];A%x==0?(P=P<<8|P>>>24,P=E.SBOX[P>>>24]<<24|E.SBOX[P>>>16&255]<<16|E.SBOX[P>>>8&255]<<8|E.SBOX[255&P],P^=_[A/x|0]<<24):x>6&&A%x==4&&(P=E.SBOX[P>>>24]<<24|E.SBOX[P>>>16&255]<<16|E.SBOX[P>>>8&255]<<8|E.SBOX[255&P]),w[A]=w[A-x]^P}for(var T=[],R=0;R<f;R++){var M=f-R,L=w[M-(R%4?0:4)];T[R]=R<4||M<=4?L:E.INV_SUB_MIX[0][E.SBOX[L>>>24]]^E.INV_SUB_MIX[1][E.SBOX[L>>>16&255]]^E.INV_SUB_MIX[2][E.SBOX[L>>>8&255]]^E.INV_SUB_MIX[3][E.SBOX[255&L]]}this._nRounds=y,this._keySchedule=w,this._invKeySchedule=T},b.prototype.encryptBlockRaw=function(p){return g(p=m(p),this._keySchedule,E.SUB_MIX,E.SBOX,this._nRounds)},b.prototype.encryptBlock=function(p){var x=this.encryptBlockRaw(p),y=h.allocUnsafe(16);return y.writeUInt32BE(x[0],0),y.writeUInt32BE(x[1],4),y.writeUInt32BE(x[2],8),y.writeUInt32BE(x[3],12),y},b.prototype.decryptBlock=function(p){var x=(p=m(p))[1];p[1]=p[3],p[3]=x;var y=g(p,this._invKeySchedule,E.INV_SUB_MIX,E.INV_SBOX,this._nRounds),f=h.allocUnsafe(16);return f.writeUInt32BE(y[0],0),f.writeUInt32BE(y[3],4),f.writeUInt32BE(y[2],8),f.writeUInt32BE(y[1],12),f},b.prototype.scrub=function(){v(this._keySchedule),v(this._invKeySchedule),v(this._key)},a.exports.AES=b},3499:(a,l,r)=>{var h=r(7463),m=r(9047).Buffer,v=r(8842),g=r(376),_=r(1225),E=r(5176),b=r(4001);function p(x,y,f,w){v.call(this);var A=m.alloc(4,0);this._cipher=new h.AES(y);var P=this._cipher.encryptBlock(A);this._ghash=new _(P),f=function(T,R,M){if(R.length===12)return T._finID=m.concat([R,m.from([0,0,0,1])]),m.concat([R,m.from([0,0,0,2])]);var L=new _(M),W=R.length,G=W%16;L.update(R),G&&(G=16-G,L.update(m.alloc(G,0))),L.update(m.alloc(8,0));var re=8*W,Q=m.alloc(8);Q.writeUIntBE(re,0,8),L.update(Q),T._finID=L.state;var oe=m.from(T._finID);return b(oe),oe}(this,f,P),this._prev=m.from(f),this._cache=m.allocUnsafe(0),this._secCache=m.allocUnsafe(0),this._decrypt=w,this._alen=0,this._len=0,this._mode=x,this._authTag=null,this._called=!1}g(p,v),p.prototype._update=function(x){if(!this._called&&this._alen){var y=16-this._alen%16;y<16&&(y=m.alloc(y,0),this._ghash.update(y))}this._called=!0;var f=this._mode.encrypt(this,x);return this._decrypt?this._ghash.update(x):this._ghash.update(f),this._len+=x.length,f},p.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var x=E(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(y,f){var w=0;y.length!==f.length&&w++;for(var A=Math.min(y.length,f.length),P=0;P<A;++P)w+=y[P]^f[P];return w}(x,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=x,this._cipher.scrub()},p.prototype.getAuthTag=function(){if(this._decrypt||!m.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},p.prototype.setAuthTag=function(x){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=x},p.prototype.setAAD=function(x){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(x),this._alen+=x.length},a.exports=p},4881:(a,l,r)=>{var h=r(8613),m=r(7909),v=r(4946);l.createCipher=l.Cipher=h.createCipher,l.createCipheriv=l.Cipheriv=h.createCipheriv,l.createDecipher=l.Decipher=m.createDecipher,l.createDecipheriv=l.Decipheriv=m.createDecipheriv,l.listCiphers=l.getCiphers=function(){return Object.keys(v)}},7909:(a,l,r)=>{var h=r(3499),m=r(9047).Buffer,v=r(6572),g=r(7188),_=r(8842),E=r(7463),b=r(1248);function p(f,w,A){_.call(this),this._cache=new x,this._last=void 0,this._cipher=new E.AES(w),this._prev=m.from(A),this._mode=f,this._autopadding=!0}function x(){this.cache=m.allocUnsafe(0)}function y(f,w,A){var P=v[f.toLowerCase()];if(!P)throw new TypeError("invalid suite type");if(typeof A=="string"&&(A=m.from(A)),P.mode!=="GCM"&&A.length!==P.iv)throw new TypeError("invalid iv length "+A.length);if(typeof w=="string"&&(w=m.from(w)),w.length!==P.key/8)throw new TypeError("invalid key length "+w.length);return P.type==="stream"?new g(P.module,w,A,!0):P.type==="auth"?new h(P.module,w,A,!0):new p(P.module,w,A)}r(376)(p,_),p.prototype._update=function(f){var w,A;this._cache.add(f);for(var P=[];w=this._cache.get(this._autopadding);)A=this._mode.decrypt(this,w),P.push(A);return m.concat(P)},p.prototype._final=function(){var f=this._cache.flush();if(this._autopadding)return function(w){var A=w[15];if(A<1||A>16)throw new Error("unable to decrypt data");for(var P=-1;++P<A;)if(w[P+(16-A)]!==A)throw new Error("unable to decrypt data");if(A!==16)return w.slice(0,16-A)}(this._mode.decrypt(this,f));if(f)throw new Error("data not multiple of block length")},p.prototype.setAutoPadding=function(f){return this._autopadding=!!f,this},x.prototype.add=function(f){this.cache=m.concat([this.cache,f])},x.prototype.get=function(f){var w;if(f){if(this.cache.length>16)return w=this.cache.slice(0,16),this.cache=this.cache.slice(16),w}else if(this.cache.length>=16)return w=this.cache.slice(0,16),this.cache=this.cache.slice(16),w;return null},x.prototype.flush=function(){if(this.cache.length)return this.cache},l.createDecipher=function(f,w){var A=v[f.toLowerCase()];if(!A)throw new TypeError("invalid suite type");var P=b(w,!1,A.key,A.iv);return y(f,P.key,P.iv)},l.createDecipheriv=y},8613:(a,l,r)=>{var h=r(6572),m=r(3499),v=r(9047).Buffer,g=r(7188),_=r(8842),E=r(7463),b=r(1248);function p(w,A,P){_.call(this),this._cache=new y,this._cipher=new E.AES(A),this._prev=v.from(P),this._mode=w,this._autopadding=!0}r(376)(p,_),p.prototype._update=function(w){var A,P;this._cache.add(w);for(var T=[];A=this._cache.get();)P=this._mode.encrypt(this,A),T.push(P);return v.concat(T)};var x=v.alloc(16,16);function y(){this.cache=v.allocUnsafe(0)}function f(w,A,P){var T=h[w.toLowerCase()];if(!T)throw new TypeError("invalid suite type");if(typeof A=="string"&&(A=v.from(A)),A.length!==T.key/8)throw new TypeError("invalid key length "+A.length);if(typeof P=="string"&&(P=v.from(P)),T.mode!=="GCM"&&P.length!==T.iv)throw new TypeError("invalid iv length "+P.length);return T.type==="stream"?new g(T.module,A,P):T.type==="auth"?new m(T.module,A,P):new p(T.module,A,P)}p.prototype._final=function(){var w=this._cache.flush();if(this._autopadding)return w=this._mode.encrypt(this,w),this._cipher.scrub(),w;if(!w.equals(x))throw this._cipher.scrub(),new Error("data not multiple of block length")},p.prototype.setAutoPadding=function(w){return this._autopadding=!!w,this},y.prototype.add=function(w){this.cache=v.concat([this.cache,w])},y.prototype.get=function(){if(this.cache.length>15){var w=this.cache.slice(0,16);return this.cache=this.cache.slice(16),w}return null},y.prototype.flush=function(){for(var w=16-this.cache.length,A=v.allocUnsafe(w),P=-1;++P<w;)A.writeUInt8(w,P);return v.concat([this.cache,A])},l.createCipheriv=f,l.createCipher=function(w,A){var P=h[w.toLowerCase()];if(!P)throw new TypeError("invalid suite type");var T=b(A,!1,P.key,P.iv);return f(w,T.key,T.iv)}},1225:(a,l,r)=>{var h=r(9047).Buffer,m=h.alloc(16,0);function v(_){var E=h.allocUnsafe(16);return E.writeUInt32BE(_[0]>>>0,0),E.writeUInt32BE(_[1]>>>0,4),E.writeUInt32BE(_[2]>>>0,8),E.writeUInt32BE(_[3]>>>0,12),E}function g(_){this.h=_,this.state=h.alloc(16,0),this.cache=h.allocUnsafe(0)}g.prototype.ghash=function(_){for(var E=-1;++E<_.length;)this.state[E]^=_[E];this._multiply()},g.prototype._multiply=function(){for(var _,E,b,p=[(_=this.h).readUInt32BE(0),_.readUInt32BE(4),_.readUInt32BE(8),_.readUInt32BE(12)],x=[0,0,0,0],y=-1;++y<128;){for(this.state[~~(y/8)]&1<<7-y%8&&(x[0]^=p[0],x[1]^=p[1],x[2]^=p[2],x[3]^=p[3]),b=(1&p[3])!=0,E=3;E>0;E--)p[E]=p[E]>>>1|(1&p[E-1])<<31;p[0]=p[0]>>>1,b&&(p[0]=p[0]^-520093696)}this.state=v(x)},g.prototype.update=function(_){var E;for(this.cache=h.concat([this.cache,_]);this.cache.length>=16;)E=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(E)},g.prototype.final=function(_,E){return this.cache.length&&this.ghash(h.concat([this.cache,m],16)),this.ghash(v([0,_,0,E])),this.state},a.exports=g},4001:a=>{a.exports=function(l){for(var r,h=l.length;h--;){if((r=l.readUInt8(h))!==255){r++,l.writeUInt8(r,h);break}l.writeUInt8(0,h)}}},9628:(a,l,r)=>{var h=r(5176);l.encrypt=function(m,v){var g=h(v,m._prev);return m._prev=m._cipher.encryptBlock(g),m._prev},l.decrypt=function(m,v){var g=m._prev;m._prev=v;var _=m._cipher.decryptBlock(v);return h(_,g)}},6674:(a,l,r)=>{var h=r(9047).Buffer,m=r(5176);function v(g,_,E){var b=_.length,p=m(_,g._cache);return g._cache=g._cache.slice(b),g._prev=h.concat([g._prev,E?_:p]),p}l.encrypt=function(g,_,E){for(var b,p=h.allocUnsafe(0);_.length;){if(g._cache.length===0&&(g._cache=g._cipher.encryptBlock(g._prev),g._prev=h.allocUnsafe(0)),!(g._cache.length<=_.length)){p=h.concat([p,v(g,_,E)]);break}b=g._cache.length,p=h.concat([p,v(g,_.slice(0,b),E)]),_=_.slice(b)}return p}},9971:(a,l,r)=>{var h=r(9047).Buffer;function m(g,_,E){for(var b,p,x=-1,y=0;++x<8;)b=_&1<<7-x?128:0,y+=(128&(p=g._cipher.encryptBlock(g._prev)[0]^b))>>x%8,g._prev=v(g._prev,E?b:p);return y}function v(g,_){var E=g.length,b=-1,p=h.allocUnsafe(g.length);for(g=h.concat([g,h.from([_])]);++b<E;)p[b]=g[b]<<1|g[b+1]>>7;return p}l.encrypt=function(g,_,E){for(var b=_.length,p=h.allocUnsafe(b),x=-1;++x<b;)p[x]=m(g,_[x],E);return p}},8194:(a,l,r)=>{var h=r(9047).Buffer;function m(v,g,_){var E=v._cipher.encryptBlock(v._prev)[0]^g;return v._prev=h.concat([v._prev.slice(1),h.from([_?g:E])]),E}l.encrypt=function(v,g,_){for(var E=g.length,b=h.allocUnsafe(E),p=-1;++p<E;)b[p]=m(v,g[p],_);return b}},8871:(a,l,r)=>{var h=r(5176),m=r(9047).Buffer,v=r(4001);function g(_){var E=_._cipher.encryptBlockRaw(_._prev);return v(_._prev),E}l.encrypt=function(_,E){var b=Math.ceil(E.length/16),p=_._cache.length;_._cache=m.concat([_._cache,m.allocUnsafe(16*b)]);for(var x=0;x<b;x++){var y=g(_),f=p+16*x;_._cache.writeUInt32BE(y[0],f+0),_._cache.writeUInt32BE(y[1],f+4),_._cache.writeUInt32BE(y[2],f+8),_._cache.writeUInt32BE(y[3],f+12)}var w=_._cache.slice(0,E.length);return _._cache=_._cache.slice(E.length),h(E,w)}},8972:(a,l)=>{l.encrypt=function(r,h){return r._cipher.encryptBlock(h)},l.decrypt=function(r,h){return r._cipher.decryptBlock(h)}},6572:(a,l,r)=>{var h={ECB:r(8972),CBC:r(9628),CFB:r(6674),CFB8:r(8194),CFB1:r(9971),OFB:r(2343),CTR:r(8871),GCM:r(8871)},m=r(4946);for(var v in m)m[v].module=h[m[v].mode];a.exports=m},2343:(a,l,r)=>{var h=r(365).Buffer,m=r(5176);function v(g){return g._prev=g._cipher.encryptBlock(g._prev),g._prev}l.encrypt=function(g,_){for(;g._cache.length<_.length;)g._cache=h.concat([g._cache,v(g)]);var E=g._cache.slice(0,_.length);return g._cache=g._cache.slice(_.length),m(_,E)}},7188:(a,l,r)=>{var h=r(7463),m=r(9047).Buffer,v=r(8842);function g(_,E,b,p){v.call(this),this._cipher=new h.AES(E),this._prev=m.from(b),this._cache=m.allocUnsafe(0),this._secCache=m.allocUnsafe(0),this._decrypt=p,this._mode=_}r(376)(g,v),g.prototype._update=function(_){return this._mode.encrypt(this,_,this._decrypt)},g.prototype._final=function(){this._cipher.scrub()},a.exports=g},5972:(a,l,r)=>{var h=r(7729),m=r(4881),v=r(6572),g=r(3519),_=r(1248);function E(p,x,y){if(p=p.toLowerCase(),v[p])return m.createCipheriv(p,x,y);if(g[p])return new h({key:x,iv:y,mode:p});throw new TypeError("invalid suite type")}function b(p,x,y){if(p=p.toLowerCase(),v[p])return m.createDecipheriv(p,x,y);if(g[p])return new h({key:x,iv:y,mode:p,decrypt:!0});throw new TypeError("invalid suite type")}l.createCipher=l.Cipher=function(p,x){var y,f;if(p=p.toLowerCase(),v[p])y=v[p].key,f=v[p].iv;else{if(!g[p])throw new TypeError("invalid suite type");y=8*g[p].key,f=g[p].iv}var w=_(x,!1,y,f);return E(p,w.key,w.iv)},l.createCipheriv=l.Cipheriv=E,l.createDecipher=l.Decipher=function(p,x){var y,f;if(p=p.toLowerCase(),v[p])y=v[p].key,f=v[p].iv;else{if(!g[p])throw new TypeError("invalid suite type");y=8*g[p].key,f=g[p].iv}var w=_(x,!1,y,f);return b(p,w.key,w.iv)},l.createDecipheriv=l.Decipheriv=b,l.listCiphers=l.getCiphers=function(){return Object.keys(g).concat(m.getCiphers())}},7729:(a,l,r)=>{var h=r(8842),m=r(167),v=r(376),g=r(9047).Buffer,_={"des-ede3-cbc":m.CBC.instantiate(m.EDE),"des-ede3":m.EDE,"des-ede-cbc":m.CBC.instantiate(m.EDE),"des-ede":m.EDE,"des-cbc":m.CBC.instantiate(m.DES),"des-ecb":m.DES};function E(b){h.call(this);var p,x=b.mode.toLowerCase(),y=_[x];p=b.decrypt?"decrypt":"encrypt";var f=b.key;g.isBuffer(f)||(f=g.from(f)),x!=="des-ede"&&x!=="des-ede-cbc"||(f=g.concat([f,f.slice(0,8)]));var w=b.iv;g.isBuffer(w)||(w=g.from(w)),this._des=y.create({key:f,iv:w,type:p})}_.des=_["des-cbc"],_.des3=_["des-ede3-cbc"],a.exports=E,v(E,h),E.prototype._update=function(b){return g.from(this._des.update(b))},E.prototype._final=function(){return g.from(this._des.final())}},3519:(a,l)=>{l["des-ecb"]={key:8,iv:0},l["des-cbc"]=l.des={key:8,iv:8},l["des-ede3-cbc"]=l.des3={key:24,iv:8},l["des-ede3"]={key:24,iv:0},l["des-ede-cbc"]={key:16,iv:8},l["des-ede"]={key:16,iv:0}},4364:(a,l,r)=>{var h=r(365).Buffer,m=r(815),v=r(5760);function g(E){var b,p=E.modulus.byteLength();do b=new m(v(p));while(b.cmp(E.modulus)>=0||!b.umod(E.prime1)||!b.umod(E.prime2));return b}function _(E,b){var p=function(W){var G=g(W);return{blinder:G.toRed(m.mont(W.modulus)).redPow(new m(W.publicExponent)).fromRed(),unblinder:G.invm(W.modulus)}}(b),x=b.modulus.byteLength(),y=new m(E).mul(p.blinder).umod(b.modulus),f=y.toRed(m.mont(b.prime1)),w=y.toRed(m.mont(b.prime2)),A=b.coefficient,P=b.prime1,T=b.prime2,R=f.redPow(b.exponent1).fromRed(),M=w.redPow(b.exponent2).fromRed(),L=R.isub(M).imul(A).umod(P).imul(T);return M.iadd(L).imul(p.unblinder).umod(b.modulus).toArrayLike(h,"be",x)}_.getr=g,a.exports=_},3363:(a,l,r)=>{a.exports=r(5207)},1022:(a,l,r)=>{var h=r(9047).Buffer,m=r(8339),v=r(5005),g=r(376),_=r(1437),E=r(1113),b=r(5207);function p(w){v.Writable.call(this);var A=b[w];if(!A)throw new Error("Unknown message digest");this._hashType=A.hash,this._hash=m(A.hash),this._tag=A.id,this._signType=A.sign}function x(w){v.Writable.call(this);var A=b[w];if(!A)throw new Error("Unknown message digest");this._hash=m(A.hash),this._tag=A.id,this._signType=A.sign}function y(w){return new p(w)}function f(w){return new x(w)}Object.keys(b).forEach(function(w){b[w].id=h.from(b[w].id,"hex"),b[w.toLowerCase()]=b[w]}),g(p,v.Writable),p.prototype._write=function(w,A,P){this._hash.update(w),P()},p.prototype.update=function(w,A){return this._hash.update(typeof w=="string"?h.from(w,A):w),this},p.prototype.sign=function(w,A){this.end();var P=this._hash.digest(),T=_(P,w,this._hashType,this._signType,this._tag);return A?T.toString(A):T},g(x,v.Writable),x.prototype._write=function(w,A,P){this._hash.update(w),P()},x.prototype.update=function(w,A){return this._hash.update(typeof w=="string"?h.from(w,A):w),this},x.prototype.verify=function(w,A,P){var T=typeof A=="string"?h.from(A,P):A;this.end();var R=this._hash.digest();return E(T,R,w,this._signType,this._tag)},a.exports={Sign:y,Verify:f,createSign:y,createVerify:f}},1437:(a,l,r)=>{var h=r(9047).Buffer,m=r(8736),v=r(4364),g=r(8333).ec,_=r(815),E=r(2914),b=r(1308);function p(w,A,P,T){if((w=h.from(w.toArray())).length<A.byteLength()){var R=h.alloc(A.byteLength()-w.length);w=h.concat([R,w])}var M=P.length,L=function(re,Q){re=(re=x(re,Q)).mod(Q);var oe=h.from(re.toArray());if(oe.length<Q.byteLength()){var ae=h.alloc(Q.byteLength()-oe.length);oe=h.concat([ae,oe])}return oe}(P,A),W=h.alloc(M);W.fill(1);var G=h.alloc(M);return G=m(T,G).update(W).update(h.from([0])).update(w).update(L).digest(),W=m(T,G).update(W).digest(),{k:G=m(T,G).update(W).update(h.from([1])).update(w).update(L).digest(),v:W=m(T,G).update(W).digest()}}function x(w,A){var P=new _(w),T=(w.length<<3)-A.bitLength();return T>0&&P.ishrn(T),P}function y(w,A,P){var T,R;do{for(T=h.alloc(0);8*T.length<w.bitLength();)A.v=m(P,A.k).update(A.v).digest(),T=h.concat([T,A.v]);R=x(T,w),A.k=m(P,A.k).update(A.v).update(h.from([0])).digest(),A.v=m(P,A.k).update(A.v).digest()}while(R.cmp(w)!==-1);return R}function f(w,A,P,T){return w.toRed(_.mont(P)).redPow(A).fromRed().mod(T)}a.exports=function(w,A,P,T,R){var M=E(A);if(M.curve){if(T!=="ecdsa"&&T!=="ecdsa/rsa")throw new Error("wrong private key type");return function(re,Q){var oe=b[Q.curve.join(".")];if(!oe)throw new Error("unknown curve "+Q.curve.join("."));var ae=new g(oe).keyFromPrivate(Q.privateKey).sign(re);return h.from(ae.toDER())}(w,M)}if(M.type==="dsa"){if(T!=="dsa")throw new Error("wrong private key type");return function(re,Q,oe){for(var ae,de=Q.params.priv_key,be=Q.params.p,pe=Q.params.q,U=Q.params.g,B=new _(0),N=x(re,pe).mod(pe),z=!1,H=p(de,pe,re,oe);z===!1;)B=f(U,ae=y(pe,H,oe),be,pe),(z=ae.invm(pe).imul(N.add(de.mul(B))).mod(pe)).cmpn(0)===0&&(z=!1,B=new _(0));return function(Y,fe){Y=Y.toArray(),fe=fe.toArray(),128&Y[0]&&(Y=[0].concat(Y)),128&fe[0]&&(fe=[0].concat(fe));var Re=[48,Y.length+fe.length+4,2,Y.length];return Re=Re.concat(Y,[2,fe.length],fe),h.from(Re)}(B,z)}(w,M,P)}if(T!=="rsa"&&T!=="ecdsa/rsa")throw new Error("wrong private key type");if(A.padding!==void 0&&A.padding!==1)throw new Error("illegal or unsupported padding mode");w=h.concat([R,w]);for(var L=M.modulus.byteLength(),W=[0,1];w.length+W.length+1<L;)W.push(255);W.push(0);for(var G=-1;++G<w.length;)W.push(w[G]);return v(W,M)},a.exports.getKey=p,a.exports.makeKey=y},1113:(a,l,r)=>{var h=r(9047).Buffer,m=r(815),v=r(8333).ec,g=r(2914),_=r(1308);function E(b,p){if(b.cmpn(0)<=0)throw new Error("invalid sig");if(b.cmp(p)>=0)throw new Error("invalid sig")}a.exports=function(b,p,x,y,f){var w=g(x);if(w.type==="ec"){if(y!=="ecdsa"&&y!=="ecdsa/rsa")throw new Error("wrong public key type");return function(W,G,re){var Q=_[re.data.algorithm.curve.join(".")];if(!Q)throw new Error("unknown curve "+re.data.algorithm.curve.join("."));var oe=new v(Q),ae=re.data.subjectPrivateKey.data;return oe.verify(G,W,ae)}(b,p,w)}if(w.type==="dsa"){if(y!=="dsa")throw new Error("wrong public key type");return function(W,G,re){var Q=re.data.p,oe=re.data.q,ae=re.data.g,de=re.data.pub_key,be=g.signature.decode(W,"der"),pe=be.s,U=be.r;E(pe,oe),E(U,oe);var B=m.mont(Q),N=pe.invm(oe);return ae.toRed(B).redPow(new m(G).mul(N).mod(oe)).fromRed().mul(de.toRed(B).redPow(U.mul(N).mod(oe)).fromRed()).mod(Q).mod(oe).cmp(U)===0}(b,p,w)}if(y!=="rsa"&&y!=="ecdsa/rsa")throw new Error("wrong public key type");p=h.concat([f,p]);for(var A=w.modulus.byteLength(),P=[1],T=0;p.length+P.length+2<A;)P.push(255),T+=1;P.push(0);for(var R=-1;++R<p.length;)P.push(p[R]);P=h.from(P);var M=m.mont(w.modulus);b=(b=new m(b).toRed(M)).redPow(new m(w.publicExponent)),b=h.from(b.fromRed().toArray());var L=T<8?1:0;for(A=Math.min(b.length,P.length),b.length!==P.length&&(L=1),R=-1;++R<A;)L|=b[R]^P[R];return L===0}},9337:a=>{function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(v)}var r={};function h(v,g,_){_||(_=Error);var E=function(b){var p,x;function y(f,w,A){return b.call(this,function(P,T,R){return typeof g=="string"?g:g(P,T,R)}(f,w,A))||this}return x=b,(p=y).prototype=Object.create(x.prototype),p.prototype.constructor=p,p.__proto__=x,y}(_);E.prototype.name=_.name,E.prototype.code=v,r[v]=E}function m(v,g){if(Array.isArray(v)){var _=v.length;return v=v.map(function(E){return String(E)}),_>2?"one of ".concat(g," ").concat(v.slice(0,_-1).join(", "),", or ")+v[_-1]:_===2?"one of ".concat(g," ").concat(v[0]," or ").concat(v[1]):"of ".concat(g," ").concat(v[0])}return"of ".concat(g," ").concat(String(v))}h("ERR_INVALID_OPT_VALUE",function(v,g){return'The value "'+g+'" is invalid for option "'+v+'"'},TypeError),h("ERR_INVALID_ARG_TYPE",function(v,g,_){var E,b,p,x,y;if(typeof g=="string"&&(b="not ",g.substr(0,4)===b)?(E="must not be",g=g.replace(/^not /,"")):E="must be",function(w,A,P){return(P===void 0||P>w.length)&&(P=w.length),w.substring(P-9,P)===A}(v," argument"))p="The ".concat(v," ").concat(E," ").concat(m(g,"type"));else{var f=(typeof y!="number"&&(y=0),y+1>(x=v).length||x.indexOf(".",y)===-1?"argument":"property");p='The "'.concat(v,'" ').concat(f," ").concat(E," ").concat(m(g,"type"))}return p+". Received type ".concat(l(_))},TypeError),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),h("ERR_METHOD_NOT_IMPLEMENTED",function(v){return"The "+v+" method is not implemented"}),h("ERR_STREAM_PREMATURE_CLOSE","Premature close"),h("ERR_STREAM_DESTROYED",function(v){return"Cannot call "+v+" after a stream was destroyed"}),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),h("ERR_STREAM_WRITE_AFTER_END","write after end"),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_UNKNOWN_ENCODING",function(v){return"Unknown encoding: "+v},TypeError),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.q=r},3798:(a,l,r)=>{var h=Object.keys||function(y){var f=[];for(var w in y)f.push(w);return f};a.exports=b;var m=r(1001),v=r(4085);r(376)(b,m);for(var g=h(v.prototype),_=0;_<g.length;_++){var E=g[_];b.prototype[E]||(b.prototype[E]=v.prototype[E])}function b(y){if(!(this instanceof b))return new b(y);m.call(this,y),v.call(this,y),this.allowHalfOpen=!0,y&&(y.readable===!1&&(this.readable=!1),y.writable===!1&&(this.writable=!1),y.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",p)))}function p(){this._writableState.ended||{env:{}}.nextTick(x,this)}function x(y){y.end()}Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(b.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(b.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=y,this._writableState.destroyed=y)}})},4707:(a,l,r)=>{a.exports=m;var h=r(1434);function m(v){if(!(this instanceof m))return new m(v);h.call(this,v)}r(376)(m,h),m.prototype._transform=function(v,g,_){_(null,v)}},1001:(a,l,r)=>{var h;a.exports=Q,Q.ReadableState=re,r(9620).EventEmitter;var m,v=function(X,ee){return X.listeners(ee).length},g=r(943),_=r(365).Buffer,E=(r.g!==void 0?r.g:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},b=r(6353);m=b&&b.debuglog?b.debuglog("stream"):function(){};var p,x,y,f=r(1782),w=r(4948),A=r(5807).getHighWaterMark,P=r(9337).q,T=P.ERR_INVALID_ARG_TYPE,R=P.ERR_STREAM_PUSH_AFTER_EOF,M=P.ERR_METHOD_NOT_IMPLEMENTED,L=P.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(376)(Q,g);var W=w.errorOrDestroy,G=["error","close","destroy","pause","resume"];function re(X,ee,Le){h=h||r(3798),X=X||{},typeof Le!="boolean"&&(Le=ee instanceof h),this.objectMode=!!X.objectMode,Le&&(this.objectMode=this.objectMode||!!X.readableObjectMode),this.highWaterMark=A(this,X,"readableHighWaterMark",Le),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=X.emitClose!==!1,this.autoDestroy=!!X.autoDestroy,this.destroyed=!1,this.defaultEncoding=X.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,X.encoding&&(p||(p=r(113).s),this.decoder=new p(X.encoding),this.encoding=X.encoding)}function Q(X){if(h=h||r(3798),!(this instanceof Q))return new Q(X);var ee=this instanceof h;this._readableState=new re(X,this,ee),this.readable=!0,X&&(typeof X.read=="function"&&(this._read=X.read),typeof X.destroy=="function"&&(this._destroy=X.destroy)),g.call(this)}function oe(X,ee,Le,Be,se){m("readableAddChunk",ee);var _e,te=X._readableState;if(ee===null)te.reading=!1,function($e,ge){if(m("onEofChunk"),!ge.ended){if(ge.decoder){var le=ge.decoder.end();le&&le.length&&(ge.buffer.push(le),ge.length+=ge.objectMode?1:le.length)}ge.ended=!0,ge.sync?pe($e):(ge.needReadable=!1,ge.emittedReadable||(ge.emittedReadable=!0,U($e)))}}(X,te);else if(se||(_e=function($e,ge){var le,ze;return ze=ge,_.isBuffer(ze)||ze instanceof E||typeof ge=="string"||ge===void 0||$e.objectMode||(le=new T("chunk",["string","Buffer","Uint8Array"],ge)),le}(te,ee)),_e)W(X,_e);else if(te.objectMode||ee&&ee.length>0)if(typeof ee=="string"||te.objectMode||Object.getPrototypeOf(ee)===_.prototype||(ee=function($e){return _.from($e)}(ee)),Be)te.endEmitted?W(X,new L):ae(X,te,ee,!0);else if(te.ended)W(X,new R);else{if(te.destroyed)return!1;te.reading=!1,te.decoder&&!Le?(ee=te.decoder.write(ee),te.objectMode||ee.length!==0?ae(X,te,ee,!1):B(X,te)):ae(X,te,ee,!1)}else Be||(te.reading=!1,B(X,te));return!te.ended&&(te.length<te.highWaterMark||te.length===0)}function ae(X,ee,Le,Be){ee.flowing&&ee.length===0&&!ee.sync?(ee.awaitDrain=0,X.emit("data",Le)):(ee.length+=ee.objectMode?1:Le.length,Be?ee.buffer.unshift(Le):ee.buffer.push(Le),ee.needReadable&&pe(X)),B(X,ee)}Object.defineProperty(Q.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(X){this._readableState&&(this._readableState.destroyed=X)}}),Q.prototype.destroy=w.destroy,Q.prototype._undestroy=w.undestroy,Q.prototype._destroy=function(X,ee){ee(X)},Q.prototype.push=function(X,ee){var Le,Be=this._readableState;return Be.objectMode?Le=!0:typeof X=="string"&&((ee=ee||Be.defaultEncoding)!==Be.encoding&&(X=_.from(X,ee),ee=""),Le=!0),oe(this,X,ee,!1,Le)},Q.prototype.unshift=function(X){return oe(this,X,null,!0,!1)},Q.prototype.isPaused=function(){return this._readableState.flowing===!1},Q.prototype.setEncoding=function(X){p||(p=r(113).s);var ee=new p(X);this._readableState.decoder=ee,this._readableState.encoding=this._readableState.decoder.encoding;for(var Le=this._readableState.buffer.head,Be="";Le!==null;)Be+=ee.write(Le.data),Le=Le.next;return this._readableState.buffer.clear(),Be!==""&&this._readableState.buffer.push(Be),this._readableState.length=Be.length,this};var de=1073741824;function be(X,ee){return X<=0||ee.length===0&&ee.ended?0:ee.objectMode?1:X!=X?ee.flowing&&ee.length?ee.buffer.head.data.length:ee.length:(X>ee.highWaterMark&&(ee.highWaterMark=function(Le){return Le>=de?Le=de:(Le--,Le|=Le>>>1,Le|=Le>>>2,Le|=Le>>>4,Le|=Le>>>8,Le|=Le>>>16,Le++),Le}(X)),X<=ee.length?X:ee.ended?ee.length:(ee.needReadable=!0,0))}function pe(X){var ee=X._readableState;m("emitReadable",ee.needReadable,ee.emittedReadable),ee.needReadable=!1,ee.emittedReadable||(m("emitReadable",ee.flowing),ee.emittedReadable=!0,{env:{}}.nextTick(U,X))}function U(X){var ee=X._readableState;m("emitReadable_",ee.destroyed,ee.length,ee.ended),ee.destroyed||!ee.length&&!ee.ended||(X.emit("readable"),ee.emittedReadable=!1),ee.needReadable=!ee.flowing&&!ee.ended&&ee.length<=ee.highWaterMark,fe(X)}function B(X,ee){ee.readingMore||(ee.readingMore=!0,{env:{}}.nextTick(N,X,ee))}function N(X,ee){for(;!ee.reading&&!ee.ended&&(ee.length<ee.highWaterMark||ee.flowing&&ee.length===0);){var Le=ee.length;if(m("maybeReadMore read 0"),X.read(0),Le===ee.length)break}ee.readingMore=!1}function z(X){var ee=X._readableState;ee.readableListening=X.listenerCount("readable")>0,ee.resumeScheduled&&!ee.paused?ee.flowing=!0:X.listenerCount("data")>0&&X.resume()}function H(X){m("readable nexttick read 0"),X.read(0)}function Y(X,ee){m("resume",ee.reading),ee.reading||X.read(0),ee.resumeScheduled=!1,X.emit("resume"),fe(X),ee.flowing&&!ee.reading&&X.read(0)}function fe(X){var ee=X._readableState;for(m("flow",ee.flowing);ee.flowing&&X.read()!==null;);}function Re(X,ee){return ee.length===0?null:(ee.objectMode?Le=ee.buffer.shift():!X||X>=ee.length?(Le=ee.decoder?ee.buffer.join(""):ee.buffer.length===1?ee.buffer.first():ee.buffer.concat(ee.length),ee.buffer.clear()):Le=ee.buffer.consume(X,ee.decoder),Le);var Le}function Oe(X){var ee=X._readableState;m("endReadable",ee.endEmitted),ee.endEmitted||(ee.ended=!0,{env:{}}.nextTick(De,ee,X))}function De(X,ee){if(m("endReadableNT",X.endEmitted,X.length),!X.endEmitted&&X.length===0&&(X.endEmitted=!0,ee.readable=!1,ee.emit("end"),X.autoDestroy)){var Le=ee._writableState;(!Le||Le.autoDestroy&&Le.finished)&&ee.destroy()}}function ot(X,ee){for(var Le=0,Be=X.length;Le<Be;Le++)if(X[Le]===ee)return Le;return-1}Q.prototype.read=function(X){m("read",X),X=parseInt(X,10);var ee=this._readableState,Le=X;if(X!==0&&(ee.emittedReadable=!1),X===0&&ee.needReadable&&((ee.highWaterMark!==0?ee.length>=ee.highWaterMark:ee.length>0)||ee.ended))return m("read: emitReadable",ee.length,ee.ended),ee.length===0&&ee.ended?Oe(this):pe(this),null;if((X=be(X,ee))===0&&ee.ended)return ee.length===0&&Oe(this),null;var Be,se=ee.needReadable;return m("need readable",se),(ee.length===0||ee.length-X<ee.highWaterMark)&&m("length less than watermark",se=!0),ee.ended||ee.reading?m("reading or ended",se=!1):se&&(m("do read"),ee.reading=!0,ee.sync=!0,ee.length===0&&(ee.needReadable=!0),this._read(ee.highWaterMark),ee.sync=!1,ee.reading||(X=be(Le,ee))),(Be=X>0?Re(X,ee):null)===null?(ee.needReadable=ee.length<=ee.highWaterMark,X=0):(ee.length-=X,ee.awaitDrain=0),ee.length===0&&(ee.ended||(ee.needReadable=!0),Le!==X&&ee.ended&&Oe(this)),Be!==null&&this.emit("data",Be),Be},Q.prototype._read=function(X){W(this,new M("_read()"))},Q.prototype.pipe=function(X,ee){var Le=this,Be=this._readableState;switch(Be.pipesCount){case 0:Be.pipes=X;break;case 1:Be.pipes=[Be.pipes,X];break;default:Be.pipes.push(X)}Be.pipesCount+=1,m("pipe count=%d opts=%j",Be.pipesCount,ee);var se=ee&&ee.end===!1||X==={env:{}}.stdout||X==={env:{}}.stderr?et:_e;function _e(){m("onend"),X.end()}Be.endEmitted?{env:{}}.nextTick(se):Le.once("end",se),X.on("unpipe",function ft(wt,It){m("onunpipe"),wt===Le&&It&&It.hasUnpiped===!1&&(It.hasUnpiped=!0,m("cleanup"),X.removeListener("close",ze),X.removeListener("finish",Je),X.removeListener("drain",te),X.removeListener("error",le),X.removeListener("unpipe",ft),Le.removeListener("end",_e),Le.removeListener("end",et),Le.removeListener("data",ge),$e=!0,!Be.awaitDrain||X._writableState&&!X._writableState.needDrain||te())});var te=function(ft){return function(){var wt=ft._readableState;m("pipeOnDrain",wt.awaitDrain),wt.awaitDrain&&wt.awaitDrain--,wt.awaitDrain===0&&v(ft,"data")&&(wt.flowing=!0,fe(ft))}}(Le);X.on("drain",te);var $e=!1;function ge(ft){m("ondata");var wt=X.write(ft);m("dest.write",wt),wt===!1&&((Be.pipesCount===1&&Be.pipes===X||Be.pipesCount>1&&ot(Be.pipes,X)!==-1)&&!$e&&(m("false write response, pause",Be.awaitDrain),Be.awaitDrain++),Le.pause())}function le(ft){m("onerror",ft),et(),X.removeListener("error",le),v(X,"error")===0&&W(X,ft)}function ze(){X.removeListener("finish",Je),et()}function Je(){m("onfinish"),X.removeListener("close",ze),et()}function et(){m("unpipe"),Le.unpipe(X)}return Le.on("data",ge),function(ft,wt,It){if(typeof ft.prependListener=="function")return ft.prependListener(wt,It);ft._events&&ft._events[wt]?Array.isArray(ft._events[wt])?ft._events[wt].unshift(It):ft._events[wt]=[It,ft._events[wt]]:ft.on(wt,It)}(X,"error",le),X.once("close",ze),X.once("finish",Je),X.emit("pipe",Le),Be.flowing||(m("pipe resume"),Le.resume()),X},Q.prototype.unpipe=function(X){var ee=this._readableState,Le={hasUnpiped:!1};if(ee.pipesCount===0)return this;if(ee.pipesCount===1)return X&&X!==ee.pipes||(X||(X=ee.pipes),ee.pipes=null,ee.pipesCount=0,ee.flowing=!1,X&&X.emit("unpipe",this,Le)),this;if(!X){var Be=ee.pipes,se=ee.pipesCount;ee.pipes=null,ee.pipesCount=0,ee.flowing=!1;for(var _e=0;_e<se;_e++)Be[_e].emit("unpipe",this,{hasUnpiped:!1});return this}var te=ot(ee.pipes,X);return te===-1||(ee.pipes.splice(te,1),ee.pipesCount-=1,ee.pipesCount===1&&(ee.pipes=ee.pipes[0]),X.emit("unpipe",this,Le)),this},Q.prototype.on=function(X,ee){var Le=g.prototype.on.call(this,X,ee),Be=this._readableState;return X==="data"?(Be.readableListening=this.listenerCount("readable")>0,Be.flowing!==!1&&this.resume()):X==="readable"&&(Be.endEmitted||Be.readableListening||(Be.readableListening=Be.needReadable=!0,Be.flowing=!1,Be.emittedReadable=!1,m("on readable",Be.length,Be.reading),Be.length?pe(this):Be.reading||{env:{}}.nextTick(H,this))),Le},Q.prototype.addListener=Q.prototype.on,Q.prototype.removeListener=function(X,ee){var Le=g.prototype.removeListener.call(this,X,ee);return X==="readable"&&{env:{}}.nextTick(z,this),Le},Q.prototype.removeAllListeners=function(X){var ee=g.prototype.removeAllListeners.apply(this,arguments);return X!=="readable"&&X!==void 0||{env:{}}.nextTick(z,this),ee},Q.prototype.resume=function(){var X=this._readableState;return X.flowing||(m("resume"),X.flowing=!X.readableListening,function(ee,Le){Le.resumeScheduled||(Le.resumeScheduled=!0,{env:{}}.nextTick(Y,ee,Le))}(this,X)),X.paused=!1,this},Q.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},Q.prototype.wrap=function(X){var ee=this,Le=this._readableState,Be=!1;for(var se in X.on("end",function(){if(m("wrapped end"),Le.decoder&&!Le.ended){var te=Le.decoder.end();te&&te.length&&ee.push(te)}ee.push(null)}),X.on("data",function(te){m("wrapped data"),Le.decoder&&(te=Le.decoder.write(te)),Le.objectMode&&te==null||(Le.objectMode||te&&te.length)&&(ee.push(te)||(Be=!0,X.pause()))}),X)this[se]===void 0&&typeof X[se]=="function"&&(this[se]=function(te){return function(){return X[te].apply(X,arguments)}}(se));for(var _e=0;_e<G.length;_e++)X.on(G[_e],this.emit.bind(this,G[_e]));return this._read=function(te){m("wrapped _read",te),Be&&(Be=!1,X.resume())},this},typeof Symbol=="function"&&(Q.prototype[Symbol.asyncIterator]=function(){return x===void 0&&(x=r(2828)),x(this)}),Object.defineProperty(Q.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Q.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Q.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(X){this._readableState&&(this._readableState.flowing=X)}}),Q._fromList=Re,Object.defineProperty(Q.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(Q.from=function(X,ee){return y===void 0&&(y=r(1318)),y(Q,X,ee)})},1434:(a,l,r)=>{a.exports=p;var h=r(9337).q,m=h.ERR_METHOD_NOT_IMPLEMENTED,v=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,_=h.ERR_TRANSFORM_WITH_LENGTH_0,E=r(3798);function b(f,w){var A=this._transformState;A.transforming=!1;var P=A.writecb;if(P===null)return this.emit("error",new v);A.writechunk=null,A.writecb=null,w!=null&&this.push(w),P(f);var T=this._readableState;T.reading=!1,(T.needReadable||T.length<T.highWaterMark)&&this._read(T.highWaterMark)}function p(f){if(!(this instanceof p))return new p(f);E.call(this,f),this._transformState={afterTransform:b.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",x)}function x(){var f=this;typeof this._flush!="function"||this._readableState.destroyed?y(this,null,null):this._flush(function(w,A){y(f,w,A)})}function y(f,w,A){if(w)return f.emit("error",w);if(A!=null&&f.push(A),f._writableState.length)throw new _;if(f._transformState.transforming)throw new g;return f.push(null)}r(376)(p,E),p.prototype.push=function(f,w){return this._transformState.needTransform=!1,E.prototype.push.call(this,f,w)},p.prototype._transform=function(f,w,A){A(new m("_transform()"))},p.prototype._write=function(f,w,A){var P=this._transformState;if(P.writecb=A,P.writechunk=f,P.writeencoding=w,!P.transforming){var T=this._readableState;(P.needTransform||T.needReadable||T.length<T.highWaterMark)&&this._read(T.highWaterMark)}},p.prototype._read=function(f){var w=this._transformState;w.writechunk===null||w.transforming?w.needTransform=!0:(w.transforming=!0,this._transform(w.writechunk,w.writeencoding,w.afterTransform))},p.prototype._destroy=function(f,w){E.prototype._destroy.call(this,f,function(A){w(A)})}},4085:(a,l,r)=>{function h(B){var N=this;this.next=null,this.entry=null,this.finish=function(){(function(z,H,Y){var fe=z.entry;for(z.entry=null;fe;){var Re=fe.callback;H.pendingcb--,Re(void 0),fe=fe.next}H.corkedRequestsFree.next=z})(N,B)}}var m;a.exports=Q,Q.WritableState=re;var v,g={deprecate:r(8016)},_=r(943),E=r(365).Buffer,b=(r.g!==void 0?r.g:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},p=r(4948),x=r(5807).getHighWaterMark,y=r(9337).q,f=y.ERR_INVALID_ARG_TYPE,w=y.ERR_METHOD_NOT_IMPLEMENTED,A=y.ERR_MULTIPLE_CALLBACK,P=y.ERR_STREAM_CANNOT_PIPE,T=y.ERR_STREAM_DESTROYED,R=y.ERR_STREAM_NULL_VALUES,M=y.ERR_STREAM_WRITE_AFTER_END,L=y.ERR_UNKNOWN_ENCODING,W=p.errorOrDestroy;function G(){}function re(B,N,z){m=m||r(3798),B=B||{},typeof z!="boolean"&&(z=N instanceof m),this.objectMode=!!B.objectMode,z&&(this.objectMode=this.objectMode||!!B.writableObjectMode),this.highWaterMark=x(this,B,"writableHighWaterMark",z),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var H=B.decodeStrings===!1;this.decodeStrings=!H,this.defaultEncoding=B.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Y){(function(fe,Re){var Oe=fe._writableState,De=Oe.sync,ot=Oe.writecb;if(typeof ot!="function")throw new A;if(function(ee){ee.writing=!1,ee.writecb=null,ee.length-=ee.writelen,ee.writelen=0}(Oe),Re)(function(ee,Le,Be,se,_e){--Le.pendingcb,Be?({env:{}}.nextTick(_e,se),{env:{}}.nextTick(U,ee,Le),ee._writableState.errorEmitted=!0,W(ee,se)):(_e(se),ee._writableState.errorEmitted=!0,W(ee,se),U(ee,Le))})(fe,Oe,De,Re,ot);else{var X=be(Oe)||fe.destroyed;X||Oe.corked||Oe.bufferProcessing||!Oe.bufferedRequest||de(fe,Oe),De?{env:{}}.nextTick(ae,fe,Oe,X,ot):ae(fe,Oe,X,ot)}})(N,Y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=B.emitClose!==!1,this.autoDestroy=!!B.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}function Q(B){var N=this instanceof(m=m||r(3798));if(!N&&!v.call(Q,this))return new Q(B);this._writableState=new re(B,this,N),this.writable=!0,B&&(typeof B.write=="function"&&(this._write=B.write),typeof B.writev=="function"&&(this._writev=B.writev),typeof B.destroy=="function"&&(this._destroy=B.destroy),typeof B.final=="function"&&(this._final=B.final)),_.call(this)}function oe(B,N,z,H,Y,fe,Re){N.writelen=H,N.writecb=Re,N.writing=!0,N.sync=!0,N.destroyed?N.onwrite(new T("write")):z?B._writev(Y,N.onwrite):B._write(Y,fe,N.onwrite),N.sync=!1}function ae(B,N,z,H){z||function(Y,fe){fe.length===0&&fe.needDrain&&(fe.needDrain=!1,Y.emit("drain"))}(B,N),N.pendingcb--,H(),U(B,N)}function de(B,N){N.bufferProcessing=!0;var z=N.bufferedRequest;if(B._writev&&z&&z.next){var H=N.bufferedRequestCount,Y=new Array(H),fe=N.corkedRequestsFree;fe.entry=z;for(var Re=0,Oe=!0;z;)Y[Re]=z,z.isBuf||(Oe=!1),z=z.next,Re+=1;Y.allBuffers=Oe,oe(B,N,!0,N.length,Y,"",fe.finish),N.pendingcb++,N.lastBufferedRequest=null,fe.next?(N.corkedRequestsFree=fe.next,fe.next=null):N.corkedRequestsFree=new h(N),N.bufferedRequestCount=0}else{for(;z;){var De=z.chunk,ot=z.encoding,X=z.callback;if(oe(B,N,!1,N.objectMode?1:De.length,De,ot,X),z=z.next,N.bufferedRequestCount--,N.writing)break}z===null&&(N.lastBufferedRequest=null)}N.bufferedRequest=z,N.bufferProcessing=!1}function be(B){return B.ending&&B.length===0&&B.bufferedRequest===null&&!B.finished&&!B.writing}function pe(B,N){B._final(function(z){N.pendingcb--,z&&W(B,z),N.prefinished=!0,B.emit("prefinish"),U(B,N)})}function U(B,N){var z=be(N);if(z&&(function(Y,fe){fe.prefinished||fe.finalCalled||(typeof Y._final!="function"||fe.destroyed?(fe.prefinished=!0,Y.emit("prefinish")):(fe.pendingcb++,fe.finalCalled=!0,{env:{}}.nextTick(pe,Y,fe)))}(B,N),N.pendingcb===0&&(N.finished=!0,B.emit("finish"),N.autoDestroy))){var H=B._readableState;(!H||H.autoDestroy&&H.endEmitted)&&B.destroy()}return z}r(376)(Q,_),re.prototype.getBuffer=function(){for(var B=this.bufferedRequest,N=[];B;)N.push(B),B=B.next;return N},function(){try{Object.defineProperty(re.prototype,"buffer",{get:g.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(Q,Symbol.hasInstance,{value:function(B){return!!v.call(this,B)||this===Q&&B&&B._writableState instanceof re}})):v=function(B){return B instanceof this},Q.prototype.pipe=function(){W(this,new P)},Q.prototype.write=function(B,N,z){var H,Y=this._writableState,fe=!1,Re=!Y.objectMode&&(H=B,E.isBuffer(H)||H instanceof b);return Re&&!E.isBuffer(B)&&(B=function(Oe){return E.from(Oe)}(B)),typeof N=="function"&&(z=N,N=null),Re?N="buffer":N||(N=Y.defaultEncoding),typeof z!="function"&&(z=G),Y.ending?function(Oe,De){var ot=new M;W(Oe,ot),{env:{}}.nextTick(De,ot)}(this,z):(Re||function(Oe,De,ot,X){var ee;return ot===null?ee=new R:typeof ot=="string"||De.objectMode||(ee=new f("chunk",["string","Buffer"],ot)),!ee||(W(Oe,ee),{env:{}}.nextTick(X,ee),!1)}(this,Y,B,z))&&(Y.pendingcb++,fe=function(Oe,De,ot,X,ee,Le){if(!ot){var Be=function($e,ge,le){return $e.objectMode||$e.decodeStrings===!1||typeof ge!="string"||(ge=E.from(ge,le)),ge}(De,X,ee);X!==Be&&(ot=!0,ee="buffer",X=Be)}var se=De.objectMode?1:X.length;De.length+=se;var _e=De.length<De.highWaterMark;if(_e||(De.needDrain=!0),De.writing||De.corked){var te=De.lastBufferedRequest;De.lastBufferedRequest={chunk:X,encoding:ee,isBuf:ot,callback:Le,next:null},te?te.next=De.lastBufferedRequest:De.bufferedRequest=De.lastBufferedRequest,De.bufferedRequestCount+=1}else oe(Oe,De,!1,se,X,ee,Le);return _e}(this,Y,Re,B,N,z)),fe},Q.prototype.cork=function(){this._writableState.corked++},Q.prototype.uncork=function(){var B=this._writableState;B.corked&&(B.corked--,B.writing||B.corked||B.bufferProcessing||!B.bufferedRequest||de(this,B))},Q.prototype.setDefaultEncoding=function(B){if(typeof B=="string"&&(B=B.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((B+"").toLowerCase())>-1))throw new L(B);return this._writableState.defaultEncoding=B,this},Object.defineProperty(Q.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Q.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Q.prototype._write=function(B,N,z){z(new w("_write()"))},Q.prototype._writev=null,Q.prototype.end=function(B,N,z){var H=this._writableState;return typeof B=="function"?(z=B,B=null,N=null):typeof N=="function"&&(z=N,N=null),B!=null&&this.write(B,N),H.corked&&(H.corked=1,this.uncork()),H.ending||function(Y,fe,Re){fe.ending=!0,U(Y,fe),Re&&(fe.finished?{env:{}}.nextTick(Re):Y.once("finish",Re)),fe.ended=!0,Y.writable=!1}(this,H,z),this},Object.defineProperty(Q.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Q.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(B){this._writableState&&(this._writableState.destroyed=B)}}),Q.prototype.destroy=p.destroy,Q.prototype._undestroy=p.undestroy,Q.prototype._destroy=function(B,N){N(B)}},2828:(a,l,r)=>{function h(M){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},h(M)}var m;function v(M,L,W){return(L=function(G){var re=function(Q,oe){if(h(Q)!=="object"||Q===null)return Q;var ae=Q[Symbol.toPrimitive];if(ae!==void 0){var de=ae.call(Q,"string");if(h(de)!=="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Q)}(G);return h(re)==="symbol"?re:String(re)}(L))in M?Object.defineProperty(M,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):M[L]=W,M}var g=r(1362),_=Symbol("lastResolve"),E=Symbol("lastReject"),b=Symbol("error"),p=Symbol("ended"),x=Symbol("lastPromise"),y=Symbol("handlePromise"),f=Symbol("stream");function w(M,L){return{value:M,done:L}}function A(M){var L=M[_];if(L!==null){var W=M[f].read();W!==null&&(M[x]=null,M[_]=null,M[E]=null,L(w(W,!1)))}}function P(M){({env:{}}).nextTick(A,M)}var T=Object.getPrototypeOf(function(){}),R=Object.setPrototypeOf((v(m={get stream(){return this[f]},next:function(){var M=this,L=this[b];if(L!==null)return Promise.reject(L);if(this[p])return Promise.resolve(w(void 0,!0));if(this[f].destroyed)return new Promise(function(Q,oe){({env:{}}).nextTick(function(){M[b]?oe(M[b]):Q(w(void 0,!0))})});var W,G=this[x];if(G)W=new Promise(function(Q,oe){return function(ae,de){Q.then(function(){oe[p]?ae(w(void 0,!0)):oe[y](ae,de)},de)}}(G,this));else{var re=this[f].read();if(re!==null)return Promise.resolve(w(re,!1));W=new Promise(this[y])}return this[x]=W,W}},Symbol.asyncIterator,function(){return this}),v(m,"return",function(){var M=this;return new Promise(function(L,W){M[f].destroy(null,function(G){G?W(G):L(w(void 0,!0))})})}),m),T);a.exports=function(M){var L,W=Object.create(R,(v(L={},f,{value:M,writable:!0}),v(L,_,{value:null,writable:!0}),v(L,E,{value:null,writable:!0}),v(L,b,{value:null,writable:!0}),v(L,p,{value:M._readableState.endEmitted,writable:!0}),v(L,y,{value:function(G,re){var Q=W[f].read();Q?(W[x]=null,W[_]=null,W[E]=null,G(w(Q,!1))):(W[_]=G,W[E]=re)},writable:!0}),L));return W[x]=null,g(M,function(G){if(G&&G.code!=="ERR_STREAM_PREMATURE_CLOSE"){var re=W[E];return re!==null&&(W[x]=null,W[_]=null,W[E]=null,re(G)),void(W[b]=G)}var Q=W[_];Q!==null&&(W[x]=null,W[_]=null,W[E]=null,Q(w(void 0,!0))),W[p]=!0}),M.on("readable",P.bind(null,W)),W}},1782:(a,l,r)=>{function h(y){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},h(y)}function m(y,f){var w=Object.keys(y);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(y);f&&(A=A.filter(function(P){return Object.getOwnPropertyDescriptor(y,P).enumerable})),w.push.apply(w,A)}return w}function v(y){for(var f=1;f<arguments.length;f++){var w=arguments[f]!=null?arguments[f]:{};f%2?m(Object(w),!0).forEach(function(A){g(y,A,w[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(w)):m(Object(w)).forEach(function(A){Object.defineProperty(y,A,Object.getOwnPropertyDescriptor(w,A))})}return y}function g(y,f,w){return(f=E(f))in y?Object.defineProperty(y,f,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[f]=w,y}function _(y,f){for(var w=0;w<f.length;w++){var A=f[w];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(y,E(A.key),A)}}function E(y){var f=function(w,A){if(h(w)!=="object"||w===null)return w;var P=w[Symbol.toPrimitive];if(P!==void 0){var T=P.call(w,"string");if(h(T)!=="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(w)}(y);return h(f)==="symbol"?f:String(f)}var b=r(365).Buffer,p=r(6419).inspect,x=p&&p.custom||"inspect";a.exports=function(){function y(){(function(A,P){if(!(A instanceof P))throw new TypeError("Cannot call a class as a function")})(this,y),this.head=null,this.tail=null,this.length=0}var f,w;return f=y,(w=[{key:"push",value:function(A){var P={data:A,next:null};this.length>0?this.tail.next=P:this.head=P,this.tail=P,++this.length}},{key:"unshift",value:function(A){var P={data:A,next:this.head};this.length===0&&(this.tail=P),this.head=P,++this.length}},{key:"shift",value:function(){if(this.length!==0){var A=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,A}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(A){if(this.length===0)return"";for(var P=this.head,T=""+P.data;P=P.next;)T+=A+P.data;return T}},{key:"concat",value:function(A){if(this.length===0)return b.alloc(0);for(var P,T,R,M=b.allocUnsafe(A>>>0),L=this.head,W=0;L;)P=L.data,T=M,R=W,b.prototype.copy.call(P,T,R),W+=L.data.length,L=L.next;return M}},{key:"consume",value:function(A,P){var T;return A<this.head.data.length?(T=this.head.data.slice(0,A),this.head.data=this.head.data.slice(A)):T=A===this.head.data.length?this.shift():P?this._getString(A):this._getBuffer(A),T}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(A){var P=this.head,T=1,R=P.data;for(A-=R.length;P=P.next;){var M=P.data,L=A>M.length?M.length:A;if(L===M.length?R+=M:R+=M.slice(0,A),(A-=L)==0){L===M.length?(++T,P.next?this.head=P.next:this.head=this.tail=null):(this.head=P,P.data=M.slice(L));break}++T}return this.length-=T,R}},{key:"_getBuffer",value:function(A){var P=b.allocUnsafe(A),T=this.head,R=1;for(T.data.copy(P),A-=T.data.length;T=T.next;){var M=T.data,L=A>M.length?M.length:A;if(M.copy(P,P.length-A,0,L),(A-=L)==0){L===M.length?(++R,T.next?this.head=T.next:this.head=this.tail=null):(this.head=T,T.data=M.slice(L));break}++R}return this.length-=R,P}},{key:x,value:function(A,P){return p(this,v(v({},P),{},{depth:0,customInspect:!1}))}}])&&_(f.prototype,w),Object.defineProperty(f,"prototype",{writable:!1}),y}()},4948:a=>{function l(m,v){h(m,v),r(m)}function r(m){m._writableState&&!m._writableState.emitClose||m._readableState&&!m._readableState.emitClose||m.emit("close")}function h(m,v){m.emit("error",v)}a.exports={destroy:function(m,v){var g=this,_=this._readableState&&this._readableState.destroyed,E=this._writableState&&this._writableState.destroyed;return _||E?(v?v(m):m&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,{env:{}}.nextTick(h,this,m)):{env:{}}.nextTick(h,this,m)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(m||null,function(b){!v&&b?g._writableState?g._writableState.errorEmitted?{env:{}}.nextTick(r,g):(g._writableState.errorEmitted=!0,{env:{}}.nextTick(l,g,b)):{env:{}}.nextTick(l,g,b):v?({env:{}}.nextTick(r,g),v(b)):{env:{}}.nextTick(r,g)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(m,v){var g=m._readableState,_=m._writableState;g&&g.autoDestroy||_&&_.autoDestroy?m.destroy(v):m.emit("error",v)}}},1362:(a,l,r)=>{var h=r(9337).q.ERR_STREAM_PREMATURE_CLOSE;function m(){}a.exports=function v(g,_,E){if(typeof _=="function")return v(g,null,_);_||(_={}),E=function(M){var L=!1;return function(){if(!L){L=!0;for(var W=arguments.length,G=new Array(W),re=0;re<W;re++)G[re]=arguments[re];M.apply(this,G)}}}(E||m);var b=_.readable||_.readable!==!1&&g.readable,p=_.writable||_.writable!==!1&&g.writable,x=function(){g.writable||f()},y=g._writableState&&g._writableState.finished,f=function(){p=!1,y=!0,b||E.call(g)},w=g._readableState&&g._readableState.endEmitted,A=function(){b=!1,w=!0,p||E.call(g)},P=function(M){E.call(g,M)},T=function(){var M;return b&&!w?(g._readableState&&g._readableState.ended||(M=new h),E.call(g,M)):p&&!y?(g._writableState&&g._writableState.ended||(M=new h),E.call(g,M)):void 0},R=function(){g.req.on("finish",f)};return function(M){return M.setHeader&&typeof M.abort=="function"}(g)?(g.on("complete",f),g.on("abort",T),g.req?R():g.on("request",R)):p&&!g._writableState&&(g.on("end",x),g.on("close",x)),g.on("end",A),g.on("finish",f),_.error!==!1&&g.on("error",P),g.on("close",T),function(){g.removeListener("complete",f),g.removeListener("abort",T),g.removeListener("request",R),g.req&&g.req.removeListener("finish",f),g.removeListener("end",x),g.removeListener("close",x),g.removeListener("finish",f),g.removeListener("end",A),g.removeListener("error",P),g.removeListener("close",T)}}},1318:a=>{a.exports=function(){throw new Error("Readable.from is not available in the browser")}},9589:(a,l,r)=>{var h,m=r(9337).q,v=m.ERR_MISSING_ARGS,g=m.ERR_STREAM_DESTROYED;function _(p){if(p)throw p}function E(p){p()}function b(p,x){return p.pipe(x)}a.exports=function(){for(var p=arguments.length,x=new Array(p),y=0;y<p;y++)x[y]=arguments[y];var f,w=function(P){return P.length?typeof P[P.length-1]!="function"?_:P.pop():_}(x);if(Array.isArray(x[0])&&(x=x[0]),x.length<2)throw new v("streams");var A=x.map(function(P,T){var R=T<x.length-1;return function(M,L,W,G){G=function(oe){var ae=!1;return function(){ae||(ae=!0,oe.apply(void 0,arguments))}}(G);var re=!1;M.on("close",function(){re=!0}),h===void 0&&(h=r(1362)),h(M,{readable:L,writable:W},function(oe){if(oe)return G(oe);re=!0,G()});var Q=!1;return function(oe){if(!re&&!Q)return Q=!0,function(ae){return ae.setHeader&&typeof ae.abort=="function"}(M)?M.abort():typeof M.destroy=="function"?M.destroy():void G(oe||new g("pipe"))}}(P,R,T>0,function(M){f||(f=M),M&&A.forEach(E),R||(A.forEach(E),w(f))})});return x.reduce(b)}},5807:(a,l,r)=>{var h=r(9337).q.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(m,v,g,_){var E=function(b,p,x){return b.highWaterMark!=null?b.highWaterMark:p?b[x]:null}(v,_,g);if(E!=null){if(!isFinite(E)||Math.floor(E)!==E||E<0)throw new h(_?g:"highWaterMark",E);return Math.floor(E)}return m.objectMode?16:16384}}},943:(a,l,r)=>{a.exports=r(9620).EventEmitter},5005:(a,l,r)=>{(l=a.exports=r(1001)).Stream=l,l.Readable=l,l.Writable=r(4085),l.Duplex=r(3798),l.Transform=r(1434),l.PassThrough=r(4707),l.finished=r(1362),l.pipeline=r(9589)},5176:(a,l,r)=>{var h=r(365).Buffer;a.exports=function(m,v){for(var g=Math.min(m.length,v.length),_=new h(g),E=0;E<g;++E)_[E]=m[E]^v[E];return _}},365:(a,l,r)=>{function h(se){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof Symbol=="function"&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e},h(se)}var m=r(7943),v=r(8405),g=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;l.Buffer=b,l.SlowBuffer=function(se){return+se!=se&&(se=0),b.alloc(+se)},l.INSPECT_MAX_BYTES=50;var _=2147483647;function E(se){if(se>_)throw new RangeError('The value "'+se+'" is invalid for option "size"');var _e=new Uint8Array(se);return Object.setPrototypeOf(_e,b.prototype),_e}function b(se,_e,te){if(typeof se=="number"){if(typeof _e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(se)}return p(se,_e,te)}function p(se,_e,te){if(typeof se=="string")return function(le,ze){if(typeof ze=="string"&&ze!==""||(ze="utf8"),!b.isEncoding(ze))throw new TypeError("Unknown encoding: "+ze);var Je=0|P(le,ze),et=E(Je),ft=et.write(le,ze);return ft!==Je&&(et=et.slice(0,ft)),et}(se,_e);if(ArrayBuffer.isView(se))return function(le){if(ee(le,Uint8Array)){var ze=new Uint8Array(le);return w(ze.buffer,ze.byteOffset,ze.byteLength)}return f(le)}(se);if(se==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+h(se));if(ee(se,ArrayBuffer)||se&&ee(se.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ee(se,SharedArrayBuffer)||se&&ee(se.buffer,SharedArrayBuffer)))return w(se,_e,te);if(typeof se=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var $e=se.valueOf&&se.valueOf();if($e!=null&&$e!==se)return b.from($e,_e,te);var ge=function(le){if(b.isBuffer(le)){var ze=0|A(le.length),Je=E(ze);return Je.length===0||le.copy(Je,0,0,ze),Je}return le.length!==void 0?typeof le.length!="number"||Le(le.length)?E(0):f(le):le.type==="Buffer"&&Array.isArray(le.data)?f(le.data):void 0}(se);if(ge)return ge;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof se[Symbol.toPrimitive]=="function")return b.from(se[Symbol.toPrimitive]("string"),_e,te);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+h(se))}function x(se){if(typeof se!="number")throw new TypeError('"size" argument must be of type number');if(se<0)throw new RangeError('The value "'+se+'" is invalid for option "size"')}function y(se){return x(se),E(se<0?0:0|A(se))}function f(se){for(var _e=se.length<0?0:0|A(se.length),te=E(_e),$e=0;$e<_e;$e+=1)te[$e]=255&se[$e];return te}function w(se,_e,te){if(_e<0||se.byteLength<_e)throw new RangeError('"offset" is outside of buffer bounds');if(se.byteLength<_e+(te||0))throw new RangeError('"length" is outside of buffer bounds');var $e;return $e=_e===void 0&&te===void 0?new Uint8Array(se):te===void 0?new Uint8Array(se,_e):new Uint8Array(se,_e,te),Object.setPrototypeOf($e,b.prototype),$e}function A(se){if(se>=_)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+_.toString(16)+" bytes");return 0|se}function P(se,_e){if(b.isBuffer(se))return se.length;if(ArrayBuffer.isView(se)||ee(se,ArrayBuffer))return se.byteLength;if(typeof se!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+h(se));var te=se.length,$e=arguments.length>2&&arguments[2]===!0;if(!$e&&te===0)return 0;for(var ge=!1;;)switch(_e){case"ascii":case"latin1":case"binary":return te;case"utf8":case"utf-8":return De(se).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*te;case"hex":return te>>>1;case"base64":return ot(se).length;default:if(ge)return $e?-1:De(se).length;_e=(""+_e).toLowerCase(),ge=!0}}function T(se,_e,te){var $e=!1;if((_e===void 0||_e<0)&&(_e=0),_e>this.length||((te===void 0||te>this.length)&&(te=this.length),te<=0)||(te>>>=0)<=(_e>>>=0))return"";for(se||(se="utf8");;)switch(se){case"hex":return B(this,_e,te);case"utf8":case"utf-8":return de(this,_e,te);case"ascii":return pe(this,_e,te);case"latin1":case"binary":return U(this,_e,te);case"base64":return ae(this,_e,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,_e,te);default:if($e)throw new TypeError("Unknown encoding: "+se);se=(se+"").toLowerCase(),$e=!0}}function R(se,_e,te){var $e=se[_e];se[_e]=se[te],se[te]=$e}function M(se,_e,te,$e,ge){if(se.length===0)return-1;if(typeof te=="string"?($e=te,te=0):te>2147483647?te=2147483647:te<-2147483648&&(te=-2147483648),Le(te=+te)&&(te=ge?0:se.length-1),te<0&&(te=se.length+te),te>=se.length){if(ge)return-1;te=se.length-1}else if(te<0){if(!ge)return-1;te=0}if(typeof _e=="string"&&(_e=b.from(_e,$e)),b.isBuffer(_e))return _e.length===0?-1:L(se,_e,te,$e,ge);if(typeof _e=="number")return _e&=255,typeof Uint8Array.prototype.indexOf=="function"?ge?Uint8Array.prototype.indexOf.call(se,_e,te):Uint8Array.prototype.lastIndexOf.call(se,_e,te):L(se,[_e],te,$e,ge);throw new TypeError("val must be string, number or Buffer")}function L(se,_e,te,$e,ge){var le,ze=1,Je=se.length,et=_e.length;if($e!==void 0&&(($e=String($e).toLowerCase())==="ucs2"||$e==="ucs-2"||$e==="utf16le"||$e==="utf-16le")){if(se.length<2||_e.length<2)return-1;ze=2,Je/=2,et/=2,te/=2}function ft(tn,xt){return ze===1?tn[xt]:tn.readUInt16BE(xt*ze)}if(ge){var wt=-1;for(le=te;le<Je;le++)if(ft(se,le)===ft(_e,wt===-1?0:le-wt)){if(wt===-1&&(wt=le),le-wt+1===et)return wt*ze}else wt!==-1&&(le-=le-wt),wt=-1}else for(te+et>Je&&(te=Je-et),le=te;le>=0;le--){for(var It=!0,Ct=0;Ct<et;Ct++)if(ft(se,le+Ct)!==ft(_e,Ct)){It=!1;break}if(It)return le}return-1}function W(se,_e,te,$e){te=Number(te)||0;var ge=se.length-te;$e?($e=Number($e))>ge&&($e=ge):$e=ge;var le=_e.length;$e>le/2&&($e=le/2);for(var ze=0;ze<$e;++ze){var Je=parseInt(_e.substr(2*ze,2),16);if(Le(Je))return ze;se[te+ze]=Je}return ze}function G(se,_e,te,$e){return X(De(_e,se.length-te),se,te,$e)}function re(se,_e,te,$e){return X(function(ge){for(var le=[],ze=0;ze<ge.length;++ze)le.push(255&ge.charCodeAt(ze));return le}(_e),se,te,$e)}function Q(se,_e,te,$e){return X(ot(_e),se,te,$e)}function oe(se,_e,te,$e){return X(function(ge,le){for(var ze,Je,et,ft=[],wt=0;wt<ge.length&&!((le-=2)<0);++wt)Je=(ze=ge.charCodeAt(wt))>>8,et=ze%256,ft.push(et),ft.push(Je);return ft}(_e,se.length-te),se,te,$e)}function ae(se,_e,te){return _e===0&&te===se.length?m.fromByteArray(se):m.fromByteArray(se.slice(_e,te))}function de(se,_e,te){te=Math.min(se.length,te);for(var $e=[],ge=_e;ge<te;){var le,ze,Je,et,ft=se[ge],wt=null,It=ft>239?4:ft>223?3:ft>191?2:1;if(ge+It<=te)switch(It){case 1:ft<128&&(wt=ft);break;case 2:(192&(le=se[ge+1]))==128&&(et=(31&ft)<<6|63&le)>127&&(wt=et);break;case 3:le=se[ge+1],ze=se[ge+2],(192&le)==128&&(192&ze)==128&&(et=(15&ft)<<12|(63&le)<<6|63&ze)>2047&&(et<55296||et>57343)&&(wt=et);break;case 4:le=se[ge+1],ze=se[ge+2],Je=se[ge+3],(192&le)==128&&(192&ze)==128&&(192&Je)==128&&(et=(15&ft)<<18|(63&le)<<12|(63&ze)<<6|63&Je)>65535&&et<1114112&&(wt=et)}wt===null?(wt=65533,It=1):wt>65535&&(wt-=65536,$e.push(wt>>>10&1023|55296),wt=56320|1023&wt),$e.push(wt),ge+=It}return function(Ct){var tn=Ct.length;if(tn<=be)return String.fromCharCode.apply(String,Ct);for(var xt="",Ht=0;Ht<tn;)xt+=String.fromCharCode.apply(String,Ct.slice(Ht,Ht+=be));return xt}($e)}l.kMaxLength=_,b.TYPED_ARRAY_SUPPORT=function(){try{var se=new Uint8Array(1),_e={foo:function(){return 42}};return Object.setPrototypeOf(_e,Uint8Array.prototype),Object.setPrototypeOf(se,_e),se.foo()===42}catch{return!1}}(),b.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(b.prototype,"parent",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.buffer}}),Object.defineProperty(b.prototype,"offset",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.byteOffset}}),b.poolSize=8192,b.from=function(se,_e,te){return p(se,_e,te)},Object.setPrototypeOf(b.prototype,Uint8Array.prototype),Object.setPrototypeOf(b,Uint8Array),b.alloc=function(se,_e,te){return function($e,ge,le){return x($e),$e<=0?E($e):ge!==void 0?typeof le=="string"?E($e).fill(ge,le):E($e).fill(ge):E($e)}(se,_e,te)},b.allocUnsafe=function(se){return y(se)},b.allocUnsafeSlow=function(se){return y(se)},b.isBuffer=function(se){return se!=null&&se._isBuffer===!0&&se!==b.prototype},b.compare=function(se,_e){if(ee(se,Uint8Array)&&(se=b.from(se,se.offset,se.byteLength)),ee(_e,Uint8Array)&&(_e=b.from(_e,_e.offset,_e.byteLength)),!b.isBuffer(se)||!b.isBuffer(_e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(se===_e)return 0;for(var te=se.length,$e=_e.length,ge=0,le=Math.min(te,$e);ge<le;++ge)if(se[ge]!==_e[ge]){te=se[ge],$e=_e[ge];break}return te<$e?-1:$e<te?1:0},b.isEncoding=function(se){switch(String(se).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.concat=function(se,_e){if(!Array.isArray(se))throw new TypeError('"list" argument must be an Array of Buffers');if(se.length===0)return b.alloc(0);var te;if(_e===void 0)for(_e=0,te=0;te<se.length;++te)_e+=se[te].length;var $e=b.allocUnsafe(_e),ge=0;for(te=0;te<se.length;++te){var le=se[te];if(ee(le,Uint8Array))ge+le.length>$e.length?b.from(le).copy($e,ge):Uint8Array.prototype.set.call($e,le,ge);else{if(!b.isBuffer(le))throw new TypeError('"list" argument must be an Array of Buffers');le.copy($e,ge)}ge+=le.length}return $e},b.byteLength=P,b.prototype._isBuffer=!0,b.prototype.swap16=function(){var se=this.length;if(se%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var _e=0;_e<se;_e+=2)R(this,_e,_e+1);return this},b.prototype.swap32=function(){var se=this.length;if(se%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var _e=0;_e<se;_e+=4)R(this,_e,_e+3),R(this,_e+1,_e+2);return this},b.prototype.swap64=function(){var se=this.length;if(se%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var _e=0;_e<se;_e+=8)R(this,_e,_e+7),R(this,_e+1,_e+6),R(this,_e+2,_e+5),R(this,_e+3,_e+4);return this},b.prototype.toString=function(){var se=this.length;return se===0?"":arguments.length===0?de(this,0,se):T.apply(this,arguments)},b.prototype.toLocaleString=b.prototype.toString,b.prototype.equals=function(se){if(!b.isBuffer(se))throw new TypeError("Argument must be a Buffer");return this===se||b.compare(this,se)===0},b.prototype.inspect=function(){var se="",_e=l.INSPECT_MAX_BYTES;return se=this.toString("hex",0,_e).replace(/(.{2})/g,"$1 ").trim(),this.length>_e&&(se+=" ... "),"<Buffer "+se+">"},g&&(b.prototype[g]=b.prototype.inspect),b.prototype.compare=function(se,_e,te,$e,ge){if(ee(se,Uint8Array)&&(se=b.from(se,se.offset,se.byteLength)),!b.isBuffer(se))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+h(se));if(_e===void 0&&(_e=0),te===void 0&&(te=se?se.length:0),$e===void 0&&($e=0),ge===void 0&&(ge=this.length),_e<0||te>se.length||$e<0||ge>this.length)throw new RangeError("out of range index");if($e>=ge&&_e>=te)return 0;if($e>=ge)return-1;if(_e>=te)return 1;if(this===se)return 0;for(var le=(ge>>>=0)-($e>>>=0),ze=(te>>>=0)-(_e>>>=0),Je=Math.min(le,ze),et=this.slice($e,ge),ft=se.slice(_e,te),wt=0;wt<Je;++wt)if(et[wt]!==ft[wt]){le=et[wt],ze=ft[wt];break}return le<ze?-1:ze<le?1:0},b.prototype.includes=function(se,_e,te){return this.indexOf(se,_e,te)!==-1},b.prototype.indexOf=function(se,_e,te){return M(this,se,_e,te,!0)},b.prototype.lastIndexOf=function(se,_e,te){return M(this,se,_e,te,!1)},b.prototype.write=function(se,_e,te,$e){if(_e===void 0)$e="utf8",te=this.length,_e=0;else if(te===void 0&&typeof _e=="string")$e=_e,te=this.length,_e=0;else{if(!isFinite(_e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");_e>>>=0,isFinite(te)?(te>>>=0,$e===void 0&&($e="utf8")):($e=te,te=void 0)}var ge=this.length-_e;if((te===void 0||te>ge)&&(te=ge),se.length>0&&(te<0||_e<0)||_e>this.length)throw new RangeError("Attempt to write outside buffer bounds");$e||($e="utf8");for(var le=!1;;)switch($e){case"hex":return W(this,se,_e,te);case"utf8":case"utf-8":return G(this,se,_e,te);case"ascii":case"latin1":case"binary":return re(this,se,_e,te);case"base64":return Q(this,se,_e,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,se,_e,te);default:if(le)throw new TypeError("Unknown encoding: "+$e);$e=(""+$e).toLowerCase(),le=!0}},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var be=4096;function pe(se,_e,te){var $e="";te=Math.min(se.length,te);for(var ge=_e;ge<te;++ge)$e+=String.fromCharCode(127&se[ge]);return $e}function U(se,_e,te){var $e="";te=Math.min(se.length,te);for(var ge=_e;ge<te;++ge)$e+=String.fromCharCode(se[ge]);return $e}function B(se,_e,te){var $e=se.length;(!_e||_e<0)&&(_e=0),(!te||te<0||te>$e)&&(te=$e);for(var ge="",le=_e;le<te;++le)ge+=Be[se[le]];return ge}function N(se,_e,te){for(var $e=se.slice(_e,te),ge="",le=0;le<$e.length-1;le+=2)ge+=String.fromCharCode($e[le]+256*$e[le+1]);return ge}function z(se,_e,te){if(se%1!=0||se<0)throw new RangeError("offset is not uint");if(se+_e>te)throw new RangeError("Trying to access beyond buffer length")}function H(se,_e,te,$e,ge,le){if(!b.isBuffer(se))throw new TypeError('"buffer" argument must be a Buffer instance');if(_e>ge||_e<le)throw new RangeError('"value" argument is out of bounds');if(te+$e>se.length)throw new RangeError("Index out of range")}function Y(se,_e,te,$e,ge,le){if(te+$e>se.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("Index out of range")}function fe(se,_e,te,$e,ge){return _e=+_e,te>>>=0,ge||Y(se,0,te,4),v.write(se,_e,te,$e,23,4),te+4}function Re(se,_e,te,$e,ge){return _e=+_e,te>>>=0,ge||Y(se,0,te,8),v.write(se,_e,te,$e,52,8),te+8}b.prototype.slice=function(se,_e){var te=this.length;(se=~~se)<0?(se+=te)<0&&(se=0):se>te&&(se=te),(_e=_e===void 0?te:~~_e)<0?(_e+=te)<0&&(_e=0):_e>te&&(_e=te),_e<se&&(_e=se);var $e=this.subarray(se,_e);return Object.setPrototypeOf($e,b.prototype),$e},b.prototype.readUintLE=b.prototype.readUIntLE=function(se,_e,te){se>>>=0,_e>>>=0,te||z(se,_e,this.length);for(var $e=this[se],ge=1,le=0;++le<_e&&(ge*=256);)$e+=this[se+le]*ge;return $e},b.prototype.readUintBE=b.prototype.readUIntBE=function(se,_e,te){se>>>=0,_e>>>=0,te||z(se,_e,this.length);for(var $e=this[se+--_e],ge=1;_e>0&&(ge*=256);)$e+=this[se+--_e]*ge;return $e},b.prototype.readUint8=b.prototype.readUInt8=function(se,_e){return se>>>=0,_e||z(se,1,this.length),this[se]},b.prototype.readUint16LE=b.prototype.readUInt16LE=function(se,_e){return se>>>=0,_e||z(se,2,this.length),this[se]|this[se+1]<<8},b.prototype.readUint16BE=b.prototype.readUInt16BE=function(se,_e){return se>>>=0,_e||z(se,2,this.length),this[se]<<8|this[se+1]},b.prototype.readUint32LE=b.prototype.readUInt32LE=function(se,_e){return se>>>=0,_e||z(se,4,this.length),(this[se]|this[se+1]<<8|this[se+2]<<16)+16777216*this[se+3]},b.prototype.readUint32BE=b.prototype.readUInt32BE=function(se,_e){return se>>>=0,_e||z(se,4,this.length),16777216*this[se]+(this[se+1]<<16|this[se+2]<<8|this[se+3])},b.prototype.readIntLE=function(se,_e,te){se>>>=0,_e>>>=0,te||z(se,_e,this.length);for(var $e=this[se],ge=1,le=0;++le<_e&&(ge*=256);)$e+=this[se+le]*ge;return $e>=(ge*=128)&&($e-=Math.pow(2,8*_e)),$e},b.prototype.readIntBE=function(se,_e,te){se>>>=0,_e>>>=0,te||z(se,_e,this.length);for(var $e=_e,ge=1,le=this[se+--$e];$e>0&&(ge*=256);)le+=this[se+--$e]*ge;return le>=(ge*=128)&&(le-=Math.pow(2,8*_e)),le},b.prototype.readInt8=function(se,_e){return se>>>=0,_e||z(se,1,this.length),128&this[se]?-1*(255-this[se]+1):this[se]},b.prototype.readInt16LE=function(se,_e){se>>>=0,_e||z(se,2,this.length);var te=this[se]|this[se+1]<<8;return 32768&te?4294901760|te:te},b.prototype.readInt16BE=function(se,_e){se>>>=0,_e||z(se,2,this.length);var te=this[se+1]|this[se]<<8;return 32768&te?4294901760|te:te},b.prototype.readInt32LE=function(se,_e){return se>>>=0,_e||z(se,4,this.length),this[se]|this[se+1]<<8|this[se+2]<<16|this[se+3]<<24},b.prototype.readInt32BE=function(se,_e){return se>>>=0,_e||z(se,4,this.length),this[se]<<24|this[se+1]<<16|this[se+2]<<8|this[se+3]},b.prototype.readFloatLE=function(se,_e){return se>>>=0,_e||z(se,4,this.length),v.read(this,se,!0,23,4)},b.prototype.readFloatBE=function(se,_e){return se>>>=0,_e||z(se,4,this.length),v.read(this,se,!1,23,4)},b.prototype.readDoubleLE=function(se,_e){return se>>>=0,_e||z(se,8,this.length),v.read(this,se,!0,52,8)},b.prototype.readDoubleBE=function(se,_e){return se>>>=0,_e||z(se,8,this.length),v.read(this,se,!1,52,8)},b.prototype.writeUintLE=b.prototype.writeUIntLE=function(se,_e,te,$e){se=+se,_e>>>=0,te>>>=0,$e||H(this,se,_e,te,Math.pow(2,8*te)-1,0);var ge=1,le=0;for(this[_e]=255&se;++le<te&&(ge*=256);)this[_e+le]=se/ge&255;return _e+te},b.prototype.writeUintBE=b.prototype.writeUIntBE=function(se,_e,te,$e){se=+se,_e>>>=0,te>>>=0,$e||H(this,se,_e,te,Math.pow(2,8*te)-1,0);var ge=te-1,le=1;for(this[_e+ge]=255&se;--ge>=0&&(le*=256);)this[_e+ge]=se/le&255;return _e+te},b.prototype.writeUint8=b.prototype.writeUInt8=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,1,255,0),this[_e]=255&se,_e+1},b.prototype.writeUint16LE=b.prototype.writeUInt16LE=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,2,65535,0),this[_e]=255&se,this[_e+1]=se>>>8,_e+2},b.prototype.writeUint16BE=b.prototype.writeUInt16BE=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,2,65535,0),this[_e]=se>>>8,this[_e+1]=255&se,_e+2},b.prototype.writeUint32LE=b.prototype.writeUInt32LE=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,4,4294967295,0),this[_e+3]=se>>>24,this[_e+2]=se>>>16,this[_e+1]=se>>>8,this[_e]=255&se,_e+4},b.prototype.writeUint32BE=b.prototype.writeUInt32BE=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,4,4294967295,0),this[_e]=se>>>24,this[_e+1]=se>>>16,this[_e+2]=se>>>8,this[_e+3]=255&se,_e+4},b.prototype.writeIntLE=function(se,_e,te,$e){if(se=+se,_e>>>=0,!$e){var ge=Math.pow(2,8*te-1);H(this,se,_e,te,ge-1,-ge)}var le=0,ze=1,Je=0;for(this[_e]=255&se;++le<te&&(ze*=256);)se<0&&Je===0&&this[_e+le-1]!==0&&(Je=1),this[_e+le]=(se/ze>>0)-Je&255;return _e+te},b.prototype.writeIntBE=function(se,_e,te,$e){if(se=+se,_e>>>=0,!$e){var ge=Math.pow(2,8*te-1);H(this,se,_e,te,ge-1,-ge)}var le=te-1,ze=1,Je=0;for(this[_e+le]=255&se;--le>=0&&(ze*=256);)se<0&&Je===0&&this[_e+le+1]!==0&&(Je=1),this[_e+le]=(se/ze>>0)-Je&255;return _e+te},b.prototype.writeInt8=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,1,127,-128),se<0&&(se=255+se+1),this[_e]=255&se,_e+1},b.prototype.writeInt16LE=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,2,32767,-32768),this[_e]=255&se,this[_e+1]=se>>>8,_e+2},b.prototype.writeInt16BE=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,2,32767,-32768),this[_e]=se>>>8,this[_e+1]=255&se,_e+2},b.prototype.writeInt32LE=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,4,2147483647,-2147483648),this[_e]=255&se,this[_e+1]=se>>>8,this[_e+2]=se>>>16,this[_e+3]=se>>>24,_e+4},b.prototype.writeInt32BE=function(se,_e,te){return se=+se,_e>>>=0,te||H(this,se,_e,4,2147483647,-2147483648),se<0&&(se=4294967295+se+1),this[_e]=se>>>24,this[_e+1]=se>>>16,this[_e+2]=se>>>8,this[_e+3]=255&se,_e+4},b.prototype.writeFloatLE=function(se,_e,te){return fe(this,se,_e,!0,te)},b.prototype.writeFloatBE=function(se,_e,te){return fe(this,se,_e,!1,te)},b.prototype.writeDoubleLE=function(se,_e,te){return Re(this,se,_e,!0,te)},b.prototype.writeDoubleBE=function(se,_e,te){return Re(this,se,_e,!1,te)},b.prototype.copy=function(se,_e,te,$e){if(!b.isBuffer(se))throw new TypeError("argument should be a Buffer");if(te||(te=0),$e||$e===0||($e=this.length),_e>=se.length&&(_e=se.length),_e||(_e=0),$e>0&&$e<te&&($e=te),$e===te||se.length===0||this.length===0)return 0;if(_e<0)throw new RangeError("targetStart out of bounds");if(te<0||te>=this.length)throw new RangeError("Index out of range");if($e<0)throw new RangeError("sourceEnd out of bounds");$e>this.length&&($e=this.length),se.length-_e<$e-te&&($e=se.length-_e+te);var ge=$e-te;return this===se&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(_e,te,$e):Uint8Array.prototype.set.call(se,this.subarray(te,$e),_e),ge},b.prototype.fill=function(se,_e,te,$e){if(typeof se=="string"){if(typeof _e=="string"?($e=_e,_e=0,te=this.length):typeof te=="string"&&($e=te,te=this.length),$e!==void 0&&typeof $e!="string")throw new TypeError("encoding must be a string");if(typeof $e=="string"&&!b.isEncoding($e))throw new TypeError("Unknown encoding: "+$e);if(se.length===1){var ge=se.charCodeAt(0);($e==="utf8"&&ge<128||$e==="latin1")&&(se=ge)}}else typeof se=="number"?se&=255:typeof se=="boolean"&&(se=Number(se));if(_e<0||this.length<_e||this.length<te)throw new RangeError("Out of range index");if(te<=_e)return this;var le;if(_e>>>=0,te=te===void 0?this.length:te>>>0,se||(se=0),typeof se=="number")for(le=_e;le<te;++le)this[le]=se;else{var ze=b.isBuffer(se)?se:b.from(se,$e),Je=ze.length;if(Je===0)throw new TypeError('The value "'+se+'" is invalid for argument "value"');for(le=0;le<te-_e;++le)this[le+_e]=ze[le%Je]}return this};var Oe=/[^+/0-9A-Za-z-_]/g;function De(se,_e){var te;_e=_e||1/0;for(var $e=se.length,ge=null,le=[],ze=0;ze<$e;++ze){if((te=se.charCodeAt(ze))>55295&&te<57344){if(!ge){if(te>56319){(_e-=3)>-1&&le.push(239,191,189);continue}if(ze+1===$e){(_e-=3)>-1&&le.push(239,191,189);continue}ge=te;continue}if(te<56320){(_e-=3)>-1&&le.push(239,191,189),ge=te;continue}te=65536+(ge-55296<<10|te-56320)}else ge&&(_e-=3)>-1&&le.push(239,191,189);if(ge=null,te<128){if((_e-=1)<0)break;le.push(te)}else if(te<2048){if((_e-=2)<0)break;le.push(te>>6|192,63&te|128)}else if(te<65536){if((_e-=3)<0)break;le.push(te>>12|224,te>>6&63|128,63&te|128)}else{if(!(te<1114112))throw new Error("Invalid code point");if((_e-=4)<0)break;le.push(te>>18|240,te>>12&63|128,te>>6&63|128,63&te|128)}}return le}function ot(se){return m.toByteArray(function(_e){if((_e=(_e=_e.split("=")[0]).trim().replace(Oe,"")).length<2)return"";for(;_e.length%4!=0;)_e+="=";return _e}(se))}function X(se,_e,te,$e){for(var ge=0;ge<$e&&!(ge+te>=_e.length||ge>=se.length);++ge)_e[ge+te]=se[ge];return ge}function ee(se,_e){return se instanceof _e||se!=null&&se.constructor!=null&&se.constructor.name!=null&&se.constructor.name===_e.name}function Le(se){return se!=se}var Be=function(){for(var se="0123456789abcdef",_e=new Array(256),te=0;te<16;++te)for(var $e=16*te,ge=0;ge<16;++ge)_e[$e+ge]=se[te]+se[ge];return _e}()},8780:(a,l,r)=>{var h=r(6893),m=r(3862),v=m(h("String.prototype.indexOf"));a.exports=function(g,_){var E=h(g,!!_);return typeof E=="function"&&v(g,".prototype.")>-1?m(E):E}},3862:(a,l,r)=>{var h=r(5246),m=r(6893),v=r(2637),g=m("%TypeError%"),_=m("%Function.prototype.apply%"),E=m("%Function.prototype.call%"),b=m("%Reflect.apply%",!0)||h.call(E,_),p=m("%Object.defineProperty%",!0),x=m("%Math.max%");if(p)try{p({},"a",{value:1})}catch{p=null}a.exports=function(f){if(typeof f!="function")throw new g("a function is required");var w=b(h,E,arguments);return v(w,1+x(0,f.length-(arguments.length-1)),!0)};var y=function(){return b(h,_,arguments)};p?p(a.exports,"apply",{value:y}):a.exports.apply=y},8842:(a,l,r)=>{var h=r(9047).Buffer,m=r(4723).Transform,v=r(113).s;function g(_){m.call(this),this.hashMode=typeof _=="string",this.hashMode?this[_]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}r(376)(g,m),g.prototype.update=function(_,E,b){typeof _=="string"&&(_=h.from(_,E));var p=this._update(_);return this.hashMode?this:(b&&(p=this._toString(p,b)),p)},g.prototype.setAutoPadding=function(){},g.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},g.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},g.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},g.prototype._transform=function(_,E,b){var p;try{this.hashMode?this._update(_):this.push(this._update(_))}catch(x){p=x}finally{b(p)}},g.prototype._flush=function(_){var E;try{this.push(this.__final())}catch(b){E=b}_(E)},g.prototype._finalOrDigest=function(_){var E=this.__final()||h.alloc(0);return _&&(E=this._toString(E,_,!0)),E},g.prototype._toString=function(_,E,b){if(this._decoder||(this._decoder=new v(E),this._encoding=E),this._encoding!==E)throw new Error("can't switch encodings");var p=this._decoder.write(_);return b&&(p+=this._decoder.end()),p},a.exports=g},4637:(a,l,r)=>{var h=r(365).Buffer,m=r(8333),v=r(815);a.exports=function(b){return new _(b)};var g={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function _(b){this.curveType=g[b],this.curveType||(this.curveType={name:b}),this.curve=new m.ec(this.curveType.name),this.keys=void 0}function E(b,p,x){Array.isArray(b)||(b=b.toArray());var y=new h(b);if(x&&y.length<x){var f=new h(x-y.length);f.fill(0),y=h.concat([f,y])}return p?y.toString(p):y}g.p224=g.secp224r1,g.p256=g.secp256r1=g.prime256v1,g.p192=g.secp192r1=g.prime192v1,g.p384=g.secp384r1,g.p521=g.secp521r1,_.prototype.generateKeys=function(b,p){return this.keys=this.curve.genKeyPair(),this.getPublicKey(b,p)},_.prototype.computeSecret=function(b,p,x){return p=p||"utf8",h.isBuffer(b)||(b=new h(b,p)),E(this.curve.keyFromPublic(b).getPublic().mul(this.keys.getPrivate()).getX(),x,this.curveType.byteLength)},_.prototype.getPublicKey=function(b,p){var x=this.keys.getPublic(p==="compressed",!0);return p==="hybrid"&&(x[x.length-1]%2?x[0]=7:x[0]=6),E(x,b)},_.prototype.getPrivateKey=function(b){return E(this.keys.getPrivate(),b)},_.prototype.setPublicKey=function(b,p){return p=p||"utf8",h.isBuffer(b)||(b=new h(b,p)),this.keys._importPublic(b),this},_.prototype.setPrivateKey=function(b,p){p=p||"utf8",h.isBuffer(b)||(b=new h(b,p));var x=new v(b);return x=x.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(x),this}},8339:(a,l,r)=>{var h=r(376),m=r(722),v=r(8100),g=r(1806),_=r(8842);function E(b){_.call(this,"digest"),this._hash=b}h(E,_),E.prototype._update=function(b){this._hash.update(b)},E.prototype._final=function(){return this._hash.digest()},a.exports=function(b){return(b=b.toLowerCase())==="md5"?new m:b==="rmd160"||b==="ripemd160"?new v:new E(g(b))}},3277:(a,l,r)=>{var h=r(722);a.exports=function(m){return new h().update(m).digest()}},8736:(a,l,r)=>{var h=r(376),m=r(2912),v=r(8842),g=r(9047).Buffer,_=r(3277),E=r(8100),b=r(1806),p=g.alloc(128);function x(y,f){v.call(this,"digest"),typeof f=="string"&&(f=g.from(f));var w=y==="sha512"||y==="sha384"?128:64;this._alg=y,this._key=f,f.length>w?f=(y==="rmd160"?new E:b(y)).update(f).digest():f.length<w&&(f=g.concat([f,p],w));for(var A=this._ipad=g.allocUnsafe(w),P=this._opad=g.allocUnsafe(w),T=0;T<w;T++)A[T]=54^f[T],P[T]=92^f[T];this._hash=y==="rmd160"?new E:b(y),this._hash.update(A)}h(x,v),x.prototype._update=function(y){this._hash.update(y)},x.prototype._final=function(){var y=this._hash.digest();return(this._alg==="rmd160"?new E:b(this._alg)).update(this._opad).update(y).digest()},a.exports=function(y,f){return(y=y.toLowerCase())==="rmd160"||y==="ripemd160"?new x("rmd160",f):y==="md5"?new m(_,f):new x(y,f)}},2912:(a,l,r)=>{var h=r(376),m=r(9047).Buffer,v=r(8842),g=m.alloc(128),_=64;function E(b,p){v.call(this,"digest"),typeof p=="string"&&(p=m.from(p)),this._alg=b,this._key=p,p.length>_?p=b(p):p.length<_&&(p=m.concat([p,g],_));for(var x=this._ipad=m.allocUnsafe(_),y=this._opad=m.allocUnsafe(_),f=0;f<_;f++)x[f]=54^p[f],y[f]=92^p[f];this._hash=[x]}h(E,v),E.prototype._update=function(b){this._hash.push(b)},E.prototype._final=function(){var b=this._alg(m.concat(this._hash));return this._alg(m.concat([this._opad,b]))},a.exports=E},462:(a,l,r)=>{l.O6=r(5760),r(8339),r(8736),r(3363);var h=r(9379);h.pbkdf2,h.pbkdf2Sync;var m=r(5972);m.Cipher,m.createCipher,m.Cipheriv,m.createCipheriv,m.Decipher,m.createDecipher,m.Decipheriv,m.createDecipheriv,m.getCiphers,m.listCiphers;var v=r(1822);v.DiffieHellmanGroup,v.createDiffieHellmanGroup,v.getDiffieHellman,v.createDiffieHellman,v.DiffieHellman;var g=r(1022);g.createSign,g.Sign,g.createVerify,g.Verify,r(4637);var _=r(2368);_.publicEncrypt,_.privateEncrypt,_.publicDecrypt,_.privateDecrypt;var E=r(9301);E.randomFill,E.randomFillSync},3793:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}var m=r(2579)(),v=r(6893),g=m&&v("%Object.defineProperty%",!0);if(g)try{g({},"a",{value:1})}catch{g=!1}var _=v("%SyntaxError%"),E=v("%TypeError%"),b=r(1554);a.exports=function(p,x,y){if(!p||h(p)!=="object"&&typeof p!="function")throw new E("`obj` must be an object or a function`");if(typeof x!="string"&&h(x)!=="symbol")throw new E("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new E("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new E("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new E("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new E("`loose`, if provided, must be a boolean");var f=arguments.length>3?arguments[3]:null,w=arguments.length>4?arguments[4]:null,A=arguments.length>5?arguments[5]:null,P=arguments.length>6&&arguments[6],T=!!b&&b(p,x);if(g)g(p,x,{configurable:A===null&&T?T.configurable:!A,enumerable:f===null&&T?T.enumerable:!f,value:y,writable:w===null&&T?T.writable:!w});else{if(!P&&(f||w||A))throw new _("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");p[x]=y}}},7921:(a,l,r)=>{function h(y){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},h(y)}var m=r(3818),v=typeof Symbol=="function"&&h(Symbol("foo"))==="symbol",g=Object.prototype.toString,_=Array.prototype.concat,E=r(3793),b=r(2579)(),p=function(y,f,w,A){if(f in y){if(A===!0){if(y[f]===w)return}else if(typeof(P=A)!="function"||g.call(P)!=="[object Function]"||!A())return}var P;b?E(y,f,w,!0):E(y,f,w)},x=function(y,f){var w=arguments.length>2?arguments[2]:{},A=m(f);v&&(A=_.call(A,Object.getOwnPropertySymbols(f)));for(var P=0;P<A.length;P+=1)p(y,A[P],f[A[P]],w[A[P]])};x.supportsDescriptors=!!b,a.exports=x},167:(a,l,r)=>{l.utils=r(5061),l.Cipher=r(7499),l.DES=r(9484),l.CBC=r(8254),l.EDE=r(5573)},8254:(a,l,r)=>{var h=r(1130),m=r(376),v={};function g(_){h.equal(_.length,8,"Invalid IV length"),this.iv=new Array(8);for(var E=0;E<this.iv.length;E++)this.iv[E]=_[E]}l.instantiate=function(_){function E(y){_.call(this,y),this._cbcInit()}m(E,_);for(var b=Object.keys(v),p=0;p<b.length;p++){var x=b[p];E.prototype[x]=v[x]}return E.create=function(y){return new E(y)},E},v._cbcInit=function(){var _=new g(this.options.iv);this._cbcState=_},v._update=function(_,E,b,p){var x=this._cbcState,y=this.constructor.super_.prototype,f=x.iv;if(this.type==="encrypt"){for(var w=0;w<this.blockSize;w++)f[w]^=_[E+w];for(y._update.call(this,f,0,b,p),w=0;w<this.blockSize;w++)f[w]=b[p+w]}else{for(y._update.call(this,_,E,b,p),w=0;w<this.blockSize;w++)b[p+w]^=f[w];for(w=0;w<this.blockSize;w++)f[w]=_[E+w]}}},7499:(a,l,r)=>{var h=r(1130);function m(v){this.options=v,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=v.padding!==!1}a.exports=m,m.prototype._init=function(){},m.prototype.update=function(v){return v.length===0?[]:this.type==="decrypt"?this._updateDecrypt(v):this._updateEncrypt(v)},m.prototype._buffer=function(v,g){for(var _=Math.min(this.buffer.length-this.bufferOff,v.length-g),E=0;E<_;E++)this.buffer[this.bufferOff+E]=v[g+E];return this.bufferOff+=_,_},m.prototype._flushBuffer=function(v,g){return this._update(this.buffer,0,v,g),this.bufferOff=0,this.blockSize},m.prototype._updateEncrypt=function(v){var g=0,_=0,E=(this.bufferOff+v.length)/this.blockSize|0,b=new Array(E*this.blockSize);this.bufferOff!==0&&(g+=this._buffer(v,g),this.bufferOff===this.buffer.length&&(_+=this._flushBuffer(b,_)));for(var p=v.length-(v.length-g)%this.blockSize;g<p;g+=this.blockSize)this._update(v,g,b,_),_+=this.blockSize;for(;g<v.length;g++,this.bufferOff++)this.buffer[this.bufferOff]=v[g];return b},m.prototype._updateDecrypt=function(v){for(var g=0,_=0,E=Math.ceil((this.bufferOff+v.length)/this.blockSize)-1,b=new Array(E*this.blockSize);E>0;E--)g+=this._buffer(v,g),_+=this._flushBuffer(b,_);return g+=this._buffer(v,g),b},m.prototype.final=function(v){var g,_;return v&&(g=this.update(v)),_=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),g?g.concat(_):_},m.prototype._pad=function(v,g){if(g===0)return!1;for(;g<v.length;)v[g++]=0;return!0},m.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var v=new Array(this.blockSize);return this._update(this.buffer,0,v,0),v},m.prototype._unpad=function(v){return v},m.prototype._finalDecrypt=function(){h.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var v=new Array(this.blockSize);return this._flushBuffer(v,0),this._unpad(v)}},9484:(a,l,r)=>{var h=r(1130),m=r(376),v=r(5061),g=r(7499);function _(){this.tmp=new Array(2),this.keys=null}function E(p){g.call(this,p);var x=new _;this._desState=x,this.deriveKeys(x,p.key)}m(E,g),a.exports=E,E.create=function(p){return new E(p)};var b=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];E.prototype.deriveKeys=function(p,x){p.keys=new Array(32),h.equal(x.length,this.blockSize,"Invalid key length");var y=v.readUInt32BE(x,0),f=v.readUInt32BE(x,4);v.pc1(y,f,p.tmp,0),y=p.tmp[0],f=p.tmp[1];for(var w=0;w<p.keys.length;w+=2){var A=b[w>>>1];y=v.r28shl(y,A),f=v.r28shl(f,A),v.pc2(y,f,p.keys,w)}},E.prototype._update=function(p,x,y,f){var w=this._desState,A=v.readUInt32BE(p,x),P=v.readUInt32BE(p,x+4);v.ip(A,P,w.tmp,0),A=w.tmp[0],P=w.tmp[1],this.type==="encrypt"?this._encrypt(w,A,P,w.tmp,0):this._decrypt(w,A,P,w.tmp,0),A=w.tmp[0],P=w.tmp[1],v.writeUInt32BE(y,A,f),v.writeUInt32BE(y,P,f+4)},E.prototype._pad=function(p,x){if(this.padding===!1)return!1;for(var y=p.length-x,f=x;f<p.length;f++)p[f]=y;return!0},E.prototype._unpad=function(p){if(this.padding===!1)return p;for(var x=p[p.length-1],y=p.length-x;y<p.length;y++)h.equal(p[y],x);return p.slice(0,p.length-x)},E.prototype._encrypt=function(p,x,y,f,w){for(var A=x,P=y,T=0;T<p.keys.length;T+=2){var R=p.keys[T],M=p.keys[T+1];v.expand(P,p.tmp,0),R^=p.tmp[0],M^=p.tmp[1];var L=v.substitute(R,M),W=P;P=(A^v.permute(L))>>>0,A=W}v.rip(P,A,f,w)},E.prototype._decrypt=function(p,x,y,f,w){for(var A=y,P=x,T=p.keys.length-2;T>=0;T-=2){var R=p.keys[T],M=p.keys[T+1];v.expand(A,p.tmp,0),R^=p.tmp[0],M^=p.tmp[1];var L=v.substitute(R,M),W=A;A=(P^v.permute(L))>>>0,P=W}v.rip(A,P,f,w)}},5573:(a,l,r)=>{var h=r(1130),m=r(376),v=r(7499),g=r(9484);function _(b,p){h.equal(p.length,24,"Invalid key length");var x=p.slice(0,8),y=p.slice(8,16),f=p.slice(16,24);this.ciphers=b==="encrypt"?[g.create({type:"encrypt",key:x}),g.create({type:"decrypt",key:y}),g.create({type:"encrypt",key:f})]:[g.create({type:"decrypt",key:f}),g.create({type:"encrypt",key:y}),g.create({type:"decrypt",key:x})]}function E(b){v.call(this,b);var p=new _(this.type,this.options.key);this._edeState=p}m(E,v),a.exports=E,E.create=function(b){return new E(b)},E.prototype._update=function(b,p,x,y){var f=this._edeState;f.ciphers[0]._update(b,p,x,y),f.ciphers[1]._update(x,y,x,y),f.ciphers[2]._update(x,y,x,y)},E.prototype._pad=g.prototype._pad,E.prototype._unpad=g.prototype._unpad},5061:(a,l)=>{l.readUInt32BE=function(v,g){return(v[0+g]<<24|v[1+g]<<16|v[2+g]<<8|v[3+g])>>>0},l.writeUInt32BE=function(v,g,_){v[0+_]=g>>>24,v[1+_]=g>>>16&255,v[2+_]=g>>>8&255,v[3+_]=255&g},l.ip=function(v,g,_,E){for(var b=0,p=0,x=6;x>=0;x-=2){for(var y=0;y<=24;y+=8)b<<=1,b|=g>>>y+x&1;for(y=0;y<=24;y+=8)b<<=1,b|=v>>>y+x&1}for(x=6;x>=0;x-=2){for(y=1;y<=25;y+=8)p<<=1,p|=g>>>y+x&1;for(y=1;y<=25;y+=8)p<<=1,p|=v>>>y+x&1}_[E+0]=b>>>0,_[E+1]=p>>>0},l.rip=function(v,g,_,E){for(var b=0,p=0,x=0;x<4;x++)for(var y=24;y>=0;y-=8)b<<=1,b|=g>>>y+x&1,b<<=1,b|=v>>>y+x&1;for(x=4;x<8;x++)for(y=24;y>=0;y-=8)p<<=1,p|=g>>>y+x&1,p<<=1,p|=v>>>y+x&1;_[E+0]=b>>>0,_[E+1]=p>>>0},l.pc1=function(v,g,_,E){for(var b=0,p=0,x=7;x>=5;x--){for(var y=0;y<=24;y+=8)b<<=1,b|=g>>y+x&1;for(y=0;y<=24;y+=8)b<<=1,b|=v>>y+x&1}for(y=0;y<=24;y+=8)b<<=1,b|=g>>y+x&1;for(x=1;x<=3;x++){for(y=0;y<=24;y+=8)p<<=1,p|=g>>y+x&1;for(y=0;y<=24;y+=8)p<<=1,p|=v>>y+x&1}for(y=0;y<=24;y+=8)p<<=1,p|=v>>y+x&1;_[E+0]=b>>>0,_[E+1]=p>>>0},l.r28shl=function(v,g){return v<<g&268435455|v>>>28-g};var r=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];l.pc2=function(v,g,_,E){for(var b=0,p=0,x=r.length>>>1,y=0;y<x;y++)b<<=1,b|=v>>>r[y]&1;for(y=x;y<r.length;y++)p<<=1,p|=g>>>r[y]&1;_[E+0]=b>>>0,_[E+1]=p>>>0},l.expand=function(v,g,_){var E=0,b=0;E=(1&v)<<5|v>>>27;for(var p=23;p>=15;p-=4)E<<=6,E|=v>>>p&63;for(p=11;p>=3;p-=4)b|=v>>>p&63,b<<=6;b|=(31&v)<<1|v>>>31,g[_+0]=E>>>0,g[_+1]=b>>>0};var h=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];l.substitute=function(v,g){for(var _=0,E=0;E<4;E++)_<<=4,_|=h[64*E+(v>>>18-6*E&63)];for(E=0;E<4;E++)_<<=4,_|=h[256+64*E+(g>>>18-6*E&63)];return _>>>0};var m=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];l.permute=function(v){for(var g=0,_=0;_<m.length;_++)g<<=1,g|=v>>>m[_]&1;return g>>>0},l.padSplit=function(v,g,_){for(var E=v.toString(2);E.length<g;)E="0"+E;for(var b=[],p=0;p<g;p+=_)b.push(E.slice(p,p+_));return b.join(" ")}},1822:(a,l,r)=>{var h=r(365).Buffer,m=r(2227),v=r(9799),g=r(6951),_={binary:!0,hex:!0,base64:!0};l.DiffieHellmanGroup=l.createDiffieHellmanGroup=l.getDiffieHellman=function(E){var b=new h(v[E].prime,"hex"),p=new h(v[E].gen,"hex");return new g(b,p)},l.createDiffieHellman=l.DiffieHellman=function E(b,p,x,y){return h.isBuffer(p)||_[p]===void 0?E(b,"binary",p,x):(p=p||"binary",y=y||"binary",x=x||new h([2]),h.isBuffer(x)||(x=new h(x,y)),typeof b=="number"?new g(m(b,x),x,!0):(h.isBuffer(b)||(b=new h(b,p)),new g(b,x,!0)))}},6951:(a,l,r)=>{var h=r(365).Buffer,m=r(815),v=new(r(9318)),g=new m(24),_=new m(11),E=new m(10),b=new m(3),p=new m(7),x=r(2227),y=r(5760);function f(R,M){return M=M||"utf8",h.isBuffer(R)||(R=new h(R,M)),this._pub=new m(R),this}function w(R,M){return M=M||"utf8",h.isBuffer(R)||(R=new h(R,M)),this._priv=new m(R),this}a.exports=P;var A={};function P(R,M,L){this.setGenerator(M),this.__prime=new m(R),this._prime=m.mont(this.__prime),this._primeLen=R.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,L?(this.setPublicKey=f,this.setPrivateKey=w):this._primeCode=8}function T(R,M){var L=new h(R.toArray());return M?L.toString(M):L}Object.defineProperty(P.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(R,M){var L=M.toString("hex"),W=[L,R.toString(16)].join("_");if(W in A)return A[W];var G,re=0;if(R.isEven()||!x.simpleSieve||!x.fermatTest(R)||!v.test(R))return re+=1,re+=L==="02"||L==="05"?8:4,A[W]=re,re;switch(v.test(R.shrn(1))||(re+=2),L){case"02":R.mod(g).cmp(_)&&(re+=8);break;case"05":(G=R.mod(E)).cmp(b)&&G.cmp(p)&&(re+=8);break;default:re+=4}return A[W]=re,re}(this.__prime,this.__gen)),this._primeCode}}),P.prototype.generateKeys=function(){return this._priv||(this._priv=new m(y(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},P.prototype.computeSecret=function(R){var M=(R=(R=new m(R)).toRed(this._prime)).redPow(this._priv).fromRed(),L=new h(M.toArray()),W=this.getPrime();if(L.length<W.length){var G=new h(W.length-L.length);G.fill(0),L=h.concat([G,L])}return L},P.prototype.getPublicKey=function(R){return T(this._pub,R)},P.prototype.getPrivateKey=function(R){return T(this._priv,R)},P.prototype.getPrime=function(R){return T(this.__prime,R)},P.prototype.getGenerator=function(R){return T(this._gen,R)},P.prototype.setGenerator=function(R,M){return M=M||"utf8",h.isBuffer(R)||(R=new h(R,M)),this.__gen=R,this._gen=new m(R),this}},2227:(a,l,r)=>{var h=r(5760);a.exports=R,R.simpleSieve=P,R.fermatTest=T;var m=r(815),v=new m(24),g=new(r(9318)),_=new m(1),E=new m(2),b=new m(5),p=(new m(16),new m(8),new m(10)),x=new m(3),y=(new m(7),new m(11)),f=new m(4),w=(new m(12),null);function A(){if(w!==null)return w;var M=[];M[0]=2;for(var L=1,W=3;W<1048576;W+=2){for(var G=Math.ceil(Math.sqrt(W)),re=0;re<L&&M[re]<=G&&W%M[re]!=0;re++);L!==re&&M[re]<=G||(M[L++]=W)}return w=M,M}function P(M){for(var L=A(),W=0;W<L.length;W++)if(M.modn(L[W])===0)return M.cmpn(L[W])===0;return!0}function T(M){var L=m.mont(M);return E.toRed(L).redPow(M.subn(1)).fromRed().cmpn(1)===0}function R(M,L){if(M<16)return new m(L===2||L===5?[140,123]:[140,39]);var W,G;for(L=new m(L);;){for(W=new m(h(Math.ceil(M/8)));W.bitLength()>M;)W.ishrn(1);if(W.isEven()&&W.iadd(_),W.testn(1)||W.iadd(E),L.cmp(E)){if(!L.cmp(b))for(;W.mod(p).cmp(x);)W.iadd(f)}else for(;W.mod(v).cmp(y);)W.iadd(f);if(P(G=W.shrn(1))&&P(W)&&T(G)&&T(W)&&g.test(G)&&g.test(W))return W}}},8333:(a,l,r)=>{var h=l;h.version=r(8597).i8,h.utils=r(7891),h.rand=r(7179),h.curve=r(4720),h.curves=r(1478),h.ec=r(5806),h.eddsa=r(8318)},9952:(a,l,r)=>{var h=r(815),m=r(7891),v=m.getNAF,g=m.getJSF,_=m.assert;function E(p,x){this.type=p,this.p=new h(x.p,16),this.red=x.prime?h.red(x.prime):h.mont(this.p),this.zero=new h(0).toRed(this.red),this.one=new h(1).toRed(this.red),this.two=new h(2).toRed(this.red),this.n=x.n&&new h(x.n,16),this.g=x.g&&this.pointFromJSON(x.g,x.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var y=this.n&&this.p.div(this.n);!y||y.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function b(p,x){this.curve=p,this.type=x,this.precomputed=null}a.exports=E,E.prototype.point=function(){throw new Error("Not implemented")},E.prototype.validate=function(){throw new Error("Not implemented")},E.prototype._fixedNafMul=function(p,x){_(p.precomputed);var y=p._getDoubles(),f=v(x,1,this._bitLength),w=(1<<y.step+1)-(y.step%2==0?2:1);w/=3;var A,P,T=[];for(A=0;A<f.length;A+=y.step){P=0;for(var R=A+y.step-1;R>=A;R--)P=(P<<1)+f[R];T.push(P)}for(var M=this.jpoint(null,null,null),L=this.jpoint(null,null,null),W=w;W>0;W--){for(A=0;A<T.length;A++)(P=T[A])===W?L=L.mixedAdd(y.points[A]):P===-W&&(L=L.mixedAdd(y.points[A].neg()));M=M.add(L)}return M.toP()},E.prototype._wnafMul=function(p,x){var y=4,f=p._getNAFPoints(y);y=f.wnd;for(var w=f.points,A=v(x,y,this._bitLength),P=this.jpoint(null,null,null),T=A.length-1;T>=0;T--){for(var R=0;T>=0&&A[T]===0;T--)R++;if(T>=0&&R++,P=P.dblp(R),T<0)break;var M=A[T];_(M!==0),P=p.type==="affine"?M>0?P.mixedAdd(w[M-1>>1]):P.mixedAdd(w[-M-1>>1].neg()):M>0?P.add(w[M-1>>1]):P.add(w[-M-1>>1].neg())}return p.type==="affine"?P.toP():P},E.prototype._wnafMulAdd=function(p,x,y,f,w){var A,P,T,R=this._wnafT1,M=this._wnafT2,L=this._wnafT3,W=0;for(A=0;A<f;A++){var G=(T=x[A])._getNAFPoints(p);R[A]=G.wnd,M[A]=G.points}for(A=f-1;A>=1;A-=2){var re=A-1,Q=A;if(R[re]===1&&R[Q]===1){var oe=[x[re],null,null,x[Q]];x[re].y.cmp(x[Q].y)===0?(oe[1]=x[re].add(x[Q]),oe[2]=x[re].toJ().mixedAdd(x[Q].neg())):x[re].y.cmp(x[Q].y.redNeg())===0?(oe[1]=x[re].toJ().mixedAdd(x[Q]),oe[2]=x[re].add(x[Q].neg())):(oe[1]=x[re].toJ().mixedAdd(x[Q]),oe[2]=x[re].toJ().mixedAdd(x[Q].neg()));var ae=[-3,-1,-5,-7,0,7,5,1,3],de=g(y[re],y[Q]);for(W=Math.max(de[0].length,W),L[re]=new Array(W),L[Q]=new Array(W),P=0;P<W;P++){var be=0|de[0][P],pe=0|de[1][P];L[re][P]=ae[3*(be+1)+(pe+1)],L[Q][P]=0,M[re]=oe}}else L[re]=v(y[re],R[re],this._bitLength),L[Q]=v(y[Q],R[Q],this._bitLength),W=Math.max(L[re].length,W),W=Math.max(L[Q].length,W)}var U=this.jpoint(null,null,null),B=this._wnafT4;for(A=W;A>=0;A--){for(var N=0;A>=0;){var z=!0;for(P=0;P<f;P++)B[P]=0|L[P][A],B[P]!==0&&(z=!1);if(!z)break;N++,A--}if(A>=0&&N++,U=U.dblp(N),A<0)break;for(P=0;P<f;P++){var H=B[P];H!==0&&(H>0?T=M[P][H-1>>1]:H<0&&(T=M[P][-H-1>>1].neg()),U=T.type==="affine"?U.mixedAdd(T):U.add(T))}}for(A=0;A<f;A++)M[A]=null;return w?U:U.toP()},E.BasePoint=b,b.prototype.eq=function(){throw new Error("Not implemented")},b.prototype.validate=function(){return this.curve.validate(this)},E.prototype.decodePoint=function(p,x){p=m.toArray(p,x);var y=this.p.byteLength();if((p[0]===4||p[0]===6||p[0]===7)&&p.length-1==2*y)return p[0]===6?_(p[p.length-1]%2==0):p[0]===7&&_(p[p.length-1]%2==1),this.point(p.slice(1,1+y),p.slice(1+y,1+2*y));if((p[0]===2||p[0]===3)&&p.length-1===y)return this.pointFromX(p.slice(1,1+y),p[0]===3);throw new Error("Unknown point format")},b.prototype.encodeCompressed=function(p){return this.encode(p,!0)},b.prototype._encode=function(p){var x=this.curve.p.byteLength(),y=this.getX().toArray("be",x);return p?[this.getY().isEven()?2:3].concat(y):[4].concat(y,this.getY().toArray("be",x))},b.prototype.encode=function(p,x){return m.encode(this._encode(x),p)},b.prototype.precompute=function(p){if(this.precomputed)return this;var x={doubles:null,naf:null,beta:null};return x.naf=this._getNAFPoints(8),x.doubles=this._getDoubles(4,p),x.beta=this._getBeta(),this.precomputed=x,this},b.prototype._hasDoubles=function(p){if(!this.precomputed)return!1;var x=this.precomputed.doubles;return!!x&&x.points.length>=Math.ceil((p.bitLength()+1)/x.step)},b.prototype._getDoubles=function(p,x){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var y=[this],f=this,w=0;w<x;w+=p){for(var A=0;A<p;A++)f=f.dbl();y.push(f)}return{step:p,points:y}},b.prototype._getNAFPoints=function(p){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var x=[this],y=(1<<p)-1,f=y===1?null:this.dbl(),w=1;w<y;w++)x[w]=x[w-1].add(f);return{wnd:p,points:x}},b.prototype._getBeta=function(){return null},b.prototype.dblp=function(p){for(var x=this,y=0;y<p;y++)x=x.dbl();return x}},958:(a,l,r)=>{var h=r(7891),m=r(815),v=r(376),g=r(9952),_=h.assert;function E(p){this.twisted=(0|p.a)!=1,this.mOneA=this.twisted&&(0|p.a)==-1,this.extended=this.mOneA,g.call(this,"edwards",p),this.a=new m(p.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new m(p.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new m(p.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),_(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|p.c)==1}function b(p,x,y,f,w){g.BasePoint.call(this,p,"projective"),x===null&&y===null&&f===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new m(x,16),this.y=new m(y,16),this.z=f?new m(f,16):this.curve.one,this.t=w&&new m(w,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}v(E,g),a.exports=E,E.prototype._mulA=function(p){return this.mOneA?p.redNeg():this.a.redMul(p)},E.prototype._mulC=function(p){return this.oneC?p:this.c.redMul(p)},E.prototype.jpoint=function(p,x,y,f){return this.point(p,x,y,f)},E.prototype.pointFromX=function(p,x){(p=new m(p,16)).red||(p=p.toRed(this.red));var y=p.redSqr(),f=this.c2.redSub(this.a.redMul(y)),w=this.one.redSub(this.c2.redMul(this.d).redMul(y)),A=f.redMul(w.redInvm()),P=A.redSqrt();if(P.redSqr().redSub(A).cmp(this.zero)!==0)throw new Error("invalid point");var T=P.fromRed().isOdd();return(x&&!T||!x&&T)&&(P=P.redNeg()),this.point(p,P)},E.prototype.pointFromY=function(p,x){(p=new m(p,16)).red||(p=p.toRed(this.red));var y=p.redSqr(),f=y.redSub(this.c2),w=y.redMul(this.d).redMul(this.c2).redSub(this.a),A=f.redMul(w.redInvm());if(A.cmp(this.zero)===0){if(x)throw new Error("invalid point");return this.point(this.zero,p)}var P=A.redSqrt();if(P.redSqr().redSub(A).cmp(this.zero)!==0)throw new Error("invalid point");return P.fromRed().isOdd()!==x&&(P=P.redNeg()),this.point(P,p)},E.prototype.validate=function(p){if(p.isInfinity())return!0;p.normalize();var x=p.x.redSqr(),y=p.y.redSqr(),f=x.redMul(this.a).redAdd(y),w=this.c2.redMul(this.one.redAdd(this.d.redMul(x).redMul(y)));return f.cmp(w)===0},v(b,g.BasePoint),E.prototype.pointFromJSON=function(p){return b.fromJSON(this,p)},E.prototype.point=function(p,x,y,f){return new b(this,p,x,y,f)},b.fromJSON=function(p,x){return new b(p,x[0],x[1],x[2])},b.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},b.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},b.prototype._extDbl=function(){var p=this.x.redSqr(),x=this.y.redSqr(),y=this.z.redSqr();y=y.redIAdd(y);var f=this.curve._mulA(p),w=this.x.redAdd(this.y).redSqr().redISub(p).redISub(x),A=f.redAdd(x),P=A.redSub(y),T=f.redSub(x),R=w.redMul(P),M=A.redMul(T),L=w.redMul(T),W=P.redMul(A);return this.curve.point(R,M,W,L)},b.prototype._projDbl=function(){var p,x,y,f,w,A,P=this.x.redAdd(this.y).redSqr(),T=this.x.redSqr(),R=this.y.redSqr();if(this.curve.twisted){var M=(f=this.curve._mulA(T)).redAdd(R);this.zOne?(p=P.redSub(T).redSub(R).redMul(M.redSub(this.curve.two)),x=M.redMul(f.redSub(R)),y=M.redSqr().redSub(M).redSub(M)):(w=this.z.redSqr(),A=M.redSub(w).redISub(w),p=P.redSub(T).redISub(R).redMul(A),x=M.redMul(f.redSub(R)),y=M.redMul(A))}else f=T.redAdd(R),w=this.curve._mulC(this.z).redSqr(),A=f.redSub(w).redSub(w),p=this.curve._mulC(P.redISub(f)).redMul(A),x=this.curve._mulC(f).redMul(T.redISub(R)),y=f.redMul(A);return this.curve.point(p,x,y)},b.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},b.prototype._extAdd=function(p){var x=this.y.redSub(this.x).redMul(p.y.redSub(p.x)),y=this.y.redAdd(this.x).redMul(p.y.redAdd(p.x)),f=this.t.redMul(this.curve.dd).redMul(p.t),w=this.z.redMul(p.z.redAdd(p.z)),A=y.redSub(x),P=w.redSub(f),T=w.redAdd(f),R=y.redAdd(x),M=A.redMul(P),L=T.redMul(R),W=A.redMul(R),G=P.redMul(T);return this.curve.point(M,L,G,W)},b.prototype._projAdd=function(p){var x,y,f=this.z.redMul(p.z),w=f.redSqr(),A=this.x.redMul(p.x),P=this.y.redMul(p.y),T=this.curve.d.redMul(A).redMul(P),R=w.redSub(T),M=w.redAdd(T),L=this.x.redAdd(this.y).redMul(p.x.redAdd(p.y)).redISub(A).redISub(P),W=f.redMul(R).redMul(L);return this.curve.twisted?(x=f.redMul(M).redMul(P.redSub(this.curve._mulA(A))),y=R.redMul(M)):(x=f.redMul(M).redMul(P.redSub(A)),y=this.curve._mulC(R).redMul(M)),this.curve.point(W,x,y)},b.prototype.add=function(p){return this.isInfinity()?p:p.isInfinity()?this:this.curve.extended?this._extAdd(p):this._projAdd(p)},b.prototype.mul=function(p){return this._hasDoubles(p)?this.curve._fixedNafMul(this,p):this.curve._wnafMul(this,p)},b.prototype.mulAdd=function(p,x,y){return this.curve._wnafMulAdd(1,[this,x],[p,y],2,!1)},b.prototype.jmulAdd=function(p,x,y){return this.curve._wnafMulAdd(1,[this,x],[p,y],2,!0)},b.prototype.normalize=function(){if(this.zOne)return this;var p=this.z.redInvm();return this.x=this.x.redMul(p),this.y=this.y.redMul(p),this.t&&(this.t=this.t.redMul(p)),this.z=this.curve.one,this.zOne=!0,this},b.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},b.prototype.getX=function(){return this.normalize(),this.x.fromRed()},b.prototype.getY=function(){return this.normalize(),this.y.fromRed()},b.prototype.eq=function(p){return this===p||this.getX().cmp(p.getX())===0&&this.getY().cmp(p.getY())===0},b.prototype.eqXToP=function(p){var x=p.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(x)===0)return!0;for(var y=p.clone(),f=this.curve.redN.redMul(this.z);;){if(y.iadd(this.curve.n),y.cmp(this.curve.p)>=0)return!1;if(x.redIAdd(f),this.x.cmp(x)===0)return!0}},b.prototype.toP=b.prototype.normalize,b.prototype.mixedAdd=b.prototype.add},4720:(a,l,r)=>{var h=l;h.base=r(9952),h.short=r(1585),h.mont=r(6773),h.edwards=r(958)},6773:(a,l,r)=>{var h=r(815),m=r(376),v=r(9952),g=r(7891);function _(b){v.call(this,"mont",b),this.a=new h(b.a,16).toRed(this.red),this.b=new h(b.b,16).toRed(this.red),this.i4=new h(4).toRed(this.red).redInvm(),this.two=new h(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function E(b,p,x){v.BasePoint.call(this,b,"projective"),p===null&&x===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new h(p,16),this.z=new h(x,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}m(_,v),a.exports=_,_.prototype.validate=function(b){var p=b.normalize().x,x=p.redSqr(),y=x.redMul(p).redAdd(x.redMul(this.a)).redAdd(p);return y.redSqrt().redSqr().cmp(y)===0},m(E,v.BasePoint),_.prototype.decodePoint=function(b,p){return this.point(g.toArray(b,p),1)},_.prototype.point=function(b,p){return new E(this,b,p)},_.prototype.pointFromJSON=function(b){return E.fromJSON(this,b)},E.prototype.precompute=function(){},E.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},E.fromJSON=function(b,p){return new E(b,p[0],p[1]||b.one)},E.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},E.prototype.isInfinity=function(){return this.z.cmpn(0)===0},E.prototype.dbl=function(){var b=this.x.redAdd(this.z).redSqr(),p=this.x.redSub(this.z).redSqr(),x=b.redSub(p),y=b.redMul(p),f=x.redMul(p.redAdd(this.curve.a24.redMul(x)));return this.curve.point(y,f)},E.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},E.prototype.diffAdd=function(b,p){var x=this.x.redAdd(this.z),y=this.x.redSub(this.z),f=b.x.redAdd(b.z),w=b.x.redSub(b.z).redMul(x),A=f.redMul(y),P=p.z.redMul(w.redAdd(A).redSqr()),T=p.x.redMul(w.redISub(A).redSqr());return this.curve.point(P,T)},E.prototype.mul=function(b){for(var p=b.clone(),x=this,y=this.curve.point(null,null),f=[];p.cmpn(0)!==0;p.iushrn(1))f.push(p.andln(1));for(var w=f.length-1;w>=0;w--)f[w]===0?(x=x.diffAdd(y,this),y=y.dbl()):(y=x.diffAdd(y,this),x=x.dbl());return y},E.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},E.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},E.prototype.eq=function(b){return this.getX().cmp(b.getX())===0},E.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},E.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},1585:(a,l,r)=>{var h=r(7891),m=r(815),v=r(376),g=r(9952),_=h.assert;function E(x){g.call(this,"short",x),this.a=new m(x.a,16).toRed(this.red),this.b=new m(x.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(x),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function b(x,y,f,w){g.BasePoint.call(this,x,"affine"),y===null&&f===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new m(y,16),this.y=new m(f,16),w&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function p(x,y,f,w){g.BasePoint.call(this,x,"jacobian"),y===null&&f===null&&w===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new m(0)):(this.x=new m(y,16),this.y=new m(f,16),this.z=new m(w,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}v(E,g),a.exports=E,E.prototype._getEndomorphism=function(x){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var y,f;if(x.beta)y=new m(x.beta,16).toRed(this.red);else{var w=this._getEndoRoots(this.p);y=(y=w[0].cmp(w[1])<0?w[0]:w[1]).toRed(this.red)}if(x.lambda)f=new m(x.lambda,16);else{var A=this._getEndoRoots(this.n);this.g.mul(A[0]).x.cmp(this.g.x.redMul(y))===0?f=A[0]:(f=A[1],_(this.g.mul(f).x.cmp(this.g.x.redMul(y))===0))}return{beta:y,lambda:f,basis:x.basis?x.basis.map(function(P){return{a:new m(P.a,16),b:new m(P.b,16)}}):this._getEndoBasis(f)}}},E.prototype._getEndoRoots=function(x){var y=x===this.p?this.red:m.mont(x),f=new m(2).toRed(y).redInvm(),w=f.redNeg(),A=new m(3).toRed(y).redNeg().redSqrt().redMul(f);return[w.redAdd(A).fromRed(),w.redSub(A).fromRed()]},E.prototype._getEndoBasis=function(x){for(var y,f,w,A,P,T,R,M,L,W=this.n.ushrn(Math.floor(this.n.bitLength()/2)),G=x,re=this.n.clone(),Q=new m(1),oe=new m(0),ae=new m(0),de=new m(1),be=0;G.cmpn(0)!==0;){var pe=re.div(G);M=re.sub(pe.mul(G)),L=ae.sub(pe.mul(Q));var U=de.sub(pe.mul(oe));if(!w&&M.cmp(W)<0)y=R.neg(),f=Q,w=M.neg(),A=L;else if(w&&++be==2)break;R=M,re=G,G=M,ae=Q,Q=L,de=oe,oe=U}P=M.neg(),T=L;var B=w.sqr().add(A.sqr());return P.sqr().add(T.sqr()).cmp(B)>=0&&(P=y,T=f),w.negative&&(w=w.neg(),A=A.neg()),P.negative&&(P=P.neg(),T=T.neg()),[{a:w,b:A},{a:P,b:T}]},E.prototype._endoSplit=function(x){var y=this.endo.basis,f=y[0],w=y[1],A=w.b.mul(x).divRound(this.n),P=f.b.neg().mul(x).divRound(this.n),T=A.mul(f.a),R=P.mul(w.a),M=A.mul(f.b),L=P.mul(w.b);return{k1:x.sub(T).sub(R),k2:M.add(L).neg()}},E.prototype.pointFromX=function(x,y){(x=new m(x,16)).red||(x=x.toRed(this.red));var f=x.redSqr().redMul(x).redIAdd(x.redMul(this.a)).redIAdd(this.b),w=f.redSqrt();if(w.redSqr().redSub(f).cmp(this.zero)!==0)throw new Error("invalid point");var A=w.fromRed().isOdd();return(y&&!A||!y&&A)&&(w=w.redNeg()),this.point(x,w)},E.prototype.validate=function(x){if(x.inf)return!0;var y=x.x,f=x.y,w=this.a.redMul(y),A=y.redSqr().redMul(y).redIAdd(w).redIAdd(this.b);return f.redSqr().redISub(A).cmpn(0)===0},E.prototype._endoWnafMulAdd=function(x,y,f){for(var w=this._endoWnafT1,A=this._endoWnafT2,P=0;P<x.length;P++){var T=this._endoSplit(y[P]),R=x[P],M=R._getBeta();T.k1.negative&&(T.k1.ineg(),R=R.neg(!0)),T.k2.negative&&(T.k2.ineg(),M=M.neg(!0)),w[2*P]=R,w[2*P+1]=M,A[2*P]=T.k1,A[2*P+1]=T.k2}for(var L=this._wnafMulAdd(1,w,A,2*P,f),W=0;W<2*P;W++)w[W]=null,A[W]=null;return L},v(b,g.BasePoint),E.prototype.point=function(x,y,f){return new b(this,x,y,f)},E.prototype.pointFromJSON=function(x,y){return b.fromJSON(this,x,y)},b.prototype._getBeta=function(){if(this.curve.endo){var x=this.precomputed;if(x&&x.beta)return x.beta;var y=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(x){var f=this.curve,w=function(A){return f.point(A.x.redMul(f.endo.beta),A.y)};x.beta=y,y.precomputed={beta:null,naf:x.naf&&{wnd:x.naf.wnd,points:x.naf.points.map(w)},doubles:x.doubles&&{step:x.doubles.step,points:x.doubles.points.map(w)}}}return y}},b.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},b.fromJSON=function(x,y,f){typeof y=="string"&&(y=JSON.parse(y));var w=x.point(y[0],y[1],f);if(!y[2])return w;function A(T){return x.point(T[0],T[1],f)}var P=y[2];return w.precomputed={beta:null,doubles:P.doubles&&{step:P.doubles.step,points:[w].concat(P.doubles.points.map(A))},naf:P.naf&&{wnd:P.naf.wnd,points:[w].concat(P.naf.points.map(A))}},w},b.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},b.prototype.isInfinity=function(){return this.inf},b.prototype.add=function(x){if(this.inf)return x;if(x.inf)return this;if(this.eq(x))return this.dbl();if(this.neg().eq(x))return this.curve.point(null,null);if(this.x.cmp(x.x)===0)return this.curve.point(null,null);var y=this.y.redSub(x.y);y.cmpn(0)!==0&&(y=y.redMul(this.x.redSub(x.x).redInvm()));var f=y.redSqr().redISub(this.x).redISub(x.x),w=y.redMul(this.x.redSub(f)).redISub(this.y);return this.curve.point(f,w)},b.prototype.dbl=function(){if(this.inf)return this;var x=this.y.redAdd(this.y);if(x.cmpn(0)===0)return this.curve.point(null,null);var y=this.curve.a,f=this.x.redSqr(),w=x.redInvm(),A=f.redAdd(f).redIAdd(f).redIAdd(y).redMul(w),P=A.redSqr().redISub(this.x.redAdd(this.x)),T=A.redMul(this.x.redSub(P)).redISub(this.y);return this.curve.point(P,T)},b.prototype.getX=function(){return this.x.fromRed()},b.prototype.getY=function(){return this.y.fromRed()},b.prototype.mul=function(x){return x=new m(x,16),this.isInfinity()?this:this._hasDoubles(x)?this.curve._fixedNafMul(this,x):this.curve.endo?this.curve._endoWnafMulAdd([this],[x]):this.curve._wnafMul(this,x)},b.prototype.mulAdd=function(x,y,f){var w=[this,y],A=[x,f];return this.curve.endo?this.curve._endoWnafMulAdd(w,A):this.curve._wnafMulAdd(1,w,A,2)},b.prototype.jmulAdd=function(x,y,f){var w=[this,y],A=[x,f];return this.curve.endo?this.curve._endoWnafMulAdd(w,A,!0):this.curve._wnafMulAdd(1,w,A,2,!0)},b.prototype.eq=function(x){return this===x||this.inf===x.inf&&(this.inf||this.x.cmp(x.x)===0&&this.y.cmp(x.y)===0)},b.prototype.neg=function(x){if(this.inf)return this;var y=this.curve.point(this.x,this.y.redNeg());if(x&&this.precomputed){var f=this.precomputed,w=function(A){return A.neg()};y.precomputed={naf:f.naf&&{wnd:f.naf.wnd,points:f.naf.points.map(w)},doubles:f.doubles&&{step:f.doubles.step,points:f.doubles.points.map(w)}}}return y},b.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},v(p,g.BasePoint),E.prototype.jpoint=function(x,y,f){return new p(this,x,y,f)},p.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var x=this.z.redInvm(),y=x.redSqr(),f=this.x.redMul(y),w=this.y.redMul(y).redMul(x);return this.curve.point(f,w)},p.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},p.prototype.add=function(x){if(this.isInfinity())return x;if(x.isInfinity())return this;var y=x.z.redSqr(),f=this.z.redSqr(),w=this.x.redMul(y),A=x.x.redMul(f),P=this.y.redMul(y.redMul(x.z)),T=x.y.redMul(f.redMul(this.z)),R=w.redSub(A),M=P.redSub(T);if(R.cmpn(0)===0)return M.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var L=R.redSqr(),W=L.redMul(R),G=w.redMul(L),re=M.redSqr().redIAdd(W).redISub(G).redISub(G),Q=M.redMul(G.redISub(re)).redISub(P.redMul(W)),oe=this.z.redMul(x.z).redMul(R);return this.curve.jpoint(re,Q,oe)},p.prototype.mixedAdd=function(x){if(this.isInfinity())return x.toJ();if(x.isInfinity())return this;var y=this.z.redSqr(),f=this.x,w=x.x.redMul(y),A=this.y,P=x.y.redMul(y).redMul(this.z),T=f.redSub(w),R=A.redSub(P);if(T.cmpn(0)===0)return R.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var M=T.redSqr(),L=M.redMul(T),W=f.redMul(M),G=R.redSqr().redIAdd(L).redISub(W).redISub(W),re=R.redMul(W.redISub(G)).redISub(A.redMul(L)),Q=this.z.redMul(T);return this.curve.jpoint(G,re,Q)},p.prototype.dblp=function(x){if(x===0)return this;if(this.isInfinity())return this;if(!x)return this.dbl();var y;if(this.curve.zeroA||this.curve.threeA){var f=this;for(y=0;y<x;y++)f=f.dbl();return f}var w=this.curve.a,A=this.curve.tinv,P=this.x,T=this.y,R=this.z,M=R.redSqr().redSqr(),L=T.redAdd(T);for(y=0;y<x;y++){var W=P.redSqr(),G=L.redSqr(),re=G.redSqr(),Q=W.redAdd(W).redIAdd(W).redIAdd(w.redMul(M)),oe=P.redMul(G),ae=Q.redSqr().redISub(oe.redAdd(oe)),de=oe.redISub(ae),be=Q.redMul(de);be=be.redIAdd(be).redISub(re);var pe=L.redMul(R);y+1<x&&(M=M.redMul(re)),P=ae,R=pe,L=be}return this.curve.jpoint(P,L.redMul(A),R)},p.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},p.prototype._zeroDbl=function(){var x,y,f;if(this.zOne){var w=this.x.redSqr(),A=this.y.redSqr(),P=A.redSqr(),T=this.x.redAdd(A).redSqr().redISub(w).redISub(P);T=T.redIAdd(T);var R=w.redAdd(w).redIAdd(w),M=R.redSqr().redISub(T).redISub(T),L=P.redIAdd(P);L=(L=L.redIAdd(L)).redIAdd(L),x=M,y=R.redMul(T.redISub(M)).redISub(L),f=this.y.redAdd(this.y)}else{var W=this.x.redSqr(),G=this.y.redSqr(),re=G.redSqr(),Q=this.x.redAdd(G).redSqr().redISub(W).redISub(re);Q=Q.redIAdd(Q);var oe=W.redAdd(W).redIAdd(W),ae=oe.redSqr(),de=re.redIAdd(re);de=(de=de.redIAdd(de)).redIAdd(de),x=ae.redISub(Q).redISub(Q),y=oe.redMul(Q.redISub(x)).redISub(de),f=(f=this.y.redMul(this.z)).redIAdd(f)}return this.curve.jpoint(x,y,f)},p.prototype._threeDbl=function(){var x,y,f;if(this.zOne){var w=this.x.redSqr(),A=this.y.redSqr(),P=A.redSqr(),T=this.x.redAdd(A).redSqr().redISub(w).redISub(P);T=T.redIAdd(T);var R=w.redAdd(w).redIAdd(w).redIAdd(this.curve.a),M=R.redSqr().redISub(T).redISub(T);x=M;var L=P.redIAdd(P);L=(L=L.redIAdd(L)).redIAdd(L),y=R.redMul(T.redISub(M)).redISub(L),f=this.y.redAdd(this.y)}else{var W=this.z.redSqr(),G=this.y.redSqr(),re=this.x.redMul(G),Q=this.x.redSub(W).redMul(this.x.redAdd(W));Q=Q.redAdd(Q).redIAdd(Q);var oe=re.redIAdd(re),ae=(oe=oe.redIAdd(oe)).redAdd(oe);x=Q.redSqr().redISub(ae),f=this.y.redAdd(this.z).redSqr().redISub(G).redISub(W);var de=G.redSqr();de=(de=(de=de.redIAdd(de)).redIAdd(de)).redIAdd(de),y=Q.redMul(oe.redISub(x)).redISub(de)}return this.curve.jpoint(x,y,f)},p.prototype._dbl=function(){var x=this.curve.a,y=this.x,f=this.y,w=this.z,A=w.redSqr().redSqr(),P=y.redSqr(),T=f.redSqr(),R=P.redAdd(P).redIAdd(P).redIAdd(x.redMul(A)),M=y.redAdd(y),L=(M=M.redIAdd(M)).redMul(T),W=R.redSqr().redISub(L.redAdd(L)),G=L.redISub(W),re=T.redSqr();re=(re=(re=re.redIAdd(re)).redIAdd(re)).redIAdd(re);var Q=R.redMul(G).redISub(re),oe=f.redAdd(f).redMul(w);return this.curve.jpoint(W,Q,oe)},p.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var x=this.x.redSqr(),y=this.y.redSqr(),f=this.z.redSqr(),w=y.redSqr(),A=x.redAdd(x).redIAdd(x),P=A.redSqr(),T=this.x.redAdd(y).redSqr().redISub(x).redISub(w),R=(T=(T=(T=T.redIAdd(T)).redAdd(T).redIAdd(T)).redISub(P)).redSqr(),M=w.redIAdd(w);M=(M=(M=M.redIAdd(M)).redIAdd(M)).redIAdd(M);var L=A.redIAdd(T).redSqr().redISub(P).redISub(R).redISub(M),W=y.redMul(L);W=(W=W.redIAdd(W)).redIAdd(W);var G=this.x.redMul(R).redISub(W);G=(G=G.redIAdd(G)).redIAdd(G);var re=this.y.redMul(L.redMul(M.redISub(L)).redISub(T.redMul(R)));re=(re=(re=re.redIAdd(re)).redIAdd(re)).redIAdd(re);var Q=this.z.redAdd(T).redSqr().redISub(f).redISub(R);return this.curve.jpoint(G,re,Q)},p.prototype.mul=function(x,y){return x=new m(x,y),this.curve._wnafMul(this,x)},p.prototype.eq=function(x){if(x.type==="affine")return this.eq(x.toJ());if(this===x)return!0;var y=this.z.redSqr(),f=x.z.redSqr();if(this.x.redMul(f).redISub(x.x.redMul(y)).cmpn(0)!==0)return!1;var w=y.redMul(this.z),A=f.redMul(x.z);return this.y.redMul(A).redISub(x.y.redMul(w)).cmpn(0)===0},p.prototype.eqXToP=function(x){var y=this.z.redSqr(),f=x.toRed(this.curve.red).redMul(y);if(this.x.cmp(f)===0)return!0;for(var w=x.clone(),A=this.curve.redN.redMul(y);;){if(w.iadd(this.curve.n),w.cmp(this.curve.p)>=0)return!1;if(f.redIAdd(A),this.x.cmp(f)===0)return!0}},p.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},p.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},1478:(a,l,r)=>{var h,m=l,v=r(3192),g=r(4720),_=r(7891).assert;function E(p){p.type==="short"?this.curve=new g.short(p):p.type==="edwards"?this.curve=new g.edwards(p):this.curve=new g.mont(p),this.g=this.curve.g,this.n=this.curve.n,this.hash=p.hash,_(this.g.validate(),"Invalid curve"),_(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function b(p,x){Object.defineProperty(m,p,{configurable:!0,enumerable:!0,get:function(){var y=new E(x);return Object.defineProperty(m,p,{configurable:!0,enumerable:!0,value:y}),y}})}m.PresetCurve=E,b("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:v.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),b("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:v.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),b("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:v.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),b("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:v.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),b("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:v.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),b("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:v.sha256,gRed:!1,g:["9"]}),b("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:v.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{h=r(8948)}catch{h=void 0}b("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:v.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",h]})},5806:(a,l,r)=>{function h(f){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},h(f)}var m=r(815),v=r(9742),g=r(7891),_=r(1478),E=r(7179),b=g.assert,p=r(3598),x=r(5206);function y(f){if(!(this instanceof y))return new y(f);typeof f=="string"&&(b(Object.prototype.hasOwnProperty.call(_,f),"Unknown curve "+f),f=_[f]),f instanceof _.PresetCurve&&(f={curve:f}),this.curve=f.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=f.curve.g,this.g.precompute(f.curve.n.bitLength()+1),this.hash=f.hash||f.curve.hash}a.exports=y,y.prototype.keyPair=function(f){return new p(this,f)},y.prototype.keyFromPrivate=function(f,w){return p.fromPrivate(this,f,w)},y.prototype.keyFromPublic=function(f,w){return p.fromPublic(this,f,w)},y.prototype.genKeyPair=function(f){f||(f={});for(var w=new v({hash:this.hash,pers:f.pers,persEnc:f.persEnc||"utf8",entropy:f.entropy||E(this.hash.hmacStrength),entropyEnc:f.entropy&&f.entropyEnc||"utf8",nonce:this.n.toArray()}),A=this.n.byteLength(),P=this.n.sub(new m(2));;){var T=new m(w.generate(A));if(!(T.cmp(P)>0))return T.iaddn(1),this.keyFromPrivate(T)}},y.prototype._truncateToN=function(f,w){var A=8*f.byteLength()-this.n.bitLength();return A>0&&(f=f.ushrn(A)),!w&&f.cmp(this.n)>=0?f.sub(this.n):f},y.prototype.sign=function(f,w,A,P){h(A)==="object"&&(P=A,A=null),P||(P={}),w=this.keyFromPrivate(w,A),f=this._truncateToN(new m(f,16));for(var T=this.n.byteLength(),R=w.getPrivate().toArray("be",T),M=f.toArray("be",T),L=new v({hash:this.hash,entropy:R,nonce:M,pers:P.pers,persEnc:P.persEnc||"utf8"}),W=this.n.sub(new m(1)),G=0;;G++){var re=P.k?P.k(G):new m(L.generate(this.n.byteLength()));if(!((re=this._truncateToN(re,!0)).cmpn(1)<=0||re.cmp(W)>=0)){var Q=this.g.mul(re);if(!Q.isInfinity()){var oe=Q.getX(),ae=oe.umod(this.n);if(ae.cmpn(0)!==0){var de=re.invm(this.n).mul(ae.mul(w.getPrivate()).iadd(f));if((de=de.umod(this.n)).cmpn(0)!==0){var be=(Q.getY().isOdd()?1:0)|(oe.cmp(ae)!==0?2:0);return P.canonical&&de.cmp(this.nh)>0&&(de=this.n.sub(de),be^=1),new x({r:ae,s:de,recoveryParam:be})}}}}}},y.prototype.verify=function(f,w,A,P){f=this._truncateToN(new m(f,16)),A=this.keyFromPublic(A,P);var T=(w=new x(w,"hex")).r,R=w.s;if(T.cmpn(1)<0||T.cmp(this.n)>=0||R.cmpn(1)<0||R.cmp(this.n)>=0)return!1;var M,L=R.invm(this.n),W=L.mul(f).umod(this.n),G=L.mul(T).umod(this.n);return this.curve._maxwellTrick?!(M=this.g.jmulAdd(W,A.getPublic(),G)).isInfinity()&&M.eqXToP(T):!(M=this.g.mulAdd(W,A.getPublic(),G)).isInfinity()&&M.getX().umod(this.n).cmp(T)===0},y.prototype.recoverPubKey=function(f,w,A,P){b((3&A)===A,"The recovery param is more than two bits"),w=new x(w,P);var T=this.n,R=new m(f),M=w.r,L=w.s,W=1&A,G=A>>1;if(M.cmp(this.curve.p.umod(this.curve.n))>=0&&G)throw new Error("Unable to find sencond key candinate");M=G?this.curve.pointFromX(M.add(this.curve.n),W):this.curve.pointFromX(M,W);var re=w.r.invm(T),Q=T.sub(R).mul(re).umod(T),oe=L.mul(re).umod(T);return this.g.mulAdd(Q,M,oe)},y.prototype.getKeyRecoveryParam=function(f,w,A,P){if((w=new x(w,P)).recoveryParam!==null)return w.recoveryParam;for(var T=0;T<4;T++){var R;try{R=this.recoverPubKey(f,w,T)}catch{continue}if(R.eq(A))return T}throw new Error("Unable to find valid recovery factor")}},3598:(a,l,r)=>{var h=r(815),m=r(7891).assert;function v(g,_){this.ec=g,this.priv=null,this.pub=null,_.priv&&this._importPrivate(_.priv,_.privEnc),_.pub&&this._importPublic(_.pub,_.pubEnc)}a.exports=v,v.fromPublic=function(g,_,E){return _ instanceof v?_:new v(g,{pub:_,pubEnc:E})},v.fromPrivate=function(g,_,E){return _ instanceof v?_:new v(g,{priv:_,privEnc:E})},v.prototype.validate=function(){var g=this.getPublic();return g.isInfinity()?{result:!1,reason:"Invalid public key"}:g.validate()?g.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},v.prototype.getPublic=function(g,_){return typeof g=="string"&&(_=g,g=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),_?this.pub.encode(_,g):this.pub},v.prototype.getPrivate=function(g){return g==="hex"?this.priv.toString(16,2):this.priv},v.prototype._importPrivate=function(g,_){this.priv=new h(g,_||16),this.priv=this.priv.umod(this.ec.curve.n)},v.prototype._importPublic=function(g,_){if(g.x||g.y)return this.ec.curve.type==="mont"?m(g.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||m(g.x&&g.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(g.x,g.y));this.pub=this.ec.curve.decodePoint(g,_)},v.prototype.derive=function(g){return g.validate()||m(g.validate(),"public point not validated"),g.mul(this.priv).getX()},v.prototype.sign=function(g,_,E){return this.ec.sign(g,this,_,E)},v.prototype.verify=function(g,_){return this.ec.verify(g,_,this)},v.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},5206:(a,l,r)=>{var h=r(815),m=r(7891),v=m.assert;function g(x,y){if(x instanceof g)return x;this._importDER(x,y)||(v(x.r&&x.s,"Signature without r or s"),this.r=new h(x.r,16),this.s=new h(x.s,16),x.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=x.recoveryParam)}function _(){this.place=0}function E(x,y){var f=x[y.place++];if(!(128&f))return f;var w=15&f;if(w===0||w>4)return!1;for(var A=0,P=0,T=y.place;P<w;P++,T++)A<<=8,A|=x[T],A>>>=0;return!(A<=127)&&(y.place=T,A)}function b(x){for(var y=0,f=x.length-1;!x[y]&&!(128&x[y+1])&&y<f;)y++;return y===0?x:x.slice(y)}function p(x,y){if(y<128)x.push(y);else{var f=1+(Math.log(y)/Math.LN2>>>3);for(x.push(128|f);--f;)x.push(y>>>(f<<3)&255);x.push(y)}}a.exports=g,g.prototype._importDER=function(x,y){x=m.toArray(x,y);var f=new _;if(x[f.place++]!==48)return!1;var w=E(x,f);if(w===!1||w+f.place!==x.length||x[f.place++]!==2)return!1;var A=E(x,f);if(A===!1)return!1;var P=x.slice(f.place,A+f.place);if(f.place+=A,x[f.place++]!==2)return!1;var T=E(x,f);if(T===!1||x.length!==T+f.place)return!1;var R=x.slice(f.place,T+f.place);if(P[0]===0){if(!(128&P[1]))return!1;P=P.slice(1)}if(R[0]===0){if(!(128&R[1]))return!1;R=R.slice(1)}return this.r=new h(P),this.s=new h(R),this.recoveryParam=null,!0},g.prototype.toDER=function(x){var y=this.r.toArray(),f=this.s.toArray();for(128&y[0]&&(y=[0].concat(y)),128&f[0]&&(f=[0].concat(f)),y=b(y),f=b(f);!(f[0]||128&f[1]);)f=f.slice(1);var w=[2];p(w,y.length),(w=w.concat(y)).push(2),p(w,f.length);var A=w.concat(f),P=[48];return p(P,A.length),P=P.concat(A),m.encode(P,x)}},8318:(a,l,r)=>{var h=r(3192),m=r(1478),v=r(7891),g=v.assert,_=v.parseBytes,E=r(9371),b=r(2214);function p(x){if(g(x==="ed25519","only tested with ed25519 so far"),!(this instanceof p))return new p(x);x=m[x].curve,this.curve=x,this.g=x.g,this.g.precompute(x.n.bitLength()+1),this.pointClass=x.point().constructor,this.encodingLength=Math.ceil(x.n.bitLength()/8),this.hash=h.sha512}a.exports=p,p.prototype.sign=function(x,y){x=_(x);var f=this.keyFromSecret(y),w=this.hashInt(f.messagePrefix(),x),A=this.g.mul(w),P=this.encodePoint(A),T=this.hashInt(P,f.pubBytes(),x).mul(f.priv()),R=w.add(T).umod(this.curve.n);return this.makeSignature({R:A,S:R,Rencoded:P})},p.prototype.verify=function(x,y,f){x=_(x),y=this.makeSignature(y);var w=this.keyFromPublic(f),A=this.hashInt(y.Rencoded(),w.pubBytes(),x),P=this.g.mul(y.S());return y.R().add(w.pub().mul(A)).eq(P)},p.prototype.hashInt=function(){for(var x=this.hash(),y=0;y<arguments.length;y++)x.update(arguments[y]);return v.intFromLE(x.digest()).umod(this.curve.n)},p.prototype.keyFromPublic=function(x){return E.fromPublic(this,x)},p.prototype.keyFromSecret=function(x){return E.fromSecret(this,x)},p.prototype.makeSignature=function(x){return x instanceof b?x:new b(this,x)},p.prototype.encodePoint=function(x){var y=x.getY().toArray("le",this.encodingLength);return y[this.encodingLength-1]|=x.getX().isOdd()?128:0,y},p.prototype.decodePoint=function(x){var y=(x=v.parseBytes(x)).length-1,f=x.slice(0,y).concat(-129&x[y]),w=(128&x[y])!=0,A=v.intFromLE(f);return this.curve.pointFromY(A,w)},p.prototype.encodeInt=function(x){return x.toArray("le",this.encodingLength)},p.prototype.decodeInt=function(x){return v.intFromLE(x)},p.prototype.isPoint=function(x){return x instanceof this.pointClass}},9371:(a,l,r)=>{var h=r(7891),m=h.assert,v=h.parseBytes,g=h.cachedProperty;function _(E,b){this.eddsa=E,this._secret=v(b.secret),E.isPoint(b.pub)?this._pub=b.pub:this._pubBytes=v(b.pub)}_.fromPublic=function(E,b){return b instanceof _?b:new _(E,{pub:b})},_.fromSecret=function(E,b){return b instanceof _?b:new _(E,{secret:b})},_.prototype.secret=function(){return this._secret},g(_,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),g(_,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),g(_,"privBytes",function(){var E=this.eddsa,b=this.hash(),p=E.encodingLength-1,x=b.slice(0,E.encodingLength);return x[0]&=248,x[p]&=127,x[p]|=64,x}),g(_,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),g(_,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),g(_,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),_.prototype.sign=function(E){return m(this._secret,"KeyPair can only verify"),this.eddsa.sign(E,this)},_.prototype.verify=function(E,b){return this.eddsa.verify(E,b,this)},_.prototype.getSecret=function(E){return m(this._secret,"KeyPair is public only"),h.encode(this.secret(),E)},_.prototype.getPublic=function(E){return h.encode(this.pubBytes(),E)},a.exports=_},2214:(a,l,r)=>{function h(p){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(p)}var m=r(815),v=r(7891),g=v.assert,_=v.cachedProperty,E=v.parseBytes;function b(p,x){this.eddsa=p,h(x)!=="object"&&(x=E(x)),Array.isArray(x)&&(x={R:x.slice(0,p.encodingLength),S:x.slice(p.encodingLength)}),g(x.R&&x.S,"Signature without R or S"),p.isPoint(x.R)&&(this._R=x.R),x.S instanceof m&&(this._S=x.S),this._Rencoded=Array.isArray(x.R)?x.R:x.Rencoded,this._Sencoded=Array.isArray(x.S)?x.S:x.Sencoded}_(b,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),_(b,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),_(b,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),_(b,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),b.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},b.prototype.toHex=function(){return v.encode(this.toBytes(),"hex").toUpperCase()},a.exports=b},8948:a=>{a.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},7891:(a,l,r)=>{var h=l,m=r(815),v=r(1130),g=r(5522);h.assert=v,h.toArray=g.toArray,h.zero2=g.zero2,h.toHex=g.toHex,h.encode=g.encode,h.getNAF=function(_,E,b){var p=new Array(Math.max(_.bitLength(),b)+1);p.fill(0);for(var x=1<<E+1,y=_.clone(),f=0;f<p.length;f++){var w,A=y.andln(x-1);y.isOdd()?(w=A>(x>>1)-1?(x>>1)-A:A,y.isubn(w)):w=0,p[f]=w,y.iushrn(1)}return p},h.getJSF=function(_,E){var b=[[],[]];_=_.clone(),E=E.clone();for(var p,x=0,y=0;_.cmpn(-x)>0||E.cmpn(-y)>0;){var f,w,A=_.andln(3)+x&3,P=E.andln(3)+y&3;A===3&&(A=-1),P===3&&(P=-1),f=1&A?(p=_.andln(7)+x&7)!=3&&p!==5||P!==2?A:-A:0,b[0].push(f),w=1&P?(p=E.andln(7)+y&7)!=3&&p!==5||A!==2?P:-P:0,b[1].push(w),2*x===f+1&&(x=1-x),2*y===w+1&&(y=1-y),_.iushrn(1),E.iushrn(1)}return b},h.cachedProperty=function(_,E,b){var p="_"+E;_.prototype[E]=function(){return this[p]!==void 0?this[p]:this[p]=b.call(this)}},h.parseBytes=function(_){return typeof _=="string"?h.toArray(_,"hex"):_},h.intFromLE=function(_){return new m(_,"hex","le")}},8028:a=>{function l(r,h){if(r==null)throw new TypeError("Cannot convert first argument to object");for(var m=Object(r),v=1;v<arguments.length;v++){var g=arguments[v];if(g!=null)for(var _=Object.keys(Object(g)),E=0,b=_.length;E<b;E++){var p=_[E],x=Object.getOwnPropertyDescriptor(g,p);x!==void 0&&x.enumerable&&(m[p]=g[p])}}return m}a.exports={assign:l,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:l})}}},9620:a=>{function l(T){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},l(T)}var r,h=(typeof Reflect>"u"?"undefined":l(Reflect))==="object"?Reflect:null,m=h&&typeof h.apply=="function"?h.apply:function(T,R,M){return Function.prototype.apply.call(T,R,M)};r=h&&typeof h.ownKeys=="function"?h.ownKeys:Object.getOwnPropertySymbols?function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:function(T){return Object.getOwnPropertyNames(T)};var v=Number.isNaN||function(T){return T!=T};function g(){g.init.call(this)}a.exports=g,a.exports.once=function(T,R){return new Promise(function(M,L){function W(re){T.removeListener(R,G),L(re)}function G(){typeof T.removeListener=="function"&&T.removeListener("error",W),M([].slice.call(arguments))}P(T,R,G,{once:!0}),R!=="error"&&function(re,Q,oe){typeof re.on=="function"&&P(re,"error",Q,{once:!0})}(T,W)})},g.EventEmitter=g,g.prototype._events=void 0,g.prototype._eventsCount=0,g.prototype._maxListeners=void 0;var _=10;function E(T){if(typeof T!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+l(T))}function b(T){return T._maxListeners===void 0?g.defaultMaxListeners:T._maxListeners}function p(T,R,M,L){var W,G,re,Q;if(E(M),(G=T._events)===void 0?(G=T._events=Object.create(null),T._eventsCount=0):(G.newListener!==void 0&&(T.emit("newListener",R,M.listener?M.listener:M),G=T._events),re=G[R]),re===void 0)re=G[R]=M,++T._eventsCount;else if(typeof re=="function"?re=G[R]=L?[M,re]:[re,M]:L?re.unshift(M):re.push(M),(W=b(T))>0&&re.length>W&&!re.warned){re.warned=!0;var oe=new Error("Possible EventEmitter memory leak detected. "+re.length+" "+String(R)+" listeners added. Use emitter.setMaxListeners() to increase limit");oe.name="MaxListenersExceededWarning",oe.emitter=T,oe.type=R,oe.count=re.length,Q=oe,console&&console.warn&&console.warn(Q)}return T}function x(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(T,R,M){var L={fired:!1,wrapFn:void 0,target:T,type:R,listener:M},W=x.bind(L);return W.listener=M,L.wrapFn=W,W}function f(T,R,M){var L=T._events;if(L===void 0)return[];var W=L[R];return W===void 0?[]:typeof W=="function"?M?[W.listener||W]:[W]:M?function(G){for(var re=new Array(G.length),Q=0;Q<re.length;++Q)re[Q]=G[Q].listener||G[Q];return re}(W):A(W,W.length)}function w(T){var R=this._events;if(R!==void 0){var M=R[T];if(typeof M=="function")return 1;if(M!==void 0)return M.length}return 0}function A(T,R){for(var M=new Array(R),L=0;L<R;++L)M[L]=T[L];return M}function P(T,R,M,L){if(typeof T.on=="function")L.once?T.once(R,M):T.on(R,M);else{if(typeof T.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+l(T));T.addEventListener(R,function W(G){L.once&&T.removeEventListener(R,W),M(G)})}}Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(T){if(typeof T!="number"||T<0||v(T))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+T+".");_=T}}),g.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},g.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||v(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this},g.prototype.getMaxListeners=function(){return b(this)},g.prototype.emit=function(T){for(var R=[],M=1;M<arguments.length;M++)R.push(arguments[M]);var L=T==="error",W=this._events;if(W!==void 0)L=L&&W.error===void 0;else if(!L)return!1;if(L){var G;if(R.length>0&&(G=R[0]),G instanceof Error)throw G;var re=new Error("Unhandled error."+(G?" ("+G.message+")":""));throw re.context=G,re}var Q=W[T];if(Q===void 0)return!1;if(typeof Q=="function")m(Q,this,R);else{var oe=Q.length,ae=A(Q,oe);for(M=0;M<oe;++M)m(ae[M],this,R)}return!0},g.prototype.addListener=function(T,R){return p(this,T,R,!1)},g.prototype.on=g.prototype.addListener,g.prototype.prependListener=function(T,R){return p(this,T,R,!0)},g.prototype.once=function(T,R){return E(R),this.on(T,y(this,T,R)),this},g.prototype.prependOnceListener=function(T,R){return E(R),this.prependListener(T,y(this,T,R)),this},g.prototype.removeListener=function(T,R){var M,L,W,G,re;if(E(R),(L=this._events)===void 0)return this;if((M=L[T])===void 0)return this;if(M===R||M.listener===R)--this._eventsCount==0?this._events=Object.create(null):(delete L[T],L.removeListener&&this.emit("removeListener",T,M.listener||R));else if(typeof M!="function"){for(W=-1,G=M.length-1;G>=0;G--)if(M[G]===R||M[G].listener===R){re=M[G].listener,W=G;break}if(W<0)return this;W===0?M.shift():function(Q,oe){for(;oe+1<Q.length;oe++)Q[oe]=Q[oe+1];Q.pop()}(M,W),M.length===1&&(L[T]=M[0]),L.removeListener!==void 0&&this.emit("removeListener",T,re||R)}return this},g.prototype.off=g.prototype.removeListener,g.prototype.removeAllListeners=function(T){var R,M,L;if((M=this._events)===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[T]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete M[T]),this;if(arguments.length===0){var W,G=Object.keys(M);for(L=0;L<G.length;++L)(W=G[L])!=="removeListener"&&this.removeAllListeners(W);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(R=M[T])=="function")this.removeListener(T,R);else if(R!==void 0)for(L=R.length-1;L>=0;L--)this.removeListener(T,R[L]);return this},g.prototype.listeners=function(T){return f(this,T,!0)},g.prototype.rawListeners=function(T){return f(this,T,!1)},g.listenerCount=function(T,R){return typeof T.listenerCount=="function"?T.listenerCount(R):w.call(T,R)},g.prototype.listenerCount=w,g.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},1248:(a,l,r)=>{var h=r(9047).Buffer,m=r(722);a.exports=function(v,g,_,E){if(h.isBuffer(v)||(v=h.from(v,"binary")),g&&(h.isBuffer(g)||(g=h.from(g,"binary")),g.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var b=_/8,p=h.alloc(b),x=h.alloc(E||0),y=h.alloc(0);b>0||E>0;){var f=new m;f.update(y),f.update(v),g&&f.update(g),y=f.digest();var w=0;if(b>0){var A=p.length-b;w=Math.min(b,y.length),y.copy(p,A,0,w),b-=w}if(w<y.length&&E>0){var P=x.length-E,T=Math.min(E,y.length-w);y.copy(x,P,w,w+T),E-=T}}return y.fill(0),{key:p,iv:x}}},5337:(a,l,r)=>{var h=r(8625),m=Object.prototype.toString,v=Object.prototype.hasOwnProperty;a.exports=function(g,_,E){if(!h(_))throw new TypeError("iterator must be a function");var b;arguments.length>=3&&(b=E),m.call(g)==="[object Array]"?function(p,x,y){for(var f=0,w=p.length;f<w;f++)v.call(p,f)&&(y==null?x(p[f],f,p):x.call(y,p[f],f,p))}(g,_,b):typeof g=="string"?function(p,x,y){for(var f=0,w=p.length;f<w;f++)y==null?x(p.charAt(f),f,p):x.call(y,p.charAt(f),f,p)}(g,_,b):function(p,x,y){for(var f in p)v.call(p,f)&&(y==null?x(p[f],f,p):x.call(y,p[f],f,p))}(g,_,b)}},5929:a=>{var l=Object.prototype.toString,r=Math.max,h=function(m,v){for(var g=[],_=0;_<m.length;_+=1)g[_]=m[_];for(var E=0;E<v.length;E+=1)g[E+m.length]=v[E];return g};a.exports=function(m){var v=this;if(typeof v!="function"||l.apply(v)!=="[object Function]")throw new TypeError("Function.prototype.bind called on incompatible "+v);for(var g,_=function(y,f){for(var w=[],A=1,P=0;A<y.length;A+=1,P+=1)w[P]=y[A];return w}(arguments),E=r(0,v.length-_.length),b=[],p=0;p<E;p++)b[p]="$"+p;if(g=Function("binder","return function ("+function(y,f){for(var w="",A=0;A<y.length;A+=1)w+=y[A],A+1<y.length&&(w+=",");return w}(b)+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof g){var y=v.apply(this,h(_,arguments));return Object(y)===y?y:this}return v.apply(m,h(_,arguments))}),v.prototype){var x=function(){};x.prototype=v.prototype,g.prototype=new x,x.prototype=null}return g}},5246:(a,l,r)=>{var h=r(5929);a.exports=Function.prototype.bind||h},6893:(a,l,r)=>{function h(B){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},h(B)}var m,v=SyntaxError,g=Function,_=TypeError,E=function(B){try{return g('"use strict"; return ('+B+").constructor;")()}catch{}},b=Object.getOwnPropertyDescriptor;if(b)try{b({},"")}catch{b=null}var p=function(){throw new _},x=b?function(){try{return p}catch{try{return b(arguments,"callee").get}catch{return p}}}():p,y=r(5990)(),f=r(4406)(),w=Object.getPrototypeOf||(f?function(B){return B.__proto__}:null),A={},P=typeof Uint8Array<"u"&&w?w(Uint8Array):m,T={"%AggregateError%":typeof AggregateError>"u"?m:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?m:ArrayBuffer,"%ArrayIteratorPrototype%":y&&w?w([][Symbol.iterator]()):m,"%AsyncFromSyncIteratorPrototype%":m,"%AsyncFunction%":A,"%AsyncGenerator%":A,"%AsyncGeneratorFunction%":A,"%AsyncIteratorPrototype%":A,"%Atomics%":typeof Atomics>"u"?m:Atomics,"%BigInt%":typeof BigInt>"u"?m:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?m:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?m:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?m:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?m:Float32Array,"%Float64Array%":typeof Float64Array>"u"?m:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?m:FinalizationRegistry,"%Function%":g,"%GeneratorFunction%":A,"%Int8Array%":typeof Int8Array>"u"?m:Int8Array,"%Int16Array%":typeof Int16Array>"u"?m:Int16Array,"%Int32Array%":typeof Int32Array>"u"?m:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":y&&w?w(w([][Symbol.iterator]())):m,"%JSON%":(typeof JSON>"u"?"undefined":h(JSON))==="object"?JSON:m,"%Map%":typeof Map>"u"?m:Map,"%MapIteratorPrototype%":typeof Map<"u"&&y&&w?w(new Map()[Symbol.iterator]()):m,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?m:Promise,"%Proxy%":typeof Proxy>"u"?m:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?m:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?m:Set,"%SetIteratorPrototype%":typeof Set<"u"&&y&&w?w(new Set()[Symbol.iterator]()):m,"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?m:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":y&&w?w(""[Symbol.iterator]()):m,"%Symbol%":y?Symbol:m,"%SyntaxError%":v,"%ThrowTypeError%":x,"%TypedArray%":P,"%TypeError%":_,"%Uint8Array%":typeof Uint8Array>"u"?m:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?m:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?m:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?m:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?m:WeakMap,"%WeakRef%":typeof WeakRef>"u"?m:WeakRef,"%WeakSet%":typeof WeakSet>"u"?m:WeakSet};if(w)try{null.error}catch(B){var R=w(w(B));T["%Error.prototype%"]=R}var M=function B(N){var z;if(N==="%AsyncFunction%")z=E("async function () {}");else if(N==="%GeneratorFunction%")z=E("function* () {}");else if(N==="%AsyncGeneratorFunction%")z=E("async function* () {}");else if(N==="%AsyncGenerator%"){var H=B("%AsyncGeneratorFunction%");H&&(z=H.prototype)}else if(N==="%AsyncIteratorPrototype%"){var Y=B("%AsyncGenerator%");Y&&w&&(z=w(Y.prototype))}return T[N]=z,z},L={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},W=r(5246),G=r(8939),re=W.call(Function.call,Array.prototype.concat),Q=W.call(Function.apply,Array.prototype.splice),oe=W.call(Function.call,String.prototype.replace),ae=W.call(Function.call,String.prototype.slice),de=W.call(Function.call,RegExp.prototype.exec),be=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,pe=/\\(\\)?/g,U=function(B,N){var z,H=B;if(G(L,H)&&(H="%"+(z=L[H])[0]+"%"),G(T,H)){var Y=T[H];if(Y===A&&(Y=M(H)),Y===void 0&&!N)throw new _("intrinsic "+B+" exists, but is not available. Please file an issue!");return{alias:z,name:H,value:Y}}throw new v("intrinsic "+B+" does not exist!")};a.exports=function(B,N){if(typeof B!="string"||B.length===0)throw new _("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof N!="boolean")throw new _('"allowMissing" argument must be a boolean');if(de(/^%?[^%]*%?$/,B)===null)throw new v("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var z=function(_e){var te=ae(_e,0,1),$e=ae(_e,-1);if(te==="%"&&$e!=="%")throw new v("invalid intrinsic syntax, expected closing `%`");if($e==="%"&&te!=="%")throw new v("invalid intrinsic syntax, expected opening `%`");var ge=[];return oe(_e,be,function(le,ze,Je,et){ge[ge.length]=Je?oe(et,pe,"$1"):ze||le}),ge}(B),H=z.length>0?z[0]:"",Y=U("%"+H+"%",N),fe=Y.name,Re=Y.value,Oe=!1,De=Y.alias;De&&(H=De[0],Q(z,re([0,1],De)));for(var ot=1,X=!0;ot<z.length;ot+=1){var ee=z[ot],Le=ae(ee,0,1),Be=ae(ee,-1);if((Le==='"'||Le==="'"||Le==="`"||Be==='"'||Be==="'"||Be==="`")&&Le!==Be)throw new v("property names with quotes must have matching quotes");if(ee!=="constructor"&&X||(Oe=!0),G(T,fe="%"+(H+="."+ee)+"%"))Re=T[fe];else if(Re!=null){if(!(ee in Re)){if(!N)throw new _("base intrinsic for "+B+" exists, but the property is not available.");return}if(b&&ot+1>=z.length){var se=b(Re,ee);Re=(X=!!se)&&"get"in se&&!("originalValue"in se.get)?se.get:Re[ee]}else X=G(Re,ee),Re=Re[ee];X&&!Oe&&(T[fe]=Re)}}return Re}},1554:(a,l,r)=>{var h=r(6893)("%Object.getOwnPropertyDescriptor%",!0);if(h)try{h([],"length")}catch{h=null}a.exports=h},2579:(a,l,r)=>{var h=r(6893)("%Object.defineProperty%",!0),m=function(){if(h)try{return h({},"a",{value:1}),!0}catch{return!1}return!1};m.hasArrayLengthDefineBug=function(){if(!m())return null;try{return h([],"length",{value:1}).length!==1}catch{return!0}},a.exports=m},4406:a=>{var l={foo:{}},r=Object;a.exports=function(){return{__proto__:l}.foo===l.foo&&!({__proto__:null}instanceof r)}},5990:(a,l,r)=>{function h(g){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},h(g)}var m=typeof Symbol<"u"&&Symbol,v=r(3031);a.exports=function(){return typeof m=="function"&&typeof Symbol=="function"&&h(m("foo"))==="symbol"&&h(Symbol("bar"))==="symbol"&&v()}},3031:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(l(Symbol.iterator)==="symbol")return!0;var r={},h=Symbol("test"),m=Object(h);if(typeof h=="string"||Object.prototype.toString.call(h)!=="[object Symbol]"||Object.prototype.toString.call(m)!=="[object Symbol]")return!1;for(h in r[h]=42,r)return!1;if(typeof Object.keys=="function"&&Object.keys(r).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(r).length!==0)return!1;var v=Object.getOwnPropertySymbols(r);if(v.length!==1||v[0]!==h||!Object.prototype.propertyIsEnumerable.call(r,h))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var g=Object.getOwnPropertyDescriptor(r,h);if(g.value!==42||g.enumerable!==!0)return!1}return!0}},5994:(a,l,r)=>{var h=r(3031);a.exports=function(){return h()&&!!Symbol.toStringTag}},5125:(a,l,r)=>{var h=r(9047).Buffer,m=r(2531).Transform;function v(g){m.call(this),this._block=h.allocUnsafe(g),this._blockSize=g,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}r(376)(v,m),v.prototype._transform=function(g,_,E){var b=null;try{this.update(g,_)}catch(p){b=p}E(b)},v.prototype._flush=function(g){var _=null;try{this.push(this.digest())}catch(E){_=E}g(_)},v.prototype.update=function(g,_){if(function(f,w){if(!h.isBuffer(f)&&typeof f!="string")throw new TypeError("Data must be a string or a buffer")}(g),this._finalized)throw new Error("Digest already called");h.isBuffer(g)||(g=h.from(g,_));for(var E=this._block,b=0;this._blockOffset+g.length-b>=this._blockSize;){for(var p=this._blockOffset;p<this._blockSize;)E[p++]=g[b++];this._update(),this._blockOffset=0}for(;b<g.length;)E[this._blockOffset++]=g[b++];for(var x=0,y=8*g.length;y>0;++x)this._length[x]+=y,(y=this._length[x]/4294967296|0)>0&&(this._length[x]-=4294967296*y);return this},v.prototype._update=function(){throw new Error("_update is not implemented")},v.prototype.digest=function(g){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var _=this._digest();g!==void 0&&(_=_.toString(g)),this._block.fill(0),this._blockOffset=0;for(var E=0;E<4;++E)this._length[E]=0;return _},v.prototype._digest=function(){throw new Error("_digest is not implemented")},a.exports=v},9002:a=>{function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(v)}var r={};function h(v,g,_){_||(_=Error);var E=function(b){var p,x;function y(f,w,A){return b.call(this,function(P,T,R){return typeof g=="string"?g:g(P,T,R)}(f,w,A))||this}return x=b,(p=y).prototype=Object.create(x.prototype),p.prototype.constructor=p,p.__proto__=x,y}(_);E.prototype.name=_.name,E.prototype.code=v,r[v]=E}function m(v,g){if(Array.isArray(v)){var _=v.length;return v=v.map(function(E){return String(E)}),_>2?"one of ".concat(g," ").concat(v.slice(0,_-1).join(", "),", or ")+v[_-1]:_===2?"one of ".concat(g," ").concat(v[0]," or ").concat(v[1]):"of ".concat(g," ").concat(v[0])}return"of ".concat(g," ").concat(String(v))}h("ERR_INVALID_OPT_VALUE",function(v,g){return'The value "'+g+'" is invalid for option "'+v+'"'},TypeError),h("ERR_INVALID_ARG_TYPE",function(v,g,_){var E,b,p,x,y;if(typeof g=="string"&&(b="not ",g.substr(0,4)===b)?(E="must not be",g=g.replace(/^not /,"")):E="must be",function(w,A,P){return(P===void 0||P>w.length)&&(P=w.length),w.substring(P-9,P)===A}(v," argument"))p="The ".concat(v," ").concat(E," ").concat(m(g,"type"));else{var f=(typeof y!="number"&&(y=0),y+1>(x=v).length||x.indexOf(".",y)===-1?"argument":"property");p='The "'.concat(v,'" ').concat(f," ").concat(E," ").concat(m(g,"type"))}return p+". Received type ".concat(l(_))},TypeError),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),h("ERR_METHOD_NOT_IMPLEMENTED",function(v){return"The "+v+" method is not implemented"}),h("ERR_STREAM_PREMATURE_CLOSE","Premature close"),h("ERR_STREAM_DESTROYED",function(v){return"Cannot call "+v+" after a stream was destroyed"}),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),h("ERR_STREAM_WRITE_AFTER_END","write after end"),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_UNKNOWN_ENCODING",function(v){return"Unknown encoding: "+v},TypeError),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.q=r},8248:(a,l,r)=>{var h=Object.keys||function(y){var f=[];for(var w in y)f.push(w);return f};a.exports=b;var m=r(8355),v=r(366);r(376)(b,m);for(var g=h(v.prototype),_=0;_<g.length;_++){var E=g[_];b.prototype[E]||(b.prototype[E]=v.prototype[E])}function b(y){if(!(this instanceof b))return new b(y);m.call(this,y),v.call(this,y),this.allowHalfOpen=!0,y&&(y.readable===!1&&(this.readable=!1),y.writable===!1&&(this.writable=!1),y.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",p)))}function p(){this._writableState.ended||{env:{}}.nextTick(x,this)}function x(y){y.end()}Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(b.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(b.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=y,this._writableState.destroyed=y)}})},4018:(a,l,r)=>{a.exports=m;var h=r(7254);function m(v){if(!(this instanceof m))return new m(v);h.call(this,v)}r(376)(m,h),m.prototype._transform=function(v,g,_){_(null,v)}},8355:(a,l,r)=>{var h;a.exports=Q,Q.ReadableState=re,r(9620).EventEmitter;var m,v=function(X,ee){return X.listeners(ee).length},g=r(2627),_=r(365).Buffer,E=(r.g!==void 0?r.g:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},b=r(1616);m=b&&b.debuglog?b.debuglog("stream"):function(){};var p,x,y,f=r(2050),w=r(7800),A=r(9021).getHighWaterMark,P=r(9002).q,T=P.ERR_INVALID_ARG_TYPE,R=P.ERR_STREAM_PUSH_AFTER_EOF,M=P.ERR_METHOD_NOT_IMPLEMENTED,L=P.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(376)(Q,g);var W=w.errorOrDestroy,G=["error","close","destroy","pause","resume"];function re(X,ee,Le){h=h||r(8248),X=X||{},typeof Le!="boolean"&&(Le=ee instanceof h),this.objectMode=!!X.objectMode,Le&&(this.objectMode=this.objectMode||!!X.readableObjectMode),this.highWaterMark=A(this,X,"readableHighWaterMark",Le),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=X.emitClose!==!1,this.autoDestroy=!!X.autoDestroy,this.destroyed=!1,this.defaultEncoding=X.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,X.encoding&&(p||(p=r(113).s),this.decoder=new p(X.encoding),this.encoding=X.encoding)}function Q(X){if(h=h||r(8248),!(this instanceof Q))return new Q(X);var ee=this instanceof h;this._readableState=new re(X,this,ee),this.readable=!0,X&&(typeof X.read=="function"&&(this._read=X.read),typeof X.destroy=="function"&&(this._destroy=X.destroy)),g.call(this)}function oe(X,ee,Le,Be,se){m("readableAddChunk",ee);var _e,te=X._readableState;if(ee===null)te.reading=!1,function($e,ge){if(m("onEofChunk"),!ge.ended){if(ge.decoder){var le=ge.decoder.end();le&&le.length&&(ge.buffer.push(le),ge.length+=ge.objectMode?1:le.length)}ge.ended=!0,ge.sync?pe($e):(ge.needReadable=!1,ge.emittedReadable||(ge.emittedReadable=!0,U($e)))}}(X,te);else if(se||(_e=function($e,ge){var le,ze;return ze=ge,_.isBuffer(ze)||ze instanceof E||typeof ge=="string"||ge===void 0||$e.objectMode||(le=new T("chunk",["string","Buffer","Uint8Array"],ge)),le}(te,ee)),_e)W(X,_e);else if(te.objectMode||ee&&ee.length>0)if(typeof ee=="string"||te.objectMode||Object.getPrototypeOf(ee)===_.prototype||(ee=function($e){return _.from($e)}(ee)),Be)te.endEmitted?W(X,new L):ae(X,te,ee,!0);else if(te.ended)W(X,new R);else{if(te.destroyed)return!1;te.reading=!1,te.decoder&&!Le?(ee=te.decoder.write(ee),te.objectMode||ee.length!==0?ae(X,te,ee,!1):B(X,te)):ae(X,te,ee,!1)}else Be||(te.reading=!1,B(X,te));return!te.ended&&(te.length<te.highWaterMark||te.length===0)}function ae(X,ee,Le,Be){ee.flowing&&ee.length===0&&!ee.sync?(ee.awaitDrain=0,X.emit("data",Le)):(ee.length+=ee.objectMode?1:Le.length,Be?ee.buffer.unshift(Le):ee.buffer.push(Le),ee.needReadable&&pe(X)),B(X,ee)}Object.defineProperty(Q.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(X){this._readableState&&(this._readableState.destroyed=X)}}),Q.prototype.destroy=w.destroy,Q.prototype._undestroy=w.undestroy,Q.prototype._destroy=function(X,ee){ee(X)},Q.prototype.push=function(X,ee){var Le,Be=this._readableState;return Be.objectMode?Le=!0:typeof X=="string"&&((ee=ee||Be.defaultEncoding)!==Be.encoding&&(X=_.from(X,ee),ee=""),Le=!0),oe(this,X,ee,!1,Le)},Q.prototype.unshift=function(X){return oe(this,X,null,!0,!1)},Q.prototype.isPaused=function(){return this._readableState.flowing===!1},Q.prototype.setEncoding=function(X){p||(p=r(113).s);var ee=new p(X);this._readableState.decoder=ee,this._readableState.encoding=this._readableState.decoder.encoding;for(var Le=this._readableState.buffer.head,Be="";Le!==null;)Be+=ee.write(Le.data),Le=Le.next;return this._readableState.buffer.clear(),Be!==""&&this._readableState.buffer.push(Be),this._readableState.length=Be.length,this};var de=1073741824;function be(X,ee){return X<=0||ee.length===0&&ee.ended?0:ee.objectMode?1:X!=X?ee.flowing&&ee.length?ee.buffer.head.data.length:ee.length:(X>ee.highWaterMark&&(ee.highWaterMark=function(Le){return Le>=de?Le=de:(Le--,Le|=Le>>>1,Le|=Le>>>2,Le|=Le>>>4,Le|=Le>>>8,Le|=Le>>>16,Le++),Le}(X)),X<=ee.length?X:ee.ended?ee.length:(ee.needReadable=!0,0))}function pe(X){var ee=X._readableState;m("emitReadable",ee.needReadable,ee.emittedReadable),ee.needReadable=!1,ee.emittedReadable||(m("emitReadable",ee.flowing),ee.emittedReadable=!0,{env:{}}.nextTick(U,X))}function U(X){var ee=X._readableState;m("emitReadable_",ee.destroyed,ee.length,ee.ended),ee.destroyed||!ee.length&&!ee.ended||(X.emit("readable"),ee.emittedReadable=!1),ee.needReadable=!ee.flowing&&!ee.ended&&ee.length<=ee.highWaterMark,fe(X)}function B(X,ee){ee.readingMore||(ee.readingMore=!0,{env:{}}.nextTick(N,X,ee))}function N(X,ee){for(;!ee.reading&&!ee.ended&&(ee.length<ee.highWaterMark||ee.flowing&&ee.length===0);){var Le=ee.length;if(m("maybeReadMore read 0"),X.read(0),Le===ee.length)break}ee.readingMore=!1}function z(X){var ee=X._readableState;ee.readableListening=X.listenerCount("readable")>0,ee.resumeScheduled&&!ee.paused?ee.flowing=!0:X.listenerCount("data")>0&&X.resume()}function H(X){m("readable nexttick read 0"),X.read(0)}function Y(X,ee){m("resume",ee.reading),ee.reading||X.read(0),ee.resumeScheduled=!1,X.emit("resume"),fe(X),ee.flowing&&!ee.reading&&X.read(0)}function fe(X){var ee=X._readableState;for(m("flow",ee.flowing);ee.flowing&&X.read()!==null;);}function Re(X,ee){return ee.length===0?null:(ee.objectMode?Le=ee.buffer.shift():!X||X>=ee.length?(Le=ee.decoder?ee.buffer.join(""):ee.buffer.length===1?ee.buffer.first():ee.buffer.concat(ee.length),ee.buffer.clear()):Le=ee.buffer.consume(X,ee.decoder),Le);var Le}function Oe(X){var ee=X._readableState;m("endReadable",ee.endEmitted),ee.endEmitted||(ee.ended=!0,{env:{}}.nextTick(De,ee,X))}function De(X,ee){if(m("endReadableNT",X.endEmitted,X.length),!X.endEmitted&&X.length===0&&(X.endEmitted=!0,ee.readable=!1,ee.emit("end"),X.autoDestroy)){var Le=ee._writableState;(!Le||Le.autoDestroy&&Le.finished)&&ee.destroy()}}function ot(X,ee){for(var Le=0,Be=X.length;Le<Be;Le++)if(X[Le]===ee)return Le;return-1}Q.prototype.read=function(X){m("read",X),X=parseInt(X,10);var ee=this._readableState,Le=X;if(X!==0&&(ee.emittedReadable=!1),X===0&&ee.needReadable&&((ee.highWaterMark!==0?ee.length>=ee.highWaterMark:ee.length>0)||ee.ended))return m("read: emitReadable",ee.length,ee.ended),ee.length===0&&ee.ended?Oe(this):pe(this),null;if((X=be(X,ee))===0&&ee.ended)return ee.length===0&&Oe(this),null;var Be,se=ee.needReadable;return m("need readable",se),(ee.length===0||ee.length-X<ee.highWaterMark)&&m("length less than watermark",se=!0),ee.ended||ee.reading?m("reading or ended",se=!1):se&&(m("do read"),ee.reading=!0,ee.sync=!0,ee.length===0&&(ee.needReadable=!0),this._read(ee.highWaterMark),ee.sync=!1,ee.reading||(X=be(Le,ee))),(Be=X>0?Re(X,ee):null)===null?(ee.needReadable=ee.length<=ee.highWaterMark,X=0):(ee.length-=X,ee.awaitDrain=0),ee.length===0&&(ee.ended||(ee.needReadable=!0),Le!==X&&ee.ended&&Oe(this)),Be!==null&&this.emit("data",Be),Be},Q.prototype._read=function(X){W(this,new M("_read()"))},Q.prototype.pipe=function(X,ee){var Le=this,Be=this._readableState;switch(Be.pipesCount){case 0:Be.pipes=X;break;case 1:Be.pipes=[Be.pipes,X];break;default:Be.pipes.push(X)}Be.pipesCount+=1,m("pipe count=%d opts=%j",Be.pipesCount,ee);var se=ee&&ee.end===!1||X==={env:{}}.stdout||X==={env:{}}.stderr?et:_e;function _e(){m("onend"),X.end()}Be.endEmitted?{env:{}}.nextTick(se):Le.once("end",se),X.on("unpipe",function ft(wt,It){m("onunpipe"),wt===Le&&It&&It.hasUnpiped===!1&&(It.hasUnpiped=!0,m("cleanup"),X.removeListener("close",ze),X.removeListener("finish",Je),X.removeListener("drain",te),X.removeListener("error",le),X.removeListener("unpipe",ft),Le.removeListener("end",_e),Le.removeListener("end",et),Le.removeListener("data",ge),$e=!0,!Be.awaitDrain||X._writableState&&!X._writableState.needDrain||te())});var te=function(ft){return function(){var wt=ft._readableState;m("pipeOnDrain",wt.awaitDrain),wt.awaitDrain&&wt.awaitDrain--,wt.awaitDrain===0&&v(ft,"data")&&(wt.flowing=!0,fe(ft))}}(Le);X.on("drain",te);var $e=!1;function ge(ft){m("ondata");var wt=X.write(ft);m("dest.write",wt),wt===!1&&((Be.pipesCount===1&&Be.pipes===X||Be.pipesCount>1&&ot(Be.pipes,X)!==-1)&&!$e&&(m("false write response, pause",Be.awaitDrain),Be.awaitDrain++),Le.pause())}function le(ft){m("onerror",ft),et(),X.removeListener("error",le),v(X,"error")===0&&W(X,ft)}function ze(){X.removeListener("finish",Je),et()}function Je(){m("onfinish"),X.removeListener("close",ze),et()}function et(){m("unpipe"),Le.unpipe(X)}return Le.on("data",ge),function(ft,wt,It){if(typeof ft.prependListener=="function")return ft.prependListener(wt,It);ft._events&&ft._events[wt]?Array.isArray(ft._events[wt])?ft._events[wt].unshift(It):ft._events[wt]=[It,ft._events[wt]]:ft.on(wt,It)}(X,"error",le),X.once("close",ze),X.once("finish",Je),X.emit("pipe",Le),Be.flowing||(m("pipe resume"),Le.resume()),X},Q.prototype.unpipe=function(X){var ee=this._readableState,Le={hasUnpiped:!1};if(ee.pipesCount===0)return this;if(ee.pipesCount===1)return X&&X!==ee.pipes||(X||(X=ee.pipes),ee.pipes=null,ee.pipesCount=0,ee.flowing=!1,X&&X.emit("unpipe",this,Le)),this;if(!X){var Be=ee.pipes,se=ee.pipesCount;ee.pipes=null,ee.pipesCount=0,ee.flowing=!1;for(var _e=0;_e<se;_e++)Be[_e].emit("unpipe",this,{hasUnpiped:!1});return this}var te=ot(ee.pipes,X);return te===-1||(ee.pipes.splice(te,1),ee.pipesCount-=1,ee.pipesCount===1&&(ee.pipes=ee.pipes[0]),X.emit("unpipe",this,Le)),this},Q.prototype.on=function(X,ee){var Le=g.prototype.on.call(this,X,ee),Be=this._readableState;return X==="data"?(Be.readableListening=this.listenerCount("readable")>0,Be.flowing!==!1&&this.resume()):X==="readable"&&(Be.endEmitted||Be.readableListening||(Be.readableListening=Be.needReadable=!0,Be.flowing=!1,Be.emittedReadable=!1,m("on readable",Be.length,Be.reading),Be.length?pe(this):Be.reading||{env:{}}.nextTick(H,this))),Le},Q.prototype.addListener=Q.prototype.on,Q.prototype.removeListener=function(X,ee){var Le=g.prototype.removeListener.call(this,X,ee);return X==="readable"&&{env:{}}.nextTick(z,this),Le},Q.prototype.removeAllListeners=function(X){var ee=g.prototype.removeAllListeners.apply(this,arguments);return X!=="readable"&&X!==void 0||{env:{}}.nextTick(z,this),ee},Q.prototype.resume=function(){var X=this._readableState;return X.flowing||(m("resume"),X.flowing=!X.readableListening,function(ee,Le){Le.resumeScheduled||(Le.resumeScheduled=!0,{env:{}}.nextTick(Y,ee,Le))}(this,X)),X.paused=!1,this},Q.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},Q.prototype.wrap=function(X){var ee=this,Le=this._readableState,Be=!1;for(var se in X.on("end",function(){if(m("wrapped end"),Le.decoder&&!Le.ended){var te=Le.decoder.end();te&&te.length&&ee.push(te)}ee.push(null)}),X.on("data",function(te){m("wrapped data"),Le.decoder&&(te=Le.decoder.write(te)),Le.objectMode&&te==null||(Le.objectMode||te&&te.length)&&(ee.push(te)||(Be=!0,X.pause()))}),X)this[se]===void 0&&typeof X[se]=="function"&&(this[se]=function(te){return function(){return X[te].apply(X,arguments)}}(se));for(var _e=0;_e<G.length;_e++)X.on(G[_e],this.emit.bind(this,G[_e]));return this._read=function(te){m("wrapped _read",te),Be&&(Be=!1,X.resume())},this},typeof Symbol=="function"&&(Q.prototype[Symbol.asyncIterator]=function(){return x===void 0&&(x=r(5812)),x(this)}),Object.defineProperty(Q.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Q.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Q.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(X){this._readableState&&(this._readableState.flowing=X)}}),Q._fromList=Re,Object.defineProperty(Q.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(Q.from=function(X,ee){return y===void 0&&(y=r(4273)),y(Q,X,ee)})},7254:(a,l,r)=>{a.exports=p;var h=r(9002).q,m=h.ERR_METHOD_NOT_IMPLEMENTED,v=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,_=h.ERR_TRANSFORM_WITH_LENGTH_0,E=r(8248);function b(f,w){var A=this._transformState;A.transforming=!1;var P=A.writecb;if(P===null)return this.emit("error",new v);A.writechunk=null,A.writecb=null,w!=null&&this.push(w),P(f);var T=this._readableState;T.reading=!1,(T.needReadable||T.length<T.highWaterMark)&&this._read(T.highWaterMark)}function p(f){if(!(this instanceof p))return new p(f);E.call(this,f),this._transformState={afterTransform:b.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",x)}function x(){var f=this;typeof this._flush!="function"||this._readableState.destroyed?y(this,null,null):this._flush(function(w,A){y(f,w,A)})}function y(f,w,A){if(w)return f.emit("error",w);if(A!=null&&f.push(A),f._writableState.length)throw new _;if(f._transformState.transforming)throw new g;return f.push(null)}r(376)(p,E),p.prototype.push=function(f,w){return this._transformState.needTransform=!1,E.prototype.push.call(this,f,w)},p.prototype._transform=function(f,w,A){A(new m("_transform()"))},p.prototype._write=function(f,w,A){var P=this._transformState;if(P.writecb=A,P.writechunk=f,P.writeencoding=w,!P.transforming){var T=this._readableState;(P.needTransform||T.needReadable||T.length<T.highWaterMark)&&this._read(T.highWaterMark)}},p.prototype._read=function(f){var w=this._transformState;w.writechunk===null||w.transforming?w.needTransform=!0:(w.transforming=!0,this._transform(w.writechunk,w.writeencoding,w.afterTransform))},p.prototype._destroy=function(f,w){E.prototype._destroy.call(this,f,function(A){w(A)})}},366:(a,l,r)=>{function h(B){var N=this;this.next=null,this.entry=null,this.finish=function(){(function(z,H,Y){var fe=z.entry;for(z.entry=null;fe;){var Re=fe.callback;H.pendingcb--,Re(void 0),fe=fe.next}H.corkedRequestsFree.next=z})(N,B)}}var m;a.exports=Q,Q.WritableState=re;var v,g={deprecate:r(8016)},_=r(2627),E=r(365).Buffer,b=(r.g!==void 0?r.g:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},p=r(7800),x=r(9021).getHighWaterMark,y=r(9002).q,f=y.ERR_INVALID_ARG_TYPE,w=y.ERR_METHOD_NOT_IMPLEMENTED,A=y.ERR_MULTIPLE_CALLBACK,P=y.ERR_STREAM_CANNOT_PIPE,T=y.ERR_STREAM_DESTROYED,R=y.ERR_STREAM_NULL_VALUES,M=y.ERR_STREAM_WRITE_AFTER_END,L=y.ERR_UNKNOWN_ENCODING,W=p.errorOrDestroy;function G(){}function re(B,N,z){m=m||r(8248),B=B||{},typeof z!="boolean"&&(z=N instanceof m),this.objectMode=!!B.objectMode,z&&(this.objectMode=this.objectMode||!!B.writableObjectMode),this.highWaterMark=x(this,B,"writableHighWaterMark",z),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var H=B.decodeStrings===!1;this.decodeStrings=!H,this.defaultEncoding=B.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Y){(function(fe,Re){var Oe=fe._writableState,De=Oe.sync,ot=Oe.writecb;if(typeof ot!="function")throw new A;if(function(ee){ee.writing=!1,ee.writecb=null,ee.length-=ee.writelen,ee.writelen=0}(Oe),Re)(function(ee,Le,Be,se,_e){--Le.pendingcb,Be?({env:{}}.nextTick(_e,se),{env:{}}.nextTick(U,ee,Le),ee._writableState.errorEmitted=!0,W(ee,se)):(_e(se),ee._writableState.errorEmitted=!0,W(ee,se),U(ee,Le))})(fe,Oe,De,Re,ot);else{var X=be(Oe)||fe.destroyed;X||Oe.corked||Oe.bufferProcessing||!Oe.bufferedRequest||de(fe,Oe),De?{env:{}}.nextTick(ae,fe,Oe,X,ot):ae(fe,Oe,X,ot)}})(N,Y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=B.emitClose!==!1,this.autoDestroy=!!B.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}function Q(B){var N=this instanceof(m=m||r(8248));if(!N&&!v.call(Q,this))return new Q(B);this._writableState=new re(B,this,N),this.writable=!0,B&&(typeof B.write=="function"&&(this._write=B.write),typeof B.writev=="function"&&(this._writev=B.writev),typeof B.destroy=="function"&&(this._destroy=B.destroy),typeof B.final=="function"&&(this._final=B.final)),_.call(this)}function oe(B,N,z,H,Y,fe,Re){N.writelen=H,N.writecb=Re,N.writing=!0,N.sync=!0,N.destroyed?N.onwrite(new T("write")):z?B._writev(Y,N.onwrite):B._write(Y,fe,N.onwrite),N.sync=!1}function ae(B,N,z,H){z||function(Y,fe){fe.length===0&&fe.needDrain&&(fe.needDrain=!1,Y.emit("drain"))}(B,N),N.pendingcb--,H(),U(B,N)}function de(B,N){N.bufferProcessing=!0;var z=N.bufferedRequest;if(B._writev&&z&&z.next){var H=N.bufferedRequestCount,Y=new Array(H),fe=N.corkedRequestsFree;fe.entry=z;for(var Re=0,Oe=!0;z;)Y[Re]=z,z.isBuf||(Oe=!1),z=z.next,Re+=1;Y.allBuffers=Oe,oe(B,N,!0,N.length,Y,"",fe.finish),N.pendingcb++,N.lastBufferedRequest=null,fe.next?(N.corkedRequestsFree=fe.next,fe.next=null):N.corkedRequestsFree=new h(N),N.bufferedRequestCount=0}else{for(;z;){var De=z.chunk,ot=z.encoding,X=z.callback;if(oe(B,N,!1,N.objectMode?1:De.length,De,ot,X),z=z.next,N.bufferedRequestCount--,N.writing)break}z===null&&(N.lastBufferedRequest=null)}N.bufferedRequest=z,N.bufferProcessing=!1}function be(B){return B.ending&&B.length===0&&B.bufferedRequest===null&&!B.finished&&!B.writing}function pe(B,N){B._final(function(z){N.pendingcb--,z&&W(B,z),N.prefinished=!0,B.emit("prefinish"),U(B,N)})}function U(B,N){var z=be(N);if(z&&(function(Y,fe){fe.prefinished||fe.finalCalled||(typeof Y._final!="function"||fe.destroyed?(fe.prefinished=!0,Y.emit("prefinish")):(fe.pendingcb++,fe.finalCalled=!0,{env:{}}.nextTick(pe,Y,fe)))}(B,N),N.pendingcb===0&&(N.finished=!0,B.emit("finish"),N.autoDestroy))){var H=B._readableState;(!H||H.autoDestroy&&H.endEmitted)&&B.destroy()}return z}r(376)(Q,_),re.prototype.getBuffer=function(){for(var B=this.bufferedRequest,N=[];B;)N.push(B),B=B.next;return N},function(){try{Object.defineProperty(re.prototype,"buffer",{get:g.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(Q,Symbol.hasInstance,{value:function(B){return!!v.call(this,B)||this===Q&&B&&B._writableState instanceof re}})):v=function(B){return B instanceof this},Q.prototype.pipe=function(){W(this,new P)},Q.prototype.write=function(B,N,z){var H,Y=this._writableState,fe=!1,Re=!Y.objectMode&&(H=B,E.isBuffer(H)||H instanceof b);return Re&&!E.isBuffer(B)&&(B=function(Oe){return E.from(Oe)}(B)),typeof N=="function"&&(z=N,N=null),Re?N="buffer":N||(N=Y.defaultEncoding),typeof z!="function"&&(z=G),Y.ending?function(Oe,De){var ot=new M;W(Oe,ot),{env:{}}.nextTick(De,ot)}(this,z):(Re||function(Oe,De,ot,X){var ee;return ot===null?ee=new R:typeof ot=="string"||De.objectMode||(ee=new f("chunk",["string","Buffer"],ot)),!ee||(W(Oe,ee),{env:{}}.nextTick(X,ee),!1)}(this,Y,B,z))&&(Y.pendingcb++,fe=function(Oe,De,ot,X,ee,Le){if(!ot){var Be=function($e,ge,le){return $e.objectMode||$e.decodeStrings===!1||typeof ge!="string"||(ge=E.from(ge,le)),ge}(De,X,ee);X!==Be&&(ot=!0,ee="buffer",X=Be)}var se=De.objectMode?1:X.length;De.length+=se;var _e=De.length<De.highWaterMark;if(_e||(De.needDrain=!0),De.writing||De.corked){var te=De.lastBufferedRequest;De.lastBufferedRequest={chunk:X,encoding:ee,isBuf:ot,callback:Le,next:null},te?te.next=De.lastBufferedRequest:De.bufferedRequest=De.lastBufferedRequest,De.bufferedRequestCount+=1}else oe(Oe,De,!1,se,X,ee,Le);return _e}(this,Y,Re,B,N,z)),fe},Q.prototype.cork=function(){this._writableState.corked++},Q.prototype.uncork=function(){var B=this._writableState;B.corked&&(B.corked--,B.writing||B.corked||B.bufferProcessing||!B.bufferedRequest||de(this,B))},Q.prototype.setDefaultEncoding=function(B){if(typeof B=="string"&&(B=B.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((B+"").toLowerCase())>-1))throw new L(B);return this._writableState.defaultEncoding=B,this},Object.defineProperty(Q.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Q.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Q.prototype._write=function(B,N,z){z(new w("_write()"))},Q.prototype._writev=null,Q.prototype.end=function(B,N,z){var H=this._writableState;return typeof B=="function"?(z=B,B=null,N=null):typeof N=="function"&&(z=N,N=null),B!=null&&this.write(B,N),H.corked&&(H.corked=1,this.uncork()),H.ending||function(Y,fe,Re){fe.ending=!0,U(Y,fe),Re&&(fe.finished?{env:{}}.nextTick(Re):Y.once("finish",Re)),fe.ended=!0,Y.writable=!1}(this,H,z),this},Object.defineProperty(Q.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Q.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(B){this._writableState&&(this._writableState.destroyed=B)}}),Q.prototype.destroy=p.destroy,Q.prototype._undestroy=p.undestroy,Q.prototype._destroy=function(B,N){N(B)}},5812:(a,l,r)=>{function h(M){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},h(M)}var m;function v(M,L,W){return(L=function(G){var re=function(Q,oe){if(h(Q)!=="object"||Q===null)return Q;var ae=Q[Symbol.toPrimitive];if(ae!==void 0){var de=ae.call(Q,"string");if(h(de)!=="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Q)}(G);return h(re)==="symbol"?re:String(re)}(L))in M?Object.defineProperty(M,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):M[L]=W,M}var g=r(9469),_=Symbol("lastResolve"),E=Symbol("lastReject"),b=Symbol("error"),p=Symbol("ended"),x=Symbol("lastPromise"),y=Symbol("handlePromise"),f=Symbol("stream");function w(M,L){return{value:M,done:L}}function A(M){var L=M[_];if(L!==null){var W=M[f].read();W!==null&&(M[x]=null,M[_]=null,M[E]=null,L(w(W,!1)))}}function P(M){({env:{}}).nextTick(A,M)}var T=Object.getPrototypeOf(function(){}),R=Object.setPrototypeOf((v(m={get stream(){return this[f]},next:function(){var M=this,L=this[b];if(L!==null)return Promise.reject(L);if(this[p])return Promise.resolve(w(void 0,!0));if(this[f].destroyed)return new Promise(function(Q,oe){({env:{}}).nextTick(function(){M[b]?oe(M[b]):Q(w(void 0,!0))})});var W,G=this[x];if(G)W=new Promise(function(Q,oe){return function(ae,de){Q.then(function(){oe[p]?ae(w(void 0,!0)):oe[y](ae,de)},de)}}(G,this));else{var re=this[f].read();if(re!==null)return Promise.resolve(w(re,!1));W=new Promise(this[y])}return this[x]=W,W}},Symbol.asyncIterator,function(){return this}),v(m,"return",function(){var M=this;return new Promise(function(L,W){M[f].destroy(null,function(G){G?W(G):L(w(void 0,!0))})})}),m),T);a.exports=function(M){var L,W=Object.create(R,(v(L={},f,{value:M,writable:!0}),v(L,_,{value:null,writable:!0}),v(L,E,{value:null,writable:!0}),v(L,b,{value:null,writable:!0}),v(L,p,{value:M._readableState.endEmitted,writable:!0}),v(L,y,{value:function(G,re){var Q=W[f].read();Q?(W[x]=null,W[_]=null,W[E]=null,G(w(Q,!1))):(W[_]=G,W[E]=re)},writable:!0}),L));return W[x]=null,g(M,function(G){if(G&&G.code!=="ERR_STREAM_PREMATURE_CLOSE"){var re=W[E];return re!==null&&(W[x]=null,W[_]=null,W[E]=null,re(G)),void(W[b]=G)}var Q=W[_];Q!==null&&(W[x]=null,W[_]=null,W[E]=null,Q(w(void 0,!0))),W[p]=!0}),M.on("readable",P.bind(null,W)),W}},2050:(a,l,r)=>{function h(y){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},h(y)}function m(y,f){var w=Object.keys(y);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(y);f&&(A=A.filter(function(P){return Object.getOwnPropertyDescriptor(y,P).enumerable})),w.push.apply(w,A)}return w}function v(y){for(var f=1;f<arguments.length;f++){var w=arguments[f]!=null?arguments[f]:{};f%2?m(Object(w),!0).forEach(function(A){g(y,A,w[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(w)):m(Object(w)).forEach(function(A){Object.defineProperty(y,A,Object.getOwnPropertyDescriptor(w,A))})}return y}function g(y,f,w){return(f=E(f))in y?Object.defineProperty(y,f,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[f]=w,y}function _(y,f){for(var w=0;w<f.length;w++){var A=f[w];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(y,E(A.key),A)}}function E(y){var f=function(w,A){if(h(w)!=="object"||w===null)return w;var P=w[Symbol.toPrimitive];if(P!==void 0){var T=P.call(w,"string");if(h(T)!=="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(w)}(y);return h(f)==="symbol"?f:String(f)}var b=r(365).Buffer,p=r(9386).inspect,x=p&&p.custom||"inspect";a.exports=function(){function y(){(function(A,P){if(!(A instanceof P))throw new TypeError("Cannot call a class as a function")})(this,y),this.head=null,this.tail=null,this.length=0}var f,w;return f=y,(w=[{key:"push",value:function(A){var P={data:A,next:null};this.length>0?this.tail.next=P:this.head=P,this.tail=P,++this.length}},{key:"unshift",value:function(A){var P={data:A,next:this.head};this.length===0&&(this.tail=P),this.head=P,++this.length}},{key:"shift",value:function(){if(this.length!==0){var A=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,A}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(A){if(this.length===0)return"";for(var P=this.head,T=""+P.data;P=P.next;)T+=A+P.data;return T}},{key:"concat",value:function(A){if(this.length===0)return b.alloc(0);for(var P,T,R,M=b.allocUnsafe(A>>>0),L=this.head,W=0;L;)P=L.data,T=M,R=W,b.prototype.copy.call(P,T,R),W+=L.data.length,L=L.next;return M}},{key:"consume",value:function(A,P){var T;return A<this.head.data.length?(T=this.head.data.slice(0,A),this.head.data=this.head.data.slice(A)):T=A===this.head.data.length?this.shift():P?this._getString(A):this._getBuffer(A),T}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(A){var P=this.head,T=1,R=P.data;for(A-=R.length;P=P.next;){var M=P.data,L=A>M.length?M.length:A;if(L===M.length?R+=M:R+=M.slice(0,A),(A-=L)==0){L===M.length?(++T,P.next?this.head=P.next:this.head=this.tail=null):(this.head=P,P.data=M.slice(L));break}++T}return this.length-=T,R}},{key:"_getBuffer",value:function(A){var P=b.allocUnsafe(A),T=this.head,R=1;for(T.data.copy(P),A-=T.data.length;T=T.next;){var M=T.data,L=A>M.length?M.length:A;if(M.copy(P,P.length-A,0,L),(A-=L)==0){L===M.length?(++R,T.next?this.head=T.next:this.head=this.tail=null):(this.head=T,T.data=M.slice(L));break}++R}return this.length-=R,P}},{key:x,value:function(A,P){return p(this,v(v({},P),{},{depth:0,customInspect:!1}))}}])&&_(f.prototype,w),Object.defineProperty(f,"prototype",{writable:!1}),y}()},7800:a=>{function l(m,v){h(m,v),r(m)}function r(m){m._writableState&&!m._writableState.emitClose||m._readableState&&!m._readableState.emitClose||m.emit("close")}function h(m,v){m.emit("error",v)}a.exports={destroy:function(m,v){var g=this,_=this._readableState&&this._readableState.destroyed,E=this._writableState&&this._writableState.destroyed;return _||E?(v?v(m):m&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,{env:{}}.nextTick(h,this,m)):{env:{}}.nextTick(h,this,m)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(m||null,function(b){!v&&b?g._writableState?g._writableState.errorEmitted?{env:{}}.nextTick(r,g):(g._writableState.errorEmitted=!0,{env:{}}.nextTick(l,g,b)):{env:{}}.nextTick(l,g,b):v?({env:{}}.nextTick(r,g),v(b)):{env:{}}.nextTick(r,g)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(m,v){var g=m._readableState,_=m._writableState;g&&g.autoDestroy||_&&_.autoDestroy?m.destroy(v):m.emit("error",v)}}},9469:(a,l,r)=>{var h=r(9002).q.ERR_STREAM_PREMATURE_CLOSE;function m(){}a.exports=function v(g,_,E){if(typeof _=="function")return v(g,null,_);_||(_={}),E=function(M){var L=!1;return function(){if(!L){L=!0;for(var W=arguments.length,G=new Array(W),re=0;re<W;re++)G[re]=arguments[re];M.apply(this,G)}}}(E||m);var b=_.readable||_.readable!==!1&&g.readable,p=_.writable||_.writable!==!1&&g.writable,x=function(){g.writable||f()},y=g._writableState&&g._writableState.finished,f=function(){p=!1,y=!0,b||E.call(g)},w=g._readableState&&g._readableState.endEmitted,A=function(){b=!1,w=!0,p||E.call(g)},P=function(M){E.call(g,M)},T=function(){var M;return b&&!w?(g._readableState&&g._readableState.ended||(M=new h),E.call(g,M)):p&&!y?(g._writableState&&g._writableState.ended||(M=new h),E.call(g,M)):void 0},R=function(){g.req.on("finish",f)};return function(M){return M.setHeader&&typeof M.abort=="function"}(g)?(g.on("complete",f),g.on("abort",T),g.req?R():g.on("request",R)):p&&!g._writableState&&(g.on("end",x),g.on("close",x)),g.on("end",A),g.on("finish",f),_.error!==!1&&g.on("error",P),g.on("close",T),function(){g.removeListener("complete",f),g.removeListener("abort",T),g.removeListener("request",R),g.req&&g.req.removeListener("finish",f),g.removeListener("end",x),g.removeListener("close",x),g.removeListener("finish",f),g.removeListener("end",A),g.removeListener("error",P),g.removeListener("close",T)}}},4273:a=>{a.exports=function(){throw new Error("Readable.from is not available in the browser")}},5996:(a,l,r)=>{var h,m=r(9002).q,v=m.ERR_MISSING_ARGS,g=m.ERR_STREAM_DESTROYED;function _(p){if(p)throw p}function E(p){p()}function b(p,x){return p.pipe(x)}a.exports=function(){for(var p=arguments.length,x=new Array(p),y=0;y<p;y++)x[y]=arguments[y];var f,w=function(P){return P.length?typeof P[P.length-1]!="function"?_:P.pop():_}(x);if(Array.isArray(x[0])&&(x=x[0]),x.length<2)throw new v("streams");var A=x.map(function(P,T){var R=T<x.length-1;return function(M,L,W,G){G=function(oe){var ae=!1;return function(){ae||(ae=!0,oe.apply(void 0,arguments))}}(G);var re=!1;M.on("close",function(){re=!0}),h===void 0&&(h=r(9469)),h(M,{readable:L,writable:W},function(oe){if(oe)return G(oe);re=!0,G()});var Q=!1;return function(oe){if(!re&&!Q)return Q=!0,function(ae){return ae.setHeader&&typeof ae.abort=="function"}(M)?M.abort():typeof M.destroy=="function"?M.destroy():void G(oe||new g("pipe"))}}(P,R,T>0,function(M){f||(f=M),M&&A.forEach(E),R||(A.forEach(E),w(f))})});return x.reduce(b)}},9021:(a,l,r)=>{var h=r(9002).q.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(m,v,g,_){var E=function(b,p,x){return b.highWaterMark!=null?b.highWaterMark:p?b[x]:null}(v,_,g);if(E!=null){if(!isFinite(E)||Math.floor(E)!==E||E<0)throw new h(_?g:"highWaterMark",E);return Math.floor(E)}return m.objectMode?16:16384}}},2627:(a,l,r)=>{a.exports=r(9620).EventEmitter},2531:(a,l,r)=>{(l=a.exports=r(8355)).Stream=l,l.Readable=l,l.Writable=r(366),l.Duplex=r(8248),l.Transform=r(7254),l.PassThrough=r(4018),l.finished=r(9469),l.pipeline=r(5996)},3192:(a,l,r)=>{var h=l;h.utils=r(8244),h.common=r(5386),h.sha=r(2507),h.ripemd=r(9993),h.hmac=r(8534),h.sha1=h.sha.sha1,h.sha256=h.sha.sha256,h.sha224=h.sha.sha224,h.sha384=h.sha.sha384,h.sha512=h.sha.sha512,h.ripemd160=h.ripemd.ripemd160},5386:(a,l,r)=>{var h=r(8244),m=r(1130);function v(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}l.BlockHash=v,v.prototype.update=function(g,_){if(g=h.toArray(g,_),this.pending?this.pending=this.pending.concat(g):this.pending=g,this.pendingTotal+=g.length,this.pending.length>=this._delta8){var E=(g=this.pending).length%this._delta8;this.pending=g.slice(g.length-E,g.length),this.pending.length===0&&(this.pending=null),g=h.join32(g,0,g.length-E,this.endian);for(var b=0;b<g.length;b+=this._delta32)this._update(g,b,b+this._delta32)}return this},v.prototype.digest=function(g){return this.update(this._pad()),m(this.pending===null),this._digest(g)},v.prototype._pad=function(){var g=this.pendingTotal,_=this._delta8,E=_-(g+this.padLength)%_,b=new Array(E+this.padLength);b[0]=128;for(var p=1;p<E;p++)b[p]=0;if(g<<=3,this.endian==="big"){for(var x=8;x<this.padLength;x++)b[p++]=0;b[p++]=0,b[p++]=0,b[p++]=0,b[p++]=0,b[p++]=g>>>24&255,b[p++]=g>>>16&255,b[p++]=g>>>8&255,b[p++]=255&g}else for(b[p++]=255&g,b[p++]=g>>>8&255,b[p++]=g>>>16&255,b[p++]=g>>>24&255,b[p++]=0,b[p++]=0,b[p++]=0,b[p++]=0,x=8;x<this.padLength;x++)b[p++]=0;return b}},8534:(a,l,r)=>{var h=r(8244),m=r(1130);function v(g,_,E){if(!(this instanceof v))return new v(g,_,E);this.Hash=g,this.blockSize=g.blockSize/8,this.outSize=g.outSize/8,this.inner=null,this.outer=null,this._init(h.toArray(_,E))}a.exports=v,v.prototype._init=function(g){g.length>this.blockSize&&(g=new this.Hash().update(g).digest()),m(g.length<=this.blockSize);for(var _=g.length;_<this.blockSize;_++)g.push(0);for(_=0;_<g.length;_++)g[_]^=54;for(this.inner=new this.Hash().update(g),_=0;_<g.length;_++)g[_]^=106;this.outer=new this.Hash().update(g)},v.prototype.update=function(g,_){return this.inner.update(g,_),this},v.prototype.digest=function(g){return this.outer.update(this.inner.digest()),this.outer.digest(g)}},9993:(a,l,r)=>{var h=r(8244),m=r(5386),v=h.rotl32,g=h.sum32,_=h.sum32_3,E=h.sum32_4,b=m.BlockHash;function p(){if(!(this instanceof p))return new p;b.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function x(R,M,L,W){return R<=15?M^L^W:R<=31?M&L|~M&W:R<=47?(M|~L)^W:R<=63?M&W|L&~W:M^(L|~W)}function y(R){return R<=15?0:R<=31?1518500249:R<=47?1859775393:R<=63?2400959708:2840853838}function f(R){return R<=15?1352829926:R<=31?1548603684:R<=47?1836072691:R<=63?2053994217:0}h.inherits(p,b),l.ripemd160=p,p.blockSize=512,p.outSize=160,p.hmacStrength=192,p.padLength=64,p.prototype._update=function(R,M){for(var L=this.h[0],W=this.h[1],G=this.h[2],re=this.h[3],Q=this.h[4],oe=L,ae=W,de=G,be=re,pe=Q,U=0;U<80;U++){var B=g(v(E(L,x(U,W,G,re),R[w[U]+M],y(U)),P[U]),Q);L=Q,Q=re,re=v(G,10),G=W,W=B,B=g(v(E(oe,x(79-U,ae,de,be),R[A[U]+M],f(U)),T[U]),pe),oe=pe,pe=be,be=v(de,10),de=ae,ae=B}B=_(this.h[1],G,be),this.h[1]=_(this.h[2],re,pe),this.h[2]=_(this.h[3],Q,oe),this.h[3]=_(this.h[4],L,ae),this.h[4]=_(this.h[0],W,de),this.h[0]=B},p.prototype._digest=function(R){return R==="hex"?h.toHex32(this.h,"little"):h.split32(this.h,"little")};var w=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],A=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],P=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],T=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},2507:(a,l,r)=>{l.sha1=r(9382),l.sha224=r(5123),l.sha256=r(4032),l.sha384=r(1364),l.sha512=r(2161)},9382:(a,l,r)=>{var h=r(8244),m=r(5386),v=r(7673),g=h.rotl32,_=h.sum32,E=h.sum32_5,b=v.ft_1,p=m.BlockHash,x=[1518500249,1859775393,2400959708,3395469782];function y(){if(!(this instanceof y))return new y;p.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}h.inherits(y,p),a.exports=y,y.blockSize=512,y.outSize=160,y.hmacStrength=80,y.padLength=64,y.prototype._update=function(f,w){for(var A=this.W,P=0;P<16;P++)A[P]=f[w+P];for(;P<A.length;P++)A[P]=g(A[P-3]^A[P-8]^A[P-14]^A[P-16],1);var T=this.h[0],R=this.h[1],M=this.h[2],L=this.h[3],W=this.h[4];for(P=0;P<A.length;P++){var G=~~(P/20),re=E(g(T,5),b(G,R,M,L),W,A[P],x[G]);W=L,L=M,M=g(R,30),R=T,T=re}this.h[0]=_(this.h[0],T),this.h[1]=_(this.h[1],R),this.h[2]=_(this.h[2],M),this.h[3]=_(this.h[3],L),this.h[4]=_(this.h[4],W)},y.prototype._digest=function(f){return f==="hex"?h.toHex32(this.h,"big"):h.split32(this.h,"big")}},5123:(a,l,r)=>{var h=r(8244),m=r(4032);function v(){if(!(this instanceof v))return new v;m.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}h.inherits(v,m),a.exports=v,v.blockSize=512,v.outSize=224,v.hmacStrength=192,v.padLength=64,v.prototype._digest=function(g){return g==="hex"?h.toHex32(this.h.slice(0,7),"big"):h.split32(this.h.slice(0,7),"big")}},4032:(a,l,r)=>{var h=r(8244),m=r(5386),v=r(7673),g=r(1130),_=h.sum32,E=h.sum32_4,b=h.sum32_5,p=v.ch32,x=v.maj32,y=v.s0_256,f=v.s1_256,w=v.g0_256,A=v.g1_256,P=m.BlockHash,T=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function R(){if(!(this instanceof R))return new R;P.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=T,this.W=new Array(64)}h.inherits(R,P),a.exports=R,R.blockSize=512,R.outSize=256,R.hmacStrength=192,R.padLength=64,R.prototype._update=function(M,L){for(var W=this.W,G=0;G<16;G++)W[G]=M[L+G];for(;G<W.length;G++)W[G]=E(A(W[G-2]),W[G-7],w(W[G-15]),W[G-16]);var re=this.h[0],Q=this.h[1],oe=this.h[2],ae=this.h[3],de=this.h[4],be=this.h[5],pe=this.h[6],U=this.h[7];for(g(this.k.length===W.length),G=0;G<W.length;G++){var B=b(U,f(de),p(de,be,pe),this.k[G],W[G]),N=_(y(re),x(re,Q,oe));U=pe,pe=be,be=de,de=_(ae,B),ae=oe,oe=Q,Q=re,re=_(B,N)}this.h[0]=_(this.h[0],re),this.h[1]=_(this.h[1],Q),this.h[2]=_(this.h[2],oe),this.h[3]=_(this.h[3],ae),this.h[4]=_(this.h[4],de),this.h[5]=_(this.h[5],be),this.h[6]=_(this.h[6],pe),this.h[7]=_(this.h[7],U)},R.prototype._digest=function(M){return M==="hex"?h.toHex32(this.h,"big"):h.split32(this.h,"big")}},1364:(a,l,r)=>{var h=r(8244),m=r(2161);function v(){if(!(this instanceof v))return new v;m.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}h.inherits(v,m),a.exports=v,v.blockSize=1024,v.outSize=384,v.hmacStrength=192,v.padLength=128,v.prototype._digest=function(g){return g==="hex"?h.toHex32(this.h.slice(0,12),"big"):h.split32(this.h.slice(0,12),"big")}},2161:(a,l,r)=>{var h=r(8244),m=r(5386),v=r(1130),g=h.rotr64_hi,_=h.rotr64_lo,E=h.shr64_hi,b=h.shr64_lo,p=h.sum64,x=h.sum64_hi,y=h.sum64_lo,f=h.sum64_4_hi,w=h.sum64_4_lo,A=h.sum64_5_hi,P=h.sum64_5_lo,T=m.BlockHash,R=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function M(){if(!(this instanceof M))return new M;T.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=R,this.W=new Array(160)}function L(U,B,N,z,H){var Y=U&N^~U&H;return Y<0&&(Y+=4294967296),Y}function W(U,B,N,z,H,Y){var fe=B&z^~B&Y;return fe<0&&(fe+=4294967296),fe}function G(U,B,N,z,H){var Y=U&N^U&H^N&H;return Y<0&&(Y+=4294967296),Y}function re(U,B,N,z,H,Y){var fe=B&z^B&Y^z&Y;return fe<0&&(fe+=4294967296),fe}function Q(U,B){var N=g(U,B,28)^g(B,U,2)^g(B,U,7);return N<0&&(N+=4294967296),N}function oe(U,B){var N=_(U,B,28)^_(B,U,2)^_(B,U,7);return N<0&&(N+=4294967296),N}function ae(U,B){var N=_(U,B,14)^_(U,B,18)^_(B,U,9);return N<0&&(N+=4294967296),N}function de(U,B){var N=g(U,B,1)^g(U,B,8)^E(U,B,7);return N<0&&(N+=4294967296),N}function be(U,B){var N=_(U,B,1)^_(U,B,8)^b(U,B,7);return N<0&&(N+=4294967296),N}function pe(U,B){var N=_(U,B,19)^_(B,U,29)^b(U,B,6);return N<0&&(N+=4294967296),N}h.inherits(M,T),a.exports=M,M.blockSize=1024,M.outSize=512,M.hmacStrength=192,M.padLength=128,M.prototype._prepareBlock=function(U,B){for(var N=this.W,z=0;z<32;z++)N[z]=U[B+z];for(;z<N.length;z+=2){var H=(ee=N[z-4],Le=N[z-3],Be=void 0,(Be=g(ee,Le,19)^g(Le,ee,29)^E(ee,Le,6))<0&&(Be+=4294967296),Be),Y=pe(N[z-4],N[z-3]),fe=N[z-14],Re=N[z-13],Oe=de(N[z-30],N[z-29]),De=be(N[z-30],N[z-29]),ot=N[z-32],X=N[z-31];N[z]=f(H,Y,fe,Re,Oe,De,ot,X),N[z+1]=w(H,Y,fe,Re,Oe,De,ot,X)}var ee,Le,Be},M.prototype._update=function(U,B){this._prepareBlock(U,B);var N,z,H,Y=this.W,fe=this.h[0],Re=this.h[1],Oe=this.h[2],De=this.h[3],ot=this.h[4],X=this.h[5],ee=this.h[6],Le=this.h[7],Be=this.h[8],se=this.h[9],_e=this.h[10],te=this.h[11],$e=this.h[12],ge=this.h[13],le=this.h[14],ze=this.h[15];v(this.k.length===Y.length);for(var Je=0;Je<Y.length;Je+=2){var et=le,ft=ze,wt=(H=void 0,(H=g(N=Be,z=se,14)^g(N,z,18)^g(z,N,9))<0&&(H+=4294967296),H),It=ae(Be,se),Ct=L(Be,0,_e,0,$e),tn=W(0,se,0,te,0,ge),xt=this.k[Je],Ht=this.k[Je+1],en=Y[Je],kn=Y[Je+1],Dn=A(et,ft,wt,It,Ct,tn,xt,Ht,en,kn),Ft=P(et,ft,wt,It,Ct,tn,xt,Ht,en,kn);et=Q(fe,Re),ft=oe(fe,Re),wt=G(fe,0,Oe,0,ot),It=re(0,Re,0,De,0,X);var Tt=x(et,ft,wt,It),rn=y(et,ft,wt,It);le=$e,ze=ge,$e=_e,ge=te,_e=Be,te=se,Be=x(ee,Le,Dn,Ft),se=y(Le,Le,Dn,Ft),ee=ot,Le=X,ot=Oe,X=De,Oe=fe,De=Re,fe=x(Dn,Ft,Tt,rn),Re=y(Dn,Ft,Tt,rn)}p(this.h,0,fe,Re),p(this.h,2,Oe,De),p(this.h,4,ot,X),p(this.h,6,ee,Le),p(this.h,8,Be,se),p(this.h,10,_e,te),p(this.h,12,$e,ge),p(this.h,14,le,ze)},M.prototype._digest=function(U){return U==="hex"?h.toHex32(this.h,"big"):h.split32(this.h,"big")}},7673:(a,l,r)=>{var h=r(8244).rotr32;function m(_,E,b){return _&E^~_&b}function v(_,E,b){return _&E^_&b^E&b}function g(_,E,b){return _^E^b}l.ft_1=function(_,E,b,p){return _===0?m(E,b,p):_===1||_===3?g(E,b,p):_===2?v(E,b,p):void 0},l.ch32=m,l.maj32=v,l.p32=g,l.s0_256=function(_){return h(_,2)^h(_,13)^h(_,22)},l.s1_256=function(_){return h(_,6)^h(_,11)^h(_,25)},l.g0_256=function(_){return h(_,7)^h(_,18)^_>>>3},l.g1_256=function(_){return h(_,17)^h(_,19)^_>>>10}},8244:(a,l,r)=>{var h=r(1130),m=r(376);function v(b,p){return(64512&b.charCodeAt(p))==55296&&!(p<0||p+1>=b.length)&&(64512&b.charCodeAt(p+1))==56320}function g(b){return(b>>>24|b>>>8&65280|b<<8&16711680|(255&b)<<24)>>>0}function _(b){return b.length===1?"0"+b:b}function E(b){return b.length===7?"0"+b:b.length===6?"00"+b:b.length===5?"000"+b:b.length===4?"0000"+b:b.length===3?"00000"+b:b.length===2?"000000"+b:b.length===1?"0000000"+b:b}l.inherits=m,l.toArray=function(b,p){if(Array.isArray(b))return b.slice();if(!b)return[];var x=[];if(typeof b=="string")if(p){if(p==="hex")for((b=b.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(b="0"+b),f=0;f<b.length;f+=2)x.push(parseInt(b[f]+b[f+1],16))}else for(var y=0,f=0;f<b.length;f++){var w=b.charCodeAt(f);w<128?x[y++]=w:w<2048?(x[y++]=w>>6|192,x[y++]=63&w|128):v(b,f)?(w=65536+((1023&w)<<10)+(1023&b.charCodeAt(++f)),x[y++]=w>>18|240,x[y++]=w>>12&63|128,x[y++]=w>>6&63|128,x[y++]=63&w|128):(x[y++]=w>>12|224,x[y++]=w>>6&63|128,x[y++]=63&w|128)}else for(f=0;f<b.length;f++)x[f]=0|b[f];return x},l.toHex=function(b){for(var p="",x=0;x<b.length;x++)p+=_(b[x].toString(16));return p},l.htonl=g,l.toHex32=function(b,p){for(var x="",y=0;y<b.length;y++){var f=b[y];p==="little"&&(f=g(f)),x+=E(f.toString(16))}return x},l.zero2=_,l.zero8=E,l.join32=function(b,p,x,y){var f=x-p;h(f%4==0);for(var w=new Array(f/4),A=0,P=p;A<w.length;A++,P+=4){var T;T=y==="big"?b[P]<<24|b[P+1]<<16|b[P+2]<<8|b[P+3]:b[P+3]<<24|b[P+2]<<16|b[P+1]<<8|b[P],w[A]=T>>>0}return w},l.split32=function(b,p){for(var x=new Array(4*b.length),y=0,f=0;y<b.length;y++,f+=4){var w=b[y];p==="big"?(x[f]=w>>>24,x[f+1]=w>>>16&255,x[f+2]=w>>>8&255,x[f+3]=255&w):(x[f+3]=w>>>24,x[f+2]=w>>>16&255,x[f+1]=w>>>8&255,x[f]=255&w)}return x},l.rotr32=function(b,p){return b>>>p|b<<32-p},l.rotl32=function(b,p){return b<<p|b>>>32-p},l.sum32=function(b,p){return b+p>>>0},l.sum32_3=function(b,p,x){return b+p+x>>>0},l.sum32_4=function(b,p,x,y){return b+p+x+y>>>0},l.sum32_5=function(b,p,x,y,f){return b+p+x+y+f>>>0},l.sum64=function(b,p,x,y){var f=b[p],w=y+b[p+1]>>>0,A=(w<y?1:0)+x+f;b[p]=A>>>0,b[p+1]=w},l.sum64_hi=function(b,p,x,y){return(p+y>>>0<p?1:0)+b+x>>>0},l.sum64_lo=function(b,p,x,y){return p+y>>>0},l.sum64_4_hi=function(b,p,x,y,f,w,A,P){var T=0,R=p;return T+=(R=R+y>>>0)<p?1:0,T+=(R=R+w>>>0)<w?1:0,b+x+f+A+(T+=(R=R+P>>>0)<P?1:0)>>>0},l.sum64_4_lo=function(b,p,x,y,f,w,A,P){return p+y+w+P>>>0},l.sum64_5_hi=function(b,p,x,y,f,w,A,P,T,R){var M=0,L=p;return M+=(L=L+y>>>0)<p?1:0,M+=(L=L+w>>>0)<w?1:0,M+=(L=L+P>>>0)<P?1:0,b+x+f+A+T+(M+=(L=L+R>>>0)<R?1:0)>>>0},l.sum64_5_lo=function(b,p,x,y,f,w,A,P,T,R){return p+y+w+P+R>>>0},l.rotr64_hi=function(b,p,x){return(p<<32-x|b>>>x)>>>0},l.rotr64_lo=function(b,p,x){return(b<<32-x|p>>>x)>>>0},l.shr64_hi=function(b,p,x){return b>>>x},l.shr64_lo=function(b,p,x){return(b<<32-x|p>>>x)>>>0}},8939:(a,l,r)=>{var h=Function.prototype.call,m=Object.prototype.hasOwnProperty,v=r(5246);a.exports=v.call(h,m)},9742:(a,l,r)=>{var h=r(3192),m=r(5522),v=r(1130);function g(_){if(!(this instanceof g))return new g(_);this.hash=_.hash,this.predResist=!!_.predResist,this.outLen=this.hash.outSize,this.minEntropy=_.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var E=m.toArray(_.entropy,_.entropyEnc||"hex"),b=m.toArray(_.nonce,_.nonceEnc||"hex"),p=m.toArray(_.pers,_.persEnc||"hex");v(E.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(E,b,p)}a.exports=g,g.prototype._init=function(_,E,b){var p=_.concat(E).concat(b);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var x=0;x<this.V.length;x++)this.K[x]=0,this.V[x]=1;this._update(p),this._reseed=1,this.reseedInterval=281474976710656},g.prototype._hmac=function(){return new h.hmac(this.hash,this.K)},g.prototype._update=function(_){var E=this._hmac().update(this.V).update([0]);_&&(E=E.update(_)),this.K=E.digest(),this.V=this._hmac().update(this.V).digest(),_&&(this.K=this._hmac().update(this.V).update([1]).update(_).digest(),this.V=this._hmac().update(this.V).digest())},g.prototype.reseed=function(_,E,b,p){typeof E!="string"&&(p=b,b=E,E=null),_=m.toArray(_,E),b=m.toArray(b,p),v(_.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(_.concat(b||[])),this._reseed=1},g.prototype.generate=function(_,E,b,p){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof E!="string"&&(p=b,b=E,E=null),b&&(b=m.toArray(b,p||"hex"),this._update(b));for(var x=[];x.length<_;)this.V=this._hmac().update(this.V).digest(),x=x.concat(this.V);var y=x.slice(0,_);return this._update(b),this._reseed++,m.encode(y,E)}},8405:(a,l)=>{l.read=function(r,h,m,v,g){var _,E,b=8*g-v-1,p=(1<<b)-1,x=p>>1,y=-7,f=m?g-1:0,w=m?-1:1,A=r[h+f];for(f+=w,_=A&(1<<-y)-1,A>>=-y,y+=b;y>0;_=256*_+r[h+f],f+=w,y-=8);for(E=_&(1<<-y)-1,_>>=-y,y+=v;y>0;E=256*E+r[h+f],f+=w,y-=8);if(_===0)_=1-x;else{if(_===p)return E?NaN:1/0*(A?-1:1);E+=Math.pow(2,v),_-=x}return(A?-1:1)*E*Math.pow(2,_-v)},l.write=function(r,h,m,v,g,_){var E,b,p,x=8*_-g-1,y=(1<<x)-1,f=y>>1,w=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=v?0:_-1,P=v?1:-1,T=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(b=isNaN(h)?1:0,E=y):(E=Math.floor(Math.log(h)/Math.LN2),h*(p=Math.pow(2,-E))<1&&(E--,p*=2),(h+=E+f>=1?w/p:w*Math.pow(2,1-f))*p>=2&&(E++,p/=2),E+f>=y?(b=0,E=y):E+f>=1?(b=(h*p-1)*Math.pow(2,g),E+=f):(b=h*Math.pow(2,f-1)*Math.pow(2,g),E=0));g>=8;r[m+A]=255&b,A+=P,b/=256,g-=8);for(E=E<<g|b,x+=g;x>0;r[m+A]=255&E,A+=P,E/=256,x-=8);r[m+A-P]|=128*T}},376:a=>{typeof Object.create=="function"?a.exports=function(l,r){r&&(l.super_=r,l.prototype=Object.create(r.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}))}:a.exports=function(l,r){if(r){l.super_=r;var h=function(){};h.prototype=r.prototype,l.prototype=new h,l.prototype.constructor=l}}},2755:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}var m=r(5994)(),v=r(8780)("Object.prototype.toString"),g=function(b){return!(m&&b&&h(b)==="object"&&Symbol.toStringTag in b)&&v(b)==="[object Arguments]"},_=function(b){return!!g(b)||b!==null&&h(b)==="object"&&typeof b.length=="number"&&b.length>=0&&v(b)!=="[object Array]"&&v(b.callee)==="[object Function]"},E=function(){return g(arguments)}();g.isLegacyArguments=_,a.exports=E?g:_},8625:a=>{function l(w){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},l(w)}var r,h,m=Function.prototype.toString,v=(typeof Reflect>"u"?"undefined":l(Reflect))==="object"&&Reflect!==null&&Reflect.apply;if(typeof v=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw h}}),h={},v(function(){throw 42},null,r)}catch(w){w!==h&&(v=null)}else v=null;var g=/^\s*class\b/,_=function(w){try{var A=m.call(w);return g.test(A)}catch{return!1}},E=function(w){try{return!_(w)&&(m.call(w),!0)}catch{return!1}},b=Object.prototype.toString,p=typeof Symbol=="function"&&!!Symbol.toStringTag,x=!(0 in[,]),y=function(){return!1};if((typeof document>"u"?"undefined":l(document))==="object"){var f=document.all;b.call(f)===b.call(document.all)&&(y=function(w){if((x||!w)&&(w===void 0||l(w)==="object"))try{var A=b.call(w);return(A==="[object HTMLAllCollection]"||A==="[object HTML document.all class]"||A==="[object HTMLCollection]"||A==="[object Object]")&&w("")==null}catch{}return!1})}a.exports=v?function(w){if(y(w))return!0;if(!w||typeof w!="function"&&l(w)!=="object")return!1;try{v(w,null,r)}catch(A){if(A!==h)return!1}return!_(w)&&E(w)}:function(w){if(y(w))return!0;if(!w||typeof w!="function"&&l(w)!=="object")return!1;if(p)return E(w);if(_(w))return!1;var A=b.call(w);return!(A!=="[object Function]"&&A!=="[object GeneratorFunction]"&&!/^\[object HTML/.test(A))&&E(w)}},6738:(a,l,r)=>{var h,m=Object.prototype.toString,v=Function.prototype.toString,g=/^\s*(?:function)?\*/,_=r(5994)(),E=Object.getPrototypeOf;a.exports=function(b){if(typeof b!="function")return!1;if(g.test(v.call(b)))return!0;if(!_)return m.call(b)==="[object GeneratorFunction]";if(!E)return!1;if(h===void 0){var p=function(){if(!_)return!1;try{return Function("return function*() {}")()}catch{}}();h=!!p&&E(p)}return E(b)===h}},2703:a=>{a.exports=function(l){return l!=l}},2191:(a,l,r)=>{var h=r(3862),m=r(7921),v=r(2703),g=r(4828),_=r(2568),E=h(g(),Number);m(E,{getPolyfill:g,implementation:v,shim:_}),a.exports=E},4828:(a,l,r)=>{var h=r(2703);a.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:h}},2568:(a,l,r)=>{var h=r(7921),m=r(4828);a.exports=function(){var v=m();return h(Number,{isNaN:v},{isNaN:function(){return Number.isNaN!==v}}),v}},7913:(a,l,r)=>{var h=r(1482);a.exports=function(m){return!!h(m)}},3138:a=>{function l(A,P){var T=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!T){if(Array.isArray(A)||(T=h(A))||P&&A&&typeof A.length=="number"){T&&(A=T);var R=0,M=function(){};return{s:M,n:function(){return R>=A.length?{done:!0}:{done:!1,value:A[R++]}},e:function(re){throw re},f:M}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L,W=!0,G=!1;return{s:function(){T=T.call(A)},n:function(){var re=T.next();return W=re.done,re},e:function(re){G=!0,L=re},f:function(){try{W||T.return==null||T.return()}finally{if(G)throw L}}}}function r(A){return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},r(A)}function h(A,P){if(A){if(typeof A=="string")return m(A,P);var T=Object.prototype.toString.call(A).slice(8,-1);return T==="Object"&&A.constructor&&(T=A.constructor.name),T==="Map"||T==="Set"?Array.from(A):T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T)?m(A,P):void 0}}function m(A,P){(P==null||P>A.length)&&(P=A.length);for(var T=0,R=new Array(P);T<P;T++)R[T]=A[T];return R}function v(A,P,T){if(g())return Reflect.construct.apply(null,arguments);var R=[null];R.push.apply(R,P);var M=new(A.bind.apply(A,R));return T&&_(M,T.prototype),M}function g(){try{var A=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(g=function(){return!!A})()}function _(A,P){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(T,R){return T.__proto__=R,T},_(A,P)}function E(){this._pres=new Map,this._posts=new Map}function b(A,P,T,R,M,L,W){return L.useErrorHandlers?A.execPost(T,R,M,{error:P},function(G){return typeof W=="function"&&W(G)}):typeof W=="function"&&W(P)}function p(A,P,T,R){var M;try{M=A.apply(P,T)}catch(L){return R(L)}x(M)&&M.then(function(){return R()},function(L){return R(L)})}function x(A){return r(A)==="object"&&A!==null&&typeof A.then=="function"}function y(A){var P=!1,T=this;return function(){var R=arguments;if(!P)return P=!0,f(function(){return A.apply(T,R)})}}E.skipWrappedFunction=function(){if(!(this instanceof E.skipWrappedFunction))return v(E.skipWrappedFunction,Array.prototype.slice.call(arguments));this.args=Array.prototype.slice.call(arguments)},E.overwriteResult=function(){if(!(this instanceof E.overwriteResult))return v(E.overwriteResult,Array.prototype.slice.call(arguments));this.args=Array.prototype.slice.call(arguments)},E.prototype.execPre=function(A,P,T,R){arguments.length===3&&(R=T,T=[]);var M=this._pres.get(A)||[],L=M.length,W=M.numAsync||0,G=0,re=W,Q=!1,oe=T,ae=null;if(!L)return f(function(){R(null)});function de(){if(!(G>=L)){var pe=M[G];if(pe.isAsync){var U=[y(be),y(function(Y){if(Y){if(Q)return;if(!(Y instanceof E.skipWrappedFunction))return Q=!0,R(Y);ae=Y}if(--re==0&&G>=L)return R(ae)})];p(pe.fn,P,U,U[0])}else if(pe.fn.length>0){for(var B=[y(be)],N=arguments.length>=2?arguments:[null].concat(oe),z=1;z<N.length;++z)z===N.length-1&&typeof N[z]=="function"||B.push(N[z]);p(pe.fn,P,B,B[0])}else{var H=null;try{H=pe.fn.call(P)}catch(Y){if(Y!=null)return R(Y)}if(x(H))H.then(function(){return be()},function(Y){return be(Y)});else{if(++G>=L)return re>0?void 0:f(function(){R(ae)});de()}}}}function be(pe){if(pe){if(Q)return;if(!(pe instanceof E.skipWrappedFunction))return Q=!0,R(pe);ae=pe}if(++G>=L)return re>0?void 0:R(ae);de.apply(P,arguments)}de.apply(null,[null].concat(T))},E.prototype.execPreSync=function(A,P,T){for(var R=this._pres.get(A)||[],M=R.length,L=0;L<M;++L)R[L].fn.apply(P,T||[])},E.prototype.execPost=function(A,P,T,R,M){arguments.length<5&&(M=R,R=null);var L=this._posts.get(A)||[],W=L.length,G=0,re=null;if(R&&R.error&&(re=R.error),!W)return f(function(){M.apply(null,[re].concat(T))});(function Q(){for(var oe=L[G].fn,ae=0,de=T.length,be=[],pe=0;pe<de;++pe)ae+=T[pe]&&T[pe]._kareemIgnore?0:1,T[pe]&&T[pe]._kareemIgnore||be.push(T[pe]);if(re)if(w(L[G],ae)){var U=y(function(H){if(H){if(H instanceof E.overwriteResult)return T=H.args,++G>=W?M.call(null,re):Q();re=H}if(++G>=W)return M.call(null,re);Q()});p(oe,P,[re].concat(be).concat([U]),U)}else{if(++G>=W)return M.call(null,re);Q()}else{var B=y(function(H){return H?H instanceof E.overwriteResult?(T=H.args,++G>=W?M.apply(null,[null].concat(T)):Q()):(re=H,Q()):++G>=W?M.apply(null,[null].concat(T)):void Q()});if(w(L[G],ae))return++G>=W?M.apply(null,[null].concat(T)):Q();if(oe.length===ae+1)p(oe,P,be.concat([B]),B);else{var N,z;try{z=oe.apply(P,be)}catch(H){N=H,re=H}if(x(z))return z.then(function(H){B(H instanceof E.overwriteResult?H:null)},function(H){return B(H)});if(z instanceof E.overwriteResult&&(T=z.args),++G>=W)return M.apply(null,[N].concat(T));Q()}}})()},E.prototype.execPostSync=function(A,P,T){for(var R=this._posts.get(A)||[],M=R.length,L=0;L<M;++L){var W=R[L].fn.apply(P,T||[]);W instanceof E.overwriteResult&&(T=W.args)}return T},E.prototype.createWrapperSync=function(A,P){var T=this;return function(){T.execPreSync(A,this,arguments);var R=P.apply(this,arguments);return T.execPostSync(A,this,[R])[0]}},E.prototype.wrap=function(A,P,T,R,M){var L=R.length>0?R[R.length-1]:null,W=Array.from(R);typeof L=="function"&&W.pop();var G=this,re=(M=M||{}).checkForPromise;this.execPre(A,T,R,function(Q){if(Q&&!(Q instanceof E.skipWrappedFunction)){for(var oe=M.numCallbackParams||0,ae=M.contextParameter?[T]:[],de=ae.length;de<oe;++de)ae.push(null);return b(G,Q,A,T,ae,M,L)}var be,pe,U=P.length;if(Q instanceof E.skipWrappedFunction)return be=Q.args[0],B.apply(void 0,[null].concat(function(N){if(Array.isArray(N))return m(N)}(pe=Q.args)||function(N){if(typeof Symbol<"u"&&N[Symbol.iterator]!=null||N["@@iterator"]!=null)return Array.from(N)}(pe)||h(pe)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()));try{be=P.apply(T,W.concat(B))}catch(N){return B(N)}if(re){if(x(be))return be.then(function(N){return B(null,N)},function(N){return B(N)});if(U<W.length+1)return B(null,be)}function B(){var N=Array.from(arguments);if(N.shift(),M.nullResultByDefault&&N.length===0&&N.push(null),arguments[0])return b(G,arguments[0],A,T,N,M,L);G.execPost(A,T,N,function(){L!==null&&(arguments[0]?L(arguments[0]):L.apply(T,arguments))})}})},E.prototype.filter=function(A){for(var P=this,T=this.clone(),R=Array.from(T._pres.keys()),M=function(){var ae=W[L],de=P._pres.get(ae).map(function(be){return Object.assign({},be,{name:ae})}).filter(A);if(de.length===0)return T._pres.delete(ae),1;de.numAsync=de.filter(function(be){return be.isAsync}).length,T._pres.set(ae,de)},L=0,W=R;L<W.length;L++)M();for(var G=Array.from(T._posts.keys()),re=function(){var ae=oe[Q],de=P._posts.get(ae).map(function(be){return Object.assign({},be,{name:ae})}).filter(A);if(de.length===0)return T._posts.delete(ae),1;T._posts.set(ae,de)},Q=0,oe=G;Q<oe.length;Q++)re();return T},E.prototype.hasHooks=function(A){return this._pres.has(A)||this._posts.has(A)},E.prototype.createWrapper=function(A,P,T,R){var M=this;return this.hasHooks(A)?function(){var L=T||this;M.wrap(A,P,L,Array.from(arguments),R)}:function(){var L=arguments,W=this;f(function(){return P.apply(W,L)})}},E.prototype.pre=function(A,P,T,R,M){var L={};r(P)==="object"&&P!==null?P=(L=P).isAsync:typeof arguments[1]!="boolean"&&(T=P,P=!1);var W=this._pres.get(A)||[];if(this._pres.set(A,W),P&&(W.numAsync=W.numAsync||0,++W.numAsync),typeof T!="function")throw new Error('pre() requires a function, got "'+r(T)+'"');return M?W.unshift(Object.assign({},L,{fn:T,isAsync:P})):W.push(Object.assign({},L,{fn:T,isAsync:P})),this},E.prototype.post=function(A,P,T,R){var M=this._posts.get(A)||[];if(typeof P=="function"&&(R=!!T,T=P,P={}),typeof T!="function")throw new Error('post() requires a function, got "'+r(T)+'"');return R?M.unshift(Object.assign({},P,{fn:T})):M.push(Object.assign({},P,{fn:T})),this._posts.set(A,M),this},E.prototype.clone=function(){var A,P=new E,T=l(this._pres.keys());try{for(T.s();!(A=T.n()).done;){var R=A.value,M=this._pres.get(R).slice();M.numAsync=this._pres.get(R).numAsync,P._pres.set(R,M)}}catch(re){T.e(re)}finally{T.f()}var L,W=l(this._posts.keys());try{for(W.s();!(L=W.n()).done;){var G=L.value;P._posts.set(G,this._posts.get(G).slice())}}catch(re){W.e(re)}finally{W.f()}return P},E.prototype.merge=function(A,P){var T,R=(P=arguments.length===1||P)?this.clone():this,M=l(A._pres.keys());try{var L=function(){var Q=T.value,oe=R._pres.get(Q)||[],ae=A._pres.get(Q).filter(function(be){return oe.map(function(pe){return pe.fn}).indexOf(be.fn)===-1}),de=oe.concat(ae);de.numAsync=oe.numAsync||0,de.numAsync+=ae.filter(function(be){return be.isAsync}).length,R._pres.set(Q,de)};for(M.s();!(T=M.n()).done;)L()}catch(Q){M.e(Q)}finally{M.f()}var W,G=l(A._posts.keys());try{var re=function(){var Q=W.value,oe=R._posts.get(Q)||[],ae=A._posts.get(Q).filter(function(de){return oe.indexOf(de)===-1});R._posts.set(Q,oe.concat(ae))};for(G.s();!(W=G.n()).done;)re()}catch(Q){G.e(Q)}finally{G.f()}return R};var f=({env:{}}===void 0?"undefined":r({env:{}}))==="object"&&{env:{}}!==null&&{env:{}}.nextTick||function(A){setTimeout(A,0)};function w(A,P){return!!A.errorHandler||A.fn.length===P+2}a.exports=E},722:(a,l,r)=>{var h=r(376),m=r(5125),v=r(9047).Buffer,g=new Array(16);function _(){m.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function E(f,w){return f<<w|f>>>32-w}function b(f,w,A,P,T,R,M){return E(f+(w&A|~w&P)+T+R|0,M)+w|0}function p(f,w,A,P,T,R,M){return E(f+(w&P|A&~P)+T+R|0,M)+w|0}function x(f,w,A,P,T,R,M){return E(f+(w^A^P)+T+R|0,M)+w|0}function y(f,w,A,P,T,R,M){return E(f+(A^(w|~P))+T+R|0,M)+w|0}h(_,m),_.prototype._update=function(){for(var f=g,w=0;w<16;++w)f[w]=this._block.readInt32LE(4*w);var A=this._a,P=this._b,T=this._c,R=this._d;A=b(A,P,T,R,f[0],3614090360,7),R=b(R,A,P,T,f[1],3905402710,12),T=b(T,R,A,P,f[2],606105819,17),P=b(P,T,R,A,f[3],3250441966,22),A=b(A,P,T,R,f[4],4118548399,7),R=b(R,A,P,T,f[5],1200080426,12),T=b(T,R,A,P,f[6],2821735955,17),P=b(P,T,R,A,f[7],4249261313,22),A=b(A,P,T,R,f[8],1770035416,7),R=b(R,A,P,T,f[9],2336552879,12),T=b(T,R,A,P,f[10],4294925233,17),P=b(P,T,R,A,f[11],2304563134,22),A=b(A,P,T,R,f[12],1804603682,7),R=b(R,A,P,T,f[13],4254626195,12),T=b(T,R,A,P,f[14],2792965006,17),A=p(A,P=b(P,T,R,A,f[15],1236535329,22),T,R,f[1],4129170786,5),R=p(R,A,P,T,f[6],3225465664,9),T=p(T,R,A,P,f[11],643717713,14),P=p(P,T,R,A,f[0],3921069994,20),A=p(A,P,T,R,f[5],3593408605,5),R=p(R,A,P,T,f[10],38016083,9),T=p(T,R,A,P,f[15],3634488961,14),P=p(P,T,R,A,f[4],3889429448,20),A=p(A,P,T,R,f[9],568446438,5),R=p(R,A,P,T,f[14],3275163606,9),T=p(T,R,A,P,f[3],4107603335,14),P=p(P,T,R,A,f[8],1163531501,20),A=p(A,P,T,R,f[13],2850285829,5),R=p(R,A,P,T,f[2],4243563512,9),T=p(T,R,A,P,f[7],1735328473,14),A=x(A,P=p(P,T,R,A,f[12],2368359562,20),T,R,f[5],4294588738,4),R=x(R,A,P,T,f[8],2272392833,11),T=x(T,R,A,P,f[11],1839030562,16),P=x(P,T,R,A,f[14],4259657740,23),A=x(A,P,T,R,f[1],2763975236,4),R=x(R,A,P,T,f[4],1272893353,11),T=x(T,R,A,P,f[7],4139469664,16),P=x(P,T,R,A,f[10],3200236656,23),A=x(A,P,T,R,f[13],681279174,4),R=x(R,A,P,T,f[0],3936430074,11),T=x(T,R,A,P,f[3],3572445317,16),P=x(P,T,R,A,f[6],76029189,23),A=x(A,P,T,R,f[9],3654602809,4),R=x(R,A,P,T,f[12],3873151461,11),T=x(T,R,A,P,f[15],530742520,16),A=y(A,P=x(P,T,R,A,f[2],3299628645,23),T,R,f[0],4096336452,6),R=y(R,A,P,T,f[7],1126891415,10),T=y(T,R,A,P,f[14],2878612391,15),P=y(P,T,R,A,f[5],4237533241,21),A=y(A,P,T,R,f[12],1700485571,6),R=y(R,A,P,T,f[3],2399980690,10),T=y(T,R,A,P,f[10],4293915773,15),P=y(P,T,R,A,f[1],2240044497,21),A=y(A,P,T,R,f[8],1873313359,6),R=y(R,A,P,T,f[15],4264355552,10),T=y(T,R,A,P,f[6],2734768916,15),P=y(P,T,R,A,f[13],1309151649,21),A=y(A,P,T,R,f[4],4149444226,6),R=y(R,A,P,T,f[11],3174756917,10),T=y(T,R,A,P,f[2],718787259,15),P=y(P,T,R,A,f[9],3951481745,21),this._a=this._a+A|0,this._b=this._b+P|0,this._c=this._c+T|0,this._d=this._d+R|0},_.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var f=v.allocUnsafe(16);return f.writeInt32LE(this._a,0),f.writeInt32LE(this._b,4),f.writeInt32LE(this._c,8),f.writeInt32LE(this._d,12),f},a.exports=_},9318:(a,l,r)=>{var h=r(815),m=r(7179);function v(g){this.rand=g||new m.Rand}a.exports=v,v.create=function(g){return new v(g)},v.prototype._randbelow=function(g){var _=g.bitLength(),E=Math.ceil(_/8);do var b=new h(this.rand.generate(E));while(b.cmp(g)>=0);return b},v.prototype._randrange=function(g,_){var E=_.sub(g);return g.add(this._randbelow(E))},v.prototype.test=function(g,_,E){var b=g.bitLength(),p=h.mont(g),x=new h(1).toRed(p);_||(_=Math.max(1,b/48|0));for(var y=g.subn(1),f=0;!y.testn(f);f++);for(var w=g.shrn(f),A=y.toRed(p);_>0;_--){var P=this._randrange(new h(2),y);E&&E(P);var T=P.toRed(p).redPow(w);if(T.cmp(x)!==0&&T.cmp(A)!==0){for(var R=1;R<f;R++){if((T=T.redSqr()).cmp(x)===0)return!1;if(T.cmp(A)===0)break}if(R===f)return!1}}return!0},v.prototype.getDivisor=function(g,_){var E=g.bitLength(),b=h.mont(g),p=new h(1).toRed(b);_||(_=Math.max(1,E/48|0));for(var x=g.subn(1),y=0;!x.testn(y);y++);for(var f=g.shrn(y),w=x.toRed(b);_>0;_--){var A=this._randrange(new h(2),x),P=g.gcd(A);if(P.cmpn(1)!==0)return P;var T=A.toRed(b).redPow(f);if(T.cmp(p)!==0&&T.cmp(w)!==0){for(var R=1;R<y;R++){if((T=T.redSqr()).cmp(p)===0)return T.fromRed().subn(1).gcd(g);if(T.cmp(w)===0)break}if(R===y)return(T=T.redSqr()).fromRed().subn(1).gcd(g)}}return!1}},1130:a=>{function l(r,h){if(!r)throw new Error(h||"Assertion failed")}a.exports=l,l.equal=function(r,h,m){if(r!=h)throw new Error(m||"Assertion failed: "+r+" != "+h)}},5522:(a,l)=>{var r=l;function h(v){return v.length===1?"0"+v:v}function m(v){for(var g="",_=0;_<v.length;_++)g+=h(v[_].toString(16));return g}r.toArray=function(v,g){if(Array.isArray(v))return v.slice();if(!v)return[];var _=[];if(typeof v!="string"){for(var E=0;E<v.length;E++)_[E]=0|v[E];return _}if(g==="hex")for((v=v.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(v="0"+v),E=0;E<v.length;E+=2)_.push(parseInt(v[E]+v[E+1],16));else for(E=0;E<v.length;E++){var b=v.charCodeAt(E),p=b>>8,x=255&b;p?_.push(p,x):_.push(x)}return _},r.zero2=h,r.toHex=m,r.encode=function(v,g){return g==="hex"?m(v):v}},3564:(a,l,r)=>{a.exports=r(8424)},8424:(a,l,r)=>{function h(E){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},h(E)}var m=r(7355),v=["__proto__","constructor","prototype"];function g(E,b,p,x,y,f){for(var w,A=0;A<E.length&&A<b.length;++A)w=E[A],Array.isArray(w)&&Array.isArray(b[A])?g(w,b[A],p,x,y,f):w&&(x?x(w,p,f(b[A])):(w[y]&&(w=w[y]),w[p]=f(b[A])))}function _(E){return E}l.get=function(E,b,p,x){var y;typeof p=="function"&&(p.length<2?(x=p,p=void 0):(y=p,p=void 0)),x||(x=_);var f=typeof E=="string"?m(E):E;if(!Array.isArray(f))throw new TypeError("Invalid `path`. Must be either string or array");for(var w,A=b,P=0;P<f.length;++P){if(w=f[P],typeof f[P]!="string"&&typeof f[P]!="number")throw new TypeError("Each segment of path to `get()` must be a string or number, got "+h(f[P]));if(Array.isArray(A)&&!/^\d+$/.test(w)){var T=f.slice(P);return[].concat(A).map(function(M){return M?l.get(T,M,p||y,x):x(void 0)})}if(y)A=y(A,w);else{var R=p&&A[p]?A[p]:A;A=R instanceof Map?R.get(w):R[w]}if(!A)return x(A)}return x(A)},l.has=function(E,b){var p=typeof E=="string"?m(E):E;if(!Array.isArray(p))throw new TypeError("Invalid `path`. Must be either string or array");for(var x=p.length,y=b,f=0;f<x;++f){if(typeof p[f]!="string"&&typeof p[f]!="number")throw new TypeError("Each segment of path to `has()` must be a string or number, got "+h(p[f]));if(y==null||h(y)!=="object"||!(p[f]in y))return!1;y=y[p[f]]}return!0},l.unset=function(E,b){var p=typeof E=="string"?m(E):E;if(!Array.isArray(p))throw new TypeError("Invalid `path`. Must be either string or array");for(var x=p.length,y=b,f=0;f<x;++f){if(y==null||h(y)!=="object"||!(p[f]in y))return!1;if(typeof p[f]!="string"&&typeof p[f]!="number")throw new TypeError("Each segment of path to `unset()` must be a string or number, got "+h(p[f]));if(v.indexOf(p[f])!==-1)return!1;if(f===x-1)return delete y[p[f]],!0;y=y instanceof Map?y.get(p[f]):y[p[f]]}return!0},l.set=function(E,b,p,x,y,f){var w;typeof x=="function"&&(x.length<2?(y=x,x=void 0):(w=x,x=void 0)),y||(y=_);var A=typeof E=="string"?m(E):E;if(!Array.isArray(A))throw new TypeError("Invalid `path`. Must be either string or array");if(p!=null){for(var P=0;P<A.length;++P){if(typeof A[P]!="string"&&typeof A[P]!="number")throw new TypeError("Each segment of path to `set()` must be a string or number, got "+h(A[P]));if(v.indexOf(A[P])!==-1)return}for(var T,R=f||/\$/.test(E)&&f!==!1,M=p,L=(P=0,A.length-1);P<L;++P)if((T=A[P])!="$"){if(Array.isArray(M)&&!/^\d+$/.test(T)){var W=A.slice(P);if(!R&&Array.isArray(b))for(var G=0;G<M.length&&G<b.length;++G)l.set(W,b[G],M[G],x||w,y,R);else for(G=0;G<M.length;++G)l.set(W,b,M[G],x||w,y,R);return}if(w)M=w(M,T);else{var re=x&&M[x]?M[x]:M;M=re instanceof Map?re.get(T):re[T]}if(!M)return}else if(P==L-1)break;if(T=A[L],x&&M[x]&&(M=M[x]),Array.isArray(M)&&!/^\d+$/.test(T))if(!R&&Array.isArray(b))g(M,b,T,w,x,y);else for(G=0;G<M.length;++G){var Q=M[G];Q&&(w?w(Q,T,y(b)):(Q[x]&&(Q=Q[x]),Q[T]=y(b)))}else w?w(M,T,y(b)):M instanceof Map?M.set(T,y(b)):M[T]=y(b)}},l.stringToParts=m},7355:a=>{a.exports=function(l){for(var r=[],h="",m="DEFAULT",v=0;v<l.length;++v)m!=="IN_SQUARE_BRACKETS"||/\d/.test(l[v])||l[v]==="]"||(m="DEFAULT",h=r[r.length-1]+"["+h,r.splice(r.length-1,1)),l[v]==="["?(m!=="IMMEDIATELY_AFTER_SQUARE_BRACKETS"&&(r.push(h),h=""),m="IN_SQUARE_BRACKETS"):l[v]==="]"?m==="IN_SQUARE_BRACKETS"?(m="IMMEDIATELY_AFTER_SQUARE_BRACKETS",r.push(h),h=""):(m="DEFAULT",h+=l[v]):l[v]==="."?(m!=="IMMEDIATELY_AFTER_SQUARE_BRACKETS"&&(r.push(h),h=""),m="DEFAULT"):h+=l[v];return m!=="IMMEDIATELY_AFTER_SQUARE_BRACKETS"&&r.push(h),r}},2068:a=>{function l(_){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},l(_)}var r=1e3,h=60*r,m=60*h,v=24*m;function g(_,E,b,p){var x=E>=1.5*b;return Math.round(_/b)+" "+p+(x?"s":"")}a.exports=function(_,E){E=E||{};var b,p,x=l(_);if(x==="string"&&_.length>0)return function(y){if(!((y=String(y)).length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(f){var w=parseFloat(f[1]);switch((f[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*w;case"weeks":case"week":case"w":return 6048e5*w;case"days":case"day":case"d":return w*v;case"hours":case"hour":case"hrs":case"hr":case"h":return w*m;case"minutes":case"minute":case"mins":case"min":case"m":return w*h;case"seconds":case"second":case"secs":case"sec":case"s":return w*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return w;default:return}}}}(_);if(x==="number"&&isFinite(_))return E.long?(b=_,(p=Math.abs(b))>=v?g(b,p,v,"day"):p>=m?g(b,p,m,"hour"):p>=h?g(b,p,h,"minute"):p>=r?g(b,p,r,"second"):b+" ms"):function(y){var f=Math.abs(y);return f>=v?Math.round(y/v)+"d":f>=m?Math.round(y/m)+"h":f>=h?Math.round(y/h)+"m":f>=r?Math.round(y/r)+"s":y+"ms"}(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))}},692:a=>{var l=function(r){return r!=r};a.exports=function(r,h){return r===0&&h===0?1/r==1/h:r===h||!(!l(r)||!l(h))}},4710:(a,l,r)=>{var h=r(7921),m=r(3862),v=r(692),g=r(9292),_=r(9228),E=m(g(),Object);h(E,{getPolyfill:g,implementation:v,shim:_}),a.exports=E},9292:(a,l,r)=>{var h=r(692);a.exports=function(){return typeof Object.is=="function"?Object.is:h}},9228:(a,l,r)=>{var h=r(9292),m=r(7921);a.exports=function(){var v=h();return m(Object,{is:v},{is:function(){return Object.is!==v}}),v}},6164:(a,l,r)=>{function h(A){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},h(A)}var m;if(!Object.keys){var v=Object.prototype.hasOwnProperty,g=Object.prototype.toString,_=r(5184),E=Object.prototype.propertyIsEnumerable,b=!E.call({toString:null},"toString"),p=E.call(function(){},"prototype"),x=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],y=function(A){var P=A.constructor;return P&&P.prototype===A},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},w=function(){if(typeof window>"u")return!1;for(var A in window)try{if(!f["$"+A]&&v.call(window,A)&&window[A]!==null&&h(window[A])==="object")try{y(window[A])}catch{return!0}}catch{return!0}return!1}();m=function(A){var P=A!==null&&h(A)==="object",T=g.call(A)==="[object Function]",R=_(A),M=P&&g.call(A)==="[object String]",L=[];if(!P&&!T&&!R)throw new TypeError("Object.keys called on a non-object");var W=p&&T;if(M&&A.length>0&&!v.call(A,0))for(var G=0;G<A.length;++G)L.push(String(G));if(R&&A.length>0)for(var re=0;re<A.length;++re)L.push(String(re));else for(var Q in A)W&&Q==="prototype"||!v.call(A,Q)||L.push(String(Q));if(b)for(var oe=function(de){if(typeof window>"u"||!w)return y(de);try{return y(de)}catch{return!1}}(A),ae=0;ae<x.length;++ae)oe&&x[ae]==="constructor"||!v.call(A,x[ae])||L.push(x[ae]);return L}}a.exports=m},3818:(a,l,r)=>{var h=Array.prototype.slice,m=r(5184),v=Object.keys,g=v?function(E){return v(E)}:r(6164),_=Object.keys;g.shim=function(){if(Object.keys){var E=function(){var b=Object.keys(arguments);return b&&b.length===arguments.length}(1,2);E||(Object.keys=function(b){return m(b)?_(h.call(b)):_(b)})}else Object.keys=g;return Object.keys||g},a.exports=g},5184:a=>{function l(h){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},l(h)}var r=Object.prototype.toString;a.exports=function(h){var m=r.call(h),v=m==="[object Arguments]";return v||(v=m!=="[object Array]"&&h!==null&&l(h)==="object"&&typeof h.length=="number"&&h.length>=0&&r.call(h.callee)==="[object Function]"),v}},7061:(a,l,r)=>{var h=r(7406);l.certificate=r(458);var m=h.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});l.RSAPrivateKey=m;var v=h.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});l.RSAPublicKey=v;var g=h.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(_),this.key("subjectPublicKey").bitstr())});l.PublicKey=g;var _=h.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),E=h.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(_),this.key("subjectPrivateKey").octstr())});l.PrivateKey=E;var b=h.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});l.EncryptedPrivateKey=b;var p=h.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});l.DSAPrivateKey=p,l.DSAparam=h.define("DSAparam",function(){this.int()});var x=h.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(y),this.key("publicKey").optional().explicit(1).bitstr())});l.ECPrivateKey=x;var y=h.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});l.signature=h.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},458:(a,l,r)=>{var h=r(7406),m=h.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),v=h.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),g=h.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),_=h.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(g),this.key("subjectPublicKey").bitstr())}),E=h.define("RelativeDistinguishedName",function(){this.setof(v)}),b=h.define("RDNSequence",function(){this.seqof(E)}),p=h.define("Name",function(){this.choice({rdnSequence:this.use(b)})}),x=h.define("Validity",function(){this.seq().obj(this.key("notBefore").use(m),this.key("notAfter").use(m))}),y=h.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),f=h.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(g),this.key("issuer").use(p),this.key("validity").use(x),this.key("subject").use(p),this.key("subjectPublicKeyInfo").use(_),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(y).optional())}),w=h.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(f),this.key("signatureAlgorithm").use(g),this.key("signatureValue").bitstr())});a.exports=w},1120:(a,l,r)=>{var h=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,m=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,v=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,g=r(1248),_=r(4881),E=r(9047).Buffer;a.exports=function(b,p){var x,y=b.toString(),f=y.match(h);if(f){var w="aes"+f[1],A=E.from(f[2],"hex"),P=E.from(f[3].replace(/[\r\n]/g,""),"base64"),T=g(p,A.slice(0,8),parseInt(f[1],10)).key,R=[],M=_.createDecipheriv(w,T,A);R.push(M.update(P)),R.push(M.final()),x=E.concat(R)}else{var L=y.match(v);x=E.from(L[2].replace(/[\r\n]/g,""),"base64")}return{tag:y.match(m)[1],data:x}}},2914:(a,l,r)=>{function h(x){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},h(x)}var m=r(7061),v=r(2562),g=r(1120),_=r(4881),E=r(9379),b=r(9047).Buffer;function p(x){var y;h(x)!=="object"||b.isBuffer(x)||(y=x.passphrase,x=x.key),typeof x=="string"&&(x=b.from(x));var f,w,A=g(x,y),P=A.tag,T=A.data;switch(P){case"CERTIFICATE":w=m.certificate.decode(T,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(w||(w=m.PublicKey.decode(T,"der")),f=w.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return m.RSAPublicKey.decode(w.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return w.subjectPrivateKey=w.subjectPublicKey,{type:"ec",data:w};case"1.2.840.10040.4.1":return w.algorithm.params.pub_key=m.DSAparam.decode(w.subjectPublicKey.data,"der"),{type:"dsa",data:w.algorithm.params};default:throw new Error("unknown key id "+f)}case"ENCRYPTED PRIVATE KEY":T=function(R,M){var L=R.algorithm.decrypt.kde.kdeparams.salt,W=parseInt(R.algorithm.decrypt.kde.kdeparams.iters.toString(),10),G=v[R.algorithm.decrypt.cipher.algo.join(".")],re=R.algorithm.decrypt.cipher.iv,Q=R.subjectPrivateKey,oe=parseInt(G.split("-")[1],10)/8,ae=E.pbkdf2Sync(M,L,W,oe,"sha1"),de=_.createDecipheriv(G,ae,re),be=[];return be.push(de.update(Q)),be.push(de.final()),b.concat(be)}(T=m.EncryptedPrivateKey.decode(T,"der"),y);case"PRIVATE KEY":switch(f=(w=m.PrivateKey.decode(T,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return m.RSAPrivateKey.decode(w.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:w.algorithm.curve,privateKey:m.ECPrivateKey.decode(w.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return w.algorithm.params.priv_key=m.DSAparam.decode(w.subjectPrivateKey,"der"),{type:"dsa",params:w.algorithm.params};default:throw new Error("unknown key id "+f)}case"RSA PUBLIC KEY":return m.RSAPublicKey.decode(T,"der");case"RSA PRIVATE KEY":return m.RSAPrivateKey.decode(T,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:m.DSAPrivateKey.decode(T,"der")};case"EC PRIVATE KEY":return{curve:(T=m.ECPrivateKey.decode(T,"der")).parameters.value,privateKey:T.privateKey};default:throw new Error("unknown key type "+P)}}a.exports=p,p.signature=m.signature},9379:(a,l,r)=>{l.pbkdf2=r(8099),l.pbkdf2Sync=r(3180)},8099:(a,l,r)=>{var h,m,v=r(9047).Buffer,g=r(2042),_=r(8994),E=r(3180),b=r(7238),p=r.g.crypto&&r.g.crypto.subtle,x={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},y=[];function f(){return m||(m=r.g.process&&r.g.process.nextTick?r.g.process.nextTick:r.g.queueMicrotask?r.g.queueMicrotask:r.g.setImmediate?r.g.setImmediate:r.g.setTimeout)}function w(A,P,T,R,M){return p.importKey("raw",A,{name:"PBKDF2"},!1,["deriveBits"]).then(function(L){return p.deriveBits({name:"PBKDF2",salt:P,iterations:T,hash:{name:M}},L,R<<3)}).then(function(L){return v.from(L)})}a.exports=function(A,P,T,R,M,L){typeof M=="function"&&(L=M,M=void 0);var W=x[(M=M||"sha1").toLowerCase()];if(W&&typeof r.g.Promise=="function"){if(g(T,R),A=b(A,_,"Password"),P=b(P,_,"Salt"),typeof L!="function")throw new Error("No callback provided to pbkdf2");(function(G,re){G.then(function(Q){f()(function(){re(null,Q)})},function(Q){f()(function(){re(Q)})})})(function(G){if(r.g.process&&!r.g.process.browser||!p||!p.importKey||!p.deriveBits)return Promise.resolve(!1);if(y[G]!==void 0)return y[G];var re=w(h=h||v.alloc(8),h,10,128,G).then(function(){return!0}).catch(function(){return!1});return y[G]=re,re}(W).then(function(G){return G?w(A,P,T,R,W):E(A,P,T,R,M)}),L)}else f()(function(){var G;try{G=E(A,P,T,R,M)}catch(re){return L(re)}L(null,G)})}},8994:(a,l,r)=>{var h;h=r.g.process&&r.g.process.browser?"utf-8":r.g.process&&r.g.process.version?parseInt({env:{}}.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":"utf-8",a.exports=h},2042:a=>{var l=Math.pow(2,30)-1;a.exports=function(r,h){if(typeof r!="number")throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if(typeof h!="number")throw new TypeError("Key length not a number");if(h<0||h>l||h!=h)throw new TypeError("Bad key length")}},3180:(a,l,r)=>{var h=r(3277),m=r(8100),v=r(1806),g=r(9047).Buffer,_=r(2042),E=r(8994),b=r(7238),p=g.alloc(128),x={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function y(f,w,A){var P=function(G){return G==="rmd160"||G==="ripemd160"?function(re){return new m().update(re).digest()}:G==="md5"?h:function(re){return v(G).update(re).digest()}}(f),T=f==="sha512"||f==="sha384"?128:64;w.length>T?w=P(w):w.length<T&&(w=g.concat([w,p],T));for(var R=g.allocUnsafe(T+x[f]),M=g.allocUnsafe(T+x[f]),L=0;L<T;L++)R[L]=54^w[L],M[L]=92^w[L];var W=g.allocUnsafe(T+A+4);R.copy(W,0,0,T),this.ipad1=W,this.ipad2=R,this.opad=M,this.alg=f,this.blocksize=T,this.hash=P,this.size=x[f]}y.prototype.run=function(f,w){return f.copy(w,this.blocksize),this.hash(w).copy(this.opad,this.blocksize),this.hash(this.opad)},a.exports=function(f,w,A,P,T){_(A,P);var R=new y(T=T||"sha1",f=b(f,E,"Password"),(w=b(w,E,"Salt")).length),M=g.allocUnsafe(P),L=g.allocUnsafe(w.length+4);w.copy(L,0,0,w.length);for(var W=0,G=x[T],re=Math.ceil(P/G),Q=1;Q<=re;Q++){L.writeUInt32BE(Q,w.length);for(var oe=R.run(L,R.ipad1),ae=oe,de=1;de<A;de++){ae=R.run(ae,R.ipad2);for(var be=0;be<G;be++)oe[be]^=ae[be]}oe.copy(M,W),W+=G}return M}},7238:(a,l,r)=>{var h=r(9047).Buffer;a.exports=function(m,v,g){if(h.isBuffer(m))return m;if(typeof m=="string")return h.from(m,v);if(ArrayBuffer.isView(m))return h.from(m.buffer);throw new TypeError(g+" must be a string, a Buffer, a typed array or a DataView")}},2368:(a,l,r)=>{l.publicEncrypt=r(2385),l.privateDecrypt=r(8752),l.privateEncrypt=function(h,m){return l.publicEncrypt(h,m,!0)},l.publicDecrypt=function(h,m){return l.privateDecrypt(h,m,!0)}},4075:(a,l,r)=>{var h=r(8339),m=r(9047).Buffer;function v(g){var _=m.allocUnsafe(4);return _.writeUInt32BE(g,0),_}a.exports=function(g,_){for(var E,b=m.alloc(0),p=0;b.length<_;)E=v(p++),b=m.concat([b,h("sha1").update(g).update(E).digest()]);return b.slice(0,_)}},8752:(a,l,r)=>{var h=r(2914),m=r(4075),v=r(782),g=r(815),_=r(4364),E=r(8339),b=r(1675),p=r(9047).Buffer;a.exports=function(x,y,f){var w;w=x.padding?x.padding:f?1:4;var A,P=h(x),T=P.modulus.byteLength();if(y.length>T||new g(y).cmp(P.modulus)>=0)throw new Error("decryption error");A=f?b(new g(y),P):_(y,P);var R=p.alloc(T-A.length);if(A=p.concat([R,A],T),w===4)return function(M,L){var W=M.modulus.byteLength(),G=E("sha1").update(p.alloc(0)).digest(),re=G.length;if(L[0]!==0)throw new Error("decryption error");var Q=L.slice(1,re+1),oe=L.slice(re+1),ae=v(Q,m(oe,re)),de=v(oe,m(ae,W-re-1));if(function(pe,U){pe=p.from(pe),U=p.from(U);var B=0,N=pe.length;pe.length!==U.length&&(B++,N=Math.min(pe.length,U.length));for(var z=-1;++z<N;)B+=pe[z]^U[z];return B}(G,de.slice(0,re)))throw new Error("decryption error");for(var be=re;de[be]===0;)be++;if(de[be++]!==1)throw new Error("decryption error");return de.slice(be)}(P,A);if(w===1)return function(M,L,W){for(var G=L.slice(0,2),re=2,Q=0;L[re++]!==0;)if(re>=L.length){Q++;break}var oe=L.slice(2,re-1);if((G.toString("hex")!=="0002"&&!W||G.toString("hex")!=="0001"&&W)&&Q++,oe.length<8&&Q++,Q)throw new Error("decryption error");return L.slice(re)}(0,A,f);if(w===3)return A;throw new Error("unknown padding")}},2385:(a,l,r)=>{var h=r(2914),m=r(5760),v=r(8339),g=r(4075),_=r(782),E=r(815),b=r(1675),p=r(4364),x=r(9047).Buffer;a.exports=function(y,f,w){var A;A=y.padding?y.padding:w?1:4;var P,T=h(y);if(A===4)P=function(R,M){var L=R.modulus.byteLength(),W=M.length,G=v("sha1").update(x.alloc(0)).digest(),re=G.length,Q=2*re;if(W>L-Q-2)throw new Error("message too long");var oe=x.alloc(L-W-Q-2),ae=L-re-1,de=m(re),be=_(x.concat([G,oe,x.alloc(1,1),M],ae),g(de,ae)),pe=_(de,g(be,re));return new E(x.concat([x.alloc(1),pe,be],L))}(T,f);else if(A===1)P=function(R,M,L){var W,G=M.length,re=R.modulus.byteLength();if(G>re-11)throw new Error("message too long");return W=L?x.alloc(re-G-3,255):function(Q){for(var oe,ae=x.allocUnsafe(Q),de=0,be=m(2*Q),pe=0;de<Q;)pe===be.length&&(be=m(2*Q),pe=0),(oe=be[pe++])&&(ae[de++]=oe);return ae}(re-G-3),new E(x.concat([x.from([0,L?1:2]),W,x.alloc(1),M],re))}(T,f,w);else{if(A!==3)throw new Error("unknown padding");if((P=new E(f)).cmp(T.modulus)>=0)throw new Error("data too long for modulus")}return w?p(P,T):b(P,T)}},1675:(a,l,r)=>{var h=r(815),m=r(9047).Buffer;a.exports=function(v,g){return m.from(v.toRed(h.mont(g.modulus)).redPow(new h(g.publicExponent)).fromRed().toArray())}},782:a=>{a.exports=function(l,r){for(var h=l.length,m=-1;++m<h;)l[m]^=r[m];return l}},5760:(a,l,r)=>{var h=65536,m=r(9047).Buffer,v=r.g.crypto||r.g.msCrypto;v&&v.getRandomValues?a.exports=function(g,_){if(g>4294967295)throw new RangeError("requested too many random bytes");var E=m.allocUnsafe(g);if(g>0)if(g>h)for(var b=0;b<g;b+=h)v.getRandomValues(E.slice(b,b+h));else v.getRandomValues(E);return typeof _=="function"?{env:{}}.nextTick(function(){_(null,E)}):E}:a.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}},9301:(a,l,r)=>{function h(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var m=r(9047),v=r(5760),g=m.Buffer,_=m.kMaxLength,E=r.g.crypto||r.g.msCrypto,b=Math.pow(2,32)-1;function p(f,w){if(typeof f!="number"||f!=f)throw new TypeError("offset must be a number");if(f>b||f<0)throw new TypeError("offset must be a uint32");if(f>_||f>w)throw new RangeError("offset out of range")}function x(f,w,A){if(typeof f!="number"||f!=f)throw new TypeError("size must be a number");if(f>b||f<0)throw new TypeError("size must be a uint32");if(f+w>A||f>_)throw new RangeError("buffer too small")}function y(f,w,A,P){if({env:{}}.browser){var T=f.buffer,R=new Uint8Array(T,w,A);return E.getRandomValues(R),P?void{env:{}}.nextTick(function(){P(null,f)}):f}if(!P)return v(A).copy(f,w),f;v(A,function(M,L){if(M)return P(M);L.copy(f,w),P(null,f)})}E&&E.getRandomValues||!{env:{}}.browser?(l.randomFill=function(f,w,A,P){if(!(g.isBuffer(f)||f instanceof r.g.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof w=="function")P=w,w=0,A=f.length;else if(typeof A=="function")P=A,A=f.length-w;else if(typeof P!="function")throw new TypeError('"cb" argument must be a function');return p(w,f.length),x(A,w,f.length),y(f,w,A,P)},l.randomFillSync=function(f,w,A){if(w===void 0&&(w=0),!(g.isBuffer(f)||f instanceof r.g.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return p(w,f.length),A===void 0&&(A=f.length-w),x(A,w,f.length),y(f,w,A)}):(l.randomFill=h,l.randomFillSync=h)},8100:(a,l,r)=>{var h=r(365).Buffer,m=r(376),v=r(5125),g=new Array(16),_=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],E=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],p=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],x=[0,1518500249,1859775393,2400959708,2840853838],y=[1352829926,1548603684,1836072691,2053994217,0];function f(){v.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function w(L,W){return L<<W|L>>>32-W}function A(L,W,G,re,Q,oe,ae,de){return w(L+(W^G^re)+oe+ae|0,de)+Q|0}function P(L,W,G,re,Q,oe,ae,de){return w(L+(W&G|~W&re)+oe+ae|0,de)+Q|0}function T(L,W,G,re,Q,oe,ae,de){return w(L+((W|~G)^re)+oe+ae|0,de)+Q|0}function R(L,W,G,re,Q,oe,ae,de){return w(L+(W&re|G&~re)+oe+ae|0,de)+Q|0}function M(L,W,G,re,Q,oe,ae,de){return w(L+(W^(G|~re))+oe+ae|0,de)+Q|0}m(f,v),f.prototype._update=function(){for(var L=g,W=0;W<16;++W)L[W]=this._block.readInt32LE(4*W);for(var G=0|this._a,re=0|this._b,Q=0|this._c,oe=0|this._d,ae=0|this._e,de=0|this._a,be=0|this._b,pe=0|this._c,U=0|this._d,B=0|this._e,N=0;N<80;N+=1){var z,H;N<16?(z=A(G,re,Q,oe,ae,L[_[N]],x[0],b[N]),H=M(de,be,pe,U,B,L[E[N]],y[0],p[N])):N<32?(z=P(G,re,Q,oe,ae,L[_[N]],x[1],b[N]),H=R(de,be,pe,U,B,L[E[N]],y[1],p[N])):N<48?(z=T(G,re,Q,oe,ae,L[_[N]],x[2],b[N]),H=T(de,be,pe,U,B,L[E[N]],y[2],p[N])):N<64?(z=R(G,re,Q,oe,ae,L[_[N]],x[3],b[N]),H=P(de,be,pe,U,B,L[E[N]],y[3],p[N])):(z=M(G,re,Q,oe,ae,L[_[N]],x[4],b[N]),H=A(de,be,pe,U,B,L[E[N]],y[4],p[N])),G=ae,ae=oe,oe=w(Q,10),Q=re,re=z,de=B,B=U,U=w(pe,10),pe=be,be=H}var Y=this._b+Q+U|0;this._b=this._c+oe+B|0,this._c=this._d+ae+de|0,this._d=this._e+G+be|0,this._e=this._a+re+pe|0,this._a=Y},f.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var L=h.alloc?h.alloc(20):new h(20);return L.writeInt32LE(this._a,0),L.writeInt32LE(this._b,4),L.writeInt32LE(this._c,8),L.writeInt32LE(this._d,12),L.writeInt32LE(this._e,16),L},a.exports=f},9047:(a,l,r)=>{var h=r(365),m=h.Buffer;function v(_,E){for(var b in _)E[b]=_[b]}function g(_,E,b){return m(_,E,b)}m.from&&m.alloc&&m.allocUnsafe&&m.allocUnsafeSlow?a.exports=h:(v(h,l),l.Buffer=g),g.prototype=Object.create(m.prototype),v(m,g),g.from=function(_,E,b){if(typeof _=="number")throw new TypeError("Argument must not be a number");return m(_,E,b)},g.alloc=function(_,E,b){if(typeof _!="number")throw new TypeError("Argument must be a number");var p=m(_);return E!==void 0?typeof b=="string"?p.fill(E,b):p.fill(E):p.fill(0),p},g.allocUnsafe=function(_){if(typeof _!="number")throw new TypeError("Argument must be a number");return m(_)},g.allocUnsafeSlow=function(_){if(typeof _!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(_)}},8723:(a,l,r)=>{function h(b){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},h(b)}var m,v=r(365),g=v.Buffer,_={};for(m in v)v.hasOwnProperty(m)&&m!=="SlowBuffer"&&m!=="Buffer"&&(_[m]=v[m]);var E=_.Buffer={};for(m in g)g.hasOwnProperty(m)&&m!=="allocUnsafe"&&m!=="allocUnsafeSlow"&&(E[m]=g[m]);if(_.Buffer.prototype=g.prototype,E.from&&E.from!==Uint8Array.from||(E.from=function(b,p,x){if(typeof b=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+h(b));if(b&&b.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+h(b));return g(b,p,x)}),E.alloc||(E.alloc=function(b,p,x){if(typeof b!="number")throw new TypeError('The "size" argument must be of type number. Received type '+h(b));if(b<0||b>=2147483648)throw new RangeError('The value "'+b+'" is invalid for option "size"');var y=g(b);return p&&p.length!==0?typeof x=="string"?y.fill(p,x):y.fill(p):y.fill(0),y}),!_.kStringMaxLength)try{_.kStringMaxLength={env:{}}.binding("buffer").kStringMaxLength}catch{}_.constants||(_.constants={MAX_LENGTH:_.kMaxLength},_.kStringMaxLength&&(_.constants.MAX_STRING_LENGTH=_.kStringMaxLength)),a.exports=_},2637:(a,l,r)=>{var h=r(6893),m=r(3793),v=r(2579)(),g=r(1554),_=h("%TypeError%"),E=h("%Math.floor%");a.exports=function(b,p){if(typeof b!="function")throw new _("`fn` is not a function");if(typeof p!="number"||p<0||p>4294967295||E(p)!==p)throw new _("`length` must be a positive 32-bit integer");var x=arguments.length>2&&!!arguments[2],y=!0,f=!0;if("length"in b&&g){var w=g(b,"length");w&&!w.configurable&&(y=!1),w&&!w.writable&&(f=!1)}return(y||f||!x)&&(v?m(b,"length",p,!0,!0):m(b,"length",p)),b}},2159:(a,l,r)=>{var h=r(9047).Buffer;function m(v,g){this._block=h.alloc(v),this._finalSize=g,this._blockSize=v,this._len=0}m.prototype.update=function(v,g){typeof v=="string"&&(g=g||"utf8",v=h.from(v,g));for(var _=this._block,E=this._blockSize,b=v.length,p=this._len,x=0;x<b;){for(var y=p%E,f=Math.min(b-x,E-y),w=0;w<f;w++)_[y+w]=v[x+w];x+=f,(p+=f)%E==0&&this._update(_)}return this._len+=b,this},m.prototype.digest=function(v){var g=this._len%this._blockSize;this._block[g]=128,this._block.fill(0,g+1),g>=this._finalSize&&(this._update(this._block),this._block.fill(0));var _=8*this._len;if(_<=4294967295)this._block.writeUInt32BE(_,this._blockSize-4);else{var E=(4294967295&_)>>>0,b=(_-E)/4294967296;this._block.writeUInt32BE(b,this._blockSize-8),this._block.writeUInt32BE(E,this._blockSize-4)}this._update(this._block);var p=this._hash();return v?p.toString(v):p},m.prototype._update=function(){throw new Error("_update must be implemented by subclass")},a.exports=m},1806:(a,l,r)=>{var h=a.exports=function(m){m=m.toLowerCase();var v=h[m];if(!v)throw new Error(m+" is not supported (we accept pull requests)");return new v};h.sha=r(9675),h.sha1=r(2950),h.sha224=r(8881),h.sha256=r(9642),h.sha384=r(8220),h.sha512=r(6859)},9675:(a,l,r)=>{var h=r(376),m=r(2159),v=r(9047).Buffer,g=[1518500249,1859775393,-1894007588,-899497514],_=new Array(80);function E(){this.init(),this._w=_,m.call(this,64,56)}function b(x){return x<<30|x>>>2}function p(x,y,f,w){return x===0?y&f|~y&w:x===2?y&f|y&w|f&w:y^f^w}h(E,m),E.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},E.prototype._update=function(x){for(var y,f=this._w,w=0|this._a,A=0|this._b,P=0|this._c,T=0|this._d,R=0|this._e,M=0;M<16;++M)f[M]=x.readInt32BE(4*M);for(;M<80;++M)f[M]=f[M-3]^f[M-8]^f[M-14]^f[M-16];for(var L=0;L<80;++L){var W=~~(L/20),G=0|((y=w)<<5|y>>>27)+p(W,A,P,T)+R+f[L]+g[W];R=T,T=P,P=b(A),A=w,w=G}this._a=w+this._a|0,this._b=A+this._b|0,this._c=P+this._c|0,this._d=T+this._d|0,this._e=R+this._e|0},E.prototype._hash=function(){var x=v.allocUnsafe(20);return x.writeInt32BE(0|this._a,0),x.writeInt32BE(0|this._b,4),x.writeInt32BE(0|this._c,8),x.writeInt32BE(0|this._d,12),x.writeInt32BE(0|this._e,16),x},a.exports=E},2950:(a,l,r)=>{var h=r(376),m=r(2159),v=r(9047).Buffer,g=[1518500249,1859775393,-1894007588,-899497514],_=new Array(80);function E(){this.init(),this._w=_,m.call(this,64,56)}function b(y){return y<<5|y>>>27}function p(y){return y<<30|y>>>2}function x(y,f,w,A){return y===0?f&w|~f&A:y===2?f&w|f&A|w&A:f^w^A}h(E,m),E.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},E.prototype._update=function(y){for(var f,w=this._w,A=0|this._a,P=0|this._b,T=0|this._c,R=0|this._d,M=0|this._e,L=0;L<16;++L)w[L]=y.readInt32BE(4*L);for(;L<80;++L)w[L]=(f=w[L-3]^w[L-8]^w[L-14]^w[L-16])<<1|f>>>31;for(var W=0;W<80;++W){var G=~~(W/20),re=b(A)+x(G,P,T,R)+M+w[W]+g[G]|0;M=R,R=T,T=p(P),P=A,A=re}this._a=A+this._a|0,this._b=P+this._b|0,this._c=T+this._c|0,this._d=R+this._d|0,this._e=M+this._e|0},E.prototype._hash=function(){var y=v.allocUnsafe(20);return y.writeInt32BE(0|this._a,0),y.writeInt32BE(0|this._b,4),y.writeInt32BE(0|this._c,8),y.writeInt32BE(0|this._d,12),y.writeInt32BE(0|this._e,16),y},a.exports=E},8881:(a,l,r)=>{var h=r(376),m=r(9642),v=r(2159),g=r(9047).Buffer,_=new Array(64);function E(){this.init(),this._w=_,v.call(this,64,56)}h(E,m),E.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},E.prototype._hash=function(){var b=g.allocUnsafe(28);return b.writeInt32BE(this._a,0),b.writeInt32BE(this._b,4),b.writeInt32BE(this._c,8),b.writeInt32BE(this._d,12),b.writeInt32BE(this._e,16),b.writeInt32BE(this._f,20),b.writeInt32BE(this._g,24),b},a.exports=E},9642:(a,l,r)=>{var h=r(376),m=r(2159),v=r(9047).Buffer,g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_=new Array(64);function E(){this.init(),this._w=_,m.call(this,64,56)}function b(w,A,P){return P^w&(A^P)}function p(w,A,P){return w&A|P&(w|A)}function x(w){return(w>>>2|w<<30)^(w>>>13|w<<19)^(w>>>22|w<<10)}function y(w){return(w>>>6|w<<26)^(w>>>11|w<<21)^(w>>>25|w<<7)}function f(w){return(w>>>7|w<<25)^(w>>>18|w<<14)^w>>>3}h(E,m),E.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},E.prototype._update=function(w){for(var A,P=this._w,T=0|this._a,R=0|this._b,M=0|this._c,L=0|this._d,W=0|this._e,G=0|this._f,re=0|this._g,Q=0|this._h,oe=0;oe<16;++oe)P[oe]=w.readInt32BE(4*oe);for(;oe<64;++oe)P[oe]=0|(((A=P[oe-2])>>>17|A<<15)^(A>>>19|A<<13)^A>>>10)+P[oe-7]+f(P[oe-15])+P[oe-16];for(var ae=0;ae<64;++ae){var de=Q+y(W)+b(W,G,re)+g[ae]+P[ae]|0,be=x(T)+p(T,R,M)|0;Q=re,re=G,G=W,W=L+de|0,L=M,M=R,R=T,T=de+be|0}this._a=T+this._a|0,this._b=R+this._b|0,this._c=M+this._c|0,this._d=L+this._d|0,this._e=W+this._e|0,this._f=G+this._f|0,this._g=re+this._g|0,this._h=Q+this._h|0},E.prototype._hash=function(){var w=v.allocUnsafe(32);return w.writeInt32BE(this._a,0),w.writeInt32BE(this._b,4),w.writeInt32BE(this._c,8),w.writeInt32BE(this._d,12),w.writeInt32BE(this._e,16),w.writeInt32BE(this._f,20),w.writeInt32BE(this._g,24),w.writeInt32BE(this._h,28),w},a.exports=E},8220:(a,l,r)=>{var h=r(376),m=r(6859),v=r(2159),g=r(9047).Buffer,_=new Array(160);function E(){this.init(),this._w=_,v.call(this,128,112)}h(E,m),E.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},E.prototype._hash=function(){var b=g.allocUnsafe(48);function p(x,y,f){b.writeInt32BE(x,f),b.writeInt32BE(y,f+4)}return p(this._ah,this._al,0),p(this._bh,this._bl,8),p(this._ch,this._cl,16),p(this._dh,this._dl,24),p(this._eh,this._el,32),p(this._fh,this._fl,40),b},a.exports=E},6859:(a,l,r)=>{var h=r(376),m=r(2159),v=r(9047).Buffer,g=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],_=new Array(160);function E(){this.init(),this._w=_,m.call(this,128,112)}function b(R,M,L){return L^R&(M^L)}function p(R,M,L){return R&M|L&(R|M)}function x(R,M){return(R>>>28|M<<4)^(M>>>2|R<<30)^(M>>>7|R<<25)}function y(R,M){return(R>>>14|M<<18)^(R>>>18|M<<14)^(M>>>9|R<<23)}function f(R,M){return(R>>>1|M<<31)^(R>>>8|M<<24)^R>>>7}function w(R,M){return(R>>>1|M<<31)^(R>>>8|M<<24)^(R>>>7|M<<25)}function A(R,M){return(R>>>19|M<<13)^(M>>>29|R<<3)^R>>>6}function P(R,M){return(R>>>19|M<<13)^(M>>>29|R<<3)^(R>>>6|M<<26)}function T(R,M){return R>>>0<M>>>0?1:0}h(E,m),E.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},E.prototype._update=function(R){for(var M=this._w,L=0|this._ah,W=0|this._bh,G=0|this._ch,re=0|this._dh,Q=0|this._eh,oe=0|this._fh,ae=0|this._gh,de=0|this._hh,be=0|this._al,pe=0|this._bl,U=0|this._cl,B=0|this._dl,N=0|this._el,z=0|this._fl,H=0|this._gl,Y=0|this._hl,fe=0;fe<32;fe+=2)M[fe]=R.readInt32BE(4*fe),M[fe+1]=R.readInt32BE(4*fe+4);for(;fe<160;fe+=2){var Re=M[fe-30],Oe=M[fe-30+1],De=f(Re,Oe),ot=w(Oe,Re),X=A(Re=M[fe-4],Oe=M[fe-4+1]),ee=P(Oe,Re),Le=M[fe-14],Be=M[fe-14+1],se=M[fe-32],_e=M[fe-32+1],te=ot+Be|0,$e=De+Le+T(te,ot)|0;$e=($e=$e+X+T(te=te+ee|0,ee)|0)+se+T(te=te+_e|0,_e)|0,M[fe]=$e,M[fe+1]=te}for(var ge=0;ge<160;ge+=2){$e=M[ge],te=M[ge+1];var le=p(L,W,G),ze=p(be,pe,U),Je=x(L,be),et=x(be,L),ft=y(Q,N),wt=y(N,Q),It=g[ge],Ct=g[ge+1],tn=b(Q,oe,ae),xt=b(N,z,H),Ht=Y+wt|0,en=de+ft+T(Ht,Y)|0;en=(en=(en=en+tn+T(Ht=Ht+xt|0,xt)|0)+It+T(Ht=Ht+Ct|0,Ct)|0)+$e+T(Ht=Ht+te|0,te)|0;var kn=et+ze|0,Dn=Je+le+T(kn,et)|0;de=ae,Y=H,ae=oe,H=z,oe=Q,z=N,Q=re+en+T(N=B+Ht|0,B)|0,re=G,B=U,G=W,U=pe,W=L,pe=be,L=en+Dn+T(be=Ht+kn|0,Ht)|0}this._al=this._al+be|0,this._bl=this._bl+pe|0,this._cl=this._cl+U|0,this._dl=this._dl+B|0,this._el=this._el+N|0,this._fl=this._fl+z|0,this._gl=this._gl+H|0,this._hl=this._hl+Y|0,this._ah=this._ah+L+T(this._al,be)|0,this._bh=this._bh+W+T(this._bl,pe)|0,this._ch=this._ch+G+T(this._cl,U)|0,this._dh=this._dh+re+T(this._dl,B)|0,this._eh=this._eh+Q+T(this._el,N)|0,this._fh=this._fh+oe+T(this._fl,z)|0,this._gh=this._gh+ae+T(this._gl,H)|0,this._hh=this._hh+de+T(this._hl,Y)|0},E.prototype._hash=function(){var R=v.allocUnsafe(64);function M(L,W,G){R.writeInt32BE(L,G),R.writeInt32BE(W,G+4)}return M(this._ah,this._al,0),M(this._bh,this._bl,8),M(this._ch,this._cl,16),M(this._dh,this._dl,24),M(this._eh,this._el,32),M(this._fh,this._fl,40),M(this._gh,this._gl,48),M(this._hh,this._hl,56),R},a.exports=E},4723:(a,l,r)=>{a.exports=m;var h=r(9620).EventEmitter;function m(){h.call(this)}r(376)(m,h),m.Readable=r(5967),m.Writable=r(8872),m.Duplex=r(7772),m.Transform=r(6473),m.PassThrough=r(5970),m.finished=r(7155),m.pipeline=r(6420),m.Stream=m,m.prototype.pipe=function(v,g){var _=this;function E(A){v.writable&&v.write(A)===!1&&_.pause&&_.pause()}function b(){_.readable&&_.resume&&_.resume()}_.on("data",E),v.on("drain",b),v._isStdio||g&&g.end===!1||(_.on("end",x),_.on("close",y));var p=!1;function x(){p||(p=!0,v.end())}function y(){p||(p=!0,typeof v.destroy=="function"&&v.destroy())}function f(A){if(w(),h.listenerCount(this,"error")===0)throw A}function w(){_.removeListener("data",E),v.removeListener("drain",b),_.removeListener("end",x),_.removeListener("close",y),_.removeListener("error",f),v.removeListener("error",f),_.removeListener("end",w),_.removeListener("close",w),v.removeListener("close",w)}return _.on("error",f),v.on("error",f),_.on("end",w),_.on("close",w),v.on("close",w),v.emit("pipe",_),v}},8442:a=>{function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(v)}var r={};function h(v,g,_){_||(_=Error);var E=function(b){var p,x;function y(f,w,A){return b.call(this,function(P,T,R){return typeof g=="string"?g:g(P,T,R)}(f,w,A))||this}return x=b,(p=y).prototype=Object.create(x.prototype),p.prototype.constructor=p,p.__proto__=x,y}(_);E.prototype.name=_.name,E.prototype.code=v,r[v]=E}function m(v,g){if(Array.isArray(v)){var _=v.length;return v=v.map(function(E){return String(E)}),_>2?"one of ".concat(g," ").concat(v.slice(0,_-1).join(", "),", or ")+v[_-1]:_===2?"one of ".concat(g," ").concat(v[0]," or ").concat(v[1]):"of ".concat(g," ").concat(v[0])}return"of ".concat(g," ").concat(String(v))}h("ERR_INVALID_OPT_VALUE",function(v,g){return'The value "'+g+'" is invalid for option "'+v+'"'},TypeError),h("ERR_INVALID_ARG_TYPE",function(v,g,_){var E,b,p,x,y;if(typeof g=="string"&&(b="not ",g.substr(0,4)===b)?(E="must not be",g=g.replace(/^not /,"")):E="must be",function(w,A,P){return(P===void 0||P>w.length)&&(P=w.length),w.substring(P-9,P)===A}(v," argument"))p="The ".concat(v," ").concat(E," ").concat(m(g,"type"));else{var f=(typeof y!="number"&&(y=0),y+1>(x=v).length||x.indexOf(".",y)===-1?"argument":"property");p='The "'.concat(v,'" ').concat(f," ").concat(E," ").concat(m(g,"type"))}return p+". Received type ".concat(l(_))},TypeError),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),h("ERR_METHOD_NOT_IMPLEMENTED",function(v){return"The "+v+" method is not implemented"}),h("ERR_STREAM_PREMATURE_CLOSE","Premature close"),h("ERR_STREAM_DESTROYED",function(v){return"Cannot call "+v+" after a stream was destroyed"}),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),h("ERR_STREAM_WRITE_AFTER_END","write after end"),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_UNKNOWN_ENCODING",function(v){return"Unknown encoding: "+v},TypeError),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.q=r},7772:(a,l,r)=>{var h=Object.keys||function(y){var f=[];for(var w in y)f.push(w);return f};a.exports=b;var m=r(5967),v=r(8872);r(376)(b,m);for(var g=h(v.prototype),_=0;_<g.length;_++){var E=g[_];b.prototype[E]||(b.prototype[E]=v.prototype[E])}function b(y){if(!(this instanceof b))return new b(y);m.call(this,y),v.call(this,y),this.allowHalfOpen=!0,y&&(y.readable===!1&&(this.readable=!1),y.writable===!1&&(this.writable=!1),y.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",p)))}function p(){this._writableState.ended||{env:{}}.nextTick(x,this)}function x(y){y.end()}Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(b.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(b.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=y,this._writableState.destroyed=y)}})},5970:(a,l,r)=>{a.exports=m;var h=r(6473);function m(v){if(!(this instanceof m))return new m(v);h.call(this,v)}r(376)(m,h),m.prototype._transform=function(v,g,_){_(null,v)}},5967:(a,l,r)=>{var h;a.exports=Q,Q.ReadableState=re,r(9620).EventEmitter;var m,v=function(X,ee){return X.listeners(ee).length},g=r(2289),_=r(365).Buffer,E=(r.g!==void 0?r.g:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},b=r(964);m=b&&b.debuglog?b.debuglog("stream"):function(){};var p,x,y,f=r(2803),w=r(6781),A=r(1441).getHighWaterMark,P=r(8442).q,T=P.ERR_INVALID_ARG_TYPE,R=P.ERR_STREAM_PUSH_AFTER_EOF,M=P.ERR_METHOD_NOT_IMPLEMENTED,L=P.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(376)(Q,g);var W=w.errorOrDestroy,G=["error","close","destroy","pause","resume"];function re(X,ee,Le){h=h||r(7772),X=X||{},typeof Le!="boolean"&&(Le=ee instanceof h),this.objectMode=!!X.objectMode,Le&&(this.objectMode=this.objectMode||!!X.readableObjectMode),this.highWaterMark=A(this,X,"readableHighWaterMark",Le),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=X.emitClose!==!1,this.autoDestroy=!!X.autoDestroy,this.destroyed=!1,this.defaultEncoding=X.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,X.encoding&&(p||(p=r(113).s),this.decoder=new p(X.encoding),this.encoding=X.encoding)}function Q(X){if(h=h||r(7772),!(this instanceof Q))return new Q(X);var ee=this instanceof h;this._readableState=new re(X,this,ee),this.readable=!0,X&&(typeof X.read=="function"&&(this._read=X.read),typeof X.destroy=="function"&&(this._destroy=X.destroy)),g.call(this)}function oe(X,ee,Le,Be,se){m("readableAddChunk",ee);var _e,te=X._readableState;if(ee===null)te.reading=!1,function($e,ge){if(m("onEofChunk"),!ge.ended){if(ge.decoder){var le=ge.decoder.end();le&&le.length&&(ge.buffer.push(le),ge.length+=ge.objectMode?1:le.length)}ge.ended=!0,ge.sync?pe($e):(ge.needReadable=!1,ge.emittedReadable||(ge.emittedReadable=!0,U($e)))}}(X,te);else if(se||(_e=function($e,ge){var le,ze;return ze=ge,_.isBuffer(ze)||ze instanceof E||typeof ge=="string"||ge===void 0||$e.objectMode||(le=new T("chunk",["string","Buffer","Uint8Array"],ge)),le}(te,ee)),_e)W(X,_e);else if(te.objectMode||ee&&ee.length>0)if(typeof ee=="string"||te.objectMode||Object.getPrototypeOf(ee)===_.prototype||(ee=function($e){return _.from($e)}(ee)),Be)te.endEmitted?W(X,new L):ae(X,te,ee,!0);else if(te.ended)W(X,new R);else{if(te.destroyed)return!1;te.reading=!1,te.decoder&&!Le?(ee=te.decoder.write(ee),te.objectMode||ee.length!==0?ae(X,te,ee,!1):B(X,te)):ae(X,te,ee,!1)}else Be||(te.reading=!1,B(X,te));return!te.ended&&(te.length<te.highWaterMark||te.length===0)}function ae(X,ee,Le,Be){ee.flowing&&ee.length===0&&!ee.sync?(ee.awaitDrain=0,X.emit("data",Le)):(ee.length+=ee.objectMode?1:Le.length,Be?ee.buffer.unshift(Le):ee.buffer.push(Le),ee.needReadable&&pe(X)),B(X,ee)}Object.defineProperty(Q.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(X){this._readableState&&(this._readableState.destroyed=X)}}),Q.prototype.destroy=w.destroy,Q.prototype._undestroy=w.undestroy,Q.prototype._destroy=function(X,ee){ee(X)},Q.prototype.push=function(X,ee){var Le,Be=this._readableState;return Be.objectMode?Le=!0:typeof X=="string"&&((ee=ee||Be.defaultEncoding)!==Be.encoding&&(X=_.from(X,ee),ee=""),Le=!0),oe(this,X,ee,!1,Le)},Q.prototype.unshift=function(X){return oe(this,X,null,!0,!1)},Q.prototype.isPaused=function(){return this._readableState.flowing===!1},Q.prototype.setEncoding=function(X){p||(p=r(113).s);var ee=new p(X);this._readableState.decoder=ee,this._readableState.encoding=this._readableState.decoder.encoding;for(var Le=this._readableState.buffer.head,Be="";Le!==null;)Be+=ee.write(Le.data),Le=Le.next;return this._readableState.buffer.clear(),Be!==""&&this._readableState.buffer.push(Be),this._readableState.length=Be.length,this};var de=1073741824;function be(X,ee){return X<=0||ee.length===0&&ee.ended?0:ee.objectMode?1:X!=X?ee.flowing&&ee.length?ee.buffer.head.data.length:ee.length:(X>ee.highWaterMark&&(ee.highWaterMark=function(Le){return Le>=de?Le=de:(Le--,Le|=Le>>>1,Le|=Le>>>2,Le|=Le>>>4,Le|=Le>>>8,Le|=Le>>>16,Le++),Le}(X)),X<=ee.length?X:ee.ended?ee.length:(ee.needReadable=!0,0))}function pe(X){var ee=X._readableState;m("emitReadable",ee.needReadable,ee.emittedReadable),ee.needReadable=!1,ee.emittedReadable||(m("emitReadable",ee.flowing),ee.emittedReadable=!0,{env:{}}.nextTick(U,X))}function U(X){var ee=X._readableState;m("emitReadable_",ee.destroyed,ee.length,ee.ended),ee.destroyed||!ee.length&&!ee.ended||(X.emit("readable"),ee.emittedReadable=!1),ee.needReadable=!ee.flowing&&!ee.ended&&ee.length<=ee.highWaterMark,fe(X)}function B(X,ee){ee.readingMore||(ee.readingMore=!0,{env:{}}.nextTick(N,X,ee))}function N(X,ee){for(;!ee.reading&&!ee.ended&&(ee.length<ee.highWaterMark||ee.flowing&&ee.length===0);){var Le=ee.length;if(m("maybeReadMore read 0"),X.read(0),Le===ee.length)break}ee.readingMore=!1}function z(X){var ee=X._readableState;ee.readableListening=X.listenerCount("readable")>0,ee.resumeScheduled&&!ee.paused?ee.flowing=!0:X.listenerCount("data")>0&&X.resume()}function H(X){m("readable nexttick read 0"),X.read(0)}function Y(X,ee){m("resume",ee.reading),ee.reading||X.read(0),ee.resumeScheduled=!1,X.emit("resume"),fe(X),ee.flowing&&!ee.reading&&X.read(0)}function fe(X){var ee=X._readableState;for(m("flow",ee.flowing);ee.flowing&&X.read()!==null;);}function Re(X,ee){return ee.length===0?null:(ee.objectMode?Le=ee.buffer.shift():!X||X>=ee.length?(Le=ee.decoder?ee.buffer.join(""):ee.buffer.length===1?ee.buffer.first():ee.buffer.concat(ee.length),ee.buffer.clear()):Le=ee.buffer.consume(X,ee.decoder),Le);var Le}function Oe(X){var ee=X._readableState;m("endReadable",ee.endEmitted),ee.endEmitted||(ee.ended=!0,{env:{}}.nextTick(De,ee,X))}function De(X,ee){if(m("endReadableNT",X.endEmitted,X.length),!X.endEmitted&&X.length===0&&(X.endEmitted=!0,ee.readable=!1,ee.emit("end"),X.autoDestroy)){var Le=ee._writableState;(!Le||Le.autoDestroy&&Le.finished)&&ee.destroy()}}function ot(X,ee){for(var Le=0,Be=X.length;Le<Be;Le++)if(X[Le]===ee)return Le;return-1}Q.prototype.read=function(X){m("read",X),X=parseInt(X,10);var ee=this._readableState,Le=X;if(X!==0&&(ee.emittedReadable=!1),X===0&&ee.needReadable&&((ee.highWaterMark!==0?ee.length>=ee.highWaterMark:ee.length>0)||ee.ended))return m("read: emitReadable",ee.length,ee.ended),ee.length===0&&ee.ended?Oe(this):pe(this),null;if((X=be(X,ee))===0&&ee.ended)return ee.length===0&&Oe(this),null;var Be,se=ee.needReadable;return m("need readable",se),(ee.length===0||ee.length-X<ee.highWaterMark)&&m("length less than watermark",se=!0),ee.ended||ee.reading?m("reading or ended",se=!1):se&&(m("do read"),ee.reading=!0,ee.sync=!0,ee.length===0&&(ee.needReadable=!0),this._read(ee.highWaterMark),ee.sync=!1,ee.reading||(X=be(Le,ee))),(Be=X>0?Re(X,ee):null)===null?(ee.needReadable=ee.length<=ee.highWaterMark,X=0):(ee.length-=X,ee.awaitDrain=0),ee.length===0&&(ee.ended||(ee.needReadable=!0),Le!==X&&ee.ended&&Oe(this)),Be!==null&&this.emit("data",Be),Be},Q.prototype._read=function(X){W(this,new M("_read()"))},Q.prototype.pipe=function(X,ee){var Le=this,Be=this._readableState;switch(Be.pipesCount){case 0:Be.pipes=X;break;case 1:Be.pipes=[Be.pipes,X];break;default:Be.pipes.push(X)}Be.pipesCount+=1,m("pipe count=%d opts=%j",Be.pipesCount,ee);var se=ee&&ee.end===!1||X==={env:{}}.stdout||X==={env:{}}.stderr?et:_e;function _e(){m("onend"),X.end()}Be.endEmitted?{env:{}}.nextTick(se):Le.once("end",se),X.on("unpipe",function ft(wt,It){m("onunpipe"),wt===Le&&It&&It.hasUnpiped===!1&&(It.hasUnpiped=!0,m("cleanup"),X.removeListener("close",ze),X.removeListener("finish",Je),X.removeListener("drain",te),X.removeListener("error",le),X.removeListener("unpipe",ft),Le.removeListener("end",_e),Le.removeListener("end",et),Le.removeListener("data",ge),$e=!0,!Be.awaitDrain||X._writableState&&!X._writableState.needDrain||te())});var te=function(ft){return function(){var wt=ft._readableState;m("pipeOnDrain",wt.awaitDrain),wt.awaitDrain&&wt.awaitDrain--,wt.awaitDrain===0&&v(ft,"data")&&(wt.flowing=!0,fe(ft))}}(Le);X.on("drain",te);var $e=!1;function ge(ft){m("ondata");var wt=X.write(ft);m("dest.write",wt),wt===!1&&((Be.pipesCount===1&&Be.pipes===X||Be.pipesCount>1&&ot(Be.pipes,X)!==-1)&&!$e&&(m("false write response, pause",Be.awaitDrain),Be.awaitDrain++),Le.pause())}function le(ft){m("onerror",ft),et(),X.removeListener("error",le),v(X,"error")===0&&W(X,ft)}function ze(){X.removeListener("finish",Je),et()}function Je(){m("onfinish"),X.removeListener("close",ze),et()}function et(){m("unpipe"),Le.unpipe(X)}return Le.on("data",ge),function(ft,wt,It){if(typeof ft.prependListener=="function")return ft.prependListener(wt,It);ft._events&&ft._events[wt]?Array.isArray(ft._events[wt])?ft._events[wt].unshift(It):ft._events[wt]=[It,ft._events[wt]]:ft.on(wt,It)}(X,"error",le),X.once("close",ze),X.once("finish",Je),X.emit("pipe",Le),Be.flowing||(m("pipe resume"),Le.resume()),X},Q.prototype.unpipe=function(X){var ee=this._readableState,Le={hasUnpiped:!1};if(ee.pipesCount===0)return this;if(ee.pipesCount===1)return X&&X!==ee.pipes||(X||(X=ee.pipes),ee.pipes=null,ee.pipesCount=0,ee.flowing=!1,X&&X.emit("unpipe",this,Le)),this;if(!X){var Be=ee.pipes,se=ee.pipesCount;ee.pipes=null,ee.pipesCount=0,ee.flowing=!1;for(var _e=0;_e<se;_e++)Be[_e].emit("unpipe",this,{hasUnpiped:!1});return this}var te=ot(ee.pipes,X);return te===-1||(ee.pipes.splice(te,1),ee.pipesCount-=1,ee.pipesCount===1&&(ee.pipes=ee.pipes[0]),X.emit("unpipe",this,Le)),this},Q.prototype.on=function(X,ee){var Le=g.prototype.on.call(this,X,ee),Be=this._readableState;return X==="data"?(Be.readableListening=this.listenerCount("readable")>0,Be.flowing!==!1&&this.resume()):X==="readable"&&(Be.endEmitted||Be.readableListening||(Be.readableListening=Be.needReadable=!0,Be.flowing=!1,Be.emittedReadable=!1,m("on readable",Be.length,Be.reading),Be.length?pe(this):Be.reading||{env:{}}.nextTick(H,this))),Le},Q.prototype.addListener=Q.prototype.on,Q.prototype.removeListener=function(X,ee){var Le=g.prototype.removeListener.call(this,X,ee);return X==="readable"&&{env:{}}.nextTick(z,this),Le},Q.prototype.removeAllListeners=function(X){var ee=g.prototype.removeAllListeners.apply(this,arguments);return X!=="readable"&&X!==void 0||{env:{}}.nextTick(z,this),ee},Q.prototype.resume=function(){var X=this._readableState;return X.flowing||(m("resume"),X.flowing=!X.readableListening,function(ee,Le){Le.resumeScheduled||(Le.resumeScheduled=!0,{env:{}}.nextTick(Y,ee,Le))}(this,X)),X.paused=!1,this},Q.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},Q.prototype.wrap=function(X){var ee=this,Le=this._readableState,Be=!1;for(var se in X.on("end",function(){if(m("wrapped end"),Le.decoder&&!Le.ended){var te=Le.decoder.end();te&&te.length&&ee.push(te)}ee.push(null)}),X.on("data",function(te){m("wrapped data"),Le.decoder&&(te=Le.decoder.write(te)),Le.objectMode&&te==null||(Le.objectMode||te&&te.length)&&(ee.push(te)||(Be=!0,X.pause()))}),X)this[se]===void 0&&typeof X[se]=="function"&&(this[se]=function(te){return function(){return X[te].apply(X,arguments)}}(se));for(var _e=0;_e<G.length;_e++)X.on(G[_e],this.emit.bind(this,G[_e]));return this._read=function(te){m("wrapped _read",te),Be&&(Be=!1,X.resume())},this},typeof Symbol=="function"&&(Q.prototype[Symbol.asyncIterator]=function(){return x===void 0&&(x=r(6428)),x(this)}),Object.defineProperty(Q.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Q.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Q.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(X){this._readableState&&(this._readableState.flowing=X)}}),Q._fromList=Re,Object.defineProperty(Q.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(Q.from=function(X,ee){return y===void 0&&(y=r(8271)),y(Q,X,ee)})},6473:(a,l,r)=>{a.exports=p;var h=r(8442).q,m=h.ERR_METHOD_NOT_IMPLEMENTED,v=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,_=h.ERR_TRANSFORM_WITH_LENGTH_0,E=r(7772);function b(f,w){var A=this._transformState;A.transforming=!1;var P=A.writecb;if(P===null)return this.emit("error",new v);A.writechunk=null,A.writecb=null,w!=null&&this.push(w),P(f);var T=this._readableState;T.reading=!1,(T.needReadable||T.length<T.highWaterMark)&&this._read(T.highWaterMark)}function p(f){if(!(this instanceof p))return new p(f);E.call(this,f),this._transformState={afterTransform:b.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",x)}function x(){var f=this;typeof this._flush!="function"||this._readableState.destroyed?y(this,null,null):this._flush(function(w,A){y(f,w,A)})}function y(f,w,A){if(w)return f.emit("error",w);if(A!=null&&f.push(A),f._writableState.length)throw new _;if(f._transformState.transforming)throw new g;return f.push(null)}r(376)(p,E),p.prototype.push=function(f,w){return this._transformState.needTransform=!1,E.prototype.push.call(this,f,w)},p.prototype._transform=function(f,w,A){A(new m("_transform()"))},p.prototype._write=function(f,w,A){var P=this._transformState;if(P.writecb=A,P.writechunk=f,P.writeencoding=w,!P.transforming){var T=this._readableState;(P.needTransform||T.needReadable||T.length<T.highWaterMark)&&this._read(T.highWaterMark)}},p.prototype._read=function(f){var w=this._transformState;w.writechunk===null||w.transforming?w.needTransform=!0:(w.transforming=!0,this._transform(w.writechunk,w.writeencoding,w.afterTransform))},p.prototype._destroy=function(f,w){E.prototype._destroy.call(this,f,function(A){w(A)})}},8872:(a,l,r)=>{function h(B){var N=this;this.next=null,this.entry=null,this.finish=function(){(function(z,H,Y){var fe=z.entry;for(z.entry=null;fe;){var Re=fe.callback;H.pendingcb--,Re(void 0),fe=fe.next}H.corkedRequestsFree.next=z})(N,B)}}var m;a.exports=Q,Q.WritableState=re;var v,g={deprecate:r(8016)},_=r(2289),E=r(365).Buffer,b=(r.g!==void 0?r.g:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},p=r(6781),x=r(1441).getHighWaterMark,y=r(8442).q,f=y.ERR_INVALID_ARG_TYPE,w=y.ERR_METHOD_NOT_IMPLEMENTED,A=y.ERR_MULTIPLE_CALLBACK,P=y.ERR_STREAM_CANNOT_PIPE,T=y.ERR_STREAM_DESTROYED,R=y.ERR_STREAM_NULL_VALUES,M=y.ERR_STREAM_WRITE_AFTER_END,L=y.ERR_UNKNOWN_ENCODING,W=p.errorOrDestroy;function G(){}function re(B,N,z){m=m||r(7772),B=B||{},typeof z!="boolean"&&(z=N instanceof m),this.objectMode=!!B.objectMode,z&&(this.objectMode=this.objectMode||!!B.writableObjectMode),this.highWaterMark=x(this,B,"writableHighWaterMark",z),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var H=B.decodeStrings===!1;this.decodeStrings=!H,this.defaultEncoding=B.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Y){(function(fe,Re){var Oe=fe._writableState,De=Oe.sync,ot=Oe.writecb;if(typeof ot!="function")throw new A;if(function(ee){ee.writing=!1,ee.writecb=null,ee.length-=ee.writelen,ee.writelen=0}(Oe),Re)(function(ee,Le,Be,se,_e){--Le.pendingcb,Be?({env:{}}.nextTick(_e,se),{env:{}}.nextTick(U,ee,Le),ee._writableState.errorEmitted=!0,W(ee,se)):(_e(se),ee._writableState.errorEmitted=!0,W(ee,se),U(ee,Le))})(fe,Oe,De,Re,ot);else{var X=be(Oe)||fe.destroyed;X||Oe.corked||Oe.bufferProcessing||!Oe.bufferedRequest||de(fe,Oe),De?{env:{}}.nextTick(ae,fe,Oe,X,ot):ae(fe,Oe,X,ot)}})(N,Y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=B.emitClose!==!1,this.autoDestroy=!!B.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new h(this)}function Q(B){var N=this instanceof(m=m||r(7772));if(!N&&!v.call(Q,this))return new Q(B);this._writableState=new re(B,this,N),this.writable=!0,B&&(typeof B.write=="function"&&(this._write=B.write),typeof B.writev=="function"&&(this._writev=B.writev),typeof B.destroy=="function"&&(this._destroy=B.destroy),typeof B.final=="function"&&(this._final=B.final)),_.call(this)}function oe(B,N,z,H,Y,fe,Re){N.writelen=H,N.writecb=Re,N.writing=!0,N.sync=!0,N.destroyed?N.onwrite(new T("write")):z?B._writev(Y,N.onwrite):B._write(Y,fe,N.onwrite),N.sync=!1}function ae(B,N,z,H){z||function(Y,fe){fe.length===0&&fe.needDrain&&(fe.needDrain=!1,Y.emit("drain"))}(B,N),N.pendingcb--,H(),U(B,N)}function de(B,N){N.bufferProcessing=!0;var z=N.bufferedRequest;if(B._writev&&z&&z.next){var H=N.bufferedRequestCount,Y=new Array(H),fe=N.corkedRequestsFree;fe.entry=z;for(var Re=0,Oe=!0;z;)Y[Re]=z,z.isBuf||(Oe=!1),z=z.next,Re+=1;Y.allBuffers=Oe,oe(B,N,!0,N.length,Y,"",fe.finish),N.pendingcb++,N.lastBufferedRequest=null,fe.next?(N.corkedRequestsFree=fe.next,fe.next=null):N.corkedRequestsFree=new h(N),N.bufferedRequestCount=0}else{for(;z;){var De=z.chunk,ot=z.encoding,X=z.callback;if(oe(B,N,!1,N.objectMode?1:De.length,De,ot,X),z=z.next,N.bufferedRequestCount--,N.writing)break}z===null&&(N.lastBufferedRequest=null)}N.bufferedRequest=z,N.bufferProcessing=!1}function be(B){return B.ending&&B.length===0&&B.bufferedRequest===null&&!B.finished&&!B.writing}function pe(B,N){B._final(function(z){N.pendingcb--,z&&W(B,z),N.prefinished=!0,B.emit("prefinish"),U(B,N)})}function U(B,N){var z=be(N);if(z&&(function(Y,fe){fe.prefinished||fe.finalCalled||(typeof Y._final!="function"||fe.destroyed?(fe.prefinished=!0,Y.emit("prefinish")):(fe.pendingcb++,fe.finalCalled=!0,{env:{}}.nextTick(pe,Y,fe)))}(B,N),N.pendingcb===0&&(N.finished=!0,B.emit("finish"),N.autoDestroy))){var H=B._readableState;(!H||H.autoDestroy&&H.endEmitted)&&B.destroy()}return z}r(376)(Q,_),re.prototype.getBuffer=function(){for(var B=this.bufferedRequest,N=[];B;)N.push(B),B=B.next;return N},function(){try{Object.defineProperty(re.prototype,"buffer",{get:g.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(Q,Symbol.hasInstance,{value:function(B){return!!v.call(this,B)||this===Q&&B&&B._writableState instanceof re}})):v=function(B){return B instanceof this},Q.prototype.pipe=function(){W(this,new P)},Q.prototype.write=function(B,N,z){var H,Y=this._writableState,fe=!1,Re=!Y.objectMode&&(H=B,E.isBuffer(H)||H instanceof b);return Re&&!E.isBuffer(B)&&(B=function(Oe){return E.from(Oe)}(B)),typeof N=="function"&&(z=N,N=null),Re?N="buffer":N||(N=Y.defaultEncoding),typeof z!="function"&&(z=G),Y.ending?function(Oe,De){var ot=new M;W(Oe,ot),{env:{}}.nextTick(De,ot)}(this,z):(Re||function(Oe,De,ot,X){var ee;return ot===null?ee=new R:typeof ot=="string"||De.objectMode||(ee=new f("chunk",["string","Buffer"],ot)),!ee||(W(Oe,ee),{env:{}}.nextTick(X,ee),!1)}(this,Y,B,z))&&(Y.pendingcb++,fe=function(Oe,De,ot,X,ee,Le){if(!ot){var Be=function($e,ge,le){return $e.objectMode||$e.decodeStrings===!1||typeof ge!="string"||(ge=E.from(ge,le)),ge}(De,X,ee);X!==Be&&(ot=!0,ee="buffer",X=Be)}var se=De.objectMode?1:X.length;De.length+=se;var _e=De.length<De.highWaterMark;if(_e||(De.needDrain=!0),De.writing||De.corked){var te=De.lastBufferedRequest;De.lastBufferedRequest={chunk:X,encoding:ee,isBuf:ot,callback:Le,next:null},te?te.next=De.lastBufferedRequest:De.bufferedRequest=De.lastBufferedRequest,De.bufferedRequestCount+=1}else oe(Oe,De,!1,se,X,ee,Le);return _e}(this,Y,Re,B,N,z)),fe},Q.prototype.cork=function(){this._writableState.corked++},Q.prototype.uncork=function(){var B=this._writableState;B.corked&&(B.corked--,B.writing||B.corked||B.bufferProcessing||!B.bufferedRequest||de(this,B))},Q.prototype.setDefaultEncoding=function(B){if(typeof B=="string"&&(B=B.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((B+"").toLowerCase())>-1))throw new L(B);return this._writableState.defaultEncoding=B,this},Object.defineProperty(Q.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Q.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Q.prototype._write=function(B,N,z){z(new w("_write()"))},Q.prototype._writev=null,Q.prototype.end=function(B,N,z){var H=this._writableState;return typeof B=="function"?(z=B,B=null,N=null):typeof N=="function"&&(z=N,N=null),B!=null&&this.write(B,N),H.corked&&(H.corked=1,this.uncork()),H.ending||function(Y,fe,Re){fe.ending=!0,U(Y,fe),Re&&(fe.finished?{env:{}}.nextTick(Re):Y.once("finish",Re)),fe.ended=!0,Y.writable=!1}(this,H,z),this},Object.defineProperty(Q.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Q.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(B){this._writableState&&(this._writableState.destroyed=B)}}),Q.prototype.destroy=p.destroy,Q.prototype._undestroy=p.undestroy,Q.prototype._destroy=function(B,N){N(B)}},6428:(a,l,r)=>{function h(M){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},h(M)}var m;function v(M,L,W){return(L=function(G){var re=function(Q,oe){if(h(Q)!=="object"||Q===null)return Q;var ae=Q[Symbol.toPrimitive];if(ae!==void 0){var de=ae.call(Q,"string");if(h(de)!=="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Q)}(G);return h(re)==="symbol"?re:String(re)}(L))in M?Object.defineProperty(M,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):M[L]=W,M}var g=r(7155),_=Symbol("lastResolve"),E=Symbol("lastReject"),b=Symbol("error"),p=Symbol("ended"),x=Symbol("lastPromise"),y=Symbol("handlePromise"),f=Symbol("stream");function w(M,L){return{value:M,done:L}}function A(M){var L=M[_];if(L!==null){var W=M[f].read();W!==null&&(M[x]=null,M[_]=null,M[E]=null,L(w(W,!1)))}}function P(M){({env:{}}).nextTick(A,M)}var T=Object.getPrototypeOf(function(){}),R=Object.setPrototypeOf((v(m={get stream(){return this[f]},next:function(){var M=this,L=this[b];if(L!==null)return Promise.reject(L);if(this[p])return Promise.resolve(w(void 0,!0));if(this[f].destroyed)return new Promise(function(Q,oe){({env:{}}).nextTick(function(){M[b]?oe(M[b]):Q(w(void 0,!0))})});var W,G=this[x];if(G)W=new Promise(function(Q,oe){return function(ae,de){Q.then(function(){oe[p]?ae(w(void 0,!0)):oe[y](ae,de)},de)}}(G,this));else{var re=this[f].read();if(re!==null)return Promise.resolve(w(re,!1));W=new Promise(this[y])}return this[x]=W,W}},Symbol.asyncIterator,function(){return this}),v(m,"return",function(){var M=this;return new Promise(function(L,W){M[f].destroy(null,function(G){G?W(G):L(w(void 0,!0))})})}),m),T);a.exports=function(M){var L,W=Object.create(R,(v(L={},f,{value:M,writable:!0}),v(L,_,{value:null,writable:!0}),v(L,E,{value:null,writable:!0}),v(L,b,{value:null,writable:!0}),v(L,p,{value:M._readableState.endEmitted,writable:!0}),v(L,y,{value:function(G,re){var Q=W[f].read();Q?(W[x]=null,W[_]=null,W[E]=null,G(w(Q,!1))):(W[_]=G,W[E]=re)},writable:!0}),L));return W[x]=null,g(M,function(G){if(G&&G.code!=="ERR_STREAM_PREMATURE_CLOSE"){var re=W[E];return re!==null&&(W[x]=null,W[_]=null,W[E]=null,re(G)),void(W[b]=G)}var Q=W[_];Q!==null&&(W[x]=null,W[_]=null,W[E]=null,Q(w(void 0,!0))),W[p]=!0}),M.on("readable",P.bind(null,W)),W}},2803:(a,l,r)=>{function h(y){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},h(y)}function m(y,f){var w=Object.keys(y);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(y);f&&(A=A.filter(function(P){return Object.getOwnPropertyDescriptor(y,P).enumerable})),w.push.apply(w,A)}return w}function v(y){for(var f=1;f<arguments.length;f++){var w=arguments[f]!=null?arguments[f]:{};f%2?m(Object(w),!0).forEach(function(A){g(y,A,w[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(w)):m(Object(w)).forEach(function(A){Object.defineProperty(y,A,Object.getOwnPropertyDescriptor(w,A))})}return y}function g(y,f,w){return(f=E(f))in y?Object.defineProperty(y,f,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[f]=w,y}function _(y,f){for(var w=0;w<f.length;w++){var A=f[w];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(y,E(A.key),A)}}function E(y){var f=function(w,A){if(h(w)!=="object"||w===null)return w;var P=w[Symbol.toPrimitive];if(P!==void 0){var T=P.call(w,"string");if(h(T)!=="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(w)}(y);return h(f)==="symbol"?f:String(f)}var b=r(365).Buffer,p=r(9862).inspect,x=p&&p.custom||"inspect";a.exports=function(){function y(){(function(A,P){if(!(A instanceof P))throw new TypeError("Cannot call a class as a function")})(this,y),this.head=null,this.tail=null,this.length=0}var f,w;return f=y,(w=[{key:"push",value:function(A){var P={data:A,next:null};this.length>0?this.tail.next=P:this.head=P,this.tail=P,++this.length}},{key:"unshift",value:function(A){var P={data:A,next:this.head};this.length===0&&(this.tail=P),this.head=P,++this.length}},{key:"shift",value:function(){if(this.length!==0){var A=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,A}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(A){if(this.length===0)return"";for(var P=this.head,T=""+P.data;P=P.next;)T+=A+P.data;return T}},{key:"concat",value:function(A){if(this.length===0)return b.alloc(0);for(var P,T,R,M=b.allocUnsafe(A>>>0),L=this.head,W=0;L;)P=L.data,T=M,R=W,b.prototype.copy.call(P,T,R),W+=L.data.length,L=L.next;return M}},{key:"consume",value:function(A,P){var T;return A<this.head.data.length?(T=this.head.data.slice(0,A),this.head.data=this.head.data.slice(A)):T=A===this.head.data.length?this.shift():P?this._getString(A):this._getBuffer(A),T}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(A){var P=this.head,T=1,R=P.data;for(A-=R.length;P=P.next;){var M=P.data,L=A>M.length?M.length:A;if(L===M.length?R+=M:R+=M.slice(0,A),(A-=L)==0){L===M.length?(++T,P.next?this.head=P.next:this.head=this.tail=null):(this.head=P,P.data=M.slice(L));break}++T}return this.length-=T,R}},{key:"_getBuffer",value:function(A){var P=b.allocUnsafe(A),T=this.head,R=1;for(T.data.copy(P),A-=T.data.length;T=T.next;){var M=T.data,L=A>M.length?M.length:A;if(M.copy(P,P.length-A,0,L),(A-=L)==0){L===M.length?(++R,T.next?this.head=T.next:this.head=this.tail=null):(this.head=T,T.data=M.slice(L));break}++R}return this.length-=R,P}},{key:x,value:function(A,P){return p(this,v(v({},P),{},{depth:0,customInspect:!1}))}}])&&_(f.prototype,w),Object.defineProperty(f,"prototype",{writable:!1}),y}()},6781:a=>{function l(m,v){h(m,v),r(m)}function r(m){m._writableState&&!m._writableState.emitClose||m._readableState&&!m._readableState.emitClose||m.emit("close")}function h(m,v){m.emit("error",v)}a.exports={destroy:function(m,v){var g=this,_=this._readableState&&this._readableState.destroyed,E=this._writableState&&this._writableState.destroyed;return _||E?(v?v(m):m&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,{env:{}}.nextTick(h,this,m)):{env:{}}.nextTick(h,this,m)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(m||null,function(b){!v&&b?g._writableState?g._writableState.errorEmitted?{env:{}}.nextTick(r,g):(g._writableState.errorEmitted=!0,{env:{}}.nextTick(l,g,b)):{env:{}}.nextTick(l,g,b):v?({env:{}}.nextTick(r,g),v(b)):{env:{}}.nextTick(r,g)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(m,v){var g=m._readableState,_=m._writableState;g&&g.autoDestroy||_&&_.autoDestroy?m.destroy(v):m.emit("error",v)}}},7155:(a,l,r)=>{var h=r(8442).q.ERR_STREAM_PREMATURE_CLOSE;function m(){}a.exports=function v(g,_,E){if(typeof _=="function")return v(g,null,_);_||(_={}),E=function(M){var L=!1;return function(){if(!L){L=!0;for(var W=arguments.length,G=new Array(W),re=0;re<W;re++)G[re]=arguments[re];M.apply(this,G)}}}(E||m);var b=_.readable||_.readable!==!1&&g.readable,p=_.writable||_.writable!==!1&&g.writable,x=function(){g.writable||f()},y=g._writableState&&g._writableState.finished,f=function(){p=!1,y=!0,b||E.call(g)},w=g._readableState&&g._readableState.endEmitted,A=function(){b=!1,w=!0,p||E.call(g)},P=function(M){E.call(g,M)},T=function(){var M;return b&&!w?(g._readableState&&g._readableState.ended||(M=new h),E.call(g,M)):p&&!y?(g._writableState&&g._writableState.ended||(M=new h),E.call(g,M)):void 0},R=function(){g.req.on("finish",f)};return function(M){return M.setHeader&&typeof M.abort=="function"}(g)?(g.on("complete",f),g.on("abort",T),g.req?R():g.on("request",R)):p&&!g._writableState&&(g.on("end",x),g.on("close",x)),g.on("end",A),g.on("finish",f),_.error!==!1&&g.on("error",P),g.on("close",T),function(){g.removeListener("complete",f),g.removeListener("abort",T),g.removeListener("request",R),g.req&&g.req.removeListener("finish",f),g.removeListener("end",x),g.removeListener("close",x),g.removeListener("finish",f),g.removeListener("end",A),g.removeListener("error",P),g.removeListener("close",T)}}},8271:a=>{a.exports=function(){throw new Error("Readable.from is not available in the browser")}},6420:(a,l,r)=>{var h,m=r(8442).q,v=m.ERR_MISSING_ARGS,g=m.ERR_STREAM_DESTROYED;function _(p){if(p)throw p}function E(p){p()}function b(p,x){return p.pipe(x)}a.exports=function(){for(var p=arguments.length,x=new Array(p),y=0;y<p;y++)x[y]=arguments[y];var f,w=function(P){return P.length?typeof P[P.length-1]!="function"?_:P.pop():_}(x);if(Array.isArray(x[0])&&(x=x[0]),x.length<2)throw new v("streams");var A=x.map(function(P,T){var R=T<x.length-1;return function(M,L,W,G){G=function(oe){var ae=!1;return function(){ae||(ae=!0,oe.apply(void 0,arguments))}}(G);var re=!1;M.on("close",function(){re=!0}),h===void 0&&(h=r(7155)),h(M,{readable:L,writable:W},function(oe){if(oe)return G(oe);re=!0,G()});var Q=!1;return function(oe){if(!re&&!Q)return Q=!0,function(ae){return ae.setHeader&&typeof ae.abort=="function"}(M)?M.abort():typeof M.destroy=="function"?M.destroy():void G(oe||new g("pipe"))}}(P,R,T>0,function(M){f||(f=M),M&&A.forEach(E),R||(A.forEach(E),w(f))})});return x.reduce(b)}},1441:(a,l,r)=>{var h=r(8442).q.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(m,v,g,_){var E=function(b,p,x){return b.highWaterMark!=null?b.highWaterMark:p?b[x]:null}(v,_,g);if(E!=null){if(!isFinite(E)||Math.floor(E)!==E||E<0)throw new h(_?g:"highWaterMark",E);return Math.floor(E)}return m.objectMode?16:16384}}},2289:(a,l,r)=>{a.exports=r(9620).EventEmitter},113:(a,l,r)=>{var h=r(4368).Buffer,m=h.isEncoding||function(w){switch((w=""+w)&&w.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function v(w){var A;switch(this.encoding=function(P){var T=function(R){if(!R)return"utf8";for(var M;;)switch(R){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return R;default:if(M)return;R=(""+R).toLowerCase(),M=!0}}(P);if(typeof T!="string"&&(h.isEncoding===m||!m(P)))throw new Error("Unknown encoding: "+P);return T||P}(w),this.encoding){case"utf16le":this.text=E,this.end=b,A=4;break;case"utf8":this.fillLast=_,A=4;break;case"base64":this.text=p,this.end=x,A=3;break;default:return this.write=y,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=h.allocUnsafe(A)}function g(w){return w<=127?0:w>>5==6?2:w>>4==14?3:w>>3==30?4:w>>6==2?-1:-2}function _(w){var A=this.lastTotal-this.lastNeed,P=function(T,R,M){if((192&R[0])!=128)return T.lastNeed=0,"�";if(T.lastNeed>1&&R.length>1){if((192&R[1])!=128)return T.lastNeed=1,"�";if(T.lastNeed>2&&R.length>2&&(192&R[2])!=128)return T.lastNeed=2,"�"}}(this,w);return P!==void 0?P:this.lastNeed<=w.length?(w.copy(this.lastChar,A,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(w.copy(this.lastChar,A,0,w.length),void(this.lastNeed-=w.length))}function E(w,A){if((w.length-A)%2==0){var P=w.toString("utf16le",A);if(P){var T=P.charCodeAt(P.length-1);if(T>=55296&&T<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1],P.slice(0,-1)}return P}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=w[w.length-1],w.toString("utf16le",A,w.length-1)}function b(w){var A=w&&w.length?this.write(w):"";if(this.lastNeed){var P=this.lastTotal-this.lastNeed;return A+this.lastChar.toString("utf16le",0,P)}return A}function p(w,A){var P=(w.length-A)%3;return P===0?w.toString("base64",A):(this.lastNeed=3-P,this.lastTotal=3,P===1?this.lastChar[0]=w[w.length-1]:(this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1]),w.toString("base64",A,w.length-P))}function x(w){var A=w&&w.length?this.write(w):"";return this.lastNeed?A+this.lastChar.toString("base64",0,3-this.lastNeed):A}function y(w){return w.toString(this.encoding)}function f(w){return w&&w.length?this.write(w):""}l.s=v,v.prototype.write=function(w){if(w.length===0)return"";var A,P;if(this.lastNeed){if((A=this.fillLast(w))===void 0)return"";P=this.lastNeed,this.lastNeed=0}else P=0;return P<w.length?A?A+this.text(w,P):this.text(w,P):A||""},v.prototype.end=function(w){var A=w&&w.length?this.write(w):"";return this.lastNeed?A+"�":A},v.prototype.text=function(w,A){var P=function(R,M,L){var W=M.length-1;if(W<L)return 0;var G=g(M[W]);return G>=0?(G>0&&(R.lastNeed=G-1),G):--W<L||G===-2?0:(G=g(M[W]))>=0?(G>0&&(R.lastNeed=G-2),G):--W<L||G===-2?0:(G=g(M[W]))>=0?(G>0&&(G===2?G=0:R.lastNeed=G-3),G):0}(this,w,A);if(!this.lastNeed)return w.toString("utf8",A);this.lastTotal=P;var T=w.length-(P-this.lastNeed);return w.copy(this.lastChar,0,T),w.toString("utf8",A,T)},v.prototype.fillLast=function(w){if(this.lastNeed<=w.length)return w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,w.length),this.lastNeed-=w.length}},4368:(a,l,r)=>{var h=r(365),m=h.Buffer;function v(_,E){for(var b in _)E[b]=_[b]}function g(_,E,b){return m(_,E,b)}m.from&&m.alloc&&m.allocUnsafe&&m.allocUnsafeSlow?a.exports=h:(v(h,l),l.Buffer=g),v(m,g),g.from=function(_,E,b){if(typeof _=="number")throw new TypeError("Argument must not be a number");return m(_,E,b)},g.alloc=function(_,E,b){if(typeof _!="number")throw new TypeError("Argument must be a number");var p=m(_);return E!==void 0?typeof b=="string"?p.fill(E,b):p.fill(E):p.fill(0),p},g.allocUnsafe=function(_){if(typeof _!="number")throw new TypeError("Argument must be a number");return m(_)},g.allocUnsafeSlow=function(_){if(typeof _!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(_)}},8016:(a,l,r)=>{function h(m){try{if(!r.g.localStorage)return!1}catch{return!1}var v=r.g.localStorage[m];return v!=null&&String(v).toLowerCase()==="true"}a.exports=function(m,v){if(h("noDeprecation"))return m;var g=!1;return function(){if(!g){if(h("throwDeprecation"))throw new Error(v);h("traceDeprecation")?console.trace(v):console.warn(v),g=!0}return m.apply(this,arguments)}}},8538:a=>{function l(r){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},l(r)}a.exports=function(r){return r&&l(r)==="object"&&typeof r.copy=="function"&&typeof r.fill=="function"&&typeof r.readUInt8=="function"}},9957:(a,l,r)=>{function h(H){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},h(H)}var m=r(2755),v=r(6738),g=r(1482),_=r(7913);function E(H){return H.call.bind(H)}var b=typeof BigInt<"u",p=typeof Symbol<"u",x=E(Object.prototype.toString),y=E(Number.prototype.valueOf),f=E(String.prototype.valueOf),w=E(Boolean.prototype.valueOf);if(b)var A=E(BigInt.prototype.valueOf);if(p)var P=E(Symbol.prototype.valueOf);function T(H,Y){if(h(H)!=="object")return!1;try{return Y(H),!0}catch{return!1}}function R(H){return x(H)==="[object Map]"}function M(H){return x(H)==="[object Set]"}function L(H){return x(H)==="[object WeakMap]"}function W(H){return x(H)==="[object WeakSet]"}function G(H){return x(H)==="[object ArrayBuffer]"}function re(H){return typeof ArrayBuffer<"u"&&(G.working?G(H):H instanceof ArrayBuffer)}function Q(H){return x(H)==="[object DataView]"}function oe(H){return typeof DataView<"u"&&(Q.working?Q(H):H instanceof DataView)}l.isArgumentsObject=m,l.isGeneratorFunction=v,l.isTypedArray=_,l.isPromise=function(H){return typeof Promise<"u"&&H instanceof Promise||H!==null&&h(H)==="object"&&typeof H.then=="function"&&typeof H.catch=="function"},l.isArrayBufferView=function(H){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(H):_(H)||oe(H)},l.isUint8Array=function(H){return g(H)==="Uint8Array"},l.isUint8ClampedArray=function(H){return g(H)==="Uint8ClampedArray"},l.isUint16Array=function(H){return g(H)==="Uint16Array"},l.isUint32Array=function(H){return g(H)==="Uint32Array"},l.isInt8Array=function(H){return g(H)==="Int8Array"},l.isInt16Array=function(H){return g(H)==="Int16Array"},l.isInt32Array=function(H){return g(H)==="Int32Array"},l.isFloat32Array=function(H){return g(H)==="Float32Array"},l.isFloat64Array=function(H){return g(H)==="Float64Array"},l.isBigInt64Array=function(H){return g(H)==="BigInt64Array"},l.isBigUint64Array=function(H){return g(H)==="BigUint64Array"},R.working=typeof Map<"u"&&R(new Map),l.isMap=function(H){return typeof Map<"u"&&(R.working?R(H):H instanceof Map)},M.working=typeof Set<"u"&&M(new Set),l.isSet=function(H){return typeof Set<"u"&&(M.working?M(H):H instanceof Set)},L.working=typeof WeakMap<"u"&&L(new WeakMap),l.isWeakMap=function(H){return typeof WeakMap<"u"&&(L.working?L(H):H instanceof WeakMap)},W.working=typeof WeakSet<"u"&&W(new WeakSet),l.isWeakSet=function(H){return W(H)},G.working=typeof ArrayBuffer<"u"&&G(new ArrayBuffer),l.isArrayBuffer=re,Q.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Q(new DataView(new ArrayBuffer(1),0,1)),l.isDataView=oe;var ae=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function de(H){return x(H)==="[object SharedArrayBuffer]"}function be(H){return ae!==void 0&&(de.working===void 0&&(de.working=de(new ae)),de.working?de(H):H instanceof ae)}function pe(H){return T(H,y)}function U(H){return T(H,f)}function B(H){return T(H,w)}function N(H){return b&&T(H,A)}function z(H){return p&&T(H,P)}l.isSharedArrayBuffer=be,l.isAsyncFunction=function(H){return x(H)==="[object AsyncFunction]"},l.isMapIterator=function(H){return x(H)==="[object Map Iterator]"},l.isSetIterator=function(H){return x(H)==="[object Set Iterator]"},l.isGeneratorObject=function(H){return x(H)==="[object Generator]"},l.isWebAssemblyCompiledModule=function(H){return x(H)==="[object WebAssembly.Module]"},l.isNumberObject=pe,l.isStringObject=U,l.isBooleanObject=B,l.isBigIntObject=N,l.isSymbolObject=z,l.isBoxedPrimitive=function(H){return pe(H)||U(H)||B(H)||N(H)||z(H)},l.isAnyArrayBuffer=function(H){return typeof Uint8Array<"u"&&(re(H)||be(H))},["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(H){Object.defineProperty(l,H,{enumerable:!1,value:function(){throw new Error(H+" is not supported in userland")}})})},8751:(a,l,r)=>{function h(N){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},h(N)}var m=Object.getOwnPropertyDescriptors||function(N){for(var z=Object.keys(N),H={},Y=0;Y<z.length;Y++)H[z[Y]]=Object.getOwnPropertyDescriptor(N,z[Y]);return H},v=/%[sdj%]/g;l.format=function(N){if(!M(N)){for(var z=[],H=0;H<arguments.length;H++)z.push(b(arguments[H]));return z.join(" ")}H=1;for(var Y=arguments,fe=Y.length,Re=String(N).replace(v,function(De){if(De==="%%")return"%";if(H>=fe)return De;switch(De){case"%s":return String(Y[H++]);case"%d":return Number(Y[H++]);case"%j":try{return JSON.stringify(Y[H++])}catch{return"[Circular]"}default:return De}}),Oe=Y[H];H<fe;Oe=Y[++H])T(Oe)||!G(Oe)?Re+=" "+Oe:Re+=" "+b(Oe);return Re},l.deprecate=function(N,z){if({env:{}}!==void 0&&{env:{}}.noDeprecation===!0)return N;if({env:{}}===void 0)return function(){return l.deprecate(N,z).apply(this,arguments)};var H=!1;return function(){if(!H){if({env:{}}.throwDeprecation)throw new Error(z);({env:{}}).traceDeprecation?console.trace(z):console.error(z),H=!0}return N.apply(this,arguments)}};var g={},_=/^$/;if({}.NODE_DEBUG){var E={}.NODE_DEBUG;E=E.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),_=new RegExp("^"+E+"$","i")}function b(N,z){var H={seen:[],stylize:x};return arguments.length>=3&&(H.depth=arguments[2]),arguments.length>=4&&(H.colors=arguments[3]),P(z)?H.showHidden=z:z&&l._extend(H,z),L(H.showHidden)&&(H.showHidden=!1),L(H.depth)&&(H.depth=2),L(H.colors)&&(H.colors=!1),L(H.customInspect)&&(H.customInspect=!0),H.colors&&(H.stylize=p),y(H,N,H.depth)}function p(N,z){var H=b.styles[z];return H?"\x1B["+b.colors[H][0]+"m"+N+"\x1B["+b.colors[H][1]+"m":N}function x(N,z){return N}function y(N,z,H){if(N.customInspect&&z&&oe(z.inspect)&&z.inspect!==l.inspect&&(!z.constructor||z.constructor.prototype!==z)){var Y=z.inspect(H,N);return M(Y)||(Y=y(N,Y,H)),Y}var fe=function(Be,se){if(L(se))return Be.stylize("undefined","undefined");if(M(se)){var _e="'"+JSON.stringify(se).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Be.stylize(_e,"string")}return R(se)?Be.stylize(""+se,"number"):P(se)?Be.stylize(""+se,"boolean"):T(se)?Be.stylize("null","null"):void 0}(N,z);if(fe)return fe;var Re=Object.keys(z),Oe=function(Be){var se={};return Be.forEach(function(_e,te){se[_e]=!0}),se}(Re);if(N.showHidden&&(Re=Object.getOwnPropertyNames(z)),Q(z)&&(Re.indexOf("message")>=0||Re.indexOf("description")>=0))return f(z);if(Re.length===0){if(oe(z)){var De=z.name?": "+z.name:"";return N.stylize("[Function"+De+"]","special")}if(W(z))return N.stylize(RegExp.prototype.toString.call(z),"regexp");if(re(z))return N.stylize(Date.prototype.toString.call(z),"date");if(Q(z))return f(z)}var ot,X="",ee=!1,Le=["{","}"];return A(z)&&(ee=!0,Le=["[","]"]),oe(z)&&(X=" [Function"+(z.name?": "+z.name:"")+"]"),W(z)&&(X=" "+RegExp.prototype.toString.call(z)),re(z)&&(X=" "+Date.prototype.toUTCString.call(z)),Q(z)&&(X=" "+f(z)),Re.length!==0||ee&&z.length!=0?H<0?W(z)?N.stylize(RegExp.prototype.toString.call(z),"regexp"):N.stylize("[Object]","special"):(N.seen.push(z),ot=ee?function(Be,se,_e,te,$e){for(var ge=[],le=0,ze=se.length;le<ze;++le)pe(se,String(le))?ge.push(w(Be,se,_e,te,String(le),!0)):ge.push("");return $e.forEach(function(Je){Je.match(/^\d+$/)||ge.push(w(Be,se,_e,te,Je,!0))}),ge}(N,z,H,Oe,Re):Re.map(function(Be){return w(N,z,H,Oe,Be,ee)}),N.seen.pop(),function(Be,se,_e){return Be.reduce(function(te,$e){return $e.indexOf(`
`),te+$e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?_e[0]+(se===""?"":se+`
 `)+" "+Be.join(`,
  `)+" "+_e[1]:_e[0]+se+" "+Be.join(", ")+" "+_e[1]}(ot,X,Le)):Le[0]+X+Le[1]}function f(N){return"["+Error.prototype.toString.call(N)+"]"}function w(N,z,H,Y,fe,Re){var Oe,De,ot;if((ot=Object.getOwnPropertyDescriptor(z,fe)||{value:z[fe]}).get?De=ot.set?N.stylize("[Getter/Setter]","special"):N.stylize("[Getter]","special"):ot.set&&(De=N.stylize("[Setter]","special")),pe(Y,fe)||(Oe="["+fe+"]"),De||(N.seen.indexOf(ot.value)<0?(De=T(H)?y(N,ot.value,null):y(N,ot.value,H-1)).indexOf(`
`)>-1&&(De=Re?De.split(`
`).map(function(X){return"  "+X}).join(`
`).slice(2):`
`+De.split(`
`).map(function(X){return"   "+X}).join(`
`)):De=N.stylize("[Circular]","special")),L(Oe)){if(Re&&fe.match(/^\d+$/))return De;(Oe=JSON.stringify(""+fe)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Oe=Oe.slice(1,-1),Oe=N.stylize(Oe,"name")):(Oe=Oe.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Oe=N.stylize(Oe,"string"))}return Oe+": "+De}function A(N){return Array.isArray(N)}function P(N){return typeof N=="boolean"}function T(N){return N===null}function R(N){return typeof N=="number"}function M(N){return typeof N=="string"}function L(N){return N===void 0}function W(N){return G(N)&&ae(N)==="[object RegExp]"}function G(N){return h(N)==="object"&&N!==null}function re(N){return G(N)&&ae(N)==="[object Date]"}function Q(N){return G(N)&&(ae(N)==="[object Error]"||N instanceof Error)}function oe(N){return typeof N=="function"}function ae(N){return Object.prototype.toString.call(N)}function de(N){return N<10?"0"+N.toString(10):N.toString(10)}l.debuglog=function(N){if(N=N.toUpperCase(),!g[N])if(_.test(N)){var z={env:{}}.pid;g[N]=function(){var H=l.format.apply(l,arguments);console.error("%s %d: %s",N,z,H)}}else g[N]=function(){};return g[N]},l.inspect=b,b.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},b.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},l.types=r(9957),l.isArray=A,l.isBoolean=P,l.isNull=T,l.isNullOrUndefined=function(N){return N==null},l.isNumber=R,l.isString=M,l.isSymbol=function(N){return h(N)==="symbol"},l.isUndefined=L,l.isRegExp=W,l.types.isRegExp=W,l.isObject=G,l.isDate=re,l.types.isDate=re,l.isError=Q,l.types.isNativeError=Q,l.isFunction=oe,l.isPrimitive=function(N){return N===null||typeof N=="boolean"||typeof N=="number"||typeof N=="string"||h(N)==="symbol"||N===void 0},l.isBuffer=r(8538);var be=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function pe(N,z){return Object.prototype.hasOwnProperty.call(N,z)}l.log=function(){var N,z;console.log("%s - %s",(z=[de((N=new Date).getHours()),de(N.getMinutes()),de(N.getSeconds())].join(":"),[N.getDate(),be[N.getMonth()],z].join(" ")),l.format.apply(l,arguments))},l.inherits=r(376),l._extend=function(N,z){if(!z||!G(z))return N;for(var H=Object.keys(z),Y=H.length;Y--;)N[H[Y]]=z[H[Y]];return N};var U=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;function B(N,z){if(!N){var H=new Error("Promise was rejected with a falsy value");H.reason=N,N=H}return z(N)}l.promisify=function(N){if(typeof N!="function")throw new TypeError('The "original" argument must be of type Function');if(U&&N[U]){var z;if(typeof(z=N[U])!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(z,U,{value:z,enumerable:!1,writable:!1,configurable:!0}),z}function z(){for(var H,Y,fe=new Promise(function(De,ot){H=De,Y=ot}),Re=[],Oe=0;Oe<arguments.length;Oe++)Re.push(arguments[Oe]);Re.push(function(De,ot){De?Y(De):H(ot)});try{N.apply(this,Re)}catch(De){Y(De)}return fe}return Object.setPrototypeOf(z,Object.getPrototypeOf(N)),U&&Object.defineProperty(z,U,{value:z,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(z,m(N))},l.promisify.custom=U,l.callbackify=function(N){if(typeof N!="function")throw new TypeError('The "original" argument must be of type Function');function z(){for(var H=[],Y=0;Y<arguments.length;Y++)H.push(arguments[Y]);var fe=H.pop();if(typeof fe!="function")throw new TypeError("The last argument must be of type Function");var Re=this,Oe=function(){return fe.apply(Re,arguments)};N.apply(this,H).then(function(De){({env:{}}).nextTick(Oe.bind(null,null,De))},function(De){({env:{}}).nextTick(B.bind(null,De,Oe))})}return Object.setPrototypeOf(z,Object.getPrototypeOf(N)),Object.defineProperties(z,m(N)),z}},1482:(a,l,r)=>{function h(T){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},h(T)}var m=r(5337),v=r(6461),g=r(3862),_=r(8780),E=r(1554),b=_("Object.prototype.toString"),p=r(5994)(),x=typeof globalThis>"u"?r.g:globalThis,y=v(),f=_("String.prototype.slice"),w=Object.getPrototypeOf,A=_("Array.prototype.indexOf",!0)||function(T,R){for(var M=0;M<T.length;M+=1)if(T[M]===R)return M;return-1},P={__proto__:null};m(y,p&&E&&w?function(T){var R=new x[T];if(Symbol.toStringTag in R){var M=w(R),L=E(M,Symbol.toStringTag);if(!L){var W=w(M);L=E(W,Symbol.toStringTag)}P["$"+T]=g(L.get)}}:function(T){var R=new x[T],M=R.slice||R.set;M&&(P["$"+T]=g(M))}),a.exports=function(T){if(!T||h(T)!=="object")return!1;if(!p){var R=f(b(T),8,-1);return A(y,R)>-1?R:R==="Object"&&function(M){var L=!1;return m(P,function(W,G){if(!L)try{W(M),L=f(G,1)}catch{}}),L}(T)}return E?function(M){var L=!1;return m(P,function(W,G){if(!L)try{"$"+W(M)===G&&(L=f(G,1))}catch{}}),L}(T):null}},6601:()=>{},9214:()=>{},6419:()=>{},6353:()=>{},9386:()=>{},1616:()=>{},9862:()=>{},964:()=>{},6461:(a,l,r)=>{var h=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],m=typeof globalThis>"u"?r.g:globalThis;a.exports=function(){for(var v=[],g=0;g<h.length;g++)typeof m[h[g]]=="function"&&(v[v.length]=h[g]);return v}},4029:(a,l,r)=>{var Lt;var h=r(365).Buffer;function m(Z){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(Z))}function v(Z){return Object.prototype.toString.call(Z)==="[object Uint8Array]"}function g(Z){return Object.prototype.toString.call(Z)==="[object RegExp]"}function _(Z){return Object.prototype.toString.call(Z)==="[object Map]"}function E(Z){return Object.prototype.toString.call(Z)==="[object Date]"}function b(Z,q){return JSON.stringify(Z,(Ee,ye)=>typeof ye=="bigint"?{$numberLong:`${ye}`}:_(ye)?Object.fromEntries(ye):ye)}const p=6,x=2147483647,y=-2147483648,f=Math.pow(2,63)-1,w=-Math.pow(2,63),A=Math.pow(2,53),P=-Math.pow(2,53),T=1,R=2,M=3,L=4,W=5,G=6,re=7,Q=8,oe=9,ae=10,de=11,be=12,pe=13,U=14,B=15,N=16,z=17,H=18,Y=19,fe=255,Re=127,Oe=0,De=4,ot=Object.freeze({double:1,string:2,object:3,array:4,binData:5,undefined:6,objectId:7,bool:8,date:9,null:10,regex:11,dbPointer:12,javascript:13,symbol:14,javascriptWithScope:15,int:16,timestamp:17,long:18,decimal:19,minKey:-1,maxKey:127});class X extends Error{get bsonError(){return!0}get name(){return"BSONError"}constructor(q){super(q)}static isBSONError(q){return q!=null&&typeof q=="object"&&"bsonError"in q&&q.bsonError===!0&&"name"in q&&"message"in q&&"stack"in q}}class ee extends X{get name(){return"BSONVersionError"}constructor(){super(`Unsupported BSON version, bson types must be from bson ${p}.x.x`)}}class Le extends X{get name(){return"BSONRuntimeError"}constructor(q){super(q)}}function Be(Z){return se.fromNumberArray(Array.from({length:Z},()=>Math.floor(256*Math.random())))}const se={toLocalBufferType(Z){if(h.isBuffer(Z))return Z;if(ArrayBuffer.isView(Z))return h.from(Z.buffer,Z.byteOffset,Z.byteLength);const q=(Z==null?void 0:Z[Symbol.toStringTag])??Object.prototype.toString.call(Z);if(q==="ArrayBuffer"||q==="SharedArrayBuffer"||q==="[object ArrayBuffer]"||q==="[object SharedArrayBuffer]")return h.from(Z);throw new X(`Cannot create Buffer from ${String(Z)}`)},allocate:Z=>h.alloc(Z),equals:(Z,q)=>se.toLocalBufferType(Z).equals(q),fromNumberArray:Z=>h.from(Z),fromBase64:Z=>h.from(Z,"base64"),toBase64:Z=>se.toLocalBufferType(Z).toString("base64"),fromISO88591:Z=>h.from(Z,"binary"),toISO88591:Z=>se.toLocalBufferType(Z).toString("binary"),fromHex:Z=>h.from(Z,"hex"),toHex:Z=>se.toLocalBufferType(Z).toString("hex"),fromUTF8:Z=>h.from(Z,"utf8"),toUTF8:(Z,q,Ee)=>se.toLocalBufferType(Z).toString("utf8",q,Ee),utf8ByteLength:Z=>h.byteLength(Z,"utf8"),encodeUTF8Into:(Z,q,Ee)=>se.toLocalBufferType(Z).write(q,Ee,void 0,"utf8"),randomBytes:(()=>{try{return r(462).O6}catch{return Be}})()};function _e(Z){if(Z<0)throw new RangeError(`The argument 'byteLength' is invalid. Received ${Z}`);return ge.fromNumberArray(Array.from({length:Z},()=>Math.floor(256*Math.random())))}const te=(()=>{var q;const{crypto:Z}=globalThis;if(Z!=null&&typeof Z.getRandomValues=="function")return Ee=>Z.getRandomValues(ge.allocate(Ee));if(function(){const{navigator:Ee}=globalThis;return typeof Ee=="object"&&Ee.product==="ReactNative"}()){const{console:Ee}=globalThis;(q=Ee==null?void 0:Ee.warn)==null||q.call(Ee,"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return _e})(),$e=/(\d|[a-f])/i,ge={toLocalBufferType(Z){const q=(Z==null?void 0:Z[Symbol.toStringTag])??Object.prototype.toString.call(Z);if(q==="Uint8Array")return Z;if(ArrayBuffer.isView(Z))return new Uint8Array(Z.buffer.slice(Z.byteOffset,Z.byteOffset+Z.byteLength));if(q==="ArrayBuffer"||q==="SharedArrayBuffer"||q==="[object ArrayBuffer]"||q==="[object SharedArrayBuffer]")return new Uint8Array(Z);throw new X(`Cannot make a Uint8Array from ${String(Z)}`)},allocate(Z){if(typeof Z!="number")throw new TypeError(`The "size" argument must be of type number. Received ${String(Z)}`);return new Uint8Array(Z)},equals(Z,q){if(Z.byteLength!==q.byteLength)return!1;for(let Ee=0;Ee<Z.byteLength;Ee++)if(Z[Ee]!==q[Ee])return!1;return!0},fromNumberArray:Z=>Uint8Array.from(Z),fromBase64:Z=>Uint8Array.from(atob(Z),q=>q.charCodeAt(0)),toBase64:Z=>btoa(ge.toISO88591(Z)),fromISO88591:Z=>Uint8Array.from(Z,q=>255&q.charCodeAt(0)),toISO88591:Z=>Array.from(Uint16Array.from(Z),q=>String.fromCharCode(q)).join(""),fromHex(Z){const q=Z.length%2==0?Z:Z.slice(0,Z.length-1),Ee=[];for(let ye=0;ye<q.length;ye+=2){const it=q[ye],st=q[ye+1];if(!$e.test(it)||!$e.test(st))break;const At=Number.parseInt(`${it}${st}`,16);Ee.push(At)}return Uint8Array.from(Ee)},toHex:Z=>Array.from(Z,q=>q.toString(16).padStart(2,"0")).join(""),fromUTF8:Z=>new TextEncoder().encode(Z),toUTF8:(Z,q,Ee)=>new TextDecoder("utf8",{fatal:!1}).decode(Z.slice(q,Ee)),utf8ByteLength:Z=>ge.fromUTF8(Z).byteLength,encodeUTF8Into(Z,q,Ee){const ye=ge.fromUTF8(q);return Z.set(ye,Ee),ye.byteLength},randomBytes:te},le=typeof h=="function"&&((Lt=h.prototype)==null?void 0:Lt._isBuffer)!==!0?se:ge;class ze extends DataView{static fromUint8Array(q){return new DataView(q.buffer,q.byteOffset,q.byteLength)}}class Je{get[Symbol.for("@@mdb.bson.version")](){return p}[Symbol.for("nodejs.util.inspect.custom")](q,Ee,ye){return this.inspect(q,Ee,ye)}}class et extends Je{get _bsontype(){return"Binary"}constructor(q,Ee){if(super(),q!=null&&typeof q=="string"&&!ArrayBuffer.isView(q)&&!m(q)&&!Array.isArray(q))throw new X("Binary can only be constructed from Uint8Array or number[]");this.sub_type=Ee??et.BSON_BINARY_SUBTYPE_DEFAULT,q==null?(this.buffer=le.allocate(et.BUFFER_SIZE),this.position=0):(this.buffer=Array.isArray(q)?le.fromNumberArray(q):le.toLocalBufferType(q),this.position=this.buffer.byteLength)}put(q){if(typeof q=="string"&&q.length!==1)throw new X("only accepts single character String");if(typeof q!="number"&&q.length!==1)throw new X("only accepts single character Uint8Array or Array");let Ee;if(Ee=typeof q=="string"?q.charCodeAt(0):typeof q=="number"?q:q[0],Ee<0||Ee>255)throw new X("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.byteLength>this.position)this.buffer[this.position++]=Ee;else{const ye=le.allocate(et.BUFFER_SIZE+this.buffer.length);ye.set(this.buffer,0),this.buffer=ye,this.buffer[this.position++]=Ee}}write(q,Ee){if(Ee=typeof Ee=="number"?Ee:this.position,this.buffer.byteLength<Ee+q.length){const ye=le.allocate(this.buffer.byteLength+q.length);ye.set(this.buffer,0),this.buffer=ye}if(ArrayBuffer.isView(q))this.buffer.set(le.toLocalBufferType(q),Ee),this.position=Ee+q.byteLength>this.position?Ee+q.length:this.position;else if(typeof q=="string")throw new X("input cannot be string")}read(q,Ee){return Ee=Ee&&Ee>0?Ee:this.position,this.buffer.slice(q,q+Ee)}value(){return this.buffer.length===this.position?this.buffer:this.buffer.subarray(0,this.position)}length(){return this.position}toJSON(){return le.toBase64(this.buffer)}toString(q){return q==="hex"?le.toHex(this.buffer):q==="base64"?le.toBase64(this.buffer):le.toUTF8(this.buffer,0,this.buffer.byteLength)}toExtendedJSON(q){q=q||{};const Ee=le.toBase64(this.buffer),ye=Number(this.sub_type).toString(16);return q.legacy?{$binary:Ee,$type:ye.length===1?"0"+ye:ye}:{$binary:{base64:Ee,subType:ye.length===1?"0"+ye:ye}}}toUUID(){if(this.sub_type===et.SUBTYPE_UUID)return new It(this.buffer.slice(0,this.position));throw new X(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${et.SUBTYPE_UUID}" is currently supported.`)}static createFromHexString(q,Ee){return new et(le.fromHex(q),Ee)}static createFromBase64(q,Ee){return new et(le.fromBase64(q),Ee)}static fromExtendedJSON(q,Ee){let ye,it;if(Ee=Ee||{},"$binary"in q?Ee.legacy&&typeof q.$binary=="string"&&"$type"in q?(it=q.$type?parseInt(q.$type,16):0,ye=le.fromBase64(q.$binary)):typeof q.$binary!="string"&&(it=q.$binary.subType?parseInt(q.$binary.subType,16):0,ye=le.fromBase64(q.$binary.base64)):"$uuid"in q&&(it=4,ye=It.bytesFromString(q.$uuid)),!ye)throw new X(`Unexpected Binary Extended JSON format ${JSON.stringify(q)}`);return it===De?new It(ye):new et(ye,it)}inspect(q,Ee,ye){return ye??(ye=b),`Binary.createFromBase64(${ye(le.toBase64(this.buffer.subarray(0,this.position)),Ee)}, ${ye(this.sub_type,Ee)})`}}et.BSON_BINARY_SUBTYPE_DEFAULT=0,et.BUFFER_SIZE=256,et.SUBTYPE_DEFAULT=0,et.SUBTYPE_FUNCTION=1,et.SUBTYPE_BYTE_ARRAY=2,et.SUBTYPE_UUID_OLD=3,et.SUBTYPE_UUID=4,et.SUBTYPE_MD5=5,et.SUBTYPE_ENCRYPTED=6,et.SUBTYPE_COLUMN=7,et.SUBTYPE_USER_DEFINED=128;const ft=/^[0-9A-F]{32}$/i,wt=/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i;class It extends et{constructor(q){let Ee;if(q==null)Ee=It.generate();else if(q instanceof It)Ee=le.toLocalBufferType(new Uint8Array(q.buffer));else if(ArrayBuffer.isView(q)&&q.byteLength===16)Ee=le.toLocalBufferType(q);else{if(typeof q!="string")throw new X("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");Ee=It.bytesFromString(q)}super(Ee,De)}get id(){return this.buffer}set id(q){this.buffer=q}toHexString(q=!0){return q?[le.toHex(this.buffer.subarray(0,4)),le.toHex(this.buffer.subarray(4,6)),le.toHex(this.buffer.subarray(6,8)),le.toHex(this.buffer.subarray(8,10)),le.toHex(this.buffer.subarray(10,16))].join("-"):le.toHex(this.buffer)}toString(q){return q==="hex"?le.toHex(this.id):q==="base64"?le.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}equals(q){if(!q)return!1;if(q instanceof It)return le.equals(q.id,this.id);try{return le.equals(new It(q).id,this.id)}catch{return!1}}toBinary(){return new et(this.id,et.SUBTYPE_UUID)}static generate(){const q=le.randomBytes(16);return q[6]=15&q[6]|64,q[8]=63&q[8]|128,q}static isValid(q){return!!q&&(typeof q=="string"?It.isValidUUIDString(q):v(q)?q.byteLength===16:q._bsontype==="Binary"&&q.sub_type===this.SUBTYPE_UUID&&q.buffer.byteLength===16)}static createFromHexString(q){const Ee=It.bytesFromString(q);return new It(Ee)}static createFromBase64(q){return new It(le.fromBase64(q))}static bytesFromString(q){if(!It.isValidUUIDString(q))throw new X("UUID string representation must be 32 hex digits or canonical hyphenated representation");return le.fromHex(q.replace(/-/g,""))}static isValidUUIDString(q){return ft.test(q)||wt.test(q)}inspect(q,Ee,ye){return ye??(ye=b),`new UUID(${ye(this.toHexString(),Ee)})`}}class Ct extends Je{get _bsontype(){return"Code"}constructor(q,Ee){super(),this.code=q.toString(),this.scope=Ee??null}toJSON(){return this.scope!=null?{code:this.code,scope:this.scope}:{code:this.code}}toExtendedJSON(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}static fromExtendedJSON(q){return new Ct(q.$code,q.$scope)}inspect(q,Ee,ye){ye??(ye=b);let it=ye(this.code,Ee);const st=it.includes(`
`);return this.scope!=null&&(it+=`,${st?`
`:" "}${ye(this.scope,Ee)}`),`new Code(${st?`
`:""}${it}${st&&this.scope===null?`
`:""})`}}function tn(Z){return Z!=null&&typeof Z=="object"&&"$id"in Z&&Z.$id!=null&&"$ref"in Z&&typeof Z.$ref=="string"&&(!("$db"in Z)||"$db"in Z&&typeof Z.$db=="string")}class xt extends Je{get _bsontype(){return"DBRef"}constructor(q,Ee,ye,it){super();const st=q.split(".");st.length===2&&(ye=st.shift(),q=st.shift()),this.collection=q,this.oid=Ee,this.db=ye,this.fields=it||{}}get namespace(){return this.collection}set namespace(q){this.collection=q}toJSON(){const q=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(q.$db=this.db),q}toExtendedJSON(q){q=q||{};let Ee={$ref:this.collection,$id:this.oid};return q.legacy||(this.db&&(Ee.$db=this.db),Ee=Object.assign(Ee,this.fields)),Ee}static fromExtendedJSON(q){const Ee=Object.assign({},q);return delete Ee.$ref,delete Ee.$id,delete Ee.$db,new xt(q.$ref,q.$id,q.$db,Ee)}inspect(q,Ee,ye){ye??(ye=b);const it=[ye(this.namespace,Ee),ye(this.oid,Ee),...this.db?[ye(this.db,Ee)]:[],...Object.keys(this.fields).length>0?[ye(this.fields,Ee)]:[]];return it[1]=ye===b?`new ObjectId(${it[1]})`:it[1],`new DBRef(${it.join(", ")})`}}let Ht;try{Ht=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}const en=4294967296,kn=18446744073709552e3,Dn=kn/2,Ft={},Tt={},rn=/^(\+?0|(\+|-)?[1-9][0-9]*)$/;class dt extends Je{get _bsontype(){return"Long"}get __isLong__(){return!0}constructor(q=0,Ee,ye){super(),typeof q=="bigint"?Object.assign(this,dt.fromBigInt(q,!!Ee)):typeof q=="string"?Object.assign(this,dt.fromString(q,!!Ee)):(this.low=0|q,this.high=0|Ee,this.unsigned=!!ye)}static fromBits(q,Ee,ye){return new dt(q,Ee,ye)}static fromInt(q,Ee){let ye,it,st;return Ee?(st=0<=(q>>>=0)&&q<256)&&(it=Tt[q],it)?it:(ye=dt.fromBits(q,(0|q)<0?-1:0,!0),st&&(Tt[q]=ye),ye):(st=-128<=(q|=0)&&q<128)&&(it=Ft[q],it)?it:(ye=dt.fromBits(q,q<0?-1:0,!1),st&&(Ft[q]=ye),ye)}static fromNumber(q,Ee){if(isNaN(q))return Ee?dt.UZERO:dt.ZERO;if(Ee){if(q<0)return dt.UZERO;if(q>=kn)return dt.MAX_UNSIGNED_VALUE}else{if(q<=-Dn)return dt.MIN_VALUE;if(q+1>=Dn)return dt.MAX_VALUE}return q<0?dt.fromNumber(-q,Ee).neg():dt.fromBits(q%en|0,q/en|0,Ee)}static fromBigInt(q,Ee){return dt.fromString(q.toString(),Ee)}static fromString(q,Ee,ye){if(q.length===0)throw new X("empty string");if(q==="NaN"||q==="Infinity"||q==="+Infinity"||q==="-Infinity")return dt.ZERO;if(typeof Ee=="number"?(ye=Ee,Ee=!1):Ee=!!Ee,(ye=ye||10)<2||36<ye)throw new X("radix");let it;if((it=q.indexOf("-"))>0)throw new X("interior hyphen");if(it===0)return dt.fromString(q.substring(1),Ee,ye).neg();const st=dt.fromNumber(Math.pow(ye,8));let At=dt.ZERO;for(let qt=0;qt<q.length;qt+=8){const gt=Math.min(8,q.length-qt),Xt=parseInt(q.substring(qt,qt+gt),ye);if(gt<8){const Vt=dt.fromNumber(Math.pow(ye,gt));At=At.mul(Vt).add(dt.fromNumber(Xt))}else At=At.mul(st),At=At.add(dt.fromNumber(Xt))}return At.unsigned=Ee,At}static fromBytes(q,Ee,ye){return ye?dt.fromBytesLE(q,Ee):dt.fromBytesBE(q,Ee)}static fromBytesLE(q,Ee){return new dt(q[0]|q[1]<<8|q[2]<<16|q[3]<<24,q[4]|q[5]<<8|q[6]<<16|q[7]<<24,Ee)}static fromBytesBE(q,Ee){return new dt(q[4]<<24|q[5]<<16|q[6]<<8|q[7],q[0]<<24|q[1]<<16|q[2]<<8|q[3],Ee)}static isLong(q){return q!=null&&typeof q=="object"&&"__isLong__"in q&&q.__isLong__===!0}static fromValue(q,Ee){return typeof q=="number"?dt.fromNumber(q,Ee):typeof q=="string"?dt.fromString(q,Ee):dt.fromBits(q.low,q.high,typeof Ee=="boolean"?Ee:q.unsigned)}add(q){dt.isLong(q)||(q=dt.fromValue(q));const Ee=this.high>>>16,ye=65535&this.high,it=this.low>>>16,st=65535&this.low,At=q.high>>>16,qt=65535&q.high,gt=q.low>>>16;let Xt=0,Vt=0,Ot=0,Ut=0;return Ut+=st+(65535&q.low),Ot+=Ut>>>16,Ut&=65535,Ot+=it+gt,Vt+=Ot>>>16,Ot&=65535,Vt+=ye+qt,Xt+=Vt>>>16,Vt&=65535,Xt+=Ee+At,Xt&=65535,dt.fromBits(Ot<<16|Ut,Xt<<16|Vt,this.unsigned)}and(q){return dt.isLong(q)||(q=dt.fromValue(q)),dt.fromBits(this.low&q.low,this.high&q.high,this.unsigned)}compare(q){if(dt.isLong(q)||(q=dt.fromValue(q)),this.eq(q))return 0;const Ee=this.isNegative(),ye=q.isNegative();return Ee&&!ye?-1:!Ee&&ye?1:this.unsigned?q.high>>>0>this.high>>>0||q.high===this.high&&q.low>>>0>this.low>>>0?-1:1:this.sub(q).isNegative()?-1:1}comp(q){return this.compare(q)}divide(q){if(dt.isLong(q)||(q=dt.fromValue(q)),q.isZero())throw new X("division by zero");if(Ht){if(!this.unsigned&&this.high===-2147483648&&q.low===-1&&q.high===-1)return this;const st=(this.unsigned?Ht.div_u:Ht.div_s)(this.low,this.high,q.low,q.high);return dt.fromBits(st,Ht.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?dt.UZERO:dt.ZERO;let Ee,ye,it;if(this.unsigned){if(q.unsigned||(q=q.toUnsigned()),q.gt(this))return dt.UZERO;if(q.gt(this.shru(1)))return dt.UONE;it=dt.UZERO}else{if(this.eq(dt.MIN_VALUE))return q.eq(dt.ONE)||q.eq(dt.NEG_ONE)?dt.MIN_VALUE:q.eq(dt.MIN_VALUE)?dt.ONE:(Ee=this.shr(1).div(q).shl(1),Ee.eq(dt.ZERO)?q.isNegative()?dt.ONE:dt.NEG_ONE:(ye=this.sub(q.mul(Ee)),it=Ee.add(ye.div(q)),it));if(q.eq(dt.MIN_VALUE))return this.unsigned?dt.UZERO:dt.ZERO;if(this.isNegative())return q.isNegative()?this.neg().div(q.neg()):this.neg().div(q).neg();if(q.isNegative())return this.div(q.neg()).neg();it=dt.ZERO}for(ye=this;ye.gte(q);){Ee=Math.max(1,Math.floor(ye.toNumber()/q.toNumber()));const st=Math.ceil(Math.log(Ee)/Math.LN2),At=st<=48?1:Math.pow(2,st-48);let qt=dt.fromNumber(Ee),gt=qt.mul(q);for(;gt.isNegative()||gt.gt(ye);)Ee-=At,qt=dt.fromNumber(Ee,this.unsigned),gt=qt.mul(q);qt.isZero()&&(qt=dt.ONE),it=it.add(qt),ye=ye.sub(gt)}return it}div(q){return this.divide(q)}equals(q){return dt.isLong(q)||(q=dt.fromValue(q)),(this.unsigned===q.unsigned||this.high>>>31!=1||q.high>>>31!=1)&&this.high===q.high&&this.low===q.low}eq(q){return this.equals(q)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.eq(dt.MIN_VALUE)?64:this.neg().getNumBitsAbs();const q=this.high!==0?this.high:this.low;let Ee;for(Ee=31;Ee>0&&!(q&1<<Ee);Ee--);return this.high!==0?Ee+33:Ee+1}greaterThan(q){return this.comp(q)>0}gt(q){return this.greaterThan(q)}greaterThanOrEqual(q){return this.comp(q)>=0}gte(q){return this.greaterThanOrEqual(q)}ge(q){return this.greaterThanOrEqual(q)}isEven(){return(1&this.low)==0}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return(1&this.low)==1}isPositive(){return this.unsigned||this.high>=0}isZero(){return this.high===0&&this.low===0}lessThan(q){return this.comp(q)<0}lt(q){return this.lessThan(q)}lessThanOrEqual(q){return this.comp(q)<=0}lte(q){return this.lessThanOrEqual(q)}modulo(q){if(dt.isLong(q)||(q=dt.fromValue(q)),Ht){const Ee=(this.unsigned?Ht.rem_u:Ht.rem_s)(this.low,this.high,q.low,q.high);return dt.fromBits(Ee,Ht.get_high(),this.unsigned)}return this.sub(this.div(q).mul(q))}mod(q){return this.modulo(q)}rem(q){return this.modulo(q)}multiply(q){if(this.isZero())return dt.ZERO;if(dt.isLong(q)||(q=dt.fromValue(q)),Ht){const pn=Ht.mul(this.low,this.high,q.low,q.high);return dt.fromBits(pn,Ht.get_high(),this.unsigned)}if(q.isZero())return dt.ZERO;if(this.eq(dt.MIN_VALUE))return q.isOdd()?dt.MIN_VALUE:dt.ZERO;if(q.eq(dt.MIN_VALUE))return this.isOdd()?dt.MIN_VALUE:dt.ZERO;if(this.isNegative())return q.isNegative()?this.neg().mul(q.neg()):this.neg().mul(q).neg();if(q.isNegative())return this.mul(q.neg()).neg();if(this.lt(dt.TWO_PWR_24)&&q.lt(dt.TWO_PWR_24))return dt.fromNumber(this.toNumber()*q.toNumber(),this.unsigned);const Ee=this.high>>>16,ye=65535&this.high,it=this.low>>>16,st=65535&this.low,At=q.high>>>16,qt=65535&q.high,gt=q.low>>>16,Xt=65535&q.low;let Vt=0,Ot=0,Ut=0,an=0;return an+=st*Xt,Ut+=an>>>16,an&=65535,Ut+=it*Xt,Ot+=Ut>>>16,Ut&=65535,Ut+=st*gt,Ot+=Ut>>>16,Ut&=65535,Ot+=ye*Xt,Vt+=Ot>>>16,Ot&=65535,Ot+=it*gt,Vt+=Ot>>>16,Ot&=65535,Ot+=st*qt,Vt+=Ot>>>16,Ot&=65535,Vt+=Ee*Xt+ye*gt+it*qt+st*At,Vt&=65535,dt.fromBits(Ut<<16|an,Vt<<16|Ot,this.unsigned)}mul(q){return this.multiply(q)}negate(){return!this.unsigned&&this.eq(dt.MIN_VALUE)?dt.MIN_VALUE:this.not().add(dt.ONE)}neg(){return this.negate()}not(){return dt.fromBits(~this.low,~this.high,this.unsigned)}notEquals(q){return!this.equals(q)}neq(q){return this.notEquals(q)}ne(q){return this.notEquals(q)}or(q){return dt.isLong(q)||(q=dt.fromValue(q)),dt.fromBits(this.low|q.low,this.high|q.high,this.unsigned)}shiftLeft(q){return dt.isLong(q)&&(q=q.toInt()),(q&=63)==0?this:q<32?dt.fromBits(this.low<<q,this.high<<q|this.low>>>32-q,this.unsigned):dt.fromBits(0,this.low<<q-32,this.unsigned)}shl(q){return this.shiftLeft(q)}shiftRight(q){return dt.isLong(q)&&(q=q.toInt()),(q&=63)==0?this:q<32?dt.fromBits(this.low>>>q|this.high<<32-q,this.high>>q,this.unsigned):dt.fromBits(this.high>>q-32,this.high>=0?0:-1,this.unsigned)}shr(q){return this.shiftRight(q)}shiftRightUnsigned(q){if(dt.isLong(q)&&(q=q.toInt()),(q&=63)==0)return this;{const Ee=this.high;if(q<32){const ye=this.low;return dt.fromBits(ye>>>q|Ee<<32-q,Ee>>>q,this.unsigned)}return q===32?dt.fromBits(Ee,0,this.unsigned):dt.fromBits(Ee>>>q-32,0,this.unsigned)}}shr_u(q){return this.shiftRightUnsigned(q)}shru(q){return this.shiftRightUnsigned(q)}subtract(q){return dt.isLong(q)||(q=dt.fromValue(q)),this.add(q.neg())}sub(q){return this.subtract(q)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*en+(this.low>>>0):this.high*en+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(q){return q?this.toBytesLE():this.toBytesBE()}toBytesLE(){const q=this.high,Ee=this.low;return[255&Ee,Ee>>>8&255,Ee>>>16&255,Ee>>>24,255&q,q>>>8&255,q>>>16&255,q>>>24]}toBytesBE(){const q=this.high,Ee=this.low;return[q>>>24,q>>>16&255,q>>>8&255,255&q,Ee>>>24,Ee>>>16&255,Ee>>>8&255,255&Ee]}toSigned(){return this.unsigned?dt.fromBits(this.low,this.high,!1):this}toString(q){if((q=q||10)<2||36<q)throw new X("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(dt.MIN_VALUE)){const st=dt.fromNumber(q),At=this.div(st),qt=At.mul(st).sub(this);return At.toString(q)+qt.toInt().toString(q)}return"-"+this.neg().toString(q)}const Ee=dt.fromNumber(Math.pow(q,6),this.unsigned);let ye=this,it="";for(;;){const st=ye.div(Ee);let At=(ye.sub(st.mul(Ee)).toInt()>>>0).toString(q);if(ye=st,ye.isZero())return At+it;for(;At.length<6;)At="0"+At;it=""+At+it}}toUnsigned(){return this.unsigned?this:dt.fromBits(this.low,this.high,!0)}xor(q){return dt.isLong(q)||(q=dt.fromValue(q)),dt.fromBits(this.low^q.low,this.high^q.high,this.unsigned)}eqz(){return this.isZero()}le(q){return this.lessThanOrEqual(q)}toExtendedJSON(q){return q&&q.relaxed?this.toNumber():{$numberLong:this.toString()}}static fromExtendedJSON(q,Ee){const{useBigInt64:ye=!1,relaxed:it=!0}={...Ee};if(q.$numberLong.length>20)throw new X("$numberLong string is too long");if(!rn.test(q.$numberLong))throw new X(`$numberLong string "${q.$numberLong}" is in an invalid format`);if(ye){const At=BigInt(q.$numberLong);return BigInt.asIntN(64,At)}const st=dt.fromString(q.$numberLong);return it?st.toNumber():st}inspect(q,Ee,ye){return ye??(ye=b),`new Long(${ye(this.toString(),Ee)}${this.unsigned?`, ${ye(this.unsigned,Ee)}`:""})`}}dt.TWO_PWR_24=dt.fromInt(16777216),dt.MAX_UNSIGNED_VALUE=dt.fromBits(-1,-1,!0),dt.ZERO=dt.fromInt(0),dt.UZERO=dt.fromInt(0,!0),dt.ONE=dt.fromInt(1),dt.UONE=dt.fromInt(1,!0),dt.NEG_ONE=dt.fromInt(-1),dt.MAX_VALUE=dt.fromBits(-1,2147483647,!1),dt.MIN_VALUE=dt.fromBits(0,-2147483648,!1);const qn=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,fn=/^(\+|-)?(Infinity|inf)$/i,dr=/^(\+|-)?NaN$/i,Xn=6111,Ir=-6176,Ae=le.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),ve=le.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),he=le.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),me=/^([-+])?(\d+)?$/;function we(Z){return!isNaN(parseInt(Z,10))}function je(Z){const q=dt.fromNumber(1e9);let Ee=dt.fromNumber(0);if(!(Z.parts[0]||Z.parts[1]||Z.parts[2]||Z.parts[3]))return{quotient:Z,rem:Ee};for(let ye=0;ye<=3;ye++)Ee=Ee.shiftLeft(32),Ee=Ee.add(new dt(Z.parts[ye],0)),Z.parts[ye]=Ee.div(q).low,Ee=Ee.modulo(q);return{quotient:Z,rem:Ee}}function qe(Z,q){throw new X(`"${Z}" is not a valid Decimal128 string - ${q}`)}class Fe extends Je{get _bsontype(){return"Decimal128"}constructor(q){if(super(),typeof q=="string")this.bytes=Fe.fromString(q).bytes;else{if(!v(q))throw new X("Decimal128 must take a Buffer or string");if(q.byteLength!==16)throw new X("Decimal128 must take a Buffer of 16 bytes");this.bytes=q}}static fromString(q){return Fe._fromString(q,{allowRounding:!1})}static fromStringWithRounding(q){return Fe._fromString(q,{allowRounding:!0})}static _fromString(q,Ee){let ye=!1,it=!1,st=!1,At=!1,qt=0,gt=0,Xt=0,Vt=0,Ot=0;const Ut=[0];let an=0,pn=0,Ln=0,or=0,gr=new dt(0,0),nr=new dt(0,0),wr=0,jn=0;if(q.length>=7e3)throw new X(q+" not a valid Decimal128 string");const yi=q.match(qn),Qn=q.match(fn),In=q.match(dr);if(!yi&&!Qn&&!In||q.length===0)throw new X(q+" not a valid Decimal128 string");if(yi){const un=yi[2],er=yi[4],mr=yi[5],Lr=yi[6];er&&Lr===void 0&&qe(q,"missing exponent power"),er&&un===void 0&&qe(q,"missing exponent base"),er===void 0&&(mr||Lr)&&qe(q,"missing e before exponent")}if(q[jn]!=="+"&&q[jn]!=="-"||(it=!0,ye=q[jn++]==="-"),!we(q[jn])&&q[jn]!=="."){if(q[jn]==="i"||q[jn]==="I")return new Fe(ye?ve:he);if(q[jn]==="N")return new Fe(Ae)}for(;we(q[jn])||q[jn]===".";)q[jn]!=="."?(an<34&&(q[jn]!=="0"||At)&&(At||(Ot=gt),At=!0,Ut[pn++]=parseInt(q[jn],10),an+=1),At&&(Xt+=1),st&&(Vt+=1),gt+=1,jn+=1):(st&&qe(q,"contains multiple periods"),st=!0,jn+=1);if(st&&!gt)throw new X(q+" not a valid Decimal128 string");if(q[jn]==="e"||q[jn]==="E"){const un=q.substr(++jn).match(me);if(!un||!un[2])return new Fe(Ae);or=parseInt(un[0],10),jn+=un[0].length}if(q[jn])return new Fe(Ae);if(an){if(Ln=an-1,qt=Xt,qt!==1)for(;q[Ot+qt-1+Number(it)+Number(st)]==="0";)qt-=1}else Ut[0]=0,Xt=1,an=1,qt=0;for(or<=Vt&&Vt>or+16384?or=Ir:or-=Vt;or>Xn;){if(Ln+=1,Ln>=34){if(qt===0){or=Xn;break}qe(q,"overflow")}or-=1}if(Ee.allowRounding){for(;or<Ir||an<Xt;){if(Ln===0&&qt<an){or=Ir,qt=0;break}if(an<Xt?Xt-=1:Ln-=1,or<Xn)or+=1;else{if(Ut.join("").match(/^0+$/)){or=Xn;break}qe(q,"overflow")}}if(Ln+1<qt){let un=gt;st&&(Ot+=1,un+=1),it&&(Ot+=1,un+=1);const er=parseInt(q[Ot+Ln+1],10);let mr=0;if(er>=5&&(mr=1,er===5)){mr=Ut[Ln]%2==1?1:0;for(let Lr=Ot+Ln+2;Lr<un;Lr++)if(parseInt(q[Lr],10)){mr=1;break}}if(mr){let Lr=Ln;for(;Lr>=0&&++Ut[Lr]>9;Lr--)if(Ut[Lr]=0,Lr===0){if(!(or<Xn))return new Fe(ye?ve:he);or+=1,Ut[Lr]=1}}}}else{for(;or<Ir||an<Xt;){if(Ln===0){if(qt===0){or=Ir;break}qe(q,"exponent underflow")}an<Xt?(q[Xt-1+Number(it)+Number(st)]!=="0"&&qt!==0&&qe(q,"inexact rounding"),Xt-=1):(Ut[Ln]!==0&&qe(q,"inexact rounding"),Ln-=1),or<Xn?or+=1:qe(q,"overflow")}Ln+1<qt&&(st&&(Ot+=1),it&&(Ot+=1),parseInt(q[Ot+Ln+1],10)!==0&&qe(q,"inexact rounding"))}if(gr=dt.fromNumber(0),nr=dt.fromNumber(0),qt===0)gr=dt.fromNumber(0),nr=dt.fromNumber(0);else if(Ln<17){let un=0;for(nr=dt.fromNumber(Ut[un++]),gr=new dt(0,0);un<=Ln;un++)nr=nr.multiply(dt.fromNumber(10)),nr=nr.add(dt.fromNumber(Ut[un]))}else{let un=0;for(gr=dt.fromNumber(Ut[un++]);un<=Ln-17;un++)gr=gr.multiply(dt.fromNumber(10)),gr=gr.add(dt.fromNumber(Ut[un]));for(nr=dt.fromNumber(Ut[un++]);un<=Ln;un++)nr=nr.multiply(dt.fromNumber(10)),nr=nr.add(dt.fromNumber(Ut[un]))}const Wr=function(un,er){if(!un&&!er)return{high:dt.fromNumber(0),low:dt.fromNumber(0)};const mr=un.shiftRightUnsigned(32),Lr=new dt(un.getLowBits(),0),bo=er.shiftRightUnsigned(32),sr=new dt(er.getLowBits(),0);let Gn=mr.multiply(bo),Mn=mr.multiply(sr);const Kn=Lr.multiply(bo);let Bn=Lr.multiply(sr);return Gn=Gn.add(Mn.shiftRightUnsigned(32)),Mn=new dt(Mn.getLowBits(),0).add(Kn).add(Bn.shiftRightUnsigned(32)),Gn=Gn.add(Mn.shiftRightUnsigned(32)),Bn=Mn.shiftLeft(32).add(new dt(Bn.getLowBits(),0)),{high:Gn,low:Bn}}(gr,dt.fromString("100000000000000000"));Wr.low=Wr.low.add(nr),function(un,er){const mr=un.high>>>0,Lr=er.high>>>0;return mr<Lr||mr===Lr&&un.low>>>0<er.low>>>0}(Wr.low,nr)&&(Wr.high=Wr.high.add(dt.fromNumber(1))),wr=or+6176;const yn={low:dt.fromNumber(0),high:dt.fromNumber(0)};Wr.high.shiftRightUnsigned(49).and(dt.fromNumber(1)).equals(dt.fromNumber(1))?(yn.high=yn.high.or(dt.fromNumber(3).shiftLeft(61)),yn.high=yn.high.or(dt.fromNumber(wr).and(dt.fromNumber(16383).shiftLeft(47))),yn.high=yn.high.or(Wr.high.and(dt.fromNumber(0x7fffffffffff)))):(yn.high=yn.high.or(dt.fromNumber(16383&wr).shiftLeft(49)),yn.high=yn.high.or(Wr.high.and(dt.fromNumber(562949953421311)))),yn.low=Wr.low,ye&&(yn.high=yn.high.or(dt.fromString("9223372036854775808")));const qr=le.allocate(16);return jn=0,qr[jn++]=255&yn.low.low,qr[jn++]=yn.low.low>>8&255,qr[jn++]=yn.low.low>>16&255,qr[jn++]=yn.low.low>>24&255,qr[jn++]=255&yn.low.high,qr[jn++]=yn.low.high>>8&255,qr[jn++]=yn.low.high>>16&255,qr[jn++]=yn.low.high>>24&255,qr[jn++]=255&yn.high.low,qr[jn++]=yn.high.low>>8&255,qr[jn++]=yn.high.low>>16&255,qr[jn++]=yn.high.low>>24&255,qr[jn++]=255&yn.high.high,qr[jn++]=yn.high.high>>8&255,qr[jn++]=yn.high.high>>16&255,qr[jn++]=yn.high.high>>24&255,new Fe(qr)}toString(){let q,Ee=0;const ye=new Array(36);for(let wr=0;wr<ye.length;wr++)ye[wr]=0;let it,st,At,qt=0,gt=!1,Xt={parts:[0,0,0,0]};const Vt=[];qt=0;const Ot=this.bytes,Ut=Ot[qt++]|Ot[qt++]<<8|Ot[qt++]<<16|Ot[qt++]<<24,an=Ot[qt++]|Ot[qt++]<<8|Ot[qt++]<<16|Ot[qt++]<<24,pn=Ot[qt++]|Ot[qt++]<<8|Ot[qt++]<<16|Ot[qt++]<<24,Ln=Ot[qt++]|Ot[qt++]<<8|Ot[qt++]<<16|Ot[qt++]<<24;qt=0,(new dt(Ut,an),new dt(pn,Ln)).lessThan(dt.ZERO)&&Vt.push("-");const or=Ln>>26&31;if(or>>3==3){if(or===30)return Vt.join("")+"Infinity";if(or===31)return"NaN";q=Ln>>15&16383,it=8+(Ln>>14&1)}else it=Ln>>14&7,q=Ln>>17&16383;const gr=q-6176;if(Xt.parts[0]=(16383&Ln)+((15&it)<<14),Xt.parts[1]=pn,Xt.parts[2]=an,Xt.parts[3]=Ut,Xt.parts[0]===0&&Xt.parts[1]===0&&Xt.parts[2]===0&&Xt.parts[3]===0)gt=!0;else for(At=3;At>=0;At--){let wr=0;const jn=je(Xt);if(Xt=jn.quotient,wr=jn.rem.low,wr)for(st=8;st>=0;st--)ye[9*At+st]=wr%10,wr=Math.floor(wr/10)}if(gt)Ee=1,ye[qt]=0;else for(Ee=36;!ye[qt];)Ee-=1,qt+=1;const nr=Ee-1+gr;if(nr>=34||nr<=-7||gr>0){if(Ee>34)return Vt.push("0"),gr>0?Vt.push(`E+${gr}`):gr<0&&Vt.push(`E${gr}`),Vt.join("");Vt.push(`${ye[qt++]}`),Ee-=1,Ee&&Vt.push(".");for(let wr=0;wr<Ee;wr++)Vt.push(`${ye[qt++]}`);Vt.push("E"),nr>0?Vt.push(`+${nr}`):Vt.push(`${nr}`)}else if(gr>=0)for(let wr=0;wr<Ee;wr++)Vt.push(`${ye[qt++]}`);else{let wr=Ee+gr;if(wr>0)for(let jn=0;jn<wr;jn++)Vt.push(`${ye[qt++]}`);else Vt.push("0");for(Vt.push(".");wr++<0;)Vt.push("0");for(let jn=0;jn<Ee-Math.max(wr-1,0);jn++)Vt.push(`${ye[qt++]}`)}return Vt.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(q){return Fe.fromString(q.$numberDecimal)}inspect(q,Ee,ye){return ye??(ye=b),`new Decimal128(${ye(this.toString(),Ee)})`}}class Xe extends Je{get _bsontype(){return"Double"}constructor(q){super(),q instanceof Number&&(q=q.valueOf()),this.value=+q}valueOf(){return this.value}toJSON(){return this.value}toString(q){return this.value.toString(q)}toExtendedJSON(q){return q&&(q.legacy||q.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-0.0"}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(q,Ee){const ye=parseFloat(q.$numberDouble);return Ee&&Ee.relaxed?ye:new Xe(ye)}inspect(q,Ee,ye){return ye??(ye=b),`new Double(${ye(this.value,Ee)})`}}class Ge extends Je{get _bsontype(){return"Int32"}constructor(q){super(),q instanceof Number&&(q=q.valueOf()),this.value=0|+q}valueOf(){return this.value}toString(q){return this.value.toString(q)}toJSON(){return this.value}toExtendedJSON(q){return q&&(q.relaxed||q.legacy)?this.value:{$numberInt:this.value.toString()}}static fromExtendedJSON(q,Ee){return Ee&&Ee.relaxed?parseInt(q.$numberInt,10):new Ge(q.$numberInt)}inspect(q,Ee,ye){return ye??(ye=b),`new Int32(${ye(this.value,Ee)})`}}class rt extends Je{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new rt}inspect(){return"new MaxKey()"}}class bt extends Je{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new bt}inspect(){return"new MinKey()"}}const at=new RegExp("^[0-9a-fA-F]{24}$");let Et=null;const jt=Symbol("id");class Kt extends Je{get _bsontype(){return"ObjectId"}constructor(q){let Ee;if(super(),typeof q=="object"&&q&&"id"in q){if(typeof q.id!="string"&&!ArrayBuffer.isView(q.id))throw new X("Argument passed in must have an id that is of type string or Buffer");Ee="toHexString"in q&&typeof q.toHexString=="function"?le.fromHex(q.toHexString()):q.id}else Ee=q;if(Ee==null||typeof Ee=="number")this[jt]=Kt.generate(typeof Ee=="number"?Ee:void 0);else if(ArrayBuffer.isView(Ee)&&Ee.byteLength===12)this[jt]=le.toLocalBufferType(Ee);else{if(typeof Ee!="string")throw new X("Argument passed in does not match the accepted types");if(Ee.length!==24||!at.test(Ee))throw new X("input must be a 24 character hex string, 12 byte Uint8Array, or an integer");this[jt]=le.fromHex(Ee)}Kt.cacheHexString&&(this.__id=le.toHex(this.id))}get id(){return this[jt]}set id(q){this[jt]=q,Kt.cacheHexString&&(this.__id=le.toHex(q))}toHexString(){if(Kt.cacheHexString&&this.__id)return this.__id;const q=le.toHex(this.id);return Kt.cacheHexString&&!this.__id&&(this.__id=q),q}static getInc(){return Kt.index=(Kt.index+1)%16777215}static generate(q){typeof q!="number"&&(q=Math.floor(Date.now()/1e3));const Ee=Kt.getInc(),ye=le.allocate(12);return ze.fromUint8Array(ye).setUint32(0,q,!1),Et===null&&(Et=le.randomBytes(5)),ye[4]=Et[0],ye[5]=Et[1],ye[6]=Et[2],ye[7]=Et[3],ye[8]=Et[4],ye[11]=255&Ee,ye[10]=Ee>>8&255,ye[9]=Ee>>16&255,ye}toString(q){return q==="base64"?le.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}static is(q){return q!=null&&typeof q=="object"&&"_bsontype"in q&&q._bsontype==="ObjectId"}equals(q){if(q==null)return!1;if(Kt.is(q))return this[jt][11]===q[jt][11]&&le.equals(this[jt],q[jt]);if(typeof q=="string")return q.toLowerCase()===this.toHexString();if(typeof q=="object"&&typeof q.toHexString=="function"){const Ee=q.toHexString(),ye=this.toHexString();return typeof Ee=="string"&&Ee.toLowerCase()===ye}return!1}getTimestamp(){const q=new Date,Ee=ze.fromUint8Array(this.id).getUint32(0,!1);return q.setTime(1e3*Math.floor(Ee)),q}static createPk(){return new Kt}static createFromTime(q){const Ee=le.fromNumberArray([0,0,0,0,0,0,0,0,0,0,0,0]);return ze.fromUint8Array(Ee).setUint32(0,q,!1),new Kt(Ee)}static createFromHexString(q){if((q==null?void 0:q.length)!==24)throw new X("hex string must be 24 characters");return new Kt(le.fromHex(q))}static createFromBase64(q){if((q==null?void 0:q.length)!==16)throw new X("base64 string must be 16 characters");return new Kt(le.fromBase64(q))}static isValid(q){if(q==null)return!1;try{return new Kt(q),!0}catch{return!1}}toExtendedJSON(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}static fromExtendedJSON(q){return new Kt(q.$oid)}inspect(q,Ee,ye){return ye??(ye=b),`new ObjectId(${ye(this.toHexString(),Ee)})`}}function Yt(Z,q,Ee){let ye=5;if(Array.isArray(Z))for(let it=0;it<Z.length;it++)ye+=Zt(it.toString(),Z[it],q,!0,Ee);else{typeof(Z==null?void 0:Z.toBSON)=="function"&&(Z=Z.toBSON());for(const it of Object.keys(Z))ye+=Zt(it,Z[it],q,!1,Ee)}return ye}function Zt(Z,q,Ee=!1,ye=!1,it=!1){switch(typeof(q==null?void 0:q.toBSON)=="function"&&(q=q.toBSON()),typeof q){case"string":return 1+le.utf8ByteLength(Z)+1+4+le.utf8ByteLength(q)+1;case"number":return Math.floor(q)===q&&q>=P&&q<=A&&q>=y&&q<=x?(Z!=null?le.utf8ByteLength(Z)+1:0)+5:(Z!=null?le.utf8ByteLength(Z)+1:0)+9;case"undefined":return ye||!it?(Z!=null?le.utf8ByteLength(Z)+1:0)+1:0;case"boolean":return(Z!=null?le.utf8ByteLength(Z)+1:0)+2;case"object":if(q!=null&&typeof q._bsontype=="string"&&q[Symbol.for("@@mdb.bson.version")]!==p)throw new ee;if(q==null||q._bsontype==="MinKey"||q._bsontype==="MaxKey")return(Z!=null?le.utf8ByteLength(Z)+1:0)+1;if(q._bsontype==="ObjectId")return(Z!=null?le.utf8ByteLength(Z)+1:0)+13;if(q instanceof Date||E(q))return(Z!=null?le.utf8ByteLength(Z)+1:0)+9;if(ArrayBuffer.isView(q)||q instanceof ArrayBuffer||m(q))return(Z!=null?le.utf8ByteLength(Z)+1:0)+6+q.byteLength;if(q._bsontype==="Long"||q._bsontype==="Double"||q._bsontype==="Timestamp")return(Z!=null?le.utf8ByteLength(Z)+1:0)+9;if(q._bsontype==="Decimal128")return(Z!=null?le.utf8ByteLength(Z)+1:0)+17;if(q._bsontype==="Code")return q.scope!=null&&Object.keys(q.scope).length>0?(Z!=null?le.utf8ByteLength(Z)+1:0)+1+4+4+le.utf8ByteLength(q.code.toString())+1+Yt(q.scope,Ee,it):(Z!=null?le.utf8ByteLength(Z)+1:0)+1+4+le.utf8ByteLength(q.code.toString())+1;if(q._bsontype==="Binary"){const st=q;return st.sub_type===et.SUBTYPE_BYTE_ARRAY?(Z!=null?le.utf8ByteLength(Z)+1:0)+(st.position+1+4+1+4):(Z!=null?le.utf8ByteLength(Z)+1:0)+(st.position+1+4+1)}if(q._bsontype==="Symbol")return(Z!=null?le.utf8ByteLength(Z)+1:0)+le.utf8ByteLength(q.value)+4+1+1;if(q._bsontype==="DBRef"){const st=Object.assign({$ref:q.collection,$id:q.oid},q.fields);return q.db!=null&&(st.$db=q.db),(Z!=null?le.utf8ByteLength(Z)+1:0)+1+Yt(st,Ee,it)}return q instanceof RegExp||g(q)?(Z!=null?le.utf8ByteLength(Z)+1:0)+1+le.utf8ByteLength(q.source)+1+(q.global?1:0)+(q.ignoreCase?1:0)+(q.multiline?1:0)+1:q._bsontype==="BSONRegExp"?(Z!=null?le.utf8ByteLength(Z)+1:0)+1+le.utf8ByteLength(q.pattern)+1+le.utf8ByteLength(q.options)+1:(Z!=null?le.utf8ByteLength(Z)+1:0)+Yt(q,Ee,it)+1;case"function":if(Ee)return(Z!=null?le.utf8ByteLength(Z)+1:0)+1+4+le.utf8ByteLength(q.toString())+1}return 0}Kt.index=Math.floor(16777215*Math.random());class Jt extends Je{get _bsontype(){return"BSONRegExp"}constructor(q,Ee){if(super(),this.pattern=q,this.options=(Ee??"").split("").sort().join(""),this.pattern.indexOf("\0")!==-1)throw new X(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`);if(this.options.indexOf("\0")!==-1)throw new X(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`);for(let ye=0;ye<this.options.length;ye++)if(this.options[ye]!=="i"&&this.options[ye]!=="m"&&this.options[ye]!=="x"&&this.options[ye]!=="l"&&this.options[ye]!=="s"&&this.options[ye]!=="u")throw new X(`The regular expression option [${this.options[ye]}] is not supported`)}static parseOptions(q){return q?q.split("").sort().join(""):""}toExtendedJSON(q){return(q=q||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(q){if("$regex"in q){if(typeof q.$regex=="string")return new Jt(q.$regex,Jt.parseOptions(q.$options));if(q.$regex._bsontype==="BSONRegExp")return q}if("$regularExpression"in q)return new Jt(q.$regularExpression.pattern,Jt.parseOptions(q.$regularExpression.options));throw new X(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(q)}`)}inspect(q,Ee,ye){const it=function(st){if(st!=null&&typeof st=="object"&&"stylize"in st&&typeof st.stylize=="function")return st.stylize}(Ee)??(st=>st);return ye??(ye=b),`new BSONRegExp(${it(ye(this.pattern),"regexp")}, ${it(ye(this.options),"regexp")})`}}class ln extends Je{get _bsontype(){return"BSONSymbol"}constructor(q){super(),this.value=q}valueOf(){return this.value}toString(){return this.value}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(q){return new ln(q.$symbol)}inspect(q,Ee,ye){return ye??(ye=b),`new BSONSymbol(${ye(this.value,Ee)})`}}const vn=dt;class wn extends vn{get _bsontype(){return"Timestamp"}constructor(q){if(q==null)super(0,0,!0);else if(typeof q=="bigint")super(q,!0);else if(dt.isLong(q))super(q.low,q.high,!0);else{if(typeof q!="object"||!("t"in q)||!("i"in q))throw new X("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }");{if(typeof q.t!="number"&&(typeof q.t!="object"||q.t._bsontype!=="Int32"))throw new X("Timestamp constructed from { t, i } must provide t as a number");if(typeof q.i!="number"&&(typeof q.i!="object"||q.i._bsontype!=="Int32"))throw new X("Timestamp constructed from { t, i } must provide i as a number");const Ee=Number(q.t),ye=Number(q.i);if(Ee<0||Number.isNaN(Ee))throw new X("Timestamp constructed from { t, i } must provide a positive t");if(ye<0||Number.isNaN(ye))throw new X("Timestamp constructed from { t, i } must provide a positive i");if(Ee>4294967295)throw new X("Timestamp constructed from { t, i } must provide t equal or less than uint32 max");if(ye>4294967295)throw new X("Timestamp constructed from { t, i } must provide i equal or less than uint32 max");super(ye,Ee,!0)}}}toJSON(){return{$timestamp:this.toString()}}static fromInt(q){return new wn(dt.fromInt(q,!0))}static fromNumber(q){return new wn(dt.fromNumber(q,!0))}static fromBits(q,Ee){return new wn({i:q,t:Ee})}static fromString(q,Ee){return new wn(dt.fromString(q,!0,Ee))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(q){const Ee=dt.isLong(q.$timestamp.i)?q.$timestamp.i.getLowBitsUnsigned():q.$timestamp.i,ye=dt.isLong(q.$timestamp.t)?q.$timestamp.t.getLowBitsUnsigned():q.$timestamp.t;return new wn({t:ye,i:Ee})}inspect(q,Ee,ye){return ye??(ye=b),`new Timestamp({ t: ${ye(this.high>>>0,Ee)}, i: ${ye(this.low>>>0,Ee)} })`}}wn.MAX_VALUE=dt.MAX_UNSIGNED_VALUE;const cn=128,xn=192,cr=224,br=240,hr=248,pr=192,Kr=224,mn=240,oi=128;function eo(Z,q,Ee){let ye=0;for(let it=q;it<Ee;it+=1){const st=Z[it];if(ye){if((st&xn)!==oi)return!1;ye-=1}else if(st&cn)if((st&cr)===pr)ye=1;else if((st&br)===Kr)ye=2;else{if((st&hr)!==mn)return!1;ye=3}}return!ye}const nn=dt.fromNumber(A),on=dt.fromNumber(P);function bn(Z,q,Ee){const ye=(q=q??{})&&q.index?q.index:0,it=Z[ye]|Z[ye+1]<<8|Z[ye+2]<<16|Z[ye+3]<<24;if(it<5)throw new X(`bson size must be >= 5, is ${it}`);if(q.allowObjectSmallerThanBufferSize&&Z.length<it)throw new X(`buffer length ${Z.length} must be >= bson size ${it}`);if(!q.allowObjectSmallerThanBufferSize&&Z.length!==it)throw new X(`buffer length ${Z.length} must === bson size ${it}`);if(it+ye>Z.byteLength)throw new X(`(bson size ${it} + options.index ${ye} must be <= buffer length ${Z.byteLength})`);if(Z[ye+it-1]!==0)throw new X("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return On(Z,ye,q,Ee)}const ir=/^\$ref$|^\$id$|^\$db$/;function On(Z,q,Ee,ye=!1){const it=Ee.fieldsAsRaw==null?null:Ee.fieldsAsRaw,st=Ee.raw!=null&&Ee.raw,At=typeof Ee.bsonRegExp=="boolean"&&Ee.bsonRegExp,qt=Ee.promoteBuffers??!1,gt=Ee.promoteLongs??!0,Xt=Ee.promoteValues??!0,Vt=Ee.useBigInt64??!1;if(Vt&&!Xt)throw new X("Must either request bigint or Long for int64 deserialization");if(Vt&&!gt)throw new X("Must either request bigint or Long for int64 deserialization");const Ot=Ee.validation==null?{utf8:!0}:Ee.validation;let Ut,an=!0;const pn=new Set,Ln=Ot.utf8;if(typeof Ln=="boolean")Ut=Ln;else{an=!1;const Qn=Object.keys(Ln).map(function(In){return Ln[In]});if(Qn.length===0)throw new X("UTF-8 validation setting cannot be empty");if(typeof Qn[0]!="boolean")throw new X("Invalid UTF-8 validation option, must specify boolean values");if(Ut=Qn[0],!Qn.every(In=>In===Ut))throw new X("Invalid UTF-8 validation option - keys must be all true or all false")}if(!an)for(const Qn of Object.keys(Ln))pn.add(Qn);const or=q;if(Z.length<5)throw new X("corrupt bson message < 5 bytes long");const gr=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;if(gr<5||gr>Z.length)throw new X("corrupt bson message");const nr=ye?[]:{};let wr=0,jn=!ye&&null;const yi=new DataView(Z.buffer,Z.byteOffset,Z.byteLength);for(;;){const Qn=Z[q++];if(Qn===0)break;let In=q;for(;Z[In]!==0&&In<Z.length;)In++;if(In>=Z.byteLength)throw new X("Bad BSON Document: illegal CString");const Wr=ye?wr++:le.toUTF8(Z,q,In);let yn,qr=!0;if(qr=an||pn.has(Wr)?Ut:!Ut,jn!==!1&&Wr[0]==="$"&&(jn=ir.test(Wr)),q=In+1,Qn===R){const un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;if(un<=0||un>Z.length-q||Z[q+un-1]!==0)throw new X("bad string length in bson");yn=Ar(Z,q,q+un-1,qr),q+=un}else if(Qn===re){const un=le.allocate(12);un.set(Z.subarray(q,q+12)),yn=new Kt(un),q+=12}else if(Qn===N&&Xt===!1)yn=new Ge(Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24);else if(Qn===N)yn=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;else if(Qn===T&&Xt===!1)yn=new Xe(yi.getFloat64(q,!0)),q+=8;else if(Qn===T)yn=yi.getFloat64(q,!0),q+=8;else if(Qn===oe){const un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24,er=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;yn=new Date(new dt(un,er).toNumber())}else if(Qn===Q){if(Z[q]!==0&&Z[q]!==1)throw new X("illegal boolean type value");yn=Z[q++]===1}else if(Qn===M){const un=q,er=Z[q]|Z[q+1]<<8|Z[q+2]<<16|Z[q+3]<<24;if(er<=0||er>Z.length-q)throw new X("bad embedded document length in bson");if(st)yn=Z.slice(q,q+er);else{let mr=Ee;an||(mr={...Ee,validation:{utf8:qr}}),yn=On(Z,un,mr,!1)}q+=er}else if(Qn===L){const un=q,er=Z[q]|Z[q+1]<<8|Z[q+2]<<16|Z[q+3]<<24;let mr=Ee;const Lr=q+er;if(it&&it[Wr]&&(mr={...Ee,raw:!0}),an||(mr={...mr,validation:{utf8:qr}}),yn=On(Z,un,mr,!0),Z[(q+=er)-1]!==0)throw new X("invalid array terminator byte");if(q!==Lr)throw new X("corrupted array bson")}else if(Qn===G)yn=void 0;else if(Qn===ae)yn=null;else if(Qn===H){const un=ze.fromUint8Array(Z.subarray(q,q+8)),er=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24,mr=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24,Lr=new dt(er,mr);yn=Vt?un.getBigInt64(0,!0):gt&&Xt===!0&&Lr.lessThanOrEqual(nn)&&Lr.greaterThanOrEqual(on)?Lr.toNumber():Lr}else if(Qn===Y){const un=le.allocate(16);un.set(Z.subarray(q,q+16),0),q+=16,yn=new Fe(un)}else if(Qn===W){let un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;const er=un,mr=Z[q++];if(un<0)throw new X("Negative binary type element size found");if(un>Z.byteLength)throw new X("Binary type size larger than document size");if(Z.slice!=null){if(mr===et.SUBTYPE_BYTE_ARRAY){if(un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24,un<0)throw new X("Negative binary type element size found for subtype 0x02");if(un>er-4)throw new X("Binary type with subtype 0x02 contains too long binary size");if(un<er-4)throw new X("Binary type with subtype 0x02 contains too short binary size")}qt&&Xt?yn=le.toLocalBufferType(Z.slice(q,q+un)):(yn=new et(Z.slice(q,q+un),mr),mr===De&&It.isValid(yn)&&(yn=yn.toUUID()))}else{const Lr=le.allocate(un);if(mr===et.SUBTYPE_BYTE_ARRAY){if(un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24,un<0)throw new X("Negative binary type element size found for subtype 0x02");if(un>er-4)throw new X("Binary type with subtype 0x02 contains too long binary size");if(un<er-4)throw new X("Binary type with subtype 0x02 contains too short binary size")}for(In=0;In<un;In++)Lr[In]=Z[q+In];qt&&Xt?yn=Lr:(yn=new et(Z.slice(q,q+un),mr),mr===De&&It.isValid(yn)&&(yn=yn.toUUID()))}q+=un}else if(Qn===de&&At===!1){for(In=q;Z[In]!==0&&In<Z.length;)In++;if(In>=Z.length)throw new X("Bad BSON Document: illegal CString");const un=le.toUTF8(Z,q,In);for(In=q=In+1;Z[In]!==0&&In<Z.length;)In++;if(In>=Z.length)throw new X("Bad BSON Document: illegal CString");const er=le.toUTF8(Z,q,In);q=In+1;const mr=new Array(er.length);for(In=0;In<er.length;In++)switch(er[In]){case"m":mr[In]="m";break;case"s":mr[In]="g";break;case"i":mr[In]="i"}yn=new RegExp(un,mr.join(""))}else if(Qn===de&&At===!0){for(In=q;Z[In]!==0&&In<Z.length;)In++;if(In>=Z.length)throw new X("Bad BSON Document: illegal CString");const un=le.toUTF8(Z,q,In);for(In=q=In+1;Z[In]!==0&&In<Z.length;)In++;if(In>=Z.length)throw new X("Bad BSON Document: illegal CString");const er=le.toUTF8(Z,q,In);q=In+1,yn=new Jt(un,er)}else if(Qn===U){const un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;if(un<=0||un>Z.length-q||Z[q+un-1]!==0)throw new X("bad string length in bson");const er=Ar(Z,q,q+un-1,qr);yn=Xt?er:new ln(er),q+=un}else if(Qn===z){const un=Z[q++]+256*Z[q++]+65536*Z[q++]+Z[q++]*16777216,er=Z[q++]+256*Z[q++]+65536*Z[q++]+Z[q++]*(1<<24);yn=new wn({i:un,t:er})}else if(Qn===fe)yn=new bt;else if(Qn===Re)yn=new rt;else if(Qn===pe){const un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;if(un<=0||un>Z.length-q||Z[q+un-1]!==0)throw new X("bad string length in bson");const er=Ar(Z,q,q+un-1,qr);yn=new Ct(er),q+=un}else if(Qn===B){const un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;if(un<13)throw new X("code_w_scope total size shorter minimum expected length");const er=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;if(er<=0||er>Z.length-q||Z[q+er-1]!==0)throw new X("bad string length in bson");const mr=Ar(Z,q,q+er-1,qr),Lr=q+=er,bo=Z[q]|Z[q+1]<<8|Z[q+2]<<16|Z[q+3]<<24,sr=On(Z,Lr,Ee,!1);if(q+=bo,un<8+bo+er)throw new X("code_w_scope total size is too short, truncating scope");if(un>8+bo+er)throw new X("code_w_scope total size is too long, clips outer document");yn=new Ct(mr,sr)}else{if(Qn!==be)throw new X(`Detected unknown BSON type ${Qn.toString(16)} for fieldname "${Wr}"`);{const un=Z[q++]|Z[q++]<<8|Z[q++]<<16|Z[q++]<<24;if(un<=0||un>Z.length-q||Z[q+un-1]!==0)throw new X("bad string length in bson");if(Ot!=null&&Ot.utf8&&!eo(Z,q,q+un-1))throw new X("Invalid UTF-8 string in BSON document");const er=le.toUTF8(Z,q,q+un-1);q+=un;const mr=le.allocate(12);mr.set(Z.subarray(q,q+12),0);const Lr=new Kt(mr);q+=12,yn=new xt(er,Lr)}}Wr==="__proto__"?Object.defineProperty(nr,Wr,{value:yn,writable:!0,enumerable:!0,configurable:!0}):nr[Wr]=yn}if(gr!==q-or)throw ye?new X("corrupt array bson"):new X("corrupt object bson");if(!jn)return nr;if(tn(nr)){const Qn=Object.assign({},nr);return delete Qn.$ref,delete Qn.$id,delete Qn.$db,new xt(nr.$ref,nr.$id,nr.$db,Qn)}return nr}function Ar(Z,q,Ee,ye){const it=le.toUTF8(Z,q,Ee);if(ye){for(let st=0;st<it.length;st++)if(it.charCodeAt(st)===65533){if(!eo(Z,q,Ee))throw new X("Invalid UTF-8 string in BSON document");break}}return it}const zr=/\x00/,kr=new Set(["$db","$ref","$id","$clusterTime"]);function ui(Z,q,Ee,ye){Z[ye++]=R,Z[(ye=ye+le.encodeUTF8Into(Z,q,ye)+1)-1]=0;const it=le.encodeUTF8Into(Z,Ee,ye+4);return Z[ye+3]=it+1>>24&255,Z[ye+2]=it+1>>16&255,Z[ye+1]=it+1>>8&255,Z[ye]=it+1&255,ye=ye+4+it,Z[ye++]=0,ye}const Jr=new DataView(new ArrayBuffer(8),0,8),Xr=new Uint8Array(Jr.buffer,0,4),wi=new Uint8Array(Jr.buffer,0,8);function Wn(Z,q,Ee,ye){const it=!Object.is(Ee,-0)&&Number.isSafeInteger(Ee)&&Ee<=x&&Ee>=y?N:T;it===N?Jr.setInt32(0,Ee,!0):Jr.setFloat64(0,Ee,!0);const st=it===N?Xr:wi;return Z[ye++]=it,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,Z.set(st,ye),ye+st.byteLength}function hi(Z,q,Ee,ye){return Z[ye++]=H,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,Jr.setBigInt64(0,Ee,!0),Z.set(wi,ye),ye+wi.byteLength}function pi(Z,q,Ee,ye){return Z[ye++]=ae,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,ye}function ns(Z,q,Ee,ye){return Z[ye++]=Q,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,Z[ye++]=Ee?1:0,ye}function ki(Z,q,Ee,ye){Z[ye++]=oe,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const it=dt.fromNumber(Ee.getTime()),st=it.getLowBits(),At=it.getHighBits();return Z[ye++]=255&st,Z[ye++]=st>>8&255,Z[ye++]=st>>16&255,Z[ye++]=st>>24&255,Z[ye++]=255&At,Z[ye++]=At>>8&255,Z[ye++]=At>>16&255,Z[ye++]=At>>24&255,ye}function Di(Z,q,Ee,ye){if(Z[ye++]=de,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,Ee.source&&Ee.source.match(zr)!=null)throw new X("value "+Ee.source+" must not contain null bytes");return ye+=le.encodeUTF8Into(Z,Ee.source,ye),Z[ye++]=0,Ee.ignoreCase&&(Z[ye++]=105),Ee.global&&(Z[ye++]=115),Ee.multiline&&(Z[ye++]=109),Z[ye++]=0,ye}function Hi(Z,q,Ee,ye){if(Z[ye++]=de,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,Ee.pattern.match(zr)!=null)throw new X("pattern "+Ee.pattern+" must not contain null bytes");ye+=le.encodeUTF8Into(Z,Ee.pattern,ye),Z[ye++]=0;const it=Ee.options.split("").sort().join("");return ye+=le.encodeUTF8Into(Z,it,ye),Z[ye++]=0,ye}function Ur(Z,q,Ee,ye){return Ee===null?Z[ye++]=ae:Ee._bsontype==="MinKey"?Z[ye++]=fe:Z[ye++]=Re,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,ye}function Io(Z,q,Ee,ye){Z[ye++]=re,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const it=Ee.id;if(!v(it))throw new X("object ["+JSON.stringify(Ee)+"] is not a valid ObjectId");for(let st=0;st<12;st++)Z[ye++]=it[st];return ye}function rs(Z,q,Ee,ye){Z[ye++]=W,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const it=Ee.length;return Z[ye++]=255&it,Z[ye++]=it>>8&255,Z[ye++]=it>>16&255,Z[ye++]=it>>24&255,Z[ye++]=Oe,Z.set(Ee,ye),ye+it}function ao(Z,q,Ee,ye,it,st,At,qt,gt){if(gt.has(Ee))throw new X("Cannot convert circular structure to BSON");gt.add(Ee),Z[ye++]=Array.isArray(Ee)?L:M,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const Xt=co(Z,Ee,it,ye,st+1,At,qt,gt);return gt.delete(Ee),Xt}function qo(Z,q,Ee,ye){return Z[ye++]=Y,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,Z.set(Ee.bytes.subarray(0,16),ye),ye+16}function yo(Z,q,Ee,ye){Z[ye++]=Ee._bsontype==="Long"?H:z,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const it=Ee.getLowBits(),st=Ee.getHighBits();return Z[ye++]=255&it,Z[ye++]=it>>8&255,Z[ye++]=it>>16&255,Z[ye++]=it>>24&255,Z[ye++]=255&st,Z[ye++]=st>>8&255,Z[ye++]=st>>16&255,Z[ye++]=st>>24&255,ye}function lo(Z,q,Ee,ye){return Ee=Ee.valueOf(),Z[ye++]=N,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,Z[ye++]=255&Ee,Z[ye++]=Ee>>8&255,Z[ye++]=Ee>>16&255,Z[ye++]=Ee>>24&255,ye}function Ao(Z,q,Ee,ye){return Z[ye++]=T,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0,Jr.setFloat64(0,Ee.value,!0),Z.set(wi,ye),ye+8}function Ss(Z,q,Ee,ye){Z[ye++]=pe,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const it=Ee.toString(),st=le.encodeUTF8Into(Z,it,ye+4)+1;return Z[ye]=255&st,Z[ye+1]=st>>8&255,Z[ye+2]=st>>16&255,Z[ye+3]=st>>24&255,ye=ye+4+st-1,Z[ye++]=0,ye}function Ho(Z,q,Ee,ye,it=!1,st=0,At=!1,qt=!0,gt){if(Ee.scope&&typeof Ee.scope=="object"){Z[ye++]=B,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;let Xt=ye;const Vt=Ee.code;ye+=4;const Ot=le.encodeUTF8Into(Z,Vt,ye+4)+1;Z[ye]=255&Ot,Z[ye+1]=Ot>>8&255,Z[ye+2]=Ot>>16&255,Z[ye+3]=Ot>>24&255,Z[ye+4+Ot-1]=0,ye=ye+Ot+4;const Ut=co(Z,Ee.scope,it,ye,st+1,At,qt,gt);ye=Ut-1;const an=Ut-Xt;Z[Xt++]=255&an,Z[Xt++]=an>>8&255,Z[Xt++]=an>>16&255,Z[Xt++]=an>>24&255,Z[ye++]=0}else{Z[ye++]=pe,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const Xt=Ee.code.toString(),Vt=le.encodeUTF8Into(Z,Xt,ye+4)+1;Z[ye]=255&Vt,Z[ye+1]=Vt>>8&255,Z[ye+2]=Vt>>16&255,Z[ye+3]=Vt>>24&255,ye=ye+4+Vt-1,Z[ye++]=0}return ye}function Kl(Z,q,Ee,ye){Z[ye++]=W,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const it=Ee.buffer;let st=Ee.position;return Ee.sub_type===et.SUBTYPE_BYTE_ARRAY&&(st+=4),Z[ye++]=255&st,Z[ye++]=st>>8&255,Z[ye++]=st>>16&255,Z[ye++]=st>>24&255,Z[ye++]=Ee.sub_type,Ee.sub_type===et.SUBTYPE_BYTE_ARRAY&&(st-=4,Z[ye++]=255&st,Z[ye++]=st>>8&255,Z[ye++]=st>>16&255,Z[ye++]=st>>24&255),Z.set(it,ye),ye+Ee.position}function za(Z,q,Ee,ye){Z[ye++]=U,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;const it=le.encodeUTF8Into(Z,Ee.value,ye+4)+1;return Z[ye]=255&it,Z[ye+1]=it>>8&255,Z[ye+2]=it>>16&255,Z[ye+3]=it>>24&255,ye=ye+4+it-1,Z[ye++]=0,ye}function Ua(Z,q,Ee,ye,it,st,At){Z[ye++]=M,ye+=le.encodeUTF8Into(Z,q,ye),Z[ye++]=0;let qt=ye,gt={$ref:Ee.collection||Ee.namespace,$id:Ee.oid};Ee.db!=null&&(gt.$db=Ee.db),gt=Object.assign(gt,Ee.fields);const Xt=co(Z,gt,!1,ye,it+1,st,!0,At),Vt=Xt-qt;return Z[qt++]=255&Vt,Z[qt++]=Vt>>8&255,Z[qt++]=Vt>>16&255,Z[qt++]=Vt>>24&255,Xt}function co(Z,q,Ee,ye,it,st,At,qt){if(qt==null){if(q==null)return Z[0]=5,Z[1]=0,Z[2]=0,Z[3]=0,Z[4]=0,5;if(Array.isArray(q))throw new X("serialize does not support an array as the root input");if(typeof q!="object")throw new X("serialize does not support non-object as the root input");if("_bsontype"in q&&typeof q._bsontype=="string")throw new X("BSON types cannot be serialized as a document");if(E(q)||g(q)||v(q)||m(q))throw new X("date, regexp, typedarray, and arraybuffer cannot be BSON documents");qt=new Set}qt.add(q);let gt=ye+4;if(Array.isArray(q))for(let Vt=0;Vt<q.length;Vt++){const Ot=`${Vt}`;let Ut=q[Vt];if(typeof(Ut==null?void 0:Ut.toBSON)=="function"&&(Ut=Ut.toBSON()),typeof Ut=="string")gt=ui(Z,Ot,Ut,gt);else if(typeof Ut=="number")gt=Wn(Z,Ot,Ut,gt);else if(typeof Ut=="bigint")gt=hi(Z,Ot,Ut,gt);else if(typeof Ut=="boolean")gt=ns(Z,Ot,Ut,gt);else if(Ut instanceof Date||E(Ut))gt=ki(Z,Ot,Ut,gt);else if(Ut===void 0)gt=pi(Z,Ot,0,gt);else if(Ut===null)gt=pi(Z,Ot,0,gt);else if(v(Ut))gt=rs(Z,Ot,Ut,gt);else if(Ut instanceof RegExp||g(Ut))gt=Di(Z,Ot,Ut,gt);else if(typeof Ut=="object"&&Ut._bsontype==null)gt=ao(Z,Ot,Ut,gt,Ee,it,st,At,qt);else{if(typeof Ut=="object"&&Ut[Symbol.for("@@mdb.bson.version")]!==p)throw new ee;if(Ut._bsontype==="ObjectId")gt=Io(Z,Ot,Ut,gt);else if(Ut._bsontype==="Decimal128")gt=qo(Z,Ot,Ut,gt);else if(Ut._bsontype==="Long"||Ut._bsontype==="Timestamp")gt=yo(Z,Ot,Ut,gt);else if(Ut._bsontype==="Double")gt=Ao(Z,Ot,Ut,gt);else if(typeof Ut=="function"&&st)gt=Ss(Z,Ot,Ut,gt);else if(Ut._bsontype==="Code")gt=Ho(Z,Ot,Ut,gt,Ee,it,st,At,qt);else if(Ut._bsontype==="Binary")gt=Kl(Z,Ot,Ut,gt);else if(Ut._bsontype==="BSONSymbol")gt=za(Z,Ot,Ut,gt);else if(Ut._bsontype==="DBRef")gt=Ua(Z,Ot,Ut,gt,it,st,qt);else if(Ut._bsontype==="BSONRegExp")gt=Hi(Z,Ot,Ut,gt);else if(Ut._bsontype==="Int32")gt=lo(Z,Ot,Ut,gt);else if(Ut._bsontype==="MinKey"||Ut._bsontype==="MaxKey")gt=Ur(Z,Ot,Ut,gt);else if(Ut._bsontype!==void 0)throw new X(`Unrecognized or invalid _bsontype: ${String(Ut._bsontype)}`)}}else if(q instanceof Map||_(q)){const Vt=q.entries();let Ot=!1;for(;!Ot;){const Ut=Vt.next();if(Ot=!!Ut.done,Ot)continue;const an=Ut.value[0];let pn=Ut.value[1];typeof(pn==null?void 0:pn.toBSON)=="function"&&(pn=pn.toBSON());const Ln=typeof pn;if(typeof an=="string"&&!kr.has(an)){if(an.match(zr)!=null)throw new X("key "+an+" must not contain null bytes");if(Ee){if(an[0]==="$")throw new X("key "+an+" must not start with '$'");if(~an.indexOf("."))throw new X("key "+an+" must not contain '.'")}}if(Ln==="string")gt=ui(Z,an,pn,gt);else if(Ln==="number")gt=Wn(Z,an,pn,gt);else if(Ln==="bigint")gt=hi(Z,an,pn,gt);else if(Ln==="boolean")gt=ns(Z,an,pn,gt);else if(pn instanceof Date||E(pn))gt=ki(Z,an,pn,gt);else if(pn===null||pn===void 0&&At===!1)gt=pi(Z,an,0,gt);else if(v(pn))gt=rs(Z,an,pn,gt);else if(pn instanceof RegExp||g(pn))gt=Di(Z,an,pn,gt);else if(Ln==="object"&&pn._bsontype==null)gt=ao(Z,an,pn,gt,Ee,it,st,At,qt);else{if(typeof pn=="object"&&pn[Symbol.for("@@mdb.bson.version")]!==p)throw new ee;if(pn._bsontype==="ObjectId")gt=Io(Z,an,pn,gt);else if(Ln==="object"&&pn._bsontype==="Decimal128")gt=qo(Z,an,pn,gt);else if(pn._bsontype==="Long"||pn._bsontype==="Timestamp")gt=yo(Z,an,pn,gt);else if(pn._bsontype==="Double")gt=Ao(Z,an,pn,gt);else if(pn._bsontype==="Code")gt=Ho(Z,an,pn,gt,Ee,it,st,At,qt);else if(typeof pn=="function"&&st)gt=Ss(Z,an,pn,gt);else if(pn._bsontype==="Binary")gt=Kl(Z,an,pn,gt);else if(pn._bsontype==="BSONSymbol")gt=za(Z,an,pn,gt);else if(pn._bsontype==="DBRef")gt=Ua(Z,an,pn,gt,it,st,qt);else if(pn._bsontype==="BSONRegExp")gt=Hi(Z,an,pn,gt);else if(pn._bsontype==="Int32")gt=lo(Z,an,pn,gt);else if(pn._bsontype==="MinKey"||pn._bsontype==="MaxKey")gt=Ur(Z,an,pn,gt);else if(pn._bsontype!==void 0)throw new X(`Unrecognized or invalid _bsontype: ${String(pn._bsontype)}`)}}}else{if(typeof(q==null?void 0:q.toBSON)=="function"&&(q=q.toBSON())!=null&&typeof q!="object")throw new X("toBSON function did not return an object");for(const Vt of Object.keys(q)){let Ot=q[Vt];typeof(Ot==null?void 0:Ot.toBSON)=="function"&&(Ot=Ot.toBSON());const Ut=typeof Ot;if(typeof Vt=="string"&&!kr.has(Vt)){if(Vt.match(zr)!=null)throw new X("key "+Vt+" must not contain null bytes");if(Ee){if(Vt[0]==="$")throw new X("key "+Vt+" must not start with '$'");if(~Vt.indexOf("."))throw new X("key "+Vt+" must not contain '.'")}}if(Ut==="string")gt=ui(Z,Vt,Ot,gt);else if(Ut==="number")gt=Wn(Z,Vt,Ot,gt);else if(Ut==="bigint")gt=hi(Z,Vt,Ot,gt);else if(Ut==="boolean")gt=ns(Z,Vt,Ot,gt);else if(Ot instanceof Date||E(Ot))gt=ki(Z,Vt,Ot,gt);else if(Ot===void 0)At===!1&&(gt=pi(Z,Vt,0,gt));else if(Ot===null)gt=pi(Z,Vt,0,gt);else if(v(Ot))gt=rs(Z,Vt,Ot,gt);else if(Ot instanceof RegExp||g(Ot))gt=Di(Z,Vt,Ot,gt);else if(Ut==="object"&&Ot._bsontype==null)gt=ao(Z,Vt,Ot,gt,Ee,it,st,At,qt);else{if(typeof Ot=="object"&&Ot[Symbol.for("@@mdb.bson.version")]!==p)throw new ee;if(Ot._bsontype==="ObjectId")gt=Io(Z,Vt,Ot,gt);else if(Ut==="object"&&Ot._bsontype==="Decimal128")gt=qo(Z,Vt,Ot,gt);else if(Ot._bsontype==="Long"||Ot._bsontype==="Timestamp")gt=yo(Z,Vt,Ot,gt);else if(Ot._bsontype==="Double")gt=Ao(Z,Vt,Ot,gt);else if(Ot._bsontype==="Code")gt=Ho(Z,Vt,Ot,gt,Ee,it,st,At,qt);else if(typeof Ot=="function"&&st)gt=Ss(Z,Vt,Ot,gt);else if(Ot._bsontype==="Binary")gt=Kl(Z,Vt,Ot,gt);else if(Ot._bsontype==="BSONSymbol")gt=za(Z,Vt,Ot,gt);else if(Ot._bsontype==="DBRef")gt=Ua(Z,Vt,Ot,gt,it,st,qt);else if(Ot._bsontype==="BSONRegExp")gt=Hi(Z,Vt,Ot,gt);else if(Ot._bsontype==="Int32")gt=lo(Z,Vt,Ot,gt);else if(Ot._bsontype==="MinKey"||Ot._bsontype==="MaxKey")gt=Ur(Z,Vt,Ot,gt);else if(Ot._bsontype!==void 0)throw new X(`Unrecognized or invalid _bsontype: ${String(Ot._bsontype)}`)}}}qt.delete(q),Z[gt++]=0;const Xt=gt-ye;return Z[ye++]=255&Xt,Z[ye++]=Xt>>8&255,Z[ye++]=Xt>>16&255,Z[ye++]=Xt>>24&255,gt}const Wo={$oid:Kt,$binary:et,$uuid:et,$symbol:ln,$numberInt:Ge,$numberDecimal:Fe,$numberDouble:Xe,$numberLong:dt,$minKey:bt,$maxKey:rt,$regex:Jt,$regularExpression:Jt,$timestamp:wn};function Wi(Z,q={}){if(typeof Z=="number"){const ye=Z<=x&&Z>=y,it=Z<=f&&Z>=w;if(q.relaxed||q.legacy)return Z;if(Number.isInteger(Z)&&!Object.is(Z,-0)){if(ye)return new Ge(Z);if(it)return q.useBigInt64?BigInt(Z):dt.fromNumber(Z)}return new Xe(Z)}if(Z==null||typeof Z!="object")return Z;if(Z.$undefined)return null;const Ee=Object.keys(Z).filter(ye=>ye.startsWith("$")&&Z[ye]!=null);for(let ye=0;ye<Ee.length;ye++){const it=Wo[Ee[ye]];if(it)return it.fromExtendedJSON(Z,q)}if(Z.$date!=null){const ye=Z.$date,it=new Date;if(q.legacy)if(typeof ye=="number")it.setTime(ye);else if(typeof ye=="string")it.setTime(Date.parse(ye));else{if(typeof ye!="bigint")throw new Le("Unrecognized type for EJSON date: "+typeof ye);it.setTime(Number(ye))}else if(typeof ye=="string")it.setTime(Date.parse(ye));else if(dt.isLong(ye))it.setTime(ye.toNumber());else if(typeof ye=="number"&&q.relaxed)it.setTime(ye);else{if(typeof ye!="bigint")throw new Le("Unrecognized type for EJSON date: "+typeof ye);it.setTime(Number(ye))}return it}if(Z.$code!=null){const ye=Object.assign({},Z);return Z.$scope&&(ye.$scope=Wi(Z.$scope)),Ct.fromExtendedJSON(Z)}if(tn(Z)||Z.$dbPointer){const ye=Z.$ref?Z:Z.$dbPointer;if(ye instanceof xt)return ye;const it=Object.keys(ye).filter(At=>At.startsWith("$"));let st=!0;if(it.forEach(At=>{["$ref","$id","$db"].indexOf(At)===-1&&(st=!1)}),st)return xt.fromExtendedJSON(ye)}return Z}function Ui(Z){const q=Z.toISOString();return Z.getUTCMilliseconds()!==0?q:q.slice(0,-5)+"Z"}function Gi(Z,q){if(Z instanceof Map||_(Z)){const Ee=Object.create(null);for(const[ye,it]of Z){if(typeof ye!="string")throw new X("Can only serialize maps with string keys");Ee[ye]=it}return Gi(Ee,q)}if((typeof Z=="object"||typeof Z=="function")&&Z!==null){const Ee=q.seenObjects.findIndex(ye=>ye.obj===Z);if(Ee!==-1){const ye=q.seenObjects.map(Vt=>Vt.propertyName),it=ye.slice(0,Ee).map(Vt=>`${Vt} -> `).join(""),st=ye[Ee],At=" -> "+ye.slice(Ee+1,ye.length-1).map(Vt=>`${Vt} -> `).join(""),qt=ye[ye.length-1],gt=" ".repeat(it.length+st.length/2),Xt="-".repeat(At.length+(st.length+qt.length)/2-1);throw new X(`Converting circular structure to EJSON:
    ${it}${st}${At}${qt}
    ${gt}\\${Xt}/`)}q.seenObjects[q.seenObjects.length-1].obj=Z}if(Array.isArray(Z))return function(Ee,ye){return Ee.map((it,st)=>{ye.seenObjects.push({propertyName:`index ${st}`,obj:null});try{return Gi(it,ye)}finally{ye.seenObjects.pop()}})}(Z,q);if(Z===void 0)return null;if(Z instanceof Date||E(Z)){const Ee=Z.getTime(),ye=Ee>-1&&Ee<2534023188e5;return q.legacy?q.relaxed&&ye?{$date:Z.getTime()}:{$date:Ui(Z)}:q.relaxed&&ye?{$date:Ui(Z)}:{$date:{$numberLong:Z.getTime().toString()}}}if(!(typeof Z!="number"||q.relaxed&&isFinite(Z))){if(Number.isInteger(Z)&&!Object.is(Z,-0)){if(Z>=y&&Z<=x)return{$numberInt:Z.toString()};if(Z>=w&&Z<=f)return{$numberLong:Z.toString()}}return{$numberDouble:Object.is(Z,-0)?"-0.0":Z.toString()}}if(typeof Z=="bigint")return q.relaxed?Number(BigInt.asIntN(64,Z)):{$numberLong:BigInt.asIntN(64,Z).toString()};if(Z instanceof RegExp||g(Z)){let Ee=Z.flags;if(Ee===void 0){const ye=Z.toString().match(/[gimuy]*$/);ye&&(Ee=ye[0])}return new Jt(Z.source,Ee).toExtendedJSON(q)}return Z!=null&&typeof Z=="object"?function(Ee,ye){if(Ee==null||typeof Ee!="object")throw new X("not an object instance");const it=Ee._bsontype;if(it===void 0){const st={};for(const At of Object.keys(Ee)){ye.seenObjects.push({propertyName:At,obj:null});try{const qt=Gi(Ee[At],ye);At==="__proto__"?Object.defineProperty(st,At,{value:qt,writable:!0,enumerable:!0,configurable:!0}):st[At]=qt}finally{ye.seenObjects.pop()}}return st}if(Ee!=null&&typeof Ee=="object"&&typeof Ee._bsontype=="string"&&Ee[Symbol.for("@@mdb.bson.version")]!==p)throw new ee;if(function(st){return st!=null&&typeof st=="object"&&"_bsontype"in st&&typeof st._bsontype=="string"}(Ee)){let st=Ee;if(typeof st.toExtendedJSON!="function"){const At=sa[Ee._bsontype];if(!At)throw new X("Unrecognized or invalid _bsontype: "+Ee._bsontype);st=At(st)}return it==="Code"&&st.scope?st=new Ct(st.code,Gi(st.scope,ye)):it==="DBRef"&&st.oid&&(st=new xt(Gi(st.collection,ye),Gi(st.oid,ye),Gi(st.db,ye),Gi(st.fields,ye))),st.toExtendedJSON(ye)}throw new X("_bsontype must be a string, but was: "+typeof it)}(Z,q):Z}const sa={Binary:Z=>new et(Z.value(),Z.sub_type),Code:Z=>new Ct(Z.code,Z.scope),DBRef:Z=>new xt(Z.collection||Z.namespace,Z.oid,Z.db,Z.fields),Decimal128:Z=>new Fe(Z.bytes),Double:Z=>new Xe(Z.value),Int32:Z=>new Ge(Z.value),Long:Z=>dt.fromBits(Z.low!=null?Z.low:Z.low_,Z.low!=null?Z.high:Z.high_,Z.low!=null?Z.unsigned:Z.unsigned_),MaxKey:()=>new rt,MinKey:()=>new bt,ObjectId:Z=>new Kt(Z),BSONRegExp:Z=>new Jt(Z.pattern,Z.options),BSONSymbol:Z=>new ln(Z.value),Timestamp:Z=>wn.fromBits(Z.low,Z.high)};function Va(Z,q){const Ee={useBigInt64:(q==null?void 0:q.useBigInt64)??!1,relaxed:(q==null?void 0:q.relaxed)??!0,legacy:(q==null?void 0:q.legacy)??!1};return JSON.parse(Z,(ye,it)=>{if(ye.indexOf("\0")!==-1)throw new X(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(ye)}`);return Wi(it,Ee)})}function Xl(Z,q,Ee,ye){Ee!=null&&typeof Ee=="object"&&(ye=Ee,Ee=0),q==null||typeof q!="object"||Array.isArray(q)||(ye=q,q=void 0,Ee=0);const it=Gi(Z,Object.assign({relaxed:!0,legacy:!1},ye,{seenObjects:[{propertyName:"(root)",obj:null}]}));return JSON.stringify(it,q,Ee)}const Mr=Object.create(null);Mr.parse=Va,Mr.stringify=Xl,Mr.serialize=function(Z,q){return q=q||{},JSON.parse(Xl(Z,q))},Mr.deserialize=function(Z,q){return q=q||{},Va(JSON.stringify(Z),q)},Object.freeze(Mr);const ke=17825792;let Ve=le.allocate(ke);function nt(Z){Ve.length<Z&&(Ve=le.allocate(Z))}function ut(Z,q={}){const Ee=typeof q.checkKeys=="boolean"&&q.checkKeys,ye=typeof q.serializeFunctions=="boolean"&&q.serializeFunctions,it=typeof q.ignoreUndefined!="boolean"||q.ignoreUndefined,st=typeof q.minInternalBufferSize=="number"?q.minInternalBufferSize:ke;Ve.length<st&&(Ve=le.allocate(st));const At=co(Ve,Z,Ee,0,0,ye,it,null),qt=le.allocate(At);return qt.set(Ve.subarray(0,At),0),qt}function _t(Z,q,Ee={}){const ye=typeof Ee.checkKeys=="boolean"&&Ee.checkKeys,it=typeof Ee.serializeFunctions=="boolean"&&Ee.serializeFunctions,st=typeof Ee.ignoreUndefined!="boolean"||Ee.ignoreUndefined,At=typeof Ee.index=="number"?Ee.index:0,qt=co(Ve,Z,ye,0,0,it,st,null);return q.set(Ve.subarray(0,qt),At),At+qt-1}function St(Z,q={}){return bn(le.toLocalBufferType(Z),q)}function Dt(Z,q={}){return Yt(Z,typeof(q=q||{}).serializeFunctions=="boolean"&&q.serializeFunctions,typeof q.ignoreUndefined!="boolean"||q.ignoreUndefined)}function Mt(Z,q,Ee,ye,it,st){const At=Object.assign({allowObjectSmallerThanBufferSize:!0,index:0},st),qt=le.toLocalBufferType(Z);let gt=q;for(let Xt=0;Xt<Ee;Xt++){const Vt=qt[gt]|qt[gt+1]<<8|qt[gt+2]<<16|qt[gt+3]<<24;At.index=gt,ye[it+Xt]=bn(qt,At),gt+=Vt}return gt}var pt=Object.freeze({__proto__:null,BSONError:X,BSONRegExp:Jt,BSONRuntimeError:Le,BSONSymbol:ln,BSONType:ot,BSONValue:Je,BSONVersionError:ee,Binary:et,Code:Ct,DBRef:xt,Decimal128:Fe,Double:Xe,EJSON:Mr,Int32:Ge,Long:dt,MaxKey:rt,MinKey:bt,ObjectId:Kt,Timestamp:wn,UUID:It,calculateObjectSize:Dt,deserialize:St,deserializeStream:Mt,serialize:ut,serializeWithBufferAndIndex:_t,setInternalBufferSize:nt});l.BSON=pt,l.BSONError=X,l.BSONRegExp=Jt,l.BSONRuntimeError=Le,l.BSONSymbol=ln,l.BSONType=ot,l.BSONValue=Je,l.BSONVersionError=ee,l.Binary=et,l.Code=Ct,l.DBRef=xt,l.Decimal128=Fe,l.Double=Xe,l.EJSON=Mr,l.Int32=Ge,l.Long=dt,l.MaxKey=rt,l.MinKey=bt,l.ObjectId=Kt,l.Timestamp=wn,l.UUID=It,l.calculateObjectSize=Dt,l.deserialize=St,l.deserializeStream=Mt,l.serialize=ut,l.serializeWithBufferAndIndex=_t,l.setInternalBufferSize=nt},4946:a=>{a.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')},5207:a=>{a.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')},1308:a=>{a.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')},9799:a=>{a.exports=JSON.parse('{"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}')},8597:a=>{a.exports={i8:"6.5.4"}},2562:a=>{a.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')}},i={};function c(a){var l=i[a];if(l!==void 0)return l.exports;var r=i[a]={id:a,loaded:!1,exports:{}};return t[a].call(r.exports,r,r.exports,c),r.loaded=!0,r.exports}return c.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),c.nmd=a=>(a.paths=[],a.children||(a.children=[]),a),c(5507)})())})(yV);const bV=()=>{const[n,e]=Wt.useState({fullName:"",username:"",password:"",confirmPassword:"",role:"user",profilePic:null,latitude:null,longitude:null,address:""}),{loading:t,signup:i}=uV(),c=(m,v)=>{console.log(m,{option:v}),e({...n,address:v.display_name||v.name,latitude:v.lat,longitude:v.lon})},a=m=>{e({...n,role:m.target.value})};document.querySelectorAll("form").forEach(m=>{m.addEventListener("submit",v=>{v.preventDefault()})});const r=async m=>{const v=m.target.files[0];if(v){const g=D8(L8,`files/${v.name}-${yR()}`);try{const _=await mR(g,v),E=await gR(_.ref);e({...n,profilePic:E})}catch(_){console.error("Error uploading file:",_),alert("Error uploading file. Please try again.")}}},h=async m=>{m.preventDefault();const v=/^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,}$/;if(n.fullName.length<6){alert("Full Name must be at least 6 characters long");return}if(n.username.length<6){alert("Username must be at least 6 characters long");return}if(n.address===""){alert("Please enter an address");return}if(!n.profilePic){alert("Please upload a profile picture");return}if(n.password!==n.confirmPassword){alert("Passwords do not match");return}if(!v.test(n.password)){alert("Password must be at least 8 characters long, start with a capital letter, and contain at least one digit and one special character.");return}console.log(n),await i(n)};return Qe.jsx("div",{className:"min-h-screen w-full bg-cover bg-center flex items-center justify-center",style:{backgroundImage:`url(${UI})`,backgroungSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},children:Qe.jsx("div",{className:"flex flex-col bg-white rounded-xl items-center justify-center min-w-96  mx-auto",children:Qe.jsxs("div",{className:"w-full p-6 rounded-lg  bg-gray-400 h-[90vh] overflow-y-auto no-scrollbar shadow-xl bg-clip-padding backdrop-filter backdrop-blur-lg bg-opacity-0",children:[Qe.jsxs("h1",{className:"text-3xl font-semibold text-center text-black",children:["Sign Up ",Qe.jsx("span",{className:"text-blue-500",children:" PrintOnGo"})]}),Qe.jsxs("form",{onSubmit:h,encType:"multipart/form-data",children:[Qe.jsxs("div",{children:[Qe.jsx("label",{className:"label p-2",children:Qe.jsx("span",{className:"text-base label-text",children:"Full Name"})}),Qe.jsx("input",{type:"text",placeholder:"John Doe",className:"w-full input !bg-gray-100  input-bordered h-10",value:n.fullName,onChange:m=>e({...n,fullName:m.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{className:"label p-2",children:Qe.jsx("span",{className:"text-base label-text",children:"Username"})}),Qe.jsx("input",{type:"text",placeholder:"johndoe",className:"w-full input !bg-gray-100  input-bordered h-10",value:n.username,onChange:m=>e({...n,username:m.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{className:"label",children:Qe.jsx("span",{className:"text-base label-text",children:"Password"})}),Qe.jsx("input",{type:"password",placeholder:"Enter Password",className:"w-full input !bg-gray-100  input-bordered h-10",value:n.password,onChange:m=>e({...n,password:m.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{className:"label",children:Qe.jsx("span",{className:"text-base label-text",children:"Confirm Password"})}),Qe.jsx("input",{type:"password",placeholder:"Confirm Password",className:"w-full input !bg-gray-100  input-bordered h-10",value:n.confirmPassword,onChange:m=>e({...n,confirmPassword:m.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{className:"label p-2",children:Qe.jsx("span",{className:"text-base label-text",children:"Role"})}),Qe.jsxs("select",{className:"w-full select !bg-gray-100 select-bordered h-10",value:n.role,onChange:a,children:[Qe.jsx("option",{value:"user",children:"User"}),Qe.jsx("option",{value:"shop",children:"Shop"})]})]}),Qe.jsx("label",{className:"label p-2",children:Qe.jsx("span",{className:"text-base label-text",children:"Address"})}),Qe.jsx(gV,{className:"md:w-full lg:w-full ",value:null,onChange:m=>c("First component",m)}),Qe.jsxs("div",{className:"mt-2 ",children:[Qe.jsx("label",{className:"label p-2",children:Qe.jsx("span",{className:"text-base  label-text",children:"Profile Picture"})}),Qe.jsx("input",{type:"file",accept:"image/*",className:"w-full file-input !bg-gray-100 text-black file-input-bordered h-10",onChange:r,required:"true"})]}),Qe.jsx(NI,{to:"/login",className:"text-sm hover:underline hover:text-blue-600 mt-2 inline-block",children:"Already have an account?"}),Qe.jsx("div",{children:Qe.jsx("button",{className:"btn btn-block btn-sm mt-2 border  border-slate-700",disabled:t,children:t?Qe.jsx("span",{className:"loading loading-spinner"}):"Sign Up"})})]})]})})})};var bR={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(n,e){(function(t,i){n.exports=i()})(mM,function(){var t={},i={};function c(l,r,h){if(i[l]=h,l==="index"){var m="var sharedModule = {}; ("+i.shared+")(sharedModule); ("+i.worker+")(sharedModule);",v={};return i.shared(v),i.index(t,v),typeof window<"u"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([m],{type:"text/javascript"}))),t}}c("shared",["exports"],function(l){function r(u,s,d,k){return new(d||(d=Promise))(function(I,F){function V(ue){try{ne(k.next(ue))}catch(xe){F(xe)}}function K(ue){try{ne(k.throw(ue))}catch(xe){F(xe)}}function ne(ue){var xe;ue.done?I(ue.value):(xe=ue.value,xe instanceof d?xe:new d(function(Te){Te(xe)})).then(V,K)}ne((k=k.apply(u,s||[])).next())})}function h(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var m=v;function v(u,s){this.x=u,this.y=s}v.prototype={clone:function(){return new v(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,s){return this.clone()._rotateAround(u,s)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var s=u.x-this.x,d=u.y-this.y;return s*s+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,s){return Math.atan2(this.x*s-this.y*u,this.x*u+this.y*s)},_matMult:function(u){var s=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=s,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var s=Math.cos(u),d=Math.sin(u),k=d*this.x+s*this.y;return this.x=s*this.x-d*this.y,this.y=k,this},_rotateAround:function(u,s){var d=Math.cos(u),k=Math.sin(u),I=s.y+k*(this.x-s.x)+d*(this.y-s.y);return this.x=s.x+d*(this.x-s.x)-k*(this.y-s.y),this.y=I,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},v.convert=function(u){return u instanceof v?u:Array.isArray(u)?new v(u[0],u[1]):u};var g=h(m),_=E;function E(u,s,d,k){this.cx=3*u,this.bx=3*(d-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(k-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=s,this.p2x=d,this.p2y=k}E.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,s){if(s===void 0&&(s=1e-6),u<0)return 0;if(u>1)return 1;for(var d=u,k=0;k<8;k++){var I=this.sampleCurveX(d)-u;if(Math.abs(I)<s)return d;var F=this.sampleCurveDerivativeX(d);if(Math.abs(F)<1e-6)break;d-=I/F}var V=0,K=1;for(d=u,k=0;k<20&&(I=this.sampleCurveX(d),!(Math.abs(I-u)<s));k++)u>I?V=d:K=d,d=.5*(K-V)+V;return d},solve:function(u,s){return this.sampleCurveY(this.solveCurveX(u,s))}};var b=h(_);let p,x;function y(){return p==null&&(p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),p}function f(){if(x==null&&(x=!1,y())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let k=0;k<5*5;k++){const I=4*k;s.fillStyle=`rgb(${I},${I+1},${I+2})`,s.fillRect(k%5,Math.floor(k/5),1,1)}const d=s.getImageData(0,0,5,5).data;for(let k=0;k<5*5*4;k++)if(k%4!=3&&d[k]!==k){x=!0;break}}}return x||!1}function w(u,s,d,k){const I=new b(u,s,d,k);return F=>I.solve(F)}const A=w(.25,.1,.25,1);function P(u,s,d){return Math.min(d,Math.max(s,u))}function T(u,s,d){const k=d-s,I=((u-s)%k+k)%k+s;return I===s?d:I}function R(u,...s){for(const d of s)for(const k in d)u[k]=d[k];return u}let M=1;function L(u,s,d){const k={};for(const I in u)k[I]=s.call(this,u[I],I,u);return k}function W(u,s,d){const k={};for(const I in u)s.call(this,u[I],I,u)&&(k[I]=u[I]);return k}function G(u){return Array.isArray(u)?u.map(G):typeof u=="object"&&u?L(u,G):u}const re={};function Q(u){re[u]||(typeof console<"u"&&console.warn(u),re[u]=!0)}function oe(u,s,d){return(d.y-u.y)*(s.x-u.x)>(s.y-u.y)*(d.x-u.x)}function ae(u){return typeof WorkerGlobalScope<"u"&&u!==void 0&&u instanceof WorkerGlobalScope}let de=null;function be(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function U(u,s,d,k,I){return r(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const F=new VideoFrame(u,{timestamp:0});try{const V=F==null?void 0:F.format;if(!V||!V.startsWith("BGR")&&!V.startsWith("RGB"))throw new Error(`Unrecognized format ${V}`);const K=V.startsWith("BGR"),ne=new Uint8ClampedArray(k*I*4);if(yield F.copyTo(ne,function(ue,xe,Te,Ne,Ue){const Ke=4*Math.max(-xe,0),Ze=(Math.max(0,Te)-Te)*Ne*4+Ke,ct=4*Ne,mt=Math.max(0,xe),Bt=Math.max(0,Te);return{rect:{x:mt,y:Bt,width:Math.min(ue.width,xe+Ne)-mt,height:Math.min(ue.height,Te+Ue)-Bt},layout:[{offset:Ze,stride:ct}]}}(u,s,d,k,I)),K)for(let ue=0;ue<ne.length;ue+=4){const xe=ne[ue];ne[ue]=ne[ue+2],ne[ue+2]=xe}return ne}finally{F.close()}})}let B,N;const z="AbortError";function H(){return new Error(z)}const Y={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function fe(u){return Y.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))]}const Re="global-dispatcher";class Oe extends Error{constructor(s,d,k,I){super(`AJAXError: ${d} (${s}): ${k}`),this.status=s,this.statusText=d,this.url=k,this.body=I}}const De=()=>ae(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ot=function(u,s){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){const k=fe(u.url);if(k)return k(u,s);if(ae(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,targetMapId:Re},s)}if(!(/^file:/.test(d=u.url)||/^file:/.test(De())&&!/^\w+:/.test(d))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(k,I){return r(this,void 0,void 0,function*(){const F=new Request(k.url,{method:k.method||"GET",body:k.body,credentials:k.credentials,headers:k.headers,cache:k.cache,referrer:De(),signal:I.signal});k.type!=="json"||F.headers.has("Accept")||F.headers.set("Accept","application/json");const V=yield fetch(F);if(!V.ok){const ue=yield V.blob();throw new Oe(V.status,V.statusText,k.url,ue)}let K;K=k.type==="arrayBuffer"||k.type==="image"?V.arrayBuffer():k.type==="json"?V.json():V.text();const ne=yield K;if(I.signal.aborted)throw H();return{data:ne,cacheControl:V.headers.get("Cache-Control"),expires:V.headers.get("Expires")}})}(u,s);if(ae(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:u,mustQueue:!0,targetMapId:Re},s)}var d;return function(k,I){return new Promise((F,V)=>{var K;const ne=new XMLHttpRequest;ne.open(k.method||"GET",k.url,!0),k.type!=="arrayBuffer"&&k.type!=="image"||(ne.responseType="arraybuffer");for(const ue in k.headers)ne.setRequestHeader(ue,k.headers[ue]);k.type==="json"&&(ne.responseType="text",!((K=k.headers)===null||K===void 0)&&K.Accept||ne.setRequestHeader("Accept","application/json")),ne.withCredentials=k.credentials==="include",ne.onerror=()=>{V(new Error(ne.statusText))},ne.onload=()=>{if(!I.signal.aborted)if((ne.status>=200&&ne.status<300||ne.status===0)&&ne.response!==null){let ue=ne.response;if(k.type==="json")try{ue=JSON.parse(ne.response)}catch(xe){return void V(xe)}F({data:ue,cacheControl:ne.getResponseHeader("Cache-Control"),expires:ne.getResponseHeader("Expires")})}else{const ue=new Blob([ne.response],{type:ne.getResponseHeader("Content-Type")});V(new Oe(ne.status,ne.statusText,k.url,ue))}},I.signal.addEventListener("abort",()=>{ne.abort(),V(H())}),ne.send(k.body)})}(u,s)};function X(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;const s=new URL(u),d=window.location;return s.protocol===d.protocol&&s.host===d.host}function ee(u,s,d){d[u]&&d[u].indexOf(s)!==-1||(d[u]=d[u]||[],d[u].push(s))}function Le(u,s,d){if(d&&d[u]){const k=d[u].indexOf(s);k!==-1&&d[u].splice(k,1)}}class Be{constructor(s,d={}){R(this,d),this.type=s}}class se extends Be{constructor(s,d={}){super("error",R({error:s},d))}}class _e{on(s,d){return this._listeners=this._listeners||{},ee(s,d,this._listeners),this}off(s,d){return Le(s,d,this._listeners),Le(s,d,this._oneTimeListeners),this}once(s,d){return d?(this._oneTimeListeners=this._oneTimeListeners||{},ee(s,d,this._oneTimeListeners),this):new Promise(k=>this.once(s,k))}fire(s,d){typeof s=="string"&&(s=new Be(s,d||{}));const k=s.type;if(this.listens(k)){s.target=this;const I=this._listeners&&this._listeners[k]?this._listeners[k].slice():[];for(const K of I)K.call(this,s);const F=this._oneTimeListeners&&this._oneTimeListeners[k]?this._oneTimeListeners[k].slice():[];for(const K of F)Le(k,K,this._oneTimeListeners),K.call(this,s);const V=this._eventedParent;V&&(R(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),V.fire(s))}else s instanceof se&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,d){return this._eventedParent=s,this._eventedParentData=d,this}}var te={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const $e=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ge(u,s){const d={};for(const k in u)k!=="ref"&&(d[k]=u[k]);return $e.forEach(k=>{k in s&&(d[k]=s[k])}),d}function le(u,s){if(Array.isArray(u)){if(!Array.isArray(s)||u.length!==s.length)return!1;for(let d=0;d<u.length;d++)if(!le(u[d],s[d]))return!1;return!0}if(typeof u=="object"&&u!==null&&s!==null){if(typeof s!="object"||Object.keys(u).length!==Object.keys(s).length)return!1;for(const d in u)if(!le(u[d],s[d]))return!1;return!0}return u===s}function ze(u,s){u.push(s)}function Je(u,s,d){ze(d,{command:"addSource",args:[u,s[u]]})}function et(u,s,d){ze(s,{command:"removeSource",args:[u]}),d[u]=!0}function ft(u,s,d,k){et(u,d,k),Je(u,s,d)}function wt(u,s,d){let k;for(k in u[d])if(Object.prototype.hasOwnProperty.call(u[d],k)&&k!=="data"&&!le(u[d][k],s[d][k]))return!1;for(k in s[d])if(Object.prototype.hasOwnProperty.call(s[d],k)&&k!=="data"&&!le(u[d][k],s[d][k]))return!1;return!0}function It(u,s,d,k,I,F){u=u||{},s=s||{};for(const V in u)Object.prototype.hasOwnProperty.call(u,V)&&(le(u[V],s[V])||d.push({command:F,args:[k,V,s[V],I]}));for(const V in s)Object.prototype.hasOwnProperty.call(s,V)&&!Object.prototype.hasOwnProperty.call(u,V)&&(le(u[V],s[V])||d.push({command:F,args:[k,V,s[V],I]}))}function Ct(u){return u.id}function tn(u,s){return u[s.id]=s,u}class xt{constructor(s,d,k,I){this.message=(s?`${s}: `:"")+k,I&&(this.identifier=I),d!=null&&d.__line__&&(this.line=d.__line__)}}function Ht(u,...s){for(const d of s)for(const k in d)u[k]=d[k];return u}class en extends Error{constructor(s,d){super(d),this.message=d,this.key=s}}class kn{constructor(s,d=[]){this.parent=s,this.bindings={};for(const[k,I]of d)this.bindings[k]=I}concat(s){return new kn(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Dn={kind:"null"},Ft={kind:"number"},Tt={kind:"string"},rn={kind:"boolean"},dt={kind:"color"},qn={kind:"object"},fn={kind:"value"},dr={kind:"collator"},Xn={kind:"formatted"},Ir={kind:"padding"},Ae={kind:"resolvedImage"},ve={kind:"variableAnchorOffsetCollection"};function he(u,s){return{kind:"array",itemType:u,N:s}}function me(u){if(u.kind==="array"){const s=me(u.itemType);return typeof u.N=="number"?`array<${s}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${s}>`}return u.kind}const we=[Dn,Ft,Tt,rn,dt,Xn,qn,he(fn),Ir,Ae,ve];function je(u,s){if(s.kind==="error")return null;if(u.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!je(u.itemType,s.itemType))&&(typeof u.N!="number"||u.N===s.N))return null}else{if(u.kind===s.kind)return null;if(u.kind==="value"){for(const d of we)if(!je(d,s))return null}}return`Expected ${me(u)} but found ${me(s)} instead.`}function qe(u,s){return s.some(d=>d.kind===u.kind)}function Fe(u,s){return s.some(d=>d==="null"?u===null:d==="array"?Array.isArray(u):d==="object"?u&&!Array.isArray(u)&&typeof u=="object":d===typeof u)}function Xe(u,s){return u.kind==="array"&&s.kind==="array"?u.itemType.kind===s.itemType.kind&&typeof u.N=="number":u.kind===s.kind}const Ge=.96422,rt=.82521,bt=4/29,at=6/29,Et=3*at*at,jt=at*at*at,Kt=Math.PI/180,Yt=180/Math.PI;function Zt(u){return(u%=360)<0&&(u+=360),u}function Jt([u,s,d,k]){let I,F;const V=vn((.2225045*(u=ln(u))+.7168786*(s=ln(s))+.0606169*(d=ln(d)))/1);u===s&&s===d?I=F=V:(I=vn((.4360747*u+.3850649*s+.1430804*d)/Ge),F=vn((.0139322*u+.0971045*s+.7141733*d)/rt));const K=116*V-16;return[K<0?0:K,500*(I-V),200*(V-F),k]}function ln(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function vn(u){return u>jt?Math.pow(u,1/3):u/Et+bt}function wn([u,s,d,k]){let I=(u+16)/116,F=isNaN(s)?I:I+s/500,V=isNaN(d)?I:I-d/200;return I=1*xn(I),F=Ge*xn(F),V=rt*xn(V),[cn(3.1338561*F-1.6168667*I-.4906146*V),cn(-.9787684*F+1.9161415*I+.033454*V),cn(.0719453*F-.2289914*I+1.4052427*V),k]}function cn(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function xn(u){return u>at?u*u*u:Et*(u-bt)}function cr(u){return parseInt(u.padEnd(2,u),16)/255}function br(u,s){return hr(s?u/100:u,0,1)}function hr(u,s,d){return Math.min(Math.max(s,u),d)}function pr(u){return!u.some(Number.isNaN)}const Kr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class mn{constructor(s,d,k,I=1,F=!0){this.r=s,this.g=d,this.b=k,this.a=I,F||(this.r*=I,this.g*=I,this.b*=I,I||this.overwriteGetter("rgb",[s,d,k,I]))}static parse(s){if(s instanceof mn)return s;if(typeof s!="string")return;const d=function(k){if((k=k.toLowerCase().trim())==="transparent")return[0,0,0,0];const I=Kr[k];if(I){const[V,K,ne]=I;return[V/255,K/255,ne/255,1]}if(k.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(k)){const V=k.length<6?1:2;let K=1;return[cr(k.slice(K,K+=V)),cr(k.slice(K,K+=V)),cr(k.slice(K,K+=V)),cr(k.slice(K,K+V)||"ff")]}if(k.startsWith("rgb")){const V=k.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(V){const[K,ne,ue,xe,Te,Ne,Ue,Ke,Ze,ct,mt,Bt]=V,Pt=[xe||" ",Ue||" ",ct].join("");if(Pt==="  "||Pt==="  /"||Pt===",,"||Pt===",,,"){const $t=[ue,Ne,Ze].join(""),Gt=$t==="%%%"?100:$t===""?255:0;if(Gt){const dn=[hr(+ne/Gt,0,1),hr(+Te/Gt,0,1),hr(+Ke/Gt,0,1),mt?br(+mt,Bt):1];if(pr(dn))return dn}}return}}const F=k.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(F){const[V,K,ne,ue,xe,Te,Ne,Ue,Ke]=F,Ze=[ne||" ",xe||" ",Ne].join("");if(Ze==="  "||Ze==="  /"||Ze===",,"||Ze===",,,"){const ct=[+K,hr(+ue,0,100),hr(+Te,0,100),Ue?br(+Ue,Ke):1];if(pr(ct))return function([mt,Bt,Pt,$t]){function Gt(dn){const $n=(dn+mt/30)%12,_r=Bt*Math.min(Pt,1-Pt);return Pt-_r*Math.max(-1,Math.min($n-3,9-$n,1))}return mt=Zt(mt),Bt/=100,Pt/=100,[Gt(0),Gt(8),Gt(4),$t]}(ct)}}}(s);return d?new mn(...d,!1):void 0}get rgb(){const{r:s,g:d,b:k,a:I}=this,F=I||1/0;return this.overwriteGetter("rgb",[s/F,d/F,k/F,I])}get hcl(){return this.overwriteGetter("hcl",function(s){const[d,k,I,F]=Jt(s),V=Math.sqrt(k*k+I*I);return[Math.round(1e4*V)?Zt(Math.atan2(I,k)*Yt):NaN,V,d,F]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Jt(this.rgb))}overwriteGetter(s,d){return Object.defineProperty(this,s,{value:d}),d}toString(){const[s,d,k,I]=this.rgb;return`rgba(${[s,d,k].map(F=>Math.round(255*F)).join(",")},${I})`}}mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1);class oi{constructor(s,d,k){this.sensitivity=s?d?"variant":"case":d?"accent":"base",this.locale=k,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,d){return this.collator.compare(s,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class eo{constructor(s,d,k,I,F){this.text=s,this.image=d,this.scale=k,this.fontStack=I,this.textColor=F}}class nn{constructor(s){this.sections=s}static fromString(s){return new nn([new eo(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof nn?s:nn.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}}class on{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof on)return s;if(typeof s=="number")return new on([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const d of s)if(typeof d!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new on(s)}}toString(){return JSON.stringify(this.values)}}const bn=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ir{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof ir)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let d=0;d<s.length;d+=2){const k=s[d],I=s[d+1];if(typeof k!="string"||!bn.has(k)||!Array.isArray(I)||I.length!==2||typeof I[0]!="number"||typeof I[1]!="number")return}return new ir(s)}}toString(){return JSON.stringify(this.values)}}class On{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new On({name:s,available:!1}):null}}function Ar(u,s,d,k){return typeof u=="number"&&u>=0&&u<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof d=="number"&&d>=0&&d<=255?k===void 0||typeof k=="number"&&k>=0&&k<=1?null:`Invalid rgba value [${[u,s,d,k].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof k=="number"?[u,s,d,k]:[u,s,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zr(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof mn||u instanceof oi||u instanceof nn||u instanceof on||u instanceof ir||u instanceof On)return!0;if(Array.isArray(u)){for(const s of u)if(!zr(s))return!1;return!0}if(typeof u=="object"){for(const s in u)if(!zr(u[s]))return!1;return!0}return!1}function kr(u){if(u===null)return Dn;if(typeof u=="string")return Tt;if(typeof u=="boolean")return rn;if(typeof u=="number")return Ft;if(u instanceof mn)return dt;if(u instanceof oi)return dr;if(u instanceof nn)return Xn;if(u instanceof on)return Ir;if(u instanceof ir)return ve;if(u instanceof On)return Ae;if(Array.isArray(u)){const s=u.length;let d;for(const k of u){const I=kr(k);if(d){if(d===I)continue;d=fn;break}d=I}return he(d||fn,s)}return qn}function ui(u){const s=typeof u;return u===null?"":s==="string"||s==="number"||s==="boolean"?String(u):u instanceof mn||u instanceof nn||u instanceof on||u instanceof ir||u instanceof On?u.toString():JSON.stringify(u)}class Jr{constructor(s,d){this.type=s,this.value=d}static parse(s,d){if(s.length!==2)return d.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!zr(s[1]))return d.error("invalid value");const k=s[1];let I=kr(k);const F=d.expectedType;return I.kind!=="array"||I.N!==0||!F||F.kind!=="array"||typeof F.N=="number"&&F.N!==0||(I=F),new Jr(I,k)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Xr{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const wi={string:Tt,number:Ft,boolean:rn,object:qn};class Wn{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");let k,I=1;const F=s[0];if(F==="array"){let K,ne;if(s.length>2){const ue=s[1];if(typeof ue!="string"||!(ue in wi)||ue==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);K=wi[ue],I++}else K=fn;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return d.error('The length argument to "array" must be a positive integer literal',2);ne=s[2],I++}k=he(K,ne)}else{if(!wi[F])throw new Error(`Types doesn't contain name = ${F}`);k=wi[F]}const V=[];for(;I<s.length;I++){const K=d.parse(s[I],I,fn);if(!K)return null;V.push(K)}return new Wn(k,V)}evaluate(s){for(let d=0;d<this.args.length;d++){const k=this.args[d].evaluate(s);if(!je(this.type,kr(k)))return k;if(d===this.args.length-1)throw new Xr(`Expected value to be of type ${me(this.type)}, but found ${me(kr(k))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const hi={"to-boolean":rn,"to-color":dt,"to-number":Ft,"to-string":Tt};class pi{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");const k=s[0];if(!hi[k])throw new Error(`Can't parse ${k} as it is not part of the known types`);if((k==="to-boolean"||k==="to-string")&&s.length!==2)return d.error("Expected one argument.");const I=hi[k],F=[];for(let V=1;V<s.length;V++){const K=d.parse(s[V],V,fn);if(!K)return null;F.push(K)}return new pi(I,F)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let d,k;for(const I of this.args){if(d=I.evaluate(s),k=null,d instanceof mn)return d;if(typeof d=="string"){const F=s.parseColor(d);if(F)return F}else if(Array.isArray(d)&&(k=d.length<3||d.length>4?`Invalid rbga value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:Ar(d[0],d[1],d[2],d[3]),!k))return new mn(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Xr(k||`Could not parse color from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"padding":{let d;for(const k of this.args){d=k.evaluate(s);const I=on.parse(d);if(I)return I}throw new Xr(`Could not parse padding from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"variableAnchorOffsetCollection":{let d;for(const k of this.args){d=k.evaluate(s);const I=ir.parse(d);if(I)return I}throw new Xr(`Could not parse variableAnchorOffsetCollection from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}case"number":{let d=null;for(const k of this.args){if(d=k.evaluate(s),d===null)return 0;const I=Number(d);if(!isNaN(I))return I}throw new Xr(`Could not convert ${JSON.stringify(d)} to number.`)}case"formatted":return nn.fromString(ui(this.args[0].evaluate(s)));case"resolvedImage":return On.fromString(ui(this.args[0].evaluate(s)));default:return ui(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const ns=["Unknown","Point","LineString","Polygon"];class ki{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ns[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let d=this._parseColorCache[s];return d||(d=this._parseColorCache[s]=mn.parse(s)),d}}class Di{constructor(s,d,k=[],I,F=new kn,V=[]){this.registry=s,this.path=k,this.key=k.map(K=>`[${K}]`).join(""),this.scope=F,this.errors=V,this.expectedType=I,this._isConstant=d}parse(s,d,k,I,F={}){return d?this.concat(d,k,I)._parse(s,F):this._parse(s,F)}_parse(s,d){function k(I,F,V){return V==="assert"?new Wn(F,[I]):V==="coerce"?new pi(F,[I]):I}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const I=s[0];if(typeof I!="string")return this.error(`Expression name must be a string, but found ${typeof I} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const F=this.registry[I];if(F){let V=F.parse(s,this);if(!V)return null;if(this.expectedType){const K=this.expectedType,ne=V.type;if(K.kind!=="string"&&K.kind!=="number"&&K.kind!=="boolean"&&K.kind!=="object"&&K.kind!=="array"||ne.kind!=="value")if(K.kind!=="color"&&K.kind!=="formatted"&&K.kind!=="resolvedImage"||ne.kind!=="value"&&ne.kind!=="string")if(K.kind!=="padding"||ne.kind!=="value"&&ne.kind!=="number"&&ne.kind!=="array")if(K.kind!=="variableAnchorOffsetCollection"||ne.kind!=="value"&&ne.kind!=="array"){if(this.checkSubtype(K,ne))return null}else V=k(V,K,d.typeAnnotation||"coerce");else V=k(V,K,d.typeAnnotation||"coerce");else V=k(V,K,d.typeAnnotation||"coerce");else V=k(V,K,d.typeAnnotation||"assert")}if(!(V instanceof Jr)&&V.type.kind!=="resolvedImage"&&this._isConstant(V)){const K=new ki;try{V=new Jr(V.type,V.evaluate(K))}catch(ne){return this.error(ne.message),null}}return V}return this.error(`Unknown expression "${I}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,d,k){const I=typeof s=="number"?this.path.concat(s):this.path,F=k?this.scope.concat(k):this.scope;return new Di(this.registry,this._isConstant,I,d||null,F,this.errors)}error(s,...d){const k=`${this.key}${d.map(I=>`[${I}]`).join("")}`;this.errors.push(new en(k,s))}checkSubtype(s,d){const k=je(s,d);return k&&this.error(k),k}}class Hi{constructor(s,d){this.type=d.type,this.bindings=[].concat(s),this.result=d}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const d of this.bindings)s(d[1]);s(this.result)}static parse(s,d){if(s.length<4)return d.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const k=[];for(let F=1;F<s.length-1;F+=2){const V=s[F];if(typeof V!="string")return d.error(`Expected string, but found ${typeof V} instead.`,F);if(/[^a-zA-Z0-9_]/.test(V))return d.error("Variable names must contain only alphanumeric characters or '_'.",F);const K=d.parse(s[F+1],F+1);if(!K)return null;k.push([V,K])}const I=d.parse(s[s.length-1],s.length-1,d.expectedType,k);return I?new Hi(k,I):null}outputDefined(){return this.result.outputDefined()}}class Ur{constructor(s,d){this.type=d.type,this.name=s,this.boundExpression=d}static parse(s,d){if(s.length!==2||typeof s[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");const k=s[1];return d.scope.has(k)?new Ur(k,d.scope.get(k)):d.error(`Unknown variable "${k}". Make sure "${k}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class Io{constructor(s,d,k){this.type=s,this.index=d,this.input=k}static parse(s,d){if(s.length!==3)return d.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const k=d.parse(s[1],1,Ft),I=d.parse(s[2],2,he(d.expectedType||fn));return k&&I?new Io(I.type.itemType,k,I):null}evaluate(s){const d=this.index.evaluate(s),k=this.input.evaluate(s);if(d<0)throw new Xr(`Array index out of bounds: ${d} < 0.`);if(d>=k.length)throw new Xr(`Array index out of bounds: ${d} > ${k.length-1}.`);if(d!==Math.floor(d))throw new Xr(`Array index must be an integer, but found ${d} instead.`);return k[d]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class rs{constructor(s,d){this.type=rn,this.needle=s,this.haystack=d}static parse(s,d){if(s.length!==3)return d.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const k=d.parse(s[1],1,fn),I=d.parse(s[2],2,fn);return k&&I?qe(k.type,[rn,Tt,Ft,Dn,fn])?new rs(k,I):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${me(k.type)} instead`):null}evaluate(s){const d=this.needle.evaluate(s),k=this.haystack.evaluate(s);if(!k)return!1;if(!Fe(d,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${me(kr(d))} instead.`);if(!Fe(k,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${me(kr(k))} instead.`);return k.indexOf(d)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class ao{constructor(s,d,k){this.type=Ft,this.needle=s,this.haystack=d,this.fromIndex=k}static parse(s,d){if(s.length<=2||s.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const k=d.parse(s[1],1,fn),I=d.parse(s[2],2,fn);if(!k||!I)return null;if(!qe(k.type,[rn,Tt,Ft,Dn,fn]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${me(k.type)} instead`);if(s.length===4){const F=d.parse(s[3],3,Ft);return F?new ao(k,I,F):null}return new ao(k,I)}evaluate(s){const d=this.needle.evaluate(s),k=this.haystack.evaluate(s);if(!Fe(d,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${me(kr(d))} instead.`);let I;if(this.fromIndex&&(I=this.fromIndex.evaluate(s)),Fe(k,["string"])){const F=k.indexOf(d,I);return F===-1?-1:[...k.slice(0,F)].length}if(Fe(k,["array"]))return k.indexOf(d,I);throw new Xr(`Expected second argument to be of type array or string, but found ${me(kr(k))} instead.`)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class qo{constructor(s,d,k,I,F,V){this.inputType=s,this.type=d,this.input=k,this.cases=I,this.outputs=F,this.otherwise=V}static parse(s,d){if(s.length<5)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return d.error("Expected an even number of arguments.");let k,I;d.expectedType&&d.expectedType.kind!=="value"&&(I=d.expectedType);const F={},V=[];for(let ue=2;ue<s.length-1;ue+=2){let xe=s[ue];const Te=s[ue+1];Array.isArray(xe)||(xe=[xe]);const Ne=d.concat(ue);if(xe.length===0)return Ne.error("Expected at least one branch label.");for(const Ke of xe){if(typeof Ke!="number"&&typeof Ke!="string")return Ne.error("Branch labels must be numbers or strings.");if(typeof Ke=="number"&&Math.abs(Ke)>Number.MAX_SAFE_INTEGER)return Ne.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Ke=="number"&&Math.floor(Ke)!==Ke)return Ne.error("Numeric branch labels must be integer values.");if(k){if(Ne.checkSubtype(k,kr(Ke)))return null}else k=kr(Ke);if(F[String(Ke)]!==void 0)return Ne.error("Branch labels must be unique.");F[String(Ke)]=V.length}const Ue=d.parse(Te,ue,I);if(!Ue)return null;I=I||Ue.type,V.push(Ue)}const K=d.parse(s[1],1,fn);if(!K)return null;const ne=d.parse(s[s.length-1],s.length-1,I);return ne?K.type.kind!=="value"&&d.concat(1).checkSubtype(k,K.type)?null:new qo(k,I,K,F,V,ne):null}evaluate(s){const d=this.input.evaluate(s);return(kr(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class yo{constructor(s,d,k){this.type=s,this.branches=d,this.otherwise=k}static parse(s,d){if(s.length<4)return d.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return d.error("Expected an odd number of arguments.");let k;d.expectedType&&d.expectedType.kind!=="value"&&(k=d.expectedType);const I=[];for(let V=1;V<s.length-1;V+=2){const K=d.parse(s[V],V,rn);if(!K)return null;const ne=d.parse(s[V+1],V+1,k);if(!ne)return null;I.push([K,ne]),k=k||ne.type}const F=d.parse(s[s.length-1],s.length-1,k);if(!F)return null;if(!k)throw new Error("Can't infer output type");return new yo(k,I,F)}evaluate(s){for(const[d,k]of this.branches)if(d.evaluate(s))return k.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[d,k]of this.branches)s(d),s(k);s(this.otherwise)}outputDefined(){return this.branches.every(([s,d])=>d.outputDefined())&&this.otherwise.outputDefined()}}class lo{constructor(s,d,k,I){this.type=s,this.input=d,this.beginIndex=k,this.endIndex=I}static parse(s,d){if(s.length<=2||s.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const k=d.parse(s[1],1,fn),I=d.parse(s[2],2,Ft);if(!k||!I)return null;if(!qe(k.type,[he(fn),Tt,fn]))return d.error(`Expected first argument to be of type array or string, but found ${me(k.type)} instead`);if(s.length===4){const F=d.parse(s[3],3,Ft);return F?new lo(k.type,k,I,F):null}return new lo(k.type,k,I)}evaluate(s){const d=this.input.evaluate(s),k=this.beginIndex.evaluate(s);let I;if(this.endIndex&&(I=this.endIndex.evaluate(s)),Fe(d,["string"]))return[...d].slice(k,I).join("");if(Fe(d,["array"]))return d.slice(k,I);throw new Xr(`Expected first argument to be of type array or string, but found ${me(kr(d))} instead.`)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function Ao(u,s){const d=u.length-1;let k,I,F=0,V=d,K=0;for(;F<=V;)if(K=Math.floor((F+V)/2),k=u[K],I=u[K+1],k<=s){if(K===d||s<I)return K;F=K+1}else{if(!(k>s))throw new Xr("Input is not a number.");V=K-1}return 0}class Ss{constructor(s,d,k){this.type=s,this.input=d,this.labels=[],this.outputs=[];for(const[I,F]of k)this.labels.push(I),this.outputs.push(F)}static parse(s,d){if(s.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return d.error("Expected an even number of arguments.");const k=d.parse(s[1],1,Ft);if(!k)return null;const I=[];let F=null;d.expectedType&&d.expectedType.kind!=="value"&&(F=d.expectedType);for(let V=1;V<s.length;V+=2){const K=V===1?-1/0:s[V],ne=s[V+1],ue=V,xe=V+1;if(typeof K!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ue);if(I.length&&I[I.length-1][0]>=K)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ue);const Te=d.parse(ne,xe,F);if(!Te)return null;F=F||Te.type,I.push([K,Te])}return new Ss(F,k,I)}evaluate(s){const d=this.labels,k=this.outputs;if(d.length===1)return k[0].evaluate(s);const I=this.input.evaluate(s);if(I<=d[0])return k[0].evaluate(s);const F=d.length;return I>=d[F-1]?k[F-1].evaluate(s):k[Ao(d,I)].evaluate(s)}eachChild(s){s(this.input);for(const d of this.outputs)s(d)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Ho(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Kl=za;function za(u,s,d,k){this.cx=3*u,this.bx=3*(d-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(k-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=s,this.p2x=d,this.p2y=k}za.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,s){if(s===void 0&&(s=1e-6),u<0)return 0;if(u>1)return 1;for(var d=u,k=0;k<8;k++){var I=this.sampleCurveX(d)-u;if(Math.abs(I)<s)return d;var F=this.sampleCurveDerivativeX(d);if(Math.abs(F)<1e-6)break;d-=I/F}var V=0,K=1;for(d=u,k=0;k<20&&(I=this.sampleCurveX(d),!(Math.abs(I-u)<s));k++)u>I?V=d:K=d,d=.5*(K-V)+V;return d},solve:function(u,s){return this.sampleCurveY(this.solveCurveX(u,s))}};var Ua=Ho(Kl);function co(u,s,d){return u+d*(s-u)}function Wo(u,s,d){return u.map((k,I)=>co(k,s[I],d))}const Wi={number:co,color:function(u,s,d,k="rgb"){switch(k){case"rgb":{const[I,F,V,K]=Wo(u.rgb,s.rgb,d);return new mn(I,F,V,K,!1)}case"hcl":{const[I,F,V,K]=u.hcl,[ne,ue,xe,Te]=s.hcl;let Ne,Ue;if(isNaN(I)||isNaN(ne))isNaN(I)?isNaN(ne)?Ne=NaN:(Ne=ne,V!==1&&V!==0||(Ue=ue)):(Ne=I,xe!==1&&xe!==0||(Ue=F));else{let Bt=ne-I;ne>I&&Bt>180?Bt-=360:ne<I&&I-ne>180&&(Bt+=360),Ne=I+d*Bt}const[Ke,Ze,ct,mt]=function([Bt,Pt,$t,Gt]){return Bt=isNaN(Bt)?0:Bt*Kt,wn([$t,Math.cos(Bt)*Pt,Math.sin(Bt)*Pt,Gt])}([Ne,Ue??co(F,ue,d),co(V,xe,d),co(K,Te,d)]);return new mn(Ke,Ze,ct,mt,!1)}case"lab":{const[I,F,V,K]=wn(Wo(u.lab,s.lab,d));return new mn(I,F,V,K,!1)}}},array:Wo,padding:function(u,s,d){return new on(Wo(u.values,s.values,d))},variableAnchorOffsetCollection:function(u,s,d){const k=u.values,I=s.values;if(k.length!==I.length)throw new Xr(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${s.toString()}`);const F=[];for(let V=0;V<k.length;V+=2){if(k[V]!==I[V])throw new Xr(`Cannot interpolate values containing mismatched anchors. from[${V}]: ${k[V]}, to[${V}]: ${I[V]}`);F.push(k[V]);const[K,ne]=k[V+1],[ue,xe]=I[V+1];F.push([co(K,ue,d),co(ne,xe,d)])}return new ir(F)}};class Ui{constructor(s,d,k,I,F){this.type=s,this.operator=d,this.interpolation=k,this.input=I,this.labels=[],this.outputs=[];for(const[V,K]of F)this.labels.push(V),this.outputs.push(K)}static interpolationFactor(s,d,k,I){let F=0;if(s.name==="exponential")F=Gi(d,s.base,k,I);else if(s.name==="linear")F=Gi(d,1,k,I);else if(s.name==="cubic-bezier"){const V=s.controlPoints;F=new Ua(V[0],V[1],V[2],V[3]).solve(Gi(d,1,k,I))}return F}static parse(s,d){let[k,I,F,...V]=s;if(!Array.isArray(I)||I.length===0)return d.error("Expected an interpolation type expression.",1);if(I[0]==="linear")I={name:"linear"};else if(I[0]==="exponential"){const ue=I[1];if(typeof ue!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);I={name:"exponential",base:ue}}else{if(I[0]!=="cubic-bezier")return d.error(`Unknown interpolation type ${String(I[0])}`,1,0);{const ue=I.slice(1);if(ue.length!==4||ue.some(xe=>typeof xe!="number"||xe<0||xe>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);I={name:"cubic-bezier",controlPoints:ue}}}if(s.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(F=d.parse(F,2,Ft),!F)return null;const K=[];let ne=null;k==="interpolate-hcl"||k==="interpolate-lab"?ne=dt:d.expectedType&&d.expectedType.kind!=="value"&&(ne=d.expectedType);for(let ue=0;ue<V.length;ue+=2){const xe=V[ue],Te=V[ue+1],Ne=ue+3,Ue=ue+4;if(typeof xe!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ne);if(K.length&&K[K.length-1][0]>=xe)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ne);const Ke=d.parse(Te,Ue,ne);if(!Ke)return null;ne=ne||Ke.type,K.push([xe,Ke])}return Xe(ne,Ft)||Xe(ne,dt)||Xe(ne,Ir)||Xe(ne,ve)||Xe(ne,he(Ft))?new Ui(ne,k,I,F,K):d.error(`Type ${me(ne)} is not interpolatable.`)}evaluate(s){const d=this.labels,k=this.outputs;if(d.length===1)return k[0].evaluate(s);const I=this.input.evaluate(s);if(I<=d[0])return k[0].evaluate(s);const F=d.length;if(I>=d[F-1])return k[F-1].evaluate(s);const V=Ao(d,I),K=Ui.interpolationFactor(this.interpolation,I,d[V],d[V+1]),ne=k[V].evaluate(s),ue=k[V+1].evaluate(s);switch(this.operator){case"interpolate":return Wi[this.type.kind](ne,ue,K);case"interpolate-hcl":return Wi.color(ne,ue,K,"hcl");case"interpolate-lab":return Wi.color(ne,ue,K,"lab")}}eachChild(s){s(this.input);for(const d of this.outputs)s(d)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Gi(u,s,d,k){const I=k-d,F=u-d;return I===0?0:s===1?F/I:(Math.pow(s,F)-1)/(Math.pow(s,I)-1)}class sa{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expectected at least one argument.");let k=null;const I=d.expectedType;I&&I.kind!=="value"&&(k=I);const F=[];for(const K of s.slice(1)){const ne=d.parse(K,1+F.length,k,void 0,{typeAnnotation:"omit"});if(!ne)return null;k=k||ne.type,F.push(ne)}if(!k)throw new Error("No output type");const V=I&&F.some(K=>je(I,K.type));return new sa(V?fn:k,F)}evaluate(s){let d,k=null,I=0;for(const F of this.args)if(I++,k=F.evaluate(s),k&&k instanceof On&&!k.available&&(d||(d=k.name),k=null,I===this.args.length&&(k=d)),k!==null)break;return k}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}function Va(u,s){return u==="=="||u==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function Xl(u,s,d,k){return k.compare(s,d)===0}function Mr(u,s,d){const k=u!=="=="&&u!=="!=";return class vR{constructor(F,V,K){this.type=rn,this.lhs=F,this.rhs=V,this.collator=K,this.hasUntypedArgument=F.type.kind==="value"||V.type.kind==="value"}static parse(F,V){if(F.length!==3&&F.length!==4)return V.error("Expected two or three arguments.");const K=F[0];let ne=V.parse(F[1],1,fn);if(!ne)return null;if(!Va(K,ne.type))return V.concat(1).error(`"${K}" comparisons are not supported for type '${me(ne.type)}'.`);let ue=V.parse(F[2],2,fn);if(!ue)return null;if(!Va(K,ue.type))return V.concat(2).error(`"${K}" comparisons are not supported for type '${me(ue.type)}'.`);if(ne.type.kind!==ue.type.kind&&ne.type.kind!=="value"&&ue.type.kind!=="value")return V.error(`Cannot compare types '${me(ne.type)}' and '${me(ue.type)}'.`);k&&(ne.type.kind==="value"&&ue.type.kind!=="value"?ne=new Wn(ue.type,[ne]):ne.type.kind!=="value"&&ue.type.kind==="value"&&(ue=new Wn(ne.type,[ue])));let xe=null;if(F.length===4){if(ne.type.kind!=="string"&&ue.type.kind!=="string"&&ne.type.kind!=="value"&&ue.type.kind!=="value")return V.error("Cannot use collator to compare non-string types.");if(xe=V.parse(F[3],3,dr),!xe)return null}return new vR(ne,ue,xe)}evaluate(F){const V=this.lhs.evaluate(F),K=this.rhs.evaluate(F);if(k&&this.hasUntypedArgument){const ne=kr(V),ue=kr(K);if(ne.kind!==ue.kind||ne.kind!=="string"&&ne.kind!=="number")throw new Xr(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${ne.kind}, ${ue.kind}) instead.`)}if(this.collator&&!k&&this.hasUntypedArgument){const ne=kr(V),ue=kr(K);if(ne.kind!=="string"||ue.kind!=="string")return s(F,V,K)}return this.collator?d(F,V,K,this.collator.evaluate(F)):s(F,V,K)}eachChild(F){F(this.lhs),F(this.rhs),this.collator&&F(this.collator)}outputDefined(){return!0}}}const ke=Mr("==",function(u,s,d){return s===d},Xl),Ve=Mr("!=",function(u,s,d){return s!==d},function(u,s,d,k){return!Xl(0,s,d,k)}),nt=Mr("<",function(u,s,d){return s<d},function(u,s,d,k){return k.compare(s,d)<0}),ut=Mr(">",function(u,s,d){return s>d},function(u,s,d,k){return k.compare(s,d)>0}),_t=Mr("<=",function(u,s,d){return s<=d},function(u,s,d,k){return k.compare(s,d)<=0}),St=Mr(">=",function(u,s,d){return s>=d},function(u,s,d,k){return k.compare(s,d)>=0});class Dt{constructor(s,d,k){this.type=dr,this.locale=k,this.caseSensitive=s,this.diacriticSensitive=d}static parse(s,d){if(s.length!==2)return d.error("Expected one argument.");const k=s[1];if(typeof k!="object"||Array.isArray(k))return d.error("Collator options argument must be an object.");const I=d.parse(k["case-sensitive"]!==void 0&&k["case-sensitive"],1,rn);if(!I)return null;const F=d.parse(k["diacritic-sensitive"]!==void 0&&k["diacritic-sensitive"],1,rn);if(!F)return null;let V=null;return k.locale&&(V=d.parse(k.locale,1,Tt),!V)?null:new Dt(I,F,V)}evaluate(s){return new oi(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}class Mt{constructor(s,d,k,I,F){this.type=Tt,this.number=s,this.locale=d,this.currency=k,this.minFractionDigits=I,this.maxFractionDigits=F}static parse(s,d){if(s.length!==3)return d.error("Expected two arguments.");const k=d.parse(s[1],1,Ft);if(!k)return null;const I=s[2];if(typeof I!="object"||Array.isArray(I))return d.error("NumberFormat options argument must be an object.");let F=null;if(I.locale&&(F=d.parse(I.locale,1,Tt),!F))return null;let V=null;if(I.currency&&(V=d.parse(I.currency,1,Tt),!V))return null;let K=null;if(I["min-fraction-digits"]&&(K=d.parse(I["min-fraction-digits"],1,Ft),!K))return null;let ne=null;return I["max-fraction-digits"]&&(ne=d.parse(I["max-fraction-digits"],1,Ft),!ne)?null:new Mt(k,F,V,K,ne)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class pt{constructor(s){this.type=Xn,this.sections=s}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");const k=s[1];if(!Array.isArray(k)&&typeof k=="object")return d.error("First argument must be an image or text section.");const I=[];let F=!1;for(let V=1;V<=s.length-1;++V){const K=s[V];if(F&&typeof K=="object"&&!Array.isArray(K)){F=!1;let ne=null;if(K["font-scale"]&&(ne=d.parse(K["font-scale"],1,Ft),!ne))return null;let ue=null;if(K["text-font"]&&(ue=d.parse(K["text-font"],1,he(Tt)),!ue))return null;let xe=null;if(K["text-color"]&&(xe=d.parse(K["text-color"],1,dt),!xe))return null;const Te=I[I.length-1];Te.scale=ne,Te.font=ue,Te.textColor=xe}else{const ne=d.parse(s[V],1,fn);if(!ne)return null;const ue=ne.type.kind;if(ue!=="string"&&ue!=="value"&&ue!=="null"&&ue!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");F=!0,I.push({content:ne,scale:null,font:null,textColor:null})}}return new pt(I)}evaluate(s){return new nn(this.sections.map(d=>{const k=d.content.evaluate(s);return kr(k)===Ae?new eo("",k,null,null,null):new eo(ui(k),null,d.scale?d.scale.evaluate(s):null,d.font?d.font.evaluate(s).join(","):null,d.textColor?d.textColor.evaluate(s):null)}))}eachChild(s){for(const d of this.sections)s(d.content),d.scale&&s(d.scale),d.font&&s(d.font),d.textColor&&s(d.textColor)}outputDefined(){return!1}}class Lt{constructor(s){this.type=Ae,this.input=s}static parse(s,d){if(s.length!==2)return d.error("Expected two arguments.");const k=d.parse(s[1],1,Tt);return k?new Lt(k):d.error("No image name provided.")}evaluate(s){const d=this.input.evaluate(s),k=On.fromString(d);return k&&s.availableImages&&(k.available=s.availableImages.indexOf(d)>-1),k}eachChild(s){s(this.input)}outputDefined(){return!1}}class Z{constructor(s){this.type=Ft,this.input=s}static parse(s,d){if(s.length!==2)return d.error(`Expected 1 argument, but found ${s.length-1} instead.`);const k=d.parse(s[1],1);return k?k.type.kind!=="array"&&k.type.kind!=="string"&&k.type.kind!=="value"?d.error(`Expected argument of type string or array, but found ${me(k.type)} instead.`):new Z(k):null}evaluate(s){const d=this.input.evaluate(s);if(typeof d=="string")return[...d].length;if(Array.isArray(d))return d.length;throw new Xr(`Expected value to be of type string or array, but found ${me(kr(d))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const q=8192;function Ee(u,s){const d=(180+u[0])/360,k=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,I=Math.pow(2,s.z);return[Math.round(d*I*q),Math.round(k*I*q)]}function ye(u,s){const d=Math.pow(2,s.z);return[(I=(u[0]/q+s.x)/d,360*I-180),(k=(u[1]/q+s.y)/d,360/Math.PI*Math.atan(Math.exp((180-360*k)*Math.PI/180))-90)];var k,I}function it(u,s){u[0]=Math.min(u[0],s[0]),u[1]=Math.min(u[1],s[1]),u[2]=Math.max(u[2],s[0]),u[3]=Math.max(u[3],s[1])}function st(u,s){return!(u[0]<=s[0]||u[2]>=s[2]||u[1]<=s[1]||u[3]>=s[3])}function At(u,s,d){const k=u[0]-s[0],I=u[1]-s[1],F=u[0]-d[0],V=u[1]-d[1];return k*V-F*I==0&&k*F<=0&&I*V<=0}function qt(u,s,d,k){return(I=[k[0]-d[0],k[1]-d[1]])[0]*(F=[s[0]-u[0],s[1]-u[1]])[1]-I[1]*F[0]!=0&&!(!an(u,s,d,k)||!an(d,k,u,s));var I,F}function gt(u,s,d){for(const k of d)for(let I=0;I<k.length-1;++I)if(qt(u,s,k[I],k[I+1]))return!0;return!1}function Xt(u,s,d=!1){let k=!1;for(const K of s)for(let ne=0;ne<K.length-1;ne++){if(At(u,K[ne],K[ne+1]))return d;(F=K[ne])[1]>(I=u)[1]!=(V=K[ne+1])[1]>I[1]&&I[0]<(V[0]-F[0])*(I[1]-F[1])/(V[1]-F[1])+F[0]&&(k=!k)}var I,F,V;return k}function Vt(u,s){for(const d of s)if(Xt(u,d))return!0;return!1}function Ot(u,s){for(const d of u)if(!Xt(d,s))return!1;for(let d=0;d<u.length-1;++d)if(gt(u[d],u[d+1],s))return!1;return!0}function Ut(u,s){for(const d of s)if(Ot(u,d))return!0;return!1}function an(u,s,d,k){const I=k[0]-d[0],F=k[1]-d[1],V=(u[0]-d[0])*F-I*(u[1]-d[1]),K=(s[0]-d[0])*F-I*(s[1]-d[1]);return V>0&&K<0||V<0&&K>0}function pn(u,s,d){const k=[];for(let I=0;I<u.length;I++){const F=[];for(let V=0;V<u[I].length;V++){const K=Ee(u[I][V],d);it(s,K),F.push(K)}k.push(F)}return k}function Ln(u,s,d){const k=[];for(let I=0;I<u.length;I++){const F=pn(u[I],s,d);k.push(F)}return k}function or(u,s,d,k){if(u[0]<d[0]||u[0]>d[2]){const I=.5*k;let F=u[0]-d[0]>I?-k:d[0]-u[0]>I?k:0;F===0&&(F=u[0]-d[2]>I?-k:d[2]-u[0]>I?k:0),u[0]+=F}it(s,u)}function gr(u,s,d,k){const I=Math.pow(2,k.z)*q,F=[k.x*q,k.y*q],V=[];for(const K of u)for(const ne of K){const ue=[ne.x+F[0],ne.y+F[1]];or(ue,s,d,I),V.push(ue)}return V}function nr(u,s,d,k){const I=Math.pow(2,k.z)*q,F=[k.x*q,k.y*q],V=[];for(const ne of u){const ue=[];for(const xe of ne){const Te=[xe.x+F[0],xe.y+F[1]];it(s,Te),ue.push(Te)}V.push(ue)}if(s[2]-s[0]<=I/2){(K=s)[0]=K[1]=1/0,K[2]=K[3]=-1/0;for(const ne of V)for(const ue of ne)or(ue,s,d,I)}var K;return V}class wr{constructor(s,d){this.type=rn,this.geojson=s,this.geometries=d}static parse(s,d){if(s.length!==2)return d.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(zr(s[1])){const k=s[1];if(k.type==="FeatureCollection"){const I=[];for(const F of k.features){const{type:V,coordinates:K}=F.geometry;V==="Polygon"&&I.push(K),V==="MultiPolygon"&&I.push(...K)}if(I.length)return new wr(k,{type:"MultiPolygon",coordinates:I})}else if(k.type==="Feature"){const I=k.geometry.type;if(I==="Polygon"||I==="MultiPolygon")return new wr(k,k.geometry)}else if(k.type==="Polygon"||k.type==="MultiPolygon")return new wr(k,k)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(d,k){const I=[1/0,1/0,-1/0,-1/0],F=[1/0,1/0,-1/0,-1/0],V=d.canonicalID();if(k.type==="Polygon"){const K=pn(k.coordinates,F,V),ne=gr(d.geometry(),I,F,V);if(!st(I,F))return!1;for(const ue of ne)if(!Xt(ue,K))return!1}if(k.type==="MultiPolygon"){const K=Ln(k.coordinates,F,V),ne=gr(d.geometry(),I,F,V);if(!st(I,F))return!1;for(const ue of ne)if(!Vt(ue,K))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(d,k){const I=[1/0,1/0,-1/0,-1/0],F=[1/0,1/0,-1/0,-1/0],V=d.canonicalID();if(k.type==="Polygon"){const K=pn(k.coordinates,F,V),ne=nr(d.geometry(),I,F,V);if(!st(I,F))return!1;for(const ue of ne)if(!Ot(ue,K))return!1}if(k.type==="MultiPolygon"){const K=Ln(k.coordinates,F,V),ne=nr(d.geometry(),I,F,V);if(!st(I,F))return!1;for(const ue of ne)if(!Ut(ue,K))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let jn=class{constructor(u=[],s=(d,k)=>d<k?-1:d>k?1:0){if(this.data=u,this.length=this.data.length,this.compare=s,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(u){this.data.push(u),this._up(this.length++)}pop(){if(this.length===0)return;const u=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:s,compare:d}=this,k=s[u];for(;u>0;){const I=u-1>>1,F=s[I];if(d(k,F)>=0)break;s[u]=F,u=I}s[u]=k}_down(u){const{data:s,compare:d}=this,k=this.length>>1,I=s[u];for(;u<k;){let F=1+(u<<1);const V=F+1;if(V<this.length&&d(s[V],s[F])<0&&(F=V),d(s[F],I)>=0)break;s[u]=s[F],u=F}s[u]=I}};function yi(u,s,d,k,I){Qn(u,s,d,k||u.length-1,I||Wr)}function Qn(u,s,d,k,I){for(;k>d;){if(k-d>600){var F=k-d+1,V=s-d+1,K=Math.log(F),ne=.5*Math.exp(2*K/3),ue=.5*Math.sqrt(K*ne*(F-ne)/F)*(V-F/2<0?-1:1);Qn(u,s,Math.max(d,Math.floor(s-V*ne/F+ue)),Math.min(k,Math.floor(s+(F-V)*ne/F+ue)),I)}var xe=u[s],Te=d,Ne=k;for(In(u,d,s),I(u[k],xe)>0&&In(u,d,k);Te<Ne;){for(In(u,Te,Ne),Te++,Ne--;I(u[Te],xe)<0;)Te++;for(;I(u[Ne],xe)>0;)Ne--}I(u[d],xe)===0?In(u,d,Ne):In(u,++Ne,k),Ne<=s&&(d=Ne+1),s<=Ne&&(k=Ne-1)}}function In(u,s,d){var k=u[s];u[s]=u[d],u[d]=k}function Wr(u,s){return u<s?-1:u>s?1:0}function yn(u,s){if(u.length<=1)return[u];const d=[];let k,I;for(const F of u){const V=un(F);V!==0&&(F.area=Math.abs(V),I===void 0&&(I=V<0),I===V<0?(k&&d.push(k),k=[F]):k.push(F))}if(k&&d.push(k),s>1)for(let F=0;F<d.length;F++)d[F].length<=s||(yi(d[F],s,1,d[F].length-1,qr),d[F]=d[F].slice(0,s));return d}function qr(u,s){return s.area-u.area}function un(u){let s=0;for(let d,k,I=0,F=u.length,V=F-1;I<F;V=I++)d=u[I],k=u[V],s+=(k.x-d.x)*(d.y+k.y);return s}const er=1/298.257223563,mr=er*(2-er),Lr=Math.PI/180;class bo{constructor(s){const d=6378.137*Lr*1e3,k=Math.cos(s*Lr),I=1/(1-mr*(1-k*k)),F=Math.sqrt(I);this.kx=d*F*k,this.ky=d*F*I*(1-mr)}distance(s,d){const k=this.wrap(s[0]-d[0])*this.kx,I=(s[1]-d[1])*this.ky;return Math.sqrt(k*k+I*I)}pointOnLine(s,d){let k,I,F,V,K=1/0;for(let ne=0;ne<s.length-1;ne++){let ue=s[ne][0],xe=s[ne][1],Te=this.wrap(s[ne+1][0]-ue)*this.kx,Ne=(s[ne+1][1]-xe)*this.ky,Ue=0;Te===0&&Ne===0||(Ue=(this.wrap(d[0]-ue)*this.kx*Te+(d[1]-xe)*this.ky*Ne)/(Te*Te+Ne*Ne),Ue>1?(ue=s[ne+1][0],xe=s[ne+1][1]):Ue>0&&(ue+=Te/this.kx*Ue,xe+=Ne/this.ky*Ue)),Te=this.wrap(d[0]-ue)*this.kx,Ne=(d[1]-xe)*this.ky;const Ke=Te*Te+Ne*Ne;Ke<K&&(K=Ke,k=ue,I=xe,F=ne,V=Ue)}return{point:[k,I],index:F,t:Math.max(0,Math.min(1,V))}}wrap(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s}}function sr(u,s){return s[0]-u[0]}function Gn(u){return u[1]-u[0]+1}function Mn(u,s){return u[1]>=u[0]&&u[1]<s}function Kn(u,s){if(u[0]>u[1])return[null,null];const d=Gn(u);if(s){if(d===2)return[u,null];const I=Math.floor(d/2);return[[u[0],u[0]+I],[u[0]+I,u[1]]]}if(d===1)return[u,null];const k=Math.floor(d/2)-1;return[[u[0],u[0]+k],[u[0]+k+1,u[1]]]}function Bn(u,s){if(!Mn(s,u.length))return[1/0,1/0,-1/0,-1/0];const d=[1/0,1/0,-1/0,-1/0];for(let k=s[0];k<=s[1];++k)it(d,u[k]);return d}function xr(u){const s=[1/0,1/0,-1/0,-1/0];for(const d of u)for(const k of d)it(s,k);return s}function Pr(u){return u[0]!==-1/0&&u[1]!==-1/0&&u[2]!==1/0&&u[3]!==1/0}function Zn(u,s,d){if(!Pr(u)||!Pr(s))return NaN;let k=0,I=0;return u[2]<s[0]&&(k=s[0]-u[2]),u[0]>s[2]&&(k=u[0]-s[2]),u[1]>s[3]&&(I=u[1]-s[3]),u[3]<s[1]&&(I=s[1]-u[3]),d.distance([0,0],[k,I])}function Pn(u,s,d){const k=d.pointOnLine(s,u);return d.distance(u,k.point)}function Cr(u,s,d,k,I){const F=Math.min(Pn(u,[d,k],I),Pn(s,[d,k],I)),V=Math.min(Pn(d,[u,s],I),Pn(k,[u,s],I));return Math.min(F,V)}function Hr(u,s,d,k,I){if(!Mn(s,u.length)||!Mn(k,d.length))return 1/0;let F=1/0;for(let V=s[0];V<s[1];++V){const K=u[V],ne=u[V+1];for(let ue=k[0];ue<k[1];++ue){const xe=d[ue],Te=d[ue+1];if(qt(K,ne,xe,Te))return 0;F=Math.min(F,Cr(K,ne,xe,Te,I))}}return F}function jr(u,s,d,k,I){if(!Mn(s,u.length)||!Mn(k,d.length))return NaN;let F=1/0;for(let V=s[0];V<=s[1];++V)for(let K=k[0];K<=k[1];++K)if(F=Math.min(F,I.distance(u[V],d[K])),F===0)return F;return F}function xi(u,s,d){if(Xt(u,s,!0))return 0;let k=1/0;for(const I of s){const F=I[0],V=I[I.length-1];if(F!==V&&(k=Math.min(k,Pn(u,[V,F],d)),k===0))return k;const K=d.pointOnLine(I,u);if(k=Math.min(k,d.distance(u,K.point)),k===0)return k}return k}function yr(u,s,d,k){if(!Mn(s,u.length))return NaN;for(let F=s[0];F<=s[1];++F)if(Xt(u[F],d,!0))return 0;let I=1/0;for(let F=s[0];F<s[1];++F){const V=u[F],K=u[F+1];for(const ne of d)for(let ue=0,xe=ne.length,Te=xe-1;ue<xe;Te=ue++){const Ne=ne[Te],Ue=ne[ue];if(qt(V,K,Ne,Ue))return 0;I=Math.min(I,Cr(V,K,Ne,Ue,k))}}return I}function Ro(u,s){for(const d of u)for(const k of d)if(Xt(k,s,!0))return!0;return!1}function zn(u,s,d,k=1/0){const I=xr(u),F=xr(s);if(k!==1/0&&Zn(I,F,d)>=k)return k;if(st(I,F)){if(Ro(u,s))return 0}else if(Ro(s,u))return 0;let V=1/0;for(const K of u)for(let ne=0,ue=K.length,xe=ue-1;ne<ue;xe=ne++){const Te=K[xe],Ne=K[ne];for(const Ue of s)for(let Ke=0,Ze=Ue.length,ct=Ze-1;Ke<Ze;ct=Ke++){const mt=Ue[ct],Bt=Ue[Ke];if(qt(Te,Ne,mt,Bt))return 0;V=Math.min(V,Cr(Te,Ne,mt,Bt,d))}}return V}function Fr(u,s,d,k,I,F){if(!F)return;const V=Zn(Bn(k,F),I,d);V<s&&u.push([V,F,[0,0]])}function ai(u,s,d,k,I,F,V){if(!F||!V)return;const K=Zn(Bn(k,F),Bn(I,V),d);K<s&&u.push([K,F,V])}function bi(u,s,d,k,I=1/0){let F=Math.min(k.distance(u[0],d[0][0]),I);if(F===0)return F;const V=new jn([[0,[0,u.length-1],[0,0]]],sr),K=xr(d);for(;V.length>0;){const ne=V.pop();if(ne[0]>=F)continue;const ue=ne[1],xe=s?50:100;if(Gn(ue)<=xe){if(!Mn(ue,u.length))return NaN;if(s){const Te=yr(u,ue,d,k);if(isNaN(Te)||Te===0)return Te;F=Math.min(F,Te)}else for(let Te=ue[0];Te<=ue[1];++Te){const Ne=xi(u[Te],d,k);if(F=Math.min(F,Ne),F===0)return 0}}else{const Te=Kn(ue,s);Fr(V,F,k,u,K,Te[0]),Fr(V,F,k,u,K,Te[1])}}return F}function Li(u,s,d,k,I,F=1/0){let V=Math.min(F,I.distance(u[0],d[0]));if(V===0)return V;const K=new jn([[0,[0,u.length-1],[0,d.length-1]]],sr);for(;K.length>0;){const ne=K.pop();if(ne[0]>=V)continue;const ue=ne[1],xe=ne[2],Te=s?50:100,Ne=k?50:100;if(Gn(ue)<=Te&&Gn(xe)<=Ne){if(!Mn(ue,u.length)&&Mn(xe,d.length))return NaN;let Ue;if(s&&k)Ue=Hr(u,ue,d,xe,I),V=Math.min(V,Ue);else if(s&&!k){const Ke=u.slice(ue[0],ue[1]+1);for(let Ze=xe[0];Ze<=xe[1];++Ze)if(Ue=Pn(d[Ze],Ke,I),V=Math.min(V,Ue),V===0)return V}else if(!s&&k){const Ke=d.slice(xe[0],xe[1]+1);for(let Ze=ue[0];Ze<=ue[1];++Ze)if(Ue=Pn(u[Ze],Ke,I),V=Math.min(V,Ue),V===0)return V}else Ue=jr(u,ue,d,xe,I),V=Math.min(V,Ue)}else{const Ue=Kn(ue,s),Ke=Kn(xe,k);ai(K,V,I,u,d,Ue[0],Ke[0]),ai(K,V,I,u,d,Ue[0],Ke[1]),ai(K,V,I,u,d,Ue[1],Ke[0]),ai(K,V,I,u,d,Ue[1],Ke[1])}}return V}function fi(u){return u.type==="MultiPolygon"?u.coordinates.map(s=>({type:"Polygon",coordinates:s})):u.type==="MultiLineString"?u.coordinates.map(s=>({type:"LineString",coordinates:s})):u.type==="MultiPoint"?u.coordinates.map(s=>({type:"Point",coordinates:s})):[u]}class is{constructor(s,d){this.type=Ft,this.geojson=s,this.geometries=d}static parse(s,d){if(s.length!==2)return d.error(`'distance' expression requires exactly one argument, but found ${s.length-1} instead.`);if(zr(s[1])){const k=s[1];if(k.type==="FeatureCollection")return new is(k,k.features.map(I=>fi(I.geometry)).flat());if(k.type==="Feature")return new is(k,fi(k.geometry));if("type"in k&&"coordinates"in k)return new is(k,fi(k))}return d.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(d,k){const I=d.geometry(),F=I.flat().map(ne=>ye([ne.x,ne.y],d.canonical));if(I.length===0)return NaN;const V=new bo(F[0][1]);let K=1/0;for(const ne of k){switch(ne.type){case"Point":K=Math.min(K,Li(F,!1,[ne.coordinates],!1,V,K));break;case"LineString":K=Math.min(K,Li(F,!1,ne.coordinates,!0,V,K));break;case"Polygon":K=Math.min(K,bi(F,!1,ne.coordinates,V,K))}if(K===0)return K}return K}(s,this.geometries);if(s.geometryType()==="LineString")return function(d,k){const I=d.geometry(),F=I.flat().map(ne=>ye([ne.x,ne.y],d.canonical));if(I.length===0)return NaN;const V=new bo(F[0][1]);let K=1/0;for(const ne of k){switch(ne.type){case"Point":K=Math.min(K,Li(F,!0,[ne.coordinates],!1,V,K));break;case"LineString":K=Math.min(K,Li(F,!0,ne.coordinates,!0,V,K));break;case"Polygon":K=Math.min(K,bi(F,!0,ne.coordinates,V,K))}if(K===0)return K}return K}(s,this.geometries);if(s.geometryType()==="Polygon")return function(d,k){const I=d.geometry();if(I.length===0||I[0].length===0)return NaN;const F=yn(I,0).map(ne=>ne.map(ue=>ue.map(xe=>ye([xe.x,xe.y],d.canonical)))),V=new bo(F[0][0][0][1]);let K=1/0;for(const ne of k)for(const ue of F){switch(ne.type){case"Point":K=Math.min(K,bi([ne.coordinates],!1,ue,V,K));break;case"LineString":K=Math.min(K,bi(ne.coordinates,!0,ue,V,K));break;case"Polygon":K=Math.min(K,zn(ue,ne.coordinates,V,K))}if(K===0)return K}return K}(s,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const aa={"==":ke,"!=":Ve,">":ut,"<":nt,">=":St,"<=":_t,array:Wn,at:Io,boolean:Wn,case:yo,coalesce:sa,collator:Dt,format:pt,image:Lt,in:rs,"index-of":ao,interpolate:Ui,"interpolate-hcl":Ui,"interpolate-lab":Ui,length:Z,let:Hi,literal:Jr,match:qo,number:Wn,"number-format":Mt,object:Wn,slice:lo,step:Ss,string:Wn,"to-boolean":pi,"to-color":pi,"to-number":pi,"to-string":pi,var:Ur,within:wr,distance:is};class Go{constructor(s,d,k,I){this.name=s,this.type=d,this._evaluate=k,this.args=I}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,d){const k=s[0],I=Go.definitions[k];if(!I)return d.error(`Unknown expression "${k}". If you wanted a literal array, use ["literal", [...]].`,0);const F=Array.isArray(I)?I[0]:I.type,V=Array.isArray(I)?[[I[1],I[2]]]:I.overloads,K=V.filter(([ue])=>!Array.isArray(ue)||ue.length===s.length-1);let ne=null;for(const[ue,xe]of K){ne=new Di(d.registry,kc,d.path,null,d.scope);const Te=[];let Ne=!1;for(let Ue=1;Ue<s.length;Ue++){const Ke=s[Ue],Ze=Array.isArray(ue)?ue[Ue-1]:ue.type,ct=ne.parse(Ke,1+Te.length,Ze);if(!ct){Ne=!0;break}Te.push(ct)}if(!Ne)if(Array.isArray(ue)&&ue.length!==Te.length)ne.error(`Expected ${ue.length} arguments, but found ${Te.length} instead.`);else{for(let Ue=0;Ue<Te.length;Ue++){const Ke=Array.isArray(ue)?ue[Ue]:ue.type,Ze=Te[Ue];ne.concat(Ue+1).checkSubtype(Ke,Ze.type)}if(ne.errors.length===0)return new Go(k,F,xe,Te)}}if(K.length===1)d.errors.push(...ne.errors);else{const ue=(K.length?K:V).map(([Te])=>{return Ne=Te,Array.isArray(Ne)?`(${Ne.map(me).join(", ")})`:`(${me(Ne.type)}...)`;var Ne}).join(" | "),xe=[];for(let Te=1;Te<s.length;Te++){const Ne=d.parse(s[Te],1+xe.length);if(!Ne)return null;xe.push(me(Ne.type))}d.error(`Expected arguments of type ${ue}, but found (${xe.join(", ")}) instead.`)}return null}static register(s,d){Go.definitions=d;for(const k in d)s[k]=Go}}function qa(u,[s,d,k,I]){s=s.evaluate(u),d=d.evaluate(u),k=k.evaluate(u);const F=I?I.evaluate(u):1,V=Ar(s,d,k,F);if(V)throw new Xr(V);return new mn(s/255,d/255,k/255,F,!1)}function Zl(u,s){return u in s}function vd(u,s){const d=s[u];return d===void 0?null:d}function uo(u){return{type:u}}function kc(u){if(u instanceof Ur)return kc(u.boundExpression);if(u instanceof Go&&u.name==="error"||u instanceof Dt||u instanceof wr||u instanceof is)return!1;const s=u instanceof pi||u instanceof Wn;let d=!0;return u.eachChild(k=>{d=s?d&&kc(k):d&&k instanceof Jr}),!!d&&du(u)&&pu(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function du(u){if(u instanceof Go&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof wr||u instanceof is)return!1;let s=!0;return u.eachChild(d=>{s&&!du(d)&&(s=!1)}),s}function li(u){if(u instanceof Go&&u.name==="feature-state")return!1;let s=!0;return u.eachChild(d=>{s&&!li(d)&&(s=!1)}),s}function pu(u,s){if(u instanceof Go&&s.indexOf(u.name)>=0)return!1;let d=!0;return u.eachChild(k=>{d&&!pu(k,s)&&(d=!1)}),d}function la(u){return{result:"success",value:u}}function Pc(u){return{result:"error",value:u}}function Tc(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function Pm(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function mu(u){return!!u.expression&&u.expression.interpolated}function si(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function Mh(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function C0(u){return u}function Tm(u,s){const d=s.type==="color",k=u.stops&&typeof u.stops[0][0]=="object",I=k||!(k||u.property!==void 0),F=u.type||(mu(s)?"exponential":"interval");if(d||s.type==="padding"){const xe=d?mn.parse:on.parse;(u=Ht({},u)).stops&&(u.stops=u.stops.map(Te=>[Te[0],xe(Te[1])])),u.default=xe(u.default?u.default:s.default)}if(u.colorSpace&&(V=u.colorSpace)!=="rgb"&&V!=="hcl"&&V!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var V;let K,ne,ue;if(F==="exponential")K=_d;else if(F==="interval")K=gu;else if(F==="categorical"){K=Om,ne=Object.create(null);for(const xe of u.stops)ne[xe[0]]=xe[1];ue=typeof u.stops[0][0]}else{if(F!=="identity")throw new Error(`Unknown function type "${F}"`);K=Ch}if(k){const xe={},Te=[];for(let Ke=0;Ke<u.stops.length;Ke++){const Ze=u.stops[Ke],ct=Ze[0].zoom;xe[ct]===void 0&&(xe[ct]={zoom:ct,type:u.type,property:u.property,default:u.default,stops:[]},Te.push(ct)),xe[ct].stops.push([Ze[0].value,Ze[1]])}const Ne=[];for(const Ke of Te)Ne.push([xe[Ke].zoom,Tm(xe[Ke],s)]);const Ue={name:"linear"};return{kind:"composite",interpolationType:Ue,interpolationFactor:Ui.interpolationFactor.bind(void 0,Ue),zoomStops:Ne.map(Ke=>Ke[0]),evaluate:({zoom:Ke},Ze)=>_d({stops:Ne,base:u.base},s,Ke).evaluate(Ke,Ze)}}if(I){const xe=F==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:xe,interpolationFactor:Ui.interpolationFactor.bind(void 0,xe),zoomStops:u.stops.map(Te=>Te[0]),evaluate:({zoom:Te})=>K(u,s,Te,ne,ue)}}return{kind:"source",evaluate(xe,Te){const Ne=Te&&Te.properties?Te.properties[u.property]:void 0;return Ne===void 0?Es(u.default,s.default):K(u,s,Ne,ne,ue)}}}function Es(u,s,d){return u!==void 0?u:s!==void 0?s:d!==void 0?d:void 0}function Om(u,s,d,k,I){return Es(typeof d===I?k[d]:void 0,u.default,s.default)}function gu(u,s,d){if(si(d)!=="number")return Es(u.default,s.default);const k=u.stops.length;if(k===1||d<=u.stops[0][0])return u.stops[0][1];if(d>=u.stops[k-1][0])return u.stops[k-1][1];const I=Ao(u.stops.map(F=>F[0]),d);return u.stops[I][1]}function _d(u,s,d){const k=u.base!==void 0?u.base:1;if(si(d)!=="number")return Es(u.default,s.default);const I=u.stops.length;if(I===1||d<=u.stops[0][0])return u.stops[0][1];if(d>=u.stops[I-1][0])return u.stops[I-1][1];const F=Ao(u.stops.map(xe=>xe[0]),d),V=function(xe,Te,Ne,Ue){const Ke=Ue-Ne,Ze=xe-Ne;return Ke===0?0:Te===1?Ze/Ke:(Math.pow(Te,Ze)-1)/(Math.pow(Te,Ke)-1)}(d,k,u.stops[F][0],u.stops[F+1][0]),K=u.stops[F][1],ne=u.stops[F+1][1],ue=Wi[s.type]||C0;return typeof K.evaluate=="function"?{evaluate(...xe){const Te=K.evaluate.apply(void 0,xe),Ne=ne.evaluate.apply(void 0,xe);if(Te!==void 0&&Ne!==void 0)return ue(Te,Ne,V,u.colorSpace)}}:ue(K,ne,V,u.colorSpace)}function Ch(u,s,d){switch(s.type){case"color":d=mn.parse(d);break;case"formatted":d=nn.fromString(d.toString());break;case"resolvedImage":d=On.fromString(d.toString());break;case"padding":d=on.parse(d);break;default:si(d)===s.type||s.type==="enum"&&s.values[d]||(d=void 0)}return Es(d,u.default,s.default)}Go.register(aa,{error:[{kind:"error"},[Tt],(u,[s])=>{throw new Xr(s.evaluate(u))}],typeof:[Tt,[fn],(u,[s])=>me(kr(s.evaluate(u)))],"to-rgba":[he(Ft,4),[dt],(u,[s])=>{const[d,k,I,F]=s.evaluate(u).rgb;return[255*d,255*k,255*I,F]}],rgb:[dt,[Ft,Ft,Ft],qa],rgba:[dt,[Ft,Ft,Ft,Ft],qa],has:{type:rn,overloads:[[[Tt],(u,[s])=>Zl(s.evaluate(u),u.properties())],[[Tt,qn],(u,[s,d])=>Zl(s.evaluate(u),d.evaluate(u))]]},get:{type:fn,overloads:[[[Tt],(u,[s])=>vd(s.evaluate(u),u.properties())],[[Tt,qn],(u,[s,d])=>vd(s.evaluate(u),d.evaluate(u))]]},"feature-state":[fn,[Tt],(u,[s])=>vd(s.evaluate(u),u.featureState||{})],properties:[qn,[],u=>u.properties()],"geometry-type":[Tt,[],u=>u.geometryType()],id:[fn,[],u=>u.id()],zoom:[Ft,[],u=>u.globals.zoom],"heatmap-density":[Ft,[],u=>u.globals.heatmapDensity||0],"line-progress":[Ft,[],u=>u.globals.lineProgress||0],accumulated:[fn,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Ft,uo(Ft),(u,s)=>{let d=0;for(const k of s)d+=k.evaluate(u);return d}],"*":[Ft,uo(Ft),(u,s)=>{let d=1;for(const k of s)d*=k.evaluate(u);return d}],"-":{type:Ft,overloads:[[[Ft,Ft],(u,[s,d])=>s.evaluate(u)-d.evaluate(u)],[[Ft],(u,[s])=>-s.evaluate(u)]]},"/":[Ft,[Ft,Ft],(u,[s,d])=>s.evaluate(u)/d.evaluate(u)],"%":[Ft,[Ft,Ft],(u,[s,d])=>s.evaluate(u)%d.evaluate(u)],ln2:[Ft,[],()=>Math.LN2],pi:[Ft,[],()=>Math.PI],e:[Ft,[],()=>Math.E],"^":[Ft,[Ft,Ft],(u,[s,d])=>Math.pow(s.evaluate(u),d.evaluate(u))],sqrt:[Ft,[Ft],(u,[s])=>Math.sqrt(s.evaluate(u))],log10:[Ft,[Ft],(u,[s])=>Math.log(s.evaluate(u))/Math.LN10],ln:[Ft,[Ft],(u,[s])=>Math.log(s.evaluate(u))],log2:[Ft,[Ft],(u,[s])=>Math.log(s.evaluate(u))/Math.LN2],sin:[Ft,[Ft],(u,[s])=>Math.sin(s.evaluate(u))],cos:[Ft,[Ft],(u,[s])=>Math.cos(s.evaluate(u))],tan:[Ft,[Ft],(u,[s])=>Math.tan(s.evaluate(u))],asin:[Ft,[Ft],(u,[s])=>Math.asin(s.evaluate(u))],acos:[Ft,[Ft],(u,[s])=>Math.acos(s.evaluate(u))],atan:[Ft,[Ft],(u,[s])=>Math.atan(s.evaluate(u))],min:[Ft,uo(Ft),(u,s)=>Math.min(...s.map(d=>d.evaluate(u)))],max:[Ft,uo(Ft),(u,s)=>Math.max(...s.map(d=>d.evaluate(u)))],abs:[Ft,[Ft],(u,[s])=>Math.abs(s.evaluate(u))],round:[Ft,[Ft],(u,[s])=>{const d=s.evaluate(u);return d<0?-Math.round(-d):Math.round(d)}],floor:[Ft,[Ft],(u,[s])=>Math.floor(s.evaluate(u))],ceil:[Ft,[Ft],(u,[s])=>Math.ceil(s.evaluate(u))],"filter-==":[rn,[Tt,fn],(u,[s,d])=>u.properties()[s.value]===d.value],"filter-id-==":[rn,[fn],(u,[s])=>u.id()===s.value],"filter-type-==":[rn,[Tt],(u,[s])=>u.geometryType()===s.value],"filter-<":[rn,[Tt,fn],(u,[s,d])=>{const k=u.properties()[s.value],I=d.value;return typeof k==typeof I&&k<I}],"filter-id-<":[rn,[fn],(u,[s])=>{const d=u.id(),k=s.value;return typeof d==typeof k&&d<k}],"filter->":[rn,[Tt,fn],(u,[s,d])=>{const k=u.properties()[s.value],I=d.value;return typeof k==typeof I&&k>I}],"filter-id->":[rn,[fn],(u,[s])=>{const d=u.id(),k=s.value;return typeof d==typeof k&&d>k}],"filter-<=":[rn,[Tt,fn],(u,[s,d])=>{const k=u.properties()[s.value],I=d.value;return typeof k==typeof I&&k<=I}],"filter-id-<=":[rn,[fn],(u,[s])=>{const d=u.id(),k=s.value;return typeof d==typeof k&&d<=k}],"filter->=":[rn,[Tt,fn],(u,[s,d])=>{const k=u.properties()[s.value],I=d.value;return typeof k==typeof I&&k>=I}],"filter-id->=":[rn,[fn],(u,[s])=>{const d=u.id(),k=s.value;return typeof d==typeof k&&d>=k}],"filter-has":[rn,[fn],(u,[s])=>s.value in u.properties()],"filter-has-id":[rn,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[rn,[he(Tt)],(u,[s])=>s.value.indexOf(u.geometryType())>=0],"filter-id-in":[rn,[he(fn)],(u,[s])=>s.value.indexOf(u.id())>=0],"filter-in-small":[rn,[Tt,he(fn)],(u,[s,d])=>d.value.indexOf(u.properties()[s.value])>=0],"filter-in-large":[rn,[Tt,he(fn)],(u,[s,d])=>function(k,I,F,V){for(;F<=V;){const K=F+V>>1;if(I[K]===k)return!0;I[K]>k?V=K-1:F=K+1}return!1}(u.properties()[s.value],d.value,0,d.value.length-1)],all:{type:rn,overloads:[[[rn,rn],(u,[s,d])=>s.evaluate(u)&&d.evaluate(u)],[uo(rn),(u,s)=>{for(const d of s)if(!d.evaluate(u))return!1;return!0}]]},any:{type:rn,overloads:[[[rn,rn],(u,[s,d])=>s.evaluate(u)||d.evaluate(u)],[uo(rn),(u,s)=>{for(const d of s)if(d.evaluate(u))return!0;return!1}]]},"!":[rn,[rn],(u,[s])=>!s.evaluate(u)],"is-supported-script":[rn,[Tt],(u,[s])=>{const d=u.globals&&u.globals.isSupportedScript;return!d||d(s.evaluate(u))}],upcase:[Tt,[Tt],(u,[s])=>s.evaluate(u).toUpperCase()],downcase:[Tt,[Tt],(u,[s])=>s.evaluate(u).toLowerCase()],concat:[Tt,uo(fn),(u,s)=>s.map(d=>ui(d.evaluate(u))).join("")],"resolved-locale":[Tt,[dr],(u,[s])=>s.evaluate(u).resolvedLocale()]});class yu{constructor(s,d){var k;this.expression=s,this._warningHistory={},this._evaluator=new ki,this._defaultValue=d?(k=d).type==="color"&&Mh(k.default)?new mn(0,0,0,0):k.type==="color"?mn.parse(k.default)||null:k.type==="padding"?on.parse(k.default)||null:k.type==="variableAnchorOffsetCollection"?ir.parse(k.default)||null:k.default===void 0?null:k.default:null,this._enumValues=d&&d.type==="enum"?d.values:null}evaluateWithoutErrorHandling(s,d,k,I,F,V){return this._evaluator.globals=s,this._evaluator.feature=d,this._evaluator.featureState=k,this._evaluator.canonical=I,this._evaluator.availableImages=F||null,this._evaluator.formattedSection=V,this.expression.evaluate(this._evaluator)}evaluate(s,d,k,I,F,V){this._evaluator.globals=s,this._evaluator.feature=d||null,this._evaluator.featureState=k||null,this._evaluator.canonical=I,this._evaluator.availableImages=F||null,this._evaluator.formattedSection=V||null;try{const K=this.expression.evaluate(this._evaluator);if(K==null||typeof K=="number"&&K!=K)return this._defaultValue;if(this._enumValues&&!(K in this._enumValues))throw new Xr(`Expected value to be one of ${Object.keys(this._enumValues).map(ne=>JSON.stringify(ne)).join(", ")}, but found ${JSON.stringify(K)} instead.`);return K}catch(K){return this._warningHistory[K.message]||(this._warningHistory[K.message]=!0,typeof console<"u"&&console.warn(K.message)),this._defaultValue}}}function bu(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in aa}function zs(u,s){const d=new Di(aa,kc,[],s?function(I){const F={color:dt,string:Tt,number:Ft,enum:Tt,boolean:rn,formatted:Xn,padding:Ir,resolvedImage:Ae,variableAnchorOffsetCollection:ve};return I.type==="array"?he(F[I.value]||fn,I.length):F[I.type]}(s):void 0),k=d.parse(u,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return k?la(new yu(k,s)):Pc(d.errors)}class Oc{constructor(s,d){this.kind=s,this._styleExpression=d,this.isStateDependent=s!=="constant"&&!li(d.expression)}evaluateWithoutErrorHandling(s,d,k,I,F,V){return this._styleExpression.evaluateWithoutErrorHandling(s,d,k,I,F,V)}evaluate(s,d,k,I,F,V){return this._styleExpression.evaluate(s,d,k,I,F,V)}}class Mc{constructor(s,d,k,I){this.kind=s,this.zoomStops=k,this._styleExpression=d,this.isStateDependent=s!=="camera"&&!li(d.expression),this.interpolationType=I}evaluateWithoutErrorHandling(s,d,k,I,F,V){return this._styleExpression.evaluateWithoutErrorHandling(s,d,k,I,F,V)}evaluate(s,d,k,I,F,V){return this._styleExpression.evaluate(s,d,k,I,F,V)}interpolationFactor(s,d,k){return this.interpolationType?Ui.interpolationFactor(this.interpolationType,s,d,k):0}}function vu(u,s){const d=zs(u,s);if(d.result==="error")return d;const k=d.value.expression,I=du(k);if(!I&&!Tc(s))return Pc([new en("","data expressions not supported")]);const F=pu(k,["zoom"]);if(!F&&!Pm(s))return Pc([new en("","zoom expressions not supported")]);const V=Yl(k);return V||F?V instanceof en?Pc([V]):V instanceof Ui&&!mu(s)?Pc([new en("",'"interpolate" expressions cannot be used with this property')]):la(V?new Mc(I?"camera":"composite",d.value,V.labels,V instanceof Ui?V.interpolation:void 0):new Oc(I?"constant":"source",d.value)):Pc([new en("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class El{constructor(s,d){this._parameters=s,this._specification=d,Ht(this,Tm(this._parameters,this._specification))}static deserialize(s){return new El(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Yl(u){let s=null;if(u instanceof Hi)s=Yl(u.result);else if(u instanceof sa){for(const d of u.args)if(s=Yl(d),s)break}else(u instanceof Ss||u instanceof Ui)&&u.input instanceof Go&&u.input.name==="zoom"&&(s=u);return s instanceof en||u.eachChild(d=>{const k=Yl(d);k instanceof en?s=k:!s&&k?s=new en("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&k&&s!==k&&(s=new en("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function _u(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const s of u.slice(1))if(!_u(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const Ih={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function wu(u){if(u==null)return{filter:()=>!0,needGeometry:!1};_u(u)||(u=xu(u));const s=zs(u,Ih);if(s.result==="error")throw new Error(s.value.map(d=>`${d.key}: ${d.message}`).join(", "));return{filter:(d,k,I)=>s.value.evaluate(d,k,{},I),needGeometry:Mm(u)}}function I0(u,s){return u<s?-1:u>s?1:0}function Mm(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let s=1;s<u.length;s++)if(Mm(u[s]))return!0;return!1}function xu(u){if(!u)return!0;const s=u[0];return u.length<=1?s!=="any":s==="=="?hn(u[1],u[2],"=="):s==="!="?$r(hn(u[1],u[2],"==")):s==="<"||s===">"||s==="<="||s===">="?hn(u[1],u[2],s):s==="any"?(d=u.slice(1),["any"].concat(d.map(xu))):s==="all"?["all"].concat(u.slice(1).map(xu)):s==="none"?["all"].concat(u.slice(1).map(xu).map($r)):s==="in"?Tr(u[1],u.slice(2)):s==="!in"?$r(Tr(u[1],u.slice(2))):s==="has"?Vr(u[1]):s!=="!has"||$r(Vr(u[1]));var d}function hn(u,s,d){switch(u){case"$type":return[`filter-type-${d}`,s];case"$id":return[`filter-id-${d}`,s];default:return[`filter-${d}`,u,s]}}function Tr(u,s){if(s.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(d=>typeof d!=typeof s[0])?["filter-in-large",u,["literal",s.sort(I0)]]:["filter-in-small",u,["literal",s]]}}function Vr(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function $r(u){return["!",u]}function Qr(u){const s=typeof u;if(s==="number"||s==="boolean"||s==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let I="[";for(const F of u)I+=`${Qr(F)},`;return`${I}]`}const d=Object.keys(u).sort();let k="{";for(let I=0;I<d.length;I++)k+=`${JSON.stringify(d[I])}:${Qr(u[d[I]])},`;return`${k}}`}function Zr(u){let s="";for(const d of $e)s+=`/${Qr(u[d])}`;return s}function Ki(u){const s=u.value;return s?[new xt(u.key,s,"constants have been deprecated as of v8")]:[]}function Si(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function As(u){if(Array.isArray(u))return u.map(As);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const s={};for(const d in u)s[d]=As(u[d]);return s}return Si(u)}function Do(u){const s=u.key,d=u.value,k=u.valueSpec||{},I=u.objectElementValidators||{},F=u.style,V=u.styleSpec,K=u.validateSpec;let ne=[];const ue=si(d);if(ue!=="object")return[new xt(s,d,`object expected, ${ue} found`)];for(const xe in d){const Te=xe.split(".")[0],Ne=k[Te]||k["*"];let Ue;if(I[Te])Ue=I[Te];else if(k[Te])Ue=K;else if(I["*"])Ue=I["*"];else{if(!k["*"]){ne.push(new xt(s,d[xe],`unknown property "${xe}"`));continue}Ue=K}ne=ne.concat(Ue({key:(s&&`${s}.`)+xe,value:d[xe],valueSpec:Ne,style:F,styleSpec:V,object:d,objectKey:xe,validateSpec:K},d))}for(const xe in k)I[xe]||k[xe].required&&k[xe].default===void 0&&d[xe]===void 0&&ne.push(new xt(s,d,`missing required property "${xe}"`));return ne}function Us(u){const s=u.value,d=u.valueSpec,k=u.style,I=u.styleSpec,F=u.key,V=u.arrayElementValidator||u.validateSpec;if(si(s)!=="array")return[new xt(F,s,`array expected, ${si(s)} found`)];if(d.length&&s.length!==d.length)return[new xt(F,s,`array length ${d.length} expected, length ${s.length} found`)];if(d["min-length"]&&s.length<d["min-length"])return[new xt(F,s,`array length at least ${d["min-length"]} expected, length ${s.length} found`)];let K={type:d.value,values:d.values};I.$version<7&&(K.function=d.function),si(d.value)==="object"&&(K=d.value);let ne=[];for(let ue=0;ue<s.length;ue++)ne=ne.concat(V({array:s,arrayIndex:ue,value:s[ue],valueSpec:K,validateSpec:u.validateSpec,style:k,styleSpec:I,key:`${F}[${ue}]`}));return ne}function Cc(u){const s=u.key,d=u.value,k=u.valueSpec;let I=si(d);return I==="number"&&d!=d&&(I="NaN"),I!=="number"?[new xt(s,d,`number expected, ${I} found`)]:"minimum"in k&&d<k.minimum?[new xt(s,d,`${d} is less than the minimum value ${k.minimum}`)]:"maximum"in k&&d>k.maximum?[new xt(s,d,`${d} is greater than the maximum value ${k.maximum}`)]:[]}function Su(u){const s=u.valueSpec,d=Si(u.value.type);let k,I,F,V={};const K=d!=="categorical"&&u.value.property===void 0,ne=!K,ue=si(u.value.stops)==="array"&&si(u.value.stops[0])==="array"&&si(u.value.stops[0][0])==="object",xe=Do({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(Ue){if(d==="identity")return[new xt(Ue.key,Ue.value,'identity function may not have a "stops" property')];let Ke=[];const Ze=Ue.value;return Ke=Ke.concat(Us({key:Ue.key,value:Ze,valueSpec:Ue.valueSpec,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec,arrayElementValidator:Te})),si(Ze)==="array"&&Ze.length===0&&Ke.push(new xt(Ue.key,Ze,"array must have at least one stop")),Ke},default:function(Ue){return Ue.validateSpec({key:Ue.key,value:Ue.value,valueSpec:s,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec})}}});return d==="identity"&&K&&xe.push(new xt(u.key,u.value,'missing required property "property"')),d==="identity"||u.value.stops||xe.push(new xt(u.key,u.value,'missing required property "stops"')),d==="exponential"&&u.valueSpec.expression&&!mu(u.valueSpec)&&xe.push(new xt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(ne&&!Tc(u.valueSpec)?xe.push(new xt(u.key,u.value,"property functions not supported")):K&&!Pm(u.valueSpec)&&xe.push(new xt(u.key,u.value,"zoom functions not supported"))),d!=="categorical"&&!ue||u.value.property!==void 0||xe.push(new xt(u.key,u.value,'"property" property is required')),xe;function Te(Ue){let Ke=[];const Ze=Ue.value,ct=Ue.key;if(si(Ze)!=="array")return[new xt(ct,Ze,`array expected, ${si(Ze)} found`)];if(Ze.length!==2)return[new xt(ct,Ze,`array length 2 expected, length ${Ze.length} found`)];if(ue){if(si(Ze[0])!=="object")return[new xt(ct,Ze,`object expected, ${si(Ze[0])} found`)];if(Ze[0].zoom===void 0)return[new xt(ct,Ze,"object stop key must have zoom")];if(Ze[0].value===void 0)return[new xt(ct,Ze,"object stop key must have value")];if(F&&F>Si(Ze[0].zoom))return[new xt(ct,Ze[0].zoom,"stop zoom values must appear in ascending order")];Si(Ze[0].zoom)!==F&&(F=Si(Ze[0].zoom),I=void 0,V={}),Ke=Ke.concat(Do({key:`${ct}[0]`,value:Ze[0],valueSpec:{zoom:{}},validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec,objectElementValidators:{zoom:Cc,value:Ne}}))}else Ke=Ke.concat(Ne({key:`${ct}[0]`,value:Ze[0],valueSpec:{},validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec},Ze));return bu(As(Ze[1]))?Ke.concat([new xt(`${ct}[1]`,Ze[1],"expressions are not allowed in function stops.")]):Ke.concat(Ue.validateSpec({key:`${ct}[1]`,value:Ze[1],valueSpec:s,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec}))}function Ne(Ue,Ke){const Ze=si(Ue.value),ct=Si(Ue.value),mt=Ue.value!==null?Ue.value:Ke;if(k){if(Ze!==k)return[new xt(Ue.key,mt,`${Ze} stop domain type must match previous stop domain type ${k}`)]}else k=Ze;if(Ze!=="number"&&Ze!=="string"&&Ze!=="boolean")return[new xt(Ue.key,mt,"stop domain value must be a number, string, or boolean")];if(Ze!=="number"&&d!=="categorical"){let Bt=`number expected, ${Ze} found`;return Tc(s)&&d===void 0&&(Bt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new xt(Ue.key,mt,Bt)]}return d!=="categorical"||Ze!=="number"||isFinite(ct)&&Math.floor(ct)===ct?d!=="categorical"&&Ze==="number"&&I!==void 0&&ct<I?[new xt(Ue.key,mt,"stop domain values must appear in ascending order")]:(I=ct,d==="categorical"&&ct in V?[new xt(Ue.key,mt,"stop domain values must be unique")]:(V[ct]=!0,[])):[new xt(Ue.key,mt,`integer expected, found ${ct}`)]}}function Ha(u){const s=(u.expressionContext==="property"?vu:zs)(As(u.value),u.valueSpec);if(s.result==="error")return s.value.map(k=>new xt(`${u.key}${k.key}`,u.value,k.message));const d=s.value.expression||s.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!d.outputDefined())return[new xt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!li(d))return[new xt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!li(d))return[new xt(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!pu(d,["zoom","feature-state"]))return[new xt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!du(d))return[new xt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function os(u){const s=u.key,d=u.value,k=u.valueSpec,I=[];return Array.isArray(k.values)?k.values.indexOf(Si(d))===-1&&I.push(new xt(s,d,`expected one of [${k.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(k.values).indexOf(Si(d))===-1&&I.push(new xt(s,d,`expected one of [${Object.keys(k.values).join(", ")}], ${JSON.stringify(d)} found`)),I}function R0(u){return _u(As(u.value))?Ha(Ht({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Cm(u)}function Cm(u){const s=u.value,d=u.key;if(si(s)!=="array")return[new xt(d,s,`array expected, ${si(s)} found`)];const k=u.styleSpec;let I,F=[];if(s.length<1)return[new xt(d,s,"filter array must have at least 1 element")];switch(F=F.concat(os({key:`${d}[0]`,value:s[0],valueSpec:k.filter_operator,style:u.style,styleSpec:u.styleSpec})),Si(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&Si(s[1])==="$type"&&F.push(new xt(d,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&F.push(new xt(d,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(I=si(s[1]),I!=="string"&&F.push(new xt(`${d}[1]`,s[1],`string expected, ${I} found`)));for(let V=2;V<s.length;V++)I=si(s[V]),Si(s[1])==="$type"?F=F.concat(os({key:`${d}[${V}]`,value:s[V],valueSpec:k.geometry_type,style:u.style,styleSpec:u.styleSpec})):I!=="string"&&I!=="number"&&I!=="boolean"&&F.push(new xt(`${d}[${V}]`,s[V],`string, number, or boolean expected, ${I} found`));break;case"any":case"all":case"none":for(let V=1;V<s.length;V++)F=F.concat(Cm({key:`${d}[${V}]`,value:s[V],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":I=si(s[1]),s.length!==2?F.push(new xt(d,s,`filter array for "${s[0]}" operator must have 2 elements`)):I!=="string"&&F.push(new xt(`${d}[1]`,s[1],`string expected, ${I} found`))}return F}function D0(u,s){const d=u.key,k=u.validateSpec,I=u.style,F=u.styleSpec,V=u.value,K=u.objectKey,ne=F[`${s}_${u.layerType}`];if(!ne)return[];const ue=K.match(/^(.*)-transition$/);if(s==="paint"&&ue&&ne[ue[1]]&&ne[ue[1]].transition)return k({key:d,value:V,valueSpec:F.transition,style:I,styleSpec:F});const xe=u.valueSpec||ne[K];if(!xe)return[new xt(d,V,`unknown property "${K}"`)];let Te;if(si(V)==="string"&&Tc(xe)&&!xe.tokens&&(Te=/^{([^}]+)}$/.exec(V)))return[new xt(d,V,`"${K}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Te[1])} }\`.`)];const Ne=[];return u.layerType==="symbol"&&(K==="text-field"&&I&&!I.glyphs&&Ne.push(new xt(d,V,'use of "text-field" requires a style "glyphs" property')),K==="text-font"&&Mh(As(V))&&Si(V.type)==="identity"&&Ne.push(new xt(d,V,'"text-font" does not support identity functions'))),Ne.concat(k({key:u.key,value:V,valueSpec:xe,style:I,styleSpec:F,expressionContext:"property",propertyType:s,propertyKey:K}))}function Im(u){return D0(u,"paint")}function L0(u){return D0(u,"layout")}function j0(u){let s=[];const d=u.value,k=u.key,I=u.style,F=u.styleSpec;d.type||d.ref||s.push(new xt(k,d,'either "type" or "ref" is required'));let V=Si(d.type);const K=Si(d.ref);if(d.id){const ne=Si(d.id);for(let ue=0;ue<u.arrayIndex;ue++){const xe=I.layers[ue];Si(xe.id)===ne&&s.push(new xt(k,d.id,`duplicate layer id "${d.id}", previously used at line ${xe.id.__line__}`))}}if("ref"in d){let ne;["type","source","source-layer","filter","layout"].forEach(ue=>{ue in d&&s.push(new xt(k,d[ue],`"${ue}" is prohibited for ref layers`))}),I.layers.forEach(ue=>{Si(ue.id)===K&&(ne=ue)}),ne?ne.ref?s.push(new xt(k,d.ref,"ref cannot reference another ref layer")):V=Si(ne.type):s.push(new xt(k,d.ref,`ref layer "${K}" not found`))}else if(V!=="background")if(d.source){const ne=I.sources&&I.sources[d.source],ue=ne&&Si(ne.type);ne?ue==="vector"&&V==="raster"?s.push(new xt(k,d.source,`layer "${d.id}" requires a raster source`)):ue!=="raster-dem"&&V==="hillshade"?s.push(new xt(k,d.source,`layer "${d.id}" requires a raster-dem source`)):ue==="raster"&&V!=="raster"?s.push(new xt(k,d.source,`layer "${d.id}" requires a vector source`)):ue!=="vector"||d["source-layer"]?ue==="raster-dem"&&V!=="hillshade"?s.push(new xt(k,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):V!=="line"||!d.paint||!d.paint["line-gradient"]||ue==="geojson"&&ne.lineMetrics||s.push(new xt(k,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new xt(k,d,`layer "${d.id}" must specify a "source-layer"`)):s.push(new xt(k,d.source,`source "${d.source}" not found`))}else s.push(new xt(k,d,'missing required property "source"'));return s=s.concat(Do({key:k,value:d,valueSpec:F.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${k}.type`,value:d.type,valueSpec:F.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:d,objectKey:"type"}),filter:R0,layout:ne=>Do({layer:d,key:ne.key,value:ne.value,style:ne.style,styleSpec:ne.styleSpec,validateSpec:ne.validateSpec,objectElementValidators:{"*":ue=>L0(Ht({layerType:V},ue))}}),paint:ne=>Do({layer:d,key:ne.key,value:ne.value,style:ne.style,styleSpec:ne.styleSpec,validateSpec:ne.validateSpec,objectElementValidators:{"*":ue=>Im(Ht({layerType:V},ue))}})}})),s}function Eu(u){const s=u.value,d=u.key,k=si(s);return k!=="string"?[new xt(d,s,`string expected, ${k} found`)]:[]}const Rm={promoteId:function({key:u,value:s}){if(si(s)==="string")return Eu({key:u,value:s});{const d=[];for(const k in s)d.push(...Eu({key:`${u}.${k}`,value:s[k]}));return d}}};function wd(u){const s=u.value,d=u.key,k=u.styleSpec,I=u.style,F=u.validateSpec;if(!s.type)return[new xt(d,s,'"type" is required')];const V=Si(s.type);let K;switch(V){case"vector":case"raster":return K=Do({key:d,value:s,valueSpec:k[`source_${V.replace("-","_")}`],style:u.style,styleSpec:k,objectElementValidators:Rm,validateSpec:F}),K;case"raster-dem":return K=function(ne){var ue;const xe=(ue=ne.sourceName)!==null&&ue!==void 0?ue:"",Te=ne.value,Ne=ne.styleSpec,Ue=Ne.source_raster_dem,Ke=ne.style;let Ze=[];const ct=si(Te);if(Te===void 0)return Ze;if(ct!=="object")return Ze.push(new xt("source_raster_dem",Te,`object expected, ${ct} found`)),Ze;const mt=Si(Te.encoding)==="custom",Bt=["redFactor","greenFactor","blueFactor","baseShift"],Pt=ne.value.encoding?`"${ne.value.encoding}"`:"Default";for(const $t in Te)!mt&&Bt.includes($t)?Ze.push(new xt($t,Te[$t],`In "${xe}": "${$t}" is only valid when "encoding" is set to "custom". ${Pt} encoding found`)):Ue[$t]?Ze=Ze.concat(ne.validateSpec({key:$t,value:Te[$t],valueSpec:Ue[$t],validateSpec:ne.validateSpec,style:Ke,styleSpec:Ne})):Ze.push(new xt($t,Te[$t],`unknown property "${$t}"`));return Ze}({sourceName:d,value:s,style:u.style,styleSpec:k,validateSpec:F}),K;case"geojson":if(K=Do({key:d,value:s,valueSpec:k.source_geojson,style:I,styleSpec:k,validateSpec:F,objectElementValidators:Rm}),s.cluster)for(const ne in s.clusterProperties){const[ue,xe]=s.clusterProperties[ne],Te=typeof ue=="string"?[ue,["accumulated"],["get",ne]]:ue;K.push(...Ha({key:`${d}.${ne}.map`,value:xe,validateSpec:F,expressionContext:"cluster-map"})),K.push(...Ha({key:`${d}.${ne}.reduce`,value:Te,validateSpec:F,expressionContext:"cluster-reduce"}))}return K;case"video":return Do({key:d,value:s,valueSpec:k.source_video,style:I,validateSpec:F,styleSpec:k});case"image":return Do({key:d,value:s,valueSpec:k.source_image,style:I,validateSpec:F,styleSpec:k});case"canvas":return[new xt(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return os({key:`${d}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:I,validateSpec:F,styleSpec:k})}}function N0(u){const s=u.value,d=u.styleSpec,k=d.light,I=u.style;let F=[];const V=si(s);if(s===void 0)return F;if(V!=="object")return F=F.concat([new xt("light",s,`object expected, ${V} found`)]),F;for(const K in s){const ne=K.match(/^(.*)-transition$/);F=F.concat(ne&&k[ne[1]]&&k[ne[1]].transition?u.validateSpec({key:K,value:s[K],valueSpec:d.transition,validateSpec:u.validateSpec,style:I,styleSpec:d}):k[K]?u.validateSpec({key:K,value:s[K],valueSpec:k[K],validateSpec:u.validateSpec,style:I,styleSpec:d}):[new xt(K,s[K],`unknown property "${K}"`)])}return F}function $0(u){const s=u.value,d=u.styleSpec,k=d.sky,I=u.style,F=si(s);if(s===void 0)return[];if(F!=="object")return[new xt("sky",s,`object expected, ${F} found`)];let V=[];for(const K in s)V=V.concat(k[K]?u.validateSpec({key:K,value:s[K],valueSpec:k[K],style:I,styleSpec:d}):[new xt(K,s[K],`unknown property "${K}"`)]);return V}function B0(u){const s=u.value,d=u.styleSpec,k=d.terrain,I=u.style;let F=[];const V=si(s);if(s===void 0)return F;if(V!=="object")return F=F.concat([new xt("terrain",s,`object expected, ${V} found`)]),F;for(const K in s)F=F.concat(k[K]?u.validateSpec({key:K,value:s[K],valueSpec:k[K],validateSpec:u.validateSpec,style:I,styleSpec:d}):[new xt(K,s[K],`unknown property "${K}"`)]);return F}function F0(u){let s=[];const d=u.value,k=u.key;if(Array.isArray(d)){const I=[],F=[];for(const V in d)d[V].id&&I.includes(d[V].id)&&s.push(new xt(k,d,`all the sprites' ids must be unique, but ${d[V].id} is duplicated`)),I.push(d[V].id),d[V].url&&F.includes(d[V].url)&&s.push(new xt(k,d,`all the sprites' URLs must be unique, but ${d[V].url} is duplicated`)),F.push(d[V].url),s=s.concat(Do({key:`${k}[${V}]`,value:d[V],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return s}return Eu({key:k,value:d})}const Dm={"*":()=>[],array:Us,boolean:function(u){const s=u.value,d=u.key,k=si(s);return k!=="boolean"?[new xt(d,s,`boolean expected, ${k} found`)]:[]},number:Cc,color:function(u){const s=u.key,d=u.value,k=si(d);return k!=="string"?[new xt(s,d,`color expected, ${k} found`)]:mn.parse(String(d))?[]:[new xt(s,d,`color expected, "${d}" found`)]},constants:Ki,enum:os,filter:R0,function:Su,layer:j0,object:Do,source:wd,light:N0,sky:$0,terrain:B0,projection:function(u){const s=u.value,d=u.styleSpec,k=d.projection,I=u.style,F=si(s);if(s===void 0)return[];if(F!=="object")return[new xt("projection",s,`object expected, ${F} found`)];let V=[];for(const K in s)V=V.concat(k[K]?u.validateSpec({key:K,value:s[K],valueSpec:k[K],style:I,styleSpec:d}):[new xt(K,s[K],`unknown property "${K}"`)]);return V},string:Eu,formatted:function(u){return Eu(u).length===0?[]:Ha(u)},resolvedImage:function(u){return Eu(u).length===0?[]:Ha(u)},padding:function(u){const s=u.key,d=u.value;if(si(d)==="array"){if(d.length<1||d.length>4)return[new xt(s,d,`padding requires 1 to 4 values; ${d.length} values found`)];const k={type:"number"};let I=[];for(let F=0;F<d.length;F++)I=I.concat(u.validateSpec({key:`${s}[${F}]`,value:d[F],validateSpec:u.validateSpec,valueSpec:k}));return I}return Cc({key:s,value:d,valueSpec:{}})},variableAnchorOffsetCollection:function(u){const s=u.key,d=u.value,k=si(d),I=u.styleSpec;if(k!=="array"||d.length<1||d.length%2!=0)return[new xt(s,d,"variableAnchorOffsetCollection requires a non-empty array of even length")];let F=[];for(let V=0;V<d.length;V+=2)F=F.concat(os({key:`${s}[${V}]`,value:d[V],valueSpec:I.layout_symbol["text-anchor"]})),F=F.concat(Us({key:`${s}[${V+1}]`,value:d[V+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:I}));return F},sprite:F0};function Rh(u){const s=u.value,d=u.valueSpec,k=u.styleSpec;return u.validateSpec=Rh,d.expression&&Mh(Si(s))?Su(u):d.expression&&bu(As(s))?Ha(u):d.type&&Dm[d.type]?Dm[d.type](u):Do(Ht({},u,{valueSpec:d.type?k[d.type]:d}))}function ow(u){const s=u.value,d=u.key,k=Eu(u);return k.length||(s.indexOf("{fontstack}")===-1&&k.push(new xt(d,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&k.push(new xt(d,s,'"glyphs" url must include a "{range}" token'))),k}function Ea(u,s=te){let d=[];return d=d.concat(Rh({key:"",value:u,valueSpec:s.$root,styleSpec:s,style:u,validateSpec:Rh,objectElementValidators:{glyphs:ow,"*":()=>[]}})),u.constants&&(d=d.concat(Ki({key:"constants",value:u.constants,style:u,styleSpec:s,validateSpec:Rh}))),z0(d)}function Al(u){return function(s){return u({...s,validateSpec:Rh})}}function z0(u){return[].concat(u).sort((s,d)=>s.line-d.line)}function Wa(u){return function(...s){return z0(u.apply(this,s))}}Ea.source=Wa(Al(wd)),Ea.sprite=Wa(Al(F0)),Ea.glyphs=Wa(Al(ow)),Ea.light=Wa(Al(N0)),Ea.sky=Wa(Al($0)),Ea.terrain=Wa(Al(B0)),Ea.layer=Wa(Al(j0)),Ea.filter=Wa(Al(R0)),Ea.paintProperty=Wa(Al(Im)),Ea.layoutProperty=Wa(Al(L0));const Au=Ea,u3=Au.light,h3=Au.sky,sw=Au.paintProperty,aw=Au.layoutProperty;function U0(u,s){let d=!1;if(s&&s.length)for(const k of s)u.fire(new se(new Error(k.message))),d=!0;return d}class Dh{constructor(s,d,k){const I=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const V=new Int32Array(this.arrayBuffer);s=V[0],this.d=(d=V[1])+2*(k=V[2]);for(let ne=0;ne<this.d*this.d;ne++){const ue=V[3+ne],xe=V[3+ne+1];I.push(ue===xe?null:V.subarray(ue,xe))}const K=V[3+I.length+1];this.keys=V.subarray(V[3+I.length],K),this.bboxes=V.subarray(K),this.insert=this._insertReadonly}else{this.d=d+2*k;for(let V=0;V<this.d*this.d;V++)I.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=s,this.padding=k,this.scale=d/s,this.uid=0;const F=k/d*s;this.min=-F,this.max=s+F}insert(s,d,k,I,F){this._forEachCell(d,k,I,F,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(d),this.bboxes.push(k),this.bboxes.push(I),this.bboxes.push(F)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,d,k,I,F,V){this.cells[F].push(V)}query(s,d,k,I,F){const V=this.min,K=this.max;if(s<=V&&d<=V&&K<=k&&K<=I&&!F)return Array.prototype.slice.call(this.keys);{const ne=[];return this._forEachCell(s,d,k,I,this._queryCell,ne,{},F),ne}}_queryCell(s,d,k,I,F,V,K,ne){const ue=this.cells[F];if(ue!==null){const xe=this.keys,Te=this.bboxes;for(let Ne=0;Ne<ue.length;Ne++){const Ue=ue[Ne];if(K[Ue]===void 0){const Ke=4*Ue;(ne?ne(Te[Ke+0],Te[Ke+1],Te[Ke+2],Te[Ke+3]):s<=Te[Ke+2]&&d<=Te[Ke+3]&&k>=Te[Ke+0]&&I>=Te[Ke+1])?(K[Ue]=!0,V.push(xe[Ue])):K[Ue]=!1}}}}_forEachCell(s,d,k,I,F,V,K,ne){const ue=this._convertToCellCoord(s),xe=this._convertToCellCoord(d),Te=this._convertToCellCoord(k),Ne=this._convertToCellCoord(I);for(let Ue=ue;Ue<=Te;Ue++)for(let Ke=xe;Ke<=Ne;Ke++){const Ze=this.d*Ke+Ue;if((!ne||ne(this._convertFromCellCoord(Ue),this._convertFromCellCoord(Ke),this._convertFromCellCoord(Ue+1),this._convertFromCellCoord(Ke+1)))&&F.call(this,s,d,k,I,Ze,V,K,ne))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,d=3+this.cells.length+1+1;let k=0;for(let V=0;V<this.cells.length;V++)k+=this.cells[V].length;const I=new Int32Array(d+k+this.keys.length+this.bboxes.length);I[0]=this.extent,I[1]=this.n,I[2]=this.padding;let F=d;for(let V=0;V<s.length;V++){const K=s[V];I[3+V]=F,I.set(K,F),F+=K.length}return I[3+s.length]=F,I.set(this.keys,F),F+=this.keys.length,I[3+s.length+1]=F,I.set(this.bboxes,F),F+=this.bboxes.length,I.buffer}static serialize(s,d){const k=s.toArrayBuffer();return d&&d.push(k),{buffer:k}}static deserialize(s){return new Dh(s.buffer)}}const Aa={};function Vn(u,s,d={}){if(Aa[u])throw new Error(`${u} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:u,writeable:!1}),Aa[u]={klass:s,omit:d.omit||[],shallow:d.shallow||[]}}Vn("Object",Object),Vn("TransferableGridIndex",Dh),Vn("Color",mn),Vn("Error",Error),Vn("AJAXError",Oe),Vn("ResolvedImage",On),Vn("StylePropertyFunction",El),Vn("StyleExpression",yu,{omit:["_evaluator"]}),Vn("ZoomDependentExpression",Mc),Vn("ZoomConstantExpression",Oc),Vn("CompoundExpression",Go,{omit:["_evaluate"]});for(const u in aa)aa[u]._classRegistryKey||Vn(`Expression_${u}`,aa[u]);function Lm(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function V0(u){return u.$name||u.constructor._classRegistryKey}function lw(u){return!function(s){if(s===null||typeof s!="object")return!1;const d=V0(s);return!(!d||d==="Object")}(u)&&(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||u instanceof Error||Lm(u)||be(u)||ArrayBuffer.isView(u)||u instanceof ImageData)}function Lh(u,s){if(lw(u))return(Lm(u)||be(u))&&s&&s.push(u),ArrayBuffer.isView(u)&&s&&s.push(u.buffer),u instanceof ImageData&&s&&s.push(u.data.buffer),u;if(Array.isArray(u)){const F=[];for(const V of u)F.push(Lh(V,s));return F}if(typeof u!="object")throw new Error("can't serialize object of type "+typeof u);const d=V0(u);if(!d)throw new Error(`can't serialize object of unregistered class ${u.constructor.name}`);if(!Aa[d])throw new Error(`${d} is not registered.`);const{klass:k}=Aa[d],I=k.serialize?k.serialize(u,s):{};if(k.serialize){if(s&&I===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const F in u){if(!u.hasOwnProperty(F)||Aa[d].omit.indexOf(F)>=0)continue;const V=u[F];I[F]=Aa[d].shallow.indexOf(F)>=0?V:Lh(V,s)}u instanceof Error&&(I.message=u.message)}if(I.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(I.$name=d),I}function jh(u){if(lw(u))return u;if(Array.isArray(u))return u.map(jh);if(typeof u!="object")throw new Error("can't deserialize object of type "+typeof u);const s=V0(u)||"Object";if(!Aa[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:d}=Aa[s];if(!d)throw new Error(`can't deserialize unregistered class ${s}`);if(d.deserialize)return d.deserialize(u);const k=Object.create(d.prototype);for(const I of Object.keys(u)){if(I==="$name")continue;const F=u[I];k[I]=Aa[s].shallow.indexOf(I)>=0?F:jh(F)}return k}class q0{constructor(){this.first=!0}update(s,d){const k=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=k,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=k,!0):(this.lastFloorZoom>k?(this.lastIntegerZoom=k+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<k&&(this.lastIntegerZoom=k,this.lastIntegerZoomTime=d),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=k,!0))}}const ni={"Latin-1 Supplement":u=>u>=128&&u<=255,"Hangul Jamo":u=>u>=4352&&u<=4607,Khmer:u=>u>=6016&&u<=6143,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Katakana:u=>u>=12448&&u<=12543,Kanbun:u=>u>=12688&&u<=12703,"CJK Strokes":u=>u>=12736&&u<=12783,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"Private Use Area":u=>u>=57344&&u<=63743,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function H0(u){for(const s of u)if(G0(s.charCodeAt(0)))return!0;return!1}function f3(u){for(const s of u)if(!Nh(s.charCodeAt(0)))return!1;return!0}function W0(u){const s=u.map(d=>{try{return new RegExp(`\\p{sc=${d}}`,"u").source}catch{return null}}).filter(d=>d);return new RegExp(s.join("|"),"u")}const d3=W0(["Arab","Dupl","Mong","Ougr","Syrc"]);function Nh(u){return!d3.test(String.fromCodePoint(u))}const cw=W0(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function G0(u){return!(u!==746&&u!==747&&(u<4352||!(ni["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||ni["CJK Compatibility"](u)||ni["CJK Strokes"](u)||!(!ni["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||ni["Enclosed CJK Letters and Months"](u)||ni["Ideographic Description Characters"](u)||ni.Kanbun(u)||ni.Katakana(u)&&u!==12540||!(!ni["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!ni["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||ni["Vertical Forms"](u)||ni["Yijing Hexagram Symbols"](u)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(u))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(u))||cw.test(String.fromCodePoint(u)))))}function uw(u){return!(G0(u)||function(s){return!!(ni["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||ni["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||ni["Letterlike Symbols"](s)||ni["Number Forms"](s)||ni["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||ni["Control Pictures"](s)&&s!==9251||ni["Optical Character Recognition"](s)||ni["Enclosed Alphanumerics"](s)||ni["Geometric Shapes"](s)||ni["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||ni["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||ni["CJK Symbols and Punctuation"](s)||ni.Katakana(s)||ni["Private Use Area"](s)||ni["CJK Compatibility Forms"](s)||ni["Small Form Variants"](s)||ni["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(u))}const p3=W0(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function K0(u){return p3.test(String.fromCodePoint(u))}function m3(u,s){return!(!s&&K0(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||ni.Khmer(u))}function g3(u){for(const s of u)if(K0(s.charCodeAt(0)))return!0;return!1}const ca=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(u){this.pluginStatus=u.pluginStatus,this.pluginURL=u.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(u){this.applyArabicShaping=u.applyArabicShaping,this.processBidirectionalText=u.processBidirectionalText,this.processStyledBidirectionalText=u.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ji{constructor(s,d){this.zoom=s,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new q0,this.transition={})}isSupportedScript(s){return function(d,k){for(const I of d)if(!m3(I.charCodeAt(0),k))return!1;return!0}(s,ca.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,d=s-Math.floor(s),k=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*k}:{fromScale:.5,toScale:1,t:1-(1-k)*d}}}class $h{constructor(s,d){this.property=s,this.value=d,this.expression=function(k,I){if(Mh(k))return new El(k,I);if(bu(k)){const F=vu(k,I);if(F.result==="error")throw new Error(F.value.map(V=>`${V.key}: ${V.message}`).join(", "));return F.value}{let F=k;return I.type==="color"&&typeof k=="string"?F=mn.parse(k):I.type!=="padding"||typeof k!="number"&&!Array.isArray(k)?I.type==="variableAnchorOffsetCollection"&&Array.isArray(k)&&(F=ir.parse(k)):F=on.parse(k),{kind:"constant",evaluate:()=>F}}}(d===void 0?s.specification.default:d,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,d,k){return this.property.possiblyEvaluate(this,s,d,k)}}class jm{constructor(s){this.property=s,this.value=new $h(s,void 0)}transitioned(s,d){return new hw(this.property,this.value,d,R({},s.transition,this.transition),s.now)}untransitioned(){return new hw(this.property,this.value,null,{},0)}}class Nm{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return G(this._values[s].value.value)}setValue(s,d){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new jm(this._values[s].property)),this._values[s].value=new $h(this._values[s].property,d===null?void 0:G(d))}getTransition(s){return G(this._values[s].transition)}setTransition(s,d){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new jm(this._values[s].property)),this._values[s].transition=G(d)||void 0}serialize(){const s={};for(const d of Object.keys(this._values)){const k=this.getValue(d);k!==void 0&&(s[d]=k);const I=this.getTransition(d);I!==void 0&&(s[`${d}-transition`]=I)}return s}transitioned(s,d){const k=new xd(this._properties);for(const I of Object.keys(this._values))k._values[I]=this._values[I].transitioned(s,d._values[I]);return k}untransitioned(){const s=new xd(this._properties);for(const d of Object.keys(this._values))s._values[d]=this._values[d].untransitioned();return s}}class hw{constructor(s,d,k,I,F){this.property=s,this.value=d,this.begin=F+I.delay||0,this.end=this.begin+I.duration||0,s.specification.transition&&(I.delay||I.duration)&&(this.prior=k)}possiblyEvaluate(s,d,k){const I=s.now||0,F=this.value.possiblyEvaluate(s,d,k),V=this.prior;if(V){if(I>this.end)return this.prior=null,F;if(this.value.isDataDriven())return this.prior=null,F;if(I<this.begin)return V.possiblyEvaluate(s,d,k);{const K=(I-this.begin)/(this.end-this.begin);return this.property.interpolate(V.possiblyEvaluate(s,d,k),F,function(ne){if(ne<=0)return 0;if(ne>=1)return 1;const ue=ne*ne,xe=ue*ne;return 4*(ne<.5?xe:3*(ne-ue)+xe-.75)}(K))}}return F}}class xd{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,d,k){const I=new Ed(this._properties);for(const F of Object.keys(this._values))I._values[F]=this._values[F].possiblyEvaluate(s,d,k);return I}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Sd{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return this._values[s].value!==void 0}getValue(s){return G(this._values[s].value)}setValue(s,d){this._values[s]=new $h(this._values[s].property,d===null?void 0:G(d))}serialize(){const s={};for(const d of Object.keys(this._values)){const k=this.getValue(d);k!==void 0&&(s[d]=k)}return s}possiblyEvaluate(s,d,k){const I=new Ed(this._properties);for(const F of Object.keys(this._values))I._values[F]=this._values[F].possiblyEvaluate(s,d,k);return I}}class kl{constructor(s,d,k){this.property=s,this.value=d,this.parameters=k}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,d,k,I){return this.property.evaluate(this.value,this.parameters,s,d,k,I)}}class Ed{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Yn{constructor(s){this.specification=s}possiblyEvaluate(s,d){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(d)}interpolate(s,d,k){const I=Wi[this.specification.type];return I?I(s,d,k):s}}class Sr{constructor(s,d){this.specification=s,this.overrides=d}possiblyEvaluate(s,d,k,I){return new kl(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(d,null,{},k,I)}:s.expression,d)}interpolate(s,d,k){if(s.value.kind!=="constant"||d.value.kind!=="constant")return s;if(s.value.value===void 0||d.value.value===void 0)return new kl(this,{kind:"constant",value:void 0},s.parameters);const I=Wi[this.specification.type];if(I){const F=I(s.value.value,d.value.value,k);return new kl(this,{kind:"constant",value:F},s.parameters)}return s}evaluate(s,d,k,I,F,V){return s.kind==="constant"?s.value:s.evaluate(d,k,I,F,V)}}class $m extends Sr{possiblyEvaluate(s,d,k,I){if(s.value===void 0)return new kl(this,{kind:"constant",value:void 0},d);if(s.expression.kind==="constant"){const F=s.expression.evaluate(d,null,{},k,I),V=s.property.specification.type==="resolvedImage"&&typeof F!="string"?F.name:F,K=this._calculate(V,V,V,d);return new kl(this,{kind:"constant",value:K},d)}if(s.expression.kind==="camera"){const F=this._calculate(s.expression.evaluate({zoom:d.zoom-1}),s.expression.evaluate({zoom:d.zoom}),s.expression.evaluate({zoom:d.zoom+1}),d);return new kl(this,{kind:"constant",value:F},d)}return new kl(this,s.expression,d)}evaluate(s,d,k,I,F,V){if(s.kind==="source"){const K=s.evaluate(d,k,I,F,V);return this._calculate(K,K,K,d)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(d.zoom)-1},k,I),s.evaluate({zoom:Math.floor(d.zoom)},k,I),s.evaluate({zoom:Math.floor(d.zoom)+1},k,I),d):s.value}_calculate(s,d,k,I){return I.zoom>I.zoomHistory.lastIntegerZoom?{from:s,to:d}:{from:k,to:d}}interpolate(s){return s}}class Bm{constructor(s){this.specification=s}possiblyEvaluate(s,d,k,I){if(s.value!==void 0){if(s.expression.kind==="constant"){const F=s.expression.evaluate(d,null,{},k,I);return this._calculate(F,F,F,d)}return this._calculate(s.expression.evaluate(new ji(Math.floor(d.zoom-1),d)),s.expression.evaluate(new ji(Math.floor(d.zoom),d)),s.expression.evaluate(new ji(Math.floor(d.zoom+1),d)),d)}}_calculate(s,d,k,I){return I.zoom>I.zoomHistory.lastIntegerZoom?{from:s,to:d}:{from:k,to:d}}interpolate(s){return s}}class X0{constructor(s){this.specification=s}possiblyEvaluate(s,d,k,I){return!!s.expression.evaluate(d,null,{},k,I)}interpolate(){return!1}}class ${constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const d in s){const k=s[d];k.specification.overridable&&this.overridableProperties.push(d);const I=this.defaultPropertyValues[d]=new $h(k,void 0),F=this.defaultTransitionablePropertyValues[d]=new jm(k);this.defaultTransitioningPropertyValues[d]=F.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=I.possiblyEvaluate({})}}}Vn("DataDrivenProperty",Sr),Vn("DataConstantProperty",Yn),Vn("CrossFadedDataDrivenProperty",$m),Vn("CrossFadedProperty",Bm),Vn("ColorRampProperty",X0);const o="-transition";class S extends _e{constructor(s,d){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),d.layout&&(this._unevaluatedLayout=new Sd(d.layout)),d.paint)){this._transitionablePaint=new Nm(d.paint);for(const k in s.paint)this.setPaintProperty(k,s.paint[k],{validate:!1});for(const k in s.layout)this.setLayoutProperty(k,s.layout[k],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ed(d.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,d,k={}){d!=null&&this._validate(aw,`layers.${this.id}.layout.${s}`,s,d,k)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,d):this.visibility=d)}getPaintProperty(s){return s.endsWith(o)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,d,k={}){if(d!=null&&this._validate(sw,`layers.${this.id}.paint.${s}`,s,d,k))return!1;if(s.endsWith(o))return this._transitionablePaint.setTransition(s.slice(0,-11),d||void 0),!1;{const I=this._transitionablePaint._values[s],F=I.property.specification["property-type"]==="cross-faded-data-driven",V=I.value.isDataDriven(),K=I.value;this._transitionablePaint.setValue(s,d),this._handleSpecialPaintPropertyUpdate(s);const ne=this._transitionablePaint._values[s].value;return ne.isDataDriven()||V||F||this._handleOverridablePaintPropertyUpdate(s,K,ne)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,d,k){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,d){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,d)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),W(s,(d,k)=>!(d===void 0||k==="layout"&&!Object.keys(d).length||k==="paint"&&!Object.keys(d).length))}_validate(s,d,k,I,F={}){return(!F||F.validate!==!1)&&U0(this,s.call(Au,{key:d,layerType:this.type,objectKey:k,value:I,styleSpec:te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const d=this.paint.get(s);if(d instanceof kl&&Tc(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1}}const O={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class C{constructor(s,d){this._structArray=s,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class j{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,d){return s._trim(),d&&(s.isTransferred=!0,d.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const d=Object.create(this.prototype);return d.arrayBuffer=s.arrayBuffer,d.length=s.length,d.capacity=s.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function J(u,s=1){let d=0,k=0;return{members:u.map(I=>{const F=O[I.type].BYTES_PER_ELEMENT,V=d=ie(d,Math.max(s,F)),K=I.components||1;return k=Math.max(k,F),d+=F*K,{name:I.name,type:I.type,components:K,offset:V}}),size:ie(d,Math.max(k,s)),alignment:s}}function ie(u,s){return Math.ceil(u/s)*s}class ce extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d){const k=this.length;return this.resize(k+1),this.emplace(k,s,d)}emplace(s,d,k){const I=2*s;return this.int16[I+0]=d,this.int16[I+1]=k,s}}ce.prototype.bytesPerElement=4,Vn("StructArrayLayout2i4",ce);class Se extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,k){const I=this.length;return this.resize(I+1),this.emplace(I,s,d,k)}emplace(s,d,k,I){const F=3*s;return this.int16[F+0]=d,this.int16[F+1]=k,this.int16[F+2]=I,s}}Se.prototype.bytesPerElement=6,Vn("StructArrayLayout3i6",Se);class Me extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,k,I){const F=this.length;return this.resize(F+1),this.emplace(F,s,d,k,I)}emplace(s,d,k,I,F){const V=4*s;return this.int16[V+0]=d,this.int16[V+1]=k,this.int16[V+2]=I,this.int16[V+3]=F,s}}Me.prototype.bytesPerElement=8,Vn("StructArrayLayout4i8",Me);class Ce extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V){const K=this.length;return this.resize(K+1),this.emplace(K,s,d,k,I,F,V)}emplace(s,d,k,I,F,V,K){const ne=6*s;return this.int16[ne+0]=d,this.int16[ne+1]=k,this.int16[ne+2]=I,this.int16[ne+3]=F,this.int16[ne+4]=V,this.int16[ne+5]=K,s}}Ce.prototype.bytesPerElement=12,Vn("StructArrayLayout2i4i12",Ce);class He extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V){const K=this.length;return this.resize(K+1),this.emplace(K,s,d,k,I,F,V)}emplace(s,d,k,I,F,V,K){const ne=4*s,ue=8*s;return this.int16[ne+0]=d,this.int16[ne+1]=k,this.uint8[ue+4]=I,this.uint8[ue+5]=F,this.uint8[ue+6]=V,this.uint8[ue+7]=K,s}}He.prototype.bytesPerElement=8,Vn("StructArrayLayout2i4ub8",He);class Ye extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d){const k=this.length;return this.resize(k+1),this.emplace(k,s,d)}emplace(s,d,k){const I=2*s;return this.float32[I+0]=d,this.float32[I+1]=k,s}}Ye.prototype.bytesPerElement=8,Vn("StructArrayLayout2f8",Ye);class tt extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V,K,ne,ue,xe){const Te=this.length;return this.resize(Te+1),this.emplace(Te,s,d,k,I,F,V,K,ne,ue,xe)}emplace(s,d,k,I,F,V,K,ne,ue,xe,Te){const Ne=10*s;return this.uint16[Ne+0]=d,this.uint16[Ne+1]=k,this.uint16[Ne+2]=I,this.uint16[Ne+3]=F,this.uint16[Ne+4]=V,this.uint16[Ne+5]=K,this.uint16[Ne+6]=ne,this.uint16[Ne+7]=ue,this.uint16[Ne+8]=xe,this.uint16[Ne+9]=Te,s}}tt.prototype.bytesPerElement=20,Vn("StructArrayLayout10ui20",tt);class ht extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V,K,ne,ue,xe,Te,Ne){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,s,d,k,I,F,V,K,ne,ue,xe,Te,Ne)}emplace(s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue){const Ke=12*s;return this.int16[Ke+0]=d,this.int16[Ke+1]=k,this.int16[Ke+2]=I,this.int16[Ke+3]=F,this.uint16[Ke+4]=V,this.uint16[Ke+5]=K,this.uint16[Ke+6]=ne,this.uint16[Ke+7]=ue,this.int16[Ke+8]=xe,this.int16[Ke+9]=Te,this.int16[Ke+10]=Ne,this.int16[Ke+11]=Ue,s}}ht.prototype.bytesPerElement=24,Vn("StructArrayLayout4i4ui4i24",ht);class yt extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,k){const I=this.length;return this.resize(I+1),this.emplace(I,s,d,k)}emplace(s,d,k,I){const F=3*s;return this.float32[F+0]=d,this.float32[F+1]=k,this.float32[F+2]=I,s}}yt.prototype.bytesPerElement=12,Vn("StructArrayLayout3f12",yt);class vt extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.uint32[1*s+0]=d,s}}vt.prototype.bytesPerElement=4,Vn("StructArrayLayout1ul4",vt);class kt extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V,K,ne,ue){const xe=this.length;return this.resize(xe+1),this.emplace(xe,s,d,k,I,F,V,K,ne,ue)}emplace(s,d,k,I,F,V,K,ne,ue,xe){const Te=10*s,Ne=5*s;return this.int16[Te+0]=d,this.int16[Te+1]=k,this.int16[Te+2]=I,this.int16[Te+3]=F,this.int16[Te+4]=V,this.int16[Te+5]=K,this.uint32[Ne+3]=ne,this.uint16[Te+8]=ue,this.uint16[Te+9]=xe,s}}kt.prototype.bytesPerElement=20,Vn("StructArrayLayout6i1ul2ui20",kt);class lt extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V){const K=this.length;return this.resize(K+1),this.emplace(K,s,d,k,I,F,V)}emplace(s,d,k,I,F,V,K){const ne=6*s;return this.int16[ne+0]=d,this.int16[ne+1]=k,this.int16[ne+2]=I,this.int16[ne+3]=F,this.int16[ne+4]=V,this.int16[ne+5]=K,s}}lt.prototype.bytesPerElement=12,Vn("StructArrayLayout2i2i2i12",lt);class Rt extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F){const V=this.length;return this.resize(V+1),this.emplace(V,s,d,k,I,F)}emplace(s,d,k,I,F,V){const K=4*s,ne=8*s;return this.float32[K+0]=d,this.float32[K+1]=k,this.float32[K+2]=I,this.int16[ne+6]=F,this.int16[ne+7]=V,s}}Rt.prototype.bytesPerElement=16,Vn("StructArrayLayout2f1f2i16",Rt);class Nt extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V){const K=this.length;return this.resize(K+1),this.emplace(K,s,d,k,I,F,V)}emplace(s,d,k,I,F,V,K){const ne=16*s,ue=4*s,xe=8*s;return this.uint8[ne+0]=d,this.uint8[ne+1]=k,this.float32[ue+1]=I,this.float32[ue+2]=F,this.int16[xe+6]=V,this.int16[xe+7]=K,s}}Nt.prototype.bytesPerElement=16,Vn("StructArrayLayout2ub2f2i16",Nt);class zt extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,k){const I=this.length;return this.resize(I+1),this.emplace(I,s,d,k)}emplace(s,d,k,I){const F=3*s;return this.uint16[F+0]=d,this.uint16[F+1]=k,this.uint16[F+2]=I,s}}zt.prototype.bytesPerElement=6,Vn("StructArrayLayout3ui6",zt);class sn extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke,Ze,ct,mt){const Bt=this.length;return this.resize(Bt+1),this.emplace(Bt,s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke,Ze,ct,mt)}emplace(s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke,Ze,ct,mt,Bt){const Pt=24*s,$t=12*s,Gt=48*s;return this.int16[Pt+0]=d,this.int16[Pt+1]=k,this.uint16[Pt+2]=I,this.uint16[Pt+3]=F,this.uint32[$t+2]=V,this.uint32[$t+3]=K,this.uint32[$t+4]=ne,this.uint16[Pt+10]=ue,this.uint16[Pt+11]=xe,this.uint16[Pt+12]=Te,this.float32[$t+7]=Ne,this.float32[$t+8]=Ue,this.uint8[Gt+36]=Ke,this.uint8[Gt+37]=Ze,this.uint8[Gt+38]=ct,this.uint32[$t+10]=mt,this.int16[Pt+22]=Bt,s}}sn.prototype.bytesPerElement=48,Vn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",sn);class gn extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke,Ze,ct,mt,Bt,Pt,$t,Gt,dn,$n,_r,Rn,Tn,rr,Hn){const Un=this.length;return this.resize(Un+1),this.emplace(Un,s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke,Ze,ct,mt,Bt,Pt,$t,Gt,dn,$n,_r,Rn,Tn,rr,Hn)}emplace(s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke,Ze,ct,mt,Bt,Pt,$t,Gt,dn,$n,_r,Rn,Tn,rr,Hn,Un){const Qt=32*s,ar=16*s;return this.int16[Qt+0]=d,this.int16[Qt+1]=k,this.int16[Qt+2]=I,this.int16[Qt+3]=F,this.int16[Qt+4]=V,this.int16[Qt+5]=K,this.int16[Qt+6]=ne,this.int16[Qt+7]=ue,this.uint16[Qt+8]=xe,this.uint16[Qt+9]=Te,this.uint16[Qt+10]=Ne,this.uint16[Qt+11]=Ue,this.uint16[Qt+12]=Ke,this.uint16[Qt+13]=Ze,this.uint16[Qt+14]=ct,this.uint16[Qt+15]=mt,this.uint16[Qt+16]=Bt,this.uint16[Qt+17]=Pt,this.uint16[Qt+18]=$t,this.uint16[Qt+19]=Gt,this.uint16[Qt+20]=dn,this.uint16[Qt+21]=$n,this.uint16[Qt+22]=_r,this.uint32[ar+12]=Rn,this.float32[ar+13]=Tn,this.float32[ar+14]=rr,this.uint16[Qt+30]=Hn,this.uint16[Qt+31]=Un,s}}gn.prototype.bytesPerElement=64,Vn("StructArrayLayout8i15ui1ul2f2ui64",gn);class Cn extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.float32[1*s+0]=d,s}}Cn.prototype.bytesPerElement=4,Vn("StructArrayLayout1f4",Cn);class Fn extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,k){const I=this.length;return this.resize(I+1),this.emplace(I,s,d,k)}emplace(s,d,k,I){const F=3*s;return this.uint16[6*s+0]=d,this.float32[F+1]=k,this.float32[F+2]=I,s}}Fn.prototype.bytesPerElement=12,Vn("StructArrayLayout1ui2f12",Fn);class En extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,k){const I=this.length;return this.resize(I+1),this.emplace(I,s,d,k)}emplace(s,d,k,I){const F=4*s;return this.uint32[2*s+0]=d,this.uint16[F+2]=k,this.uint16[F+3]=I,s}}En.prototype.bytesPerElement=8,Vn("StructArrayLayout1ul2ui8",En);class Sn extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d){const k=this.length;return this.resize(k+1),this.emplace(k,s,d)}emplace(s,d,k){const I=2*s;return this.uint16[I+0]=d,this.uint16[I+1]=k,s}}Sn.prototype.bytesPerElement=4,Vn("StructArrayLayout2ui4",Sn);class Jn extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.uint16[1*s+0]=d,s}}Jn.prototype.bytesPerElement=2,Vn("StructArrayLayout1ui2",Jn);class Nr extends j{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,k,I){const F=this.length;return this.resize(F+1),this.emplace(F,s,d,k,I)}emplace(s,d,k,I,F){const V=4*s;return this.float32[V+0]=d,this.float32[V+1]=k,this.float32[V+2]=I,this.float32[V+3]=F,s}}Nr.prototype.bytesPerElement=16,Vn("StructArrayLayout4f16",Nr);class An extends C{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new g(this.anchorPointX,this.anchorPointY)}}An.prototype.size=20;class Nn extends kt{get(s){return new An(this,s)}}Vn("CollisionBoxArray",Nn);class Rr extends C{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Rr.prototype.size=48;class Ni extends sn{get(s){return new Rr(this,s)}}Vn("PlacedSymbolArray",Ni);class Gr extends C{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Gr.prototype.size=64;class ti extends gn{get(s){return new Gr(this,s)}}Vn("SymbolInstanceArray",ti);class $i extends Cn{getoffsetX(s){return this.float32[1*s+0]}}Vn("GlyphOffsetArray",$i);class ss extends Se{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}Vn("SymbolLineVertexArray",ss);class Ga extends C{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ga.prototype.size=12;class Bi extends Fn{get(s){return new Ga(this,s)}}Vn("TextAnchorOffsetArray",Bi);class Vs extends C{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Vs.prototype.size=8;class ks extends En{get(s){return new Vs(this,s)}}Vn("FeatureIndexArray",ks);class as extends ce{}class Ps extends ce{}class Pl extends ce{}class Bh extends Ce{}class Fm extends He{}class Fh extends Ye{}class ka extends tt{}class zm extends ht{}class Z0 extends yt{}class Pa extends vt{}class Ta extends lt{}class Ic extends Nt{}class Ka extends zt{}class Ko extends Sn{}const ls=J([{name:"a_pos",components:2,type:"Int16"}],4),{members:ua}=ls;class ri{constructor(s=[]){this.segments=s}prepareSegment(s,d,k,I){let F=this.segments[this.segments.length-1];return s>ri.MAX_VERTEX_ARRAY_LENGTH&&Q(`Max vertices per segment is ${ri.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!F||F.vertexLength+s>ri.MAX_VERTEX_ARRAY_LENGTH||F.sortKey!==I)&&(F={vertexOffset:d.length,primitiveOffset:k.length,vertexLength:0,primitiveLength:0},I!==void 0&&(F.sortKey=I),this.segments.push(F)),F}get(){return this.segments}destroy(){for(const s of this.segments)for(const d in s.vaos)s.vaos[d].destroy()}static simpleSegment(s,d,k,I){return new ri([{vertexOffset:s,primitiveOffset:d,vertexLength:k,primitiveLength:I,vaos:{},sortKey:0}])}}function ku(u,s){return 256*(u=P(Math.floor(u),0,255))+P(Math.floor(s),0,255)}ri.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Vn("SegmentVector",ri);const zh=J([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Uh={exports:{}},fw={exports:{}};fw.exports=function(u,s){var d,k,I,F,V,K,ne,ue;for(k=u.length-(d=3&u.length),I=s,V=3432918353,K=461845907,ue=0;ue<k;)ne=255&u.charCodeAt(ue)|(255&u.charCodeAt(++ue))<<8|(255&u.charCodeAt(++ue))<<16|(255&u.charCodeAt(++ue))<<24,++ue,I=27492+(65535&(F=5*(65535&(I=(I^=ne=(65535&(ne=(ne=(65535&ne)*V+(((ne>>>16)*V&65535)<<16)&4294967295)<<15|ne>>>17))*K+(((ne>>>16)*K&65535)<<16)&4294967295)<<13|I>>>19))+((5*(I>>>16)&65535)<<16)&4294967295))+((58964+(F>>>16)&65535)<<16);switch(ne=0,d){case 3:ne^=(255&u.charCodeAt(ue+2))<<16;case 2:ne^=(255&u.charCodeAt(ue+1))<<8;case 1:I^=ne=(65535&(ne=(ne=(65535&(ne^=255&u.charCodeAt(ue)))*V+(((ne>>>16)*V&65535)<<16)&4294967295)<<15|ne>>>17))*K+(((ne>>>16)*K&65535)<<16)&4294967295}return I^=u.length,I=2246822507*(65535&(I^=I>>>16))+((2246822507*(I>>>16)&65535)<<16)&4294967295,I=3266489909*(65535&(I^=I>>>13))+((3266489909*(I>>>16)&65535)<<16)&4294967295,(I^=I>>>16)>>>0};var y3=fw.exports,dw={exports:{}};dw.exports=function(u,s){for(var d,k=u.length,I=s^k,F=0;k>=4;)d=1540483477*(65535&(d=255&u.charCodeAt(F)|(255&u.charCodeAt(++F))<<8|(255&u.charCodeAt(++F))<<16|(255&u.charCodeAt(++F))<<24))+((1540483477*(d>>>16)&65535)<<16),I=1540483477*(65535&I)+((1540483477*(I>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),k-=4,++F;switch(k){case 3:I^=(255&u.charCodeAt(F+2))<<16;case 2:I^=(255&u.charCodeAt(F+1))<<8;case 1:I=1540483477*(65535&(I^=255&u.charCodeAt(F)))+((1540483477*(I>>>16)&65535)<<16)}return I=1540483477*(65535&(I^=I>>>13))+((1540483477*(I>>>16)&65535)<<16),(I^=I>>>15)>>>0};var Rc=y3,pw=dw.exports;Uh.exports=Rc,Uh.exports.murmur3=Rc,Uh.exports.murmur2=pw;var Um=h(Uh.exports);class Ad{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,d,k,I){this.ids.push(Vm(s)),this.positions.push(d,k,I)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const d=Vm(s);let k=0,I=this.ids.length-1;for(;k<I;){const V=k+I>>1;this.ids[V]>=d?I=V:k=V+1}const F=[];for(;this.ids[k]===d;)F.push({index:this.positions[3*k],start:this.positions[3*k+1],end:this.positions[3*k+2]}),k++;return F}static serialize(s,d){const k=new Float64Array(s.ids),I=new Uint32Array(s.positions);return qm(k,I,0,k.length-1),d&&d.push(k.buffer,I.buffer),{ids:k,positions:I}}static deserialize(s){const d=new Ad;return d.ids=s.ids,d.positions=s.positions,d.indexed=!0,d}}function Vm(u){const s=+u;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:Um(String(u))}function qm(u,s,d,k){for(;d<k;){const I=u[d+k>>1];let F=d-1,V=k+1;for(;;){do F++;while(u[F]<I);do V--;while(u[V]>I);if(F>=V)break;Vh(u,F,V),Vh(s,3*F,3*V),Vh(s,3*F+1,3*V+1),Vh(s,3*F+2,3*V+2)}V-d<k-V?(qm(u,s,d,V),d=V+1):(qm(u,s,V+1,k),k=V)}}function Vh(u,s,d){const k=u[s];u[s]=u[d],u[d]=k}Vn("FeaturePositionMap",Ad);class kd{constructor(s,d){this.gl=s.gl,this.location=d}}class mw extends kd{constructor(s,d){super(s,d),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class sk extends kd{constructor(s,d){super(s,d),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class ak extends kd{constructor(s,d){super(s,d),this.current=mn.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const J9=new Float32Array(16);function b3(u){return[ku(255*u.r,255*u.g),ku(255*u.b,255*u.a)]}class Y0{constructor(s,d,k){this.value=s,this.uniformNames=d.map(I=>`u_${I}`),this.type=k}setUniform(s,d,k){s.set(k.constantOr(this.value))}getBinding(s,d,k){return this.type==="color"?new ak(s,d):new mw(s,d)}}class Hm{constructor(s,d){this.uniformNames=d.map(k=>`u_${k}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=s.tlbr}setUniform(s,d,k,I){const F=I==="u_pattern_to"?this.patternTo:I==="u_pattern_from"?this.patternFrom:I==="u_pixel_ratio_to"?this.pixelRatioTo:I==="u_pixel_ratio_from"?this.pixelRatioFrom:null;F&&s.set(F)}getBinding(s,d,k){return k.substr(0,9)==="u_pattern"?new sk(s,d):new mw(s,d)}}class Pu{constructor(s,d,k,I){this.expression=s,this.type=k,this.maxValue=0,this.paintVertexAttributes=d.map(F=>({name:`a_${F}`,type:"Float32",components:k==="color"?2:1,offset:0})),this.paintVertexArray=new I}populatePaintArray(s,d,k,I,F){const V=this.paintVertexArray.length,K=this.expression.evaluate(new ji(0),d,{},I,[],F);this.paintVertexArray.resize(s),this._setPaintValue(V,s,K)}updatePaintArray(s,d,k,I){const F=this.expression.evaluate({zoom:0},k,I);this._setPaintValue(s,d,F)}_setPaintValue(s,d,k){if(this.type==="color"){const I=b3(k);for(let F=s;F<d;F++)this.paintVertexArray.emplace(F,I[0],I[1])}else{for(let I=s;I<d;I++)this.paintVertexArray.emplace(I,k);this.maxValue=Math.max(this.maxValue,Math.abs(k))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Jl{constructor(s,d,k,I,F,V){this.expression=s,this.uniformNames=d.map(K=>`u_${K}_t`),this.type=k,this.useIntegerZoom=I,this.zoom=F,this.maxValue=0,this.paintVertexAttributes=d.map(K=>({name:`a_${K}`,type:"Float32",components:k==="color"?4:2,offset:0})),this.paintVertexArray=new V}populatePaintArray(s,d,k,I,F){const V=this.expression.evaluate(new ji(this.zoom),d,{},I,[],F),K=this.expression.evaluate(new ji(this.zoom+1),d,{},I,[],F),ne=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(ne,s,V,K)}updatePaintArray(s,d,k,I){const F=this.expression.evaluate({zoom:this.zoom},k,I),V=this.expression.evaluate({zoom:this.zoom+1},k,I);this._setPaintValue(s,d,F,V)}_setPaintValue(s,d,k,I){if(this.type==="color"){const F=b3(k),V=b3(I);for(let K=s;K<d;K++)this.paintVertexArray.emplace(K,F[0],F[1],V[0],V[1])}else{for(let F=s;F<d;F++)this.paintVertexArray.emplace(F,k,I);this.maxValue=Math.max(this.maxValue,Math.abs(k),Math.abs(I))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,d){const k=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,I=P(this.expression.interpolationFactor(k,this.zoom,this.zoom+1),0,1);s.set(I)}getBinding(s,d,k){return new mw(s,d)}}class qh{constructor(s,d,k,I,F,V){this.expression=s,this.type=d,this.useIntegerZoom=k,this.zoom=I,this.layerId=V,this.zoomInPaintVertexArray=new F,this.zoomOutPaintVertexArray=new F}populatePaintArray(s,d,k){const I=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(I,s,d.patterns&&d.patterns[this.layerId],k)}updatePaintArray(s,d,k,I,F){this._setPaintValues(s,d,k.patterns&&k.patterns[this.layerId],F)}_setPaintValues(s,d,k,I){if(!I||!k)return;const{min:F,mid:V,max:K}=k,ne=I[F],ue=I[V],xe=I[K];if(ne&&ue&&xe)for(let Te=s;Te<d;Te++)this.zoomInPaintVertexArray.emplace(Te,ue.tl[0],ue.tl[1],ue.br[0],ue.br[1],ne.tl[0],ne.tl[1],ne.br[0],ne.br[1],ue.pixelRatio,ne.pixelRatio),this.zoomOutPaintVertexArray.emplace(Te,ue.tl[0],ue.tl[1],ue.br[0],ue.br[1],xe.tl[0],xe.tl[1],xe.br[0],xe.br[1],ue.pixelRatio,xe.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,zh.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,zh.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class lk{constructor(s,d,k){this.binders={},this._buffers=[];const I=[];for(const F in s.paint._values){if(!k(F))continue;const V=s.paint.get(F);if(!(V instanceof kl&&Tc(V.property.specification)))continue;const K=Q9(F,s.type),ne=V.value,ue=V.property.specification.type,xe=V.property.useIntegerZoom,Te=V.property.specification["property-type"],Ne=Te==="cross-faded"||Te==="cross-faded-data-driven";if(ne.kind==="constant")this.binders[F]=Ne?new Hm(ne.value,K):new Y0(ne.value,K,ue),I.push(`/u_${F}`);else if(ne.kind==="source"||Ne){const Ue=ck(F,ue,"source");this.binders[F]=Ne?new qh(ne,ue,xe,d,Ue,s.id):new Pu(ne,K,ue,Ue),I.push(`/a_${F}`)}else{const Ue=ck(F,ue,"composite");this.binders[F]=new Jl(ne,K,ue,xe,d,Ue),I.push(`/z_${F}`)}}this.cacheKey=I.sort().join("")}getMaxValue(s){const d=this.binders[s];return d instanceof Pu||d instanceof Jl?d.maxValue:0}populatePaintArrays(s,d,k,I,F){for(const V in this.binders){const K=this.binders[V];(K instanceof Pu||K instanceof Jl||K instanceof qh)&&K.populatePaintArray(s,d,k,I,F)}}setConstantPatternPositions(s,d){for(const k in this.binders){const I=this.binders[k];I instanceof Hm&&I.setConstantPatternPositions(s,d)}}updatePaintArrays(s,d,k,I,F){let V=!1;for(const K in s){const ne=d.getPositions(K);for(const ue of ne){const xe=k.feature(ue.index);for(const Te in this.binders){const Ne=this.binders[Te];if((Ne instanceof Pu||Ne instanceof Jl||Ne instanceof qh)&&Ne.expression.isStateDependent===!0){const Ue=I.paint.get(Te);Ne.expression=Ue.value,Ne.updatePaintArray(ue.start,ue.end,xe,s[K],F),V=!0}}}}return V}defines(){const s=[];for(const d in this.binders){const k=this.binders[d];(k instanceof Y0||k instanceof Hm)&&s.push(...k.uniformNames.map(I=>`#define HAS_UNIFORM_${I}`))}return s}getBinderAttributes(){const s=[];for(const d in this.binders){const k=this.binders[d];if(k instanceof Pu||k instanceof Jl)for(let I=0;I<k.paintVertexAttributes.length;I++)s.push(k.paintVertexAttributes[I].name);else if(k instanceof qh)for(let I=0;I<zh.members.length;I++)s.push(zh.members[I].name)}return s}getBinderUniforms(){const s=[];for(const d in this.binders){const k=this.binders[d];if(k instanceof Y0||k instanceof Hm||k instanceof Jl)for(const I of k.uniformNames)s.push(I)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,d){const k=[];for(const I in this.binders){const F=this.binders[I];if(F instanceof Y0||F instanceof Hm||F instanceof Jl){for(const V of F.uniformNames)if(d[V]){const K=F.getBinding(s,d[V],V);k.push({name:V,property:I,binding:K})}}}return k}setUniforms(s,d,k,I){for(const{name:F,property:V,binding:K}of d)this.binders[V].setUniform(K,I,k.get(V),F)}updatePaintBuffers(s){this._buffers=[];for(const d in this.binders){const k=this.binders[d];if(s&&k instanceof qh){const I=s.fromScale===2?k.zoomInPaintVertexBuffer:k.zoomOutPaintVertexBuffer;I&&this._buffers.push(I)}else(k instanceof Pu||k instanceof Jl)&&k.paintVertexBuffer&&this._buffers.push(k.paintVertexBuffer)}}upload(s){for(const d in this.binders){const k=this.binders[d];(k instanceof Pu||k instanceof Jl||k instanceof qh)&&k.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const d=this.binders[s];(d instanceof Pu||d instanceof Jl||d instanceof qh)&&d.destroy()}}}class Pd{constructor(s,d,k=()=>!0){this.programConfigurations={};for(const I of s)this.programConfigurations[I.id]=new lk(I,d,k);this.needsUpload=!1,this._featureMap=new Ad,this._bufferOffset=0}populatePaintArrays(s,d,k,I,F,V){for(const K in this.programConfigurations)this.programConfigurations[K].populatePaintArrays(s,d,I,F,V);d.id!==void 0&&this._featureMap.add(d.id,k,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,d,k,I){for(const F of k)this.needsUpload=this.programConfigurations[F.id].updatePaintArrays(s,this._featureMap,d,F,I)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function Q9(u,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${s}-`,"").replace(/-/g,"_")]}function ck(u,s,d){const k={color:{source:Ye,composite:Nr},number:{source:Cn,composite:Ye}},I=function(F){return{"line-pattern":{source:ka,composite:ka},"fill-pattern":{source:ka,composite:ka},"fill-extrusion-pattern":{source:ka,composite:ka}}[F]}(u);return I&&I[d]||k[s][d]}Vn("ConstantBinder",Y0),Vn("CrossFadedConstantBinder",Hm),Vn("SourceExpressionBinder",Pu),Vn("CrossFadedCompositeBinder",qh),Vn("CompositeExpressionBinder",Jl),Vn("ProgramConfiguration",lk,{omit:["_buffers"]}),Vn("ProgramConfigurationSet",Pd);const vo=8192,v3=Math.pow(2,14)-1,uk=-v3-1;function Td(u){const s=vo/u.extent,d=u.loadGeometry();for(let k=0;k<d.length;k++){const I=d[k];for(let F=0;F<I.length;F++){const V=I[F],K=Math.round(V.x*s),ne=Math.round(V.y*s);V.x=P(K,uk,v3),V.y=P(ne,uk,v3),(K<V.x||K>V.x+1||ne<V.y||ne>V.y+1)&&Q("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return d}function Od(u,s){return{type:u.type,id:u.id,properties:u.properties,geometry:s?Td(u):[]}}function gw(u,s,d,k,I){u.emplaceBack(2*s+(k+1)/2,2*d+(I+1)/2)}class _3{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Ps,this.indexArray=new Ka,this.segments=new ri,this.programConfigurations=new Pd(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(s,d,k){const I=this.layers[0],F=[];let V=null,K=!1;I.type==="circle"&&(V=I.layout.get("circle-sort-key"),K=!V.isConstant());for(const{feature:ne,id:ue,index:xe,sourceLayerIndex:Te}of s){const Ne=this.layers[0]._featureFilter.needGeometry,Ue=Od(ne,Ne);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),Ue,k))continue;const Ke=K?V.evaluate(Ue,{},k):void 0,Ze={id:ue,properties:ne.properties,type:ne.type,sourceLayerIndex:Te,index:xe,geometry:Ne?Ue.geometry:Td(ne),patterns:{},sortKey:Ke};F.push(Ze)}K&&F.sort((ne,ue)=>ne.sortKey-ue.sortKey);for(const ne of F){const{geometry:ue,index:xe,sourceLayerIndex:Te}=ne,Ne=s[xe].feature;this.addFeature(ne,ue,xe,k),d.featureIndex.insert(Ne,ue,xe,Te,this.index)}}update(s,d,k){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,d,this.stateDependentLayers,k)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ua),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,d,k,I){for(const F of d)for(const V of F){const K=V.x,ne=V.y;if(K<0||K>=vo||ne<0||ne>=vo)continue;const ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),xe=ue.vertexLength;gw(this.layoutVertexArray,K,ne,-1,-1),gw(this.layoutVertexArray,K,ne,1,-1),gw(this.layoutVertexArray,K,ne,1,1),gw(this.layoutVertexArray,K,ne,-1,1),this.indexArray.emplaceBack(xe,xe+1,xe+2),this.indexArray.emplaceBack(xe,xe+3,xe+2),ue.vertexLength+=4,ue.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,k,{},I)}}function hk(u,s){for(let d=0;d<u.length;d++)if(Wm(s,u[d]))return!0;for(let d=0;d<s.length;d++)if(Wm(u,s[d]))return!0;return!!w3(u,s)}function eD(u,s,d){return!!Wm(u,s)||!!x3(s,u,d)}function fk(u,s){if(u.length===1)return pk(s,u[0]);for(let d=0;d<s.length;d++){const k=s[d];for(let I=0;I<k.length;I++)if(Wm(u,k[I]))return!0}for(let d=0;d<u.length;d++)if(pk(s,u[d]))return!0;for(let d=0;d<s.length;d++)if(w3(u,s[d]))return!0;return!1}function tD(u,s,d){if(u.length>1){if(w3(u,s))return!0;for(let k=0;k<s.length;k++)if(x3(s[k],u,d))return!0}for(let k=0;k<u.length;k++)if(x3(u[k],s,d))return!0;return!1}function w3(u,s){if(u.length===0||s.length===0)return!1;for(let d=0;d<u.length-1;d++){const k=u[d],I=u[d+1];for(let F=0;F<s.length-1;F++)if(nD(k,I,s[F],s[F+1]))return!0}return!1}function nD(u,s,d,k){return oe(u,d,k)!==oe(s,d,k)&&oe(u,s,d)!==oe(u,s,k)}function x3(u,s,d){const k=d*d;if(s.length===1)return u.distSqr(s[0])<k;for(let I=1;I<s.length;I++)if(dk(u,s[I-1],s[I])<k)return!0;return!1}function dk(u,s,d){const k=s.distSqr(d);if(k===0)return u.distSqr(s);const I=((u.x-s.x)*(d.x-s.x)+(u.y-s.y)*(d.y-s.y))/k;return u.distSqr(I<0?s:I>1?d:d.sub(s)._mult(I)._add(s))}function pk(u,s){let d,k,I,F=!1;for(let V=0;V<u.length;V++){d=u[V];for(let K=0,ne=d.length-1;K<d.length;ne=K++)k=d[K],I=d[ne],k.y>s.y!=I.y>s.y&&s.x<(I.x-k.x)*(s.y-k.y)/(I.y-k.y)+k.x&&(F=!F)}return F}function Wm(u,s){let d=!1;for(let k=0,I=u.length-1;k<u.length;I=k++){const F=u[k],V=u[I];F.y>s.y!=V.y>s.y&&s.x<(V.x-F.x)*(s.y-F.y)/(V.y-F.y)+F.x&&(d=!d)}return d}function rD(u,s,d){const k=d[0],I=d[2];if(u.x<k.x&&s.x<k.x||u.x>I.x&&s.x>I.x||u.y<k.y&&s.y<k.y||u.y>I.y&&s.y>I.y)return!1;const F=oe(u,s,d[0]);return F!==oe(u,s,d[1])||F!==oe(u,s,d[2])||F!==oe(u,s,d[3])}function J0(u,s,d){const k=s.paint.get(u).value;return k.kind==="constant"?k.value:d.programConfigurations.get(s.id).getMaxValue(u)}function yw(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function bw(u,s,d,k,I){if(!s[0]&&!s[1])return u;const F=g.convert(s)._mult(I);d==="viewport"&&F._rotate(-k);const V=[];for(let K=0;K<u.length;K++)V.push(u[K].sub(F));return V}let mk,gk;Vn("CircleBucket",_3,{omit:["layers"]});var iD={get paint(){return gk=gk||new $({"circle-radius":new Sr(te.paint_circle["circle-radius"]),"circle-color":new Sr(te.paint_circle["circle-color"]),"circle-blur":new Sr(te.paint_circle["circle-blur"]),"circle-opacity":new Sr(te.paint_circle["circle-opacity"]),"circle-translate":new Yn(te.paint_circle["circle-translate"]),"circle-translate-anchor":new Yn(te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Yn(te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Yn(te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Sr(te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Sr(te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Sr(te.paint_circle["circle-stroke-opacity"])})},get layout(){return mk=mk||new $({"circle-sort-key":new Sr(te.layout_circle["circle-sort-key"])})}},qs=1e-6,Gm=typeof Float32Array<"u"?Float32Array:Array;function S3(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function yk(u,s,d){var k=s[0],I=s[1],F=s[2],V=s[3],K=s[4],ne=s[5],ue=s[6],xe=s[7],Te=s[8],Ne=s[9],Ue=s[10],Ke=s[11],Ze=s[12],ct=s[13],mt=s[14],Bt=s[15],Pt=d[0],$t=d[1],Gt=d[2],dn=d[3];return u[0]=Pt*k+$t*K+Gt*Te+dn*Ze,u[1]=Pt*I+$t*ne+Gt*Ne+dn*ct,u[2]=Pt*F+$t*ue+Gt*Ue+dn*mt,u[3]=Pt*V+$t*xe+Gt*Ke+dn*Bt,u[4]=(Pt=d[4])*k+($t=d[5])*K+(Gt=d[6])*Te+(dn=d[7])*Ze,u[5]=Pt*I+$t*ne+Gt*Ne+dn*ct,u[6]=Pt*F+$t*ue+Gt*Ue+dn*mt,u[7]=Pt*V+$t*xe+Gt*Ke+dn*Bt,u[8]=(Pt=d[8])*k+($t=d[9])*K+(Gt=d[10])*Te+(dn=d[11])*Ze,u[9]=Pt*I+$t*ne+Gt*Ne+dn*ct,u[10]=Pt*F+$t*ue+Gt*Ue+dn*mt,u[11]=Pt*V+$t*xe+Gt*Ke+dn*Bt,u[12]=(Pt=d[12])*k+($t=d[13])*K+(Gt=d[14])*Te+(dn=d[15])*Ze,u[13]=Pt*I+$t*ne+Gt*Ne+dn*ct,u[14]=Pt*F+$t*ue+Gt*Ue+dn*mt,u[15]=Pt*V+$t*xe+Gt*Ke+dn*Bt,u}Math.hypot||(Math.hypot=function(){for(var u=0,s=arguments.length;s--;)u+=arguments[s]*arguments[s];return Math.sqrt(u)});var Q0,oD=yk;function vw(u,s,d){var k=s[0],I=s[1],F=s[2],V=s[3];return u[0]=d[0]*k+d[4]*I+d[8]*F+d[12]*V,u[1]=d[1]*k+d[5]*I+d[9]*F+d[13]*V,u[2]=d[2]*k+d[6]*I+d[10]*F+d[14]*V,u[3]=d[3]*k+d[7]*I+d[11]*F+d[15]*V,u}Q0=new Gm(4),Gm!=Float32Array&&(Q0[0]=0,Q0[1]=0,Q0[2]=0,Q0[3]=0);class sD extends S{constructor(s){super(s,iD)}createBucket(s){return new _3(s)}queryRadius(s){const d=s;return J0("circle-radius",this,d)+J0("circle-stroke-width",this,d)+yw(this.paint.get("circle-translate"))}queryIntersectsFeature(s,d,k,I,F,V,K,ne){const ue=bw(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),V.angle,K),xe=this.paint.get("circle-radius").evaluate(d,k)+this.paint.get("circle-stroke-width").evaluate(d,k),Te=this.paint.get("circle-pitch-alignment")==="map",Ne=Te?ue:function(Ke,Ze){return Ke.map(ct=>bk(ct,Ze))}(ue,ne),Ue=Te?xe*K:xe;for(const Ke of I)for(const Ze of Ke){const ct=Te?Ze:bk(Ze,ne);let mt=Ue;const Bt=vw([],[Ze.x,Ze.y,0,1],ne);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?mt*=Bt[3]/V.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(mt*=V.cameraToCenterDistance/Bt[3]),eD(Ne,ct,mt))return!0}return!1}}function bk(u,s){const d=vw([],[u.x,u.y,0,1],s);return new g(d[0]/d[3],d[1]/d[3])}class vk extends _3{}let _k;Vn("HeatmapBucket",vk,{omit:["layers"]});var aD={get paint(){return _k=_k||new $({"heatmap-radius":new Sr(te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Sr(te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Yn(te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new X0(te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Yn(te.paint_heatmap["heatmap-opacity"])})}};function E3(u,{width:s,height:d},k,I){if(I){if(I instanceof Uint8ClampedArray)I=new Uint8Array(I.buffer);else if(I.length!==s*d*k)throw new RangeError(`mismatched image size. expected: ${I.length} but got: ${s*d*k}`)}else I=new Uint8Array(s*d*k);return u.width=s,u.height=d,u.data=I,u}function wk(u,{width:s,height:d},k){if(s===u.width&&d===u.height)return;const I=E3({},{width:s,height:d},k);A3(u,I,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,s),height:Math.min(u.height,d)},k),u.width=s,u.height=d,u.data=I.data}function A3(u,s,d,k,I,F){if(I.width===0||I.height===0)return s;if(I.width>u.width||I.height>u.height||d.x>u.width-I.width||d.y>u.height-I.height)throw new RangeError("out of range source coordinates for image copy");if(I.width>s.width||I.height>s.height||k.x>s.width-I.width||k.y>s.height-I.height)throw new RangeError("out of range destination coordinates for image copy");const V=u.data,K=s.data;if(V===K)throw new Error("srcData equals dstData, so image is already copied");for(let ne=0;ne<I.height;ne++){const ue=((d.y+ne)*u.width+d.x)*F,xe=((k.y+ne)*s.width+k.x)*F;for(let Te=0;Te<I.width*F;Te++)K[xe+Te]=V[ue+Te]}return s}class eb{constructor(s,d){E3(this,s,1,d)}resize(s){wk(this,s,1)}clone(){return new eb({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,d,k,I,F){A3(s,d,k,I,F,1)}}class Xa{constructor(s,d){E3(this,s,4,d)}resize(s){wk(this,s,4)}replace(s,d){d?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Xa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,d,k,I,F){A3(s,d,k,I,F,4)}}function xk(u){const s={},d=u.resolution||256,k=u.clips?u.clips.length:1,I=u.image||new Xa({width:d,height:k});if(Math.log(d)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${d}`);const F=(V,K,ne)=>{s[u.evaluationKey]=ne;const ue=u.expression.evaluate(s);I.data[V+K+0]=Math.floor(255*ue.r/ue.a),I.data[V+K+1]=Math.floor(255*ue.g/ue.a),I.data[V+K+2]=Math.floor(255*ue.b/ue.a),I.data[V+K+3]=Math.floor(255*ue.a)};if(u.clips)for(let V=0,K=0;V<k;++V,K+=4*d)for(let ne=0,ue=0;ne<d;ne++,ue+=4){const xe=ne/(d-1),{start:Te,end:Ne}=u.clips[V];F(K,ue,Te*(1-xe)+Ne*xe)}else for(let V=0,K=0;V<d;V++,K+=4)F(0,K,V/(d-1));return I}Vn("AlphaImage",eb),Vn("RGBAImage",Xa);const k3="big-fb";class lD extends S{createBucket(s){return new vk(s)}constructor(s){super(s,aD),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xk({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(k3)&&this.heatmapFbos.delete(k3)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Sk;var cD={get paint(){return Sk=Sk||new $({"hillshade-illumination-direction":new Yn(te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Yn(te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Yn(te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Yn(te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Yn(te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Yn(te.paint_hillshade["hillshade-accent-color"])})}};class uD extends S{constructor(s){super(s,cD)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const hD=J([{name:"a_pos",components:2,type:"Int16"}],4),{members:fD}=hD;function Ek(u,s,d=2){const k=s&&s.length,I=k?s[0]*d:u.length;let F=Ak(u,0,I,d,!0);const V=[];if(!F||F.next===F.prev)return V;let K,ne,ue;if(k&&(F=function(xe,Te,Ne,Ue){const Ke=[];for(let Ze=0,ct=Te.length;Ze<ct;Ze++){const mt=Ak(xe,Te[Ze]*Ue,Ze<ct-1?Te[Ze+1]*Ue:xe.length,Ue,!1);mt===mt.next&&(mt.steiner=!0),Ke.push(_D(mt))}Ke.sort(yD);for(let Ze=0;Ze<Ke.length;Ze++)Ne=bD(Ke[Ze],Ne);return Ne}(u,s,F,d)),u.length>80*d){K=1/0,ne=1/0;let xe=-1/0,Te=-1/0;for(let Ne=d;Ne<I;Ne+=d){const Ue=u[Ne],Ke=u[Ne+1];Ue<K&&(K=Ue),Ke<ne&&(ne=Ke),Ue>xe&&(xe=Ue),Ke>Te&&(Te=Ke)}ue=Math.max(xe-K,Te-ne),ue=ue!==0?32767/ue:0}return tb(F,V,d,K,ne,ue,0),V}function Ak(u,s,d,k,I){let F;if(I===function(V,K,ne,ue){let xe=0;for(let Te=K,Ne=ne-ue;Te<ne;Te+=ue)xe+=(V[Ne]-V[Te])*(V[Te+1]+V[Ne+1]),Ne=Te;return xe}(u,s,d,k)>0)for(let V=s;V<d;V+=k)F=Tk(V/k|0,u[V],u[V+1],F);else for(let V=d-k;V>=s;V-=k)F=Tk(V/k|0,u[V],u[V+1],F);return F&&_w(F,F.next)&&(rb(F),F=F.next),F}function Md(u,s){if(!u)return u;s||(s=u);let d,k=u;do if(d=!1,k.steiner||!_w(k,k.next)&&ho(k.prev,k,k.next)!==0)k=k.next;else{if(rb(k),k=s=k.prev,k===k.next)break;d=!0}while(d||k!==s);return s}function tb(u,s,d,k,I,F,V){if(!u)return;!V&&F&&function(ne,ue,xe,Te){let Ne=ne;do Ne.z===0&&(Ne.z=P3(Ne.x,Ne.y,ue,xe,Te)),Ne.prevZ=Ne.prev,Ne.nextZ=Ne.next,Ne=Ne.next;while(Ne!==ne);Ne.prevZ.nextZ=null,Ne.prevZ=null,function(Ue){let Ke,Ze=1;do{let ct,mt=Ue;Ue=null;let Bt=null;for(Ke=0;mt;){Ke++;let Pt=mt,$t=0;for(let dn=0;dn<Ze&&($t++,Pt=Pt.nextZ,Pt);dn++);let Gt=Ze;for(;$t>0||Gt>0&&Pt;)$t!==0&&(Gt===0||!Pt||mt.z<=Pt.z)?(ct=mt,mt=mt.nextZ,$t--):(ct=Pt,Pt=Pt.nextZ,Gt--),Bt?Bt.nextZ=ct:Ue=ct,ct.prevZ=Bt,Bt=ct;mt=Pt}Bt.nextZ=null,Ze*=2}while(Ke>1)}(Ne)}(u,k,I,F);let K=u;for(;u.prev!==u.next;){const ne=u.prev,ue=u.next;if(F?pD(u,k,I,F):dD(u))s.push(ne.i,u.i,ue.i),rb(u),u=ue.next,K=ue.next;else if((u=ue)===K){V?V===1?tb(u=mD(Md(u),s),s,d,k,I,F,2):V===2&&gD(u,s,d,k,I,F):tb(Md(u),s,d,k,I,F,1);break}}}function dD(u){const s=u.prev,d=u,k=u.next;if(ho(s,d,k)>=0)return!1;const I=s.x,F=d.x,V=k.x,K=s.y,ne=d.y,ue=k.y,xe=I<F?I<V?I:V:F<V?F:V,Te=K<ne?K<ue?K:ue:ne<ue?ne:ue,Ne=I>F?I>V?I:V:F>V?F:V,Ue=K>ne?K>ue?K:ue:ne>ue?ne:ue;let Ke=k.next;for(;Ke!==s;){if(Ke.x>=xe&&Ke.x<=Ne&&Ke.y>=Te&&Ke.y<=Ue&&Km(I,K,F,ne,V,ue,Ke.x,Ke.y)&&ho(Ke.prev,Ke,Ke.next)>=0)return!1;Ke=Ke.next}return!0}function pD(u,s,d,k){const I=u.prev,F=u,V=u.next;if(ho(I,F,V)>=0)return!1;const K=I.x,ne=F.x,ue=V.x,xe=I.y,Te=F.y,Ne=V.y,Ue=K<ne?K<ue?K:ue:ne<ue?ne:ue,Ke=xe<Te?xe<Ne?xe:Ne:Te<Ne?Te:Ne,Ze=K>ne?K>ue?K:ue:ne>ue?ne:ue,ct=xe>Te?xe>Ne?xe:Ne:Te>Ne?Te:Ne,mt=P3(Ue,Ke,s,d,k),Bt=P3(Ze,ct,s,d,k);let Pt=u.prevZ,$t=u.nextZ;for(;Pt&&Pt.z>=mt&&$t&&$t.z<=Bt;){if(Pt.x>=Ue&&Pt.x<=Ze&&Pt.y>=Ke&&Pt.y<=ct&&Pt!==I&&Pt!==V&&Km(K,xe,ne,Te,ue,Ne,Pt.x,Pt.y)&&ho(Pt.prev,Pt,Pt.next)>=0||(Pt=Pt.prevZ,$t.x>=Ue&&$t.x<=Ze&&$t.y>=Ke&&$t.y<=ct&&$t!==I&&$t!==V&&Km(K,xe,ne,Te,ue,Ne,$t.x,$t.y)&&ho($t.prev,$t,$t.next)>=0))return!1;$t=$t.nextZ}for(;Pt&&Pt.z>=mt;){if(Pt.x>=Ue&&Pt.x<=Ze&&Pt.y>=Ke&&Pt.y<=ct&&Pt!==I&&Pt!==V&&Km(K,xe,ne,Te,ue,Ne,Pt.x,Pt.y)&&ho(Pt.prev,Pt,Pt.next)>=0)return!1;Pt=Pt.prevZ}for(;$t&&$t.z<=Bt;){if($t.x>=Ue&&$t.x<=Ze&&$t.y>=Ke&&$t.y<=ct&&$t!==I&&$t!==V&&Km(K,xe,ne,Te,ue,Ne,$t.x,$t.y)&&ho($t.prev,$t,$t.next)>=0)return!1;$t=$t.nextZ}return!0}function mD(u,s){let d=u;do{const k=d.prev,I=d.next.next;!_w(k,I)&&kk(k,d,d.next,I)&&nb(k,I)&&nb(I,k)&&(s.push(k.i,d.i,I.i),rb(d),rb(d.next),d=u=I),d=d.next}while(d!==u);return Md(d)}function gD(u,s,d,k,I,F){let V=u;do{let K=V.next.next;for(;K!==V.prev;){if(V.i!==K.i&&wD(V,K)){let ne=Pk(V,K);return V=Md(V,V.next),ne=Md(ne,ne.next),tb(V,s,d,k,I,F,0),void tb(ne,s,d,k,I,F,0)}K=K.next}V=V.next}while(V!==u)}function yD(u,s){return u.x-s.x}function bD(u,s){const d=function(I,F){let V=F;const K=I.x,ne=I.y;let ue,xe=-1/0;do{if(ne<=V.y&&ne>=V.next.y&&V.next.y!==V.y){const Ze=V.x+(ne-V.y)*(V.next.x-V.x)/(V.next.y-V.y);if(Ze<=K&&Ze>xe&&(xe=Ze,ue=V.x<V.next.x?V:V.next,Ze===K))return ue}V=V.next}while(V!==F);if(!ue)return null;const Te=ue,Ne=ue.x,Ue=ue.y;let Ke=1/0;V=ue;do{if(K>=V.x&&V.x>=Ne&&K!==V.x&&Km(ne<Ue?K:xe,ne,Ne,Ue,ne<Ue?xe:K,ne,V.x,V.y)){const Ze=Math.abs(ne-V.y)/(K-V.x);nb(V,I)&&(Ze<Ke||Ze===Ke&&(V.x>ue.x||V.x===ue.x&&vD(ue,V)))&&(ue=V,Ke=Ze)}V=V.next}while(V!==Te);return ue}(u,s);if(!d)return s;const k=Pk(d,u);return Md(k,k.next),Md(d,d.next)}function vD(u,s){return ho(u.prev,u,s.prev)<0&&ho(s.next,u,u.next)<0}function P3(u,s,d,k,I){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-d)*I|0)|u<<8))|u<<4))|u<<2))|u<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-k)*I|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function _D(u){let s=u,d=u;do(s.x<d.x||s.x===d.x&&s.y<d.y)&&(d=s),s=s.next;while(s!==u);return d}function Km(u,s,d,k,I,F,V,K){return(I-V)*(s-K)>=(u-V)*(F-K)&&(u-V)*(k-K)>=(d-V)*(s-K)&&(d-V)*(F-K)>=(I-V)*(k-K)}function wD(u,s){return u.next.i!==s.i&&u.prev.i!==s.i&&!function(d,k){let I=d;do{if(I.i!==d.i&&I.next.i!==d.i&&I.i!==k.i&&I.next.i!==k.i&&kk(I,I.next,d,k))return!0;I=I.next}while(I!==d);return!1}(u,s)&&(nb(u,s)&&nb(s,u)&&function(d,k){let I=d,F=!1;const V=(d.x+k.x)/2,K=(d.y+k.y)/2;do I.y>K!=I.next.y>K&&I.next.y!==I.y&&V<(I.next.x-I.x)*(K-I.y)/(I.next.y-I.y)+I.x&&(F=!F),I=I.next;while(I!==d);return F}(u,s)&&(ho(u.prev,u,s.prev)||ho(u,s.prev,s))||_w(u,s)&&ho(u.prev,u,u.next)>0&&ho(s.prev,s,s.next)>0)}function ho(u,s,d){return(s.y-u.y)*(d.x-s.x)-(s.x-u.x)*(d.y-s.y)}function _w(u,s){return u.x===s.x&&u.y===s.y}function kk(u,s,d,k){const I=xw(ho(u,s,d)),F=xw(ho(u,s,k)),V=xw(ho(d,k,u)),K=xw(ho(d,k,s));return I!==F&&V!==K||!(I!==0||!ww(u,d,s))||!(F!==0||!ww(u,k,s))||!(V!==0||!ww(d,u,k))||!(K!==0||!ww(d,s,k))}function ww(u,s,d){return s.x<=Math.max(u.x,d.x)&&s.x>=Math.min(u.x,d.x)&&s.y<=Math.max(u.y,d.y)&&s.y>=Math.min(u.y,d.y)}function xw(u){return u>0?1:u<0?-1:0}function nb(u,s){return ho(u.prev,u,u.next)<0?ho(u,s,u.next)>=0&&ho(u,u.prev,s)>=0:ho(u,s,u.prev)<0||ho(u,u.next,s)<0}function Pk(u,s){const d=T3(u.i,u.x,u.y),k=T3(s.i,s.x,s.y),I=u.next,F=s.prev;return u.next=s,s.prev=u,d.next=I,I.prev=d,k.next=d,d.prev=k,F.next=k,k.prev=F,k}function Tk(u,s,d,k){const I=T3(u,s,d);return k?(I.next=k.next,I.prev=k,k.next.prev=I,k.next=I):(I.prev=I,I.next=I),I}function rb(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function T3(u,s,d){return{i:u,x:s,y:d,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function O3(u,s,d){const k=d.patternDependencies;let I=!1;for(const F of s){const V=F.paint.get(`${u}-pattern`);V.isConstant()||(I=!0);const K=V.constantOr(null);K&&(I=!0,k[K.to]=!0,k[K.from]=!0)}return I}function M3(u,s,d,k,I){const F=I.patternDependencies;for(const V of s){const K=V.paint.get(`${u}-pattern`).value;if(K.kind!=="constant"){let ne=K.evaluate({zoom:k-1},d,{},I.availableImages),ue=K.evaluate({zoom:k},d,{},I.availableImages),xe=K.evaluate({zoom:k+1},d,{},I.availableImages);ne=ne&&ne.name?ne.name:ne,ue=ue&&ue.name?ue.name:ue,xe=xe&&xe.name?xe.name:xe,F[ne]=!0,F[ue]=!0,F[xe]=!0,d.patterns[V.id]={min:ne,mid:ue,max:xe}}}return d}class C3{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Pl,this.indexArray=new Ka,this.indexArray2=new Ko,this.programConfigurations=new Pd(s.layers,s.zoom),this.segments=new ri,this.segments2=new ri,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(s,d,k){this.hasPattern=O3("fill",this.layers,d);const I=this.layers[0].layout.get("fill-sort-key"),F=!I.isConstant(),V=[];for(const{feature:K,id:ne,index:ue,sourceLayerIndex:xe}of s){const Te=this.layers[0]._featureFilter.needGeometry,Ne=Od(K,Te);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),Ne,k))continue;const Ue=F?I.evaluate(Ne,{},k,d.availableImages):void 0,Ke={id:ne,properties:K.properties,type:K.type,sourceLayerIndex:xe,index:ue,geometry:Te?Ne.geometry:Td(K),patterns:{},sortKey:Ue};V.push(Ke)}F&&V.sort((K,ne)=>K.sortKey-ne.sortKey);for(const K of V){const{geometry:ne,index:ue,sourceLayerIndex:xe}=K;if(this.hasPattern){const Te=M3("fill",this.layers,K,this.zoom,d);this.patternFeatures.push(Te)}else this.addFeature(K,ne,ue,k,{});d.featureIndex.insert(s[ue].feature,ne,ue,xe,this.index)}}update(s,d,k){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,d,this.stateDependentLayers,k)}addFeatures(s,d,k){for(const I of this.patternFeatures)this.addFeature(I,I.geometry,I.index,d,k)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,fD),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,d,k,I,F){for(const V of yn(d,500)){let K=0;for(const Ue of V)K+=Ue.length;const ne=this.segments.prepareSegment(K,this.layoutVertexArray,this.indexArray),ue=ne.vertexLength,xe=[],Te=[];for(const Ue of V){if(Ue.length===0)continue;Ue!==V[0]&&Te.push(xe.length/2);const Ke=this.segments2.prepareSegment(Ue.length,this.layoutVertexArray,this.indexArray2),Ze=Ke.vertexLength;this.layoutVertexArray.emplaceBack(Ue[0].x,Ue[0].y),this.indexArray2.emplaceBack(Ze+Ue.length-1,Ze),xe.push(Ue[0].x),xe.push(Ue[0].y);for(let ct=1;ct<Ue.length;ct++)this.layoutVertexArray.emplaceBack(Ue[ct].x,Ue[ct].y),this.indexArray2.emplaceBack(Ze+ct-1,Ze+ct),xe.push(Ue[ct].x),xe.push(Ue[ct].y);Ke.vertexLength+=Ue.length,Ke.primitiveLength+=Ue.length}const Ne=Ek(xe,Te);for(let Ue=0;Ue<Ne.length;Ue+=3)this.indexArray.emplaceBack(ue+Ne[Ue],ue+Ne[Ue+1],ue+Ne[Ue+2]);ne.vertexLength+=K,ne.primitiveLength+=Ne.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,k,F,I)}}let Ok,Mk;Vn("FillBucket",C3,{omit:["layers","patternFeatures"]});var xD={get paint(){return Mk=Mk||new $({"fill-antialias":new Yn(te.paint_fill["fill-antialias"]),"fill-opacity":new Sr(te.paint_fill["fill-opacity"]),"fill-color":new Sr(te.paint_fill["fill-color"]),"fill-outline-color":new Sr(te.paint_fill["fill-outline-color"]),"fill-translate":new Yn(te.paint_fill["fill-translate"]),"fill-translate-anchor":new Yn(te.paint_fill["fill-translate-anchor"]),"fill-pattern":new $m(te.paint_fill["fill-pattern"])})},get layout(){return Ok=Ok||new $({"fill-sort-key":new Sr(te.layout_fill["fill-sort-key"])})}};class SD extends S{constructor(s){super(s,xD)}recalculate(s,d){super.recalculate(s,d);const k=this.paint._values["fill-outline-color"];k.value.kind==="constant"&&k.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new C3(s)}queryRadius(){return yw(this.paint.get("fill-translate"))}queryIntersectsFeature(s,d,k,I,F,V,K){return fk(bw(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),V.angle,K),I)}isTileClipped(){return!0}}const ED=J([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),AD=J([{name:"a_centroid",components:2,type:"Int16"}],4),{members:kD}=ED;var Hh={},PD=m,Ck=Xm;function Xm(u,s,d,k,I){this.properties={},this.extent=d,this.type=0,this._pbf=u,this._geometry=-1,this._keys=k,this._values=I,u.readFields(TD,this,s)}function TD(u,s,d){u==1?s.id=d.readVarint():u==2?function(k,I){for(var F=k.readVarint()+k.pos;k.pos<F;){var V=I._keys[k.readVarint()],K=I._values[k.readVarint()];I.properties[V]=K}}(d,s):u==3?s.type=d.readVarint():u==4&&(s._geometry=d.pos)}function OD(u){for(var s,d,k=0,I=0,F=u.length,V=F-1;I<F;V=I++)k+=((d=u[V]).x-(s=u[I]).x)*(s.y+d.y);return k}Xm.types=["Unknown","Point","LineString","Polygon"],Xm.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var s,d=u.readVarint()+u.pos,k=1,I=0,F=0,V=0,K=[];u.pos<d;){if(I<=0){var ne=u.readVarint();k=7&ne,I=ne>>3}if(I--,k===1||k===2)F+=u.readSVarint(),V+=u.readSVarint(),k===1&&(s&&K.push(s),s=[]),s.push(new PD(F,V));else{if(k!==7)throw new Error("unknown command "+k);s&&s.push(s[0].clone())}}return s&&K.push(s),K},Xm.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var s=u.readVarint()+u.pos,d=1,k=0,I=0,F=0,V=1/0,K=-1/0,ne=1/0,ue=-1/0;u.pos<s;){if(k<=0){var xe=u.readVarint();d=7&xe,k=xe>>3}if(k--,d===1||d===2)(I+=u.readSVarint())<V&&(V=I),I>K&&(K=I),(F+=u.readSVarint())<ne&&(ne=F),F>ue&&(ue=F);else if(d!==7)throw new Error("unknown command "+d)}return[V,ne,K,ue]},Xm.prototype.toGeoJSON=function(u,s,d){var k,I,F=this.extent*Math.pow(2,d),V=this.extent*u,K=this.extent*s,ne=this.loadGeometry(),ue=Xm.types[this.type];function xe(Ue){for(var Ke=0;Ke<Ue.length;Ke++){var Ze=Ue[Ke];Ue[Ke]=[360*(Ze.x+V)/F-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ze.y+K)/F)*Math.PI/180))-90]}}switch(this.type){case 1:var Te=[];for(k=0;k<ne.length;k++)Te[k]=ne[k][0];xe(ne=Te);break;case 2:for(k=0;k<ne.length;k++)xe(ne[k]);break;case 3:for(ne=function(Ue){var Ke=Ue.length;if(Ke<=1)return[Ue];for(var Ze,ct,mt=[],Bt=0;Bt<Ke;Bt++){var Pt=OD(Ue[Bt]);Pt!==0&&(ct===void 0&&(ct=Pt<0),ct===Pt<0?(Ze&&mt.push(Ze),Ze=[Ue[Bt]]):Ze.push(Ue[Bt]))}return Ze&&mt.push(Ze),mt}(ne),k=0;k<ne.length;k++)for(I=0;I<ne[k].length;I++)xe(ne[k][I])}ne.length===1?ne=ne[0]:ue="Multi"+ue;var Ne={type:"Feature",geometry:{type:ue,coordinates:ne},properties:this.properties};return"id"in this&&(Ne.id=this.id),Ne};var MD=Ck,Ik=Rk;function Rk(u,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(CD,this,s),this.length=this._features.length}function CD(u,s,d){u===15?s.version=d.readVarint():u===1?s.name=d.readString():u===5?s.extent=d.readVarint():u===2?s._features.push(d.pos):u===3?s._keys.push(d.readString()):u===4&&s._values.push(function(k){for(var I=null,F=k.readVarint()+k.pos;k.pos<F;){var V=k.readVarint()>>3;I=V===1?k.readString():V===2?k.readFloat():V===3?k.readDouble():V===4?k.readVarint64():V===5?k.readVarint():V===6?k.readSVarint():V===7?k.readBoolean():null}return I}(d))}Rk.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var s=this._pbf.readVarint()+this._pbf.pos;return new MD(this._pbf,s,this.extent,this._keys,this._values)};var ID=Ik;function RD(u,s,d){if(u===3){var k=new ID(d,d.readVarint()+d.pos);k.length&&(s[k.name]=k)}}Hh.VectorTile=function(u,s){this.layers=u.readFields(RD,{},s)},Hh.VectorTileFeature=Ck,Hh.VectorTileLayer=Ik;const DD=Hh.VectorTileFeature.types,I3=Math.pow(2,13);function ib(u,s,d,k,I,F,V,K){u.emplaceBack(s,d,2*Math.floor(k*I3)+V,I*I3*2,F*I3*2,Math.round(K))}class R3{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Bh,this.centroidVertexArray=new as,this.indexArray=new Ka,this.programConfigurations=new Pd(s.layers,s.zoom),this.segments=new ri,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(s,d,k){this.features=[],this.hasPattern=O3("fill-extrusion",this.layers,d);for(const{feature:I,id:F,index:V,sourceLayerIndex:K}of s){const ne=this.layers[0]._featureFilter.needGeometry,ue=Od(I,ne);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),ue,k))continue;const xe={id:F,sourceLayerIndex:K,index:V,geometry:ne?ue.geometry:Td(I),properties:I.properties,type:I.type,patterns:{}};this.hasPattern?this.features.push(M3("fill-extrusion",this.layers,xe,this.zoom,d)):this.addFeature(xe,xe.geometry,V,k,{}),d.featureIndex.insert(I,xe.geometry,V,K,this.index,!0)}}addFeatures(s,d,k){for(const I of this.features){const{geometry:F}=I;this.addFeature(I,F,I.index,d,k)}}update(s,d,k){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,d,this.stateDependentLayers,k)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,kD),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,AD.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,d,k,I,F){for(const V of yn(d,500)){const K={x:0,y:0,vertexCount:0};let ne=0;for(const Ke of V)ne+=Ke.length;let ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Ke of V){if(Ke.length===0||jD(Ke))continue;let Ze=0;for(let ct=0;ct<Ke.length;ct++){const mt=Ke[ct];if(ct>=1){const Bt=Ke[ct-1];if(!LD(mt,Bt)){ue.vertexLength+4>ri.MAX_VERTEX_ARRAY_LENGTH&&(ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Pt=mt.sub(Bt)._perp()._unit(),$t=Bt.dist(mt);Ze+$t>32768&&(Ze=0),ib(this.layoutVertexArray,mt.x,mt.y,Pt.x,Pt.y,0,0,Ze),ib(this.layoutVertexArray,mt.x,mt.y,Pt.x,Pt.y,0,1,Ze),K.x+=2*mt.x,K.y+=2*mt.y,K.vertexCount+=2,Ze+=$t,ib(this.layoutVertexArray,Bt.x,Bt.y,Pt.x,Pt.y,0,0,Ze),ib(this.layoutVertexArray,Bt.x,Bt.y,Pt.x,Pt.y,0,1,Ze),K.x+=2*Bt.x,K.y+=2*Bt.y,K.vertexCount+=2;const Gt=ue.vertexLength;this.indexArray.emplaceBack(Gt,Gt+2,Gt+1),this.indexArray.emplaceBack(Gt+1,Gt+2,Gt+3),ue.vertexLength+=4,ue.primitiveLength+=2}}}}if(ue.vertexLength+ne>ri.MAX_VERTEX_ARRAY_LENGTH&&(ue=this.segments.prepareSegment(ne,this.layoutVertexArray,this.indexArray)),DD[s.type]!=="Polygon")continue;const xe=[],Te=[],Ne=ue.vertexLength;for(const Ke of V)if(Ke.length!==0){Ke!==V[0]&&Te.push(xe.length/2);for(let Ze=0;Ze<Ke.length;Ze++){const ct=Ke[Ze];ib(this.layoutVertexArray,ct.x,ct.y,0,0,1,1,0),K.x+=ct.x,K.y+=ct.y,K.vertexCount+=1,xe.push(ct.x),xe.push(ct.y)}}const Ue=Ek(xe,Te);for(let Ke=0;Ke<Ue.length;Ke+=3)this.indexArray.emplaceBack(Ne+Ue[Ke],Ne+Ue[Ke+2],Ne+Ue[Ke+1]);ue.primitiveLength+=Ue.length/3,ue.vertexLength+=ne;for(let Ke=0;Ke<K.vertexCount;Ke++){const Ze=Math.floor(K.x/K.vertexCount),ct=Math.floor(K.y/K.vertexCount);this.centroidVertexArray.emplaceBack(Ze,ct)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,k,F,I)}}function LD(u,s){return u.x===s.x&&(u.x<0||u.x>vo)||u.y===s.y&&(u.y<0||u.y>vo)}function jD(u){return u.every(s=>s.x<0)||u.every(s=>s.x>vo)||u.every(s=>s.y<0)||u.every(s=>s.y>vo)}let Dk;Vn("FillExtrusionBucket",R3,{omit:["layers","features"]});var ND={get paint(){return Dk=Dk||new $({"fill-extrusion-opacity":new Yn(te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Sr(te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Yn(te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Yn(te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $m(te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Sr(te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Sr(te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Yn(te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class $D extends S{constructor(s){super(s,ND)}createBucket(s){return new R3(s)}queryRadius(){return yw(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,d,k,I,F,V,K,ne){const ue=bw(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),V.angle,K),xe=this.paint.get("fill-extrusion-height").evaluate(d,k),Te=this.paint.get("fill-extrusion-base").evaluate(d,k),Ne=function(Ke,Ze,ct,mt){const Bt=[];for(const Pt of Ke){const $t=[Pt.x,Pt.y,0,1];vw($t,$t,Ze),Bt.push(new g($t[0]/$t[3],$t[1]/$t[3]))}return Bt}(ue,ne),Ue=function(Ke,Ze,ct,mt){const Bt=[],Pt=[],$t=mt[8]*Ze,Gt=mt[9]*Ze,dn=mt[10]*Ze,$n=mt[11]*Ze,_r=mt[8]*ct,Rn=mt[9]*ct,Tn=mt[10]*ct,rr=mt[11]*ct;for(const Hn of Ke){const Un=[],Qt=[];for(const ar of Hn){const tr=ar.x,Dr=ar.y,Oi=mt[0]*tr+mt[4]*Dr+mt[12],Ti=mt[1]*tr+mt[5]*Dr+mt[13],Lo=mt[2]*tr+mt[6]*Dr+mt[14],Tl=mt[3]*tr+mt[7]*Dr+mt[15],us=Lo+dn,jo=Tl+$n,Hs=Oi+_r,Ws=Ti+Rn,Gs=Lo+Tn,to=Tl+rr,No=new g((Oi+$t)/jo,(Ti+Gt)/jo);No.z=us/jo,Un.push(No);const Ts=new g(Hs/to,Ws/to);Ts.z=Gs/to,Qt.push(Ts)}Bt.push(Un),Pt.push(Qt)}return[Bt,Pt]}(I,Te,xe,ne);return function(Ke,Ze,ct){let mt=1/0;fk(ct,Ze)&&(mt=Lk(ct,Ze[0]));for(let Bt=0;Bt<Ze.length;Bt++){const Pt=Ze[Bt],$t=Ke[Bt];for(let Gt=0;Gt<Pt.length-1;Gt++){const dn=Pt[Gt],$n=[dn,Pt[Gt+1],$t[Gt+1],$t[Gt],dn];hk(ct,$n)&&(mt=Math.min(mt,Lk(ct,$n)))}}return mt!==1/0&&mt}(Ue[0],Ue[1],Ne)}}function ob(u,s){return u.x*s.x+u.y*s.y}function Lk(u,s){if(u.length===1){let d=0;const k=s[d++];let I;for(;!I||k.equals(I);)if(I=s[d++],!I)return 1/0;for(;d<s.length;d++){const F=s[d],V=u[0],K=I.sub(k),ne=F.sub(k),ue=V.sub(k),xe=ob(K,K),Te=ob(K,ne),Ne=ob(ne,ne),Ue=ob(ue,K),Ke=ob(ue,ne),Ze=xe*Ne-Te*Te,ct=(Ne*Ue-Te*Ke)/Ze,mt=(xe*Ke-Te*Ue)/Ze,Bt=k.z*(1-ct-mt)+I.z*ct+F.z*mt;if(isFinite(Bt))return Bt}return 1/0}{let d=1/0;for(const k of s)d=Math.min(d,k.z);return d}}const BD=J([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:FD}=BD,zD=J([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:UD}=zD,VD=Hh.VectorTileFeature.types,qD=Math.cos(Math.PI/180*37.5),jk=Math.pow(2,14)/.5;class D3{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new Fm,this.layoutVertexArray2=new Fh,this.indexArray=new Ka,this.programConfigurations=new Pd(s.layers,s.zoom),this.segments=new ri,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(s,d,k){this.hasPattern=O3("line",this.layers,d);const I=this.layers[0].layout.get("line-sort-key"),F=!I.isConstant(),V=[];for(const{feature:K,id:ne,index:ue,sourceLayerIndex:xe}of s){const Te=this.layers[0]._featureFilter.needGeometry,Ne=Od(K,Te);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),Ne,k))continue;const Ue=F?I.evaluate(Ne,{},k):void 0,Ke={id:ne,properties:K.properties,type:K.type,sourceLayerIndex:xe,index:ue,geometry:Te?Ne.geometry:Td(K),patterns:{},sortKey:Ue};V.push(Ke)}F&&V.sort((K,ne)=>K.sortKey-ne.sortKey);for(const K of V){const{geometry:ne,index:ue,sourceLayerIndex:xe}=K;if(this.hasPattern){const Te=M3("line",this.layers,K,this.zoom,d);this.patternFeatures.push(Te)}else this.addFeature(K,ne,ue,k,{});d.featureIndex.insert(s[ue].feature,ne,ue,xe,this.index)}}update(s,d,k){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,d,this.stateDependentLayers,k)}addFeatures(s,d,k){for(const I of this.patternFeatures)this.addFeature(I,I.geometry,I.index,d,k)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,UD)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,FD),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,d,k,I,F){const V=this.layers[0].layout,K=V.get("line-join").evaluate(s,{}),ne=V.get("line-cap"),ue=V.get("line-miter-limit"),xe=V.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const Te of d)this.addLine(Te,s,K,ne,ue,xe);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,k,F,I)}addLine(s,d,k,I,F,V){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let mt=0;mt<s.length-1;mt++)this.totalDistance+=s[mt].dist(s[mt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const K=VD[d.type]==="Polygon";let ne=s.length;for(;ne>=2&&s[ne-1].equals(s[ne-2]);)ne--;let ue=0;for(;ue<ne-1&&s[ue].equals(s[ue+1]);)ue++;if(ne<(K?3:2))return;k==="bevel"&&(F=1.05);const xe=this.overscaling<=16?15*vo/(512*this.overscaling):0,Te=this.segments.prepareSegment(10*ne,this.layoutVertexArray,this.indexArray);let Ne,Ue,Ke,Ze,ct;this.e1=this.e2=-1,K&&(Ne=s[ne-2],ct=s[ue].sub(Ne)._unit()._perp());for(let mt=ue;mt<ne;mt++){if(Ke=mt===ne-1?K?s[ue+1]:void 0:s[mt+1],Ke&&s[mt].equals(Ke))continue;ct&&(Ze=ct),Ne&&(Ue=Ne),Ne=s[mt],ct=Ke?Ke.sub(Ne)._unit()._perp():Ze,Ze=Ze||ct;let Bt=Ze.add(ct);Bt.x===0&&Bt.y===0||Bt._unit();const Pt=Ze.x*ct.x+Ze.y*ct.y,$t=Bt.x*ct.x+Bt.y*ct.y,Gt=$t!==0?1/$t:1/0,dn=2*Math.sqrt(2-2*$t),$n=$t<qD&&Ue&&Ke,_r=Ze.x*ct.y-Ze.y*ct.x>0;if($n&&mt>ue){const rr=Ne.dist(Ue);if(rr>2*xe){const Hn=Ne.sub(Ne.sub(Ue)._mult(xe/rr)._round());this.updateDistance(Ue,Hn),this.addCurrentVertex(Hn,Ze,0,0,Te),Ue=Hn}}const Rn=Ue&&Ke;let Tn=Rn?k:K?"butt":I;if(Rn&&Tn==="round"&&(Gt<V?Tn="miter":Gt<=2&&(Tn="fakeround")),Tn==="miter"&&Gt>F&&(Tn="bevel"),Tn==="bevel"&&(Gt>2&&(Tn="flipbevel"),Gt<F&&(Tn="miter")),Ue&&this.updateDistance(Ue,Ne),Tn==="miter")Bt._mult(Gt),this.addCurrentVertex(Ne,Bt,0,0,Te);else if(Tn==="flipbevel"){if(Gt>100)Bt=ct.mult(-1);else{const rr=Gt*Ze.add(ct).mag()/Ze.sub(ct).mag();Bt._perp()._mult(rr*(_r?-1:1))}this.addCurrentVertex(Ne,Bt,0,0,Te),this.addCurrentVertex(Ne,Bt.mult(-1),0,0,Te)}else if(Tn==="bevel"||Tn==="fakeround"){const rr=-Math.sqrt(Gt*Gt-1),Hn=_r?rr:0,Un=_r?0:rr;if(Ue&&this.addCurrentVertex(Ne,Ze,Hn,Un,Te),Tn==="fakeround"){const Qt=Math.round(180*dn/Math.PI/20);for(let ar=1;ar<Qt;ar++){let tr=ar/Qt;if(tr!==.5){const Oi=tr-.5;tr+=tr*Oi*(tr-1)*((1.0904+Pt*(Pt*(3.55645-1.43519*Pt)-3.2452))*Oi*Oi+(.848013+Pt*(.215638*Pt-1.06021)))}const Dr=ct.sub(Ze)._mult(tr)._add(Ze)._unit()._mult(_r?-1:1);this.addHalfVertex(Ne,Dr.x,Dr.y,!1,_r,0,Te)}}Ke&&this.addCurrentVertex(Ne,ct,-Hn,-Un,Te)}else if(Tn==="butt")this.addCurrentVertex(Ne,Bt,0,0,Te);else if(Tn==="square"){const rr=Ue?1:-1;this.addCurrentVertex(Ne,Bt,rr,rr,Te)}else Tn==="round"&&(Ue&&(this.addCurrentVertex(Ne,Ze,0,0,Te),this.addCurrentVertex(Ne,Ze,1,1,Te,!0)),Ke&&(this.addCurrentVertex(Ne,ct,-1,-1,Te,!0),this.addCurrentVertex(Ne,ct,0,0,Te)));if($n&&mt<ne-1){const rr=Ne.dist(Ke);if(rr>2*xe){const Hn=Ne.add(Ke.sub(Ne)._mult(xe/rr)._round());this.updateDistance(Ne,Hn),this.addCurrentVertex(Hn,ct,0,0,Te),Ne=Hn}}}}addCurrentVertex(s,d,k,I,F,V=!1){const K=d.y*I-d.x,ne=-d.y-d.x*I;this.addHalfVertex(s,d.x+d.y*k,d.y-d.x*k,V,!1,k,F),this.addHalfVertex(s,K,ne,V,!0,-I,F),this.distance>jk/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,d,k,I,F,V))}addHalfVertex({x:s,y:d},k,I,F,V,K,ne){const ue=.5*(this.lineClips?this.scaledDistance*(jk-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(F?1:0),(d<<1)+(V?1:0),Math.round(63*k)+128,Math.round(63*I)+128,1+(K===0?0:K<0?-1:1)|(63&ue)<<2,ue>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const xe=ne.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,xe),ne.primitiveLength++),V?this.e2=xe:this.e1=xe}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,d){this.distance+=s.dist(d),this.updateScaledDistance()}}let Nk,$k;Vn("LineBucket",D3,{omit:["layers","patternFeatures"]});var Bk={get paint(){return $k=$k||new $({"line-opacity":new Sr(te.paint_line["line-opacity"]),"line-color":new Sr(te.paint_line["line-color"]),"line-translate":new Yn(te.paint_line["line-translate"]),"line-translate-anchor":new Yn(te.paint_line["line-translate-anchor"]),"line-width":new Sr(te.paint_line["line-width"]),"line-gap-width":new Sr(te.paint_line["line-gap-width"]),"line-offset":new Sr(te.paint_line["line-offset"]),"line-blur":new Sr(te.paint_line["line-blur"]),"line-dasharray":new Bm(te.paint_line["line-dasharray"]),"line-pattern":new $m(te.paint_line["line-pattern"]),"line-gradient":new X0(te.paint_line["line-gradient"])})},get layout(){return Nk=Nk||new $({"line-cap":new Yn(te.layout_line["line-cap"]),"line-join":new Sr(te.layout_line["line-join"]),"line-miter-limit":new Yn(te.layout_line["line-miter-limit"]),"line-round-limit":new Yn(te.layout_line["line-round-limit"]),"line-sort-key":new Sr(te.layout_line["line-sort-key"])})}};class HD extends Sr{possiblyEvaluate(s,d){return d=new ji(Math.floor(d.zoom),{now:d.now,fadeDuration:d.fadeDuration,zoomHistory:d.zoomHistory,transition:d.transition}),super.possiblyEvaluate(s,d)}evaluate(s,d,k,I){return d=R({},d,{zoom:Math.floor(d.zoom)}),super.evaluate(s,d,k,I)}}let Sw;class WD extends S{constructor(s){super(s,Bk),this.gradientVersion=0,Sw||(Sw=new HD(Bk.paint.properties["line-width"].specification),Sw.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const d=this.gradientExpression();this.stepInterpolant=!!function(k){return k._styleExpression!==void 0}(d)&&d._styleExpression.expression instanceof Ss,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,d){super.recalculate(s,d),this.paint._values["line-floorwidth"]=Sw.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new D3(s)}queryRadius(s){const d=s,k=Fk(J0("line-width",this,d),J0("line-gap-width",this,d)),I=J0("line-offset",this,d);return k/2+Math.abs(I)+yw(this.paint.get("line-translate"))}queryIntersectsFeature(s,d,k,I,F,V,K){const ne=bw(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),V.angle,K),ue=K/2*Fk(this.paint.get("line-width").evaluate(d,k),this.paint.get("line-gap-width").evaluate(d,k)),xe=this.paint.get("line-offset").evaluate(d,k);return xe&&(I=function(Te,Ne){const Ue=[];for(let Ke=0;Ke<Te.length;Ke++){const Ze=Te[Ke],ct=[];for(let mt=0;mt<Ze.length;mt++){const Bt=Ze[mt-1],Pt=Ze[mt],$t=Ze[mt+1],Gt=mt===0?new g(0,0):Pt.sub(Bt)._unit()._perp(),dn=mt===Ze.length-1?new g(0,0):$t.sub(Pt)._unit()._perp(),$n=Gt._add(dn)._unit(),_r=$n.x*dn.x+$n.y*dn.y;_r!==0&&$n._mult(1/_r),ct.push($n._mult(Ne)._add(Pt))}Ue.push(ct)}return Ue}(I,xe*K)),function(Te,Ne,Ue){for(let Ke=0;Ke<Ne.length;Ke++){const Ze=Ne[Ke];if(Te.length>=3){for(let ct=0;ct<Ze.length;ct++)if(Wm(Te,Ze[ct]))return!0}if(tD(Te,Ze,Ue))return!0}return!1}(ne,I,ue)}isTileClipped(){return!0}}function Fk(u,s){return s>0?s+2*u:u}const GD=J([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),KD=J([{name:"a_projected_pos",components:3,type:"Float32"}],4);J([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const XD=J([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);J([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zk=J([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ZD=J([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function YD(u,s,d){return u.sections.forEach(k=>{k.text=function(I,F,V){const K=F.layout.get("text-transform").evaluate(V,{});return K==="uppercase"?I=I.toLocaleUpperCase():K==="lowercase"&&(I=I.toLocaleLowerCase()),ca.applyArabicShaping&&(I=ca.applyArabicShaping(I)),I}(k.text,s,d)}),u}J([{name:"triangle",components:3,type:"Uint16"}]),J([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),J([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),J([{type:"Float32",name:"offsetX"}]),J([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),J([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const sb={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ko=24,Uk=Pi,Vk=function(u,s,d,k,I){var F,V,K=8*I-k-1,ne=(1<<K)-1,ue=ne>>1,xe=-7,Te=d?I-1:0,Ne=d?-1:1,Ue=u[s+Te];for(Te+=Ne,F=Ue&(1<<-xe)-1,Ue>>=-xe,xe+=K;xe>0;F=256*F+u[s+Te],Te+=Ne,xe-=8);for(V=F&(1<<-xe)-1,F>>=-xe,xe+=k;xe>0;V=256*V+u[s+Te],Te+=Ne,xe-=8);if(F===0)F=1-ue;else{if(F===ne)return V?NaN:1/0*(Ue?-1:1);V+=Math.pow(2,k),F-=ue}return(Ue?-1:1)*V*Math.pow(2,F-k)},qk=function(u,s,d,k,I,F){var V,K,ne,ue=8*F-I-1,xe=(1<<ue)-1,Te=xe>>1,Ne=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ue=k?0:F-1,Ke=k?1:-1,Ze=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(K=isNaN(s)?1:0,V=xe):(V=Math.floor(Math.log(s)/Math.LN2),s*(ne=Math.pow(2,-V))<1&&(V--,ne*=2),(s+=V+Te>=1?Ne/ne:Ne*Math.pow(2,1-Te))*ne>=2&&(V++,ne/=2),V+Te>=xe?(K=0,V=xe):V+Te>=1?(K=(s*ne-1)*Math.pow(2,I),V+=Te):(K=s*Math.pow(2,Te-1)*Math.pow(2,I),V=0));I>=8;u[d+Ue]=255&K,Ue+=Ke,K/=256,I-=8);for(V=V<<I|K,ue+=I;ue>0;u[d+Ue]=255&V,Ue+=Ke,V/=256,ue-=8);u[d+Ue-Ke]|=128*Ze};function Pi(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Pi.Varint=0,Pi.Fixed64=1,Pi.Bytes=2,Pi.Fixed32=5;var L3=4294967296,Hk=1/L3,Wk=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Tu(u){return u.type===Pi.Bytes?u.readVarint()+u.pos:u.pos+1}function Zm(u,s,d){return d?4294967296*s+(u>>>0):4294967296*(s>>>0)+(u>>>0)}function Gk(u,s,d){var k=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));d.realloc(k);for(var I=d.pos-1;I>=u;I--)d.buf[I+k]=d.buf[I]}function JD(u,s){for(var d=0;d<u.length;d++)s.writeVarint(u[d])}function QD(u,s){for(var d=0;d<u.length;d++)s.writeSVarint(u[d])}function eL(u,s){for(var d=0;d<u.length;d++)s.writeFloat(u[d])}function tL(u,s){for(var d=0;d<u.length;d++)s.writeDouble(u[d])}function nL(u,s){for(var d=0;d<u.length;d++)s.writeBoolean(u[d])}function rL(u,s){for(var d=0;d<u.length;d++)s.writeFixed32(u[d])}function iL(u,s){for(var d=0;d<u.length;d++)s.writeSFixed32(u[d])}function oL(u,s){for(var d=0;d<u.length;d++)s.writeFixed64(u[d])}function sL(u,s){for(var d=0;d<u.length;d++)s.writeSFixed64(u[d])}function Ew(u,s){return(u[s]|u[s+1]<<8|u[s+2]<<16)+16777216*u[s+3]}function Ym(u,s,d){u[d]=s,u[d+1]=s>>>8,u[d+2]=s>>>16,u[d+3]=s>>>24}function Kk(u,s){return(u[s]|u[s+1]<<8|u[s+2]<<16)+(u[s+3]<<24)}Pi.prototype={destroy:function(){this.buf=null},readFields:function(u,s,d){for(d=d||this.length;this.pos<d;){var k=this.readVarint(),I=k>>3,F=this.pos;this.type=7&k,u(I,s,this),this.pos===F&&this.skip(k)}return s},readMessage:function(u,s){return this.readFields(u,s,this.readVarint()+this.pos)},readFixed32:function(){var u=Ew(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=Kk(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=Ew(this.buf,this.pos)+Ew(this.buf,this.pos+4)*L3;return this.pos+=8,u},readSFixed64:function(){var u=Ew(this.buf,this.pos)+Kk(this.buf,this.pos+4)*L3;return this.pos+=8,u},readFloat:function(){var u=Vk(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=Vk(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var s,d,k=this.buf;return s=127&(d=k[this.pos++]),d<128?s:(s|=(127&(d=k[this.pos++]))<<7,d<128?s:(s|=(127&(d=k[this.pos++]))<<14,d<128?s:(s|=(127&(d=k[this.pos++]))<<21,d<128?s:function(I,F,V){var K,ne,ue=V.buf;if(K=(112&(ne=ue[V.pos++]))>>4,ne<128||(K|=(127&(ne=ue[V.pos++]))<<3,ne<128)||(K|=(127&(ne=ue[V.pos++]))<<10,ne<128)||(K|=(127&(ne=ue[V.pos++]))<<17,ne<128)||(K|=(127&(ne=ue[V.pos++]))<<24,ne<128)||(K|=(1&(ne=ue[V.pos++]))<<31,ne<128))return Zm(I,K,F);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(d=k[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,s=this.pos;return this.pos=u,u-s>=12&&Wk?function(d,k,I){return Wk.decode(d.subarray(k,I))}(this.buf,s,u):function(d,k,I){for(var F="",V=k;V<I;){var K,ne,ue,xe=d[V],Te=null,Ne=xe>239?4:xe>223?3:xe>191?2:1;if(V+Ne>I)break;Ne===1?xe<128&&(Te=xe):Ne===2?(192&(K=d[V+1]))==128&&(Te=(31&xe)<<6|63&K)<=127&&(Te=null):Ne===3?(ne=d[V+2],(192&(K=d[V+1]))==128&&(192&ne)==128&&((Te=(15&xe)<<12|(63&K)<<6|63&ne)<=2047||Te>=55296&&Te<=57343)&&(Te=null)):Ne===4&&(ne=d[V+2],ue=d[V+3],(192&(K=d[V+1]))==128&&(192&ne)==128&&(192&ue)==128&&((Te=(15&xe)<<18|(63&K)<<12|(63&ne)<<6|63&ue)<=65535||Te>=1114112)&&(Te=null)),Te===null?(Te=65533,Ne=1):Te>65535&&(Te-=65536,F+=String.fromCharCode(Te>>>10&1023|55296),Te=56320|1023&Te),F+=String.fromCharCode(Te),V+=Ne}return F}(this.buf,s,u)},readBytes:function(){var u=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,u);return this.pos=u,s},readPackedVarint:function(u,s){if(this.type!==Pi.Bytes)return u.push(this.readVarint(s));var d=Tu(this);for(u=u||[];this.pos<d;)u.push(this.readVarint(s));return u},readPackedSVarint:function(u){if(this.type!==Pi.Bytes)return u.push(this.readSVarint());var s=Tu(this);for(u=u||[];this.pos<s;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Pi.Bytes)return u.push(this.readBoolean());var s=Tu(this);for(u=u||[];this.pos<s;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Pi.Bytes)return u.push(this.readFloat());var s=Tu(this);for(u=u||[];this.pos<s;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Pi.Bytes)return u.push(this.readDouble());var s=Tu(this);for(u=u||[];this.pos<s;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Pi.Bytes)return u.push(this.readFixed32());var s=Tu(this);for(u=u||[];this.pos<s;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Pi.Bytes)return u.push(this.readSFixed32());var s=Tu(this);for(u=u||[];this.pos<s;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Pi.Bytes)return u.push(this.readFixed64());var s=Tu(this);for(u=u||[];this.pos<s;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Pi.Bytes)return u.push(this.readSFixed64());var s=Tu(this);for(u=u||[];this.pos<s;)u.push(this.readSFixed64());return u},skip:function(u){var s=7&u;if(s===Pi.Varint)for(;this.buf[this.pos++]>127;);else if(s===Pi.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Pi.Fixed32)this.pos+=4;else{if(s!==Pi.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(u,s){this.writeVarint(u<<3|s)},realloc:function(u){for(var s=this.length||16;s<this.pos+u;)s*=2;if(s!==this.length){var d=new Uint8Array(s);d.set(this.buf),this.buf=d,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Ym(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Ym(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Ym(this.buf,-1&u,this.pos),Ym(this.buf,Math.floor(u*Hk),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Ym(this.buf,-1&u,this.pos),Ym(this.buf,Math.floor(u*Hk),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(s,d){var k,I;if(s>=0?(k=s%4294967296|0,I=s/4294967296|0):(I=~(-s/4294967296),4294967295^(k=~(-s%4294967296))?k=k+1|0:(k=0,I=I+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),function(F,V,K){K.buf[K.pos++]=127&F|128,F>>>=7,K.buf[K.pos++]=127&F|128,F>>>=7,K.buf[K.pos++]=127&F|128,F>>>=7,K.buf[K.pos++]=127&F|128,K.buf[K.pos]=127&(F>>>=7)}(k,0,d),function(F,V){var K=(7&F)<<4;V.buf[V.pos++]|=K|((F>>>=3)?128:0),F&&(V.buf[V.pos++]=127&F|((F>>>=7)?128:0),F&&(V.buf[V.pos++]=127&F|((F>>>=7)?128:0),F&&(V.buf[V.pos++]=127&F|((F>>>=7)?128:0),F&&(V.buf[V.pos++]=127&F|((F>>>=7)?128:0),F&&(V.buf[V.pos++]=127&F)))))}(I,d)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var s=this.pos;this.pos=function(k,I,F){for(var V,K,ne=0;ne<I.length;ne++){if((V=I.charCodeAt(ne))>55295&&V<57344){if(!K){V>56319||ne+1===I.length?(k[F++]=239,k[F++]=191,k[F++]=189):K=V;continue}if(V<56320){k[F++]=239,k[F++]=191,k[F++]=189,K=V;continue}V=K-55296<<10|V-56320|65536,K=null}else K&&(k[F++]=239,k[F++]=191,k[F++]=189,K=null);V<128?k[F++]=V:(V<2048?k[F++]=V>>6|192:(V<65536?k[F++]=V>>12|224:(k[F++]=V>>18|240,k[F++]=V>>12&63|128),k[F++]=V>>6&63|128),k[F++]=63&V|128)}return F}(this.buf,u,this.pos);var d=this.pos-s;d>=128&&Gk(s,d,this),this.pos=s-1,this.writeVarint(d),this.pos+=d},writeFloat:function(u){this.realloc(4),qk(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),qk(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var s=u.length;this.writeVarint(s),this.realloc(s);for(var d=0;d<s;d++)this.buf[this.pos++]=u[d]},writeRawMessage:function(u,s){this.pos++;var d=this.pos;u(s,this);var k=this.pos-d;k>=128&&Gk(d,k,this),this.pos=d-1,this.writeVarint(k),this.pos+=k},writeMessage:function(u,s,d){this.writeTag(u,Pi.Bytes),this.writeRawMessage(s,d)},writePackedVarint:function(u,s){s.length&&this.writeMessage(u,JD,s)},writePackedSVarint:function(u,s){s.length&&this.writeMessage(u,QD,s)},writePackedBoolean:function(u,s){s.length&&this.writeMessage(u,nL,s)},writePackedFloat:function(u,s){s.length&&this.writeMessage(u,eL,s)},writePackedDouble:function(u,s){s.length&&this.writeMessage(u,tL,s)},writePackedFixed32:function(u,s){s.length&&this.writeMessage(u,rL,s)},writePackedSFixed32:function(u,s){s.length&&this.writeMessage(u,iL,s)},writePackedFixed64:function(u,s){s.length&&this.writeMessage(u,oL,s)},writePackedSFixed64:function(u,s){s.length&&this.writeMessage(u,sL,s)},writeBytesField:function(u,s){this.writeTag(u,Pi.Bytes),this.writeBytes(s)},writeFixed32Field:function(u,s){this.writeTag(u,Pi.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(u,s){this.writeTag(u,Pi.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(u,s){this.writeTag(u,Pi.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(u,s){this.writeTag(u,Pi.Fixed64),this.writeSFixed64(s)},writeVarintField:function(u,s){this.writeTag(u,Pi.Varint),this.writeVarint(s)},writeSVarintField:function(u,s){this.writeTag(u,Pi.Varint),this.writeSVarint(s)},writeStringField:function(u,s){this.writeTag(u,Pi.Bytes),this.writeString(s)},writeFloatField:function(u,s){this.writeTag(u,Pi.Fixed32),this.writeFloat(s)},writeDoubleField:function(u,s){this.writeTag(u,Pi.Fixed64),this.writeDouble(s)},writeBooleanField:function(u,s){this.writeVarintField(u,!!s)}};var j3=h(Uk);const N3=3;function aL(u,s,d){u===1&&d.readMessage(lL,s)}function lL(u,s,d){if(u===3){const{id:k,bitmap:I,width:F,height:V,left:K,top:ne,advance:ue}=d.readMessage(cL,{});s.push({id:k,bitmap:new eb({width:F+2*N3,height:V+2*N3},I),metrics:{width:F,height:V,left:K,top:ne,advance:ue}})}}function cL(u,s,d){u===1?s.id=d.readVarint():u===2?s.bitmap=d.readBytes():u===3?s.width=d.readVarint():u===4?s.height=d.readVarint():u===5?s.left=d.readSVarint():u===6?s.top=d.readSVarint():u===7&&(s.advance=d.readVarint())}const Xk=N3;function Zk(u){let s=0,d=0;for(const V of u)s+=V.w*V.h,d=Math.max(d,V.w);u.sort((V,K)=>K.h-V.h);const k=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),d),h:1/0}];let I=0,F=0;for(const V of u)for(let K=k.length-1;K>=0;K--){const ne=k[K];if(!(V.w>ne.w||V.h>ne.h)){if(V.x=ne.x,V.y=ne.y,F=Math.max(F,V.y+V.h),I=Math.max(I,V.x+V.w),V.w===ne.w&&V.h===ne.h){const ue=k.pop();K<k.length&&(k[K]=ue)}else V.h===ne.h?(ne.x+=V.w,ne.w-=V.w):V.w===ne.w?(ne.y+=V.h,ne.h-=V.h):(k.push({x:ne.x+V.w,y:ne.y,w:ne.w-V.w,h:V.h}),ne.y+=V.h,ne.h-=V.h);break}}return{w:I,h:F,fill:s/(I*F)||0}}const ha=1;class $3{constructor(s,{pixelRatio:d,version:k,stretchX:I,stretchY:F,content:V,textFitWidth:K,textFitHeight:ne}){this.paddedRect=s,this.pixelRatio=d,this.stretchX=I,this.stretchY=F,this.content=V,this.version=k,this.textFitWidth=K,this.textFitHeight=ne}get tl(){return[this.paddedRect.x+ha,this.paddedRect.y+ha]}get br(){return[this.paddedRect.x+this.paddedRect.w-ha,this.paddedRect.y+this.paddedRect.h-ha]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ha)/this.pixelRatio,(this.paddedRect.h-2*ha)/this.pixelRatio]}}class Yk{constructor(s,d){const k={},I={};this.haveRenderCallbacks=[];const F=[];this.addImages(s,k,F),this.addImages(d,I,F);const{w:V,h:K}=Zk(F),ne=new Xa({width:V||1,height:K||1});for(const ue in s){const xe=s[ue],Te=k[ue].paddedRect;Xa.copy(xe.data,ne,{x:0,y:0},{x:Te.x+ha,y:Te.y+ha},xe.data)}for(const ue in d){const xe=d[ue],Te=I[ue].paddedRect,Ne=Te.x+ha,Ue=Te.y+ha,Ke=xe.data.width,Ze=xe.data.height;Xa.copy(xe.data,ne,{x:0,y:0},{x:Ne,y:Ue},xe.data),Xa.copy(xe.data,ne,{x:0,y:Ze-1},{x:Ne,y:Ue-1},{width:Ke,height:1}),Xa.copy(xe.data,ne,{x:0,y:0},{x:Ne,y:Ue+Ze},{width:Ke,height:1}),Xa.copy(xe.data,ne,{x:Ke-1,y:0},{x:Ne-1,y:Ue},{width:1,height:Ze}),Xa.copy(xe.data,ne,{x:0,y:0},{x:Ne+Ke,y:Ue},{width:1,height:Ze})}this.image=ne,this.iconPositions=k,this.patternPositions=I}addImages(s,d,k){for(const I in s){const F=s[I],V={x:0,y:0,w:F.data.width+2*ha,h:F.data.height+2*ha};k.push(V),d[I]=new $3(V,F),F.hasRenderCallback&&this.haveRenderCallbacks.push(I)}}patchUpdatedImages(s,d){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const k in s.updatedImages)this.patchUpdatedImage(this.iconPositions[k],s.getImage(k),d),this.patchUpdatedImage(this.patternPositions[k],s.getImage(k),d)}patchUpdatedImage(s,d,k){if(!s||!d||s.version===d.version)return;s.version=d.version;const[I,F]=s.tl;k.update(d.data,void 0,{x:I,y:F})}}var Wh;Vn("ImagePosition",$3),Vn("ImageAtlas",Yk),l.ah=void 0,(Wh=l.ah||(l.ah={}))[Wh.none=0]="none",Wh[Wh.horizontal=1]="horizontal",Wh[Wh.vertical=2]="vertical",Wh[Wh.horizontalOnly=3]="horizontalOnly";const ab=-17;class lb{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,d){const k=new lb;return k.scale=s||1,k.fontStack=d,k}static forImage(s){const d=new lb;return d.imageName=s,d}}class Jm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,d){const k=new Jm;for(let I=0;I<s.sections.length;I++){const F=s.sections[I];F.image?k.addImageSection(F):k.addTextSection(F,d)}return k}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let d="";for(let k=0;k<s.length;k++){const I=s.charCodeAt(k+1)||null,F=s.charCodeAt(k-1)||null;d+=I&&uw(I)&&!sb[s[k+1]]||F&&uw(F)&&!sb[s[k-1]]||!sb[s[k]]?s[k]:sb[s[k]]}return d}(this.text)}trim(){let s=0;for(let k=0;k<this.text.length&&kw[this.text.charCodeAt(k)];k++)s++;let d=this.text.length;for(let k=this.text.length-1;k>=0&&k>=s&&kw[this.text.charCodeAt(k)];k--)d--;this.text=this.text.substring(s,d),this.sectionIndex=this.sectionIndex.slice(s,d)}substring(s,d){const k=new Jm;return k.text=this.text.substring(s,d),k.sectionIndex=this.sectionIndex.slice(s,d),k.sections=this.sections,k}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,d)=>Math.max(s,this.sections[d].scale),0)}addTextSection(s,d){this.text+=s.text,this.sections.push(lb.forText(s.scale,s.fontStack||d));const k=this.sections.length-1;for(let I=0;I<s.text.length;++I)this.sectionIndex.push(k)}addImageSection(s){const d=s.image?s.image.name:"";if(d.length===0)return void Q("Can't add FormattedSection with an empty image.");const k=this.getNextImageSectionCharCode();k?(this.text+=String.fromCharCode(k),this.sections.push(lb.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Q("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Aw(u,s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke){const Ze=Jm.fromFeature(u,I);let ct;Te===l.ah.vertical&&Ze.verticalizePunctuation();const{processBidirectionalText:mt,processStyledBidirectionalText:Bt}=ca;if(mt&&Ze.sections.length===1){ct=[];const Gt=mt(Ze.toString(),B3(Ze,ue,F,s,k,Ue));for(const dn of Gt){const $n=new Jm;$n.text=dn,$n.sections=Ze.sections;for(let _r=0;_r<dn.length;_r++)$n.sectionIndex.push(0);ct.push($n)}}else if(Bt){ct=[];const Gt=Bt(Ze.text,Ze.sectionIndex,B3(Ze,ue,F,s,k,Ue));for(const dn of Gt){const $n=new Jm;$n.text=dn[0],$n.sectionIndex=dn[1],$n.sections=Ze.sections,ct.push($n)}}else ct=function(Gt,dn){const $n=[],_r=Gt.text;let Rn=0;for(const Tn of dn)$n.push(Gt.substring(Rn,Tn)),Rn=Tn;return Rn<_r.length&&$n.push(Gt.substring(Rn,_r.length)),$n}(Ze,B3(Ze,ue,F,s,k,Ue));const Pt=[],$t={positionedLines:Pt,text:Ze.toString(),top:xe[1],bottom:xe[1],left:xe[0],right:xe[0],writingMode:Te,iconsInText:!1,verticalizable:!1};return function(Gt,dn,$n,_r,Rn,Tn,rr,Hn,Un,Qt,ar,tr){let Dr=0,Oi=ab,Ti=0,Lo=0;const Tl=Hn==="right"?1:Hn==="left"?0:.5;let us=0;for(const to of Rn){to.trim();const No=to.getMaxScale(),Ts=(No-1)*ko,hs={positionedGlyphs:[],lineOffset:0};Gt.positionedLines[us]=hs;const Ks=hs.positionedGlyphs;let fs=0;if(!to.length()){Oi+=Tn,++us;continue}for(let fa=0;fa<to.length();fa++){const mi=to.getSection(fa),Mi=to.getSectionIndex(fa),Fi=to.getCharCode(fa);let Oa=0,Xi=null,ng=null,Lc=null,jc=ko;const Ol=!(Un===l.ah.horizontal||!ar&&!G0(Fi)||ar&&(kw[Fi]||(jo=Fi,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(jo)))));if(mi.imageName){const Ja=_r[mi.imageName];if(!Ja)continue;Lc=mi.imageName,Gt.iconsInText=Gt.iconsInText||!0,ng=Ja.paddedRect;const Xo=Ja.displaySize;mi.scale=mi.scale*ko/tr,Xi={width:Xo[0],height:Xo[1],left:ha,top:-Xk,advance:Ol?Xo[1]:Xo[0]},Oa=Ts+(ko-Xo[1]*mi.scale),jc=Xi.advance;const Ou=Ol?Xo[0]*mi.scale-ko*No:Xo[1]*mi.scale-ko*No;Ou>0&&Ou>fs&&(fs=Ou)}else{const Ja=$n[mi.fontStack],Xo=Ja&&Ja[Fi];if(Xo&&Xo.rect)ng=Xo.rect,Xi=Xo.metrics;else{const Ou=dn[mi.fontStack],pb=Ou&&Ou[Fi];if(!pb)continue;Xi=pb.metrics}Oa=(No-mi.scale)*ko}Ol?(Gt.verticalizable=!0,Ks.push({glyph:Fi,imageName:Lc,x:Dr,y:Oi+Oa,vertical:Ol,scale:mi.scale,fontStack:mi.fontStack,sectionIndex:Mi,metrics:Xi,rect:ng}),Dr+=jc*mi.scale+Qt):(Ks.push({glyph:Fi,imageName:Lc,x:Dr,y:Oi+Oa,vertical:Ol,scale:mi.scale,fontStack:mi.fontStack,sectionIndex:Mi,metrics:Xi,rect:ng}),Dr+=Xi.advance*mi.scale+Qt)}Ks.length!==0&&(Ti=Math.max(Dr-Qt,Ti),dL(Ks,0,Ks.length-1,Tl,fs)),Dr=0;const Ya=Tn*No+fs;hs.lineOffset=Math.max(fs,Ts),Oi+=Ya,Lo=Math.max(Ya,Lo),++us}var jo;const Hs=Oi-ab,{horizontalAlign:Ws,verticalAlign:Gs}=F3(rr);(function(to,No,Ts,hs,Ks,fs,Ya,fa,mi){const Mi=(No-Ts)*Ks;let Fi=0;Fi=fs!==Ya?-fa*hs-ab:(-hs*mi+.5)*Ya;for(const Oa of to)for(const Xi of Oa.positionedGlyphs)Xi.x+=Mi,Xi.y+=Fi})(Gt.positionedLines,Tl,Ws,Gs,Ti,Lo,Tn,Hs,Rn.length),Gt.top+=-Gs*Hs,Gt.bottom=Gt.top+Hs,Gt.left+=-Ws*Ti,Gt.right=Gt.left+Ti}($t,s,d,k,ct,V,K,ne,Te,ue,Ne,Ke),!function(Gt){for(const dn of Gt)if(dn.positionedGlyphs.length!==0)return!1;return!0}(Pt)&&$t}const kw={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},uL={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},hL={40:!0};function Jk(u,s,d,k,I,F){if(s.imageName){const V=k[s.imageName];return V?V.displaySize[0]*s.scale*ko/F+I:0}{const V=d[s.fontStack],K=V&&V[u];return K?K.metrics.advance*s.scale+I:0}}function Qk(u,s,d,k){const I=Math.pow(u-s,2);return k?u<s?I/2:2*I:I+Math.abs(d)*d}function fL(u,s,d){let k=0;return u===10&&(k-=1e4),d&&(k+=150),u!==40&&u!==65288||(k+=50),s!==41&&s!==65289||(k+=50),k}function eP(u,s,d,k,I,F){let V=null,K=Qk(s,d,I,F);for(const ne of k){const ue=Qk(s-ne.x,d,I,F)+ne.badness;ue<=K&&(V=ne,K=ue)}return{index:u,x:s,priorBreak:V,badness:K}}function tP(u){return u?tP(u.priorBreak).concat(u.index):[]}function B3(u,s,d,k,I,F){if(!u)return[];const V=[],K=function(Te,Ne,Ue,Ke,Ze,ct){let mt=0;for(let Bt=0;Bt<Te.length();Bt++){const Pt=Te.getSection(Bt);mt+=Jk(Te.getCharCode(Bt),Pt,Ke,Ze,Ne,ct)}return mt/Math.max(1,Math.ceil(mt/Ue))}(u,s,d,k,I,F),ne=u.text.indexOf("​")>=0;let ue=0;for(let Te=0;Te<u.length();Te++){const Ne=u.getSection(Te),Ue=u.getCharCode(Te);if(kw[Ue]||(ue+=Jk(Ue,Ne,k,I,s,F)),Te<u.length()-1){const Ke=!((xe=Ue)<11904)&&(!!ni["CJK Compatibility Forms"](xe)||!!ni["CJK Compatibility"](xe)||!!ni["CJK Strokes"](xe)||!!ni["CJK Symbols and Punctuation"](xe)||!!ni["Enclosed CJK Letters and Months"](xe)||!!ni["Halfwidth and Fullwidth Forms"](xe)||!!ni["Ideographic Description Characters"](xe)||!!ni["Vertical Forms"](xe)||cw.test(String.fromCodePoint(xe)));(uL[Ue]||Ke||Ne.imageName||Te!==u.length()-2&&hL[u.getCharCode(Te+1)])&&V.push(eP(Te+1,ue,K,V,fL(Ue,u.getCharCode(Te+1),Ke&&ne),!1))}}var xe;return tP(eP(u.length(),ue,K,V,0,!0))}function F3(u){let s=.5,d=.5;switch(u){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:s,verticalAlign:d}}function dL(u,s,d,k,I){if(!k&&!I)return;const F=u[d],V=(u[d].x+F.metrics.advance*F.scale)*k;for(let K=s;K<=d;K++)u[K].x-=V,u[K].y+=I}function pL(u,s,d){const{horizontalAlign:k,verticalAlign:I}=F3(d),F=s[0]-u.displaySize[0]*k,V=s[1]-u.displaySize[1]*I;return{image:u,top:V,bottom:V+u.displaySize[1],left:F,right:F+u.displaySize[0]}}function nP(u){var s,d;let k=u.left,I=u.top,F=u.right-k,V=u.bottom-I;const K=(s=u.image.textFitWidth)!==null&&s!==void 0?s:"stretchOrShrink",ne=(d=u.image.textFitHeight)!==null&&d!==void 0?d:"stretchOrShrink",ue=(u.image.content[2]-u.image.content[0])/(u.image.content[3]-u.image.content[1]);if(ne==="proportional"){if(K==="stretchOnly"&&F/V<ue||K==="proportional"){const xe=Math.ceil(V*ue);k*=xe/F,F=xe}}else if(K==="proportional"&&ne==="stretchOnly"&&ue!==0&&F/V>ue){const xe=Math.ceil(F/ue);I*=xe/V,V=xe}return{x1:k,y1:I,x2:k+F,y2:I+V}}function rP(u,s,d,k,I,F){const V=u.image;let K;if(V.content){const ct=V.content,mt=V.pixelRatio||1;K=[ct[0]/mt,ct[1]/mt,V.displaySize[0]-ct[2]/mt,V.displaySize[1]-ct[3]/mt]}const ne=s.left*F,ue=s.right*F;let xe,Te,Ne,Ue;d==="width"||d==="both"?(Ue=I[0]+ne-k[3],Te=I[0]+ue+k[1]):(Ue=I[0]+(ne+ue-V.displaySize[0])/2,Te=Ue+V.displaySize[0]);const Ke=s.top*F,Ze=s.bottom*F;return d==="height"||d==="both"?(xe=I[1]+Ke-k[0],Ne=I[1]+Ze+k[2]):(xe=I[1]+(Ke+Ze-V.displaySize[1])/2,Ne=xe+V.displaySize[1]),{image:V,top:xe,right:Te,bottom:Ne,left:Ue,collisionPadding:K}}const cb=255,Dc=128,Gh=cb*Dc;function iP(u,s){const{expression:d}=s;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new ji(u+1))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:k,interpolationType:I}=d;let F=0;for(;F<k.length&&k[F]<=u;)F++;F=Math.max(0,F-1);let V=F;for(;V<k.length&&k[V]<u+1;)V++;V=Math.min(k.length-1,V);const K=k[F],ne=k[V];return d.kind==="composite"?{kind:"composite",minZoom:K,maxZoom:ne,interpolationType:I}:{kind:"camera",minZoom:K,maxZoom:ne,minSize:d.evaluate(new ji(K)),maxSize:d.evaluate(new ji(ne)),interpolationType:I}}}function z3(u,s,d){let k="never";const I=u.get(s);return I?k=I:u.get(d)&&(k="always"),k}const mL=Hh.VectorTileFeature.types,gL=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Pw(u,s,d,k,I,F,V,K,ne,ue,xe,Te,Ne){const Ue=K?Math.min(Gh,Math.round(K[0])):0,Ke=K?Math.min(Gh,Math.round(K[1])):0;u.emplaceBack(s,d,Math.round(32*k),Math.round(32*I),F,V,(Ue<<1)+(ne?1:0),Ke,16*ue,16*xe,256*Te,256*Ne)}function U3(u,s,d){u.emplaceBack(s.x,s.y,d),u.emplaceBack(s.x,s.y,d),u.emplaceBack(s.x,s.y,d),u.emplaceBack(s.x,s.y,d)}function yL(u){for(const s of u.sections)if(g3(s.text))return!0;return!1}class V3{constructor(s){this.layoutVertexArray=new zm,this.indexArray=new Ka,this.programConfigurations=s,this.segments=new ri,this.dynamicLayoutVertexArray=new Z0,this.opacityVertexArray=new Pa,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ni}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,d,k,I){this.isEmpty()||(k&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,GD.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,KD.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,gL,!0),this.opacityVertexBuffer.itemSize=1),(k||I)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Vn("SymbolBuffers",V3);class q3{constructor(s,d,k){this.layoutVertexArray=new s,this.layoutAttributes=d,this.indexArray=new k,this.segments=new ri,this.collisionVertexArray=new Ic}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,XD.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Vn("CollisionBuffers",q3);class Qm{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(V=>V.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=S3([]),this.placementViewportMatrix=S3([]);const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=iP(this.zoom,d["text-size"]),this.iconSizeData=iP(this.zoom,d["icon-size"]);const k=this.layers[0].layout,I=k.get("symbol-sort-key"),F=k.get("symbol-z-order");this.canOverlap=z3(k,"text-overlap","text-allow-overlap")!=="never"||z3(k,"icon-overlap","icon-allow-overlap")!=="never"||k.get("text-ignore-placement")||k.get("icon-ignore-placement"),this.sortFeaturesByKey=F!=="viewport-y"&&!I.isConstant(),this.sortFeaturesByY=(F==="viewport-y"||F==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,k.get("symbol-placement")==="point"&&(this.writingModes=k.get("text-writing-mode").map(V=>l.ah[V])),this.stateDependentLayerIds=this.layers.filter(V=>V.isStateDependent()).map(V=>V.id),this.sourceID=s.sourceID}createArrays(){this.text=new V3(new Pd(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new V3(new Pd(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new $i,this.lineVertexArray=new ss,this.symbolInstances=new ti,this.textAnchorOffsets=new Bi}calculateGlyphDependencies(s,d,k,I,F){for(let V=0;V<s.length;V++)if(d[s.charCodeAt(V)]=!0,(k||I)&&F){const K=sb[s.charAt(V)];K&&(d[K.charCodeAt(0)]=!0)}}populate(s,d,k){const I=this.layers[0],F=I.layout,V=F.get("text-font"),K=F.get("text-field"),ne=F.get("icon-image"),ue=(K.value.kind!=="constant"||K.value.value instanceof nn&&!K.value.value.isEmpty()||K.value.value.toString().length>0)&&(V.value.kind!=="constant"||V.value.value.length>0),xe=ne.value.kind!=="constant"||!!ne.value.value||Object.keys(ne.parameters).length>0,Te=F.get("symbol-sort-key");if(this.features=[],!ue&&!xe)return;const Ne=d.iconDependencies,Ue=d.glyphDependencies,Ke=d.availableImages,Ze=new ji(this.zoom);for(const{feature:ct,id:mt,index:Bt,sourceLayerIndex:Pt}of s){const $t=I._featureFilter.needGeometry,Gt=Od(ct,$t);if(!I._featureFilter.filter(Ze,Gt,k))continue;let dn,$n;if($t||(Gt.geometry=Td(ct)),ue){const Rn=I.getValueAndResolveTokens("text-field",Gt,k,Ke),Tn=nn.factory(Rn),rr=this.hasRTLText=this.hasRTLText||yL(Tn);(!rr||ca.getRTLTextPluginStatus()==="unavailable"||rr&&ca.isParsed())&&(dn=YD(Tn,I,Gt))}if(xe){const Rn=I.getValueAndResolveTokens("icon-image",Gt,k,Ke);$n=Rn instanceof On?Rn:On.fromString(Rn)}if(!dn&&!$n)continue;const _r=this.sortFeaturesByKey?Te.evaluate(Gt,{},k):void 0;if(this.features.push({id:mt,text:dn,icon:$n,index:Bt,sourceLayerIndex:Pt,geometry:Gt.geometry,properties:ct.properties,type:mL[ct.type],sortKey:_r}),$n&&(Ne[$n.name]=!0),dn){const Rn=V.evaluate(Gt,{},k).join(","),Tn=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.ah.vertical)>=0;for(const rr of dn.sections)if(rr.image)Ne[rr.image.name]=!0;else{const Hn=H0(dn.toString()),Un=rr.fontStack||Rn,Qt=Ue[Un]=Ue[Un]||{};this.calculateGlyphDependencies(rr.text,Qt,Tn,this.allowVerticalPlacement,Hn)}}}F.get("symbol-placement")==="line"&&(this.features=function(ct){const mt={},Bt={},Pt=[];let $t=0;function Gt(Rn){Pt.push(ct[Rn]),$t++}function dn(Rn,Tn,rr){const Hn=Bt[Rn];return delete Bt[Rn],Bt[Tn]=Hn,Pt[Hn].geometry[0].pop(),Pt[Hn].geometry[0]=Pt[Hn].geometry[0].concat(rr[0]),Hn}function $n(Rn,Tn,rr){const Hn=mt[Tn];return delete mt[Tn],mt[Rn]=Hn,Pt[Hn].geometry[0].shift(),Pt[Hn].geometry[0]=rr[0].concat(Pt[Hn].geometry[0]),Hn}function _r(Rn,Tn,rr){const Hn=rr?Tn[0][Tn[0].length-1]:Tn[0][0];return`${Rn}:${Hn.x}:${Hn.y}`}for(let Rn=0;Rn<ct.length;Rn++){const Tn=ct[Rn],rr=Tn.geometry,Hn=Tn.text?Tn.text.toString():null;if(!Hn){Gt(Rn);continue}const Un=_r(Hn,rr),Qt=_r(Hn,rr,!0);if(Un in Bt&&Qt in mt&&Bt[Un]!==mt[Qt]){const ar=$n(Un,Qt,rr),tr=dn(Un,Qt,Pt[ar].geometry);delete mt[Un],delete Bt[Qt],Bt[_r(Hn,Pt[tr].geometry,!0)]=tr,Pt[ar].geometry=null}else Un in Bt?dn(Un,Qt,rr):Qt in mt?$n(Un,Qt,rr):(Gt(Rn),mt[Un]=$t-1,Bt[Qt]=$t-1)}return Pt.filter(Rn=>Rn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ct,mt)=>ct.sortKey-mt.sortKey)}update(s,d,k){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,d,this.layers,k),this.icon.programConfigurations.updatePaintArrays(s,d,this.layers,k))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,d){const k=this.lineVertexArray.length;if(s.segment!==void 0){let I=s.dist(d[s.segment+1]),F=s.dist(d[s.segment]);const V={};for(let K=s.segment+1;K<d.length;K++)V[K]={x:d[K].x,y:d[K].y,tileUnitDistanceFromAnchor:I},K<d.length-1&&(I+=d[K+1].dist(d[K]));for(let K=s.segment||0;K>=0;K--)V[K]={x:d[K].x,y:d[K].y,tileUnitDistanceFromAnchor:F},K>0&&(F+=d[K-1].dist(d[K]));for(let K=0;K<d.length;K++){const ne=V[K];this.lineVertexArray.emplaceBack(ne.x,ne.y,ne.tileUnitDistanceFromAnchor)}}return{lineStartIndex:k,lineLength:this.lineVertexArray.length-k}}addSymbols(s,d,k,I,F,V,K,ne,ue,xe,Te,Ne){const Ue=s.indexArray,Ke=s.layoutVertexArray,Ze=s.segments.prepareSegment(4*d.length,Ke,Ue,this.canOverlap?V.sortKey:void 0),ct=this.glyphOffsetArray.length,mt=Ze.vertexLength,Bt=this.allowVerticalPlacement&&K===l.ah.vertical?Math.PI/2:0,Pt=V.text&&V.text.sections;for(let $t=0;$t<d.length;$t++){const{tl:Gt,tr:dn,bl:$n,br:_r,tex:Rn,pixelOffsetTL:Tn,pixelOffsetBR:rr,minFontScaleX:Hn,minFontScaleY:Un,glyphOffset:Qt,isSDF:ar,sectionIndex:tr}=d[$t],Dr=Ze.vertexLength,Oi=Qt[1];Pw(Ke,ne.x,ne.y,Gt.x,Oi+Gt.y,Rn.x,Rn.y,k,ar,Tn.x,Tn.y,Hn,Un),Pw(Ke,ne.x,ne.y,dn.x,Oi+dn.y,Rn.x+Rn.w,Rn.y,k,ar,rr.x,Tn.y,Hn,Un),Pw(Ke,ne.x,ne.y,$n.x,Oi+$n.y,Rn.x,Rn.y+Rn.h,k,ar,Tn.x,rr.y,Hn,Un),Pw(Ke,ne.x,ne.y,_r.x,Oi+_r.y,Rn.x+Rn.w,Rn.y+Rn.h,k,ar,rr.x,rr.y,Hn,Un),U3(s.dynamicLayoutVertexArray,ne,Bt),Ue.emplaceBack(Dr,Dr+1,Dr+2),Ue.emplaceBack(Dr+1,Dr+2,Dr+3),Ze.vertexLength+=4,Ze.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Qt[0]),$t!==d.length-1&&tr===d[$t+1].sectionIndex||s.programConfigurations.populatePaintArrays(Ke.length,V,V.index,{},Ne,Pt&&Pt[tr])}s.placedSymbolArray.emplaceBack(ne.x,ne.y,ct,this.glyphOffsetArray.length-ct,mt,ue,xe,ne.segment,k?k[0]:0,k?k[1]:0,I[0],I[1],K,0,!1,0,Te)}_addCollisionDebugVertex(s,d,k,I,F,V){return d.emplaceBack(0,0),s.emplaceBack(k.x,k.y,I,F,Math.round(V.x),Math.round(V.y))}addCollisionDebugVertices(s,d,k,I,F,V,K){const ne=F.segments.prepareSegment(4,F.layoutVertexArray,F.indexArray),ue=ne.vertexLength,xe=F.layoutVertexArray,Te=F.collisionVertexArray,Ne=K.anchorX,Ue=K.anchorY;this._addCollisionDebugVertex(xe,Te,V,Ne,Ue,new g(s,d)),this._addCollisionDebugVertex(xe,Te,V,Ne,Ue,new g(k,d)),this._addCollisionDebugVertex(xe,Te,V,Ne,Ue,new g(k,I)),this._addCollisionDebugVertex(xe,Te,V,Ne,Ue,new g(s,I)),ne.vertexLength+=4;const Ke=F.indexArray;Ke.emplaceBack(ue,ue+1),Ke.emplaceBack(ue+1,ue+2),Ke.emplaceBack(ue+2,ue+3),Ke.emplaceBack(ue+3,ue),ne.primitiveLength+=4}addDebugCollisionBoxes(s,d,k,I){for(let F=s;F<d;F++){const V=this.collisionBoxArray.get(F);this.addCollisionDebugVertices(V.x1,V.y1,V.x2,V.y2,I?this.textCollisionBox:this.iconCollisionBox,V.anchorPoint,k)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new q3(Ta,zk.members,Ko),this.iconCollisionBox=new q3(Ta,zk.members,Ko);for(let s=0;s<this.symbolInstances.length;s++){const d=this.symbolInstances.get(s);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}}_deserializeCollisionBoxesForSymbol(s,d,k,I,F,V,K,ne,ue){const xe={};for(let Te=d;Te<k;Te++){const Ne=s.get(Te);xe.textBox={x1:Ne.x1,y1:Ne.y1,x2:Ne.x2,y2:Ne.y2,anchorPointX:Ne.anchorPointX,anchorPointY:Ne.anchorPointY},xe.textFeatureIndex=Ne.featureIndex;break}for(let Te=I;Te<F;Te++){const Ne=s.get(Te);xe.verticalTextBox={x1:Ne.x1,y1:Ne.y1,x2:Ne.x2,y2:Ne.y2,anchorPointX:Ne.anchorPointX,anchorPointY:Ne.anchorPointY},xe.verticalTextFeatureIndex=Ne.featureIndex;break}for(let Te=V;Te<K;Te++){const Ne=s.get(Te);xe.iconBox={x1:Ne.x1,y1:Ne.y1,x2:Ne.x2,y2:Ne.y2,anchorPointX:Ne.anchorPointX,anchorPointY:Ne.anchorPointY},xe.iconFeatureIndex=Ne.featureIndex;break}for(let Te=ne;Te<ue;Te++){const Ne=s.get(Te);xe.verticalIconBox={x1:Ne.x1,y1:Ne.y1,x2:Ne.x2,y2:Ne.y2,anchorPointX:Ne.anchorPointX,anchorPointY:Ne.anchorPointY},xe.verticalIconFeatureIndex=Ne.featureIndex;break}return xe}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const k=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,k.textBoxStartIndex,k.textBoxEndIndex,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k.iconBoxStartIndex,k.iconBoxEndIndex,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,d){const k=s.placedSymbolArray.get(d),I=k.vertexStartIndex+4*k.numGlyphs;for(let F=k.vertexStartIndex;F<I;F+=4)s.indexArray.emplaceBack(F,F+1,F+2),s.indexArray.emplaceBack(F+1,F+2,F+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const d=Math.sin(s),k=Math.cos(s),I=[],F=[],V=[];for(let K=0;K<this.symbolInstances.length;++K){V.push(K);const ne=this.symbolInstances.get(K);I.push(0|Math.round(d*ne.anchorX+k*ne.anchorY)),F.push(ne.featureIndex)}return V.sort((K,ne)=>I[K]-I[ne]||F[ne]-F[K]),V}addToSortKeyRanges(s,d){const k=this.sortKeyRanges[this.sortKeyRanges.length-1];k&&k.sortKey===d?k.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const k=this.symbolInstances.get(d);this.featureSortOrder.push(k.featureIndex),[k.rightJustifiedTextSymbolIndex,k.centerJustifiedTextSymbolIndex,k.leftJustifiedTextSymbolIndex].forEach((I,F,V)=>{I>=0&&V.indexOf(I)===F&&this.addIndicesForPlacedSymbol(this.text,I)}),k.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,k.verticalPlacedTextSymbolIndex),k.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,k.placedIconSymbolIndex),k.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,k.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let oP,sP;Vn("SymbolBucket",Qm,{omit:["layers","collisionBoxArray","features","compareText"]}),Qm.MAX_GLYPHS=65535,Qm.addDynamicAttributes=U3;var H3={get paint(){return sP=sP||new $({"icon-opacity":new Sr(te.paint_symbol["icon-opacity"]),"icon-color":new Sr(te.paint_symbol["icon-color"]),"icon-halo-color":new Sr(te.paint_symbol["icon-halo-color"]),"icon-halo-width":new Sr(te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Sr(te.paint_symbol["icon-halo-blur"]),"icon-translate":new Yn(te.paint_symbol["icon-translate"]),"icon-translate-anchor":new Yn(te.paint_symbol["icon-translate-anchor"]),"text-opacity":new Sr(te.paint_symbol["text-opacity"]),"text-color":new Sr(te.paint_symbol["text-color"],{runtimeType:dt,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Sr(te.paint_symbol["text-halo-color"]),"text-halo-width":new Sr(te.paint_symbol["text-halo-width"]),"text-halo-blur":new Sr(te.paint_symbol["text-halo-blur"]),"text-translate":new Yn(te.paint_symbol["text-translate"]),"text-translate-anchor":new Yn(te.paint_symbol["text-translate-anchor"])})},get layout(){return oP=oP||new $({"symbol-placement":new Yn(te.layout_symbol["symbol-placement"]),"symbol-spacing":new Yn(te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Yn(te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Sr(te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Yn(te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Yn(te.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Yn(te.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Yn(te.layout_symbol["icon-ignore-placement"]),"icon-optional":new Yn(te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Yn(te.layout_symbol["icon-rotation-alignment"]),"icon-size":new Sr(te.layout_symbol["icon-size"]),"icon-text-fit":new Yn(te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Yn(te.layout_symbol["icon-text-fit-padding"]),"icon-image":new Sr(te.layout_symbol["icon-image"]),"icon-rotate":new Sr(te.layout_symbol["icon-rotate"]),"icon-padding":new Sr(te.layout_symbol["icon-padding"]),"icon-keep-upright":new Yn(te.layout_symbol["icon-keep-upright"]),"icon-offset":new Sr(te.layout_symbol["icon-offset"]),"icon-anchor":new Sr(te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Yn(te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Yn(te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Yn(te.layout_symbol["text-rotation-alignment"]),"text-field":new Sr(te.layout_symbol["text-field"]),"text-font":new Sr(te.layout_symbol["text-font"]),"text-size":new Sr(te.layout_symbol["text-size"]),"text-max-width":new Sr(te.layout_symbol["text-max-width"]),"text-line-height":new Yn(te.layout_symbol["text-line-height"]),"text-letter-spacing":new Sr(te.layout_symbol["text-letter-spacing"]),"text-justify":new Sr(te.layout_symbol["text-justify"]),"text-radial-offset":new Sr(te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Yn(te.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Sr(te.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Sr(te.layout_symbol["text-anchor"]),"text-max-angle":new Yn(te.layout_symbol["text-max-angle"]),"text-writing-mode":new Yn(te.layout_symbol["text-writing-mode"]),"text-rotate":new Sr(te.layout_symbol["text-rotate"]),"text-padding":new Yn(te.layout_symbol["text-padding"]),"text-keep-upright":new Yn(te.layout_symbol["text-keep-upright"]),"text-transform":new Sr(te.layout_symbol["text-transform"]),"text-offset":new Sr(te.layout_symbol["text-offset"]),"text-allow-overlap":new Yn(te.layout_symbol["text-allow-overlap"]),"text-overlap":new Yn(te.layout_symbol["text-overlap"]),"text-ignore-placement":new Yn(te.layout_symbol["text-ignore-placement"]),"text-optional":new Yn(te.layout_symbol["text-optional"])})}};class aP{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:Dn,this.defaultValue=s}evaluate(s){if(s.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(s.formattedSection))return d.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Vn("FormatSectionOverride",aP,{omit:["defaultValue"]});class Tw extends S{constructor(s){super(s,H3)}recalculate(s,d){if(super.recalculate(s,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const k=this.layout.get("text-writing-mode");if(k){const I=[];for(const F of k)I.indexOf(F)<0&&I.push(F);this.layout._values["text-writing-mode"]=I}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,d,k,I){const F=this.layout.get(s).evaluate(d,{},k,I),V=this._unevaluatedLayout._values[s];return V.isDataDriven()||bu(V.value)||!F?F:function(K,ne){return ne.replace(/{([^{}]+)}/g,(ue,xe)=>K&&xe in K?String(K[xe]):"")}(d.properties,F)}createBucket(s){return new Qm(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of H3.paint.overridableProperties){if(!Tw.hasPaintOverride(this.layout,s))continue;const d=this.paint.get(s),k=new aP(d),I=new yu(k,d.property.specification);let F=null;F=d.value.kind==="constant"||d.value.kind==="source"?new Oc("source",I):new Mc("composite",I,d.value.zoomStops),this.paint._values[s]=new kl(d.property,F,d.parameters)}}_handleOverridablePaintPropertyUpdate(s,d,k){return!(!this.layout||d.isDataDriven()||k.isDataDriven())&&Tw.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,d){const k=s.get("text-field"),I=H3.paint.properties[d];let F=!1;const V=K=>{for(const ne of K)if(I.overrides&&I.overrides.hasOverride(ne))return void(F=!0)};if(k.value.kind==="constant"&&k.value.value instanceof nn)V(k.value.value.sections);else if(k.value.kind==="source"){const K=ue=>{F||(ue instanceof Jr&&kr(ue.value)===Xn?V(ue.value.sections):ue instanceof pt?V(ue.sections):ue.eachChild(K))},ne=k.value;ne._styleExpression&&K(ne._styleExpression.expression)}return F}}let lP;var bL={get paint(){return lP=lP||new $({"background-color":new Yn(te.paint_background["background-color"]),"background-pattern":new Bm(te.paint_background["background-pattern"]),"background-opacity":new Yn(te.paint_background["background-opacity"])})}};class vL extends S{constructor(s){super(s,bL)}}let cP;var _L={get paint(){return cP=cP||new $({"raster-opacity":new Yn(te.paint_raster["raster-opacity"]),"raster-hue-rotate":new Yn(te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Yn(te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Yn(te.paint_raster["raster-brightness-max"]),"raster-saturation":new Yn(te.paint_raster["raster-saturation"]),"raster-contrast":new Yn(te.paint_raster["raster-contrast"]),"raster-resampling":new Yn(te.paint_raster["raster-resampling"]),"raster-fade-duration":new Yn(te.paint_raster["raster-fade-duration"])})}};class wL extends S{constructor(s){super(s,_L)}}class xL extends S{constructor(s){super(s,{}),this.onAdd=d=>{this.implementation.onAdd&&this.implementation.onAdd(d,d.painter.context.gl)},this.onRemove=d=>{this.implementation.onRemove&&this.implementation.onRemove(d,d.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class SL{constructor(s){this._methodToThrottle=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const W3=63710088e-1;class Kh{constructor(s,d){if(isNaN(s)||isNaN(d))throw new Error(`Invalid LngLat object: (${s}, ${d})`);if(this.lng=+s,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Kh(T(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const d=Math.PI/180,k=this.lat*d,I=s.lat*d,F=Math.sin(k)*Math.sin(I)+Math.cos(k)*Math.cos(I)*Math.cos((s.lng-this.lng)*d);return W3*Math.acos(Math.min(F,1))}static convert(s){if(s instanceof Kh)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Kh(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Kh(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const uP=2*Math.PI*W3;function hP(u){return uP*Math.cos(u*Math.PI/180)}function fP(u){return(180+u)/360}function dP(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function pP(u,s){return u/hP(s)}function G3(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class ub{constructor(s,d,k=0){this.x=+s,this.y=+d,this.z=+k}static fromLngLat(s,d=0){const k=Kh.convert(s);return new ub(fP(k.lng),dP(k.lat),pP(d,k.lat))}toLngLat(){return new Kh(360*this.x-180,G3(this.y))}toAltitude(){return this.z*hP(G3(this.y))}meterInMercatorCoordinateUnits(){return 1/uP*(s=G3(this.y),1/Math.cos(s*Math.PI/180));var s}}function mP(u,s,d){var k=2*Math.PI*6378137/256/Math.pow(2,d);return[u*k-2*Math.PI*6378137/2,s*k-2*Math.PI*6378137/2]}class K3{constructor(s,d,k){if(!function(I,F,V){return!(I<0||I>25||V<0||V>=Math.pow(2,I)||F<0||F>=Math.pow(2,I))}(s,d,k))throw new Error(`x=${d}, y=${k}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=d,this.y=k,this.key=hb(0,s,s,d,k)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,d,k){const I=(V=this.y,K=this.z,ne=mP(256*(F=this.x),256*(V=Math.pow(2,K)-V-1),K),ue=mP(256*(F+1),256*(V+1),K),ne[0]+","+ne[1]+","+ue[0]+","+ue[1]);var F,V,K,ne,ue;const xe=function(Te,Ne,Ue){let Ke,Ze="";for(let ct=Te;ct>0;ct--)Ke=1<<ct-1,Ze+=(Ne&Ke?1:0)+(Ue&Ke?2:0);return Ze}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(k==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,d>1?"@2x":"").replace(/{quadkey}/g,xe).replace(/{bbox-epsg-3857}/g,I)}isChildOf(s){const d=this.z-s.z;return d>0&&s.x===this.x>>d&&s.y===this.y>>d}getTilePoint(s){const d=Math.pow(2,this.z);return new g((s.x*d-this.x)*vo,(s.y*d-this.y)*vo)}toString(){return`${this.z}/${this.x}/${this.y}`}}class gP{constructor(s,d){this.wrap=s,this.canonical=d,this.key=hb(s,d.z,d.z,d.x,d.y)}}class Za{constructor(s,d,k,I,F){if(s<k)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${k}`);this.overscaledZ=s,this.wrap=d,this.canonical=new K3(k,+I,+F),this.key=hb(d,s,k,I,F)}clone(){return new Za(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-s;return s>this.canonical.z?new Za(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Za(s,this.wrap,s,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(s,d){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const k=this.canonical.z-s;return s>this.canonical.z?hb(this.wrap*+d,s,this.canonical.z,this.canonical.x,this.canonical.y):hb(this.wrap*+d,s,s,this.canonical.x>>k,this.canonical.y>>k)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const d=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>d&&s.canonical.y===this.canonical.y>>d}children(s){if(this.overscaledZ>=s)return[new Za(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,k=2*this.canonical.x,I=2*this.canonical.y;return[new Za(d,this.wrap,d,k,I),new Za(d,this.wrap,d,k+1,I),new Za(d,this.wrap,d,k,I+1),new Za(d,this.wrap,d,k+1,I+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Za(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Za(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new gP(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new ub(s.x-this.wrap,s.y))}}function hb(u,s,d,k,I){(u*=2)<0&&(u=-1*u-1);const F=1<<d;return(F*F*u+F*I+k).toString(36)+d.toString(36)+s.toString(36)}Vn("CanonicalTileID",K3),Vn("OverscaledTileID",Za,{omit:["posMatrix"]});class yP{constructor(s,d,k,I=1,F=1,V=1,K=0){if(this.uid=s,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(k&&!["mapbox","terrarium","custom"].includes(k))return void Q(`"${k}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=d.height;const ne=this.dim=d.height-2;switch(this.data=new Uint32Array(d.data.buffer),k){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=I,this.greenFactor=F,this.blueFactor=V,this.baseShift=K;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let ue=0;ue<ne;ue++)this.data[this._idx(-1,ue)]=this.data[this._idx(0,ue)],this.data[this._idx(ne,ue)]=this.data[this._idx(ne-1,ue)],this.data[this._idx(ue,-1)]=this.data[this._idx(ue,0)],this.data[this._idx(ue,ne)]=this.data[this._idx(ue,ne-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ne,-1)]=this.data[this._idx(ne-1,0)],this.data[this._idx(-1,ne)]=this.data[this._idx(0,ne-1)],this.data[this._idx(ne,ne)]=this.data[this._idx(ne-1,ne-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let ue=0;ue<ne;ue++)for(let xe=0;xe<ne;xe++){const Te=this.get(ue,xe);Te>this.max&&(this.max=Te),Te<this.min&&(this.min=Te)}}get(s,d){const k=new Uint8Array(this.data.buffer),I=4*this._idx(s,d);return this.unpack(k[I],k[I+1],k[I+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,d){if(s<-1||s>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(s+1)}unpack(s,d,k){return s*this.redFactor+d*this.greenFactor+k*this.blueFactor-this.baseShift}getPixels(){return new Xa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,d,k){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let I=d*this.dim,F=d*this.dim+this.dim,V=k*this.dim,K=k*this.dim+this.dim;switch(d){case-1:I=F-1;break;case 1:F=I+1}switch(k){case-1:V=K-1;break;case 1:K=V+1}const ne=-d*this.dim,ue=-k*this.dim;for(let xe=V;xe<K;xe++)for(let Te=I;Te<F;Te++)this.data[this._idx(Te,xe)]=s.data[this._idx(Te+ne,xe+ue)]}}Vn("DEMData",yP);class bP{constructor(s){this._stringToNumber={},this._numberToString=[];for(let d=0;d<s.length;d++){const k=s[d];this._stringToNumber[k]=d,this._numberToString[d]=k}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class vP{constructor(s,d,k,I,F){this.type="Feature",this._vectorTileFeature=s,s._z=d,s._x=k,s._y=I,this.properties=s.properties,this.id=F}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(s[d]=this[d]);return s}}class _P{constructor(s,d){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Dh(vo,16,0),this.grid3D=new Dh(vo,16,0),this.featureIndexArray=new ks,this.promoteId=d}insert(s,d,k,I,F,V){const K=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(k,I,F);const ne=V?this.grid3D:this.grid;for(let ue=0;ue<d.length;ue++){const xe=d[ue],Te=[1/0,1/0,-1/0,-1/0];for(let Ne=0;Ne<xe.length;Ne++){const Ue=xe[Ne];Te[0]=Math.min(Te[0],Ue.x),Te[1]=Math.min(Te[1],Ue.y),Te[2]=Math.max(Te[2],Ue.x),Te[3]=Math.max(Te[3],Ue.y)}Te[0]<vo&&Te[1]<vo&&Te[2]>=0&&Te[3]>=0&&ne.insert(K,Te[0],Te[1],Te[2],Te[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Hh.VectorTile(new j3(this.rawTileData)).layers,this.sourceLayerCoder=new bP(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,d,k,I){this.loadVTLayers();const F=s.params||{},V=vo/s.tileSize/s.scale,K=wu(F.filter),ne=s.queryGeometry,ue=s.queryPadding*V,xe=xP(ne),Te=this.grid.query(xe.minX-ue,xe.minY-ue,xe.maxX+ue,xe.maxY+ue),Ne=xP(s.cameraQueryGeometry),Ue=this.grid3D.query(Ne.minX-ue,Ne.minY-ue,Ne.maxX+ue,Ne.maxY+ue,(ct,mt,Bt,Pt)=>function($t,Gt,dn,$n,_r){for(const Tn of $t)if(Gt<=Tn.x&&dn<=Tn.y&&$n>=Tn.x&&_r>=Tn.y)return!0;const Rn=[new g(Gt,dn),new g(Gt,_r),new g($n,_r),new g($n,dn)];if($t.length>2){for(const Tn of Rn)if(Wm($t,Tn))return!0}for(let Tn=0;Tn<$t.length-1;Tn++)if(rD($t[Tn],$t[Tn+1],Rn))return!0;return!1}(s.cameraQueryGeometry,ct-ue,mt-ue,Bt+ue,Pt+ue));for(const ct of Ue)Te.push(ct);Te.sort(EL);const Ke={};let Ze;for(let ct=0;ct<Te.length;ct++){const mt=Te[ct];if(mt===Ze)continue;Ze=mt;const Bt=this.featureIndexArray.get(mt);let Pt=null;this.loadMatchingFeature(Ke,Bt.bucketIndex,Bt.sourceLayerIndex,Bt.featureIndex,K,F.layers,F.availableImages,d,k,I,($t,Gt,dn)=>(Pt||(Pt=Td($t)),Gt.queryIntersectsFeature(ne,$t,dn,Pt,this.z,s.transform,V,s.pixelPosMatrix)))}return Ke}loadMatchingFeature(s,d,k,I,F,V,K,ne,ue,xe,Te){const Ne=this.bucketLayerIDs[d];if(V&&!function(ct,mt){for(let Bt=0;Bt<ct.length;Bt++)if(mt.indexOf(ct[Bt])>=0)return!0;return!1}(V,Ne))return;const Ue=this.sourceLayerCoder.decode(k),Ke=this.vtLayers[Ue].feature(I);if(F.needGeometry){const ct=Od(Ke,!0);if(!F.filter(new ji(this.tileID.overscaledZ),ct,this.tileID.canonical))return}else if(!F.filter(new ji(this.tileID.overscaledZ),Ke))return;const Ze=this.getId(Ke,Ue);for(let ct=0;ct<Ne.length;ct++){const mt=Ne[ct];if(V&&V.indexOf(mt)<0)continue;const Bt=ne[mt];if(!Bt)continue;let Pt={};Ze&&xe&&(Pt=xe.getState(Bt.sourceLayer||"_geojsonTileLayer",Ze));const $t=R({},ue[mt]);$t.paint=wP($t.paint,Bt.paint,Ke,Pt,K),$t.layout=wP($t.layout,Bt.layout,Ke,Pt,K);const Gt=!Te||Te(Ke,Bt,Pt);if(!Gt)continue;const dn=new vP(Ke,this.z,this.x,this.y,Ze);dn.layer=$t;let $n=s[mt];$n===void 0&&($n=s[mt]=[]),$n.push({featureIndex:I,feature:dn,intersectionZ:Gt})}}lookupSymbolFeatures(s,d,k,I,F,V,K,ne){const ue={};this.loadVTLayers();const xe=wu(F);for(const Te of s)this.loadMatchingFeature(ue,k,I,Te,xe,V,K,ne,d);return ue}hasLayer(s){for(const d of this.bucketLayerIDs)for(const k of d)if(s===k)return!0;return!1}getId(s,d){let k=s.id;return this.promoteId&&(k=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]],typeof k=="boolean"&&(k=Number(k))),k}}function wP(u,s,d,k,I){return L(u,(F,V)=>{const K=s instanceof Ed?s.get(V):null;return K&&K.evaluate?K.evaluate(d,k,I):K})}function xP(u){let s=1/0,d=1/0,k=-1/0,I=-1/0;for(const F of u)s=Math.min(s,F.x),d=Math.min(d,F.y),k=Math.max(k,F.x),I=Math.max(I,F.y);return{minX:s,minY:d,maxX:k,maxY:I}}function EL(u,s){return s-u}function SP(u,s,d,k,I){const F=[];for(let V=0;V<u.length;V++){const K=u[V];let ne;for(let ue=0;ue<K.length-1;ue++){let xe=K[ue],Te=K[ue+1];xe.x<s&&Te.x<s||(xe.x<s?xe=new g(s,xe.y+(s-xe.x)/(Te.x-xe.x)*(Te.y-xe.y))._round():Te.x<s&&(Te=new g(s,xe.y+(s-xe.x)/(Te.x-xe.x)*(Te.y-xe.y))._round()),xe.y<d&&Te.y<d||(xe.y<d?xe=new g(xe.x+(d-xe.y)/(Te.y-xe.y)*(Te.x-xe.x),d)._round():Te.y<d&&(Te=new g(xe.x+(d-xe.y)/(Te.y-xe.y)*(Te.x-xe.x),d)._round()),xe.x>=k&&Te.x>=k||(xe.x>=k?xe=new g(k,xe.y+(k-xe.x)/(Te.x-xe.x)*(Te.y-xe.y))._round():Te.x>=k&&(Te=new g(k,xe.y+(k-xe.x)/(Te.x-xe.x)*(Te.y-xe.y))._round()),xe.y>=I&&Te.y>=I||(xe.y>=I?xe=new g(xe.x+(I-xe.y)/(Te.y-xe.y)*(Te.x-xe.x),I)._round():Te.y>=I&&(Te=new g(xe.x+(I-xe.y)/(Te.y-xe.y)*(Te.x-xe.x),I)._round()),ne&&xe.equals(ne[ne.length-1])||(ne=[xe],F.push(ne)),ne.push(Te)))))}}return F}Vn("FeatureIndex",_P,{omit:["rawTileData","sourceLayerCoder"]});class Xh extends g{constructor(s,d,k,I){super(s,d),this.angle=k,I!==void 0&&(this.segment=I)}clone(){return new Xh(this.x,this.y,this.angle,this.segment)}}function EP(u,s,d,k,I){if(s.segment===void 0||d===0)return!0;let F=s,V=s.segment+1,K=0;for(;K>-d/2;){if(V--,V<0)return!1;K-=u[V].dist(F),F=u[V]}K+=u[V].dist(u[V+1]),V++;const ne=[];let ue=0;for(;K<d/2;){const xe=u[V],Te=u[V+1];if(!Te)return!1;let Ne=u[V-1].angleTo(xe)-xe.angleTo(Te);for(Ne=Math.abs((Ne+3*Math.PI)%(2*Math.PI)-Math.PI),ne.push({distance:K,angleDelta:Ne}),ue+=Ne;K-ne[0].distance>k;)ue-=ne.shift().angleDelta;if(ue>I)return!1;V++,K+=xe.dist(Te)}return!0}function AP(u){let s=0;for(let d=0;d<u.length-1;d++)s+=u[d].dist(u[d+1]);return s}function kP(u,s,d){return u?.6*s*d:0}function PP(u,s){return Math.max(u?u.right-u.left:0,s?s.right-s.left:0)}function AL(u,s,d,k,I,F){const V=kP(d,I,F),K=PP(d,k)*F;let ne=0;const ue=AP(u)/2;for(let xe=0;xe<u.length-1;xe++){const Te=u[xe],Ne=u[xe+1],Ue=Te.dist(Ne);if(ne+Ue>ue){const Ke=(ue-ne)/Ue,Ze=Wi.number(Te.x,Ne.x,Ke),ct=Wi.number(Te.y,Ne.y,Ke),mt=new Xh(Ze,ct,Ne.angleTo(Te),xe);return mt._round(),!V||EP(u,mt,K,V,s)?mt:void 0}ne+=Ue}}function kL(u,s,d,k,I,F,V,K,ne){const ue=kP(k,F,V),xe=PP(k,I),Te=xe*V,Ne=u[0].x===0||u[0].x===ne||u[0].y===0||u[0].y===ne;return s-Te<s/4&&(s=Te+s/4),TP(u,Ne?s/2*K%s:(xe/2+2*F)*V*K%s,s,ue,d,Te,Ne,!1,ne)}function TP(u,s,d,k,I,F,V,K,ne){const ue=F/2,xe=AP(u);let Te=0,Ne=s-d,Ue=[];for(let Ke=0;Ke<u.length-1;Ke++){const Ze=u[Ke],ct=u[Ke+1],mt=Ze.dist(ct),Bt=ct.angleTo(Ze);for(;Ne+d<Te+mt;){Ne+=d;const Pt=(Ne-Te)/mt,$t=Wi.number(Ze.x,ct.x,Pt),Gt=Wi.number(Ze.y,ct.y,Pt);if($t>=0&&$t<ne&&Gt>=0&&Gt<ne&&Ne-ue>=0&&Ne+ue<=xe){const dn=new Xh($t,Gt,Bt,Ke);dn._round(),k&&!EP(u,dn,F,k,I)||Ue.push(dn)}}Te+=mt}return K||Ue.length||V||(Ue=TP(u,Te/2,d,k,I,F,V,!0,ne)),Ue}Vn("Anchor",Xh);const eg=ha;function OP(u,s,d,k){const I=[],F=u.image,V=F.pixelRatio,K=F.paddedRect.w-2*eg,ne=F.paddedRect.h-2*eg;let ue={x1:u.left,y1:u.top,x2:u.right,y2:u.bottom};const xe=F.stretchX||[[0,K]],Te=F.stretchY||[[0,ne]],Ne=(Qt,ar)=>Qt+ar[1]-ar[0],Ue=xe.reduce(Ne,0),Ke=Te.reduce(Ne,0),Ze=K-Ue,ct=ne-Ke;let mt=0,Bt=Ue,Pt=0,$t=Ke,Gt=0,dn=Ze,$n=0,_r=ct;if(F.content&&k){const Qt=F.content,ar=Qt[2]-Qt[0],tr=Qt[3]-Qt[1];(F.textFitWidth||F.textFitHeight)&&(ue=nP(u)),mt=Ow(xe,0,Qt[0]),Pt=Ow(Te,0,Qt[1]),Bt=Ow(xe,Qt[0],Qt[2]),$t=Ow(Te,Qt[1],Qt[3]),Gt=Qt[0]-mt,$n=Qt[1]-Pt,dn=ar-Bt,_r=tr-$t}const Rn=ue.x1,Tn=ue.y1,rr=ue.x2-Rn,Hn=ue.y2-Tn,Un=(Qt,ar,tr,Dr)=>{const Oi=Mw(Qt.stretch-mt,Bt,rr,Rn),Ti=Cw(Qt.fixed-Gt,dn,Qt.stretch,Ue),Lo=Mw(ar.stretch-Pt,$t,Hn,Tn),Tl=Cw(ar.fixed-$n,_r,ar.stretch,Ke),us=Mw(tr.stretch-mt,Bt,rr,Rn),jo=Cw(tr.fixed-Gt,dn,tr.stretch,Ue),Hs=Mw(Dr.stretch-Pt,$t,Hn,Tn),Ws=Cw(Dr.fixed-$n,_r,Dr.stretch,Ke),Gs=new g(Oi,Lo),to=new g(us,Lo),No=new g(us,Hs),Ts=new g(Oi,Hs),hs=new g(Ti/V,Tl/V),Ks=new g(jo/V,Ws/V),fs=s*Math.PI/180;if(fs){const mi=Math.sin(fs),Mi=Math.cos(fs),Fi=[Mi,-mi,mi,Mi];Gs._matMult(Fi),to._matMult(Fi),Ts._matMult(Fi),No._matMult(Fi)}const Ya=Qt.stretch+Qt.fixed,fa=ar.stretch+ar.fixed;return{tl:Gs,tr:to,bl:Ts,br:No,tex:{x:F.paddedRect.x+eg+Ya,y:F.paddedRect.y+eg+fa,w:tr.stretch+tr.fixed-Ya,h:Dr.stretch+Dr.fixed-fa},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:hs,pixelOffsetBR:Ks,minFontScaleX:dn/V/rr,minFontScaleY:_r/V/Hn,isSDF:d}};if(k&&(F.stretchX||F.stretchY)){const Qt=MP(xe,Ze,Ue),ar=MP(Te,ct,Ke);for(let tr=0;tr<Qt.length-1;tr++){const Dr=Qt[tr],Oi=Qt[tr+1];for(let Ti=0;Ti<ar.length-1;Ti++)I.push(Un(Dr,ar[Ti],Oi,ar[Ti+1]))}}else I.push(Un({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:K+1},{fixed:0,stretch:ne+1}));return I}function Ow(u,s,d){let k=0;for(const I of u)k+=Math.max(s,Math.min(d,I[1]))-Math.max(s,Math.min(d,I[0]));return k}function MP(u,s,d){const k=[{fixed:-eg,stretch:0}];for(const[I,F]of u){const V=k[k.length-1];k.push({fixed:I-V.stretch,stretch:V.stretch}),k.push({fixed:I-V.stretch,stretch:V.stretch+(F-I)})}return k.push({fixed:s+eg,stretch:d}),k}function Mw(u,s,d,k){return u/s*d+k}function Cw(u,s,d,k){return u-s*d/k}class Iw{constructor(s,d,k,I,F,V,K,ne,ue,xe){var Te;if(this.boxStartIndex=s.length,ue){let Ne=V.top,Ue=V.bottom;const Ke=V.collisionPadding;Ke&&(Ne-=Ke[1],Ue+=Ke[3]);let Ze=Ue-Ne;Ze>0&&(Ze=Math.max(10,Ze),this.circleDiameter=Ze)}else{const Ne=!((Te=V.image)===null||Te===void 0)&&Te.content&&(V.image.textFitWidth||V.image.textFitHeight)?nP(V):{x1:V.left,y1:V.top,x2:V.right,y2:V.bottom};Ne.y1=Ne.y1*K-ne[0],Ne.y2=Ne.y2*K+ne[2],Ne.x1=Ne.x1*K-ne[3],Ne.x2=Ne.x2*K+ne[1];const Ue=V.collisionPadding;if(Ue&&(Ne.x1-=Ue[0]*K,Ne.y1-=Ue[1]*K,Ne.x2+=Ue[2]*K,Ne.y2+=Ue[3]*K),xe){const Ke=new g(Ne.x1,Ne.y1),Ze=new g(Ne.x2,Ne.y1),ct=new g(Ne.x1,Ne.y2),mt=new g(Ne.x2,Ne.y2),Bt=xe*Math.PI/180;Ke._rotate(Bt),Ze._rotate(Bt),ct._rotate(Bt),mt._rotate(Bt),Ne.x1=Math.min(Ke.x,Ze.x,ct.x,mt.x),Ne.x2=Math.max(Ke.x,Ze.x,ct.x,mt.x),Ne.y1=Math.min(Ke.y,Ze.y,ct.y,mt.y),Ne.y2=Math.max(Ke.y,Ze.y,ct.y,mt.y)}s.emplaceBack(d.x,d.y,Ne.x1,Ne.y1,Ne.x2,Ne.y2,k,I,F)}this.boxEndIndex=s.length}}class PL{constructor(s=[],d=(k,I)=>k<I?-1:k>I?1:0){if(this.data=s,this.length=this.data.length,this.compare=d,this.length>0)for(let k=(this.length>>1)-1;k>=0;k--)this._down(k)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],d=this.data.pop();return--this.length>0&&(this.data[0]=d,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:d,compare:k}=this,I=d[s];for(;s>0;){const F=s-1>>1,V=d[F];if(k(I,V)>=0)break;d[s]=V,s=F}d[s]=I}_down(s){const{data:d,compare:k}=this,I=this.length>>1,F=d[s];for(;s<I;){let V=1+(s<<1);const K=V+1;if(K<this.length&&k(d[K],d[V])<0&&(V=K),k(d[V],F)>=0)break;d[s]=d[V],s=V}d[s]=F}}function TL(u,s=1,d=!1){let k=1/0,I=1/0,F=-1/0,V=-1/0;const K=u[0];for(let Ue=0;Ue<K.length;Ue++){const Ke=K[Ue];(!Ue||Ke.x<k)&&(k=Ke.x),(!Ue||Ke.y<I)&&(I=Ke.y),(!Ue||Ke.x>F)&&(F=Ke.x),(!Ue||Ke.y>V)&&(V=Ke.y)}const ne=Math.min(F-k,V-I);let ue=ne/2;const xe=new PL([],OL);if(ne===0)return new g(k,I);for(let Ue=k;Ue<F;Ue+=ne)for(let Ke=I;Ke<V;Ke+=ne)xe.push(new tg(Ue+ue,Ke+ue,ue,u));let Te=function(Ue){let Ke=0,Ze=0,ct=0;const mt=Ue[0];for(let Bt=0,Pt=mt.length,$t=Pt-1;Bt<Pt;$t=Bt++){const Gt=mt[Bt],dn=mt[$t],$n=Gt.x*dn.y-dn.x*Gt.y;Ze+=(Gt.x+dn.x)*$n,ct+=(Gt.y+dn.y)*$n,Ke+=3*$n}return new tg(Ze/Ke,ct/Ke,0,Ue)}(u),Ne=xe.length;for(;xe.length;){const Ue=xe.pop();(Ue.d>Te.d||!Te.d)&&(Te=Ue,d&&console.log("found best %d after %d probes",Math.round(1e4*Ue.d)/1e4,Ne)),Ue.max-Te.d<=s||(ue=Ue.h/2,xe.push(new tg(Ue.p.x-ue,Ue.p.y-ue,ue,u)),xe.push(new tg(Ue.p.x+ue,Ue.p.y-ue,ue,u)),xe.push(new tg(Ue.p.x-ue,Ue.p.y+ue,ue,u)),xe.push(new tg(Ue.p.x+ue,Ue.p.y+ue,ue,u)),Ne+=4)}return d&&(console.log(`num probes: ${Ne}`),console.log(`best distance: ${Te.d}`)),Te.p}function OL(u,s){return s.max-u.max}function tg(u,s,d,k){this.p=new g(u,s),this.h=d,this.d=function(I,F){let V=!1,K=1/0;for(let ne=0;ne<F.length;ne++){const ue=F[ne];for(let xe=0,Te=ue.length,Ne=Te-1;xe<Te;Ne=xe++){const Ue=ue[xe],Ke=ue[Ne];Ue.y>I.y!=Ke.y>I.y&&I.x<(Ke.x-Ue.x)*(I.y-Ue.y)/(Ke.y-Ue.y)+Ue.x&&(V=!V),K=Math.min(K,dk(I,Ue,Ke))}}return(V?1:-1)*Math.sqrt(K)}(this.p,k),this.max=this.d+this.h*Math.SQRT2}var cs;l.aq=void 0,(cs=l.aq||(l.aq={}))[cs.center=1]="center",cs[cs.left=2]="left",cs[cs.right=3]="right",cs[cs.top=4]="top",cs[cs.bottom=5]="bottom",cs[cs["top-left"]=6]="top-left",cs[cs["top-right"]=7]="top-right",cs[cs["bottom-left"]=8]="bottom-left",cs[cs["bottom-right"]=9]="bottom-right";const Zh=7,X3=Number.POSITIVE_INFINITY;function CP(u,s){return s[1]!==X3?function(d,k,I){let F=0,V=0;switch(k=Math.abs(k),I=Math.abs(I),d){case"top-right":case"top-left":case"top":V=I-Zh;break;case"bottom-right":case"bottom-left":case"bottom":V=-I+Zh}switch(d){case"top-right":case"bottom-right":case"right":F=-k;break;case"top-left":case"bottom-left":case"left":F=k}return[F,V]}(u,s[0],s[1]):function(d,k){let I=0,F=0;k<0&&(k=0);const V=k/Math.SQRT2;switch(d){case"top-right":case"top-left":F=V-Zh;break;case"bottom-right":case"bottom-left":F=-V+Zh;break;case"bottom":F=-k+Zh;break;case"top":F=k-Zh}switch(d){case"top-right":case"bottom-right":I=-V;break;case"top-left":case"bottom-left":I=V;break;case"left":I=k;break;case"right":I=-k}return[I,F]}(u,s[0])}function IP(u,s,d){var k;const I=u.layout,F=(k=I.get("text-variable-anchor-offset"))===null||k===void 0?void 0:k.evaluate(s,{},d);if(F){const K=F.values,ne=[];for(let ue=0;ue<K.length;ue+=2){const xe=ne[ue]=K[ue],Te=K[ue+1].map(Ne=>Ne*ko);xe.startsWith("top")?Te[1]-=Zh:xe.startsWith("bottom")&&(Te[1]+=Zh),ne[ue+1]=Te}return new ir(ne)}const V=I.get("text-variable-anchor");if(V){let K;K=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[I.get("text-radial-offset").evaluate(s,{},d)*ko,X3]:I.get("text-offset").evaluate(s,{},d).map(ue=>ue*ko);const ne=[];for(const ue of V)ne.push(ue,CP(ue,K));return new ir(ne)}return null}function Z3(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ML(u,s,d,k,I,F,V,K,ne,ue,xe){let Te=F.textMaxSize.evaluate(s,{});Te===void 0&&(Te=V);const Ne=u.layers[0].layout,Ue=Ne.get("icon-offset").evaluate(s,{},xe),Ke=DP(d.horizontal),Ze=V/24,ct=u.tilePixelRatio*Ze,mt=u.tilePixelRatio*Te/24,Bt=u.tilePixelRatio*K,Pt=u.tilePixelRatio*Ne.get("symbol-spacing"),$t=Ne.get("text-padding")*u.tilePixelRatio,Gt=function(Qt,ar,tr,Dr=1){const Oi=Qt.get("icon-padding").evaluate(ar,{},tr),Ti=Oi&&Oi.values;return[Ti[0]*Dr,Ti[1]*Dr,Ti[2]*Dr,Ti[3]*Dr]}(Ne,s,xe,u.tilePixelRatio),dn=Ne.get("text-max-angle")/180*Math.PI,$n=Ne.get("text-rotation-alignment")!=="viewport"&&Ne.get("symbol-placement")!=="point",_r=Ne.get("icon-rotation-alignment")==="map"&&Ne.get("symbol-placement")!=="point",Rn=Ne.get("symbol-placement"),Tn=Pt/2,rr=Ne.get("icon-text-fit");let Hn;k&&rr!=="none"&&(u.allowVerticalPlacement&&d.vertical&&(Hn=rP(k,d.vertical,rr,Ne.get("icon-text-fit-padding"),Ue,Ze)),Ke&&(k=rP(k,Ke,rr,Ne.get("icon-text-fit-padding"),Ue,Ze)));const Un=(Qt,ar)=>{ar.x<0||ar.x>=vo||ar.y<0||ar.y>=vo||function(tr,Dr,Oi,Ti,Lo,Tl,us,jo,Hs,Ws,Gs,to,No,Ts,hs,Ks,fs,Ya,fa,mi,Mi,Fi,Oa,Xi,ng){const Lc=tr.addToLineVertexArray(Dr,Oi);let jc,Ol,Ja,Xo,Ou=0,pb=0,$P=0,BP=0,iA=-1,oA=-1;const Mu={};let FP=Um("");if(tr.allowVerticalPlacement&&Ti.vertical){const Os=jo.layout.get("text-rotate").evaluate(Mi,{},Xi)+90;Ja=new Iw(Hs,Dr,Ws,Gs,to,Ti.vertical,No,Ts,hs,Os),us&&(Xo=new Iw(Hs,Dr,Ws,Gs,to,us,fs,Ya,hs,Os))}if(Lo){const Os=jo.layout.get("icon-rotate").evaluate(Mi,{}),Qa=jo.layout.get("icon-text-fit")!=="none",Cd=OP(Lo,Os,Oa,Qa),ec=us?OP(us,Os,Oa,Qa):void 0;Ol=new Iw(Hs,Dr,Ws,Gs,to,Lo,fs,Ya,!1,Os),Ou=4*Cd.length;const Id=tr.iconSizeData;let Nc=null;Id.kind==="source"?(Nc=[Dc*jo.layout.get("icon-size").evaluate(Mi,{})],Nc[0]>Gh&&Q(`${tr.layerIds[0]}: Value for "icon-size" is >= ${cb}. Reduce your "icon-size".`)):Id.kind==="composite"&&(Nc=[Dc*Fi.compositeIconSizes[0].evaluate(Mi,{},Xi),Dc*Fi.compositeIconSizes[1].evaluate(Mi,{},Xi)],(Nc[0]>Gh||Nc[1]>Gh)&&Q(`${tr.layerIds[0]}: Value for "icon-size" is >= ${cb}. Reduce your "icon-size".`)),tr.addSymbols(tr.icon,Cd,Nc,mi,fa,Mi,l.ah.none,Dr,Lc.lineStartIndex,Lc.lineLength,-1,Xi),iA=tr.icon.placedSymbolArray.length-1,ec&&(pb=4*ec.length,tr.addSymbols(tr.icon,ec,Nc,mi,fa,Mi,l.ah.vertical,Dr,Lc.lineStartIndex,Lc.lineLength,-1,Xi),oA=tr.icon.placedSymbolArray.length-1)}const zP=Object.keys(Ti.horizontal);for(const Os of zP){const Qa=Ti.horizontal[Os];if(!jc){FP=Um(Qa.text);const ec=jo.layout.get("text-rotate").evaluate(Mi,{},Xi);jc=new Iw(Hs,Dr,Ws,Gs,to,Qa,No,Ts,hs,ec)}const Cd=Qa.positionedLines.length===1;if($P+=RP(tr,Dr,Qa,Tl,jo,hs,Mi,Ks,Lc,Ti.vertical?l.ah.horizontal:l.ah.horizontalOnly,Cd?zP:[Os],Mu,iA,Fi,Xi),Cd)break}Ti.vertical&&(BP+=RP(tr,Dr,Ti.vertical,Tl,jo,hs,Mi,Ks,Lc,l.ah.vertical,["vertical"],Mu,oA,Fi,Xi));const RL=jc?jc.boxStartIndex:tr.collisionBoxArray.length,DL=jc?jc.boxEndIndex:tr.collisionBoxArray.length,LL=Ja?Ja.boxStartIndex:tr.collisionBoxArray.length,jL=Ja?Ja.boxEndIndex:tr.collisionBoxArray.length,NL=Ol?Ol.boxStartIndex:tr.collisionBoxArray.length,$L=Ol?Ol.boxEndIndex:tr.collisionBoxArray.length,BL=Xo?Xo.boxStartIndex:tr.collisionBoxArray.length,FL=Xo?Xo.boxEndIndex:tr.collisionBoxArray.length;let Ql=-1;const Dw=(Os,Qa)=>Os&&Os.circleDiameter?Math.max(Os.circleDiameter,Qa):Qa;Ql=Dw(jc,Ql),Ql=Dw(Ja,Ql),Ql=Dw(Ol,Ql),Ql=Dw(Xo,Ql);const UP=Ql>-1?1:0;UP&&(Ql*=ng/ko),tr.glyphOffsetArray.length>=Qm.MAX_GLYPHS&&Q("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mi.sortKey!==void 0&&tr.addToSortKeyRanges(tr.symbolInstances.length,Mi.sortKey);const zL=IP(jo,Mi,Xi),[UL,VL]=function(Os,Qa){const Cd=Os.length,ec=Qa==null?void 0:Qa.values;if((ec==null?void 0:ec.length)>0)for(let Id=0;Id<ec.length;Id+=2){const Nc=ec[Id+1];Os.emplaceBack(l.aq[ec[Id]],Nc[0],Nc[1])}return[Cd,Os.length]}(tr.textAnchorOffsets,zL);tr.symbolInstances.emplaceBack(Dr.x,Dr.y,Mu.right>=0?Mu.right:-1,Mu.center>=0?Mu.center:-1,Mu.left>=0?Mu.left:-1,Mu.vertical||-1,iA,oA,FP,RL,DL,LL,jL,NL,$L,BL,FL,Ws,$P,BP,Ou,pb,UP,0,No,Ql,UL,VL)}(u,ar,Qt,d,k,I,Hn,u.layers[0],u.collisionBoxArray,s.index,s.sourceLayerIndex,u.index,ct,[$t,$t,$t,$t],$n,ne,Bt,Gt,_r,Ue,s,F,ue,xe,V)};if(Rn==="line")for(const Qt of SP(s.geometry,0,0,vo,vo)){const ar=kL(Qt,Pt,dn,d.vertical||Ke,k,24,mt,u.overscaling,vo);for(const tr of ar)Ke&&CL(u,Ke.text,Tn,tr)||Un(Qt,tr)}else if(Rn==="line-center"){for(const Qt of s.geometry)if(Qt.length>1){const ar=AL(Qt,dn,d.vertical||Ke,k,24,mt);ar&&Un(Qt,ar)}}else if(s.type==="Polygon")for(const Qt of yn(s.geometry,0)){const ar=TL(Qt,16);Un(Qt[0],new Xh(ar.x,ar.y,0))}else if(s.type==="LineString")for(const Qt of s.geometry)Un(Qt,new Xh(Qt[0].x,Qt[0].y,0));else if(s.type==="Point")for(const Qt of s.geometry)for(const ar of Qt)Un([ar],new Xh(ar.x,ar.y,0))}function RP(u,s,d,k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke){const Ze=function(Bt,Pt,$t,Gt,dn,$n,_r,Rn){const Tn=Gt.layout.get("text-rotate").evaluate($n,{})*Math.PI/180,rr=[];for(const Hn of Pt.positionedLines)for(const Un of Hn.positionedGlyphs){if(!Un.rect)continue;const Qt=Un.rect||{};let ar=Xk+1,tr=!0,Dr=1,Oi=0;const Ti=(dn||Rn)&&Un.vertical,Lo=Un.metrics.advance*Un.scale/2;if(Rn&&Pt.verticalizable&&(Oi=Hn.lineOffset/2-(Un.imageName?-(ko-Un.metrics.width*Un.scale)/2:(Un.scale-1)*ko)),Un.imageName){const mi=_r[Un.imageName];tr=mi.sdf,Dr=mi.pixelRatio,ar=ha/Dr}const Tl=dn?[Un.x+Lo,Un.y]:[0,0];let us=dn?[0,0]:[Un.x+Lo+$t[0],Un.y+$t[1]-Oi],jo=[0,0];Ti&&(jo=us,us=[0,0]);const Hs=Un.metrics.isDoubleResolution?2:1,Ws=(Un.metrics.left-ar)*Un.scale-Lo+us[0],Gs=(-Un.metrics.top-ar)*Un.scale+us[1],to=Ws+Qt.w/Hs*Un.scale/Dr,No=Gs+Qt.h/Hs*Un.scale/Dr,Ts=new g(Ws,Gs),hs=new g(to,Gs),Ks=new g(Ws,No),fs=new g(to,No);if(Ti){const mi=new g(-Lo,Lo-ab),Mi=-Math.PI/2,Fi=ko/2-Lo,Oa=new g(5-ab-Fi,-(Un.imageName?Fi:0)),Xi=new g(...jo);Ts._rotateAround(Mi,mi)._add(Oa)._add(Xi),hs._rotateAround(Mi,mi)._add(Oa)._add(Xi),Ks._rotateAround(Mi,mi)._add(Oa)._add(Xi),fs._rotateAround(Mi,mi)._add(Oa)._add(Xi)}if(Tn){const mi=Math.sin(Tn),Mi=Math.cos(Tn),Fi=[Mi,-mi,mi,Mi];Ts._matMult(Fi),hs._matMult(Fi),Ks._matMult(Fi),fs._matMult(Fi)}const Ya=new g(0,0),fa=new g(0,0);rr.push({tl:Ts,tr:hs,bl:Ks,br:fs,tex:Qt,writingMode:Pt.writingMode,glyphOffset:Tl,sectionIndex:Un.sectionIndex,isSDF:tr,pixelOffsetTL:Ya,pixelOffsetBR:fa,minFontScaleX:0,minFontScaleY:0})}return rr}(0,d,K,I,F,V,k,u.allowVerticalPlacement),ct=u.textSizeData;let mt=null;ct.kind==="source"?(mt=[Dc*I.layout.get("text-size").evaluate(V,{})],mt[0]>Gh&&Q(`${u.layerIds[0]}: Value for "text-size" is >= ${cb}. Reduce your "text-size".`)):ct.kind==="composite"&&(mt=[Dc*Ue.compositeTextSizes[0].evaluate(V,{},Ke),Dc*Ue.compositeTextSizes[1].evaluate(V,{},Ke)],(mt[0]>Gh||mt[1]>Gh)&&Q(`${u.layerIds[0]}: Value for "text-size" is >= ${cb}. Reduce your "text-size".`)),u.addSymbols(u.text,Ze,mt,K,F,V,ue,s,ne.lineStartIndex,ne.lineLength,Ne,Ke);for(const Bt of xe)Te[Bt]=u.text.placedSymbolArray.length-1;return 4*Ze.length}function DP(u){for(const s in u)return u[s];return null}function CL(u,s,d,k){const I=u.compareText;if(s in I){const F=I[s];for(let V=F.length-1;V>=0;V--)if(k.dist(F[V])<d)return!0}else I[s]=[];return I[s].push(k),!1}const LP=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Y3{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[d,k]=new Uint8Array(s,0,2);if(d!==219)throw new Error("Data does not appear to be in a KDBush format.");const I=k>>4;if(I!==1)throw new Error(`Got v${I} data when expected v1.`);const F=LP[15&k];if(!F)throw new Error("Unrecognized array type.");const[V]=new Uint16Array(s,2,1),[K]=new Uint32Array(s,4,1);return new Y3(K,V,F,s)}constructor(s,d=64,k=Float64Array,I){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+d,2),65535),this.ArrayType=k,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const F=LP.indexOf(this.ArrayType),V=2*s*this.ArrayType.BYTES_PER_ELEMENT,K=s*this.IndexArrayType.BYTES_PER_ELEMENT,ne=(8-K%8)%8;if(F<0)throw new Error(`Unexpected typed array class: ${k}.`);I&&I instanceof ArrayBuffer?(this.data=I,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+K+ne,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+V+K+ne),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+K+ne,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+F]),new Uint16Array(this.data,2,1)[0]=d,new Uint32Array(this.data,4,1)[0]=s)}add(s,d){const k=this._pos>>1;return this.ids[k]=k,this.coords[this._pos++]=s,this.coords[this._pos++]=d,k}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return J3(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,d,k,I){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:F,coords:V,nodeSize:K}=this,ne=[0,F.length-1,0],ue=[];for(;ne.length;){const xe=ne.pop()||0,Te=ne.pop()||0,Ne=ne.pop()||0;if(Te-Ne<=K){for(let ct=Ne;ct<=Te;ct++){const mt=V[2*ct],Bt=V[2*ct+1];mt>=s&&mt<=k&&Bt>=d&&Bt<=I&&ue.push(F[ct])}continue}const Ue=Ne+Te>>1,Ke=V[2*Ue],Ze=V[2*Ue+1];Ke>=s&&Ke<=k&&Ze>=d&&Ze<=I&&ue.push(F[Ue]),(xe===0?s<=Ke:d<=Ze)&&(ne.push(Ne),ne.push(Ue-1),ne.push(1-xe)),(xe===0?k>=Ke:I>=Ze)&&(ne.push(Ue+1),ne.push(Te),ne.push(1-xe))}return ue}within(s,d,k){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:I,coords:F,nodeSize:V}=this,K=[0,I.length-1,0],ne=[],ue=k*k;for(;K.length;){const xe=K.pop()||0,Te=K.pop()||0,Ne=K.pop()||0;if(Te-Ne<=V){for(let ct=Ne;ct<=Te;ct++)NP(F[2*ct],F[2*ct+1],s,d)<=ue&&ne.push(I[ct]);continue}const Ue=Ne+Te>>1,Ke=F[2*Ue],Ze=F[2*Ue+1];NP(Ke,Ze,s,d)<=ue&&ne.push(I[Ue]),(xe===0?s-k<=Ke:d-k<=Ze)&&(K.push(Ne),K.push(Ue-1),K.push(1-xe)),(xe===0?s+k>=Ke:d+k>=Ze)&&(K.push(Ue+1),K.push(Te),K.push(1-xe))}return ne}}function J3(u,s,d,k,I,F){if(I-k<=d)return;const V=k+I>>1;jP(u,s,V,k,I,F),J3(u,s,d,k,V-1,1-F),J3(u,s,d,V+1,I,1-F)}function jP(u,s,d,k,I,F){for(;I>k;){if(I-k>600){const ue=I-k+1,xe=d-k+1,Te=Math.log(ue),Ne=.5*Math.exp(2*Te/3),Ue=.5*Math.sqrt(Te*Ne*(ue-Ne)/ue)*(xe-ue/2<0?-1:1);jP(u,s,d,Math.max(k,Math.floor(d-xe*Ne/ue+Ue)),Math.min(I,Math.floor(d+(ue-xe)*Ne/ue+Ue)),F)}const V=s[2*d+F];let K=k,ne=I;for(fb(u,s,k,d),s[2*I+F]>V&&fb(u,s,k,I);K<ne;){for(fb(u,s,K,ne),K++,ne--;s[2*K+F]<V;)K++;for(;s[2*ne+F]>V;)ne--}s[2*k+F]===V?fb(u,s,k,ne):(ne++,fb(u,s,ne,I)),ne<=d&&(k=ne+1),d<=ne&&(I=ne-1)}}function fb(u,s,d,k){Q3(u,d,k),Q3(s,2*d,2*k),Q3(s,2*d+1,2*k+1)}function Q3(u,s,d){const k=u[s];u[s]=u[d],u[d]=k}function NP(u,s,d,k){const I=u-d,F=s-k;return I*I+F*F}var eA;l.bg=void 0,(eA=l.bg||(l.bg={})).create="create",eA.load="load",eA.fullLoad="fullLoad";let Rw=null,db=[];const tA=1e3/60,nA="loadTime",rA="fullLoadTime",IL={mark(u){performance.mark(u)},frame(u){const s=u;Rw!=null&&db.push(s-Rw),Rw=s},clearMetrics(){Rw=null,db=[],performance.clearMeasures(nA),performance.clearMeasures(rA);for(const u in l.bg)performance.clearMarks(l.bg[u])},getPerformanceMetrics(){performance.measure(nA,l.bg.create,l.bg.load),performance.measure(rA,l.bg.create,l.bg.fullLoad);const u=performance.getEntriesByName(nA)[0].duration,s=performance.getEntriesByName(rA)[0].duration,d=db.length,k=1/(db.reduce((F,V)=>F+V,0)/d/1e3),I=db.filter(F=>F>tA).reduce((F,V)=>F+(V-tA)/tA,0);return{loadTime:u,fullLoadTime:s,fps:k,percentDroppedFrames:I/(d+I)*100,totalFrames:d}}};l.$=class extends Me{},l.A=Gm,l.B=h3,l.C=function(u){if(de==null){const s=u.navigator?u.navigator.userAgent:null;de=!!u.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return de},l.D=Yn,l.E=_e,l.F=class{constructor(u,s){this.target=u,this.mapId=s,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new SL(()=>this.process()),this.subscription=function(d,k,I,F){return d.addEventListener(k,I,!1),{unsubscribe:()=>{d.removeEventListener(k,I,!1)}}}(this.target,"message",d=>this.receive(d)),this.globalScope=ae(self)?u:window}registerMessageHandler(u,s){this.messageHandlers[u]=s}sendAsync(u,s){return new Promise((d,k)=>{const I=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[I]={resolve:d,reject:k},s&&s.signal.addEventListener("abort",()=>{delete this.resolveRejects[I];const K={id:I,type:"<cancel>",origin:location.origin,targetMapId:u.targetMapId,sourceMapId:this.mapId};this.target.postMessage(K)},{once:!0});const F=[],V=Object.assign(Object.assign({},u),{id:I,sourceMapId:this.mapId,origin:location.origin,data:Lh(u.data,F)});this.target.postMessage(V,{transfer:F})})}receive(u){const s=u.data,d=s.id;if(!(s.origin!=="file://"&&location.origin!=="file://"&&s.origin!=="resource://android"&&location.origin!=="resource://android"&&s.origin!==location.origin||s.targetMapId&&this.mapId!==s.targetMapId)){if(s.type==="<cancel>"){delete this.tasks[d];const k=this.abortControllers[d];return delete this.abortControllers[d],void(k&&k.abort())}if(ae(self)||s.mustQueue)return this.tasks[d]=s,this.taskQueue.push(d),void this.invoker.trigger();this.processTask(d,s)}}process(){if(this.taskQueue.length===0)return;const u=this.taskQueue.shift(),s=this.tasks[u];delete this.tasks[u],this.taskQueue.length>0&&this.invoker.trigger(),s&&this.processTask(u,s)}processTask(u,s){return r(this,void 0,void 0,function*(){if(s.type==="<response>"){const I=this.resolveRejects[u];return delete this.resolveRejects[u],I?void(s.error?I.reject(jh(s.error)):I.resolve(jh(s.data))):void 0}if(!this.messageHandlers[s.type])return void this.completeTask(u,new Error(`Could not find a registered handler for ${s.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const d=jh(s.data),k=new AbortController;this.abortControllers[u]=k;try{const I=yield this.messageHandlers[s.type](s.sourceMapId,d,k);this.completeTask(u,null,I)}catch(I){this.completeTask(u,I)}})}completeTask(u,s,d){const k=[];delete this.abortControllers[u];const I={id:u,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:s?Lh(s):null,data:Lh(d,k)};this.target.postMessage(I,{transfer:k})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},l.G=Re,l.H=function(){var u=new Gm(16);return Gm!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},l.I=$3,l.J=function(u,s,d){var k,I,F,V,K,ne,ue,xe,Te,Ne,Ue,Ke,Ze=d[0],ct=d[1],mt=d[2];return s===u?(u[12]=s[0]*Ze+s[4]*ct+s[8]*mt+s[12],u[13]=s[1]*Ze+s[5]*ct+s[9]*mt+s[13],u[14]=s[2]*Ze+s[6]*ct+s[10]*mt+s[14],u[15]=s[3]*Ze+s[7]*ct+s[11]*mt+s[15]):(I=s[1],F=s[2],V=s[3],K=s[4],ne=s[5],ue=s[6],xe=s[7],Te=s[8],Ne=s[9],Ue=s[10],Ke=s[11],u[0]=k=s[0],u[1]=I,u[2]=F,u[3]=V,u[4]=K,u[5]=ne,u[6]=ue,u[7]=xe,u[8]=Te,u[9]=Ne,u[10]=Ue,u[11]=Ke,u[12]=k*Ze+K*ct+Te*mt+s[12],u[13]=I*Ze+ne*ct+Ne*mt+s[13],u[14]=F*Ze+ue*ct+Ue*mt+s[14],u[15]=V*Ze+xe*ct+Ke*mt+s[15]),u},l.K=function(u,s,d){var k=d[0],I=d[1],F=d[2];return u[0]=s[0]*k,u[1]=s[1]*k,u[2]=s[2]*k,u[3]=s[3]*k,u[4]=s[4]*I,u[5]=s[5]*I,u[6]=s[6]*I,u[7]=s[7]*I,u[8]=s[8]*F,u[9]=s[9]*F,u[10]=s[10]*F,u[11]=s[11]*F,u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15],u},l.L=yk,l.M=function(u,s){const d={};for(let k=0;k<s.length;k++){const I=s[k];I in u&&(d[I]=u[I])}return d},l.N=Kh,l.O=fP,l.P=g,l.Q=dP,l.R=Xa,l.S=Za,l.T=Nm,l.U=y,l.V=f,l.W=U,l.X=vo,l.Y=J,l.Z=ub,l._=r,l.a=Y,l.a$=function(u,s){var d=u[0],k=u[1],I=u[2],F=u[3],V=u[4],K=u[5],ne=u[6],ue=u[7],xe=u[8],Te=u[9],Ne=u[10],Ue=u[11],Ke=u[12],Ze=u[13],ct=u[14],mt=u[15],Bt=s[0],Pt=s[1],$t=s[2],Gt=s[3],dn=s[4],$n=s[5],_r=s[6],Rn=s[7],Tn=s[8],rr=s[9],Hn=s[10],Un=s[11],Qt=s[12],ar=s[13],tr=s[14],Dr=s[15];return Math.abs(d-Bt)<=qs*Math.max(1,Math.abs(d),Math.abs(Bt))&&Math.abs(k-Pt)<=qs*Math.max(1,Math.abs(k),Math.abs(Pt))&&Math.abs(I-$t)<=qs*Math.max(1,Math.abs(I),Math.abs($t))&&Math.abs(F-Gt)<=qs*Math.max(1,Math.abs(F),Math.abs(Gt))&&Math.abs(V-dn)<=qs*Math.max(1,Math.abs(V),Math.abs(dn))&&Math.abs(K-$n)<=qs*Math.max(1,Math.abs(K),Math.abs($n))&&Math.abs(ne-_r)<=qs*Math.max(1,Math.abs(ne),Math.abs(_r))&&Math.abs(ue-Rn)<=qs*Math.max(1,Math.abs(ue),Math.abs(Rn))&&Math.abs(xe-Tn)<=qs*Math.max(1,Math.abs(xe),Math.abs(Tn))&&Math.abs(Te-rr)<=qs*Math.max(1,Math.abs(Te),Math.abs(rr))&&Math.abs(Ne-Hn)<=qs*Math.max(1,Math.abs(Ne),Math.abs(Hn))&&Math.abs(Ue-Un)<=qs*Math.max(1,Math.abs(Ue),Math.abs(Un))&&Math.abs(Ke-Qt)<=qs*Math.max(1,Math.abs(Ke),Math.abs(Qt))&&Math.abs(Ze-ar)<=qs*Math.max(1,Math.abs(Ze),Math.abs(ar))&&Math.abs(ct-tr)<=qs*Math.max(1,Math.abs(ct),Math.abs(tr))&&Math.abs(mt-Dr)<=qs*Math.max(1,Math.abs(mt),Math.abs(Dr))},l.a0=ri,l.a1=K3,l.a2=xt,l.a3=u=>{const s=window.document.createElement("video");return s.muted=!0,new Promise(d=>{s.onloadstart=()=>{d(s)};for(const k of u){const I=window.document.createElement("source");X(k)||(s.crossOrigin="Anonymous"),I.src=k,s.appendChild(I)}})},l.a4=function(){return M++},l.a5=Nn,l.a6=Qm,l.a7=wu,l.a8=Od,l.a9=vP,l.aA=function(u){if(u.type==="custom")return new xL(u);switch(u.type){case"background":return new vL(u);case"circle":return new sD(u);case"fill":return new SD(u);case"fill-extrusion":return new $D(u);case"heatmap":return new lD(u);case"hillshade":return new uD(u);case"line":return new WD(u);case"raster":return new wL(u);case"symbol":return new Tw(u)}},l.aB=G,l.aC=function(u,s){if(!u)return[{command:"setStyle",args:[s]}];let d=[];try{if(!le(u.version,s.version))return[{command:"setStyle",args:[s]}];le(u.center,s.center)||d.push({command:"setCenter",args:[s.center]}),le(u.zoom,s.zoom)||d.push({command:"setZoom",args:[s.zoom]}),le(u.bearing,s.bearing)||d.push({command:"setBearing",args:[s.bearing]}),le(u.pitch,s.pitch)||d.push({command:"setPitch",args:[s.pitch]}),le(u.sprite,s.sprite)||d.push({command:"setSprite",args:[s.sprite]}),le(u.glyphs,s.glyphs)||d.push({command:"setGlyphs",args:[s.glyphs]}),le(u.transition,s.transition)||d.push({command:"setTransition",args:[s.transition]}),le(u.light,s.light)||d.push({command:"setLight",args:[s.light]}),le(u.terrain,s.terrain)||d.push({command:"setTerrain",args:[s.terrain]}),le(u.sky,s.sky)||d.push({command:"setSky",args:[s.sky]}),le(u.projection,s.projection)||d.push({command:"setProjection",args:[s.projection]});const k={},I=[];(function(V,K,ne,ue){let xe;for(xe in K=K||{},V=V||{})Object.prototype.hasOwnProperty.call(V,xe)&&(Object.prototype.hasOwnProperty.call(K,xe)||et(xe,ne,ue));for(xe in K)Object.prototype.hasOwnProperty.call(K,xe)&&(Object.prototype.hasOwnProperty.call(V,xe)?le(V[xe],K[xe])||(V[xe].type==="geojson"&&K[xe].type==="geojson"&&wt(V,K,xe)?ze(ne,{command:"setGeoJSONSourceData",args:[xe,K[xe].data]}):ft(xe,K,ne,ue)):Je(xe,K,ne))})(u.sources,s.sources,I,k);const F=[];u.layers&&u.layers.forEach(V=>{"source"in V&&k[V.source]?d.push({command:"removeLayer",args:[V.id]}):F.push(V)}),d=d.concat(I),function(V,K,ne){K=K||[];const ue=(V=V||[]).map(Ct),xe=K.map(Ct),Te=V.reduce(tn,{}),Ne=K.reduce(tn,{}),Ue=ue.slice(),Ke=Object.create(null);let Ze,ct,mt,Bt,Pt;for(let $t=0,Gt=0;$t<ue.length;$t++)Ze=ue[$t],Object.prototype.hasOwnProperty.call(Ne,Ze)?Gt++:(ze(ne,{command:"removeLayer",args:[Ze]}),Ue.splice(Ue.indexOf(Ze,Gt),1));for(let $t=0,Gt=0;$t<xe.length;$t++)Ze=xe[xe.length-1-$t],Ue[Ue.length-1-$t]!==Ze&&(Object.prototype.hasOwnProperty.call(Te,Ze)?(ze(ne,{command:"removeLayer",args:[Ze]}),Ue.splice(Ue.lastIndexOf(Ze,Ue.length-Gt),1)):Gt++,Bt=Ue[Ue.length-$t],ze(ne,{command:"addLayer",args:[Ne[Ze],Bt]}),Ue.splice(Ue.length-$t,0,Ze),Ke[Ze]=!0);for(let $t=0;$t<xe.length;$t++)if(Ze=xe[$t],ct=Te[Ze],mt=Ne[Ze],!Ke[Ze]&&!le(ct,mt))if(le(ct.source,mt.source)&&le(ct["source-layer"],mt["source-layer"])&&le(ct.type,mt.type)){for(Pt in It(ct.layout,mt.layout,ne,Ze,null,"setLayoutProperty"),It(ct.paint,mt.paint,ne,Ze,null,"setPaintProperty"),le(ct.filter,mt.filter)||ze(ne,{command:"setFilter",args:[Ze,mt.filter]}),le(ct.minzoom,mt.minzoom)&&le(ct.maxzoom,mt.maxzoom)||ze(ne,{command:"setLayerZoomRange",args:[Ze,mt.minzoom,mt.maxzoom]}),ct)Object.prototype.hasOwnProperty.call(ct,Pt)&&Pt!=="layout"&&Pt!=="paint"&&Pt!=="filter"&&Pt!=="metadata"&&Pt!=="minzoom"&&Pt!=="maxzoom"&&(Pt.indexOf("paint.")===0?It(ct[Pt],mt[Pt],ne,Ze,Pt.slice(6),"setPaintProperty"):le(ct[Pt],mt[Pt])||ze(ne,{command:"setLayerProperty",args:[Ze,Pt,mt[Pt]]}));for(Pt in mt)Object.prototype.hasOwnProperty.call(mt,Pt)&&!Object.prototype.hasOwnProperty.call(ct,Pt)&&Pt!=="layout"&&Pt!=="paint"&&Pt!=="filter"&&Pt!=="metadata"&&Pt!=="minzoom"&&Pt!=="maxzoom"&&(Pt.indexOf("paint.")===0?It(ct[Pt],mt[Pt],ne,Ze,Pt.slice(6),"setPaintProperty"):le(ct[Pt],mt[Pt])||ze(ne,{command:"setLayerProperty",args:[Ze,Pt,mt[Pt]]}))}else ze(ne,{command:"removeLayer",args:[Ze]}),Bt=Ue[Ue.lastIndexOf(Ze)+1],ze(ne,{command:"addLayer",args:[mt,Bt]})}(F,s.layers,d)}catch(k){console.warn("Unable to compute style diff:",k),d=[{command:"setStyle",args:[s]}]}return d},l.aD=function(u){const s=[],d=u.id;return d===void 0&&s.push({message:`layers.${d}: missing required property "id"`}),u.render===void 0&&s.push({message:`layers.${d}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&s.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),s},l.aE=function u(s,d){if(Array.isArray(s)){if(!Array.isArray(d)||s.length!==d.length)return!1;for(let k=0;k<s.length;k++)if(!u(s[k],d[k]))return!1;return!0}if(typeof s=="object"&&s!==null&&d!==null){if(typeof d!="object"||Object.keys(s).length!==Object.keys(d).length)return!1;for(const k in s)if(!u(s[k],d[k]))return!1;return!0}return s===d},l.aF=L,l.aG=W,l.aH=class extends kd{constructor(u,s){super(u,s),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},l.aI=mw,l.aJ=class extends kd{constructor(u,s){super(u,s),this.current=J9}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let s=1;s<16;s++)if(u[s]!==this.current[s]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},l.aK=sk,l.aL=ak,l.aM=mn,l.aN=class extends kd{constructor(u,s){super(u,s),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},l.aO=class extends kd{constructor(u,s){super(u,s),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},l.aP=function(u,s,d,k,I,F,V){var K=1/(s-d),ne=1/(k-I),ue=1/(F-V);return u[0]=-2*K,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*ne,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*ue,u[11]=0,u[12]=(s+d)*K,u[13]=(I+k)*ne,u[14]=(V+F)*ue,u[15]=1,u},l.aQ=oD,l.aR=class extends Rt{},l.aS=ZD,l.aT=class extends zt{},l.aU=k3,l.aV=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},l.aW=xk,l.aX=as,l.aY=Ka,l.aZ=class extends Jn{},l.a_=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]&&u[4]===s[4]&&u[5]===s[5]&&u[6]===s[6]&&u[7]===s[7]&&u[8]===s[8]&&u[9]===s[9]&&u[10]===s[10]&&u[11]===s[11]&&u[12]===s[12]&&u[13]===s[13]&&u[14]===s[14]&&u[15]===s[15]},l.aa=function(u){const s={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,k,I,F)=>{const V=I||F;return s[k]=!V||V.toLowerCase(),""}),s["max-age"]){const d=parseInt(s["max-age"],10);isNaN(d)?delete s["max-age"]:s["max-age"]=d}return s},l.ab=function(u,s){const d=[];for(const k in u)k in s||d.push(k);return d},l.ac=P,l.ad=function(u,s,d){var k=Math.sin(d),I=Math.cos(d),F=s[0],V=s[1],K=s[2],ne=s[3],ue=s[4],xe=s[5],Te=s[6],Ne=s[7];return s!==u&&(u[8]=s[8],u[9]=s[9],u[10]=s[10],u[11]=s[11],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[0]=F*I+ue*k,u[1]=V*I+xe*k,u[2]=K*I+Te*k,u[3]=ne*I+Ne*k,u[4]=ue*I-F*k,u[5]=xe*I-V*k,u[6]=Te*I-K*k,u[7]=Ne*I-ne*k,u},l.ae=function(u){var s=new Gm(16);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s[4]=u[4],s[5]=u[5],s[6]=u[6],s[7]=u[7],s[8]=u[8],s[9]=u[9],s[10]=u[10],s[11]=u[11],s[12]=u[12],s[13]=u[13],s[14]=u[14],s[15]=u[15],s},l.af=vw,l.ag=function(u,s){let d=0,k=0;if(u.kind==="constant")k=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:I,minZoom:F,maxZoom:V}=u,K=I?P(Ui.interpolationFactor(I,s,F,V),0,1):0;u.kind==="camera"?k=Wi.number(u.minSize,u.maxSize,K):d=K}return{uSizeT:d,uSize:k}},l.ai=function(u,{uSize:s,uSizeT:d},{lowerSize:k,upperSize:I}){return u.kind==="source"?k/Dc:u.kind==="composite"?Wi.number(k/Dc,I/Dc,d):s},l.aj=U3,l.ak=function(u,s,d,k){const I=s.y-u.y,F=s.x-u.x,V=k.y-d.y,K=k.x-d.x,ne=V*F-K*I;if(ne===0)return null;const ue=(K*(u.y-d.y)-V*(u.x-d.x))/ne;return new g(u.x+ue*F,u.y+ue*I)},l.al=SP,l.am=hk,l.an=S3,l.ao=function(u){let s=1/0,d=1/0,k=-1/0,I=-1/0;for(const F of u)s=Math.min(s,F.x),d=Math.min(d,F.y),k=Math.max(k,F.x),I=Math.max(I,F.y);return[s,d,k,I]},l.ap=ko,l.ar=z3,l.as=function(u,s){var d=s[0],k=s[1],I=s[2],F=s[3],V=s[4],K=s[5],ne=s[6],ue=s[7],xe=s[8],Te=s[9],Ne=s[10],Ue=s[11],Ke=s[12],Ze=s[13],ct=s[14],mt=s[15],Bt=d*K-k*V,Pt=d*ne-I*V,$t=d*ue-F*V,Gt=k*ne-I*K,dn=k*ue-F*K,$n=I*ue-F*ne,_r=xe*Ze-Te*Ke,Rn=xe*ct-Ne*Ke,Tn=xe*mt-Ue*Ke,rr=Te*ct-Ne*Ze,Hn=Te*mt-Ue*Ze,Un=Ne*mt-Ue*ct,Qt=Bt*Un-Pt*Hn+$t*rr+Gt*Tn-dn*Rn+$n*_r;return Qt?(u[0]=(K*Un-ne*Hn+ue*rr)*(Qt=1/Qt),u[1]=(I*Hn-k*Un-F*rr)*Qt,u[2]=(Ze*$n-ct*dn+mt*Gt)*Qt,u[3]=(Ne*dn-Te*$n-Ue*Gt)*Qt,u[4]=(ne*Tn-V*Un-ue*Rn)*Qt,u[5]=(d*Un-I*Tn+F*Rn)*Qt,u[6]=(ct*$t-Ke*$n-mt*Pt)*Qt,u[7]=(xe*$n-Ne*$t+Ue*Pt)*Qt,u[8]=(V*Hn-K*Tn+ue*_r)*Qt,u[9]=(k*Tn-d*Hn-F*_r)*Qt,u[10]=(Ke*dn-Ze*$t+mt*Bt)*Qt,u[11]=(Te*$t-xe*dn-Ue*Bt)*Qt,u[12]=(K*Rn-V*rr-ne*_r)*Qt,u[13]=(d*rr-k*Rn+I*_r)*Qt,u[14]=(Ze*Pt-Ke*Gt-ct*Bt)*Qt,u[15]=(xe*Gt-Te*Pt+Ne*Bt)*Qt,u):null},l.at=Z3,l.au=F3,l.av=Y3,l.aw=function(){const u={},s=te.$version;for(const d in te.$root){const k=te.$root[d];if(k.required){let I=null;I=d==="version"?s:k.type==="array"?[]:{},I!=null&&(u[d]=I)}}return u},l.ax=q0,l.ay=De,l.az=function(u){u=u.slice();const s=Object.create(null);for(let d=0;d<u.length;d++)s[u[d].id]=u[d];for(let d=0;d<u.length;d++)"ref"in u[d]&&(u[d]=ge(u[d],s[u[d].ref]));return u},l.b=be,l.b0=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[4]=s[4],u[5]=s[5],u[6]=s[6],u[7]=s[7],u[8]=s[8],u[9]=s[9],u[10]=s[10],u[11]=s[11],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15],u},l.b1=function(u,s,d){return u[0]=s[0]*d[0],u[1]=s[1]*d[1],u[2]=s[2]*d[2],u[3]=s[3]*d[3],u},l.b2=function(u,s){return u[0]*s[0]+u[1]*s[1]+u[2]*s[2]+u[3]*s[3]},l.b3=T,l.b4=gP,l.b5=pP,l.b6=function(u,s,d,k,I){var F,V=1/Math.tan(s/2);return u[0]=V/d,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=V,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,I!=null&&I!==1/0?(u[10]=(I+k)*(F=1/(k-I)),u[14]=2*I*k*F):(u[10]=-1,u[14]=-2*k),u},l.b7=function(u,s,d){var k=Math.sin(d),I=Math.cos(d),F=s[4],V=s[5],K=s[6],ne=s[7],ue=s[8],xe=s[9],Te=s[10],Ne=s[11];return s!==u&&(u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[4]=F*I+ue*k,u[5]=V*I+xe*k,u[6]=K*I+Te*k,u[7]=ne*I+Ne*k,u[8]=ue*I-F*k,u[9]=xe*I-V*k,u[10]=Te*I-K*k,u[11]=Ne*I-ne*k,u},l.b8=w,l.b9=A,l.bA=Uk,l.bB=function(u){return u.message===z},l.bC=zs,l.bD=ca,l.ba=function(u){return u*Math.PI/180},l.bb=function(u,s){const{x:d,y:k}=ub.fromLngLat(s);return!(u<0||u>25||k<0||k>=1||d<0||d>=1)},l.bc=function(u,s){return u[0]=s[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=s[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=s[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},l.bd=class extends Se{},l.be=W3,l.bf=IL,l.bh=Oe,l.bi=function(u,s){Y.REGISTERED_PROTOCOLS[u]=s},l.bj=function(u){delete Y.REGISTERED_PROTOCOLS[u]},l.bk=function(u,s){const d={};for(let I=0;I<u.length;I++){const F=s&&s[u[I].id]||Zr(u[I]);s&&(s[u[I].id]=F);let V=d[F];V||(V=d[F]=[]),V.push(u[I])}const k=[];for(const I in d)k.push(d[I]);return k},l.bl=Vn,l.bm=bP,l.bn=_P,l.bo=Yk,l.bp=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=vo/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const s=u.bucket.layers[0],d=s.layout,k=s._unevaluatedLayout._values,I={layoutIconSize:k["icon-size"].possiblyEvaluate(new ji(u.bucket.zoom+1),u.canonical),layoutTextSize:k["text-size"].possiblyEvaluate(new ji(u.bucket.zoom+1),u.canonical),textMaxSize:k["text-size"].possiblyEvaluate(new ji(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:ue,maxZoom:xe}=u.bucket.textSizeData;I.compositeTextSizes=[k["text-size"].possiblyEvaluate(new ji(ue),u.canonical),k["text-size"].possiblyEvaluate(new ji(xe),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:ue,maxZoom:xe}=u.bucket.iconSizeData;I.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new ji(ue),u.canonical),k["icon-size"].possiblyEvaluate(new ji(xe),u.canonical)]}const F=d.get("text-line-height")*ko,V=d.get("text-rotation-alignment")!=="viewport"&&d.get("symbol-placement")!=="point",K=d.get("text-keep-upright"),ne=d.get("text-size");for(const ue of u.bucket.features){const xe=d.get("text-font").evaluate(ue,{},u.canonical).join(","),Te=ne.evaluate(ue,{},u.canonical),Ne=I.layoutTextSize.evaluate(ue,{},u.canonical),Ue=I.layoutIconSize.evaluate(ue,{},u.canonical),Ke={horizontal:{},vertical:void 0},Ze=ue.text;let ct,mt=[0,0];if(Ze){const $t=Ze.toString(),Gt=d.get("text-letter-spacing").evaluate(ue,{},u.canonical)*ko,dn=f3($t)?Gt:0,$n=d.get("text-anchor").evaluate(ue,{},u.canonical),_r=IP(s,ue,u.canonical);if(!_r){const Hn=d.get("text-radial-offset").evaluate(ue,{},u.canonical);mt=Hn?CP($n,[Hn*ko,X3]):d.get("text-offset").evaluate(ue,{},u.canonical).map(Un=>Un*ko)}let Rn=V?"center":d.get("text-justify").evaluate(ue,{},u.canonical);const Tn=d.get("symbol-placement")==="point"?d.get("text-max-width").evaluate(ue,{},u.canonical)*ko:1/0,rr=()=>{u.bucket.allowVerticalPlacement&&H0($t)&&(Ke.vertical=Aw(Ze,u.glyphMap,u.glyphPositions,u.imagePositions,xe,Tn,F,$n,"left",dn,mt,l.ah.vertical,!0,Ne,Te))};if(!V&&_r){const Hn=new Set;if(Rn==="auto")for(let Qt=0;Qt<_r.values.length;Qt+=2)Hn.add(Z3(_r.values[Qt]));else Hn.add(Rn);let Un=!1;for(const Qt of Hn)if(!Ke.horizontal[Qt])if(Un)Ke.horizontal[Qt]=Ke.horizontal[0];else{const ar=Aw(Ze,u.glyphMap,u.glyphPositions,u.imagePositions,xe,Tn,F,"center",Qt,dn,mt,l.ah.horizontal,!1,Ne,Te);ar&&(Ke.horizontal[Qt]=ar,Un=ar.positionedLines.length===1)}rr()}else{Rn==="auto"&&(Rn=Z3($n));const Hn=Aw(Ze,u.glyphMap,u.glyphPositions,u.imagePositions,xe,Tn,F,$n,Rn,dn,mt,l.ah.horizontal,!1,Ne,Te);Hn&&(Ke.horizontal[Rn]=Hn),rr(),H0($t)&&V&&K&&(Ke.vertical=Aw(Ze,u.glyphMap,u.glyphPositions,u.imagePositions,xe,Tn,F,$n,Rn,dn,mt,l.ah.vertical,!1,Ne,Te))}}let Bt=!1;if(ue.icon&&ue.icon.name){const $t=u.imageMap[ue.icon.name];$t&&(ct=pL(u.imagePositions[ue.icon.name],d.get("icon-offset").evaluate(ue,{},u.canonical),d.get("icon-anchor").evaluate(ue,{},u.canonical)),Bt=!!$t.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Bt:u.bucket.sdfIcons!==Bt&&Q("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($t.pixelRatio!==u.bucket.pixelRatio||d.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const Pt=DP(Ke.horizontal)||Ke.vertical;u.bucket.iconsInText=!!Pt&&Pt.iconsInText,(Pt||ct)&&ML(u.bucket,ue,Ke,ct,u.imageMap,I,Ne,Ue,mt,Bt,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},l.bq=D3,l.br=C3,l.bs=R3,l.bt=Hh,l.bu=j3,l.bv=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},l.bw=function(u,s,d,k,I){return r(this,void 0,void 0,function*(){if(f())try{return yield U(u,s,d,k,I)}catch{}return function(F,V,K,ne,ue){const xe=F.width,Te=F.height;B&&N||(B=new OffscreenCanvas(xe,Te),N=B.getContext("2d",{willReadFrequently:!0})),B.width=xe,B.height=Te,N.drawImage(F,0,0,xe,Te);const Ne=N.getImageData(V,K,ne,ue);return N.clearRect(0,0,xe,Te),Ne.data}(u,s,d,k,I)})},l.bx=yP,l.by=h,l.bz=m,l.c=H,l.d=u=>r(void 0,void 0,void 0,function*(){if(u.byteLength===0)return createImageBitmap(new ImageData(1,1));const s=new Blob([new Uint8Array(u)],{type:"image/png"});try{return createImageBitmap(s)}catch(d){throw new Error(`Could not load image because of ${d.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),l.e=R,l.f=u=>new Promise((s,d)=>{const k=new Image;k.onload=()=>{s(k),URL.revokeObjectURL(k.src),k.onload=null,window.requestAnimationFrame(()=>{k.src=pe})},k.onerror=()=>d(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new Blob([new Uint8Array(u)],{type:"image/png"});k.src=u.byteLength?URL.createObjectURL(I):pe}),l.g=fe,l.h=(u,s)=>ot(R(u,{type:"json"}),s),l.i=ae,l.j=se,l.k=Be,l.l=(u,s)=>ot(R(u,{type:"arrayBuffer"}),s),l.m=ot,l.n=function(u){return new j3(u).readFields(aL,[])},l.o=eb,l.p=Zk,l.q=$,l.r=u3,l.s=X,l.t=U0,l.u=Au,l.v=te,l.w=Q,l.x=function([u,s,d]){return s+=90,s*=Math.PI/180,d*=Math.PI/180,{x:u*Math.cos(s)*Math.sin(d),y:u*Math.sin(s)*Math.sin(d),z:u*Math.cos(d)}},l.y=Wi,l.z=ji}),c("worker",["./shared"],function(l){class r{constructor(he){this.keyCache={},he&&this.replace(he)}replace(he){this._layerConfigs={},this._layers={},this.update(he,[])}update(he,me){for(const je of he){this._layerConfigs[je.id]=je;const qe=this._layers[je.id]=l.aA(je);qe._featureFilter=l.a7(qe.filter),this.keyCache[je.id]&&delete this.keyCache[je.id]}for(const je of me)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const we=l.bk(Object.values(this._layerConfigs),this.keyCache);for(const je of we){const qe=je.map(at=>this._layers[at.id]),Fe=qe[0];if(Fe.visibility==="none")continue;const Xe=Fe.source||"";let Ge=this.familiesBySource[Xe];Ge||(Ge=this.familiesBySource[Xe]={});const rt=Fe.sourceLayer||"_geojsonTileLayer";let bt=Ge[rt];bt||(bt=Ge[rt]=[]),bt.push(qe)}}}class h{constructor(he){const me={},we=[];for(const Xe in he){const Ge=he[Xe],rt=me[Xe]={};for(const bt in Ge){const at=Ge[+bt];if(!at||at.bitmap.width===0||at.bitmap.height===0)continue;const Et={x:0,y:0,w:at.bitmap.width+2,h:at.bitmap.height+2};we.push(Et),rt[bt]={rect:Et,metrics:at.metrics}}}const{w:je,h:qe}=l.p(we),Fe=new l.o({width:je||1,height:qe||1});for(const Xe in he){const Ge=he[Xe];for(const rt in Ge){const bt=Ge[+rt];if(!bt||bt.bitmap.width===0||bt.bitmap.height===0)continue;const at=me[Xe][rt].rect;l.o.copy(bt.bitmap,Fe,{x:0,y:0},{x:at.x+1,y:at.y+1},bt.bitmap)}}this.image=Fe,this.positions=me}}l.bl("GlyphAtlas",h);class m{constructor(he){this.tileID=new l.S(he.tileID.overscaledZ,he.tileID.wrap,he.tileID.canonical.z,he.tileID.canonical.x,he.tileID.canonical.y),this.uid=he.uid,this.zoom=he.zoom,this.pixelRatio=he.pixelRatio,this.tileSize=he.tileSize,this.source=he.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=he.showCollisionBoxes,this.collectResourceTiming=!!he.collectResourceTiming,this.returnDependencies=!!he.returnDependencies,this.promoteId=he.promoteId,this.inFlightDependencies=[]}parse(he,me,we,je){return l._(this,void 0,void 0,function*(){this.status="parsing",this.data=he,this.collisionBoxArray=new l.a5;const qe=new l.bm(Object.keys(he.layers).sort()),Fe=new l.bn(this.tileID,this.promoteId);Fe.bucketLayerIDs=[];const Xe={},Ge={featureIndex:Fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:we},rt=me.familiesBySource[this.source];for(const cn in rt){const xn=he.layers[cn];if(!xn)continue;xn.version===1&&l.w(`Vector tile source "${this.source}" layer "${cn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const cr=qe.encode(cn),br=[];for(let hr=0;hr<xn.length;hr++){const pr=xn.feature(hr),Kr=Fe.getId(pr,cn);br.push({feature:pr,id:Kr,index:hr,sourceLayerIndex:cr})}for(const hr of rt[cn]){const pr=hr[0];pr.source!==this.source&&l.w(`layer.source = ${pr.source} does not equal this.source = ${this.source}`),pr.minzoom&&this.zoom<Math.floor(pr.minzoom)||pr.maxzoom&&this.zoom>=pr.maxzoom||pr.visibility!=="none"&&(v(hr,this.zoom,we),(Xe[pr.id]=pr.createBucket({index:Fe.bucketLayerIDs.length,layers:hr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:cr,sourceID:this.source})).populate(br,Ge,this.tileID.canonical),Fe.bucketLayerIDs.push(hr.map(Kr=>Kr.id)))}}const bt=l.aF(Ge.glyphDependencies,cn=>Object.keys(cn).map(Number));this.inFlightDependencies.forEach(cn=>cn==null?void 0:cn.abort()),this.inFlightDependencies=[];let at=Promise.resolve({});if(Object.keys(bt).length){const cn=new AbortController;this.inFlightDependencies.push(cn),at=je.sendAsync({type:"GG",data:{stacks:bt,source:this.source,tileID:this.tileID,type:"glyphs"}},cn)}const Et=Object.keys(Ge.iconDependencies);let jt=Promise.resolve({});if(Et.length){const cn=new AbortController;this.inFlightDependencies.push(cn),jt=je.sendAsync({type:"GI",data:{icons:Et,source:this.source,tileID:this.tileID,type:"icons"}},cn)}const Kt=Object.keys(Ge.patternDependencies);let Yt=Promise.resolve({});if(Kt.length){const cn=new AbortController;this.inFlightDependencies.push(cn),Yt=je.sendAsync({type:"GI",data:{icons:Kt,source:this.source,tileID:this.tileID,type:"patterns"}},cn)}const[Zt,Jt,ln]=yield Promise.all([at,jt,Yt]),vn=new h(Zt),wn=new l.bo(Jt,ln);for(const cn in Xe){const xn=Xe[cn];xn instanceof l.a6?(v(xn.layers,this.zoom,we),l.bp({bucket:xn,glyphMap:Zt,glyphPositions:vn.positions,imageMap:Jt,imagePositions:wn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):xn.hasPattern&&(xn instanceof l.bq||xn instanceof l.br||xn instanceof l.bs)&&(v(xn.layers,this.zoom,we),xn.addFeatures(Ge,this.tileID.canonical,wn.patternPositions))}return this.status="done",{buckets:Object.values(Xe).filter(cn=>!cn.isEmpty()),featureIndex:Fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vn.image,imageAtlas:wn,glyphMap:this.returnDependencies?Zt:null,iconMap:this.returnDependencies?Jt:null,glyphPositions:this.returnDependencies?vn.positions:null}})}}function v(ve,he,me){const we=new l.z(he);for(const je of ve)je.recalculate(we,me)}class g{constructor(he,me,we){this.actor=he,this.layerIndex=me,this.availableImages=we,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(he,me){return l._(this,void 0,void 0,function*(){const we=yield l.l(he.request,me);try{return{vectorTile:new l.bt.VectorTile(new l.bu(we.data)),rawData:we.data,cacheControl:we.cacheControl,expires:we.expires}}catch(je){const qe=new Uint8Array(we.data);let Fe=`Unable to parse the tile at ${he.request.url}, `;throw Fe+=qe[0]===31&&qe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${je.message}`,new Error(Fe)}})}loadTile(he){return l._(this,void 0,void 0,function*(){const me=he.uid,we=!!(he&&he.request&&he.request.collectResourceTiming)&&new l.bv(he.request),je=new m(he);this.loading[me]=je;const qe=new AbortController;je.abort=qe;try{const Fe=yield this.loadVectorTile(he,qe);if(delete this.loading[me],!Fe)return null;const Xe=Fe.rawData,Ge={};Fe.expires&&(Ge.expires=Fe.expires),Fe.cacheControl&&(Ge.cacheControl=Fe.cacheControl);const rt={};if(we){const at=we.finish();at&&(rt.resourceTiming=JSON.parse(JSON.stringify(at)))}je.vectorTile=Fe.vectorTile;const bt=je.parse(Fe.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[me]=je,this.fetching[me]={rawTileData:Xe,cacheControl:Ge,resourceTiming:rt};try{const at=yield bt;return l.e({rawTileData:Xe.slice(0)},at,Ge,rt)}finally{delete this.fetching[me]}}catch(Fe){throw delete this.loading[me],je.status="done",this.loaded[me]=je,Fe}})}reloadTile(he){return l._(this,void 0,void 0,function*(){const me=he.uid;if(!this.loaded||!this.loaded[me])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const we=this.loaded[me];if(we.showCollisionBoxes=he.showCollisionBoxes,we.status==="parsing"){const je=yield we.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor);let qe;if(this.fetching[me]){const{rawTileData:Fe,cacheControl:Xe,resourceTiming:Ge}=this.fetching[me];delete this.fetching[me],qe=l.e({rawTileData:Fe.slice(0)},je,Xe,Ge)}else qe=je;return qe}if(we.status==="done"&&we.vectorTile)return we.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(he){return l._(this,void 0,void 0,function*(){const me=this.loading,we=he.uid;me&&me[we]&&me[we].abort&&(me[we].abort.abort(),delete me[we])})}removeTile(he){return l._(this,void 0,void 0,function*(){this.loaded&&this.loaded[he.uid]&&delete this.loaded[he.uid]})}}class _{constructor(){this.loaded={}}loadTile(he){return l._(this,void 0,void 0,function*(){const{uid:me,encoding:we,rawImageData:je,redFactor:qe,greenFactor:Fe,blueFactor:Xe,baseShift:Ge}=he,rt=je.width+2,bt=je.height+2,at=l.b(je)?new l.R({width:rt,height:bt},yield l.bw(je,-1,-1,rt,bt)):je,Et=new l.bx(me,at,we,qe,Fe,Xe,Ge);return this.loaded=this.loaded||{},this.loaded[me]=Et,Et})}removeTile(he){const me=this.loaded,we=he.uid;me&&me[we]&&delete me[we]}}function E(ve,he){if(ve.length!==0){b(ve[0],he);for(var me=1;me<ve.length;me++)b(ve[me],!he)}}function b(ve,he){for(var me=0,we=0,je=0,qe=ve.length,Fe=qe-1;je<qe;Fe=je++){var Xe=(ve[je][0]-ve[Fe][0])*(ve[Fe][1]+ve[je][1]),Ge=me+Xe;we+=Math.abs(me)>=Math.abs(Xe)?me-Ge+Xe:Xe-Ge+me,me=Ge}me+we>=0!=!!he&&ve.reverse()}var p=l.by(function ve(he,me){var we,je=he&&he.type;if(je==="FeatureCollection")for(we=0;we<he.features.length;we++)ve(he.features[we],me);else if(je==="GeometryCollection")for(we=0;we<he.geometries.length;we++)ve(he.geometries[we],me);else if(je==="Feature")ve(he.geometry,me);else if(je==="Polygon")E(he.coordinates,me);else if(je==="MultiPolygon")for(we=0;we<he.coordinates.length;we++)E(he.coordinates[we],me);return he});const x=l.bt.VectorTileFeature.prototype.toGeoJSON;var y={exports:{}},f=l.bz,w=l.bt.VectorTileFeature,A=P;function P(ve,he){this.options=he||{},this.features=ve,this.length=ve.length}function T(ve,he){this.id=typeof ve.id=="number"?ve.id:void 0,this.type=ve.type,this.rawGeometry=ve.type===1?[ve.geometry]:ve.geometry,this.properties=ve.tags,this.extent=he||4096}P.prototype.feature=function(ve){return new T(this.features[ve],this.options.extent)},T.prototype.loadGeometry=function(){var ve=this.rawGeometry;this.geometry=[];for(var he=0;he<ve.length;he++){for(var me=ve[he],we=[],je=0;je<me.length;je++)we.push(new f(me[je][0],me[je][1]));this.geometry.push(we)}return this.geometry},T.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ve=this.geometry,he=1/0,me=-1/0,we=1/0,je=-1/0,qe=0;qe<ve.length;qe++)for(var Fe=ve[qe],Xe=0;Xe<Fe.length;Xe++){var Ge=Fe[Xe];he=Math.min(he,Ge.x),me=Math.max(me,Ge.x),we=Math.min(we,Ge.y),je=Math.max(je,Ge.y)}return[he,we,me,je]},T.prototype.toGeoJSON=w.prototype.toGeoJSON;var R=l.bA,M=A;function L(ve){var he=new R;return function(me,we){for(var je in me.layers)we.writeMessage(3,W,me.layers[je])}(ve,he),he.finish()}function W(ve,he){var me;he.writeVarintField(15,ve.version||1),he.writeStringField(1,ve.name||""),he.writeVarintField(5,ve.extent||4096);var we={keys:[],values:[],keycache:{},valuecache:{}};for(me=0;me<ve.length;me++)we.feature=ve.feature(me),he.writeMessage(2,G,we);var je=we.keys;for(me=0;me<je.length;me++)he.writeStringField(3,je[me]);var qe=we.values;for(me=0;me<qe.length;me++)he.writeMessage(4,de,qe[me])}function G(ve,he){var me=ve.feature;me.id!==void 0&&he.writeVarintField(1,me.id),he.writeMessage(2,re,ve),he.writeVarintField(3,me.type),he.writeMessage(4,ae,me)}function re(ve,he){var me=ve.feature,we=ve.keys,je=ve.values,qe=ve.keycache,Fe=ve.valuecache;for(var Xe in me.properties){var Ge=me.properties[Xe],rt=qe[Xe];if(Ge!==null){rt===void 0&&(we.push(Xe),qe[Xe]=rt=we.length-1),he.writeVarint(rt);var bt=typeof Ge;bt!=="string"&&bt!=="boolean"&&bt!=="number"&&(Ge=JSON.stringify(Ge));var at=bt+":"+Ge,Et=Fe[at];Et===void 0&&(je.push(Ge),Fe[at]=Et=je.length-1),he.writeVarint(Et)}}}function Q(ve,he){return(he<<3)+(7&ve)}function oe(ve){return ve<<1^ve>>31}function ae(ve,he){for(var me=ve.loadGeometry(),we=ve.type,je=0,qe=0,Fe=me.length,Xe=0;Xe<Fe;Xe++){var Ge=me[Xe],rt=1;we===1&&(rt=Ge.length),he.writeVarint(Q(1,rt));for(var bt=we===3?Ge.length-1:Ge.length,at=0;at<bt;at++){at===1&&we!==1&&he.writeVarint(Q(2,bt-1));var Et=Ge[at].x-je,jt=Ge[at].y-qe;he.writeVarint(oe(Et)),he.writeVarint(oe(jt)),je+=Et,qe+=jt}we===3&&he.writeVarint(Q(7,1))}}function de(ve,he){var me=typeof ve;me==="string"?he.writeStringField(1,ve):me==="boolean"?he.writeBooleanField(7,ve):me==="number"&&(ve%1!=0?he.writeDoubleField(3,ve):ve<0?he.writeSVarintField(6,ve):he.writeVarintField(5,ve))}y.exports=L,y.exports.fromVectorTileJs=L,y.exports.fromGeojsonVt=function(ve,he){he=he||{};var me={};for(var we in ve)me[we]=new M(ve[we].features,he),me[we].name=we,me[we].version=he.version,me[we].extent=he.extent;return L({layers:me})},y.exports.GeoJSONWrapper=M;var be=l.by(y.exports);const pe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ve=>ve},U=Math.fround||(B=new Float32Array(1),ve=>(B[0]=+ve,B[0]));var B;const N=3,z=5,H=6;class Y{constructor(he){this.options=Object.assign(Object.create(pe),he),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(he){const{log:me,minZoom:we,maxZoom:je}=this.options;me&&console.time("total time");const qe=`prepare ${he.length} points`;me&&console.time(qe),this.points=he;const Fe=[];for(let Ge=0;Ge<he.length;Ge++){const rt=he[Ge];if(!rt.geometry)continue;const[bt,at]=rt.geometry.coordinates,Et=U(Oe(bt)),jt=U(De(at));Fe.push(Et,jt,1/0,Ge,-1,1),this.options.reduce&&Fe.push(0)}let Xe=this.trees[je+1]=this._createTree(Fe);me&&console.timeEnd(qe);for(let Ge=je;Ge>=we;Ge--){const rt=+Date.now();Xe=this.trees[Ge]=this._createTree(this._cluster(Xe,Ge)),me&&console.log("z%d: %d clusters in %dms",Ge,Xe.numItems,+Date.now()-rt)}return me&&console.timeEnd("total time"),this}getClusters(he,me){let we=((he[0]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,he[1]));let qe=he[2]===180?180:((he[2]+180)%360+360)%360-180;const Fe=Math.max(-90,Math.min(90,he[3]));if(he[2]-he[0]>=360)we=-180,qe=180;else if(we>qe){const at=this.getClusters([we,je,180,Fe],me),Et=this.getClusters([-180,je,qe,Fe],me);return at.concat(Et)}const Xe=this.trees[this._limitZoom(me)],Ge=Xe.range(Oe(we),De(Fe),Oe(qe),De(je)),rt=Xe.data,bt=[];for(const at of Ge){const Et=this.stride*at;bt.push(rt[Et+z]>1?fe(rt,Et,this.clusterProps):this.points[rt[Et+N]])}return bt}getChildren(he){const me=this._getOriginId(he),we=this._getOriginZoom(he),je="No cluster with the specified id.",qe=this.trees[we];if(!qe)throw new Error(je);const Fe=qe.data;if(me*this.stride>=Fe.length)throw new Error(je);const Xe=this.options.radius/(this.options.extent*Math.pow(2,we-1)),Ge=qe.within(Fe[me*this.stride],Fe[me*this.stride+1],Xe),rt=[];for(const bt of Ge){const at=bt*this.stride;Fe[at+4]===he&&rt.push(Fe[at+z]>1?fe(Fe,at,this.clusterProps):this.points[Fe[at+N]])}if(rt.length===0)throw new Error(je);return rt}getLeaves(he,me,we){const je=[];return this._appendLeaves(je,he,me=me||10,we=we||0,0),je}getTile(he,me,we){const je=this.trees[this._limitZoom(he)],qe=Math.pow(2,he),{extent:Fe,radius:Xe}=this.options,Ge=Xe/Fe,rt=(we-Ge)/qe,bt=(we+1+Ge)/qe,at={features:[]};return this._addTileFeatures(je.range((me-Ge)/qe,rt,(me+1+Ge)/qe,bt),je.data,me,we,qe,at),me===0&&this._addTileFeatures(je.range(1-Ge/qe,rt,1,bt),je.data,qe,we,qe,at),me===qe-1&&this._addTileFeatures(je.range(0,rt,Ge/qe,bt),je.data,-1,we,qe,at),at.features.length?at:null}getClusterExpansionZoom(he){let me=this._getOriginZoom(he)-1;for(;me<=this.options.maxZoom;){const we=this.getChildren(he);if(me++,we.length!==1)break;he=we[0].properties.cluster_id}return me}_appendLeaves(he,me,we,je,qe){const Fe=this.getChildren(me);for(const Xe of Fe){const Ge=Xe.properties;if(Ge&&Ge.cluster?qe+Ge.point_count<=je?qe+=Ge.point_count:qe=this._appendLeaves(he,Ge.cluster_id,we,je,qe):qe<je?qe++:he.push(Xe),he.length===we)break}return qe}_createTree(he){const me=new l.av(he.length/this.stride|0,this.options.nodeSize,Float32Array);for(let we=0;we<he.length;we+=this.stride)me.add(he[we],he[we+1]);return me.finish(),me.data=he,me}_addTileFeatures(he,me,we,je,qe,Fe){for(const Xe of he){const Ge=Xe*this.stride,rt=me[Ge+z]>1;let bt,at,Et;if(rt)bt=Re(me,Ge,this.clusterProps),at=me[Ge],Et=me[Ge+1];else{const Yt=this.points[me[Ge+N]];bt=Yt.properties;const[Zt,Jt]=Yt.geometry.coordinates;at=Oe(Zt),Et=De(Jt)}const jt={type:1,geometry:[[Math.round(this.options.extent*(at*qe-we)),Math.round(this.options.extent*(Et*qe-je))]],tags:bt};let Kt;Kt=rt||this.options.generateId?me[Ge+N]:this.points[me[Ge+N]].id,Kt!==void 0&&(jt.id=Kt),Fe.features.push(jt)}}_limitZoom(he){return Math.max(this.options.minZoom,Math.min(Math.floor(+he),this.options.maxZoom+1))}_cluster(he,me){const{radius:we,extent:je,reduce:qe,minPoints:Fe}=this.options,Xe=we/(je*Math.pow(2,me)),Ge=he.data,rt=[],bt=this.stride;for(let at=0;at<Ge.length;at+=bt){if(Ge[at+2]<=me)continue;Ge[at+2]=me;const Et=Ge[at],jt=Ge[at+1],Kt=he.within(Ge[at],Ge[at+1],Xe),Yt=Ge[at+z];let Zt=Yt;for(const Jt of Kt){const ln=Jt*bt;Ge[ln+2]>me&&(Zt+=Ge[ln+z])}if(Zt>Yt&&Zt>=Fe){let Jt,ln=Et*Yt,vn=jt*Yt,wn=-1;const cn=((at/bt|0)<<5)+(me+1)+this.points.length;for(const xn of Kt){const cr=xn*bt;if(Ge[cr+2]<=me)continue;Ge[cr+2]=me;const br=Ge[cr+z];ln+=Ge[cr]*br,vn+=Ge[cr+1]*br,Ge[cr+4]=cn,qe&&(Jt||(Jt=this._map(Ge,at,!0),wn=this.clusterProps.length,this.clusterProps.push(Jt)),qe(Jt,this._map(Ge,cr)))}Ge[at+4]=cn,rt.push(ln/Zt,vn/Zt,1/0,cn,-1,Zt),qe&&rt.push(wn)}else{for(let Jt=0;Jt<bt;Jt++)rt.push(Ge[at+Jt]);if(Zt>1)for(const Jt of Kt){const ln=Jt*bt;if(!(Ge[ln+2]<=me)){Ge[ln+2]=me;for(let vn=0;vn<bt;vn++)rt.push(Ge[ln+vn])}}}}return rt}_getOriginId(he){return he-this.points.length>>5}_getOriginZoom(he){return(he-this.points.length)%32}_map(he,me,we){if(he[me+z]>1){const Fe=this.clusterProps[he[me+H]];return we?Object.assign({},Fe):Fe}const je=this.points[he[me+N]].properties,qe=this.options.map(je);return we&&qe===je?Object.assign({},qe):qe}}function fe(ve,he,me){return{type:"Feature",id:ve[he+N],properties:Re(ve,he,me),geometry:{type:"Point",coordinates:[(we=ve[he],360*(we-.5)),ot(ve[he+1])]}};var we}function Re(ve,he,me){const we=ve[he+z],je=we>=1e4?`${Math.round(we/1e3)}k`:we>=1e3?Math.round(we/100)/10+"k":we,qe=ve[he+H],Fe=qe===-1?{}:Object.assign({},me[qe]);return Object.assign(Fe,{cluster:!0,cluster_id:ve[he+N],point_count:we,point_count_abbreviated:je})}function Oe(ve){return ve/360+.5}function De(ve){const he=Math.sin(ve*Math.PI/180),me=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return me<0?0:me>1?1:me}function ot(ve){const he=(180-360*ve)*Math.PI/180;return 360*Math.atan(Math.exp(he))/Math.PI-90}function X(ve,he,me,we){let je=we;const qe=he+(me-he>>1);let Fe,Xe=me-he;const Ge=ve[he],rt=ve[he+1],bt=ve[me],at=ve[me+1];for(let Et=he+3;Et<me;Et+=3){const jt=ee(ve[Et],ve[Et+1],Ge,rt,bt,at);if(jt>je)Fe=Et,je=jt;else if(jt===je){const Kt=Math.abs(Et-qe);Kt<Xe&&(Fe=Et,Xe=Kt)}}je>we&&(Fe-he>3&&X(ve,he,Fe,we),ve[Fe+2]=je,me-Fe>3&&X(ve,Fe,me,we))}function ee(ve,he,me,we,je,qe){let Fe=je-me,Xe=qe-we;if(Fe!==0||Xe!==0){const Ge=((ve-me)*Fe+(he-we)*Xe)/(Fe*Fe+Xe*Xe);Ge>1?(me=je,we=qe):Ge>0&&(me+=Fe*Ge,we+=Xe*Ge)}return Fe=ve-me,Xe=he-we,Fe*Fe+Xe*Xe}function Le(ve,he,me,we){const je={id:ve??null,type:he,geometry:me,tags:we,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(he==="Point"||he==="MultiPoint"||he==="LineString")Be(je,me);else if(he==="Polygon")Be(je,me[0]);else if(he==="MultiLineString")for(const qe of me)Be(je,qe);else if(he==="MultiPolygon")for(const qe of me)Be(je,qe[0]);return je}function Be(ve,he){for(let me=0;me<he.length;me+=3)ve.minX=Math.min(ve.minX,he[me]),ve.minY=Math.min(ve.minY,he[me+1]),ve.maxX=Math.max(ve.maxX,he[me]),ve.maxY=Math.max(ve.maxY,he[me+1])}function se(ve,he,me,we){if(!he.geometry)return;const je=he.geometry.coordinates;if(je&&je.length===0)return;const qe=he.geometry.type,Fe=Math.pow(me.tolerance/((1<<me.maxZoom)*me.extent),2);let Xe=[],Ge=he.id;if(me.promoteId?Ge=he.properties[me.promoteId]:me.generateId&&(Ge=we||0),qe==="Point")_e(je,Xe);else if(qe==="MultiPoint")for(const rt of je)_e(rt,Xe);else if(qe==="LineString")te(je,Xe,Fe,!1);else if(qe==="MultiLineString"){if(me.lineMetrics){for(const rt of je)Xe=[],te(rt,Xe,Fe,!1),ve.push(Le(Ge,"LineString",Xe,he.properties));return}$e(je,Xe,Fe,!1)}else if(qe==="Polygon")$e(je,Xe,Fe,!0);else{if(qe!=="MultiPolygon"){if(qe==="GeometryCollection"){for(const rt of he.geometry.geometries)se(ve,{id:Ge,geometry:rt,properties:he.properties},me,we);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const rt of je){const bt=[];$e(rt,bt,Fe,!0),Xe.push(bt)}}ve.push(Le(Ge,qe,Xe,he.properties))}function _e(ve,he){he.push(ge(ve[0]),le(ve[1]),0)}function te(ve,he,me,we){let je,qe,Fe=0;for(let Ge=0;Ge<ve.length;Ge++){const rt=ge(ve[Ge][0]),bt=le(ve[Ge][1]);he.push(rt,bt,0),Ge>0&&(Fe+=we?(je*bt-rt*qe)/2:Math.sqrt(Math.pow(rt-je,2)+Math.pow(bt-qe,2))),je=rt,qe=bt}const Xe=he.length-3;he[2]=1,X(he,0,Xe,me),he[Xe+2]=1,he.size=Math.abs(Fe),he.start=0,he.end=he.size}function $e(ve,he,me,we){for(let je=0;je<ve.length;je++){const qe=[];te(ve[je],qe,me,we),he.push(qe)}}function ge(ve){return ve/360+.5}function le(ve){const he=Math.sin(ve*Math.PI/180),me=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return me<0?0:me>1?1:me}function ze(ve,he,me,we,je,qe,Fe,Xe){if(we/=he,qe>=(me/=he)&&Fe<we)return ve;if(Fe<me||qe>=we)return null;const Ge=[];for(const rt of ve){const bt=rt.geometry;let at=rt.type;const Et=je===0?rt.minX:rt.minY,jt=je===0?rt.maxX:rt.maxY;if(Et>=me&&jt<we){Ge.push(rt);continue}if(jt<me||Et>=we)continue;let Kt=[];if(at==="Point"||at==="MultiPoint")Je(bt,Kt,me,we,je);else if(at==="LineString")et(bt,Kt,me,we,je,!1,Xe.lineMetrics);else if(at==="MultiLineString")wt(bt,Kt,me,we,je,!1);else if(at==="Polygon")wt(bt,Kt,me,we,je,!0);else if(at==="MultiPolygon")for(const Yt of bt){const Zt=[];wt(Yt,Zt,me,we,je,!0),Zt.length&&Kt.push(Zt)}if(Kt.length){if(Xe.lineMetrics&&at==="LineString"){for(const Yt of Kt)Ge.push(Le(rt.id,at,Yt,rt.tags));continue}at!=="LineString"&&at!=="MultiLineString"||(Kt.length===1?(at="LineString",Kt=Kt[0]):at="MultiLineString"),at!=="Point"&&at!=="MultiPoint"||(at=Kt.length===3?"Point":"MultiPoint"),Ge.push(Le(rt.id,at,Kt,rt.tags))}}return Ge.length?Ge:null}function Je(ve,he,me,we,je){for(let qe=0;qe<ve.length;qe+=3){const Fe=ve[qe+je];Fe>=me&&Fe<=we&&It(he,ve[qe],ve[qe+1],ve[qe+2])}}function et(ve,he,me,we,je,qe,Fe){let Xe=ft(ve);const Ge=je===0?Ct:tn;let rt,bt,at=ve.start;for(let Zt=0;Zt<ve.length-3;Zt+=3){const Jt=ve[Zt],ln=ve[Zt+1],vn=ve[Zt+2],wn=ve[Zt+3],cn=ve[Zt+4],xn=je===0?Jt:ln,cr=je===0?wn:cn;let br=!1;Fe&&(rt=Math.sqrt(Math.pow(Jt-wn,2)+Math.pow(ln-cn,2))),xn<me?cr>me&&(bt=Ge(Xe,Jt,ln,wn,cn,me),Fe&&(Xe.start=at+rt*bt)):xn>we?cr<we&&(bt=Ge(Xe,Jt,ln,wn,cn,we),Fe&&(Xe.start=at+rt*bt)):It(Xe,Jt,ln,vn),cr<me&&xn>=me&&(bt=Ge(Xe,Jt,ln,wn,cn,me),br=!0),cr>we&&xn<=we&&(bt=Ge(Xe,Jt,ln,wn,cn,we),br=!0),!qe&&br&&(Fe&&(Xe.end=at+rt*bt),he.push(Xe),Xe=ft(ve)),Fe&&(at+=rt)}let Et=ve.length-3;const jt=ve[Et],Kt=ve[Et+1],Yt=je===0?jt:Kt;Yt>=me&&Yt<=we&&It(Xe,jt,Kt,ve[Et+2]),Et=Xe.length-3,qe&&Et>=3&&(Xe[Et]!==Xe[0]||Xe[Et+1]!==Xe[1])&&It(Xe,Xe[0],Xe[1],Xe[2]),Xe.length&&he.push(Xe)}function ft(ve){const he=[];return he.size=ve.size,he.start=ve.start,he.end=ve.end,he}function wt(ve,he,me,we,je,qe){for(const Fe of ve)et(Fe,he,me,we,je,qe,!1)}function It(ve,he,me,we){ve.push(he,me,we)}function Ct(ve,he,me,we,je,qe){const Fe=(qe-he)/(we-he);return It(ve,qe,me+(je-me)*Fe,1),Fe}function tn(ve,he,me,we,je,qe){const Fe=(qe-me)/(je-me);return It(ve,he+(we-he)*Fe,qe,1),Fe}function xt(ve,he){const me=[];for(let we=0;we<ve.length;we++){const je=ve[we],qe=je.type;let Fe;if(qe==="Point"||qe==="MultiPoint"||qe==="LineString")Fe=Ht(je.geometry,he);else if(qe==="MultiLineString"||qe==="Polygon"){Fe=[];for(const Xe of je.geometry)Fe.push(Ht(Xe,he))}else if(qe==="MultiPolygon"){Fe=[];for(const Xe of je.geometry){const Ge=[];for(const rt of Xe)Ge.push(Ht(rt,he));Fe.push(Ge)}}me.push(Le(je.id,qe,Fe,je.tags))}return me}function Ht(ve,he){const me=[];me.size=ve.size,ve.start!==void 0&&(me.start=ve.start,me.end=ve.end);for(let we=0;we<ve.length;we+=3)me.push(ve[we]+he,ve[we+1],ve[we+2]);return me}function en(ve,he){if(ve.transformed)return ve;const me=1<<ve.z,we=ve.x,je=ve.y;for(const qe of ve.features){const Fe=qe.geometry,Xe=qe.type;if(qe.geometry=[],Xe===1)for(let Ge=0;Ge<Fe.length;Ge+=2)qe.geometry.push(kn(Fe[Ge],Fe[Ge+1],he,me,we,je));else for(let Ge=0;Ge<Fe.length;Ge++){const rt=[];for(let bt=0;bt<Fe[Ge].length;bt+=2)rt.push(kn(Fe[Ge][bt],Fe[Ge][bt+1],he,me,we,je));qe.geometry.push(rt)}}return ve.transformed=!0,ve}function kn(ve,he,me,we,je,qe){return[Math.round(me*(ve*we-je)),Math.round(me*(he*we-qe))]}function Dn(ve,he,me,we,je){const qe=he===je.maxZoom?0:je.tolerance/((1<<he)*je.extent),Fe={features:[],numPoints:0,numSimplified:0,numFeatures:ve.length,source:null,x:me,y:we,z:he,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Xe of ve)Ft(Fe,Xe,qe,je);return Fe}function Ft(ve,he,me,we){const je=he.geometry,qe=he.type,Fe=[];if(ve.minX=Math.min(ve.minX,he.minX),ve.minY=Math.min(ve.minY,he.minY),ve.maxX=Math.max(ve.maxX,he.maxX),ve.maxY=Math.max(ve.maxY,he.maxY),qe==="Point"||qe==="MultiPoint")for(let Xe=0;Xe<je.length;Xe+=3)Fe.push(je[Xe],je[Xe+1]),ve.numPoints++,ve.numSimplified++;else if(qe==="LineString")Tt(Fe,je,ve,me,!1,!1);else if(qe==="MultiLineString"||qe==="Polygon")for(let Xe=0;Xe<je.length;Xe++)Tt(Fe,je[Xe],ve,me,qe==="Polygon",Xe===0);else if(qe==="MultiPolygon")for(let Xe=0;Xe<je.length;Xe++){const Ge=je[Xe];for(let rt=0;rt<Ge.length;rt++)Tt(Fe,Ge[rt],ve,me,!0,rt===0)}if(Fe.length){let Xe=he.tags||null;if(qe==="LineString"&&we.lineMetrics){Xe={};for(const rt in he.tags)Xe[rt]=he.tags[rt];Xe.mapbox_clip_start=je.start/je.size,Xe.mapbox_clip_end=je.end/je.size}const Ge={geometry:Fe,type:qe==="Polygon"||qe==="MultiPolygon"?3:qe==="LineString"||qe==="MultiLineString"?2:1,tags:Xe};he.id!==null&&(Ge.id=he.id),ve.features.push(Ge)}}function Tt(ve,he,me,we,je,qe){const Fe=we*we;if(we>0&&he.size<(je?Fe:we))return void(me.numPoints+=he.length/3);const Xe=[];for(let Ge=0;Ge<he.length;Ge+=3)(we===0||he[Ge+2]>Fe)&&(me.numSimplified++,Xe.push(he[Ge],he[Ge+1])),me.numPoints++;je&&function(Ge,rt){let bt=0;for(let at=0,Et=Ge.length,jt=Et-2;at<Et;jt=at,at+=2)bt+=(Ge[at]-Ge[jt])*(Ge[at+1]+Ge[jt+1]);if(bt>0===rt)for(let at=0,Et=Ge.length;at<Et/2;at+=2){const jt=Ge[at],Kt=Ge[at+1];Ge[at]=Ge[Et-2-at],Ge[at+1]=Ge[Et-1-at],Ge[Et-2-at]=jt,Ge[Et-1-at]=Kt}}(Xe,qe),ve.push(Xe)}const rn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class dt{constructor(he,me){const we=(me=this.options=function(qe,Fe){for(const Xe in Fe)qe[Xe]=Fe[Xe];return qe}(Object.create(rn),me)).debug;if(we&&console.time("preprocess data"),me.maxZoom<0||me.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(me.promoteId&&me.generateId)throw new Error("promoteId and generateId cannot be used together.");let je=function(qe,Fe){const Xe=[];if(qe.type==="FeatureCollection")for(let Ge=0;Ge<qe.features.length;Ge++)se(Xe,qe.features[Ge],Fe,Ge);else se(Xe,qe.type==="Feature"?qe:{geometry:qe},Fe);return Xe}(he,me);this.tiles={},this.tileCoords=[],we&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",me.indexMaxZoom,me.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),je=function(qe,Fe){const Xe=Fe.buffer/Fe.extent;let Ge=qe;const rt=ze(qe,1,-1-Xe,Xe,0,-1,2,Fe),bt=ze(qe,1,1-Xe,2+Xe,0,-1,2,Fe);return(rt||bt)&&(Ge=ze(qe,1,-Xe,1+Xe,0,-1,2,Fe)||[],rt&&(Ge=xt(rt,1).concat(Ge)),bt&&(Ge=Ge.concat(xt(bt,-1)))),Ge}(je,me),je.length&&this.splitTile(je,0,0,0),we&&(je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(he,me,we,je,qe,Fe,Xe){const Ge=[he,me,we,je],rt=this.options,bt=rt.debug;for(;Ge.length;){je=Ge.pop(),we=Ge.pop(),me=Ge.pop(),he=Ge.pop();const at=1<<me,Et=qn(me,we,je);let jt=this.tiles[Et];if(!jt&&(bt>1&&console.time("creation"),jt=this.tiles[Et]=Dn(he,me,we,je,rt),this.tileCoords.push({z:me,x:we,y:je}),bt)){bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",me,we,je,jt.numFeatures,jt.numPoints,jt.numSimplified),console.timeEnd("creation"));const br=`z${me}`;this.stats[br]=(this.stats[br]||0)+1,this.total++}if(jt.source=he,qe==null){if(me===rt.indexMaxZoom||jt.numPoints<=rt.indexMaxPoints)continue}else{if(me===rt.maxZoom||me===qe)continue;if(qe!=null){const br=qe-me;if(we!==Fe>>br||je!==Xe>>br)continue}}if(jt.source=null,he.length===0)continue;bt>1&&console.time("clipping");const Kt=.5*rt.buffer/rt.extent,Yt=.5-Kt,Zt=.5+Kt,Jt=1+Kt;let ln=null,vn=null,wn=null,cn=null,xn=ze(he,at,we-Kt,we+Zt,0,jt.minX,jt.maxX,rt),cr=ze(he,at,we+Yt,we+Jt,0,jt.minX,jt.maxX,rt);he=null,xn&&(ln=ze(xn,at,je-Kt,je+Zt,1,jt.minY,jt.maxY,rt),vn=ze(xn,at,je+Yt,je+Jt,1,jt.minY,jt.maxY,rt),xn=null),cr&&(wn=ze(cr,at,je-Kt,je+Zt,1,jt.minY,jt.maxY,rt),cn=ze(cr,at,je+Yt,je+Jt,1,jt.minY,jt.maxY,rt),cr=null),bt>1&&console.timeEnd("clipping"),Ge.push(ln||[],me+1,2*we,2*je),Ge.push(vn||[],me+1,2*we,2*je+1),Ge.push(wn||[],me+1,2*we+1,2*je),Ge.push(cn||[],me+1,2*we+1,2*je+1)}}getTile(he,me,we){he=+he,me=+me,we=+we;const je=this.options,{extent:qe,debug:Fe}=je;if(he<0||he>24)return null;const Xe=1<<he,Ge=qn(he,me=me+Xe&Xe-1,we);if(this.tiles[Ge])return en(this.tiles[Ge],qe);Fe>1&&console.log("drilling down to z%d-%d-%d",he,me,we);let rt,bt=he,at=me,Et=we;for(;!rt&&bt>0;)bt--,at>>=1,Et>>=1,rt=this.tiles[qn(bt,at,Et)];return rt&&rt.source?(Fe>1&&(console.log("found parent tile z%d-%d-%d",bt,at,Et),console.time("drilling down")),this.splitTile(rt.source,bt,at,Et,he,me,we),Fe>1&&console.timeEnd("drilling down"),this.tiles[Ge]?en(this.tiles[Ge],qe):null):null}}function qn(ve,he,me){return 32*((1<<ve)*me+he)+ve}function fn(ve,he){return he?ve.properties[he]:ve.id}function dr(ve,he){if(ve==null)return!0;if(ve.type==="Feature")return fn(ve,he)!=null;if(ve.type==="FeatureCollection"){const me=new Set;for(const we of ve.features){const je=fn(we,he);if(je==null||me.has(je))return!1;me.add(je)}return!0}return!1}function Xn(ve,he){const me=new Map;if(ve!=null)if(ve.type==="Feature")me.set(fn(ve,he),ve);else for(const we of ve.features)me.set(fn(we,he),we);return me}class Ir extends g{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(he,me){return l._(this,void 0,void 0,function*(){const we=he.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const je=this._geoJSONIndex.getTile(we.z,we.x,we.y);if(!je)return null;const qe=new class{constructor(Xe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.X,this.length=Xe.length,this._features=Xe}feature(Xe){return new class{constructor(Ge){this._feature=Ge,this.extent=l.X,this.type=Ge.type,this.properties=Ge.tags,"id"in Ge&&!isNaN(Ge.id)&&(this.id=parseInt(Ge.id,10))}loadGeometry(){if(this._feature.type===1){const Ge=[];for(const rt of this._feature.geometry)Ge.push([new l.P(rt[0],rt[1])]);return Ge}{const Ge=[];for(const rt of this._feature.geometry){const bt=[];for(const at of rt)bt.push(new l.P(at[0],at[1]));Ge.push(bt)}return Ge}}toGeoJSON(Ge,rt,bt){return x.call(this,Ge,rt,bt)}}(this._features[Xe])}}(je.features);let Fe=be(qe);return Fe.byteOffset===0&&Fe.byteLength===Fe.buffer.byteLength||(Fe=new Uint8Array(Fe)),{vectorTile:qe,rawData:Fe.buffer}})}loadData(he){return l._(this,void 0,void 0,function*(){var me;(me=this._pendingRequest)===null||me===void 0||me.abort();const we=!!(he&&he.request&&he.request.collectResourceTiming)&&new l.bv(he.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(he,this._pendingRequest),this._geoJSONIndex=he.cluster?new Y(function({superclusterOptions:Fe,clusterProperties:Xe}){if(!Xe||!Fe)return Fe;const Ge={},rt={},bt={accumulated:null,zoom:0},at={properties:null},Et=Object.keys(Xe);for(const jt of Et){const[Kt,Yt]=Xe[jt],Zt=l.bC(Yt),Jt=l.bC(typeof Kt=="string"?[Kt,["accumulated"],["get",jt]]:Kt);Ge[jt]=Zt.value,rt[jt]=Jt.value}return Fe.map=jt=>{at.properties=jt;const Kt={};for(const Yt of Et)Kt[Yt]=Ge[Yt].evaluate(bt,at);return Kt},Fe.reduce=(jt,Kt)=>{at.properties=Kt;for(const Yt of Et)bt.accumulated=jt[Yt],jt[Yt]=rt[Yt].evaluate(bt,at)},Fe}(he)).load((yield this._pendingData).features):(je=yield this._pendingData,new dt(je,he.geojsonVtOptions)),this.loaded={};const qe={};if(we){const Fe=we.finish();Fe&&(qe.resourceTiming={},qe.resourceTiming[he.source]=JSON.parse(JSON.stringify(Fe)))}return qe}catch(qe){if(delete this._pendingRequest,l.bB(qe))return{abandoned:!0};throw qe}var je})}getData(){return l._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(he){const me=this.loaded;return me&&me[he.uid]?super.reloadTile(he):this.loadTile(he)}loadAndProcessGeoJSON(he,me){return l._(this,void 0,void 0,function*(){let we=yield this.loadGeoJSON(he,me);if(delete this._pendingRequest,typeof we!="object")throw new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`);if(p(we,!0),he.filter){const je=l.bC(he.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(je.result==="error")throw new Error(je.value.map(Fe=>`${Fe.key}: ${Fe.message}`).join(", "));we={type:"FeatureCollection",features:we.features.filter(Fe=>je.value.evaluate({zoom:0},Fe))}}return we})}loadGeoJSON(he,me){return l._(this,void 0,void 0,function*(){const{promoteId:we}=he;if(he.request){const je=yield l.h(he.request,me);return this._dataUpdateable=dr(je.data,we)?Xn(je.data,we):void 0,je.data}if(typeof he.data=="string")try{const je=JSON.parse(he.data);return this._dataUpdateable=dr(je,we)?Xn(je,we):void 0,je}catch{throw new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`)}if(!he.dataDiff)throw new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${he.source}`);return function(je,qe,Fe){var Xe,Ge,rt,bt;if(qe.removeAll&&je.clear(),qe.remove)for(const at of qe.remove)je.delete(at);if(qe.add)for(const at of qe.add){const Et=fn(at,Fe);Et!=null&&je.set(Et,at)}if(qe.update)for(const at of qe.update){let Et=je.get(at.id);if(Et==null)continue;const jt=!at.removeAllProperties&&(((Xe=at.removeProperties)===null||Xe===void 0?void 0:Xe.length)>0||((Ge=at.addOrUpdateProperties)===null||Ge===void 0?void 0:Ge.length)>0);if((at.newGeometry||at.removeAllProperties||jt)&&(Et=Object.assign({},Et),je.set(at.id,Et),jt&&(Et.properties=Object.assign({},Et.properties))),at.newGeometry&&(Et.geometry=at.newGeometry),at.removeAllProperties)Et.properties={};else if(((rt=at.removeProperties)===null||rt===void 0?void 0:rt.length)>0)for(const Kt of at.removeProperties)Object.prototype.hasOwnProperty.call(Et.properties,Kt)&&delete Et.properties[Kt];if(((bt=at.addOrUpdateProperties)===null||bt===void 0?void 0:bt.length)>0)for(const{key:Kt,value:Yt}of at.addOrUpdateProperties)Et.properties[Kt]=Yt}}(this._dataUpdateable,he.dataDiff,we),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(he){return l._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(he){return this._geoJSONIndex.getClusterExpansionZoom(he.clusterId)}getClusterChildren(he){return this._geoJSONIndex.getChildren(he.clusterId)}getClusterLeaves(he){return this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset)}}class Ae{constructor(he){this.self=he,this.actor=new l.F(he),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(me,we)=>{if(this.externalWorkerSourceTypes[me])throw new Error(`Worker source with name "${me}" already registered.`);this.externalWorkerSourceTypes[me]=we},this.self.addProtocol=l.bi,this.self.removeProtocol=l.bj,this.self.registerRTLTextPlugin=me=>{if(l.bD.isParsed())throw new Error("RTL text plugin already registered.");l.bD.setMethods(me)},this.actor.registerMessageHandler("LDT",(me,we)=>this._getDEMWorkerSource(me,we.source).loadTile(we)),this.actor.registerMessageHandler("RDT",(me,we)=>l._(this,void 0,void 0,function*(){this._getDEMWorkerSource(me,we.source).removeTile(we)})),this.actor.registerMessageHandler("GCEZ",(me,we)=>l._(this,void 0,void 0,function*(){return this._getWorkerSource(me,we.type,we.source).getClusterExpansionZoom(we)})),this.actor.registerMessageHandler("GCC",(me,we)=>l._(this,void 0,void 0,function*(){return this._getWorkerSource(me,we.type,we.source).getClusterChildren(we)})),this.actor.registerMessageHandler("GCL",(me,we)=>l._(this,void 0,void 0,function*(){return this._getWorkerSource(me,we.type,we.source).getClusterLeaves(we)})),this.actor.registerMessageHandler("LD",(me,we)=>this._getWorkerSource(me,we.type,we.source).loadData(we)),this.actor.registerMessageHandler("GD",(me,we)=>this._getWorkerSource(me,we.type,we.source).getData()),this.actor.registerMessageHandler("LT",(me,we)=>this._getWorkerSource(me,we.type,we.source).loadTile(we)),this.actor.registerMessageHandler("RT",(me,we)=>this._getWorkerSource(me,we.type,we.source).reloadTile(we)),this.actor.registerMessageHandler("AT",(me,we)=>this._getWorkerSource(me,we.type,we.source).abortTile(we)),this.actor.registerMessageHandler("RMT",(me,we)=>this._getWorkerSource(me,we.type,we.source).removeTile(we)),this.actor.registerMessageHandler("RS",(me,we)=>l._(this,void 0,void 0,function*(){if(!this.workerSources[me]||!this.workerSources[me][we.type]||!this.workerSources[me][we.type][we.source])return;const je=this.workerSources[me][we.type][we.source];delete this.workerSources[me][we.type][we.source],je.removeSource!==void 0&&je.removeSource(we)})),this.actor.registerMessageHandler("RM",me=>l._(this,void 0,void 0,function*(){delete this.layerIndexes[me],delete this.availableImages[me],delete this.workerSources[me],delete this.demWorkerSources[me]})),this.actor.registerMessageHandler("SR",(me,we)=>l._(this,void 0,void 0,function*(){this.referrer=we})),this.actor.registerMessageHandler("SRPS",(me,we)=>this._syncRTLPluginState(me,we)),this.actor.registerMessageHandler("IS",(me,we)=>l._(this,void 0,void 0,function*(){this.self.importScripts(we)})),this.actor.registerMessageHandler("SI",(me,we)=>this._setImages(me,we)),this.actor.registerMessageHandler("UL",(me,we)=>l._(this,void 0,void 0,function*(){this._getLayerIndex(me).update(we.layers,we.removedIds)})),this.actor.registerMessageHandler("SL",(me,we)=>l._(this,void 0,void 0,function*(){this._getLayerIndex(me).replace(we)}))}_setImages(he,me){return l._(this,void 0,void 0,function*(){this.availableImages[he]=me;for(const we in this.workerSources[he]){const je=this.workerSources[he][we];for(const qe in je)je[qe].availableImages=me}})}_syncRTLPluginState(he,me){return l._(this,void 0,void 0,function*(){if(l.bD.isParsed())return l.bD.getState();if(me.pluginStatus!=="loading")return l.bD.setState(me),me;const we=me.pluginURL;if(this.self.importScripts(we),l.bD.isParsed()){const je={pluginStatus:"loaded",pluginURL:we};return l.bD.setState(je),je}throw l.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${we}`)})}_getAvailableImages(he){let me=this.availableImages[he];return me||(me=[]),me}_getLayerIndex(he){let me=this.layerIndexes[he];return me||(me=this.layerIndexes[he]=new r),me}_getWorkerSource(he,me,we){if(this.workerSources[he]||(this.workerSources[he]={}),this.workerSources[he][me]||(this.workerSources[he][me]={}),!this.workerSources[he][me][we]){const je={sendAsync:(qe,Fe)=>(qe.targetMapId=he,this.actor.sendAsync(qe,Fe))};switch(me){case"vector":this.workerSources[he][me][we]=new g(je,this._getLayerIndex(he),this._getAvailableImages(he));break;case"geojson":this.workerSources[he][me][we]=new Ir(je,this._getLayerIndex(he),this._getAvailableImages(he));break;default:this.workerSources[he][me][we]=new this.externalWorkerSourceTypes[me](je,this._getLayerIndex(he),this._getAvailableImages(he))}}return this.workerSources[he][me][we]}_getDEMWorkerSource(he,me){return this.demWorkerSources[he]||(this.demWorkerSources[he]={}),this.demWorkerSources[he][me]||(this.demWorkerSources[he][me]=new _),this.demWorkerSources[he][me]}}return l.i(self)&&(self.worker=new Ae(self)),Ae}),c("index",["exports","./shared"],function(l,r){var h="4.7.1";let m,v;const g={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:$=>new Promise((o,S)=>{const O=requestAnimationFrame(o);$.signal.addEventListener("abort",()=>{cancelAnimationFrame(O),S(r.c())})}),getImageData($,o=0){return this.getImageCanvasContext($).getImageData(-o,-o,$.width+2*o,$.height+2*o)},getImageCanvasContext($){const o=window.document.createElement("canvas"),S=o.getContext("2d",{willReadFrequently:!0});if(!S)throw new Error("failed to create canvas 2d context");return o.width=$.width,o.height=$.height,S.drawImage($,0,0,$.width,$.height),S},resolveURL:$=>(m||(m=document.createElement("a")),m.href=$,m.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(v==null&&(v=matchMedia("(prefers-reduced-motion: reduce)")),v.matches)}};class _{static testProp(o){if(!_.docStyle)return o[0];for(let S=0;S<o.length;S++)if(o[S]in _.docStyle)return o[S];return o[0]}static create(o,S,O){const C=window.document.createElement(o);return S!==void 0&&(C.className=S),O&&O.appendChild(C),C}static createNS(o,S){return window.document.createElementNS(o,S)}static disableDrag(){_.docStyle&&_.selectProp&&(_.userSelect=_.docStyle[_.selectProp],_.docStyle[_.selectProp]="none")}static enableDrag(){_.docStyle&&_.selectProp&&(_.docStyle[_.selectProp]=_.userSelect)}static setTransform(o,S){o.style[_.transformProp]=S}static addEventListener(o,S,O,C={}){o.addEventListener(S,O,"passive"in C?C:C.capture)}static removeEventListener(o,S,O,C={}){o.removeEventListener(S,O,"passive"in C?C:C.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",_.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",_.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",_.suppressClickInternal,!0)},0)}static getScale(o){const S=o.getBoundingClientRect();return{x:S.width/o.offsetWidth||1,y:S.height/o.offsetHeight||1,boundingClientRect:S}}static getPoint(o,S,O){const C=S.boundingClientRect;return new r.P((O.clientX-C.left)/S.x-o.clientLeft,(O.clientY-C.top)/S.y-o.clientTop)}static mousePos(o,S){const O=_.getScale(o);return _.getPoint(o,O,S)}static touchPos(o,S){const O=[],C=_.getScale(o);for(let j=0;j<S.length;j++)O.push(_.getPoint(o,C,S[j]));return O}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}_.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,_.selectProp=_.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),_.transformProp=_.testProp(["transform","WebkitTransform"]);const E={supported:!1,testSupport:function($){!x&&p&&(y?f($):b=$)}};let b,p,x=!1,y=!1;function f($){const o=$.createTexture();$.bindTexture($.TEXTURE_2D,o);try{if($.texImage2D($.TEXTURE_2D,0,$.RGBA,$.RGBA,$.UNSIGNED_BYTE,p),$.isContextLost())return;E.supported=!0}catch{}$.deleteTexture(o),x=!0}var w;typeof document<"u"&&(p=document.createElement("img"),p.onload=()=>{b&&f(b),b=null,y=!0},p.onerror=()=>{x=!0,b=null},p.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function($){let o,S,O,C;$.resetRequestQueue=()=>{o=[],S=0,O=0,C={}},$.addThrottleControl=ce=>{const Se=O++;return C[Se]=ce,Se},$.removeThrottleControl=ce=>{delete C[ce],J()},$.getImage=(ce,Se,Me=!0)=>new Promise((Ce,He)=>{E.supported&&(ce.headers||(ce.headers={}),ce.headers.accept="image/webp,*/*"),r.e(ce,{type:"image"}),o.push({abortController:Se,requestParameters:ce,supportImageRefresh:Me,state:"queued",onError:Ye=>{He(Ye)},onSuccess:Ye=>{Ce(Ye)}}),J()});const j=ce=>r._(this,void 0,void 0,function*(){ce.state="running";const{requestParameters:Se,supportImageRefresh:Me,onError:Ce,onSuccess:He,abortController:Ye}=ce,tt=Me===!1&&!r.i(self)&&!r.g(Se.url)&&(!Se.headers||Object.keys(Se.headers).reduce((vt,kt)=>vt&&kt==="accept",!0));S++;const ht=tt?ie(Se,Ye):r.m(Se,Ye);try{const vt=yield ht;delete ce.abortController,ce.state="completed",vt.data instanceof HTMLImageElement||r.b(vt.data)?He(vt):vt.data&&He({data:yield(yt=vt.data,typeof createImageBitmap=="function"?r.d(yt):r.f(yt)),cacheControl:vt.cacheControl,expires:vt.expires})}catch(vt){delete ce.abortController,Ce(vt)}finally{S--,J()}var yt}),J=()=>{const ce=(()=>{for(const Se of Object.keys(C))if(C[Se]())return!0;return!1})()?r.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:r.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let Se=S;Se<ce&&o.length>0;Se++){const Me=o.shift();Me.abortController.signal.aborted?Se--:j(Me)}},ie=(ce,Se)=>new Promise((Me,Ce)=>{const He=new Image,Ye=ce.url,tt=ce.credentials;tt&&tt==="include"?He.crossOrigin="use-credentials":(tt&&tt==="same-origin"||!r.s(Ye))&&(He.crossOrigin="anonymous"),Se.signal.addEventListener("abort",()=>{He.src="",Ce(r.c())}),He.fetchPriority="high",He.onload=()=>{He.onerror=He.onload=null,Me({data:He})},He.onerror=()=>{He.onerror=He.onload=null,Se.signal.aborted||Ce(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},He.src=Ye})}(w||(w={})),w.resetRequestQueue();class A{constructor(o){this._transformRequestFn=o}transformRequest(o,S){return this._transformRequestFn&&this._transformRequestFn(o,S)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function P($){var o=new r.A(3);return o[0]=$[0],o[1]=$[1],o[2]=$[2],o}var T,R=function($,o,S){return $[0]=o[0]-S[0],$[1]=o[1]-S[1],$[2]=o[2]-S[2],$};T=new r.A(3),r.A!=Float32Array&&(T[0]=0,T[1]=0,T[2]=0);var M=function($){var o=$[0],S=$[1];return o*o+S*S};function L($){const o=[];if(typeof $=="string")o.push({id:"default",url:$});else if($&&$.length>0){const S=[];for(const{id:O,url:C}of $){const j=`${O}${C}`;S.indexOf(j)===-1&&(S.push(j),o.push({id:O,url:C}))}}return o}function W($,o,S){const O=$.split("?");return O[0]+=`${o}${S}`,O.join("?")}(function(){var $=new r.A(2);r.A!=Float32Array&&($[0]=0,$[1]=0)})();class G{constructor(o,S,O,C){this.context=o,this.format=O,this.texture=o.gl.createTexture(),this.update(S,C)}update(o,S,O){const{width:C,height:j}=o,J=!(this.size&&this.size[0]===C&&this.size[1]===j||O),{context:ie}=this,{gl:ce}=ie;if(this.useMipmap=!!(S&&S.useMipmap),ce.bindTexture(ce.TEXTURE_2D,this.texture),ie.pixelStoreUnpackFlipY.set(!1),ie.pixelStoreUnpack.set(1),ie.pixelStoreUnpackPremultiplyAlpha.set(this.format===ce.RGBA&&(!S||S.premultiply!==!1)),J)this.size=[C,j],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||r.b(o)?ce.texImage2D(ce.TEXTURE_2D,0,this.format,this.format,ce.UNSIGNED_BYTE,o):ce.texImage2D(ce.TEXTURE_2D,0,this.format,C,j,0,this.format,ce.UNSIGNED_BYTE,o.data);else{const{x:Se,y:Me}=O||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||r.b(o)?ce.texSubImage2D(ce.TEXTURE_2D,0,Se,Me,ce.RGBA,ce.UNSIGNED_BYTE,o):ce.texSubImage2D(ce.TEXTURE_2D,0,Se,Me,C,j,ce.RGBA,ce.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ce.generateMipmap(ce.TEXTURE_2D)}bind(o,S,O){const{context:C}=this,{gl:j}=C;j.bindTexture(j.TEXTURE_2D,this.texture),O!==j.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(O=j.LINEAR),o!==this.filter&&(j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,o),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,O||o),this.filter=o),S!==this.wrap&&(j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,S),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,S),this.wrap=S)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function re($){const{userImage:o}=$;return!!(o&&o.render&&o.render())&&($.data.replace(new Uint8Array(o.data.buffer)),!0)}class Q extends r.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:S,promiseResolve:O}of this.requestors)O(this._getImagesForIds(S));this.requestors=[]}}getImage(o){const S=this.images[o];if(S&&!S.data&&S.spriteData){const O=S.spriteData;S.data=new r.R({width:O.width,height:O.height},O.context.getImageData(O.x,O.y,O.width,O.height).data),S.spriteData=null}return S}addImage(o,S){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,S)&&(this.images[o]=S)}_validate(o,S){let O=!0;const C=S.data||S.spriteData;return this._validateStretch(S.stretchX,C&&C.width)||(this.fire(new r.j(new Error(`Image "${o}" has invalid "stretchX" value`))),O=!1),this._validateStretch(S.stretchY,C&&C.height)||(this.fire(new r.j(new Error(`Image "${o}" has invalid "stretchY" value`))),O=!1),this._validateContent(S.content,S)||(this.fire(new r.j(new Error(`Image "${o}" has invalid "content" value`))),O=!1),O}_validateStretch(o,S){if(!o)return!0;let O=0;for(const C of o){if(C[0]<O||C[1]<C[0]||S<C[1])return!1;O=C[1]}return!0}_validateContent(o,S){if(!o)return!0;if(o.length!==4)return!1;const O=S.spriteData,C=O&&O.width||S.data.width,j=O&&O.height||S.data.height;return!(o[0]<0||C<o[0]||o[1]<0||j<o[1]||o[2]<0||C<o[2]||o[3]<0||j<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,S,O=!0){const C=this.getImage(o);if(O&&(C.data.width!==S.data.width||C.data.height!==S.data.height))throw new Error(`size mismatch between old image (${C.data.width}x${C.data.height}) and new image (${S.data.width}x${S.data.height}).`);S.version=C.version+1,this.images[o]=S,this.updatedImages[o]=!0}removeImage(o){const S=this.images[o];delete this.images[o],delete this.patterns[o],S.userImage&&S.userImage.onRemove&&S.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((S,O)=>{let C=!0;if(!this.isLoaded())for(const j of o)this.images[j]||(C=!1);this.isLoaded()||C?S(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:S})})}_getImagesForIds(o){const S={};for(const O of o){let C=this.getImage(O);C||(this.fire(new r.k("styleimagemissing",{id:O})),C=this.getImage(O)),C?S[O]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,textFitWidth:C.textFitWidth,textFitHeight:C.textFitHeight,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:r.w(`Image "${O}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return S}getPixelSize(){const{width:o,height:S}=this.atlasImage;return{width:o,height:S}}getPattern(o){const S=this.patterns[o],O=this.getImage(o);if(!O)return null;if(S&&S.position.version===O.version)return S.position;if(S)S.position.version=O.version;else{const C={w:O.data.width+2,h:O.data.height+2,x:0,y:0},j=new r.I(C,O);this.patterns[o]={bin:C,position:j}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const S=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new G(o,this.atlasImage,S.RGBA),this.atlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const j in this.patterns)o.push(this.patterns[j].bin);const{w:S,h:O}=r.p(o),C=this.atlasImage;C.resize({width:S||1,height:O||1});for(const j in this.patterns){const{bin:J}=this.patterns[j],ie=J.x+1,ce=J.y+1,Se=this.getImage(j).data,Me=Se.width,Ce=Se.height;r.R.copy(Se,C,{x:0,y:0},{x:ie,y:ce},{width:Me,height:Ce}),r.R.copy(Se,C,{x:0,y:Ce-1},{x:ie,y:ce-1},{width:Me,height:1}),r.R.copy(Se,C,{x:0,y:0},{x:ie,y:ce+Ce},{width:Me,height:1}),r.R.copy(Se,C,{x:Me-1,y:0},{x:ie-1,y:ce},{width:1,height:Ce}),r.R.copy(Se,C,{x:0,y:0},{x:ie+Me,y:ce},{width:1,height:Ce})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const S of o){if(this.callbackDispatchedThisFrame[S])continue;this.callbackDispatchedThisFrame[S]=!0;const O=this.getImage(S);O||r.w(`Image with ID: "${S}" was not found`),re(O)&&this.updateImage(S,O)}}}const oe=1e20;function ae($,o,S,O,C,j,J,ie,ce){for(let Se=o;Se<o+O;Se++)de($,S*j+Se,j,C,J,ie,ce);for(let Se=S;Se<S+C;Se++)de($,Se*j+o,1,O,J,ie,ce)}function de($,o,S,O,C,j,J){j[0]=0,J[0]=-oe,J[1]=oe,C[0]=$[o];for(let ie=1,ce=0,Se=0;ie<O;ie++){C[ie]=$[o+ie*S];const Me=ie*ie;do{const Ce=j[ce];Se=(C[ie]-C[Ce]+Me-Ce*Ce)/(ie-Ce)/2}while(Se<=J[ce]&&--ce>-1);ce++,j[ce]=ie,J[ce]=Se,J[ce+1]=oe}for(let ie=0,ce=0;ie<O;ie++){for(;J[ce+1]<ie;)ce++;const Se=j[ce],Me=ie-Se;$[o+ie*S]=C[Se]+Me*Me}}class be{constructor(o,S){this.requestManager=o,this.localIdeographFontFamily=S,this.entries={}}setURL(o){this.url=o}getGlyphs(o){return r._(this,void 0,void 0,function*(){const S=[];for(const j in o)for(const J of o[j])S.push(this._getAndCacheGlyphsPromise(j,J));const O=yield Promise.all(S),C={};for(const{stack:j,id:J,glyph:ie}of O)C[j]||(C[j]={}),C[j][J]=ie&&{id:ie.id,bitmap:ie.bitmap.clone(),metrics:ie.metrics};return C})}_getAndCacheGlyphsPromise(o,S){return r._(this,void 0,void 0,function*(){let O=this.entries[o];O||(O=this.entries[o]={glyphs:{},requests:{},ranges:{}});let C=O.glyphs[S];if(C!==void 0)return{stack:o,id:S,glyph:C};if(C=this._tinySDF(O,o,S),C)return O.glyphs[S]=C,{stack:o,id:S,glyph:C};const j=Math.floor(S/256);if(256*j>65535)throw new Error("glyphs > 65535 not supported");if(O.ranges[j])return{stack:o,id:S,glyph:C};if(!this.url)throw new Error("glyphsUrl is not set");if(!O.requests[j]){const ie=be.loadGlyphRange(o,j,this.url,this.requestManager);O.requests[j]=ie}const J=yield O.requests[j];for(const ie in J)this._doesCharSupportLocalGlyph(+ie)||(O.glyphs[+ie]=J[+ie]);return O.ranges[j]=!0,{stack:o,id:S,glyph:J[S]||null}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(o))}_tinySDF(o,S,O){const C=this.localIdeographFontFamily;if(!C||!this._doesCharSupportLocalGlyph(O))return;let j=o.tinySDF;if(!j){let ie="400";/bold/i.test(S)?ie="900":/medium/i.test(S)?ie="500":/light/i.test(S)&&(ie="200"),j=o.tinySDF=new be.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:C,fontWeight:ie})}const J=j.draw(String.fromCharCode(O));return{id:O,bitmap:new r.o({width:J.width||60,height:J.height||60},J.data),metrics:{width:J.glyphWidth/2||24,height:J.glyphHeight/2||24,left:J.glyphLeft/2+.5||0,top:J.glyphTop/2-27.5||-8,advance:J.glyphAdvance/2||24,isDoubleResolution:!0}}}}be.loadGlyphRange=function($,o,S,O){return r._(this,void 0,void 0,function*(){const C=256*o,j=C+255,J=O.transformRequest(S.replace("{fontstack}",$).replace("{range}",`${C}-${j}`),"Glyphs"),ie=yield r.l(J,new AbortController);if(!ie||!ie.data)throw new Error(`Could not load glyph range. range: ${o}, ${C}-${j}`);const ce={};for(const Se of r.n(ie.data))ce[Se.id]=Se;return ce})},be.TinySDF=class{constructor({fontSize:$=24,buffer:o=3,radius:S=8,cutoff:O=.25,fontFamily:C="sans-serif",fontWeight:j="normal",fontStyle:J="normal"}={}){this.buffer=o,this.cutoff=O,this.radius=S;const ie=this.size=$+4*o,ce=this._createCanvas(ie),Se=this.ctx=ce.getContext("2d",{willReadFrequently:!0});Se.font=`${J} ${j} ${$}px ${C}`,Se.textBaseline="alphabetic",Se.textAlign="left",Se.fillStyle="black",this.gridOuter=new Float64Array(ie*ie),this.gridInner=new Float64Array(ie*ie),this.f=new Float64Array(ie),this.z=new Float64Array(ie+1),this.v=new Uint16Array(ie)}_createCanvas($){const o=document.createElement("canvas");return o.width=o.height=$,o}draw($){const{width:o,actualBoundingBoxAscent:S,actualBoundingBoxDescent:O,actualBoundingBoxLeft:C,actualBoundingBoxRight:j}=this.ctx.measureText($),J=Math.ceil(S),ie=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(j-C))),ce=Math.min(this.size-this.buffer,J+Math.ceil(O)),Se=ie+2*this.buffer,Me=ce+2*this.buffer,Ce=Math.max(Se*Me,0),He=new Uint8ClampedArray(Ce),Ye={data:He,width:Se,height:Me,glyphWidth:ie,glyphHeight:ce,glyphTop:J,glyphLeft:0,glyphAdvance:o};if(ie===0||ce===0)return Ye;const{ctx:tt,buffer:ht,gridInner:yt,gridOuter:vt}=this;tt.clearRect(ht,ht,ie,ce),tt.fillText($,ht,ht+J);const kt=tt.getImageData(ht,ht,ie,ce);vt.fill(oe,0,Ce),yt.fill(0,0,Ce);for(let lt=0;lt<ce;lt++)for(let Rt=0;Rt<ie;Rt++){const Nt=kt.data[4*(lt*ie+Rt)+3]/255;if(Nt===0)continue;const zt=(lt+ht)*Se+Rt+ht;if(Nt===1)vt[zt]=0,yt[zt]=oe;else{const sn=.5-Nt;vt[zt]=sn>0?sn*sn:0,yt[zt]=sn<0?sn*sn:0}}ae(vt,0,0,Se,Me,Se,this.f,this.v,this.z),ae(yt,ht,ht,ie,ce,Se,this.f,this.v,this.z);for(let lt=0;lt<Ce;lt++){const Rt=Math.sqrt(vt[lt])-Math.sqrt(yt[lt]);He[lt]=Math.round(255-255*(Rt/this.radius+this.cutoff))}return Ye}};class pe{constructor(){this.specification=r.v.light.position}possiblyEvaluate(o,S){return r.x(o.expression.evaluate(S))}interpolate(o,S,O){return{x:r.y.number(o.x,S.x,O),y:r.y.number(o.y,S.y,O),z:r.y.number(o.z,S.z,O)}}}let U;class B extends r.E{constructor(o){super(),U=U||new r.q({anchor:new r.D(r.v.light.anchor),position:new pe,color:new r.D(r.v.light.color),intensity:new r.D(r.v.light.intensity)}),this._transitionable=new r.T(U),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,S={}){if(!this._validate(r.r,o,S))for(const O in o){const C=o[O];O.endsWith("-transition")?this._transitionable.setTransition(O.slice(0,-11),C):this._transitionable.setValue(O,C)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,S,O){return(!O||O.validate!==!1)&&r.t(this,o.call(r.u,{value:S,style:{glyphs:!0,sprite:!0},styleSpec:r.v}))}}const N=new r.q({"sky-color":new r.D(r.v.sky["sky-color"]),"horizon-color":new r.D(r.v.sky["horizon-color"]),"fog-color":new r.D(r.v.sky["fog-color"]),"fog-ground-blend":new r.D(r.v.sky["fog-ground-blend"]),"horizon-fog-blend":new r.D(r.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new r.D(r.v.sky["sky-horizon-blend"]),"atmosphere-blend":new r.D(r.v.sky["atmosphere-blend"])});class z extends r.E{constructor(o){super(),this._transitionable=new r.T(N),this.setSky(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new r.z(0))}setSky(o,S={}){if(!this._validate(r.B,o,S)){o||(o={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const O in o){const C=o[O];O.endsWith("-transition")?this._transitionable.setTransition(O.slice(0,-11),C):this._transitionable.setValue(O,C)}}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,S,O={}){return(O==null?void 0:O.validate)!==!1&&r.t(this,o.call(r.u,r.e({value:S,style:{glyphs:!0,sprite:!0},styleSpec:r.v})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class H{constructor(o,S){this.width=o,this.height=S,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,S){const O=o.join(",")+String(S);return this.dashEntry[O]||(this.dashEntry[O]=this.addDash(o,S)),this.dashEntry[O]}getDashRanges(o,S,O){const C=[];let j=o.length%2==1?-o[o.length-1]*O:0,J=o[0]*O,ie=!0;C.push({left:j,right:J,isDash:ie,zeroLength:o[0]===0});let ce=o[0];for(let Se=1;Se<o.length;Se++){ie=!ie;const Me=o[Se];j=ce*O,ce+=Me,J=ce*O,C.push({left:j,right:J,isDash:ie,zeroLength:Me===0})}return C}addRoundDash(o,S,O){const C=S/2;for(let j=-O;j<=O;j++){const J=this.width*(this.nextRow+O+j);let ie=0,ce=o[ie];for(let Se=0;Se<this.width;Se++){Se/ce.right>1&&(ce=o[++ie]);const Me=Math.abs(Se-ce.left),Ce=Math.abs(Se-ce.right),He=Math.min(Me,Ce);let Ye;const tt=j/O*(C+1);if(ce.isDash){const ht=C-Math.abs(tt);Ye=Math.sqrt(He*He+ht*ht)}else Ye=C-Math.sqrt(He*He+tt*tt);this.data[J+Se]=Math.max(0,Math.min(255,Ye+128))}}}addRegularDash(o){for(let ie=o.length-1;ie>=0;--ie){const ce=o[ie],Se=o[ie+1];ce.zeroLength?o.splice(ie,1):Se&&Se.isDash===ce.isDash&&(Se.left=ce.left,o.splice(ie,1))}const S=o[0],O=o[o.length-1];S.isDash===O.isDash&&(S.left=O.left-this.width,O.right=S.right+this.width);const C=this.width*this.nextRow;let j=0,J=o[j];for(let ie=0;ie<this.width;ie++){ie/J.right>1&&(J=o[++j]);const ce=Math.abs(ie-J.left),Se=Math.abs(ie-J.right),Me=Math.min(ce,Se);this.data[C+ie]=Math.max(0,Math.min(255,(J.isDash?Me:-Me)+128))}}addDash(o,S){const O=S?7:0,C=2*O+1;if(this.nextRow+C>this.height)return r.w("LineAtlas out of space"),null;let j=0;for(let ie=0;ie<o.length;ie++)j+=o[ie];if(j!==0){const ie=this.width/j,ce=this.getDashRanges(o,this.width,ie);S?this.addRoundDash(ce,ie,O):this.addRegularDash(ce)}const J={y:(this.nextRow+O+.5)/this.height,height:2*O/this.height,width:j};return this.nextRow+=C,this.dirty=!0,J}bind(o){const S=o.gl;this.texture?(S.bindTexture(S.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,S.texSubImage2D(S.TEXTURE_2D,0,0,0,this.width,this.height,S.ALPHA,S.UNSIGNED_BYTE,this.data))):(this.texture=S.createTexture(),S.bindTexture(S.TEXTURE_2D,this.texture),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.REPEAT),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.REPEAT),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR),S.texImage2D(S.TEXTURE_2D,0,S.ALPHA,this.width,this.height,0,S.ALPHA,S.UNSIGNED_BYTE,this.data))}}const Y="maplibre_preloaded_worker_pool";class fe{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<fe.workerCount;)this.workers.push(new Worker(r.a.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(S=>{S.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Y]}numActive(){return Object.keys(this.active).length}}const Re=Math.floor(g.hardwareConcurrency/2);let Oe,De;function ot(){return Oe||(Oe=new fe),Oe}fe.workerCount=r.C(globalThis)?Math.max(Math.min(Re,3),1):1;class X{constructor(o,S){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=S;const O=this.workerPool.acquire(S);for(let C=0;C<O.length;C++){const j=new r.F(O[C],S);j.name=`Worker ${C}`,this.actors.push(j)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,S){const O=[];for(const C of this.actors)O.push(C.sendAsync({type:o,data:S}));return Promise.all(O)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(S=>{S.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,S){for(const O of this.actors)O.registerMessageHandler(o,S)}}function ee(){return De||(De=new X(ot(),r.G),De.registerMessageHandler("GR",($,o,S)=>r.m(o,S))),De}function Le($,o){const S=r.H();return r.J(S,S,[1,1,0]),r.K(S,S,[.5*$.width,.5*$.height,1]),r.L(S,S,$.calculatePosMatrix(o.toUnwrapped()))}function Be($,o,S,O,C,j){const J=function(Ce,He,Ye){if(Ce)for(const tt of Ce){const ht=He[tt];if(ht&&ht.source===Ye&&ht.type==="fill-extrusion")return!0}else for(const tt in He){const ht=He[tt];if(ht.source===Ye&&ht.type==="fill-extrusion")return!0}return!1}(C&&C.layers,o,$.id),ie=j.maxPitchScaleFactor(),ce=$.tilesIn(O,ie,J);ce.sort(se);const Se=[];for(const Ce of ce)Se.push({wrappedTileID:Ce.tileID.wrapped().key,queryResults:Ce.tile.queryRenderedFeatures(o,S,$._state,Ce.queryGeometry,Ce.cameraQueryGeometry,Ce.scale,C,j,ie,Le($.transform,Ce.tileID))});const Me=function(Ce){const He={},Ye={};for(const tt of Ce){const ht=tt.queryResults,yt=tt.wrappedTileID,vt=Ye[yt]=Ye[yt]||{};for(const kt in ht){const lt=ht[kt],Rt=vt[kt]=vt[kt]||{},Nt=He[kt]=He[kt]||[];for(const zt of lt)Rt[zt.featureIndex]||(Rt[zt.featureIndex]=!0,Nt.push(zt))}}return He}(Se);for(const Ce in Me)Me[Ce].forEach(He=>{const Ye=He.feature,tt=$.getFeatureState(Ye.layer["source-layer"],Ye.id);Ye.source=Ye.layer.source,Ye.layer["source-layer"]&&(Ye.sourceLayer=Ye.layer["source-layer"]),Ye.state=tt});return Me}function se($,o){const S=$.tileID,O=o.tileID;return S.overscaledZ-O.overscaledZ||S.canonical.y-O.canonical.y||S.wrap-O.wrap||S.canonical.x-O.canonical.x}function _e($,o,S){return r._(this,void 0,void 0,function*(){let O=$;if($.url?O=(yield r.h(o.transformRequest($.url,"Source"),S)).data:yield g.frameAsync(S),!O)return null;const C=r.M(r.e(O,$),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in O&&O.vector_layers&&(C.vectorLayerIds=O.vector_layers.map(j=>j.id)),C})}class te{constructor(o,S){o&&(S?this.setSouthWest(o).setNorthEast(S):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof r.N?new r.N(o.lng,o.lat):r.N.convert(o),this}setSouthWest(o){return this._sw=o instanceof r.N?new r.N(o.lng,o.lat):r.N.convert(o),this}extend(o){const S=this._sw,O=this._ne;let C,j;if(o instanceof r.N)C=o,j=o;else{if(!(o instanceof te))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(te.convert(o)):this.extend(r.N.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(r.N.convert(o)):this;if(C=o._sw,j=o._ne,!C||!j)return this}return S||O?(S.lng=Math.min(C.lng,S.lng),S.lat=Math.min(C.lat,S.lat),O.lng=Math.max(j.lng,O.lng),O.lat=Math.max(j.lat,O.lat)):(this._sw=new r.N(C.lng,C.lat),this._ne=new r.N(j.lng,j.lat)),this}getCenter(){return new r.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new r.N(this.getWest(),this.getNorth())}getSouthEast(){return new r.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:S,lat:O}=r.N.convert(o);let C=this._sw.lng<=S&&S<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=S&&S>=this._ne.lng),this._sw.lat<=O&&O<=this._ne.lat&&C}static convert(o){return o instanceof te?o:o&&new te(o)}static fromLngLat(o,S=0){const O=360*S/40075017,C=O/Math.cos(Math.PI/180*o.lat);return new te(new r.N(o.lng-C,o.lat-O),new r.N(o.lng+C,o.lat+O))}adjustAntiMeridian(){const o=new r.N(this._sw.lng,this._sw.lat),S=new r.N(this._ne.lng,this._ne.lat);return new te(o,o.lng>S.lng?new r.N(S.lng+360,S.lat):S)}}class $e{constructor(o,S,O){this.bounds=te.convert(this.validateBounds(o)),this.minzoom=S||0,this.maxzoom=O||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const S=Math.pow(2,o.z),O=Math.floor(r.O(this.bounds.getWest())*S),C=Math.floor(r.Q(this.bounds.getNorth())*S),j=Math.ceil(r.O(this.bounds.getEast())*S),J=Math.ceil(r.Q(this.bounds.getSouth())*S);return o.x>=O&&o.x<j&&o.y>=C&&o.y<J}}class ge extends r.E{constructor(o,S,O,C){if(super(),this.id=o,this.dispatcher=O,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.e(this,r.M(S,["url","scheme","tileSize","promoteId"])),this._options=r.e({type:"vector"},S),this._collectResourceTiming=S.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){return r._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new r.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield _e(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o&&(r.e(this,o),o.bounds&&(this.tileBounds=new $e(o.bounds,this.minzoom,this.maxzoom)),this.fire(new r.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.k("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new r.j(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return r.e({},this._options)}loadTile(o){return r._(this,void 0,void 0,function*(){const S=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O={request:this.map._requestManager.transformRequest(S,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};O.request.collectResourceTiming=this._collectResourceTiming;let C="RT";if(o.actor&&o.state!=="expired"){if(o.state==="loading")return new Promise((j,J)=>{o.reloadPromise={resolve:j,reject:J}})}else o.actor=this.dispatcher.getActor(),C="LT";o.abortController=new AbortController;try{const j=yield o.actor.sendAsync({type:C,data:O},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,j)}catch(j){if(delete o.abortController,o.aborted)return;if(j&&j.status!==404)throw j;this._afterTileLoadWorkerResponse(o,null)}})}_afterTileLoadWorkerResponse(o,S){if(S&&S.resourceTiming&&(o.resourceTiming=S.resourceTiming),S&&this.map._refreshExpiredTiles&&o.setExpiryData(S),o.loadVectorData(S,this.map.painter),o.reloadPromise){const O=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(O.resolve).catch(O.reject)}}abortTile(o){return r._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return r._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class le extends r.E{constructor(o,S,O,C){super(),this.id=o,this.dispatcher=O,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.e({type:"raster"},S),r.e(this,r.M(S,["url","scheme","tileSize"]))}load(){return r._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new r.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield _e(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(r.e(this,o),o.bounds&&(this.tileBounds=new $e(o.bounds,this.minzoom,this.maxzoom)),this.fire(new r.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.k("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new r.j(o))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return r.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return r._(this,void 0,void 0,function*(){const S=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const O=yield w.getImage(this.map._requestManager.transformRequest(S,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(O&&O.data){this.map._refreshExpiredTiles&&O.cacheControl&&O.expires&&o.setExpiryData({cacheControl:O.cacheControl,expires:O.expires});const C=this.map.painter.context,j=C.gl,J=O.data;o.texture=this.map.painter.getTileTexture(J.width),o.texture?o.texture.update(J,{useMipmap:!0}):(o.texture=new G(C,J,j.RGBA,{useMipmap:!0}),o.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(O){if(delete o.abortController,o.aborted)o.state="unloaded";else if(O)throw o.state="errored",O}})}abortTile(o){return r._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return r._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class ze extends le{constructor(o,S,O,C){super(o,S,O,C),this.type="raster-dem",this.maxzoom=22,this._options=r.e({type:"raster-dem"},S),this.encoding=S.encoding||"mapbox",this.redFactor=S.redFactor,this.greenFactor=S.greenFactor,this.blueFactor=S.blueFactor,this.baseShift=S.baseShift}loadTile(o){return r._(this,void 0,void 0,function*(){const S=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),O=this.map._requestManager.transformRequest(S,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const C=yield w.getImage(O,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(C&&C.data){const j=C.data;this.map._refreshExpiredTiles&&C.cacheControl&&C.expires&&o.setExpiryData({cacheControl:C.cacheControl,expires:C.expires});const J=r.b(j)&&r.U()?j:yield this.readImageNow(j),ie={type:this.type,uid:o.uid,source:this.id,rawImageData:J,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||o.state==="expired"){o.actor=this.dispatcher.getActor();const ce=yield o.actor.sendAsync({type:"LDT",data:ie});o.dem=ce,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(C){if(delete o.abortController,o.aborted)o.state="unloaded";else if(C)throw o.state="errored",C}})}readImageNow(o){return r._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&r.V()){const S=o.width+2,O=o.height+2;try{return new r.R({width:S,height:O},yield r.W(o,-1,-1,S,O))}catch{}}return g.getImageData(o,1)})}_getNeighboringTiles(o){const S=o.canonical,O=Math.pow(2,S.z),C=(S.x-1+O)%O,j=S.x===0?o.wrap-1:o.wrap,J=(S.x+1+O)%O,ie=S.x+1===O?o.wrap+1:o.wrap,ce={};return ce[new r.S(o.overscaledZ,j,S.z,C,S.y).key]={backfilled:!1},ce[new r.S(o.overscaledZ,ie,S.z,J,S.y).key]={backfilled:!1},S.y>0&&(ce[new r.S(o.overscaledZ,j,S.z,C,S.y-1).key]={backfilled:!1},ce[new r.S(o.overscaledZ,o.wrap,S.z,S.x,S.y-1).key]={backfilled:!1},ce[new r.S(o.overscaledZ,ie,S.z,J,S.y-1).key]={backfilled:!1}),S.y+1<O&&(ce[new r.S(o.overscaledZ,j,S.z,C,S.y+1).key]={backfilled:!1},ce[new r.S(o.overscaledZ,o.wrap,S.z,S.x,S.y+1).key]={backfilled:!1},ce[new r.S(o.overscaledZ,ie,S.z,J,S.y+1).key]={backfilled:!1}),ce}unloadTile(o){return r._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}class Je extends r.E{constructor(o,S,O,C){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=O.getActor(),this.setEventedParent(C),this._data=S.data,this._options=r.e({},S),this._collectResourceTiming=S.collectResourceTiming,S.maxzoom!==void 0&&(this.maxzoom=S.maxzoom),S.type&&(this.type=S.type),S.attribution&&(this.attribution=S.attribution),this.promoteId=S.promoteId;const j=r.X/this.tileSize;S.clusterMaxZoom!==void 0&&this.maxzoom<=S.clusterMaxZoom&&r.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${S.clusterMaxZoom}".`),this.workerOptions=r.e({source:this.id,cluster:S.cluster||!1,geojsonVtOptions:{buffer:(S.buffer!==void 0?S.buffer:128)*j,tolerance:(S.tolerance!==void 0?S.tolerance:.375)*j,extent:r.X,maxZoom:this.maxzoom,lineMetrics:S.lineMetrics||!1,generateId:S.generateId||!1},superclusterOptions:{maxZoom:S.clusterMaxZoom!==void 0?S.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,S.clusterMinPoints||2),extent:r.X,radius:(S.clusterRadius||50)*j,log:!1,generateId:S.generateId||!1},clusterProperties:S.clusterProperties,filter:S.filter},S.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return r._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}getData(){return r._(this,void 0,void 0,function*(){const o=r.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,S,O){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:S,offset:O}})}_updateWorkerData(o){return r._(this,void 0,void 0,function*(){const S=r.e({type:this.type},this.workerOptions);o?S.dataDiff=o:typeof this._data=="string"?(S.request=this.map._requestManager.transformRequest(g.resolveURL(this._data),"Source"),S.request.collectResourceTiming=this._collectResourceTiming):S.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new r.k("dataloading",{dataType:"source"}));try{const O=yield this.actor.sendAsync({type:"LD",data:S});if(this._pendingLoads--,this._removed||O.abandoned)return void this.fire(new r.k("dataabort",{dataType:"source"}));let C=null;O.resourceTiming&&O.resourceTiming[this.id]&&(C=O.resourceTiming[this.id].slice(0));const j={dataType:"source"};this._collectResourceTiming&&C&&C.length>0&&r.e(j,{resourceTiming:C}),this.fire(new r.k("data",Object.assign(Object.assign({},j),{sourceDataType:"metadata"}))),this.fire(new r.k("data",Object.assign(Object.assign({},j),{sourceDataType:"content"})))}catch(O){if(this._pendingLoads--,this._removed)return void this.fire(new r.k("dataabort",{dataType:"source"}));this.fire(new r.j(O))}})}loaded(){return this._pendingLoads===0}loadTile(o){return r._(this,void 0,void 0,function*(){const S=o.actor?"RT":"LT";o.actor=this.actor;const O={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.abortController=new AbortController;const C=yield this.actor.sendAsync({type:S,data:O},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(C,this.map.painter,S==="RT")})}abortTile(o){return r._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return r._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return r.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var et=r.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ft extends r.E{constructor(o,S,O,C){super(),this.id=o,this.dispatcher=O,this.coordinates=S.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=S}load(o){return r._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new r.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const S=yield w.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,S&&S.data&&(this.image=S.data,o&&(this.coordinates=o),this._finishLoading())}catch(S){this._request=null,this._loaded=!0,this.fire(new r.j(S))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const S=o.map(r.Z.fromLngLat);this.tileID=function(C){let j=1/0,J=1/0,ie=-1/0,ce=-1/0;for(const He of C)j=Math.min(j,He.x),J=Math.min(J,He.y),ie=Math.max(ie,He.x),ce=Math.max(ce,He.y);const Se=Math.max(ie-j,ce-J),Me=Math.max(0,Math.floor(-Math.log(Se)/Math.LN2)),Ce=Math.pow(2,Me);return new r.a1(Me,Math.floor((j+ie)/2*Ce),Math.floor((J+ce)/2*Ce))}(S),this.minzoom=this.maxzoom=this.tileID.z;const O=S.map(C=>this.tileID.getTilePoint(C)._round());return this._boundsArray=new r.$,this._boundsArray.emplaceBack(O[0].x,O[0].y,0,0),this._boundsArray.emplaceBack(O[1].x,O[1].y,r.X,0),this._boundsArray.emplaceBack(O[3].x,O[3].y,0,r.X),this._boundsArray.emplaceBack(O[2].x,O[2].y,r.X,r.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new r.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,S=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=r.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new G(o,this.image,S.RGBA),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE));let O=!1;for(const C in this.tiles){const j=this.tiles[C];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture,O=!0)}O&&this.fire(new r.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return r._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class wt extends ft{constructor(o,S,O,C){super(o,S,O,C),this.roundZoom=!0,this.type="video",this.options=S}load(){return r._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const S of o.urls)this.urls.push(this.map._requestManager.transformRequest(S,"Source").url);try{const S=yield r.a3(this.urls);if(this._loaded=!0,!S)return;this.video=S,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(S){this.fire(new r.j(S))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const S=this.video.seekable;o<S.start(0)||o>S.end(0)?this.fire(new r.j(new r.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${S.start(0)} and ${S.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,S=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=r.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.texSubImage2D(S.TEXTURE_2D,0,0,0,S.RGBA,S.UNSIGNED_BYTE,this.video)):(this.texture=new G(o,this.video,S.RGBA),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE));let O=!1;for(const C in this.tiles){const j=this.tiles[C];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture,O=!0)}O&&this.fire(new r.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class It extends ft{constructor(o,S,O,C){super(o,S,O,C),S.coordinates?Array.isArray(S.coordinates)&&S.coordinates.length===4&&!S.coordinates.some(j=>!Array.isArray(j)||j.length!==2||j.some(J=>typeof J!="number"))||this.fire(new r.j(new r.a2(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.j(new r.a2(`sources.${o}`,null,'missing required property "coordinates"'))),S.animate&&typeof S.animate!="boolean"&&this.fire(new r.j(new r.a2(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),S.canvas?typeof S.canvas=="string"||S.canvas instanceof HTMLCanvasElement||this.fire(new r.j(new r.a2(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.j(new r.a2(`sources.${o}`,null,'missing required property "canvas"'))),this.options=S,this.animate=S.animate===void 0||S.animate}load(){return r._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const S=this.map.painter.context,O=S.gl;this.boundsBuffer||(this.boundsBuffer=S.createVertexBuffer(this._boundsArray,et.members)),this.boundsSegments||(this.boundsSegments=r.a0.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new G(S,this.canvas,O.RGBA,{premultiply:!0});let C=!1;for(const j in this.tiles){const J=this.tiles[j];J.state!=="loaded"&&(J.state="loaded",J.texture=this.texture,C=!0)}C&&this.fire(new r.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Ct={},tn=$=>{switch($){case"geojson":return Je;case"image":return ft;case"raster":return le;case"raster-dem":return ze;case"vector":return ge;case"video":return wt;case"canvas":return It}return Ct[$]},xt="RTLPluginLoaded";class Ht extends r.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ee()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(S=>{throw this.status="error",S})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return r._(this,arguments,void 0,function*(S,O=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=g.resolveURL(S),!this.url)throw new Error(`requested url ${S} is invalid`);if(this.status==="unavailable"){if(!O)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return r._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new r.k(xt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let en=null;function kn(){return en||(en=new Ht),en}class Dn{constructor(o,S){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=r.a4(),this.uses=0,this.tileSize=S,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const S=o+this.timeAdded;S<this.fadeEndTime||(this.fadeEndTime=S)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,S,O){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(C,j){const J={};if(!j)return J;for(const ie of C){const ce=ie.layerIds.map(Se=>j.getLayer(Se)).filter(Boolean);if(ce.length!==0){ie.layers=ce,ie.stateDependentLayerIds&&(ie.stateDependentLayers=ie.stateDependentLayerIds.map(Se=>ce.filter(Me=>Me.id===Se)[0]));for(const Se of ce)J[Se.id]=ie}}return J}(o.buckets,S.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const j=this.buckets[C];if(j instanceof r.a6){if(this.hasSymbolBuckets=!0,!O)break;j.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const j=this.buckets[C];if(j instanceof r.a6&&j.hasRTLText){this.hasRTLText=!0,kn().lazyLoad();break}}this.queryPadding=0;for(const C in this.buckets){const j=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,S.style.getLayer(C).queryRadius(j))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new r.a5}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const O in this.buckets){const C=this.buckets[O];C.uploadPending()&&C.upload(o)}const S=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new G(o,this.imageAtlas.image,S.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new G(o,this.glyphAtlasImage,S.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,S,O,C,j,J,ie,ce,Se,Me){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:j,scale:J,tileSize:this.tileSize,pixelPosMatrix:Me,transform:ce,params:ie,queryPadding:this.queryPadding*Se},o,S,O):{}}querySourceFeatures(o,S){const O=this.latestFeatureIndex;if(!O||!O.rawTileData)return;const C=O.loadVTLayers(),j=S&&S.sourceLayer?S.sourceLayer:"",J=C._geojsonTileLayer||C[j];if(!J)return;const ie=r.a7(S&&S.filter),{z:ce,x:Se,y:Me}=this.tileID.canonical,Ce={z:ce,x:Se,y:Me};for(let He=0;He<J.length;He++){const Ye=J.feature(He);if(ie.needGeometry){const yt=r.a8(Ye,!0);if(!ie.filter(new r.z(this.tileID.overscaledZ),yt,this.tileID.canonical))continue}else if(!ie.filter(new r.z(this.tileID.overscaledZ),Ye))continue;const tt=O.getId(Ye,j),ht=new r.a9(Ye,ce,Se,Me,tt);ht.tile=Ce,o.push(ht)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const S=this.expirationTime;if(o.cacheControl){const O=r.aa(o.cacheControl);O["max-age"]&&(this.expirationTime=Date.now()+1e3*O["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const O=Date.now();let C=!1;if(this.expirationTime>O)C=!1;else if(S)if(this.expirationTime<S)C=!0;else{const j=this.expirationTime-S;j?this.expirationTime=O+Math.max(j,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,S){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const O=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!S.style.hasLayer(C))continue;const j=this.buckets[C],J=j.layers[0].sourceLayer||"_geojsonTileLayer",ie=O[J],ce=o[J];if(!ie||!ce||Object.keys(ce).length===0)continue;j.update(ce,ie,this.imageAtlas&&this.imageAtlas.patternPositions||{});const Se=S&&S.style&&S.style.getLayer(C);Se&&(this.queryPadding=Math.max(this.queryPadding,Se.queryRadius(j)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<g.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=g.now()+o}setDependencies(o,S){const O={};for(const C of S)O[C]=!0;this.dependencies[o]=O}hasDependency(o,S){for(const O of o){const C=this.dependencies[O];if(C){for(const j of S)if(C[j])return!0}}return!1}}class Ft{constructor(o,S){this.max=o,this.onRemove=S,this.reset()}reset(){for(const o in this.data)for(const S of this.data[o])S.timeout&&clearTimeout(S.timeout),this.onRemove(S.value);return this.data={},this.order=[],this}add(o,S,O){const C=o.wrapped().key;this.data[C]===void 0&&(this.data[C]=[]);const j={value:S,timeout:void 0};if(O!==void 0&&(j.timeout=setTimeout(()=>{this.remove(o,j)},O)),this.data[C].push(j),this.order.push(C),this.order.length>this.max){const J=this._getAndRemoveByKey(this.order[0]);J&&this.onRemove(J)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const S=this.data[o].shift();return S.timeout&&clearTimeout(S.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),S.value}getByKey(o){const S=this.data[o];return S?S[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,S){if(!this.has(o))return this;const O=o.wrapped().key,C=S===void 0?0:this.data[O].indexOf(S),j=this.data[O][C];return this.data[O].splice(C,1),j.timeout&&clearTimeout(j.timeout),this.data[O].length===0&&delete this.data[O],this.onRemove(j.value),this.order.splice(this.order.indexOf(O),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}filter(o){const S=[];for(const O in this.data)for(const C of this.data[O])o(C.value)||S.push(C);for(const O of S)this.remove(O.value.tileID,O)}}class Tt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,S,O){const C=String(S);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][C]=this.stateChanges[o][C]||{},r.e(this.stateChanges[o][C],O),this.deletedStates[o]===null){this.deletedStates[o]={};for(const j in this.state[o])j!==C&&(this.deletedStates[o][j]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][C]===null){this.deletedStates[o][C]={};for(const j in this.state[o][C])O[j]||(this.deletedStates[o][C][j]=null)}else for(const j in O)this.deletedStates[o]&&this.deletedStates[o][C]&&this.deletedStates[o][C][j]===null&&delete this.deletedStates[o][C][j]}removeFeatureState(o,S,O){if(this.deletedStates[o]===null)return;const C=String(S);if(this.deletedStates[o]=this.deletedStates[o]||{},O&&S!==void 0)this.deletedStates[o][C]!==null&&(this.deletedStates[o][C]=this.deletedStates[o][C]||{},this.deletedStates[o][C][O]=null);else if(S!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][C])for(O in this.deletedStates[o][C]={},this.stateChanges[o][C])this.deletedStates[o][C][O]=null;else this.deletedStates[o][C]=null;else this.deletedStates[o]=null}getState(o,S){const O=String(S),C=r.e({},(this.state[o]||{})[O],(this.stateChanges[o]||{})[O]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const j=this.deletedStates[o][S];if(j===null)return{};for(const J in j)delete C[J]}return C}initializeTileState(o,S){o.setFeatureState(this.state,S)}coalesceChanges(o,S){const O={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const j={};for(const J in this.stateChanges[C])this.state[C][J]||(this.state[C][J]={}),r.e(this.state[C][J],this.stateChanges[C][J]),j[J]=this.state[C][J];O[C]=j}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const j={};if(this.deletedStates[C]===null)for(const J in this.state[C])j[J]={},this.state[C][J]={};else for(const J in this.deletedStates[C]){if(this.deletedStates[C][J]===null)this.state[C][J]={};else for(const ie of Object.keys(this.deletedStates[C][J]))delete this.state[C][J][ie];j[J]=this.state[C][J]}O[C]=O[C]||{},r.e(O[C],j)}if(this.stateChanges={},this.deletedStates={},Object.keys(O).length!==0)for(const C in o)o[C].setFeatureState(O,S)}}class rn extends r.E{constructor(o,S,O){super(),this.id=o,this.dispatcher=O,this.on("data",C=>this._dataHandler(C)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((C,j,J,ie)=>{const ce=new(tn(j.type))(C,j,J,ie);if(ce.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${ce.id}`);return ce})(o,S,O,this),this._tiles={},this._cache=new Ft(0,C=>this._unloadTile(C)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Tt,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const S=this._tiles[o];if(S.state!=="loaded"&&S.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,S,O){return r._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,S,O)}catch(C){o.state="errored",C.status!==404?this._source.fire(new r.j(C,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new r.k("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const S in this._tiles){const O=this._tiles[S];O.upload(o),O.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(dt).map(o=>o.key)}getRenderableIds(o){const S=[];for(const O in this._tiles)this._isIdRenderable(O,o)&&S.push(this._tiles[O]);return o?S.sort((O,C)=>{const j=O.tileID,J=C.tileID,ie=new r.P(j.canonical.x,j.canonical.y)._rotate(this.transform.angle),ce=new r.P(J.canonical.x,J.canonical.y)._rotate(this.transform.angle);return j.overscaledZ-J.overscaledZ||ce.y-ie.y||ce.x-ie.x}).map(O=>O.tileID.key):S.map(O=>O.tileID).sort(dt).map(O=>O.key)}hasRenderableParent(o){const S=this.findLoadedParent(o,0);return!!S&&this._isIdRenderable(S.tileID.key)}_isIdRenderable(o,S){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(S||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,S){return r._(this,void 0,void 0,function*(){const O=this._tiles[o];O&&(O.state!=="loading"&&(O.state=S),yield this._loadTile(O,o,S))})}_tileLoaded(o,S,O){o.timeAdded=g.now(),O==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(S,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new r.k("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const S=this.getRenderableIds();for(let C=0;C<S.length;C++){const j=S[C];if(o.neighboringTiles&&o.neighboringTiles[j]){const J=this.getTileByID(j);O(o,J),O(J,o)}}function O(C,j){C.needsHillshadePrepare=!0,C.needsTerrainPrepare=!0;let J=j.tileID.canonical.x-C.tileID.canonical.x;const ie=j.tileID.canonical.y-C.tileID.canonical.y,ce=Math.pow(2,C.tileID.canonical.z),Se=j.tileID.key;J===0&&ie===0||Math.abs(ie)>1||(Math.abs(J)>1&&(Math.abs(J+ce)===1?J+=ce:Math.abs(J-ce)===1&&(J-=ce)),j.dem&&C.dem&&(C.dem.backfillBorder(j.dem,J,ie),C.neighboringTiles&&C.neighboringTiles[Se]&&(C.neighboringTiles[Se].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,S,O,C){for(const j in this._tiles){let J=this._tiles[j];if(C[j]||!J.hasData()||J.tileID.overscaledZ<=S||J.tileID.overscaledZ>O)continue;let ie=J.tileID;for(;J&&J.tileID.overscaledZ>S+1;){const Se=J.tileID.scaledTo(J.tileID.overscaledZ-1);J=this._tiles[Se.key],J&&J.hasData()&&(ie=Se)}let ce=ie;for(;ce.overscaledZ>S;)if(ce=ce.scaledTo(ce.overscaledZ-1),o[ce.key]){C[ie.key]=ie;break}}}findLoadedParent(o,S){if(o.key in this._loadedParentTiles){const O=this._loadedParentTiles[o.key];return O&&O.tileID.overscaledZ>=S?O:null}for(let O=o.overscaledZ-1;O>=S;O--){const C=o.scaledTo(O),j=this._getLoadedTile(C);if(j)return j}}findLoadedSibling(o){return this._getLoadedTile(o)}_getLoadedTile(o){const S=this._tiles[o.key];return S&&S.hasData()?S:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const S=Math.ceil(o.width/this._source.tileSize)+1,O=Math.ceil(o.height/this._source.tileSize)+1,C=Math.floor(S*O*(this._maxTileCacheZoomLevels===null?r.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),j=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(j)}handleWrapJump(o){const S=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,S){const O={};for(const C in this._tiles){const j=this._tiles[C];j.tileID=j.tileID.unwrapTo(j.tileID.wrap+S),O[j.tileID.key]=j}this._tiles=O;for(const C in this._timers)clearTimeout(this._timers[C]),delete this._timers[C];for(const C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}}_updateCoveredAndRetainedTiles(o,S,O,C,j,J){const ie={},ce={},Se=Object.keys(o),Me=g.now();for(const Ce of Se){const He=o[Ce],Ye=this._tiles[Ce];if(!Ye||Ye.fadeEndTime!==0&&Ye.fadeEndTime<=Me)continue;const tt=this.findLoadedParent(He,S),ht=this.findLoadedSibling(He),yt=tt||ht||null;yt&&(this._addTile(yt.tileID),ie[yt.tileID.key]=yt.tileID),ce[Ce]=He}this._retainLoadedChildren(ce,C,O,o);for(const Ce in ie)o[Ce]||(this._coveredTiles[Ce]=!0,o[Ce]=ie[Ce]);if(J){const Ce={},He={};for(const Ye of j)this._tiles[Ye.key].hasData()?Ce[Ye.key]=Ye:He[Ye.key]=Ye;for(const Ye in He){const tt=He[Ye].children(this._source.maxzoom);this._tiles[tt[0].key]&&this._tiles[tt[1].key]&&this._tiles[tt[2].key]&&this._tiles[tt[3].key]&&(Ce[tt[0].key]=o[tt[0].key]=tt[0],Ce[tt[1].key]=o[tt[1].key]=tt[1],Ce[tt[2].key]=o[tt[2].key]=tt[2],Ce[tt[3].key]=o[tt[3].key]=tt[3],delete He[Ye])}for(const Ye in He){const tt=He[Ye],ht=this.findLoadedParent(tt,this._source.minzoom),yt=this.findLoadedSibling(tt),vt=ht||yt||null;if(vt){Ce[vt.tileID.key]=o[vt.tileID.key]=vt.tileID;for(const kt in Ce)Ce[kt].isChildOf(vt.tileID)&&delete Ce[kt]}}for(const Ye in this._tiles)Ce[Ye]||(this._coveredTiles[Ye]=!0)}}update(o,S){if(!this._sourceLoaded||this._paused)return;let O;this.transform=o,this.terrain=S,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?O=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(Me=>new r.S(Me.canonical.z,Me.wrap,Me.canonical.z,Me.canonical.x,Me.canonical.y)):(O=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:S}),this._source.hasTile&&(O=O.filter(Me=>this._source.hasTile(Me)))):O=[];const C=o.coveringZoomLevel(this._source),j=Math.max(C-rn.maxOverzooming,this._source.minzoom),J=Math.max(C+rn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Me={};for(const Ce of O)if(Ce.canonical.z>this._source.minzoom){const He=Ce.scaledTo(Ce.canonical.z-1);Me[He.key]=He;const Ye=Ce.scaledTo(Math.max(this._source.minzoom,Math.min(Ce.canonical.z,5)));Me[Ye.key]=Ye}O=O.concat(Object.values(Me))}const ie=O.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,ie&&this.fire(new r.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const ce=this._updateRetainedTiles(O,C);qn(this._source.type)&&this._updateCoveredAndRetainedTiles(ce,j,J,C,O,S);for(const Me in ce)this._tiles[Me].clearFadeHold();const Se=r.ab(this._tiles,ce);for(const Me of Se){const Ce=this._tiles[Me];Ce.hasSymbolBuckets&&!Ce.holdingForFade()?Ce.setHoldDuration(this.map._fadeDuration):Ce.hasSymbolBuckets&&!Ce.symbolFadeFinished()||this._removeTile(Me)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,S){var O;const C={},j={},J=Math.max(S-rn.maxOverzooming,this._source.minzoom),ie=Math.max(S+rn.maxUnderzooming,this._source.minzoom),ce={};for(const Se of o){const Me=this._addTile(Se);C[Se.key]=Se,Me.hasData()||S<this._source.maxzoom&&(ce[Se.key]=Se)}this._retainLoadedChildren(ce,S,ie,C);for(const Se of o){let Me=this._tiles[Se.key];if(Me.hasData())continue;if(S+1>this._source.maxzoom){const He=Se.children(this._source.maxzoom)[0],Ye=this.getTile(He);if(Ye&&Ye.hasData()){C[He.key]=He;continue}}else{const He=Se.children(this._source.maxzoom);if(C[He[0].key]&&C[He[1].key]&&C[He[2].key]&&C[He[3].key])continue}let Ce=Me.wasRequested();for(let He=Se.overscaledZ-1;He>=J;--He){const Ye=Se.scaledTo(He);if(j[Ye.key])break;if(j[Ye.key]=!0,Me=this.getTile(Ye),!Me&&Ce&&(Me=this._addTile(Ye)),Me){const tt=Me.hasData();if((tt||!(!((O=this.map)===null||O===void 0)&&O.cancelPendingTileRequestsWhileZooming)||Ce)&&(C[Ye.key]=Ye),Ce=Me.wasRequested(),tt)break}}}return C}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const S=[];let O,C=this._tiles[o].tileID;for(;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){O=this._loadedParentTiles[C.key];break}S.push(C.key);const j=C.scaledTo(C.overscaledZ-1);if(O=this._getLoadedTile(j),O)break;C=j}for(const j of S)this._loadedParentTiles[j]=O}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const o in this._tiles){const S=this._tiles[o].tileID,O=this._getLoadedTile(S);this._loadedSiblingTiles[S.key]=O}}_addTile(o){let S=this._tiles[o.key];if(S)return S;S=this._cache.getAndRemove(o),S&&(this._setTileReloadTimer(o.key,S),S.tileID=o,this._state.initializeTileState(S,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,S)));const O=S;return S||(S=new Dn(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(S,o.key,S.state)),S.uses++,this._tiles[o.key]=S,O||this._source.fire(new r.k("dataloading",{tile:S,coord:S.tileID,dataType:"source"})),S}_setTileReloadTimer(o,S){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const O=S.getExpiryTimeout();O&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},O))}_removeTile(o){const S=this._tiles[o];S&&(S.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),S.uses>0||(S.hasData()&&S.state!=="reloading"?this._cache.add(S.tileID,S,S.getExpiryTimeout()):(S.aborted=!0,this._abortTile(S),this._unloadTile(S))))}_dataHandler(o){const S=o.sourceDataType;o.dataType==="source"&&S==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&o.dataType==="source"&&S==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,S,O){const C=[],j=this.transform;if(!j)return C;const J=O?j.getCameraQueryGeometry(o):o,ie=o.map(tt=>j.pointCoordinate(tt,this.terrain)),ce=J.map(tt=>j.pointCoordinate(tt,this.terrain)),Se=this.getIds();let Me=1/0,Ce=1/0,He=-1/0,Ye=-1/0;for(const tt of ce)Me=Math.min(Me,tt.x),Ce=Math.min(Ce,tt.y),He=Math.max(He,tt.x),Ye=Math.max(Ye,tt.y);for(let tt=0;tt<Se.length;tt++){const ht=this._tiles[Se[tt]];if(ht.holdingForFade())continue;const yt=ht.tileID,vt=Math.pow(2,j.zoom-ht.tileID.overscaledZ),kt=S*ht.queryPadding*r.X/ht.tileSize/vt,lt=[yt.getTilePoint(new r.Z(Me,Ce)),yt.getTilePoint(new r.Z(He,Ye))];if(lt[0].x-kt<r.X&&lt[0].y-kt<r.X&&lt[1].x+kt>=0&&lt[1].y+kt>=0){const Rt=ie.map(zt=>yt.getTilePoint(zt)),Nt=ce.map(zt=>yt.getTilePoint(zt));C.push({tile:ht,tileID:yt,queryGeometry:Rt,cameraQueryGeometry:Nt,scale:vt})}}return C}getVisibleCoordinates(o){const S=this.getRenderableIds(o).map(O=>this._tiles[O].tileID);for(const O of S)O.posMatrix=this.transform.calculatePosMatrix(O.toUnwrapped());return S}hasTransition(){if(this._source.hasTransition())return!0;if(qn(this._source.type)){const o=g.now();for(const S in this._tiles)if(this._tiles[S].fadeEndTime>=o)return!0}return!1}setFeatureState(o,S,O){this._state.updateState(o=o||"_geojsonTileLayer",S,O)}removeFeatureState(o,S,O){this._state.removeFeatureState(o=o||"_geojsonTileLayer",S,O)}getFeatureState(o,S){return this._state.getState(o=o||"_geojsonTileLayer",S)}setDependencies(o,S,O){const C=this._tiles[o];C&&C.setDependencies(S,O)}reloadTilesForDependencies(o,S){for(const O in this._tiles)this._tiles[O].hasDependency(o,S)&&this._reloadTile(O,"reloading");this._cache.filter(O=>!O.hasDependency(o,S))}}function dt($,o){const S=Math.abs(2*$.wrap)-+($.wrap<0),O=Math.abs(2*o.wrap)-+(o.wrap<0);return $.overscaledZ-o.overscaledZ||O-S||o.canonical.y-$.canonical.y||o.canonical.x-$.canonical.x}function qn($){return $==="raster"||$==="image"||$==="video"}rn.maxOverzooming=10,rn.maxUnderzooming=3;class fn{constructor(o,S){this.reset(o,S)}reset(o,S){this.points=o||[],this._distances=[0];for(let O=1;O<this.points.length;O++)this._distances[O]=this._distances[O-1]+this.points[O].dist(this.points[O-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(S||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=r.ac(o,0,1);let S=1,O=this._distances[S];const C=o*this.paddedLength+this.padding;for(;O<C&&S<this._distances.length;)O=this._distances[++S];const j=S-1,J=this._distances[j],ie=O-J,ce=ie>0?(C-J)/ie:0;return this.points[j].mult(1-ce).add(this.points[S].mult(ce))}}function dr($,o){let S=!0;return $==="always"||$!=="never"&&o!=="never"||(S=!1),S}class Xn{constructor(o,S,O){const C=this.boxCells=[],j=this.circleCells=[];this.xCellCount=Math.ceil(o/O),this.yCellCount=Math.ceil(S/O);for(let J=0;J<this.xCellCount*this.yCellCount;J++)C.push([]),j.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=S,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/S,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,S,O,C,j){this._forEachCell(S,O,C,j,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(S),this.bboxes.push(O),this.bboxes.push(C),this.bboxes.push(j)}insertCircle(o,S,O,C){this._forEachCell(S-C,O-C,S+C,O+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(S),this.circles.push(O),this.circles.push(C)}_insertBoxCell(o,S,O,C,j,J){this.boxCells[j].push(J)}_insertCircleCell(o,S,O,C,j,J){this.circleCells[j].push(J)}_query(o,S,O,C,j,J,ie){if(O<0||o>this.width||C<0||S>this.height)return[];const ce=[];if(o<=0&&S<=0&&this.width<=O&&this.height<=C){if(j)return[{key:null,x1:o,y1:S,x2:O,y2:C}];for(let Se=0;Se<this.boxKeys.length;Se++)ce.push({key:this.boxKeys[Se],x1:this.bboxes[4*Se],y1:this.bboxes[4*Se+1],x2:this.bboxes[4*Se+2],y2:this.bboxes[4*Se+3]});for(let Se=0;Se<this.circleKeys.length;Se++){const Me=this.circles[3*Se],Ce=this.circles[3*Se+1],He=this.circles[3*Se+2];ce.push({key:this.circleKeys[Se],x1:Me-He,y1:Ce-He,x2:Me+He,y2:Ce+He})}}else this._forEachCell(o,S,O,C,this._queryCell,ce,{hitTest:j,overlapMode:J,seenUids:{box:{},circle:{}}},ie);return ce}query(o,S,O,C){return this._query(o,S,O,C,!1,null)}hitTest(o,S,O,C,j,J){return this._query(o,S,O,C,!0,j,J).length>0}hitTestCircle(o,S,O,C,j){const J=o-O,ie=o+O,ce=S-O,Se=S+O;if(ie<0||J>this.width||Se<0||ce>this.height)return!1;const Me=[];return this._forEachCell(J,ce,ie,Se,this._queryCellCircle,Me,{hitTest:!0,overlapMode:C,circle:{x:o,y:S,radius:O},seenUids:{box:{},circle:{}}},j),Me.length>0}_queryCell(o,S,O,C,j,J,ie,ce){const{seenUids:Se,hitTest:Me,overlapMode:Ce}=ie,He=this.boxCells[j];if(He!==null){const tt=this.bboxes;for(const ht of He)if(!Se.box[ht]){Se.box[ht]=!0;const yt=4*ht,vt=this.boxKeys[ht];if(o<=tt[yt+2]&&S<=tt[yt+3]&&O>=tt[yt+0]&&C>=tt[yt+1]&&(!ce||ce(vt))&&(!Me||!dr(Ce,vt.overlapMode))&&(J.push({key:vt,x1:tt[yt],y1:tt[yt+1],x2:tt[yt+2],y2:tt[yt+3]}),Me))return!0}}const Ye=this.circleCells[j];if(Ye!==null){const tt=this.circles;for(const ht of Ye)if(!Se.circle[ht]){Se.circle[ht]=!0;const yt=3*ht,vt=this.circleKeys[ht];if(this._circleAndRectCollide(tt[yt],tt[yt+1],tt[yt+2],o,S,O,C)&&(!ce||ce(vt))&&(!Me||!dr(Ce,vt.overlapMode))){const kt=tt[yt],lt=tt[yt+1],Rt=tt[yt+2];if(J.push({key:vt,x1:kt-Rt,y1:lt-Rt,x2:kt+Rt,y2:lt+Rt}),Me)return!0}}}return!1}_queryCellCircle(o,S,O,C,j,J,ie,ce){const{circle:Se,seenUids:Me,overlapMode:Ce}=ie,He=this.boxCells[j];if(He!==null){const tt=this.bboxes;for(const ht of He)if(!Me.box[ht]){Me.box[ht]=!0;const yt=4*ht,vt=this.boxKeys[ht];if(this._circleAndRectCollide(Se.x,Se.y,Se.radius,tt[yt+0],tt[yt+1],tt[yt+2],tt[yt+3])&&(!ce||ce(vt))&&!dr(Ce,vt.overlapMode))return J.push(!0),!0}}const Ye=this.circleCells[j];if(Ye!==null){const tt=this.circles;for(const ht of Ye)if(!Me.circle[ht]){Me.circle[ht]=!0;const yt=3*ht,vt=this.circleKeys[ht];if(this._circlesCollide(tt[yt],tt[yt+1],tt[yt+2],Se.x,Se.y,Se.radius)&&(!ce||ce(vt))&&!dr(Ce,vt.overlapMode))return J.push(!0),!0}}}_forEachCell(o,S,O,C,j,J,ie,ce){const Se=this._convertToXCellCoord(o),Me=this._convertToYCellCoord(S),Ce=this._convertToXCellCoord(O),He=this._convertToYCellCoord(C);for(let Ye=Se;Ye<=Ce;Ye++)for(let tt=Me;tt<=He;tt++)if(j.call(this,o,S,O,C,this.xCellCount*tt+Ye,J,ie,ce))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,S,O,C,j,J){const ie=C-o,ce=j-S,Se=O+J;return Se*Se>ie*ie+ce*ce}_circleAndRectCollide(o,S,O,C,j,J,ie){const ce=(J-C)/2,Se=Math.abs(o-(C+ce));if(Se>ce+O)return!1;const Me=(ie-j)/2,Ce=Math.abs(S-(j+Me));if(Ce>Me+O)return!1;if(Se<=ce||Ce<=Me)return!0;const He=Se-ce,Ye=Ce-Me;return He*He+Ye*Ye<=O*O}}function Ir($,o,S,O,C){const j=r.H();return o?(r.K(j,j,[1/C,1/C,1]),S||r.ad(j,j,O.angle)):r.L(j,O.labelPlaneMatrix,$),j}function Ae($,o,S,O,C){if(o){const j=r.ae($);return r.K(j,j,[C,C,1]),S||r.ad(j,j,-O.angle),j}return O.glCoordMatrix}function ve($,o,S,O){let C;O?(C=[$,o,O($,o),1],r.af(C,C,S)):(C=[$,o,0,1],Yt(C,C,S));const j=C[3];return{point:new r.P(C[0]/j,C[1]/j),signedDistanceFromCamera:j,isOccluded:!1}}function he($,o){return .5+$/o*.5}function me($,o){return $.x>=-o[0]&&$.x<=o[0]&&$.y>=-o[1]&&$.y<=o[1]}function we($,o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,Ye,tt){const ht=O?$.textSizeData:$.iconSizeData,yt=r.ag(ht,S.transform.zoom),vt=[256/S.width*2+1,256/S.height*2+1],kt=O?$.text.dynamicLayoutVertexArray:$.icon.dynamicLayoutVertexArray;kt.clear();const lt=$.lineVertexArray,Rt=O?$.text.placedSymbolArray:$.icon.placedSymbolArray,Nt=S.transform.width/S.transform.height;let zt=!1;for(let sn=0;sn<Rt.length;sn++){const gn=Rt.get(sn);if(gn.hidden||gn.writingMode===r.ah.vertical&&!zt){Kt(gn.numGlyphs,kt);continue}zt=!1;const Cn=ve(gn.anchorX,gn.anchorY,o,tt);if(!me(Cn.point,vt)){Kt(gn.numGlyphs,kt);continue}const Fn=he(S.transform.cameraToCenterDistance,Cn.signedDistanceFromCamera),En=r.ai(ht,yt,gn),Sn=J?En/Fn:En*Fn,Jn={getElevation:tt,labelPlaneMatrix:C,lineVertexArray:lt,pitchWithMap:J,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:Se,tileAnchorPoint:new r.P(gn.anchorX,gn.anchorY),unwrappedTileID:Me,width:Ce,height:He,translation:Ye},Nr=Fe(Jn,gn,Sn,!1,ie,o,j,$.glyphOffsetArray,kt,Nt,ce);zt=Nr.useVertical,(Nr.notEnoughRoom||zt||Nr.needsFlipping&&Fe(Jn,gn,Sn,!0,ie,o,j,$.glyphOffsetArray,kt,Nt,ce).notEnoughRoom)&&Kt(gn.numGlyphs,kt)}O?$.text.dynamicLayoutVertexBuffer.updateData(kt):$.icon.dynamicLayoutVertexBuffer.updateData(kt)}function je($,o,S,O,C,j,J,ie){const ce=j.glyphStartIndex+j.numGlyphs,Se=j.lineStartIndex,Me=j.lineStartIndex+j.lineLength,Ce=o.getoffsetX(j.glyphStartIndex),He=o.getoffsetX(ce-1),Ye=Et($*Ce,S,O,C,j.segment,Se,Me,ie,J);if(!Ye)return null;const tt=Et($*He,S,O,C,j.segment,Se,Me,ie,J);return tt?ie.projectionCache.anyProjectionOccluded?null:{first:Ye,last:tt}:null}function qe($,o,S,O){return $===r.ah.horizontal&&Math.abs(S.y-o.y)>Math.abs(S.x-o.x)*O?{useVertical:!0}:($===r.ah.vertical?o.y<S.y:o.x>S.x)?{needsFlipping:!0}:null}function Fe($,o,S,O,C,j,J,ie,ce,Se,Me){const Ce=S/24,He=o.lineOffsetX*Ce,Ye=o.lineOffsetY*Ce;let tt;if(o.numGlyphs>1){const ht=o.glyphStartIndex+o.numGlyphs,yt=o.lineStartIndex,vt=o.lineStartIndex+o.lineLength,kt=je(Ce,ie,He,Ye,O,o,Me,$);if(!kt)return{notEnoughRoom:!0};const lt=ve(kt.first.point.x,kt.first.point.y,J,$.getElevation).point,Rt=ve(kt.last.point.x,kt.last.point.y,J,$.getElevation).point;if(C&&!O){const Nt=qe(o.writingMode,lt,Rt,Se);if(Nt)return Nt}tt=[kt.first];for(let Nt=o.glyphStartIndex+1;Nt<ht-1;Nt++)tt.push(Et(Ce*ie.getoffsetX(Nt),He,Ye,O,o.segment,yt,vt,$,Me));tt.push(kt.last)}else{if(C&&!O){const yt=ve($.tileAnchorPoint.x,$.tileAnchorPoint.y,j,$.getElevation).point,vt=o.lineStartIndex+o.segment+1,kt=new r.P($.lineVertexArray.getx(vt),$.lineVertexArray.gety(vt)),lt=ve(kt.x,kt.y,j,$.getElevation),Rt=lt.signedDistanceFromCamera>0?lt.point:function(zt,sn,gn,Cn,Fn,En){return Xe(zt,sn,gn,1,Fn,En)}($.tileAnchorPoint,kt,yt,0,j,$),Nt=qe(o.writingMode,yt,Rt,Se);if(Nt)return Nt}const ht=Et(Ce*ie.getoffsetX(o.glyphStartIndex),He,Ye,O,o.segment,o.lineStartIndex,o.lineStartIndex+o.lineLength,$,Me);if(!ht||$.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};tt=[ht]}for(const ht of tt)r.aj(ce,ht.point,ht.angle);return{}}function Xe($,o,S,O,C,j){const J=$.add($.sub(o)._unit()),ie=C!==void 0?ve(J.x,J.y,C,j.getElevation).point:rt(J.x,J.y,j).point,ce=S.sub(ie);return S.add(ce._mult(O/ce.mag()))}function Ge($,o,S){const O=o.projectionCache;if(O.projections[$])return O.projections[$];const C=new r.P(o.lineVertexArray.getx($),o.lineVertexArray.gety($)),j=rt(C.x,C.y,o);if(j.signedDistanceFromCamera>0)return O.projections[$]=j.point,O.anyProjectionOccluded=O.anyProjectionOccluded||j.isOccluded,j.point;const J=$-S.direction;return function(ie,ce,Se,Me,Ce){return Xe(ie,ce,Se,Me,void 0,Ce)}(S.distanceFromAnchor===0?o.tileAnchorPoint:new r.P(o.lineVertexArray.getx(J),o.lineVertexArray.gety(J)),C,S.previousVertex,S.absOffsetX-S.distanceFromAnchor+1,o)}function rt($,o,S){const O=$+S.translation[0],C=o+S.translation[1];let j;return!S.pitchWithMap&&S.projection.useSpecialProjectionForSymbols?(j=S.projection.projectTileCoordinates(O,C,S.unwrappedTileID,S.getElevation),j.point.x=(.5*j.point.x+.5)*S.width,j.point.y=(.5*-j.point.y+.5)*S.height):(j=ve(O,C,S.labelPlaneMatrix,S.getElevation),j.isOccluded=!1),j}function bt($,o,S){return $._unit()._perp()._mult(o*S)}function at($,o,S,O,C,j,J,ie,ce){if(ie.projectionCache.offsets[$])return ie.projectionCache.offsets[$];const Se=S.add(o);if($+ce.direction<O||$+ce.direction>=C)return ie.projectionCache.offsets[$]=Se,Se;const Me=Ge($+ce.direction,ie,ce),Ce=bt(Me.sub(S),J,ce.direction),He=S.add(Ce),Ye=Me.add(Ce);return ie.projectionCache.offsets[$]=r.ak(j,Se,He,Ye)||Se,ie.projectionCache.offsets[$]}function Et($,o,S,O,C,j,J,ie,ce){const Se=O?$-o:$+o;let Me=Se>0?1:-1,Ce=0;O&&(Me*=-1,Ce=Math.PI),Me<0&&(Ce+=Math.PI);let He,Ye=Me>0?j+C:j+C+1;ie.projectionCache.cachedAnchorPoint?He=ie.projectionCache.cachedAnchorPoint:(He=rt(ie.tileAnchorPoint.x,ie.tileAnchorPoint.y,ie).point,ie.projectionCache.cachedAnchorPoint=He);let tt,ht,yt=He,vt=He,kt=0,lt=0;const Rt=Math.abs(Se),Nt=[];let zt;for(;kt+lt<=Rt;){if(Ye+=Me,Ye<j||Ye>=J)return null;kt+=lt,vt=yt,ht=tt;const Cn={absOffsetX:Rt,direction:Me,distanceFromAnchor:kt,previousVertex:vt};if(yt=Ge(Ye,ie,Cn),S===0)Nt.push(vt),zt=yt.sub(vt);else{let Fn;const En=yt.sub(vt);Fn=En.mag()===0?bt(Ge(Ye+Me,ie,Cn).sub(yt),S,Me):bt(En,S,Me),ht||(ht=vt.add(Fn)),tt=at(Ye,Fn,yt,j,J,ht,S,ie,Cn),Nt.push(ht),zt=tt.sub(ht)}lt=zt.mag()}const sn=zt._mult((Rt-kt)/lt)._add(ht||vt),gn=Ce+Math.atan2(yt.y-vt.y,yt.x-vt.x);return Nt.push(sn),{point:sn,angle:ce?gn:0,path:Nt}}const jt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Kt($,o){for(let S=0;S<$;S++){const O=o.length;o.resize(O+4),o.float32.set(jt,3*O)}}function Yt($,o,S){const O=o[0],C=o[1];return $[0]=S[0]*O+S[4]*C+S[12],$[1]=S[1]*O+S[5]*C+S[13],$[3]=S[3]*O+S[7]*C+S[15],$}const Zt=100;class Jt{constructor(o,S,O=new Xn(o.width+200,o.height+200,25),C=new Xn(o.width+200,o.height+200,25)){this.transform=o,this.mapProjection=S,this.grid=O,this.ignoredGrid=C,this.pitchFactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Zt,this.screenBottomBoundary=o.height+Zt,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,S,O,C,j,J,ie,ce,Se,Me,Ce){const He=o.anchorPointX+ce[0],Ye=o.anchorPointY+ce[1],tt=this.projectAndGetPerspectiveRatio(C,He,Ye,j,Me),ht=O*tt.perspectiveRatio;let yt;if(J||ie)yt=this._projectCollisionBox(o,ht,C,j,J,ie,ce,tt,Me,Ce);else{const Nt=tt.point.x+(Ce?Ce.x*ht:0),zt=tt.point.y+(Ce?Ce.y*ht:0);yt={allPointsOccluded:!1,box:[Nt+o.x1*ht,zt+o.y1*ht,Nt+o.x2*ht,zt+o.y2*ht]}}const[vt,kt,lt,Rt]=yt.box;return this.mapProjection.useSpecialProjectionForSymbols&&(J?yt.allPointsOccluded:this.mapProjection.isOccluded(He,Ye,j))||tt.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(vt,kt,lt,Rt)||S!=="always"&&this.grid.hitTest(vt,kt,lt,Rt,S,Se)?{box:[vt,kt,lt,Rt],placeable:!1,offscreen:!1}:{box:[vt,kt,lt,Rt],placeable:!0,offscreen:this.isOffscreen(vt,kt,lt,Rt)}}placeCollisionCircles(o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,Ye,tt,ht,yt){const vt=[],kt=new r.P(S.anchorX,S.anchorY),lt=this.getPerspectiveRatio(J,kt.x,kt.y,ie,yt),Rt=(Ce?j/lt:j*lt)/r.ap,Nt={getElevation:yt,labelPlaneMatrix:ce,lineVertexArray:O,pitchWithMap:Ce,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:kt,unwrappedTileID:ie,width:this.transform.width,height:this.transform.height,translation:ht},zt=je(Rt,C,S.lineOffsetX*Rt,S.lineOffsetY*Rt,!1,S,!1,Nt);let sn=!1,gn=!1,Cn=!0;if(zt){const Fn=.5*Ye*lt+tt,En=new r.P(-100,-100),Sn=new r.P(this.screenRightBoundary,this.screenBottomBoundary),Jn=new fn,Nr=zt.first,An=zt.last;let Nn=[];for(let Gr=Nr.path.length-1;Gr>=1;Gr--)Nn.push(Nr.path[Gr]);for(let Gr=1;Gr<An.path.length;Gr++)Nn.push(An.path[Gr]);const Rr=2.5*Fn;if(Se){const Gr=this.projectPathToScreenSpace(Nn,Nt,Se);Nn=Gr.some(ti=>ti.signedDistanceFromCamera<=0)?[]:Gr.map(ti=>ti.point)}let Ni=[];if(Nn.length>0){const Gr=Nn[0].clone(),ti=Nn[0].clone();for(let $i=1;$i<Nn.length;$i++)Gr.x=Math.min(Gr.x,Nn[$i].x),Gr.y=Math.min(Gr.y,Nn[$i].y),ti.x=Math.max(ti.x,Nn[$i].x),ti.y=Math.max(ti.y,Nn[$i].y);Ni=Gr.x>=En.x&&ti.x<=Sn.x&&Gr.y>=En.y&&ti.y<=Sn.y?[Nn]:ti.x<En.x||Gr.x>Sn.x||ti.y<En.y||Gr.y>Sn.y?[]:r.al([Nn],En.x,En.y,Sn.x,Sn.y)}for(const Gr of Ni){Jn.reset(Gr,.25*Fn);let ti=0;ti=Jn.length<=.5*Fn?1:Math.ceil(Jn.paddedLength/Rr)+1;for(let $i=0;$i<ti;$i++){const ss=$i/Math.max(ti-1,1),Ga=Jn.lerp(ss),Bi=Ga.x+Zt,Vs=Ga.y+Zt;vt.push(Bi,Vs,Fn,0);const ks=Bi-Fn,as=Vs-Fn,Ps=Bi+Fn,Pl=Vs+Fn;if(Cn=Cn&&this.isOffscreen(ks,as,Ps,Pl),gn=gn||this.isInsideGrid(ks,as,Ps,Pl),o!=="always"&&this.grid.hitTestCircle(Bi,Vs,Fn,o,He)&&(sn=!0,!Me))return{circles:[],offscreen:!1,collisionDetected:sn}}}}return{circles:!Me&&sn||!gn||lt<this.perspectiveRatioCutoff?[]:vt,offscreen:Cn,collisionDetected:sn}}projectPathToScreenSpace(o,S,O){return o.map(C=>ve(C.x,C.y,O,S.getElevation))}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const S=[];let O=1/0,C=1/0,j=-1/0,J=-1/0;for(const Me of o){const Ce=new r.P(Me.x+Zt,Me.y+Zt);O=Math.min(O,Ce.x),C=Math.min(C,Ce.y),j=Math.max(j,Ce.x),J=Math.max(J,Ce.y),S.push(Ce)}const ie=this.grid.query(O,C,j,J).concat(this.ignoredGrid.query(O,C,j,J)),ce={},Se={};for(const Me of ie){const Ce=Me.key;if(ce[Ce.bucketInstanceId]===void 0&&(ce[Ce.bucketInstanceId]={}),ce[Ce.bucketInstanceId][Ce.featureIndex])continue;const He=[new r.P(Me.x1,Me.y1),new r.P(Me.x2,Me.y1),new r.P(Me.x2,Me.y2),new r.P(Me.x1,Me.y2)];r.am(S,He)&&(ce[Ce.bucketInstanceId][Ce.featureIndex]=!0,Se[Ce.bucketInstanceId]===void 0&&(Se[Ce.bucketInstanceId]=[]),Se[Ce.bucketInstanceId].push(Ce.featureIndex))}return Se}insertCollisionBox(o,S,O,C,j,J){(O?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:j,collisionGroupID:J,overlapMode:S},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,S,O,C,j,J){const ie=O?this.ignoredGrid:this.grid,ce={bucketInstanceId:C,featureIndex:j,collisionGroupID:J,overlapMode:S};for(let Se=0;Se<o.length;Se+=4)ie.insertCircle(ce,o[Se],o[Se+1],o[Se+2])}projectAndGetPerspectiveRatio(o,S,O,C,j){let J;j?(J=[S,O,j(S,O),1],r.af(J,J,o)):(J=[S,O,0,1],Yt(J,J,o));const ie=J[3];return{point:new r.P((J[0]/ie+1)/2*this.transform.width+Zt,(-J[1]/ie+1)/2*this.transform.height+Zt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/ie*.5,isOccluded:!1,signedDistanceFromCamera:ie}}getPerspectiveRatio(o,S,O,C,j){const J=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(S,O,C,j):ve(S,O,o,j);return .5+this.transform.cameraToCenterDistance/J.signedDistanceFromCamera*.5}isOffscreen(o,S,O,C){return O<Zt||o>=this.screenRightBoundary||C<Zt||S>this.screenBottomBoundary}isInsideGrid(o,S,O,C){return O>=0&&o<this.gridRightBoundary&&C>=0&&S<this.gridBottomBoundary}getViewportMatrix(){const o=r.an([]);return r.J(o,o,[-100,-100,0]),o}_projectCollisionBox(o,S,O,C,j,J,ie,ce,Se,Me){let Ce=new r.P(1,0),He=new r.P(0,1);const Ye=new r.P(o.anchorPointX+ie[0],o.anchorPointY+ie[1]);if(J&&!j){const Cn=this.projectAndGetPerspectiveRatio(O,Ye.x+1,Ye.y,C,Se).point.sub(ce.point).unit(),Fn=Math.atan(Cn.y/Cn.x)+(Cn.x<0?Math.PI:0),En=Math.sin(Fn),Sn=Math.cos(Fn);Ce=new r.P(Sn,En),He=new r.P(-En,Sn)}else if(!J&&j){const Cn=-this.transform.angle,Fn=Math.sin(Cn),En=Math.cos(Cn);Ce=new r.P(En,Fn),He=new r.P(-Fn,En)}let tt=ce.point,ht=S;if(j){tt=Ye;const Cn=this.transform.zoom-Math.floor(this.transform.zoom);ht=Math.pow(2,-Cn),ht*=this.mapProjection.getPitchedTextCorrection(this.transform,Ye,C),Me||(ht*=r.ac(.5+ce.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}Me&&(tt=tt.add(Ce.mult(Me.x*ht)).add(He.mult(Me.y*ht)));const yt=o.x1*ht,vt=o.x2*ht,kt=(yt+vt)/2,lt=o.y1*ht,Rt=o.y2*ht,Nt=(lt+Rt)/2,zt=[{offsetX:yt,offsetY:lt},{offsetX:kt,offsetY:lt},{offsetX:vt,offsetY:lt},{offsetX:vt,offsetY:Nt},{offsetX:vt,offsetY:Rt},{offsetX:kt,offsetY:Rt},{offsetX:yt,offsetY:Rt},{offsetX:yt,offsetY:Nt}];let sn=[];for(const{offsetX:Cn,offsetY:Fn}of zt)sn.push(new r.P(tt.x+Ce.x*Cn+He.x*Fn,tt.y+Ce.y*Cn+He.y*Fn));let gn=!1;if(j){const Cn=sn.map(Fn=>this.projectAndGetPerspectiveRatio(O,Fn.x,Fn.y,C,Se));gn=Cn.some(Fn=>!Fn.isOccluded),sn=Cn.map(Fn=>Fn.point)}else gn=!0;return{box:r.ao(sn),allPointsOccluded:!gn}}}function ln($,o,S){return o*(r.X/($.tileSize*Math.pow(2,S-$.tileID.overscaledZ)))}class vn{constructor(o,S,O,C){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?S:-S))):C&&O?1:0,this.placed=O}isHidden(){return this.opacity===0&&!this.placed}}class wn{constructor(o,S,O,C,j){this.text=new vn(o?o.text:null,S,O,j),this.icon=new vn(o?o.icon:null,S,C,j)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cn{constructor(o,S,O){this.text=o,this.icon=S,this.skipFade=O}}class xn{constructor(){this.invProjMatrix=r.H(),this.viewportMatrix=r.H(),this.circles=[]}}class cr{constructor(o,S,O,C,j){this.bucketInstanceId=o,this.featureIndex=S,this.sourceLayerIndex=O,this.bucketIndex=C,this.tileID=j}}class br{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const S=++this.maxGroupID;this.collisionGroups[o]={ID:S,predicate:O=>O.collisionGroupID===S}}return this.collisionGroups[o]}}function hr($,o,S,O,C){const{horizontalAlign:j,verticalAlign:J}=r.au($);return new r.P(-(j-.5)*o+O[0]*C,-(J-.5)*S+O[1]*C)}class pr{constructor(o,S,O,C,j,J){this.transform=o.clone(),this.terrain=O,this.collisionIndex=new Jt(this.transform,S),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=C,this.retainedQueryData={},this.collisionGroups=new br(j),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=J,J&&(J.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const S=this.terrain;return S?(O,C)=>S.getElevation(o,O,C):null}getBucketParts(o,S,O,C){const j=O.getBucket(S),J=O.latestFeatureIndex;if(!j||!J||S.id!==j.layerIds[0])return;const ie=O.collisionBoxArray,ce=j.layers[0].layout,Se=j.layers[0].paint,Me=Math.pow(2,this.transform.zoom-O.tileID.overscaledZ),Ce=O.tileSize/r.X,He=O.tileID.toUnwrapped(),Ye=this.transform.calculatePosMatrix(He),tt=ce.get("text-pitch-alignment")==="map",ht=ce.get("text-rotation-alignment")==="map",yt=ln(O,1,this.transform.zoom),vt=this.collisionIndex.mapProjection.translatePosition(this.transform,O,Se.get("text-translate"),Se.get("text-translate-anchor")),kt=this.collisionIndex.mapProjection.translatePosition(this.transform,O,Se.get("icon-translate"),Se.get("icon-translate-anchor")),lt=Ir(Ye,tt,ht,this.transform,yt);let Rt=null;if(tt){const zt=Ae(Ye,tt,ht,this.transform,yt);Rt=r.L([],this.transform.labelPlaneMatrix,zt)}this.retainedQueryData[j.bucketInstanceId]=new cr(j.bucketInstanceId,J,j.sourceLayerIndex,j.index,O.tileID);const Nt={bucket:j,layout:ce,translationText:vt,translationIcon:kt,posMatrix:Ye,unwrappedTileID:He,textLabelPlaneMatrix:lt,labelToScreenMatrix:Rt,scale:Me,textPixelRatio:Ce,holdingForFade:O.holdingForFade(),collisionBoxArray:ie,partiallyEvaluatedTextSize:r.ag(j.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(j.sourceID)};if(C)for(const zt of j.sortKeyRanges){const{sortKey:sn,symbolInstanceStart:gn,symbolInstanceEnd:Cn}=zt;o.push({sortKey:sn,symbolInstanceStart:gn,symbolInstanceEnd:Cn,parameters:Nt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:j.symbolInstances.length,parameters:Nt})}attemptAnchorPlacement(o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,Ye,tt,ht,yt,vt,kt,lt){const Rt=r.aq[o.textAnchor],Nt=[o.textOffset0,o.textOffset1],zt=hr(Rt,O,C,Nt,j),sn=this.collisionIndex.placeCollisionBox(S,He,ce,Se,Me,ie,J,yt,Ce.predicate,lt,zt);if((!kt||this.collisionIndex.placeCollisionBox(kt,He,ce,Se,Me,ie,J,vt,Ce.predicate,lt,zt).placeable)&&sn.placeable){let gn;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ye.crossTileID]&&this.prevPlacement.placements[Ye.crossTileID]&&this.prevPlacement.placements[Ye.crossTileID].text&&(gn=this.prevPlacement.variableOffsets[Ye.crossTileID].anchor),Ye.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ye.crossTileID]={textOffset:Nt,width:O,height:C,anchor:Rt,textBoxScale:j,prevAnchor:gn},this.markUsedJustification(tt,Rt,Ye,ht),tt.allowVerticalPlacement&&(this.markUsedOrientation(tt,ht,Ye),this.placedOrientations[Ye.crossTileID]=ht),{shift:zt,placedGlyphBoxes:sn}}}placeLayerBucketPart(o,S,O){const{bucket:C,layout:j,translationText:J,translationIcon:ie,posMatrix:ce,unwrappedTileID:Se,textLabelPlaneMatrix:Me,labelToScreenMatrix:Ce,textPixelRatio:He,holdingForFade:Ye,collisionBoxArray:tt,partiallyEvaluatedTextSize:ht,collisionGroup:yt}=o.parameters,vt=j.get("text-optional"),kt=j.get("icon-optional"),lt=r.ar(j,"text-overlap","text-allow-overlap"),Rt=lt==="always",Nt=r.ar(j,"icon-overlap","icon-allow-overlap"),zt=Nt==="always",sn=j.get("text-rotation-alignment")==="map",gn=j.get("text-pitch-alignment")==="map",Cn=j.get("icon-text-fit")!=="none",Fn=j.get("symbol-z-order")==="viewport-y",En=Rt&&(zt||!C.hasIconData()||kt),Sn=zt&&(Rt||!C.hasTextData()||vt);!C.collisionArrays&&tt&&C.deserializeCollisionBoxes(tt);const Jn=this._getTerrainElevationFunc(this.retainedQueryData[C.bucketInstanceId].tileID),Nr=(An,Nn,Rr)=>{var Ni,Gr;if(S[An.crossTileID])return;if(Ye)return void(this.placements[An.crossTileID]=new cn(!1,!1,!1));let ti=!1,$i=!1,ss=!0,Ga=null,Bi={box:null,placeable:!1,offscreen:null},Vs={box:null,placeable:!1,offscreen:null},ks=null,as=null,Ps=null,Pl=0,Bh=0,Fm=0;Nn.textFeatureIndex?Pl=Nn.textFeatureIndex:An.useRuntimeCollisionCircles&&(Pl=An.featureIndex),Nn.verticalTextFeatureIndex&&(Bh=Nn.verticalTextFeatureIndex);const Fh=Nn.textBox;if(Fh){const Pa=Ko=>{let ls=r.ah.horizontal;if(C.allowVerticalPlacement&&!Ko&&this.prevPlacement){const ua=this.prevPlacement.placedOrientations[An.crossTileID];ua&&(this.placedOrientations[An.crossTileID]=ua,ls=ua,this.markUsedOrientation(C,ls,An))}return ls},Ta=(Ko,ls)=>{if(C.allowVerticalPlacement&&An.numVerticalGlyphVertices>0&&Nn.verticalTextBox){for(const ua of C.writingModes)if(ua===r.ah.vertical?(Bi=ls(),Vs=Bi):Bi=Ko(),Bi&&Bi.placeable)break}else Bi=Ko()},Ic=An.textAnchorOffsetStartIndex,Ka=An.textAnchorOffsetEndIndex;if(Ka===Ic){const Ko=(ls,ua)=>{const ri=this.collisionIndex.placeCollisionBox(ls,lt,He,ce,Se,gn,sn,J,yt.predicate,Jn);return ri&&ri.placeable&&(this.markUsedOrientation(C,ua,An),this.placedOrientations[An.crossTileID]=ua),ri};Ta(()=>Ko(Fh,r.ah.horizontal),()=>{const ls=Nn.verticalTextBox;return C.allowVerticalPlacement&&An.numVerticalGlyphVertices>0&&ls?Ko(ls,r.ah.vertical):{box:null,offscreen:null}}),Pa(Bi&&Bi.placeable)}else{let Ko=r.aq[(Gr=(Ni=this.prevPlacement)===null||Ni===void 0?void 0:Ni.variableOffsets[An.crossTileID])===null||Gr===void 0?void 0:Gr.anchor];const ls=(ri,ku,zh)=>{const Uh=ri.x2-ri.x1,fw=ri.y2-ri.y1,y3=An.textBoxScale,dw=Cn&&Nt==="never"?ku:null;let Rc=null,pw=lt==="never"?1:2,Um="never";Ko&&pw++;for(let Ad=0;Ad<pw;Ad++){for(let Vm=Ic;Vm<Ka;Vm++){const qm=C.textAnchorOffsets.get(Vm);if(Ko&&qm.textAnchor!==Ko)continue;const Vh=this.attemptAnchorPlacement(qm,ri,Uh,fw,y3,sn,gn,He,ce,Se,yt,Um,An,C,zh,J,ie,dw,Jn);if(Vh&&(Rc=Vh.placedGlyphBoxes,Rc&&Rc.placeable))return ti=!0,Ga=Vh.shift,Rc}Ko?Ko=null:Um=lt}return O&&!Rc&&(Rc={box:this.collisionIndex.placeCollisionBox(Fh,"always",He,ce,Se,gn,sn,J,yt.predicate,Jn,new r.P(0,0)).box,offscreen:!1,placeable:!1}),Rc};Ta(()=>ls(Fh,Nn.iconBox,r.ah.horizontal),()=>{const ri=Nn.verticalTextBox;return C.allowVerticalPlacement&&(!Bi||!Bi.placeable)&&An.numVerticalGlyphVertices>0&&ri?ls(ri,Nn.verticalIconBox,r.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Bi&&(ti=Bi.placeable,ss=Bi.offscreen);const ua=Pa(Bi&&Bi.placeable);if(!ti&&this.prevPlacement){const ri=this.prevPlacement.variableOffsets[An.crossTileID];ri&&(this.variableOffsets[An.crossTileID]=ri,this.markUsedJustification(C,ri.anchor,An,ua))}}}if(ks=Bi,ti=ks&&ks.placeable,ss=ks&&ks.offscreen,An.useRuntimeCollisionCircles){const Pa=C.text.placedSymbolArray.get(An.centerJustifiedTextSymbolIndex),Ta=r.ai(C.textSizeData,ht,Pa),Ic=j.get("text-padding");as=this.collisionIndex.placeCollisionCircles(lt,Pa,C.lineVertexArray,C.glyphOffsetArray,Ta,ce,Se,Me,Ce,O,gn,yt.predicate,An.collisionCircleDiameter,Ic,J,Jn),as.circles.length&&as.collisionDetected&&!O&&r.w("Collisions detected, but collision boxes are not shown"),ti=Rt||as.circles.length>0&&!as.collisionDetected,ss=ss&&as.offscreen}if(Nn.iconFeatureIndex&&(Fm=Nn.iconFeatureIndex),Nn.iconBox){const Pa=Ta=>this.collisionIndex.placeCollisionBox(Ta,Nt,He,ce,Se,gn,sn,ie,yt.predicate,Jn,Cn&&Ga?Ga:void 0);Vs&&Vs.placeable&&Nn.verticalIconBox?(Ps=Pa(Nn.verticalIconBox),$i=Ps.placeable):(Ps=Pa(Nn.iconBox),$i=Ps.placeable),ss=ss&&Ps.offscreen}const ka=vt||An.numHorizontalGlyphVertices===0&&An.numVerticalGlyphVertices===0,zm=kt||An.numIconVertices===0;ka||zm?zm?ka||($i=$i&&ti):ti=$i&&ti:$i=ti=$i&&ti;const Z0=$i&&Ps.placeable;if(ti&&ks.placeable&&this.collisionIndex.insertCollisionBox(ks.box,lt,j.get("text-ignore-placement"),C.bucketInstanceId,Vs&&Vs.placeable&&Bh?Bh:Pl,yt.ID),Z0&&this.collisionIndex.insertCollisionBox(Ps.box,Nt,j.get("icon-ignore-placement"),C.bucketInstanceId,Fm,yt.ID),as&&ti&&this.collisionIndex.insertCollisionCircles(as.circles,lt,j.get("text-ignore-placement"),C.bucketInstanceId,Pl,yt.ID),O&&this.storeCollisionData(C.bucketInstanceId,Rr,Nn,ks,Ps,as),An.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(C.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[An.crossTileID]=new cn(ti||En,$i||Sn,ss||C.justReloaded),S[An.crossTileID]=!0};if(Fn){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const An=C.getSortedSymbolIndexes(this.transform.angle);for(let Nn=An.length-1;Nn>=0;--Nn){const Rr=An[Nn];Nr(C.symbolInstances.get(Rr),C.collisionArrays[Rr],Rr)}}else for(let An=o.symbolInstanceStart;An<o.symbolInstanceEnd;An++)Nr(C.symbolInstances.get(An),C.collisionArrays[An],An);if(O&&C.bucketInstanceId in this.collisionCircleArrays){const An=this.collisionCircleArrays[C.bucketInstanceId];r.as(An.invProjMatrix,ce),An.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}storeCollisionData(o,S,O,C,j,J){if(O.textBox||O.iconBox){let ie,ce;this.collisionBoxArrays.has(o)?ie=this.collisionBoxArrays.get(o):(ie=new Map,this.collisionBoxArrays.set(o,ie)),ie.has(S)?ce=ie.get(S):(ce={text:null,icon:null},ie.set(S,ce)),O.textBox&&(ce.text=C.box),O.iconBox&&(ce.icon=j.box)}if(J){let ie=this.collisionCircleArrays[o];ie===void 0&&(ie=this.collisionCircleArrays[o]=new xn);for(let ce=0;ce<J.circles.length;ce+=4)ie.circles.push(J.circles[ce+0]),ie.circles.push(J.circles[ce+1]),ie.circles.push(J.circles[ce+2]),ie.circles.push(J.collisionDetected?1:0)}}markUsedJustification(o,S,O,C){let j;j=C===r.ah.vertical?O.verticalPlacedTextSymbolIndex:{left:O.leftJustifiedTextSymbolIndex,center:O.centerJustifiedTextSymbolIndex,right:O.rightJustifiedTextSymbolIndex}[r.at(S)];const J=[O.leftJustifiedTextSymbolIndex,O.centerJustifiedTextSymbolIndex,O.rightJustifiedTextSymbolIndex,O.verticalPlacedTextSymbolIndex];for(const ie of J)ie>=0&&(o.text.placedSymbolArray.get(ie).crossTileID=j>=0&&ie!==j?0:O.crossTileID)}markUsedOrientation(o,S,O){const C=S===r.ah.horizontal||S===r.ah.horizontalOnly?S:0,j=S===r.ah.vertical?S:0,J=[O.leftJustifiedTextSymbolIndex,O.centerJustifiedTextSymbolIndex,O.rightJustifiedTextSymbolIndex];for(const ie of J)o.text.placedSymbolArray.get(ie).placedOrientation=C;O.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(O.verticalPlacedTextSymbolIndex).placedOrientation=j)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const S=this.prevPlacement;let O=!1;this.prevZoomAdjustment=S?S.zoomAdjustment(this.transform.zoom):0;const C=S?S.symbolFadeChange(o):1,j=S?S.opacities:{},J=S?S.variableOffsets:{},ie=S?S.placedOrientations:{};for(const ce in this.placements){const Se=this.placements[ce],Me=j[ce];Me?(this.opacities[ce]=new wn(Me,C,Se.text,Se.icon),O=O||Se.text!==Me.text.placed||Se.icon!==Me.icon.placed):(this.opacities[ce]=new wn(null,C,Se.text,Se.icon,Se.skipFade),O=O||Se.text||Se.icon)}for(const ce in j){const Se=j[ce];if(!this.opacities[ce]){const Me=new wn(Se,C,!1,!1);Me.isHidden()||(this.opacities[ce]=Me,O=O||Se.text.placed||Se.icon.placed)}}for(const ce in J)this.variableOffsets[ce]||!this.opacities[ce]||this.opacities[ce].isHidden()||(this.variableOffsets[ce]=J[ce]);for(const ce in ie)this.placedOrientations[ce]||!this.opacities[ce]||this.opacities[ce].isHidden()||(this.placedOrientations[ce]=ie[ce]);if(S&&S.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");O?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=S?S.lastPlacementChangeTime:o)}updateLayerOpacities(o,S){const O={};for(const C of S){const j=C.getBucket(o);j&&C.latestFeatureIndex&&o.id===j.layerIds[0]&&this.updateBucketOpacities(j,C.tileID,O,C.collisionBoxArray)}}updateBucketOpacities(o,S,O,C){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const j=o.layers[0],J=j.layout,ie=new wn(null,0,!1,!1,!0),ce=J.get("text-allow-overlap"),Se=J.get("icon-allow-overlap"),Me=j._unevaluatedLayout.hasValue("text-variable-anchor")||j._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ce=J.get("text-rotation-alignment")==="map",He=J.get("text-pitch-alignment")==="map",Ye=J.get("icon-text-fit")!=="none",tt=new wn(null,0,ce&&(Se||!o.hasIconData()||J.get("icon-optional")),Se&&(ce||!o.hasTextData()||J.get("text-optional")),!0);!o.collisionArrays&&C&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(C);const ht=(vt,kt,lt)=>{for(let Rt=0;Rt<kt/4;Rt++)vt.opacityVertexArray.emplaceBack(lt);vt.hasVisibleVertices=vt.hasVisibleVertices||lt!==Ar},yt=this.collisionBoxArrays.get(o.bucketInstanceId);for(let vt=0;vt<o.symbolInstances.length;vt++){const kt=o.symbolInstances.get(vt),{numHorizontalGlyphVertices:lt,numVerticalGlyphVertices:Rt,crossTileID:Nt}=kt;let zt=this.opacities[Nt];O[Nt]?zt=ie:zt||(zt=tt,this.opacities[Nt]=zt),O[Nt]=!0;const sn=kt.numIconVertices>0,gn=this.placedOrientations[kt.crossTileID],Cn=gn===r.ah.vertical,Fn=gn===r.ah.horizontal||gn===r.ah.horizontalOnly;if(lt>0||Rt>0){const Sn=On(zt.text);ht(o.text,lt,Cn?Ar:Sn),ht(o.text,Rt,Fn?Ar:Sn);const Jn=zt.text.isHidden();[kt.rightJustifiedTextSymbolIndex,kt.centerJustifiedTextSymbolIndex,kt.leftJustifiedTextSymbolIndex].forEach(Nn=>{Nn>=0&&(o.text.placedSymbolArray.get(Nn).hidden=Jn||Cn?1:0)}),kt.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(kt.verticalPlacedTextSymbolIndex).hidden=Jn||Fn?1:0);const Nr=this.variableOffsets[kt.crossTileID];Nr&&this.markUsedJustification(o,Nr.anchor,kt,gn);const An=this.placedOrientations[kt.crossTileID];An&&(this.markUsedJustification(o,"left",kt,An),this.markUsedOrientation(o,An,kt))}if(sn){const Sn=On(zt.icon),Jn=!(Ye&&kt.verticalPlacedIconSymbolIndex&&Cn);kt.placedIconSymbolIndex>=0&&(ht(o.icon,kt.numIconVertices,Jn?Sn:Ar),o.icon.placedSymbolArray.get(kt.placedIconSymbolIndex).hidden=zt.icon.isHidden()),kt.verticalPlacedIconSymbolIndex>=0&&(ht(o.icon,kt.numVerticalIconVertices,Jn?Ar:Sn),o.icon.placedSymbolArray.get(kt.verticalPlacedIconSymbolIndex).hidden=zt.icon.isHidden())}const En=yt&&yt.has(vt)?yt.get(vt):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Sn=o.collisionArrays[vt];if(Sn){let Jn=new r.P(0,0);if(Sn.textBox||Sn.verticalTextBox){let Nr=!0;if(Me){const An=this.variableOffsets[Nt];An?(Jn=hr(An.anchor,An.width,An.height,An.textOffset,An.textBoxScale),Ce&&Jn._rotate(He?this.transform.angle:-this.transform.angle)):Nr=!1}if(Sn.textBox||Sn.verticalTextBox){let An;Sn.textBox&&(An=Cn),Sn.verticalTextBox&&(An=Fn),Kr(o.textCollisionBox.collisionVertexArray,zt.text.placed,!Nr||An,En.text,Jn.x,Jn.y)}}if(Sn.iconBox||Sn.verticalIconBox){const Nr=!!(!Fn&&Sn.verticalIconBox);let An;Sn.iconBox&&(An=Nr),Sn.verticalIconBox&&(An=!Nr),Kr(o.iconCollisionBox.collisionVertexArray,zt.icon.placed,An,En.icon,Ye?Jn.x:0,Ye?Jn.y:0)}}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const vt=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=vt.invProjMatrix,o.placementViewportMatrix=vt.viewportMatrix,o.collisionCircleArray=vt.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,S){const O=this.zoomAtLastRecencyCheck===S?1-this.zoomAdjustment(S):1;return this.zoomAtLastRecencyCheck=S,this.commitTime+this.fadeDuration*O>o}setStale(){this.stale=!0}}function Kr($,o,S,O,C,j){O&&O.length!==0||(O=[0,0,0,0]);const J=O[0]-Zt,ie=O[1]-Zt,ce=O[2]-Zt,Se=O[3]-Zt;$.emplaceBack(o?1:0,S?1:0,C||0,j||0,J,ie),$.emplaceBack(o?1:0,S?1:0,C||0,j||0,ce,ie),$.emplaceBack(o?1:0,S?1:0,C||0,j||0,ce,Se),$.emplaceBack(o?1:0,S?1:0,C||0,j||0,J,Se)}const mn=Math.pow(2,25),oi=Math.pow(2,24),eo=Math.pow(2,17),nn=Math.pow(2,16),on=Math.pow(2,9),bn=Math.pow(2,8),ir=Math.pow(2,1);function On($){if($.opacity===0&&!$.placed)return 0;if($.opacity===1&&$.placed)return 4294967295;const o=$.placed?1:0,S=Math.floor(127*$.opacity);return S*mn+o*oi+S*eo+o*nn+S*on+o*bn+S*ir+o}const Ar=0;function zr(){return{isOccluded:($,o,S)=>!1,getPitchedTextCorrection:($,o,S)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates($,o,S,O){throw new Error("Not implemented.")},translatePosition:($,o,S,O)=>function(C,j,J,ie,ce=!1){if(!J[0]&&!J[1])return[0,0];const Se=ce?ie==="map"?C.angle:0:ie==="viewport"?-C.angle:0;if(Se){const Me=Math.sin(Se),Ce=Math.cos(Se);J=[J[0]*Ce-J[1]*Me,J[0]*Me+J[1]*Ce]}return[ce?J[0]:ln(j,J[0],C.zoom),ce?J[1]:ln(j,J[1],C.zoom)]}($,o,S,O),getCircleRadiusCorrection:$=>1}}class kr{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,S,O,C,j){const J=this._bucketParts;for(;this._currentTileIndex<o.length;)if(S.getBucketParts(J,C,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,j())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,J.sort((ie,ce)=>ie.sortKey-ce.sortKey));this._currentPartIndex<J.length;)if(S.placeLayerBucketPart(J[this._currentPartIndex],this._seenCrossTileIDs,O),this._currentPartIndex++,j())return!0;return!1}}class ui{constructor(o,S,O,C,j,J,ie,ce){this.placement=new pr(o,zr(),S,J,ie,ce),this._currentPlacementIndex=O.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=j,this._done=!1}isDone(){return this._done}continuePlacement(o,S,O){const C=g.now(),j=()=>!this._forceFullPlacement&&g.now()-C>2;for(;this._currentPlacementIndex>=0;){const J=S[o[this._currentPlacementIndex]],ie=this.placement.collisionIndex.transform.zoom;if(J.type==="symbol"&&(!J.minzoom||J.minzoom<=ie)&&(!J.maxzoom||J.maxzoom>ie)){if(this._inProgressLayer||(this._inProgressLayer=new kr(J)),this._inProgressLayer.continuePlacement(O[J.source],this.placement,this._showCollisionBoxes,J,j))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Jr=512/r.X/2;class Xr{constructor(o,S,O){this.tileID=o,this.bucketInstanceId=O,this._symbolsByKey={};const C=new Map;for(let j=0;j<S.length;j++){const J=S.get(j),ie=J.key,ce=C.get(ie);ce?ce.push(J):C.set(ie,[J])}for(const[j,J]of C){const ie={positions:J.map(ce=>({x:Math.floor(ce.anchorX*Jr),y:Math.floor(ce.anchorY*Jr)})),crossTileIDs:J.map(ce=>ce.crossTileID)};if(ie.positions.length>128){const ce=new r.av(ie.positions.length,16,Uint16Array);for(const{x:Se,y:Me}of ie.positions)ce.add(Se,Me);ce.finish(),delete ie.positions,ie.index=ce}this._symbolsByKey[j]=ie}}getScaledCoordinates(o,S){const{x:O,y:C,z:j}=this.tileID.canonical,{x:J,y:ie,z:ce}=S.canonical,Se=Jr/Math.pow(2,ce-j),Me=(ie*r.X+o.anchorY)*Se,Ce=C*r.X*Jr;return{x:Math.floor((J*r.X+o.anchorX)*Se-O*r.X*Jr),y:Math.floor(Me-Ce)}}findMatches(o,S,O){const C=this.tileID.canonical.z<S.canonical.z?1:Math.pow(2,this.tileID.canonical.z-S.canonical.z);for(let j=0;j<o.length;j++){const J=o.get(j);if(J.crossTileID)continue;const ie=this._symbolsByKey[J.key];if(!ie)continue;const ce=this.getScaledCoordinates(J,S);if(ie.index){const Se=ie.index.range(ce.x-C,ce.y-C,ce.x+C,ce.y+C).sort();for(const Me of Se){const Ce=ie.crossTileIDs[Me];if(!O[Ce]){O[Ce]=!0,J.crossTileID=Ce;break}}}else if(ie.positions)for(let Se=0;Se<ie.positions.length;Se++){const Me=ie.positions[Se],Ce=ie.crossTileIDs[Se];if(Math.abs(Me.x-ce.x)<=C&&Math.abs(Me.y-ce.y)<=C&&!O[Ce]){O[Ce]=!0,J.crossTileID=Ce;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class wi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const S=Math.round((o-this.lng)/360);if(S!==0)for(const O in this.indexes){const C=this.indexes[O],j={};for(const J in C){const ie=C[J];ie.tileID=ie.tileID.unwrapTo(ie.tileID.wrap+S),j[ie.tileID.key]=ie}this.indexes[O]=j}this.lng=o}addBucket(o,S,O){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===S.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let j=0;j<S.symbolInstances.length;j++)S.symbolInstances.get(j).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const C=this.usedCrossTileIDs[o.overscaledZ];for(const j in this.indexes){const J=this.indexes[j];if(Number(j)>o.overscaledZ)for(const ie in J){const ce=J[ie];ce.tileID.isChildOf(o)&&ce.findMatches(S.symbolInstances,o,C)}else{const ie=J[o.scaledTo(Number(j)).key];ie&&ie.findMatches(S.symbolInstances,o,C)}}for(let j=0;j<S.symbolInstances.length;j++){const J=S.symbolInstances.get(j);J.crossTileID||(J.crossTileID=O.generate(),C[J.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Xr(o,S.symbolInstances,S.bucketInstanceId),!0}removeBucketCrossTileIDs(o,S){for(const O of S.getCrossTileIDsLists())for(const C of O)delete this.usedCrossTileIDs[o][C]}removeStaleBuckets(o){let S=!1;for(const O in this.indexes){const C=this.indexes[O];for(const j in C)o[C[j].bucketInstanceId]||(this.removeBucketCrossTileIDs(O,C[j]),delete C[j],S=!0)}return S}}class hi{constructor(){this.layerIndexes={},this.crossTileIDs=new wi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,S,O){let C=this.layerIndexes[o.id];C===void 0&&(C=this.layerIndexes[o.id]=new Wn);let j=!1;const J={};C.handleWrapJump(O);for(const ie of S){const ce=ie.getBucket(o);ce&&o.id===ce.layerIds[0]&&(ce.bucketInstanceId||(ce.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(ie.tileID,ce,this.crossTileIDs)&&(j=!0),J[ce.bucketInstanceId]=!0)}return C.removeStaleBuckets(J)&&(j=!0),j}pruneUnusedLayers(o){const S={};o.forEach(O=>{S[O]=!0});for(const O in this.layerIndexes)S[O]||delete this.layerIndexes[O]}}const pi=($,o)=>r.t($,o&&o.filter(S=>S.identifier!=="source.canvas")),ns=r.aw();class ki extends r.E{constructor(o,S={}){super(),this._rtlPluginLoaded=()=>{for(const O in this.sourceCaches){const C=this.sourceCaches[O].getSource().type;C!=="vector"&&C!=="geojson"||this.sourceCaches[O].reload()}},this.map=o,this.dispatcher=new X(ot(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(O,C)=>this.getGlyphs(O,C)),this.dispatcher.registerMessageHandler("GI",(O,C)=>this.getImages(O,C)),this.imageManager=new Q,this.imageManager.setEventedParent(this),this.glyphManager=new be(o._requestManager,S.localIdeographFontFamily),this.lineAtlas=new H(256,512),this.crossTileSymbolIndex=new hi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new r.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",r.ay()),kn().on(xt,this._rtlPluginLoaded),this.on("data",O=>{if(O.dataType!=="source"||O.sourceDataType!=="metadata")return;const C=this.sourceCaches[O.sourceId];if(!C)return;const j=C.getSource();if(j&&j.vectorLayerIds)for(const J in this._layers){const ie=this._layers[J];ie.source===j.id&&this._validateLayer(ie)}})}loadURL(o,S={},O){this.fire(new r.k("dataloading",{dataType:"style"})),S.validate=typeof S.validate!="boolean"||S.validate;const C=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const j=this._loadStyleRequest;r.h(C,this._loadStyleRequest).then(J=>{this._loadStyleRequest=null,this._load(J.data,S,O)}).catch(J=>{this._loadStyleRequest=null,J&&!j.signal.aborted&&this.fire(new r.j(J))})}loadJSON(o,S={},O){this.fire(new r.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,g.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,S.validate=S.validate!==!1,this._load(o,S,O)}).catch(()=>{})}loadEmpty(){this.fire(new r.k("dataloading",{dataType:"style"})),this._load(ns,{validate:!1})}_load(o,S,O){var C;const j=S.transformStyle?S.transformStyle(O,o):o;if(!S.validate||!pi(this,r.u(j))){this._loaded=!0,this.stylesheet=j;for(const J in j.sources)this.addSource(J,j.sources[J],{validate:!1});j.sprite?this._loadSprite(j.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(j.glyphs),this._createLayers(),this.light=new B(this.stylesheet.light),this.sky=new z(this.stylesheet.sky),this.map.setTerrain((C=this.stylesheet.terrain)!==null&&C!==void 0?C:null),this.fire(new r.k("data",{dataType:"style"})),this.fire(new r.k("style.load"))}}_createLayers(){const o=r.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",o),this._order=o.map(S=>S.id),this._layers={},this._serializedLayers=null;for(const S of o){const O=r.aA(S);O.setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=O}}_loadSprite(o,S=!1,O=void 0){let C;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(j,J,ie,ce){return r._(this,void 0,void 0,function*(){const Se=L(j),Me=ie>1?"@2x":"",Ce={},He={};for(const{id:Ye,url:tt}of Se){const ht=J.transformRequest(W(tt,Me,".json"),"SpriteJSON");Ce[Ye]=r.h(ht,ce);const yt=J.transformRequest(W(tt,Me,".png"),"SpriteImage");He[Ye]=w.getImage(yt,ce)}return yield Promise.all([...Object.values(Ce),...Object.values(He)]),function(Ye,tt){return r._(this,void 0,void 0,function*(){const ht={};for(const yt in Ye){ht[yt]={};const vt=g.getImageCanvasContext((yield tt[yt]).data),kt=(yield Ye[yt]).data;for(const lt in kt){const{width:Rt,height:Nt,x:zt,y:sn,sdf:gn,pixelRatio:Cn,stretchX:Fn,stretchY:En,content:Sn,textFitWidth:Jn,textFitHeight:Nr}=kt[lt];ht[yt][lt]={data:null,pixelRatio:Cn,sdf:gn,stretchX:Fn,stretchY:En,content:Sn,textFitWidth:Jn,textFitHeight:Nr,spriteData:{width:Rt,height:Nt,x:zt,y:sn,context:vt}}}}return ht})}(Ce,He)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(j=>{if(this._spriteRequest=null,j)for(const J in j){this._spritesImagesIds[J]=[];const ie=this._spritesImagesIds[J]?this._spritesImagesIds[J].filter(ce=>!(ce in j)):[];for(const ce of ie)this.imageManager.removeImage(ce),this._changedImages[ce]=!0;for(const ce in j[J]){const Se=J==="default"?ce:`${J}:${ce}`;this._spritesImagesIds[J].push(Se),Se in this.imageManager.images?this.imageManager.updateImage(Se,j[J][ce],!1):this.imageManager.addImage(Se,j[J][ce]),S&&(this._changedImages[Se]=!0)}}}).catch(j=>{this._spriteRequest=null,C=j,this.fire(new r.j(C))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),S&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new r.k("data",{dataType:"style"})),O&&O(C)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new r.k("data",{dataType:"style"}))}_validateLayer(o){const S=this.sourceCaches[o.source];if(!S)return;const O=o.sourceLayer;if(!O)return;const C=S.getSource();(C.type==="geojson"||C.vectorLayerIds&&C.vectorLayerIds.indexOf(O)===-1)&&this.fire(new r.j(new Error(`Source layer "${O}" does not exist on source "${C.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o,S=!1){const O=this._serializedAllLayers();if(!o||o.length===0)return Object.values(S?r.aB(O):O);const C=[];for(const j of o)if(O[j]){const J=S?r.aB(O[j]):O[j];C.push(J)}return C}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const S=Object.keys(this._layers);for(const O of S){const C=this._layers[O];C.type!=="custom"&&(o[O]=C.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const S=this._changed;if(S){const C=Object.keys(this._updatedLayers),j=Object.keys(this._removedLayers);(C.length||j.length)&&this._updateWorkerLayers(C,j);for(const J in this._updatedSources){const ie=this._updatedSources[J];if(ie==="reload")this._reloadSource(J);else{if(ie!=="clear")throw new Error(`Invalid action ${ie}`);this._clearSource(J)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const J in this._updatedPaintProps)this._layers[J].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const O={};for(const C in this.sourceCaches){const j=this.sourceCaches[C];O[C]=j.used,j.used=!1}for(const C of this._order){const j=this._layers[C];j.recalculate(o,this._availableImages),!j.isHidden(o.zoom)&&j.source&&(this.sourceCaches[j.source].used=!0)}for(const C in O){const j=this.sourceCaches[C];!!O[C]!=!!j.used&&j.fire(new r.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(o),this.sky.recalculate(o),this.z=o.zoom,S&&this.fire(new r.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const S in this.sourceCaches)this.sourceCaches[S].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,S){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o,!1),removedIds:S})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,S={}){var O;this._checkLoaded();const C=this.serialize();if(o=S.transformStyle?S.transformStyle(C,o):o,((O=S.validate)===null||O===void 0||O)&&pi(this,r.u(o)))return!1;(o=r.aB(o)).layers=r.az(o.layers);const j=r.aC(C,o),J=this._getOperationsToPerform(j);if(J.unimplemented.length>0)throw new Error(`Unimplemented: ${J.unimplemented.join(", ")}.`);if(J.operations.length===0)return!1;for(const ie of J.operations)ie();return this.stylesheet=o,this._serializedLayers=null,!0}_getOperationsToPerform(o){const S=[],O=[];for(const C of o)switch(C.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":S.push(()=>this.addLayer.apply(this,C.args));break;case"removeLayer":S.push(()=>this.removeLayer.apply(this,C.args));break;case"setPaintProperty":S.push(()=>this.setPaintProperty.apply(this,C.args));break;case"setLayoutProperty":S.push(()=>this.setLayoutProperty.apply(this,C.args));break;case"setFilter":S.push(()=>this.setFilter.apply(this,C.args));break;case"addSource":S.push(()=>this.addSource.apply(this,C.args));break;case"removeSource":S.push(()=>this.removeSource.apply(this,C.args));break;case"setLayerZoomRange":S.push(()=>this.setLayerZoomRange.apply(this,C.args));break;case"setLight":S.push(()=>this.setLight.apply(this,C.args));break;case"setGeoJSONSourceData":S.push(()=>this.setGeoJSONSourceData.apply(this,C.args));break;case"setGlyphs":S.push(()=>this.setGlyphs.apply(this,C.args));break;case"setSprite":S.push(()=>this.setSprite.apply(this,C.args));break;case"setSky":S.push(()=>this.setSky.apply(this,C.args));break;case"setTerrain":S.push(()=>this.map.setTerrain.apply(this,C.args));break;case"setTransition":S.push(()=>{});break;default:O.push(C.command)}return{operations:S,unimplemented:O}}addImage(o,S){if(this.getImage(o))return this.fire(new r.j(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,S),this._afterImageUpdated(o)}updateImage(o,S){this.imageManager.updateImage(o,S)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new r.j(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new r.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,S,O={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!S.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(S).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(S.type)>=0&&this._validate(r.u.source,`sources.${o}`,S,null,O))return;this.map&&this.map._collectResourceTiming&&(S.collectResourceTiming=!0);const C=this.sourceCaches[o]=new rn(o,S,this.dispatcher);C.style=this,C.setEventedParent(this,()=>({isSourceLoaded:C.loaded(),source:C.serialize(),sourceId:o})),C.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const O in this._layers)if(this._layers[O].source===o)return this.fire(new r.j(new Error(`Source "${o}" cannot be removed while layer "${O}" is using it.`)));const S=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],S.fire(new r.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),S.setEventedParent(null),S.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,S){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const O=this.sourceCaches[o].getSource();if(O.type!=="geojson")throw new Error(`geojsonSource.type is ${O.type}, which is !== 'geojson`);O.setData(S),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,S,O={}){this._checkLoaded();const C=o.id;if(this.getLayer(C))return void this.fire(new r.j(new Error(`Layer "${C}" already exists on this map.`)));let j;if(o.type==="custom"){if(pi(this,r.aD(o)))return;j=r.aA(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(C,o.source),o=r.aB(o),o=r.e(o,{source:C})),this._validate(r.u.layer,`layers.${C}`,o,{arrayIndex:-1},O))return;j=r.aA(o),this._validateLayer(j),j.setEventedParent(this,{layer:{id:C}})}const J=S?this._order.indexOf(S):this._order.length;if(S&&J===-1)this.fire(new r.j(new Error(`Cannot add layer "${C}" before non-existing layer "${S}".`)));else{if(this._order.splice(J,0,C),this._layerOrderChanged=!0,this._layers[C]=j,this._removedLayers[C]&&j.source&&j.type!=="custom"){const ie=this._removedLayers[C];delete this._removedLayers[C],ie.type!==j.type?this._updatedSources[j.source]="clear":(this._updatedSources[j.source]="reload",this.sourceCaches[j.source].pause())}this._updateLayer(j),j.onAdd&&j.onAdd(this.map)}}moveLayer(o,S){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new r.j(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===S)return;const O=this._order.indexOf(o);this._order.splice(O,1);const C=S?this._order.indexOf(S):this._order.length;S&&C===-1?this.fire(new r.j(new Error(`Cannot move layer "${o}" before non-existing layer "${S}".`))):(this._order.splice(C,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const S=this._layers[o];if(!S)return void this.fire(new r.j(new Error(`Cannot remove non-existing layer "${o}".`)));S.setEventedParent(null);const O=this._order.indexOf(o);this._order.splice(O,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=S,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],S.onRemove&&S.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,S,O){this._checkLoaded();const C=this.getLayer(o);C?C.minzoom===S&&C.maxzoom===O||(S!=null&&(C.minzoom=S),O!=null&&(C.maxzoom=O),this._updateLayer(C)):this.fire(new r.j(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,S,O={}){this._checkLoaded();const C=this.getLayer(o);if(C){if(!r.aE(C.filter,S))return S==null?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(r.u.filter,`layers.${C.id}.filter`,S,null,O)||(C.filter=r.aB(S),this._updateLayer(C)))}else this.fire(new r.j(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return r.aB(this.getLayer(o).filter)}setLayoutProperty(o,S,O,C={}){this._checkLoaded();const j=this.getLayer(o);j?r.aE(j.getLayoutProperty(S),O)||(j.setLayoutProperty(S,O,C),this._updateLayer(j)):this.fire(new r.j(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,S){const O=this.getLayer(o);if(O)return O.getLayoutProperty(S);this.fire(new r.j(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,S,O,C={}){this._checkLoaded();const j=this.getLayer(o);j?r.aE(j.getPaintProperty(S),O)||(j.setPaintProperty(S,O,C)&&this._updateLayer(j),this._changed=!0,this._updatedPaintProps[o]=!0,this._serializedLayers=null):this.fire(new r.j(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,S){return this.getLayer(o).getPaintProperty(S)}setFeatureState(o,S){this._checkLoaded();const O=o.source,C=o.sourceLayer,j=this.sourceCaches[O];if(j===void 0)return void this.fire(new r.j(new Error(`The source '${O}' does not exist in the map's style.`)));const J=j.getSource().type;J==="geojson"&&C?this.fire(new r.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):J!=="vector"||C?(o.id===void 0&&this.fire(new r.j(new Error("The feature id parameter must be provided."))),j.setFeatureState(C,o.id,S)):this.fire(new r.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,S){this._checkLoaded();const O=o.source,C=this.sourceCaches[O];if(C===void 0)return void this.fire(new r.j(new Error(`The source '${O}' does not exist in the map's style.`)));const j=C.getSource().type,J=j==="vector"?o.sourceLayer:void 0;j!=="vector"||J?S&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new r.j(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(J,o.id,S):this.fire(new r.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const S=o.source,O=o.sourceLayer,C=this.sourceCaches[S];if(C!==void 0)return C.getSource().type!=="vector"||O?(o.id===void 0&&this.fire(new r.j(new Error("The feature id parameter must be provided."))),C.getFeatureState(O,o.id)):void this.fire(new r.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new r.j(new Error(`The source '${S}' does not exist in the map's style.`)))}getTransition(){return r.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=r.aF(this.sourceCaches,j=>j.serialize()),S=this._serializeByIds(this._order,!0),O=this.map.getTerrain()||void 0,C=this.stylesheet;return r.aG({version:C.version,name:C.name,metadata:C.metadata,light:C.light,sky:C.sky,center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch,sprite:C.sprite,glyphs:C.glyphs,transition:C.transition,sources:o,layers:S,terrain:O},j=>j!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const S=J=>this._layers[J].type==="fill-extrusion",O={},C=[];for(let J=this._order.length-1;J>=0;J--){const ie=this._order[J];if(S(ie)){O[ie]=J;for(const ce of o){const Se=ce[ie];if(Se)for(const Me of Se)C.push(Me)}}}C.sort((J,ie)=>ie.intersectionZ-J.intersectionZ);const j=[];for(let J=this._order.length-1;J>=0;J--){const ie=this._order[J];if(S(ie))for(let ce=C.length-1;ce>=0;ce--){const Se=C[ce].feature;if(O[Se.layer.id]<J)break;j.push(Se),C.pop()}else for(const ce of o){const Se=ce[ie];if(Se)for(const Me of Se)j.push(Me.feature)}}return j}queryRenderedFeatures(o,S,O){S&&S.filter&&this._validate(r.u.filter,"queryRenderedFeatures.filter",S.filter,null,S);const C={};if(S&&S.layers){if(!Array.isArray(S.layers))return this.fire(new r.j(new Error("parameters.layers must be an Array."))),[];for(const ie of S.layers){const ce=this._layers[ie];if(!ce)return this.fire(new r.j(new Error(`The layer '${ie}' does not exist in the map's style and cannot be queried for features.`))),[];C[ce.source]=!0}}const j=[];S.availableImages=this._availableImages;const J=this._serializedAllLayers();for(const ie in this.sourceCaches)S.layers&&!C[ie]||j.push(Be(this.sourceCaches[ie],this._layers,J,o,S,O));return this.placement&&j.push(function(ie,ce,Se,Me,Ce,He,Ye){const tt={},ht=He.queryRenderedSymbols(Me),yt=[];for(const vt of Object.keys(ht).map(Number))yt.push(Ye[vt]);yt.sort(se);for(const vt of yt){const kt=vt.featureIndex.lookupSymbolFeatures(ht[vt.bucketInstanceId],ce,vt.bucketIndex,vt.sourceLayerIndex,Ce.filter,Ce.layers,Ce.availableImages,ie);for(const lt in kt){const Rt=tt[lt]=tt[lt]||[],Nt=kt[lt];Nt.sort((zt,sn)=>{const gn=vt.featureSortOrder;if(gn){const Cn=gn.indexOf(zt.featureIndex);return gn.indexOf(sn.featureIndex)-Cn}return sn.featureIndex-zt.featureIndex});for(const zt of Nt)Rt.push(zt)}}for(const vt in tt)tt[vt].forEach(kt=>{const lt=kt.feature,Rt=Se[ie[vt].source].getFeatureState(lt.layer["source-layer"],lt.id);lt.source=lt.layer.source,lt.layer["source-layer"]&&(lt.sourceLayer=lt.layer["source-layer"]),lt.state=Rt});return tt}(this._layers,J,this.sourceCaches,o,S,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(j)}querySourceFeatures(o,S){S&&S.filter&&this._validate(r.u.filter,"querySourceFeatures.filter",S.filter,null,S);const O=this.sourceCaches[o];return O?function(C,j){const J=C.getRenderableIds().map(Se=>C.getTileByID(Se)),ie=[],ce={};for(let Se=0;Se<J.length;Se++){const Me=J[Se],Ce=Me.tileID.canonical.key;ce[Ce]||(ce[Ce]=!0,Me.querySourceFeatures(ie,j))}return ie}(O,S):[]}getLight(){return this.light.getLight()}setLight(o,S={}){this._checkLoaded();const O=this.light.getLight();let C=!1;for(const J in o)if(!r.aE(o[J],O[J])){C=!0;break}if(!C)return;const j={now:g.now(),transition:r.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,S),this.light.updateTransitions(j)}getSky(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.sky}setSky(o,S={}){const O=this.getSky();let C=!1;if(!o&&!O)return;if(o&&!O)C=!0;else if(!o&&O)C=!0;else for(const J in o)if(!r.aE(o[J],O[J])){C=!0;break}if(!C)return;const j={now:g.now(),transition:r.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,S),this.sky.updateTransitions(j)}_validate(o,S,O,C,j={}){return(!j||j.validate!==!1)&&pi(this,o.call(r.u,r.e({key:S,style:this.serialize(),value:O,styleSpec:r.v},C)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),kn().off(xt,this._rtlPluginLoaded);for(const S in this._layers)this._layers[S].setEventedParent(null);for(const S in this.sourceCaches){const O=this.sourceCaches[S];O.setEventedParent(null),O.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const S in this.sourceCaches)this.sourceCaches[S].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,S,O,C,j=!1){let J=!1,ie=!1;const ce={};for(const Se of this._order){const Me=this._layers[Se];if(Me.type!=="symbol")continue;if(!ce[Me.source]){const He=this.sourceCaches[Me.source];ce[Me.source]=He.getRenderableIds(!0).map(Ye=>He.getTileByID(Ye)).sort((Ye,tt)=>tt.tileID.overscaledZ-Ye.tileID.overscaledZ||(Ye.tileID.isLessThan(tt.tileID)?-1:1))}const Ce=this.crossTileSymbolIndex.addLayer(Me,ce[Me.source],o.center.lng);J=J||Ce}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((j=j||this._layerOrderChanged||O===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(g.now(),o.zoom))&&(this.pauseablePlacement=new ui(o,this.map.terrain,this._order,j,S,O,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ce),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(g.now()),ie=!0),J&&this.pauseablePlacement.placement.setStale()),ie||J)for(const Se of this._order){const Me=this._layers[Se];Me.type==="symbol"&&this.placement.updateLayerOpacities(Me,ce[Me.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(g.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,S){return r._(this,void 0,void 0,function*(){const O=yield this.imageManager.getImages(S.icons);this._updateTilesForChangedImages();const C=this.sourceCaches[S.source];return C&&C.setDependencies(S.tileID.key,S.type,S.icons),O})}getGlyphs(o,S){return r._(this,void 0,void 0,function*(){const O=yield this.glyphManager.getGlyphs(S.stacks),C=this.sourceCaches[S.source];return C&&C.setDependencies(S.tileID.key,S.type,[""]),O})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,S={}){this._checkLoaded(),o&&this._validate(r.u.glyphs,"glyphs",o,null,S)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,S,O={},C){this._checkLoaded();const j=[{id:o,url:S}],J=[...L(this.stylesheet.sprite),...j];this._validate(r.u.sprite,"sprite",J,null,O)||(this.stylesheet.sprite=J,this._loadSprite(j,!0,C))}removeSprite(o){this._checkLoaded();const S=L(this.stylesheet.sprite);if(S.find(O=>O.id===o)){if(this._spritesImagesIds[o])for(const O of this._spritesImagesIds[o])this.imageManager.removeImage(O),this._changedImages[O]=!0;S.splice(S.findIndex(O=>O.id===o),1),this.stylesheet.sprite=S.length>0?S:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new r.k("data",{dataType:"style"}))}else this.fire(new r.j(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return L(this.stylesheet.sprite)}setSprite(o,S={},O){this._checkLoaded(),o&&this._validate(r.u.sprite,"sprite",o,null,S)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,O):(this._unloadSprite(),O&&O(null)))}}var Di=r.Y([{name:"a_pos",type:"Int16",components:2}]);const Hi={prelude:Ur(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Ur(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ur(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ur(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ur("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ur(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Ur(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ur("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ur("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ur("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ur(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Ur(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Ur(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Ur(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ur(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ur(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ur(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ur(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ur(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ur(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ur(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ur(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ur(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ur(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ur(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ur(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ur("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ur("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ur("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Ur("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ur($,o){const S=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,O=o.match(/attribute ([\w]+) ([\w]+)/g),C=$.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),j=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),J=j?j.concat(C):C,ie={};return{fragmentSource:$=$.replace(S,(ce,Se,Me,Ce,He)=>(ie[He]=!0,Se==="define"?`
#ifndef HAS_UNIFORM_u_${He}
varying ${Me} ${Ce} ${He};
#else
uniform ${Me} ${Ce} u_${He};
#endif
`:`
#ifdef HAS_UNIFORM_u_${He}
    ${Me} ${Ce} ${He} = u_${He};
#endif
`)),vertexSource:o=o.replace(S,(ce,Se,Me,Ce,He)=>{const Ye=Ce==="float"?"vec2":"vec4",tt=He.match(/color/)?"color":Ye;return ie[He]?Se==="define"?`
#ifndef HAS_UNIFORM_u_${He}
uniform lowp float u_${He}_t;
attribute ${Me} ${Ye} a_${He};
varying ${Me} ${Ce} ${He};
#else
uniform ${Me} ${Ce} u_${He};
#endif
`:tt==="vec4"?`
#ifndef HAS_UNIFORM_u_${He}
    ${He} = a_${He};
#else
    ${Me} ${Ce} ${He} = u_${He};
#endif
`:`
#ifndef HAS_UNIFORM_u_${He}
    ${He} = unpack_mix_${tt}(a_${He}, u_${He}_t);
#else
    ${Me} ${Ce} ${He} = u_${He};
#endif
`:Se==="define"?`
#ifndef HAS_UNIFORM_u_${He}
uniform lowp float u_${He}_t;
attribute ${Me} ${Ye} a_${He};
#else
uniform ${Me} ${Ce} u_${He};
#endif
`:tt==="vec4"?`
#ifndef HAS_UNIFORM_u_${He}
    ${Me} ${Ce} ${He} = a_${He};
#else
    ${Me} ${Ce} ${He} = u_${He};
#endif
`:`
#ifndef HAS_UNIFORM_u_${He}
    ${Me} ${Ce} ${He} = unpack_mix_${tt}(a_${He}, u_${He}_t);
#else
    ${Me} ${Ce} ${He} = u_${He};
#endif
`}),staticAttributes:O,staticUniforms:J}}class Io{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,S,O,C,j,J,ie,ce,Se){this.context=o;let Me=this.boundPaintVertexBuffers.length!==C.length;for(let Ce=0;!Me&&Ce<C.length;Ce++)this.boundPaintVertexBuffers[Ce]!==C[Ce]&&(Me=!0);!this.vao||this.boundProgram!==S||this.boundLayoutVertexBuffer!==O||Me||this.boundIndexBuffer!==j||this.boundVertexOffset!==J||this.boundDynamicVertexBuffer!==ie||this.boundDynamicVertexBuffer2!==ce||this.boundDynamicVertexBuffer3!==Se?this.freshBind(S,O,C,j,J,ie,ce,Se):(o.bindVertexArray.set(this.vao),ie&&ie.bind(),j&&j.dynamicDraw&&j.bind(),ce&&ce.bind(),Se&&Se.bind())}freshBind(o,S,O,C,j,J,ie,ce){const Se=o.numAttributes,Me=this.context,Ce=Me.gl;this.vao&&this.destroy(),this.vao=Me.createVertexArray(),Me.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=S,this.boundPaintVertexBuffers=O,this.boundIndexBuffer=C,this.boundVertexOffset=j,this.boundDynamicVertexBuffer=J,this.boundDynamicVertexBuffer2=ie,this.boundDynamicVertexBuffer3=ce,S.enableAttributes(Ce,o);for(const He of O)He.enableAttributes(Ce,o);J&&J.enableAttributes(Ce,o),ie&&ie.enableAttributes(Ce,o),ce&&ce.enableAttributes(Ce,o),S.bind(),S.setVertexAttribPointers(Ce,o,j);for(const He of O)He.bind(),He.setVertexAttribPointers(Ce,o,j);J&&(J.bind(),J.setVertexAttribPointers(Ce,o,j)),C&&C.bind(),ie&&(ie.bind(),ie.setVertexAttribPointers(Ce,o,j)),ce&&(ce.bind(),ce.setVertexAttribPointers(Ce,o,j)),Me.currentNumAttributes=Se}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const rs=($,o,S,O,C)=>({u_matrix:$,u_texture:0,u_ele_delta:o,u_fog_matrix:S,u_fog_color:O?O.properties.get("fog-color"):r.aM.white,u_fog_ground_blend:O?O.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:O?O.calculateFogBlendOpacity(C):0,u_horizon_color:O?O.properties.get("horizon-color"):r.aM.white,u_horizon_fog_blend:O?O.properties.get("horizon-fog-blend"):1});function ao($){const o=[];for(let S=0;S<$.length;S++){if($[S]===null)continue;const O=$[S].split(" ");o.push(O.pop())}return o}class qo{constructor(o,S,O,C,j,J){const ie=o.gl;this.program=ie.createProgram();const ce=ao(S.staticAttributes),Se=O?O.getBinderAttributes():[],Me=ce.concat(Se),Ce=Hi.prelude.staticUniforms?ao(Hi.prelude.staticUniforms):[],He=S.staticUniforms?ao(S.staticUniforms):[],Ye=O?O.getBinderUniforms():[],tt=Ce.concat(He).concat(Ye),ht=[];for(const zt of tt)ht.indexOf(zt)<0&&ht.push(zt);const yt=O?O.defines():[];j&&yt.push("#define OVERDRAW_INSPECTOR;"),J&&yt.push("#define TERRAIN3D;");const vt=yt.concat(Hi.prelude.fragmentSource,S.fragmentSource).join(`
`),kt=yt.concat(Hi.prelude.vertexSource,S.vertexSource).join(`
`),lt=ie.createShader(ie.FRAGMENT_SHADER);if(ie.isContextLost())return void(this.failedToCreate=!0);if(ie.shaderSource(lt,vt),ie.compileShader(lt),!ie.getShaderParameter(lt,ie.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${ie.getShaderInfoLog(lt)}`);ie.attachShader(this.program,lt);const Rt=ie.createShader(ie.VERTEX_SHADER);if(ie.isContextLost())return void(this.failedToCreate=!0);if(ie.shaderSource(Rt,kt),ie.compileShader(Rt),!ie.getShaderParameter(Rt,ie.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${ie.getShaderInfoLog(Rt)}`);ie.attachShader(this.program,Rt),this.attributes={};const Nt={};this.numAttributes=Me.length;for(let zt=0;zt<this.numAttributes;zt++)Me[zt]&&(ie.bindAttribLocation(this.program,zt,Me[zt]),this.attributes[Me[zt]]=zt);if(ie.linkProgram(this.program),!ie.getProgramParameter(this.program,ie.LINK_STATUS))throw new Error(`Program failed to link: ${ie.getProgramInfoLog(this.program)}`);ie.deleteShader(Rt),ie.deleteShader(lt);for(let zt=0;zt<ht.length;zt++){const sn=ht[zt];if(sn&&!Nt[sn]){const gn=ie.getUniformLocation(this.program,sn);gn&&(Nt[sn]=gn)}}this.fixedUniforms=C(o,Nt),this.terrainUniforms=((zt,sn)=>({u_depth:new r.aH(zt,sn.u_depth),u_terrain:new r.aH(zt,sn.u_terrain),u_terrain_dim:new r.aI(zt,sn.u_terrain_dim),u_terrain_matrix:new r.aJ(zt,sn.u_terrain_matrix),u_terrain_unpack:new r.aK(zt,sn.u_terrain_unpack),u_terrain_exaggeration:new r.aI(zt,sn.u_terrain_exaggeration)}))(o,Nt),this.binderUniforms=O?O.getUniforms(o,Nt):[]}draw(o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,Ye,tt,ht,yt,vt,kt){const lt=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(O),o.setStencilMode(C),o.setColorMode(j),o.setCullFace(J),ce){o.activeTexture.set(lt.TEXTURE2),lt.bindTexture(lt.TEXTURE_2D,ce.depthTexture),o.activeTexture.set(lt.TEXTURE3),lt.bindTexture(lt.TEXTURE_2D,ce.texture);for(const Nt in this.terrainUniforms)this.terrainUniforms[Nt].set(ce[Nt])}for(const Nt in this.fixedUniforms)this.fixedUniforms[Nt].set(ie[Nt]);ht&&ht.setUniforms(o,this.binderUniforms,Ye,{zoom:tt});let Rt=0;switch(S){case lt.LINES:Rt=2;break;case lt.TRIANGLES:Rt=3;break;case lt.LINE_STRIP:Rt=1}for(const Nt of He.get()){const zt=Nt.vaos||(Nt.vaos={});(zt[Se]||(zt[Se]=new Io)).bind(o,this,Me,ht?ht.getPaintVertexBuffers():[],Ce,Nt.vertexOffset,yt,vt,kt),lt.drawElements(S,Nt.primitiveLength*Rt,lt.UNSIGNED_SHORT,Nt.primitiveOffset*Rt*2)}}}function yo($,o,S){const O=1/ln(S,1,o.transform.tileZoom),C=Math.pow(2,S.tileID.overscaledZ),j=S.tileSize*Math.pow(2,o.transform.tileZoom)/C,J=j*(S.tileID.canonical.x+S.tileID.wrap*C),ie=j*S.tileID.canonical.y;return{u_image:0,u_texsize:S.imageAtlasTexture.size,u_scale:[O,$.fromScale,$.toScale],u_fade:$.t,u_pixel_coord_upper:[J>>16,ie>>16],u_pixel_coord_lower:[65535&J,65535&ie]}}const lo=($,o,S,O)=>{const C=o.style.light,j=C.properties.get("position"),J=[j.x,j.y,j.z],ie=function(){var Se=new r.A(9);return r.A!=Float32Array&&(Se[1]=0,Se[2]=0,Se[3]=0,Se[5]=0,Se[6]=0,Se[7]=0),Se[0]=1,Se[4]=1,Se[8]=1,Se}();C.properties.get("anchor")==="viewport"&&function(Se,Me){var Ce=Math.sin(Me),He=Math.cos(Me);Se[0]=He,Se[1]=Ce,Se[2]=0,Se[3]=-Ce,Se[4]=He,Se[5]=0,Se[6]=0,Se[7]=0,Se[8]=1}(ie,-o.transform.angle),function(Se,Me,Ce){var He=Me[0],Ye=Me[1],tt=Me[2];Se[0]=He*Ce[0]+Ye*Ce[3]+tt*Ce[6],Se[1]=He*Ce[1]+Ye*Ce[4]+tt*Ce[7],Se[2]=He*Ce[2]+Ye*Ce[5]+tt*Ce[8]}(J,J,ie);const ce=C.properties.get("color");return{u_matrix:$,u_lightpos:J,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[ce.r,ce.g,ce.b],u_vertical_gradient:+S,u_opacity:O}},Ao=($,o,S,O,C,j,J)=>r.e(lo($,o,S,O),yo(j,o,J),{u_height_factor:-Math.pow(2,C.overscaledZ)/J.tileSize/8}),Ss=$=>({u_matrix:$}),Ho=($,o,S,O)=>r.e(Ss($),yo(S,o,O)),Kl=($,o)=>({u_matrix:$,u_world:o}),za=($,o,S,O,C)=>r.e(Ho($,o,S,O),{u_world:C}),Ua=($,o,S,O)=>{const C=$.transform;let j,J;if(O.paint.get("circle-pitch-alignment")==="map"){const ie=ln(S,1,C.zoom);j=!0,J=[ie,ie]}else j=!1,J=C.pixelsToGLUnits;return{u_camera_to_center_distance:C.cameraToCenterDistance,u_scale_with_map:+(O.paint.get("circle-pitch-scale")==="map"),u_matrix:$.translatePosMatrix(o.posMatrix,S,O.paint.get("circle-translate"),O.paint.get("circle-translate-anchor")),u_pitch_with_map:+j,u_device_pixel_ratio:$.pixelRatio,u_extrude_scale:J}},co=($,o,S)=>({u_matrix:$,u_inv_matrix:o,u_camera_to_center_distance:S.cameraToCenterDistance,u_viewport_size:[S.width,S.height]}),Wo=($,o,S=1)=>({u_matrix:$,u_color:o,u_overlay:0,u_overlay_scale:S}),Wi=$=>({u_matrix:$}),Ui=($,o,S,O)=>({u_matrix:$,u_extrude_scale:ln(o,1,S),u_intensity:O}),Gi=($,o,S,O)=>{const C=r.H();r.aP(C,0,$.width,$.height,0,0,1);const j=$.context.gl;return{u_matrix:C,u_world:[j.drawingBufferWidth,j.drawingBufferHeight],u_image:S,u_color_ramp:O,u_opacity:o.paint.get("heatmap-opacity")}};function sa($,o){const S=Math.pow(2,o.canonical.z),O=o.canonical.y;return[new r.Z(0,O/S).toLngLat().lat,new r.Z(0,(O+1)/S).toLngLat().lat]}const Va=($,o,S,O)=>{const C=$.transform;return{u_matrix:nt($,o,S,O),u_ratio:1/ln(o,1,C.zoom),u_device_pixel_ratio:$.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},Xl=($,o,S,O,C)=>r.e(Va($,o,S,C),{u_image:0,u_image_height:O}),Mr=($,o,S,O,C)=>{const j=$.transform,J=Ve(o,j);return{u_matrix:nt($,o,S,C),u_texsize:o.imageAtlasTexture.size,u_ratio:1/ln(o,1,j.zoom),u_device_pixel_ratio:$.pixelRatio,u_image:0,u_scale:[J,O.fromScale,O.toScale],u_fade:O.t,u_units_to_pixels:[1/j.pixelsToGLUnits[0],1/j.pixelsToGLUnits[1]]}},ke=($,o,S,O,C,j)=>{const J=$.lineAtlas,ie=Ve(o,$.transform),ce=S.layout.get("line-cap")==="round",Se=J.getDash(O.from,ce),Me=J.getDash(O.to,ce),Ce=Se.width*C.fromScale,He=Me.width*C.toScale;return r.e(Va($,o,S,j),{u_patternscale_a:[ie/Ce,-Se.height/2],u_patternscale_b:[ie/He,-Me.height/2],u_sdfgamma:J.width/(256*Math.min(Ce,He)*$.pixelRatio)/2,u_image:0,u_tex_y_a:Se.y,u_tex_y_b:Me.y,u_mix:C.t})};function Ve($,o){return 1/ln($,1,o.tileZoom)}function nt($,o,S,O){return $.translatePosMatrix(O?O.posMatrix:o.tileID.posMatrix,o,S.paint.get("line-translate"),S.paint.get("line-translate-anchor"))}const ut=($,o,S,O,C)=>{return{u_matrix:$,u_tl_parent:o,u_scale_parent:S,u_buffer_scale:1,u_fade_t:O.mix,u_opacity:O.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(J=C.paint.get("raster-saturation"),J>0?1-1/(1.001-J):-J),u_contrast_factor:(j=C.paint.get("raster-contrast"),j>0?1/(1-j):1+j),u_spin_weights:_t(C.paint.get("raster-hue-rotate"))};var j,J};function _t($){$*=Math.PI/180;const o=Math.sin($),S=Math.cos($);return[(2*S+1)/3,(-Math.sqrt(3)*o-S+1)/3,(Math.sqrt(3)*o-S+1)/3]}const St=($,o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,Ye)=>{const tt=J.transform;return{u_is_size_zoom_constant:+($==="constant"||$==="source"),u_is_size_feature_constant:+($==="constant"||$==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:tt.cameraToCenterDistance,u_pitch:tt.pitch/360*2*Math.PI,u_rotate_symbol:+S,u_aspect_ratio:tt.width/tt.height,u_fade_change:J.options.fadeDuration?J.symbolFadeChange:1,u_matrix:ie,u_label_plane_matrix:ce,u_coord_matrix:Se,u_is_text:+Ce,u_pitch_with_map:+O,u_is_along_line:C,u_is_variable_anchor:j,u_texsize:He,u_texture:0,u_translation:Me,u_pitched_scale:Ye}},Dt=($,o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,Ye,tt)=>{const ht=J.transform;return r.e(St($,o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,tt),{u_gamma_scale:O?Math.cos(ht._pitch)*ht.cameraToCenterDistance:1,u_device_pixel_ratio:J.pixelRatio,u_is_halo:+Ye})},Mt=($,o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,Ye)=>r.e(Dt($,o,S,O,C,j,J,ie,ce,Se,Me,!0,Ce,!0,Ye),{u_texsize_icon:He,u_texture_icon:1}),pt=($,o,S)=>({u_matrix:$,u_opacity:o,u_color:S}),Lt=($,o,S,O,C,j)=>r.e(function(J,ie,ce,Se){const Me=ce.imageManager.getPattern(J.from.toString()),Ce=ce.imageManager.getPattern(J.to.toString()),{width:He,height:Ye}=ce.imageManager.getPixelSize(),tt=Math.pow(2,Se.tileID.overscaledZ),ht=Se.tileSize*Math.pow(2,ce.transform.tileZoom)/tt,yt=ht*(Se.tileID.canonical.x+Se.tileID.wrap*tt),vt=ht*Se.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Me.tl,u_pattern_br_a:Me.br,u_pattern_tl_b:Ce.tl,u_pattern_br_b:Ce.br,u_texsize:[He,Ye],u_mix:ie.t,u_pattern_size_a:Me.displaySize,u_pattern_size_b:Ce.displaySize,u_scale_a:ie.fromScale,u_scale_b:ie.toScale,u_tile_units_to_pixels:1/ln(Se,1,ce.transform.tileZoom),u_pixel_coord_upper:[yt>>16,vt>>16],u_pixel_coord_lower:[65535&yt,65535&vt]}}(O,j,S,C),{u_matrix:$,u_opacity:o}),Z={fillExtrusion:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_lightpos:new r.aN($,o.u_lightpos),u_lightintensity:new r.aI($,o.u_lightintensity),u_lightcolor:new r.aN($,o.u_lightcolor),u_vertical_gradient:new r.aI($,o.u_vertical_gradient),u_opacity:new r.aI($,o.u_opacity)}),fillExtrusionPattern:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_lightpos:new r.aN($,o.u_lightpos),u_lightintensity:new r.aI($,o.u_lightintensity),u_lightcolor:new r.aN($,o.u_lightcolor),u_vertical_gradient:new r.aI($,o.u_vertical_gradient),u_height_factor:new r.aI($,o.u_height_factor),u_image:new r.aH($,o.u_image),u_texsize:new r.aO($,o.u_texsize),u_pixel_coord_upper:new r.aO($,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.aO($,o.u_pixel_coord_lower),u_scale:new r.aN($,o.u_scale),u_fade:new r.aI($,o.u_fade),u_opacity:new r.aI($,o.u_opacity)}),fill:($,o)=>({u_matrix:new r.aJ($,o.u_matrix)}),fillPattern:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_image:new r.aH($,o.u_image),u_texsize:new r.aO($,o.u_texsize),u_pixel_coord_upper:new r.aO($,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.aO($,o.u_pixel_coord_lower),u_scale:new r.aN($,o.u_scale),u_fade:new r.aI($,o.u_fade)}),fillOutline:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_world:new r.aO($,o.u_world)}),fillOutlinePattern:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_world:new r.aO($,o.u_world),u_image:new r.aH($,o.u_image),u_texsize:new r.aO($,o.u_texsize),u_pixel_coord_upper:new r.aO($,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.aO($,o.u_pixel_coord_lower),u_scale:new r.aN($,o.u_scale),u_fade:new r.aI($,o.u_fade)}),circle:($,o)=>({u_camera_to_center_distance:new r.aI($,o.u_camera_to_center_distance),u_scale_with_map:new r.aH($,o.u_scale_with_map),u_pitch_with_map:new r.aH($,o.u_pitch_with_map),u_extrude_scale:new r.aO($,o.u_extrude_scale),u_device_pixel_ratio:new r.aI($,o.u_device_pixel_ratio),u_matrix:new r.aJ($,o.u_matrix)}),collisionBox:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_pixel_extrude_scale:new r.aO($,o.u_pixel_extrude_scale)}),collisionCircle:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_inv_matrix:new r.aJ($,o.u_inv_matrix),u_camera_to_center_distance:new r.aI($,o.u_camera_to_center_distance),u_viewport_size:new r.aO($,o.u_viewport_size)}),debug:($,o)=>({u_color:new r.aL($,o.u_color),u_matrix:new r.aJ($,o.u_matrix),u_overlay:new r.aH($,o.u_overlay),u_overlay_scale:new r.aI($,o.u_overlay_scale)}),clippingMask:($,o)=>({u_matrix:new r.aJ($,o.u_matrix)}),heatmap:($,o)=>({u_extrude_scale:new r.aI($,o.u_extrude_scale),u_intensity:new r.aI($,o.u_intensity),u_matrix:new r.aJ($,o.u_matrix)}),heatmapTexture:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_world:new r.aO($,o.u_world),u_image:new r.aH($,o.u_image),u_color_ramp:new r.aH($,o.u_color_ramp),u_opacity:new r.aI($,o.u_opacity)}),hillshade:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_image:new r.aH($,o.u_image),u_latrange:new r.aO($,o.u_latrange),u_light:new r.aO($,o.u_light),u_shadow:new r.aL($,o.u_shadow),u_highlight:new r.aL($,o.u_highlight),u_accent:new r.aL($,o.u_accent)}),hillshadePrepare:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_image:new r.aH($,o.u_image),u_dimension:new r.aO($,o.u_dimension),u_zoom:new r.aI($,o.u_zoom),u_unpack:new r.aK($,o.u_unpack)}),line:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_ratio:new r.aI($,o.u_ratio),u_device_pixel_ratio:new r.aI($,o.u_device_pixel_ratio),u_units_to_pixels:new r.aO($,o.u_units_to_pixels)}),lineGradient:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_ratio:new r.aI($,o.u_ratio),u_device_pixel_ratio:new r.aI($,o.u_device_pixel_ratio),u_units_to_pixels:new r.aO($,o.u_units_to_pixels),u_image:new r.aH($,o.u_image),u_image_height:new r.aI($,o.u_image_height)}),linePattern:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_texsize:new r.aO($,o.u_texsize),u_ratio:new r.aI($,o.u_ratio),u_device_pixel_ratio:new r.aI($,o.u_device_pixel_ratio),u_image:new r.aH($,o.u_image),u_units_to_pixels:new r.aO($,o.u_units_to_pixels),u_scale:new r.aN($,o.u_scale),u_fade:new r.aI($,o.u_fade)}),lineSDF:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_ratio:new r.aI($,o.u_ratio),u_device_pixel_ratio:new r.aI($,o.u_device_pixel_ratio),u_units_to_pixels:new r.aO($,o.u_units_to_pixels),u_patternscale_a:new r.aO($,o.u_patternscale_a),u_patternscale_b:new r.aO($,o.u_patternscale_b),u_sdfgamma:new r.aI($,o.u_sdfgamma),u_image:new r.aH($,o.u_image),u_tex_y_a:new r.aI($,o.u_tex_y_a),u_tex_y_b:new r.aI($,o.u_tex_y_b),u_mix:new r.aI($,o.u_mix)}),raster:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_tl_parent:new r.aO($,o.u_tl_parent),u_scale_parent:new r.aI($,o.u_scale_parent),u_buffer_scale:new r.aI($,o.u_buffer_scale),u_fade_t:new r.aI($,o.u_fade_t),u_opacity:new r.aI($,o.u_opacity),u_image0:new r.aH($,o.u_image0),u_image1:new r.aH($,o.u_image1),u_brightness_low:new r.aI($,o.u_brightness_low),u_brightness_high:new r.aI($,o.u_brightness_high),u_saturation_factor:new r.aI($,o.u_saturation_factor),u_contrast_factor:new r.aI($,o.u_contrast_factor),u_spin_weights:new r.aN($,o.u_spin_weights)}),symbolIcon:($,o)=>({u_is_size_zoom_constant:new r.aH($,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.aH($,o.u_is_size_feature_constant),u_size_t:new r.aI($,o.u_size_t),u_size:new r.aI($,o.u_size),u_camera_to_center_distance:new r.aI($,o.u_camera_to_center_distance),u_pitch:new r.aI($,o.u_pitch),u_rotate_symbol:new r.aH($,o.u_rotate_symbol),u_aspect_ratio:new r.aI($,o.u_aspect_ratio),u_fade_change:new r.aI($,o.u_fade_change),u_matrix:new r.aJ($,o.u_matrix),u_label_plane_matrix:new r.aJ($,o.u_label_plane_matrix),u_coord_matrix:new r.aJ($,o.u_coord_matrix),u_is_text:new r.aH($,o.u_is_text),u_pitch_with_map:new r.aH($,o.u_pitch_with_map),u_is_along_line:new r.aH($,o.u_is_along_line),u_is_variable_anchor:new r.aH($,o.u_is_variable_anchor),u_texsize:new r.aO($,o.u_texsize),u_texture:new r.aH($,o.u_texture),u_translation:new r.aO($,o.u_translation),u_pitched_scale:new r.aI($,o.u_pitched_scale)}),symbolSDF:($,o)=>({u_is_size_zoom_constant:new r.aH($,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.aH($,o.u_is_size_feature_constant),u_size_t:new r.aI($,o.u_size_t),u_size:new r.aI($,o.u_size),u_camera_to_center_distance:new r.aI($,o.u_camera_to_center_distance),u_pitch:new r.aI($,o.u_pitch),u_rotate_symbol:new r.aH($,o.u_rotate_symbol),u_aspect_ratio:new r.aI($,o.u_aspect_ratio),u_fade_change:new r.aI($,o.u_fade_change),u_matrix:new r.aJ($,o.u_matrix),u_label_plane_matrix:new r.aJ($,o.u_label_plane_matrix),u_coord_matrix:new r.aJ($,o.u_coord_matrix),u_is_text:new r.aH($,o.u_is_text),u_pitch_with_map:new r.aH($,o.u_pitch_with_map),u_is_along_line:new r.aH($,o.u_is_along_line),u_is_variable_anchor:new r.aH($,o.u_is_variable_anchor),u_texsize:new r.aO($,o.u_texsize),u_texture:new r.aH($,o.u_texture),u_gamma_scale:new r.aI($,o.u_gamma_scale),u_device_pixel_ratio:new r.aI($,o.u_device_pixel_ratio),u_is_halo:new r.aH($,o.u_is_halo),u_translation:new r.aO($,o.u_translation),u_pitched_scale:new r.aI($,o.u_pitched_scale)}),symbolTextAndIcon:($,o)=>({u_is_size_zoom_constant:new r.aH($,o.u_is_size_zoom_constant),u_is_size_feature_constant:new r.aH($,o.u_is_size_feature_constant),u_size_t:new r.aI($,o.u_size_t),u_size:new r.aI($,o.u_size),u_camera_to_center_distance:new r.aI($,o.u_camera_to_center_distance),u_pitch:new r.aI($,o.u_pitch),u_rotate_symbol:new r.aH($,o.u_rotate_symbol),u_aspect_ratio:new r.aI($,o.u_aspect_ratio),u_fade_change:new r.aI($,o.u_fade_change),u_matrix:new r.aJ($,o.u_matrix),u_label_plane_matrix:new r.aJ($,o.u_label_plane_matrix),u_coord_matrix:new r.aJ($,o.u_coord_matrix),u_is_text:new r.aH($,o.u_is_text),u_pitch_with_map:new r.aH($,o.u_pitch_with_map),u_is_along_line:new r.aH($,o.u_is_along_line),u_is_variable_anchor:new r.aH($,o.u_is_variable_anchor),u_texsize:new r.aO($,o.u_texsize),u_texsize_icon:new r.aO($,o.u_texsize_icon),u_texture:new r.aH($,o.u_texture),u_texture_icon:new r.aH($,o.u_texture_icon),u_gamma_scale:new r.aI($,o.u_gamma_scale),u_device_pixel_ratio:new r.aI($,o.u_device_pixel_ratio),u_is_halo:new r.aH($,o.u_is_halo),u_translation:new r.aO($,o.u_translation),u_pitched_scale:new r.aI($,o.u_pitched_scale)}),background:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_opacity:new r.aI($,o.u_opacity),u_color:new r.aL($,o.u_color)}),backgroundPattern:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_opacity:new r.aI($,o.u_opacity),u_image:new r.aH($,o.u_image),u_pattern_tl_a:new r.aO($,o.u_pattern_tl_a),u_pattern_br_a:new r.aO($,o.u_pattern_br_a),u_pattern_tl_b:new r.aO($,o.u_pattern_tl_b),u_pattern_br_b:new r.aO($,o.u_pattern_br_b),u_texsize:new r.aO($,o.u_texsize),u_mix:new r.aI($,o.u_mix),u_pattern_size_a:new r.aO($,o.u_pattern_size_a),u_pattern_size_b:new r.aO($,o.u_pattern_size_b),u_scale_a:new r.aI($,o.u_scale_a),u_scale_b:new r.aI($,o.u_scale_b),u_pixel_coord_upper:new r.aO($,o.u_pixel_coord_upper),u_pixel_coord_lower:new r.aO($,o.u_pixel_coord_lower),u_tile_units_to_pixels:new r.aI($,o.u_tile_units_to_pixels)}),terrain:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_texture:new r.aH($,o.u_texture),u_ele_delta:new r.aI($,o.u_ele_delta),u_fog_matrix:new r.aJ($,o.u_fog_matrix),u_fog_color:new r.aL($,o.u_fog_color),u_fog_ground_blend:new r.aI($,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new r.aI($,o.u_fog_ground_blend_opacity),u_horizon_color:new r.aL($,o.u_horizon_color),u_horizon_fog_blend:new r.aI($,o.u_horizon_fog_blend)}),terrainDepth:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_ele_delta:new r.aI($,o.u_ele_delta)}),terrainCoords:($,o)=>({u_matrix:new r.aJ($,o.u_matrix),u_texture:new r.aH($,o.u_texture),u_terrain_coords_id:new r.aI($,o.u_terrain_coords_id),u_ele_delta:new r.aI($,o.u_ele_delta)}),sky:($,o)=>({u_sky_color:new r.aL($,o.u_sky_color),u_horizon_color:new r.aL($,o.u_horizon_color),u_horizon:new r.aI($,o.u_horizon),u_sky_horizon_blend:new r.aI($,o.u_sky_horizon_blend)})};class q{constructor(o,S,O){this.context=o;const C=o.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!O,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,S.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete S.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const S=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),S.bufferSubData(S.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ee={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ye{constructor(o,S,O,C){this.length=S.length,this.attributes=O,this.itemSize=S.bytesPerElement,this.dynamicDraw=C,this.context=o;const j=o.gl;this.buffer=j.createBuffer(),o.bindVertexBuffer.set(this.buffer),j.bufferData(j.ARRAY_BUFFER,S.arrayBuffer,this.dynamicDraw?j.DYNAMIC_DRAW:j.STATIC_DRAW),this.dynamicDraw||delete S.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const S=this.context.gl;this.bind(),S.bufferSubData(S.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,S){for(let O=0;O<this.attributes.length;O++){const C=S.attributes[this.attributes[O].name];C!==void 0&&o.enableVertexAttribArray(C)}}setVertexAttribPointers(o,S,O){for(let C=0;C<this.attributes.length;C++){const j=this.attributes[C],J=S.attributes[j.name];J!==void 0&&o.vertexAttribPointer(J,j.components,o[Ee[j.type]],!1,this.itemSize,j.offset+this.itemSize*(O||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const it=new WeakMap;function st($){var o;if(it.has($))return it.get($);{const S=(o=$.getParameter($.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return it.set($,S),S}}class At{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qt extends At{getDefault(){return r.aM.transparent}set(o){const S=this.current;(o.r!==S.r||o.g!==S.g||o.b!==S.b||o.a!==S.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class gt extends At{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Xt extends At{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Vt extends At{getDefault(){return[!0,!0,!0,!0]}set(o){const S=this.current;(o[0]!==S[0]||o[1]!==S[1]||o[2]!==S[2]||o[3]!==S[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ot extends At{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Ut extends At{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class an extends At{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const S=this.current;(o.func!==S.func||o.ref!==S.ref||o.mask!==S.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class pn extends At{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const S=this.current;(o[0]!==S[0]||o[1]!==S[1]||o[2]!==S[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Ln extends At{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;o?S.enable(S.STENCIL_TEST):S.disable(S.STENCIL_TEST),this.current=o,this.dirty=!1}}class or extends At{getDefault(){return[0,1]}set(o){const S=this.current;(o[0]!==S[0]||o[1]!==S[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class gr extends At{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;o?S.enable(S.DEPTH_TEST):S.disable(S.DEPTH_TEST),this.current=o,this.dirty=!1}}class nr extends At{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class wr extends At{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;o?S.enable(S.BLEND):S.disable(S.BLEND),this.current=o,this.dirty=!1}}class jn extends At{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const S=this.current;(o[0]!==S[0]||o[1]!==S[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class yi extends At{getDefault(){return r.aM.transparent}set(o){const S=this.current;(o.r!==S.r||o.g!==S.g||o.b!==S.b||o.a!==S.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Qn extends At{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class In extends At{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;o?S.enable(S.CULL_FACE):S.disable(S.CULL_FACE),this.current=o,this.dirty=!1}}class Wr extends At{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class yn extends At{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class qr extends At{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class un extends At{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class er extends At{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const S=this.current;(o[0]!==S[0]||o[1]!==S[1]||o[2]!==S[2]||o[3]!==S[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class mr extends At{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;S.bindFramebuffer(S.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Lr extends At{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;S.bindRenderbuffer(S.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class bo extends At{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;S.bindTexture(S.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class sr extends At{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;S.bindBuffer(S.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Gn extends At{getDefault(){return null}set(o){const S=this.gl;S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Mn extends At{getDefault(){return null}set(o){var S;if(o===this.current&&!this.dirty)return;const O=this.gl;st(O)?O.bindVertexArray(o):(S=O.getExtension("OES_vertex_array_object"))===null||S===void 0||S.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class Kn extends At{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;S.pixelStorei(S.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Bn extends At{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;S.pixelStorei(S.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class xr extends At{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const S=this.gl;S.pixelStorei(S.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Pr extends At{constructor(o,S){super(o),this.context=o,this.parent=S}getDefault(){return null}}class Zn extends Pr{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const S=this.gl;S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Pn extends Pr{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const S=this.gl;S.framebufferRenderbuffer(S.FRAMEBUFFER,S.DEPTH_ATTACHMENT,S.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Cr extends Pr{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const S=this.gl;S.framebufferRenderbuffer(S.FRAMEBUFFER,S.DEPTH_STENCIL_ATTACHMENT,S.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Hr{constructor(o,S,O,C,j){this.context=o,this.width=S,this.height=O;const J=o.gl,ie=this.framebuffer=J.createFramebuffer();if(this.colorAttachment=new Zn(o,ie),C)this.depthAttachment=j?new Cr(o,ie):new Pn(o,ie);else if(j)throw new Error("Stencil cannot be set without depth");if(J.checkFramebufferStatus(J.FRAMEBUFFER)!==J.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,S=this.colorAttachment.get();if(S&&o.deleteTexture(S),this.depthAttachment){const O=this.depthAttachment.get();O&&o.deleteRenderbuffer(O)}o.deleteFramebuffer(this.framebuffer)}}class jr{constructor(o,S,O){this.blendFunction=o,this.blendColor=S,this.mask=O}}jr.Replace=[1,0],jr.disabled=new jr(jr.Replace,r.aM.transparent,[!1,!1,!1,!1]),jr.unblended=new jr(jr.Replace,r.aM.transparent,[!0,!0,!0,!0]),jr.alphaBlended=new jr([1,771],r.aM.transparent,[!0,!0,!0,!0]);class xi{constructor(o){var S,O;if(this.gl=o,this.clearColor=new qt(this),this.clearDepth=new gt(this),this.clearStencil=new Xt(this),this.colorMask=new Vt(this),this.depthMask=new Ot(this),this.stencilMask=new Ut(this),this.stencilFunc=new an(this),this.stencilOp=new pn(this),this.stencilTest=new Ln(this),this.depthRange=new or(this),this.depthTest=new gr(this),this.depthFunc=new nr(this),this.blend=new wr(this),this.blendFunc=new jn(this),this.blendColor=new yi(this),this.blendEquation=new Qn(this),this.cullFace=new In(this),this.cullFaceSide=new Wr(this),this.frontFace=new yn(this),this.program=new qr(this),this.activeTexture=new un(this),this.viewport=new er(this),this.bindFramebuffer=new mr(this),this.bindRenderbuffer=new Lr(this),this.bindTexture=new bo(this),this.bindVertexBuffer=new sr(this),this.bindElementBuffer=new Gn(this),this.bindVertexArray=new Mn(this),this.pixelStoreUnpack=new Kn(this),this.pixelStoreUnpackPremultiplyAlpha=new Bn(this),this.pixelStoreUnpackFlipY=new xr(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),st(o)){this.HALF_FLOAT=o.HALF_FLOAT;const C=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(S=o.RGBA16F)!==null&&S!==void 0?S:C==null?void 0:C.RGBA16F_EXT,this.RGB16F=(O=o.RGB16F)!==null&&O!==void 0?O:C==null?void 0:C.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const C=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=C==null?void 0:C.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,S){return new q(this,o,S)}createVertexBuffer(o,S,O){return new ye(this,o,S,O)}createRenderbuffer(o,S,O){const C=this.gl,j=C.createRenderbuffer();return this.bindRenderbuffer.set(j),C.renderbufferStorage(C.RENDERBUFFER,o,S,O),this.bindRenderbuffer.set(null),j}createFramebuffer(o,S,O,C){return new Hr(this,o,S,O,C)}clear({color:o,depth:S,stencil:O}){const C=this.gl;let j=0;o&&(j|=C.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),S!==void 0&&(j|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(S),this.depthMask.set(!0)),O!==void 0&&(j|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(O),this.stencilMask.set(255)),C.clear(j)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){r.aE(o.blendFunction,jr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return st(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var S;return st(this.gl)?this.gl.deleteVertexArray(o):(S=this.gl.getExtension("OES_vertex_array_object"))===null||S===void 0?void 0:S.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class yr{constructor(o,S,O){this.func=o,this.mask=S,this.range=O}}yr.ReadOnly=!1,yr.ReadWrite=!0,yr.disabled=new yr(519,yr.ReadOnly,[0,1]);const Ro=7680;class zn{constructor(o,S,O,C,j,J){this.test=o,this.ref=S,this.mask=O,this.fail=C,this.depthFail=j,this.pass=J}}zn.disabled=new zn({func:519,mask:0},0,0,Ro,Ro,Ro);class Fr{constructor(o,S,O){this.enable=o,this.mode=S,this.frontFace=O}}let ai;function bi($,o,S,O,C){const j=$.context,J=j.gl,ie=$.useProgram("collisionBox"),ce=[];let Se=0,Me=0;for(let vt=0;vt<O.length;vt++){const kt=O[vt],lt=o.getTile(kt).getBucket(S);if(!lt)continue;const Rt=C?lt.textCollisionBox:lt.iconCollisionBox,Nt=lt.collisionCircleArray;if(Nt.length>0){const zt=r.H();r.aQ(zt,lt.placementInvProjMatrix,$.transform.glCoordMatrix),r.aQ(zt,zt,lt.placementViewportMatrix),ce.push({circleArray:Nt,circleOffset:Me,transform:kt.posMatrix,invTransform:zt,coord:kt}),Se+=Nt.length/4,Me=Se}Rt&&ie.draw(j,J.LINES,yr.disabled,zn.disabled,$.colorModeForRenderPass(),Fr.disabled,{u_matrix:kt.posMatrix,u_pixel_extrude_scale:[1/(Ce=$.transform).width,1/Ce.height]},$.style.map.terrain&&$.style.map.terrain.getTerrainData(kt),S.id,Rt.layoutVertexBuffer,Rt.indexBuffer,Rt.segments,null,$.transform.zoom,null,null,Rt.collisionVertexBuffer)}var Ce;if(!C||!ce.length)return;const He=$.useProgram("collisionCircle"),Ye=new r.aR;Ye.resize(4*Se),Ye._trim();let tt=0;for(const vt of ce)for(let kt=0;kt<vt.circleArray.length/4;kt++){const lt=4*kt,Rt=vt.circleArray[lt+0],Nt=vt.circleArray[lt+1],zt=vt.circleArray[lt+2],sn=vt.circleArray[lt+3];Ye.emplace(tt++,Rt,Nt,zt,sn,0),Ye.emplace(tt++,Rt,Nt,zt,sn,1),Ye.emplace(tt++,Rt,Nt,zt,sn,2),Ye.emplace(tt++,Rt,Nt,zt,sn,3)}(!ai||ai.length<2*Se)&&(ai=function(vt){const kt=2*vt,lt=new r.aT;lt.resize(kt),lt._trim();for(let Rt=0;Rt<kt;Rt++){const Nt=6*Rt;lt.uint16[Nt+0]=4*Rt+0,lt.uint16[Nt+1]=4*Rt+1,lt.uint16[Nt+2]=4*Rt+2,lt.uint16[Nt+3]=4*Rt+2,lt.uint16[Nt+4]=4*Rt+3,lt.uint16[Nt+5]=4*Rt+0}return lt}(Se));const ht=j.createIndexBuffer(ai,!0),yt=j.createVertexBuffer(Ye,r.aS.members,!0);for(const vt of ce){const kt=co(vt.transform,vt.invTransform,$.transform);He.draw(j,J.TRIANGLES,yr.disabled,zn.disabled,$.colorModeForRenderPass(),Fr.disabled,kt,$.style.map.terrain&&$.style.map.terrain.getTerrainData(vt.coord),S.id,yt,ht,r.a0.simpleSegment(0,2*vt.circleOffset,vt.circleArray.length,vt.circleArray.length/2),null,$.transform.zoom,null,null,null)}yt.destroy(),ht.destroy()}Fr.disabled=new Fr(!1,1029,2305),Fr.backCCW=new Fr(!0,1029,2305);const Li=r.an(new Float32Array(16));function fi($,o,S,O,C,j){const{horizontalAlign:J,verticalAlign:ie}=r.au($);return new r.P((-(J-.5)*o/C+O[0])*j,(-(ie-.5)*S/C+O[1])*j)}function is($,o,S,O,C,j){const J=o.tileAnchorPoint.add(new r.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let ie=O.mult(j);S||(ie=ie.rotate(-C));const ce=J.add(ie);return ve(ce.x,ce.y,o.labelPlaneMatrix,o.getElevation).point}if(S){const ie=rt(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub($),ce=Math.atan(ie.y/ie.x)+(ie.x<0?Math.PI:0);return $.add(O.rotate(ce))}return $.add(O)}function aa($,o,S,O,C,j,J,ie,ce,Se,Me,Ce,He,Ye){const tt=$.text.placedSymbolArray,ht=$.text.dynamicLayoutVertexArray,yt=$.icon.dynamicLayoutVertexArray,vt={};ht.clear();for(let kt=0;kt<tt.length;kt++){const lt=tt.get(kt),Rt=lt.hidden||!lt.crossTileID||$.allowVerticalPlacement&&!lt.placedOrientation?null:O[lt.crossTileID];if(Rt){const Nt=new r.P(lt.anchorX,lt.anchorY),zt={getElevation:Ye,width:C.width,height:C.height,labelPlaneMatrix:j,lineVertexArray:null,pitchWithMap:S,projection:Me,projectionCache:null,tileAnchorPoint:Nt,translation:Ce,unwrappedTileID:He},sn=S?ve(Nt.x,Nt.y,J,Ye):rt(Nt.x,Nt.y,zt),gn=he(C.cameraToCenterDistance,sn.signedDistanceFromCamera);let Cn=r.ai($.textSizeData,ce,lt)*gn/r.ap;S&&(Cn*=$.tilePixelRatio/ie);const{width:Fn,height:En,anchor:Sn,textOffset:Jn,textBoxScale:Nr}=Rt,An=fi(Sn,Fn,En,Jn,Nr,Cn),Nn=Me.getPitchedTextCorrection(C,Nt.add(new r.P(Ce[0],Ce[1])),He),Rr=is(sn.point,zt,o,An,C.angle,Nn),Ni=$.allowVerticalPlacement&&lt.placedOrientation===r.ah.vertical?Math.PI/2:0;for(let Gr=0;Gr<lt.numGlyphs;Gr++)r.aj(ht,Rr,Ni);Se&&lt.associatedIconIndex>=0&&(vt[lt.associatedIconIndex]={shiftedAnchor:Rr,angle:Ni})}else Kt(lt.numGlyphs,ht)}if(Se){yt.clear();const kt=$.icon.placedSymbolArray;for(let lt=0;lt<kt.length;lt++){const Rt=kt.get(lt);if(Rt.hidden)Kt(Rt.numGlyphs,yt);else{const Nt=vt[lt];if(Nt)for(let zt=0;zt<Rt.numGlyphs;zt++)r.aj(yt,Nt.shiftedAnchor,Nt.angle);else Kt(Rt.numGlyphs,yt)}}$.icon.dynamicLayoutVertexBuffer.updateData(yt)}$.text.dynamicLayoutVertexBuffer.updateData(ht)}function Go($,o,S){return S.iconsInText&&o?"symbolTextAndIcon":$?"symbolSDF":"symbolIcon"}function qa($,o,S,O,C,j,J,ie,ce,Se,Me,Ce){const He=$.context,Ye=He.gl,tt=$.transform,ht=zr(),yt=ie==="map",vt=ce==="map",kt=ie!=="viewport"&&S.layout.get("symbol-placement")!=="point",lt=yt&&!vt&&!kt,Rt=!vt&&kt,Nt=!S.layout.get("symbol-sort-key").isConstant();let zt=!1;const sn=$.depthModeForSublayer(0,yr.ReadOnly),gn=S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Cn=[],Fn=ht.getCircleRadiusCorrection(tt);for(const En of O){const Sn=o.getTile(En),Jn=Sn.getBucket(S);if(!Jn)continue;const Nr=C?Jn.text:Jn.icon;if(!Nr||!Nr.segments.get().length||!Nr.hasVisibleVertices)continue;const An=Nr.programConfigurations.get(S.id),Nn=C||Jn.sdfIcons,Rr=C?Jn.textSizeData:Jn.iconSizeData,Ni=vt||tt.pitch!==0,Gr=$.useProgram(Go(Nn,C,Jn),An),ti=r.ag(Rr,tt.zoom),$i=$.style.map.terrain&&$.style.map.terrain.getTerrainData(En);let ss,Ga,Bi,Vs,ks=[0,0],as=null;if(C)Ga=Sn.glyphAtlasTexture,Bi=Ye.LINEAR,ss=Sn.glyphAtlasTexture.size,Jn.iconsInText&&(ks=Sn.imageAtlasTexture.size,as=Sn.imageAtlasTexture,Vs=Ni||$.options.rotating||$.options.zooming||Rr.kind==="composite"||Rr.kind==="camera"?Ye.LINEAR:Ye.NEAREST);else{const ri=S.layout.get("icon-size").constantOr(0)!==1||Jn.iconsNeedLinear;Ga=Sn.imageAtlasTexture,Bi=Nn||$.options.rotating||$.options.zooming||ri||Ni?Ye.LINEAR:Ye.NEAREST,ss=Sn.imageAtlasTexture.size}const Ps=ln(Sn,1,$.transform.zoom),Pl=Rt?En.posMatrix:Li,Bh=Ir(Pl,vt,yt,$.transform,Ps),Fm=Ae(Pl,vt,yt,$.transform,Ps),Fh=Ae(En.posMatrix,vt,yt,$.transform,Ps),ka=ht.translatePosition($.transform,Sn,j,J),zm=gn&&Jn.hasTextData(),Z0=S.layout.get("icon-text-fit")!=="none"&&zm&&Jn.hasIconData();if(kt){const ri=$.style.map.terrain?(zh,Uh)=>$.style.map.terrain.getElevation(En,zh,Uh):null,ku=S.layout.get("text-rotation-alignment")==="map";we(Jn,En.posMatrix,$,C,Bh,Fh,vt,Se,ku,ht,En.toUnwrapped(),tt.width,tt.height,ka,ri)}const Pa=En.posMatrix,Ta=C&&gn||Z0,Ic=kt||Ta?Li:Bh,Ka=Fm,Ko=Nn&&S.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ls;ls=Nn?Jn.iconsInText?Mt(Rr.kind,ti,lt,vt,kt,Ta,$,Pa,Ic,Ka,ka,ss,ks,Fn):Dt(Rr.kind,ti,lt,vt,kt,Ta,$,Pa,Ic,Ka,ka,C,ss,!0,Fn):St(Rr.kind,ti,lt,vt,kt,Ta,$,Pa,Ic,Ka,ka,C,ss,Fn);const ua={program:Gr,buffers:Nr,uniformValues:ls,atlasTexture:Ga,atlasTextureIcon:as,atlasInterpolation:Bi,atlasInterpolationIcon:Vs,isSDF:Nn,hasHalo:Ko};if(Nt&&Jn.canOverlap){zt=!0;const ri=Nr.segments.get();for(const ku of ri)Cn.push({segments:new r.a0([ku]),sortKey:ku.sortKey,state:ua,terrainData:$i})}else Cn.push({segments:Nr.segments,sortKey:0,state:ua,terrainData:$i})}zt&&Cn.sort((En,Sn)=>En.sortKey-Sn.sortKey);for(const En of Cn){const Sn=En.state;if(He.activeTexture.set(Ye.TEXTURE0),Sn.atlasTexture.bind(Sn.atlasInterpolation,Ye.CLAMP_TO_EDGE),Sn.atlasTextureIcon&&(He.activeTexture.set(Ye.TEXTURE1),Sn.atlasTextureIcon&&Sn.atlasTextureIcon.bind(Sn.atlasInterpolationIcon,Ye.CLAMP_TO_EDGE)),Sn.isSDF){const Jn=Sn.uniformValues;Sn.hasHalo&&(Jn.u_is_halo=1,Zl(Sn.buffers,En.segments,S,$,Sn.program,sn,Me,Ce,Jn,En.terrainData)),Jn.u_is_halo=0}Zl(Sn.buffers,En.segments,S,$,Sn.program,sn,Me,Ce,Sn.uniformValues,En.terrainData)}}function Zl($,o,S,O,C,j,J,ie,ce,Se){const Me=O.context;C.draw(Me,Me.gl.TRIANGLES,j,J,ie,Fr.disabled,ce,Se,S.id,$.layoutVertexBuffer,$.indexBuffer,o,S.paint,O.transform.zoom,$.programConfigurations.get(S.id),$.dynamicLayoutVertexBuffer,$.opacityVertexBuffer)}function vd($,o,S,O){const C=$.context,j=C.gl,J=zn.disabled,ie=new jr([j.ONE,j.ONE],r.aM.transparent,[!0,!0,!0,!0]),ce=o.getBucket(S);if(!ce)return;const Se=O.key;let Me=S.heatmapFbos.get(Se);Me||(Me=kc(C,o.tileSize,o.tileSize),S.heatmapFbos.set(Se,Me)),C.bindFramebuffer.set(Me.framebuffer),C.viewport.set([0,0,o.tileSize,o.tileSize]),C.clear({color:r.aM.transparent});const Ce=ce.programConfigurations.get(S.id),He=$.useProgram("heatmap",Ce),Ye=$.style.map.terrain.getTerrainData(O);He.draw(C,j.TRIANGLES,yr.disabled,J,ie,Fr.disabled,Ui(O.posMatrix,o,$.transform.zoom,S.paint.get("heatmap-intensity")),Ye,S.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,S.paint,$.transform.zoom,Ce)}function uo($,o,S){const O=$.context,C=O.gl;O.setColorMode($.colorModeForRenderPass());const j=du(O,o),J=S.key,ie=o.heatmapFbos.get(J);ie&&(O.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,ie.colorAttachment.get()),O.activeTexture.set(C.TEXTURE1),j.bind(C.LINEAR,C.CLAMP_TO_EDGE),$.useProgram("heatmapTexture").draw(O,C.TRIANGLES,yr.disabled,zn.disabled,$.colorModeForRenderPass(),Fr.disabled,Gi($,o,0,1),null,o.id,$.rasterBoundsBuffer,$.quadTriangleIndexBuffer,$.rasterBoundsSegments,o.paint,$.transform.zoom),ie.destroy(),o.heatmapFbos.delete(J))}function kc($,o,S){var O,C;const j=$.gl,J=j.createTexture();j.bindTexture(j.TEXTURE_2D,J),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,j.CLAMP_TO_EDGE),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_MAG_FILTER,j.LINEAR);const ie=(O=$.HALF_FLOAT)!==null&&O!==void 0?O:j.UNSIGNED_BYTE,ce=(C=$.RGBA16F)!==null&&C!==void 0?C:j.RGBA;j.texImage2D(j.TEXTURE_2D,0,ce,o,S,0,j.RGBA,ie,null);const Se=$.createFramebuffer(o,S,!1,!1);return Se.colorAttachment.set(J),Se}function du($,o){return o.colorRampTexture||(o.colorRampTexture=new G($,o.colorRamp,$.gl.RGBA)),o.colorRampTexture}function li($,o,S,O,C){if(!S||!O||!O.imageAtlas)return;const j=O.imageAtlas.patternPositions;let J=j[S.to.toString()],ie=j[S.from.toString()];if(!J&&ie&&(J=ie),!ie&&J&&(ie=J),!J||!ie){const ce=C.getPaintProperty(o);J=j[ce],ie=j[ce]}J&&ie&&$.setConstantPatternPositions(J,ie)}function pu($,o,S,O,C,j,J){const ie=$.context.gl,ce="fill-pattern",Se=S.paint.get(ce),Me=Se&&Se.constantOr(1),Ce=S.getCrossfadeParameters();let He,Ye,tt,ht,yt;J?(Ye=Me&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",He=ie.LINES):(Ye=Me?"fillPattern":"fill",He=ie.TRIANGLES);const vt=Se.constantOr(null);for(const kt of O){const lt=o.getTile(kt);if(Me&&!lt.patternsLoaded())continue;const Rt=lt.getBucket(S);if(!Rt)continue;const Nt=Rt.programConfigurations.get(S.id),zt=$.useProgram(Ye,Nt),sn=$.style.map.terrain&&$.style.map.terrain.getTerrainData(kt);Me&&($.context.activeTexture.set(ie.TEXTURE0),lt.imageAtlasTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),Nt.updatePaintBuffers(Ce)),li(Nt,ce,vt,lt,S);const gn=sn?kt:null,Cn=$.translatePosMatrix(gn?gn.posMatrix:kt.posMatrix,lt,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor"));if(J){ht=Rt.indexBuffer2,yt=Rt.segments2;const Fn=[ie.drawingBufferWidth,ie.drawingBufferHeight];tt=Ye==="fillOutlinePattern"&&Me?za(Cn,$,Ce,lt,Fn):Kl(Cn,Fn)}else ht=Rt.indexBuffer,yt=Rt.segments,tt=Me?Ho(Cn,$,Ce,lt):Ss(Cn);zt.draw($.context,He,C,$.stencilModeForClipping(kt),j,Fr.disabled,tt,sn,S.id,Rt.layoutVertexBuffer,ht,yt,S.paint,$.transform.zoom,Nt)}}function la($,o,S,O,C,j,J){const ie=$.context,ce=ie.gl,Se="fill-extrusion-pattern",Me=S.paint.get(Se),Ce=Me.constantOr(1),He=S.getCrossfadeParameters(),Ye=S.paint.get("fill-extrusion-opacity"),tt=Me.constantOr(null);for(const ht of O){const yt=o.getTile(ht),vt=yt.getBucket(S);if(!vt)continue;const kt=$.style.map.terrain&&$.style.map.terrain.getTerrainData(ht),lt=vt.programConfigurations.get(S.id),Rt=$.useProgram(Ce?"fillExtrusionPattern":"fillExtrusion",lt);Ce&&($.context.activeTexture.set(ce.TEXTURE0),yt.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),lt.updatePaintBuffers(He)),li(lt,Se,tt,yt,S);const Nt=$.translatePosMatrix(ht.posMatrix,yt,S.paint.get("fill-extrusion-translate"),S.paint.get("fill-extrusion-translate-anchor")),zt=S.paint.get("fill-extrusion-vertical-gradient"),sn=Ce?Ao(Nt,$,zt,Ye,ht,He,yt):lo(Nt,$,zt,Ye);Rt.draw(ie,ie.gl.TRIANGLES,C,j,J,Fr.backCCW,sn,kt,S.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,S.paint,$.transform.zoom,lt,$.style.map.terrain&&vt.centroidVertexBuffer)}}function Pc($,o,S,O,C,j,J){const ie=$.context,ce=ie.gl,Se=S.fbo;if(!Se)return;const Me=$.useProgram("hillshade"),Ce=$.style.map.terrain&&$.style.map.terrain.getTerrainData(o);ie.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,Se.colorAttachment.get()),Me.draw(ie,ce.TRIANGLES,C,j,J,Fr.disabled,((He,Ye,tt,ht)=>{const yt=tt.paint.get("hillshade-shadow-color"),vt=tt.paint.get("hillshade-highlight-color"),kt=tt.paint.get("hillshade-accent-color");let lt=tt.paint.get("hillshade-illumination-direction")*(Math.PI/180);tt.paint.get("hillshade-illumination-anchor")==="viewport"&&(lt-=He.transform.angle);const Rt=!He.options.moving;return{u_matrix:ht?ht.posMatrix:He.transform.calculatePosMatrix(Ye.tileID.toUnwrapped(),Rt),u_image:0,u_latrange:sa(0,Ye.tileID),u_light:[tt.paint.get("hillshade-exaggeration"),lt],u_shadow:yt,u_highlight:vt,u_accent:kt}})($,S,O,Ce?o:null),Ce,O.id,$.rasterBoundsBuffer,$.quadTriangleIndexBuffer,$.rasterBoundsSegments)}function Tc($,o,S,O,C,j){const J=$.context,ie=J.gl,ce=o.dem;if(ce&&ce.data){const Se=ce.dim,Me=ce.stride,Ce=ce.getPixels();if(J.activeTexture.set(ie.TEXTURE1),J.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||$.getTileTexture(Me),o.demTexture){const Ye=o.demTexture;Ye.update(Ce,{premultiply:!1}),Ye.bind(ie.NEAREST,ie.CLAMP_TO_EDGE)}else o.demTexture=new G(J,Ce,ie.RGBA,{premultiply:!1}),o.demTexture.bind(ie.NEAREST,ie.CLAMP_TO_EDGE);J.activeTexture.set(ie.TEXTURE0);let He=o.fbo;if(!He){const Ye=new G(J,{width:Se,height:Se,data:null},ie.RGBA);Ye.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),He=o.fbo=J.createFramebuffer(Se,Se,!0,!1),He.colorAttachment.set(Ye.texture)}J.bindFramebuffer.set(He.framebuffer),J.viewport.set([0,0,Se,Se]),$.useProgram("hillshadePrepare").draw(J,ie.TRIANGLES,O,C,j,Fr.disabled,((Ye,tt)=>{const ht=tt.stride,yt=r.H();return r.aP(yt,0,r.X,-r.X,0,0,1),r.J(yt,yt,[0,-r.X,0]),{u_matrix:yt,u_image:1,u_dimension:[ht,ht],u_zoom:Ye.overscaledZ,u_unpack:tt.getUnpackVector()}})(o.tileID,ce),null,S.id,$.rasterBoundsBuffer,$.quadTriangleIndexBuffer,$.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Pm($,o,S,O,C,j){const J=O.paint.get("raster-fade-duration");if(!j&&J>0){const ie=g.now(),ce=(ie-$.timeAdded)/J,Se=o?(ie-o.timeAdded)/J:-1,Me=S.getSource(),Ce=C.coveringZoomLevel({tileSize:Me.tileSize,roundZoom:Me.roundZoom}),He=!o||Math.abs(o.tileID.overscaledZ-Ce)>Math.abs($.tileID.overscaledZ-Ce),Ye=He&&$.refreshedUponExpiration?1:r.ac(He?ce:1-Se,0,1);return $.refreshedUponExpiration&&ce>=1&&($.refreshedUponExpiration=!1),o?{opacity:1,mix:1-Ye}:{opacity:Ye,mix:0}}return{opacity:1,mix:0}}const mu=new r.aM(1,0,0,1),si=new r.aM(0,1,0,1),Mh=new r.aM(0,0,1,1),C0=new r.aM(1,0,1,1),Tm=new r.aM(0,1,1,1);function Es($,o,S,O){gu($,0,o+S/2,$.transform.width,S,O)}function Om($,o,S,O){gu($,o-S/2,0,S,$.transform.height,O)}function gu($,o,S,O,C,j){const J=$.context,ie=J.gl;ie.enable(ie.SCISSOR_TEST),ie.scissor(o*$.pixelRatio,S*$.pixelRatio,O*$.pixelRatio,C*$.pixelRatio),J.clear({color:j}),ie.disable(ie.SCISSOR_TEST)}function _d($,o,S){const O=$.context,C=O.gl,j=S.posMatrix,J=$.useProgram("debug"),ie=yr.disabled,ce=zn.disabled,Se=$.colorModeForRenderPass(),Me="$debug",Ce=$.style.map.terrain&&$.style.map.terrain.getTerrainData(S);O.activeTexture.set(C.TEXTURE0);const He=o.getTileByID(S.key).latestRawTileData,Ye=Math.floor((He&&He.byteLength||0)/1024),tt=o.getTile(S).tileSize,ht=512/Math.min(tt,512)*(S.overscaledZ/$.transform.zoom)*.5;let yt=S.canonical.toString();S.overscaledZ!==S.canonical.z&&(yt+=` => ${S.overscaledZ}`),function(vt,kt){vt.initDebugOverlayCanvas();const lt=vt.debugOverlayCanvas,Rt=vt.context.gl,Nt=vt.debugOverlayCanvas.getContext("2d");Nt.clearRect(0,0,lt.width,lt.height),Nt.shadowColor="white",Nt.shadowBlur=2,Nt.lineWidth=1.5,Nt.strokeStyle="white",Nt.textBaseline="top",Nt.font="bold 36px Open Sans, sans-serif",Nt.fillText(kt,5,5),Nt.strokeText(kt,5,5),vt.debugOverlayTexture.update(lt),vt.debugOverlayTexture.bind(Rt.LINEAR,Rt.CLAMP_TO_EDGE)}($,`${yt} ${Ye}kB`),J.draw(O,C.TRIANGLES,ie,ce,jr.alphaBlended,Fr.disabled,Wo(j,r.aM.transparent,ht),null,Me,$.debugBuffer,$.quadTriangleIndexBuffer,$.debugSegments),J.draw(O,C.LINE_STRIP,ie,ce,Se,Fr.disabled,Wo(j,r.aM.red),Ce,Me,$.debugBuffer,$.tileBorderIndexBuffer,$.debugSegments)}function Ch($,o,S){const O=$.context,C=O.gl,j=$.colorModeForRenderPass(),J=new yr(C.LEQUAL,yr.ReadWrite,$.depthRangeFor3D),ie=$.useProgram("terrain"),ce=o.getTerrainMesh();O.bindFramebuffer.set(null),O.viewport.set([0,0,$.width,$.height]);for(const Se of S){const Me=$.renderToTexture.getTexture(Se),Ce=o.getTerrainData(Se.tileID);O.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,Me.texture);const He=$.transform.calculatePosMatrix(Se.tileID.toUnwrapped()),Ye=o.getMeshFrameDelta($.transform.zoom),tt=$.transform.calculateFogMatrix(Se.tileID.toUnwrapped()),ht=rs(He,Ye,tt,$.style.sky,$.transform.pitch);ie.draw(O,C.TRIANGLES,J,zn.disabled,j,Fr.backCCW,ht,Ce,"terrain",ce.vertexBuffer,ce.indexBuffer,ce.segments)}}class yu{constructor(o,S,O){this.vertexBuffer=o,this.indexBuffer=S,this.segments=O}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class bu{constructor(o,S){this.context=new xi(o),this.transform=S,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:r.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=rn.maxUnderzooming+rn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new hi}resize(o,S,O){if(this.width=Math.floor(o*O),this.height=Math.floor(S*O),this.pixelRatio=O,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){const o=this.context,S=new r.aX;S.emplaceBack(0,0),S.emplaceBack(r.X,0),S.emplaceBack(0,r.X),S.emplaceBack(r.X,r.X),this.tileExtentBuffer=o.createVertexBuffer(S,Di.members),this.tileExtentSegments=r.a0.simpleSegment(0,0,4,2);const O=new r.aX;O.emplaceBack(0,0),O.emplaceBack(r.X,0),O.emplaceBack(0,r.X),O.emplaceBack(r.X,r.X),this.debugBuffer=o.createVertexBuffer(O,Di.members),this.debugSegments=r.a0.simpleSegment(0,0,4,5);const C=new r.$;C.emplaceBack(0,0,0,0),C.emplaceBack(r.X,0,r.X,0),C.emplaceBack(0,r.X,0,r.X),C.emplaceBack(r.X,r.X,r.X,r.X),this.rasterBoundsBuffer=o.createVertexBuffer(C,et.members),this.rasterBoundsSegments=r.a0.simpleSegment(0,0,4,2);const j=new r.aX;j.emplaceBack(0,0),j.emplaceBack(1,0),j.emplaceBack(0,1),j.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(j,Di.members),this.viewportSegments=r.a0.simpleSegment(0,0,4,2);const J=new r.aZ;J.emplaceBack(0),J.emplaceBack(1),J.emplaceBack(3),J.emplaceBack(2),J.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(J);const ie=new r.aY;ie.emplaceBack(0,1,2),ie.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(ie);const ce=this.context.gl;this.stencilClearMode=new zn({func:ce.ALWAYS,mask:0},0,255,ce.ZERO,ce.ZERO,ce.ZERO)}clearStencil(){const o=this.context,S=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const O=r.H();r.aP(O,0,this.width,this.height,0,0,1),r.K(O,O,[S.drawingBufferWidth,S.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,S.TRIANGLES,yr.disabled,this.stencilClearMode,jr.disabled,Fr.disabled,Wi(O),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,S){if(this.currentStencilSource===o.source||!o.isTileClipped()||!S||!S.length)return;this.currentStencilSource=o.source;const O=this.context,C=O.gl;this.nextStencilID+S.length>256&&this.clearStencil(),O.setColorMode(jr.disabled),O.setDepthMode(yr.disabled);const j=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const J of S){const ie=this._tileClippingMaskIDs[J.key]=this.nextStencilID++,ce=this.style.map.terrain&&this.style.map.terrain.getTerrainData(J);j.draw(O,C.TRIANGLES,yr.disabled,new zn({func:C.ALWAYS,mask:0},ie,255,C.KEEP,C.KEEP,C.REPLACE),jr.disabled,Fr.disabled,Wi(J.posMatrix),ce,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,S=this.context.gl;return new zn({func:S.NOTEQUAL,mask:255},o,255,S.KEEP,S.KEEP,S.REPLACE)}stencilModeForClipping(o){const S=this.context.gl;return new zn({func:S.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,S.KEEP,S.KEEP,S.REPLACE)}stencilConfigForOverlap(o){const S=this.context.gl,O=o.sort((J,ie)=>ie.overscaledZ-J.overscaledZ),C=O[O.length-1].overscaledZ,j=O[0].overscaledZ-C+1;if(j>1){this.currentStencilSource=void 0,this.nextStencilID+j>256&&this.clearStencil();const J={};for(let ie=0;ie<j;ie++)J[ie+C]=new zn({func:S.GEQUAL,mask:255},ie+this.nextStencilID,255,S.KEEP,S.KEEP,S.REPLACE);return this.nextStencilID+=j,[J,O]}return[{[C]:zn.disabled},O]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new jr([o.CONSTANT_COLOR,o.ONE],new r.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?jr.unblended:jr.alphaBlended}depthModeForSublayer(o,S,O){if(!this.opaquePassEnabledForLayer())return yr.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new yr(O||this.context.gl.LEQUAL,S,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,S){this.style=o,this.options=S,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(g.now()),this.imageManager.beginFrame();const O=this.style._order,C=this.style.sourceCaches,j={},J={},ie={};for(const ce in C){const Se=C[ce];Se.used&&Se.prepare(this.context),j[ce]=Se.getVisibleCoordinates(),J[ce]=j[ce].slice().reverse(),ie[ce]=Se.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ce=0;ce<O.length;ce++)if(this.style._layers[O[ce]].is3D()){this.opaquePassCutoff=ce;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const ce of O){const Se=this.style._layers[ce];if(!Se.hasOffscreenPass()||Se.isHidden(this.transform.zoom))continue;const Me=J[Se.source];(Se.type==="custom"||Me.length)&&this.renderLayer(this,C[Se.source],Se,Me)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:S.showOverdrawInspector?r.aM.black:r.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(ce,Se){const Me=ce.context,Ce=Me.gl,He=((vt,kt,lt)=>({u_sky_color:vt.properties.get("sky-color"),u_horizon_color:vt.properties.get("horizon-color"),u_horizon:(kt.height/2+kt.getHorizon())*lt,u_sky_horizon_blend:vt.properties.get("sky-horizon-blend")*kt.height/2*lt}))(Se,ce.style.map.transform,ce.pixelRatio),Ye=new yr(Ce.LEQUAL,yr.ReadWrite,[0,1]),tt=zn.disabled,ht=ce.colorModeForRenderPass(),yt=ce.useProgram("sky");if(!Se.mesh){const vt=new r.aX;vt.emplaceBack(-1,-1),vt.emplaceBack(1,-1),vt.emplaceBack(1,1),vt.emplaceBack(-1,1);const kt=new r.aY;kt.emplaceBack(0,1,2),kt.emplaceBack(0,2,3),Se.mesh=new yu(Me.createVertexBuffer(vt,Di.members),Me.createIndexBuffer(kt),r.a0.simpleSegment(0,0,vt.length,kt.length))}yt.draw(Me,Ce.TRIANGLES,Ye,tt,ht,Fr.disabled,He,void 0,"sky",Se.mesh.vertexBuffer,Se.mesh.indexBuffer,Se.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=S.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=O.length-1;this.currentLayer>=0;this.currentLayer--){const ce=this.style._layers[O[this.currentLayer]],Se=C[ce.source],Me=j[ce.source];this._renderTileClippingMasks(ce,Me),this.renderLayer(this,Se,ce,Me)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<O.length;this.currentLayer++){const ce=this.style._layers[O[this.currentLayer]],Se=C[ce.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(ce))continue;const Me=(ce.type==="symbol"?ie:J)[ce.source];this._renderTileClippingMasks(ce,j[ce.source]),this.renderLayer(this,Se,ce,Me)}if(this.options.showTileBoundaries){const ce=function(Se,Me){let Ce=null;const He=Object.values(Se._layers).flatMap(yt=>yt.source&&!yt.isHidden(Me)?[Se.sourceCaches[yt.source]]:[]),Ye=He.filter(yt=>yt.getSource().type==="vector"),tt=He.filter(yt=>yt.getSource().type!=="vector"),ht=yt=>{(!Ce||Ce.getSource().maxzoom<yt.getSource().maxzoom)&&(Ce=yt)};return Ye.forEach(yt=>ht(yt)),Ce||tt.forEach(yt=>ht(yt)),Ce}(this.style,this.transform.zoom);ce&&function(Se,Me,Ce){for(let He=0;He<Ce.length;He++)_d(Se,Me,Ce[He])}(this,ce,ce.getVisibleCoordinates())}this.options.showPadding&&function(ce){const Se=ce.transform.padding;Es(ce,ce.transform.height-(Se.top||0),3,mu),Es(ce,Se.bottom||0,3,si),Om(ce,Se.left||0,3,Mh),Om(ce,ce.transform.width-(Se.right||0),3,C0);const Me=ce.transform.centerPoint;(function(Ce,He,Ye,tt){gu(Ce,He-1,Ye-10,2,20,tt),gu(Ce,He-10,Ye-1,20,2,tt)})(ce,Me.x,ce.transform.height-Me.y,Tm)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const S=this.terrainFacilitator.matrix,O=this.transform.modelViewProjectionMatrix;let C=this.terrainFacilitator.dirty;C||(C=o?!r.a_(S,O):!r.a$(S,O)),C||(C=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),C&&(r.b0(S,O),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(j,J){const ie=j.context,ce=ie.gl,Se=jr.unblended,Me=new yr(ce.LEQUAL,yr.ReadWrite,[0,1]),Ce=J.getTerrainMesh(),He=J.sourceCache.getRenderableTiles(),Ye=j.useProgram("terrainDepth");ie.bindFramebuffer.set(J.getFramebuffer("depth").framebuffer),ie.viewport.set([0,0,j.width/devicePixelRatio,j.height/devicePixelRatio]),ie.clear({color:r.aM.transparent,depth:1});for(const tt of He){const ht=J.getTerrainData(tt.tileID),yt={u_matrix:j.transform.calculatePosMatrix(tt.tileID.toUnwrapped()),u_ele_delta:J.getMeshFrameDelta(j.transform.zoom)};Ye.draw(ie,ce.TRIANGLES,Me,zn.disabled,Se,Fr.backCCW,yt,ht,"terrain",Ce.vertexBuffer,Ce.indexBuffer,Ce.segments)}ie.bindFramebuffer.set(null),ie.viewport.set([0,0,j.width,j.height])}(this,this.style.map.terrain),function(j,J){const ie=j.context,ce=ie.gl,Se=jr.unblended,Me=new yr(ce.LEQUAL,yr.ReadWrite,[0,1]),Ce=J.getTerrainMesh(),He=J.getCoordsTexture(),Ye=J.sourceCache.getRenderableTiles(),tt=j.useProgram("terrainCoords");ie.bindFramebuffer.set(J.getFramebuffer("coords").framebuffer),ie.viewport.set([0,0,j.width/devicePixelRatio,j.height/devicePixelRatio]),ie.clear({color:r.aM.transparent,depth:1}),J.coordsIndex=[];for(const ht of Ye){const yt=J.getTerrainData(ht.tileID);ie.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,He.texture);const vt={u_matrix:j.transform.calculatePosMatrix(ht.tileID.toUnwrapped()),u_terrain_coords_id:(255-J.coordsIndex.length)/255,u_texture:0,u_ele_delta:J.getMeshFrameDelta(j.transform.zoom)};tt.draw(ie,ce.TRIANGLES,Me,zn.disabled,Se,Fr.backCCW,vt,yt,"terrain",Ce.vertexBuffer,Ce.indexBuffer,Ce.segments),J.coordsIndex.push(ht.tileID.key)}ie.bindFramebuffer.set(null),ie.viewport.set([0,0,j.width,j.height])}(this,this.style.map.terrain))}renderLayer(o,S,O,C){if(!O.isHidden(this.transform.zoom)&&(O.type==="background"||O.type==="custom"||(C||[]).length))switch(this.id=O.id,O.type){case"symbol":(function(j,J,ie,ce,Se){if(j.renderPass!=="translucent")return;const Me=zn.disabled,Ce=j.colorModeForRenderPass();(ie._unevaluatedLayout.hasValue("text-variable-anchor")||ie._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(He,Ye,tt,ht,yt,vt,kt,lt,Rt){const Nt=Ye.transform,zt=zr(),sn=yt==="map",gn=vt==="map";for(const Cn of He){const Fn=ht.getTile(Cn),En=Fn.getBucket(tt);if(!En||!En.text||!En.text.segments.get().length)continue;const Sn=r.ag(En.textSizeData,Nt.zoom),Jn=ln(Fn,1,Ye.transform.zoom),Nr=Ir(Cn.posMatrix,gn,sn,Ye.transform,Jn),An=tt.layout.get("icon-text-fit")!=="none"&&En.hasIconData();if(Sn){const Nn=Math.pow(2,Nt.zoom-Fn.tileID.overscaledZ),Rr=Ye.style.map.terrain?(Gr,ti)=>Ye.style.map.terrain.getElevation(Cn,Gr,ti):null,Ni=zt.translatePosition(Nt,Fn,kt,lt);aa(En,sn,gn,Rt,Nt,Nr,Cn.posMatrix,Nn,Sn,An,zt,Ni,Cn.toUnwrapped(),Rr)}}}(ce,j,ie,J,ie.layout.get("text-rotation-alignment"),ie.layout.get("text-pitch-alignment"),ie.paint.get("text-translate"),ie.paint.get("text-translate-anchor"),Se),ie.paint.get("icon-opacity").constantOr(1)!==0&&qa(j,J,ie,ce,!1,ie.paint.get("icon-translate"),ie.paint.get("icon-translate-anchor"),ie.layout.get("icon-rotation-alignment"),ie.layout.get("icon-pitch-alignment"),ie.layout.get("icon-keep-upright"),Me,Ce),ie.paint.get("text-opacity").constantOr(1)!==0&&qa(j,J,ie,ce,!0,ie.paint.get("text-translate"),ie.paint.get("text-translate-anchor"),ie.layout.get("text-rotation-alignment"),ie.layout.get("text-pitch-alignment"),ie.layout.get("text-keep-upright"),Me,Ce),J.map.showCollisionBoxes&&(bi(j,J,ie,ce,!0),bi(j,J,ie,ce,!1))})(o,S,O,C,this.style.placement.variableOffsets);break;case"circle":(function(j,J,ie,ce){if(j.renderPass!=="translucent")return;const Se=ie.paint.get("circle-opacity"),Me=ie.paint.get("circle-stroke-width"),Ce=ie.paint.get("circle-stroke-opacity"),He=!ie.layout.get("circle-sort-key").isConstant();if(Se.constantOr(1)===0&&(Me.constantOr(1)===0||Ce.constantOr(1)===0))return;const Ye=j.context,tt=Ye.gl,ht=j.depthModeForSublayer(0,yr.ReadOnly),yt=zn.disabled,vt=j.colorModeForRenderPass(),kt=[];for(let lt=0;lt<ce.length;lt++){const Rt=ce[lt],Nt=J.getTile(Rt),zt=Nt.getBucket(ie);if(!zt)continue;const sn=zt.programConfigurations.get(ie.id),gn=j.useProgram("circle",sn),Cn=zt.layoutVertexBuffer,Fn=zt.indexBuffer,En=j.style.map.terrain&&j.style.map.terrain.getTerrainData(Rt),Sn={programConfiguration:sn,program:gn,layoutVertexBuffer:Cn,indexBuffer:Fn,uniformValues:Ua(j,Rt,Nt,ie),terrainData:En};if(He){const Jn=zt.segments.get();for(const Nr of Jn)kt.push({segments:new r.a0([Nr]),sortKey:Nr.sortKey,state:Sn})}else kt.push({segments:zt.segments,sortKey:0,state:Sn})}He&&kt.sort((lt,Rt)=>lt.sortKey-Rt.sortKey);for(const lt of kt){const{programConfiguration:Rt,program:Nt,layoutVertexBuffer:zt,indexBuffer:sn,uniformValues:gn,terrainData:Cn}=lt.state;Nt.draw(Ye,tt.TRIANGLES,ht,yt,vt,Fr.disabled,gn,Cn,ie.id,zt,sn,lt.segments,ie.paint,j.transform.zoom,Rt)}})(o,S,O,C);break;case"heatmap":(function(j,J,ie,ce){if(ie.paint.get("heatmap-opacity")===0)return;const Se=j.context;if(j.style.map.terrain){for(const Me of ce){const Ce=J.getTile(Me);J.hasRenderableParent(Me)||(j.renderPass==="offscreen"?vd(j,Ce,ie,Me):j.renderPass==="translucent"&&uo(j,ie,Me))}Se.viewport.set([0,0,j.width,j.height])}else j.renderPass==="offscreen"?function(Me,Ce,He,Ye){const tt=Me.context,ht=tt.gl,yt=zn.disabled,vt=new jr([ht.ONE,ht.ONE],r.aM.transparent,[!0,!0,!0,!0]);(function(kt,lt,Rt){const Nt=kt.gl;kt.activeTexture.set(Nt.TEXTURE1),kt.viewport.set([0,0,lt.width/4,lt.height/4]);let zt=Rt.heatmapFbos.get(r.aU);zt?(Nt.bindTexture(Nt.TEXTURE_2D,zt.colorAttachment.get()),kt.bindFramebuffer.set(zt.framebuffer)):(zt=kc(kt,lt.width/4,lt.height/4),Rt.heatmapFbos.set(r.aU,zt))})(tt,Me,He),tt.clear({color:r.aM.transparent});for(let kt=0;kt<Ye.length;kt++){const lt=Ye[kt];if(Ce.hasRenderableParent(lt))continue;const Rt=Ce.getTile(lt),Nt=Rt.getBucket(He);if(!Nt)continue;const zt=Nt.programConfigurations.get(He.id),sn=Me.useProgram("heatmap",zt),{zoom:gn}=Me.transform;sn.draw(tt,ht.TRIANGLES,yr.disabled,yt,vt,Fr.disabled,Ui(lt.posMatrix,Rt,gn,He.paint.get("heatmap-intensity")),null,He.id,Nt.layoutVertexBuffer,Nt.indexBuffer,Nt.segments,He.paint,Me.transform.zoom,zt)}tt.viewport.set([0,0,Me.width,Me.height])}(j,J,ie,ce):j.renderPass==="translucent"&&function(Me,Ce){const He=Me.context,Ye=He.gl;He.setColorMode(Me.colorModeForRenderPass());const tt=Ce.heatmapFbos.get(r.aU);tt&&(He.activeTexture.set(Ye.TEXTURE0),Ye.bindTexture(Ye.TEXTURE_2D,tt.colorAttachment.get()),He.activeTexture.set(Ye.TEXTURE1),du(He,Ce).bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE),Me.useProgram("heatmapTexture").draw(He,Ye.TRIANGLES,yr.disabled,zn.disabled,Me.colorModeForRenderPass(),Fr.disabled,Gi(Me,Ce,0,1),null,Ce.id,Me.viewportBuffer,Me.quadTriangleIndexBuffer,Me.viewportSegments,Ce.paint,Me.transform.zoom))}(j,ie)})(o,S,O,C);break;case"line":(function(j,J,ie,ce){if(j.renderPass!=="translucent")return;const Se=ie.paint.get("line-opacity"),Me=ie.paint.get("line-width");if(Se.constantOr(1)===0||Me.constantOr(1)===0)return;const Ce=j.depthModeForSublayer(0,yr.ReadOnly),He=j.colorModeForRenderPass(),Ye=ie.paint.get("line-dasharray"),tt=ie.paint.get("line-pattern"),ht=tt.constantOr(1),yt=ie.paint.get("line-gradient"),vt=ie.getCrossfadeParameters(),kt=ht?"linePattern":Ye?"lineSDF":yt?"lineGradient":"line",lt=j.context,Rt=lt.gl;let Nt=!0;for(const zt of ce){const sn=J.getTile(zt);if(ht&&!sn.patternsLoaded())continue;const gn=sn.getBucket(ie);if(!gn)continue;const Cn=gn.programConfigurations.get(ie.id),Fn=j.context.program.get(),En=j.useProgram(kt,Cn),Sn=Nt||En.program!==Fn,Jn=j.style.map.terrain&&j.style.map.terrain.getTerrainData(zt),Nr=tt.constantOr(null);if(Nr&&sn.imageAtlas){const Rr=sn.imageAtlas,Ni=Rr.patternPositions[Nr.to.toString()],Gr=Rr.patternPositions[Nr.from.toString()];Ni&&Gr&&Cn.setConstantPatternPositions(Ni,Gr)}const An=Jn?zt:null,Nn=ht?Mr(j,sn,ie,vt,An):Ye?ke(j,sn,ie,Ye,vt,An):yt?Xl(j,sn,ie,gn.lineClipsArray.length,An):Va(j,sn,ie,An);if(ht)lt.activeTexture.set(Rt.TEXTURE0),sn.imageAtlasTexture.bind(Rt.LINEAR,Rt.CLAMP_TO_EDGE),Cn.updatePaintBuffers(vt);else if(Ye&&(Sn||j.lineAtlas.dirty))lt.activeTexture.set(Rt.TEXTURE0),j.lineAtlas.bind(lt);else if(yt){const Rr=gn.gradients[ie.id];let Ni=Rr.texture;if(ie.gradientVersion!==Rr.version){let Gr=256;if(ie.stepInterpolant){const ti=J.getSource().maxzoom,$i=zt.canonical.z===ti?Math.ceil(1<<j.transform.maxZoom-zt.canonical.z):1;Gr=r.ac(r.aV(gn.maxLineLength/r.X*1024*$i),256,lt.maxTextureSize)}Rr.gradient=r.aW({expression:ie.gradientExpression(),evaluationKey:"lineProgress",resolution:Gr,image:Rr.gradient||void 0,clips:gn.lineClipsArray}),Rr.texture?Rr.texture.update(Rr.gradient):Rr.texture=new G(lt,Rr.gradient,Rt.RGBA),Rr.version=ie.gradientVersion,Ni=Rr.texture}lt.activeTexture.set(Rt.TEXTURE0),Ni.bind(ie.stepInterpolant?Rt.NEAREST:Rt.LINEAR,Rt.CLAMP_TO_EDGE)}En.draw(lt,Rt.TRIANGLES,Ce,j.stencilModeForClipping(zt),He,Fr.disabled,Nn,Jn,ie.id,gn.layoutVertexBuffer,gn.indexBuffer,gn.segments,ie.paint,j.transform.zoom,Cn,gn.layoutVertexBuffer2),Nt=!1}})(o,S,O,C);break;case"fill":(function(j,J,ie,ce){const Se=ie.paint.get("fill-color"),Me=ie.paint.get("fill-opacity");if(Me.constantOr(1)===0)return;const Ce=j.colorModeForRenderPass(),He=ie.paint.get("fill-pattern"),Ye=j.opaquePassEnabledForLayer()&&!He.constantOr(1)&&Se.constantOr(r.aM.transparent).a===1&&Me.constantOr(0)===1?"opaque":"translucent";if(j.renderPass===Ye){const tt=j.depthModeForSublayer(1,j.renderPass==="opaque"?yr.ReadWrite:yr.ReadOnly);pu(j,J,ie,ce,tt,Ce,!1)}if(j.renderPass==="translucent"&&ie.paint.get("fill-antialias")){const tt=j.depthModeForSublayer(ie.getPaintProperty("fill-outline-color")?2:0,yr.ReadOnly);pu(j,J,ie,ce,tt,Ce,!0)}})(o,S,O,C);break;case"fill-extrusion":(function(j,J,ie,ce){const Se=ie.paint.get("fill-extrusion-opacity");if(Se!==0&&j.renderPass==="translucent"){const Me=new yr(j.context.gl.LEQUAL,yr.ReadWrite,j.depthRangeFor3D);if(Se!==1||ie.paint.get("fill-extrusion-pattern").constantOr(1))la(j,J,ie,ce,Me,zn.disabled,jr.disabled),la(j,J,ie,ce,Me,j.stencilModeFor3D(),j.colorModeForRenderPass());else{const Ce=j.colorModeForRenderPass();la(j,J,ie,ce,Me,zn.disabled,Ce)}}})(o,S,O,C);break;case"hillshade":(function(j,J,ie,ce){if(j.renderPass!=="offscreen"&&j.renderPass!=="translucent")return;const Se=j.context,Me=j.depthModeForSublayer(0,yr.ReadOnly),Ce=j.colorModeForRenderPass(),[He,Ye]=j.renderPass==="translucent"?j.stencilConfigForOverlap(ce):[{},ce];for(const tt of Ye){const ht=J.getTile(tt);ht.needsHillshadePrepare!==void 0&&ht.needsHillshadePrepare&&j.renderPass==="offscreen"?Tc(j,ht,ie,Me,zn.disabled,Ce):j.renderPass==="translucent"&&Pc(j,tt,ht,ie,Me,He[tt.overscaledZ],Ce)}Se.viewport.set([0,0,j.width,j.height])})(o,S,O,C);break;case"raster":(function(j,J,ie,ce){if(j.renderPass!=="translucent"||ie.paint.get("raster-opacity")===0||!ce.length)return;const Se=j.context,Me=Se.gl,Ce=J.getSource(),He=j.useProgram("raster"),Ye=j.colorModeForRenderPass(),[tt,ht]=Ce instanceof ft?[{},ce]:j.stencilConfigForOverlap(ce),yt=ht[ht.length-1].overscaledZ,vt=!j.options.moving;for(const kt of ht){const lt=j.depthModeForSublayer(kt.overscaledZ-yt,ie.paint.get("raster-opacity")===1?yr.ReadWrite:yr.ReadOnly,Me.LESS),Rt=J.getTile(kt);Rt.registerFadeDuration(ie.paint.get("raster-fade-duration"));const Nt=J.findLoadedParent(kt,0),zt=J.findLoadedSibling(kt),sn=Pm(Rt,Nt||zt||null,J,ie,j.transform,j.style.map.terrain);let gn,Cn;const Fn=ie.paint.get("raster-resampling")==="nearest"?Me.NEAREST:Me.LINEAR;Se.activeTexture.set(Me.TEXTURE0),Rt.texture.bind(Fn,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST),Se.activeTexture.set(Me.TEXTURE1),Nt?(Nt.texture.bind(Fn,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST),gn=Math.pow(2,Nt.tileID.overscaledZ-Rt.tileID.overscaledZ),Cn=[Rt.tileID.canonical.x*gn%1,Rt.tileID.canonical.y*gn%1]):Rt.texture.bind(Fn,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST),Rt.texture.useMipmap&&Se.extTextureFilterAnisotropic&&j.transform.pitch>20&&Me.texParameterf(Me.TEXTURE_2D,Se.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Se.extTextureFilterAnisotropicMax);const En=j.style.map.terrain&&j.style.map.terrain.getTerrainData(kt),Sn=En?kt:null,Jn=Sn?Sn.posMatrix:j.transform.calculatePosMatrix(kt.toUnwrapped(),vt),Nr=ut(Jn,Cn||[0,0],gn||1,sn,ie);Ce instanceof ft?He.draw(Se,Me.TRIANGLES,lt,zn.disabled,Ye,Fr.disabled,Nr,En,ie.id,Ce.boundsBuffer,j.quadTriangleIndexBuffer,Ce.boundsSegments):He.draw(Se,Me.TRIANGLES,lt,tt[kt.overscaledZ],Ye,Fr.disabled,Nr,En,ie.id,j.rasterBoundsBuffer,j.quadTriangleIndexBuffer,j.rasterBoundsSegments)}})(o,S,O,C);break;case"background":(function(j,J,ie,ce){const Se=ie.paint.get("background-color"),Me=ie.paint.get("background-opacity");if(Me===0)return;const Ce=j.context,He=Ce.gl,Ye=j.transform,tt=Ye.tileSize,ht=ie.paint.get("background-pattern");if(j.isPatternMissing(ht))return;const yt=!ht&&Se.a===1&&Me===1&&j.opaquePassEnabledForLayer()?"opaque":"translucent";if(j.renderPass!==yt)return;const vt=zn.disabled,kt=j.depthModeForSublayer(0,yt==="opaque"?yr.ReadWrite:yr.ReadOnly),lt=j.colorModeForRenderPass(),Rt=j.useProgram(ht?"backgroundPattern":"background"),Nt=ce||Ye.coveringTiles({tileSize:tt,terrain:j.style.map.terrain});ht&&(Ce.activeTexture.set(He.TEXTURE0),j.imageManager.bind(j.context));const zt=ie.getCrossfadeParameters();for(const sn of Nt){const gn=ce?sn.posMatrix:j.transform.calculatePosMatrix(sn.toUnwrapped()),Cn=ht?Lt(gn,Me,j,ht,{tileID:sn,tileSize:tt},zt):pt(gn,Me,Se),Fn=j.style.map.terrain&&j.style.map.terrain.getTerrainData(sn);Rt.draw(Ce,He.TRIANGLES,kt,vt,lt,Fr.disabled,Cn,Fn,ie.id,j.tileExtentBuffer,j.quadTriangleIndexBuffer,j.tileExtentSegments)}})(o,0,O,C);break;case"custom":(function(j,J,ie){const ce=j.context,Se=ie.implementation;if(j.renderPass==="offscreen"){const Me=Se.prerender;Me&&(j.setCustomLayerDefaults(),ce.setColorMode(j.colorModeForRenderPass()),Me.call(Se,ce.gl,j.transform.customLayerMatrix()),ce.setDirty(),j.setBaseState())}else if(j.renderPass==="translucent"){j.setCustomLayerDefaults(),ce.setColorMode(j.colorModeForRenderPass()),ce.setStencilMode(zn.disabled);const Me=Se.renderingMode==="3d"?new yr(j.context.gl.LEQUAL,yr.ReadWrite,j.depthRangeFor3D):j.depthModeForSublayer(0,yr.ReadOnly);ce.setDepthMode(Me),Se.render(ce.gl,j.transform.customLayerMatrix(),{farZ:j.transform.farZ,nearZ:j.transform.nearZ,fov:j.transform._fov,modelViewProjectionMatrix:j.transform.modelViewProjectionMatrix,projectionMatrix:j.transform.projectionMatrix}),ce.setDirty(),j.setBaseState(),ce.bindFramebuffer.set(null)}})(o,0,O)}}translatePosMatrix(o,S,O,C,j){if(!O[0]&&!O[1])return o;const J=j?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(J){const Se=Math.sin(J),Me=Math.cos(J);O=[O[0]*Me-O[1]*Se,O[0]*Se+O[1]*Me]}const ie=[j?O[0]:ln(S,O[0],this.transform.zoom),j?O[1]:ln(S,O[1],this.transform.zoom),0],ce=new Float32Array(16);return r.J(ce,o,ie),ce}saveTileTexture(o){const S=this._tileTextures[o.size[0]];S?S.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const S=this._tileTextures[o];return S&&S.length>0?S.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const S=this.imageManager.getPattern(o.from.toString()),O=this.imageManager.getPattern(o.to.toString());return!S||!O}useProgram(o,S){this.cache=this.cache||{};const O=o+(S?S.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[O]||(this.cache[O]=new qo(this.context,Hi[o],S,Z[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new G(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:S}=this.context.gl;return this.width!==o||this.height!==S}}class zs{constructor(o,S){this.points=o,this.planes=S}static fromInvProjectionMatrix(o,S,O){const C=Math.pow(2,O),j=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(ie=>{const ce=1/(ie=r.af([],ie,o))[3]/S*C;return r.b1(ie,ie,[ce,ce,1/ie[3],ce])}),J=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(ie=>{const ce=function(He,Ye){var tt=Ye[0],ht=Ye[1],yt=Ye[2],vt=tt*tt+ht*ht+yt*yt;return vt>0&&(vt=1/Math.sqrt(vt)),He[0]=Ye[0]*vt,He[1]=Ye[1]*vt,He[2]=Ye[2]*vt,He}([],function(He,Ye,tt){var ht=Ye[0],yt=Ye[1],vt=Ye[2],kt=tt[0],lt=tt[1],Rt=tt[2];return He[0]=yt*Rt-vt*lt,He[1]=vt*kt-ht*Rt,He[2]=ht*lt-yt*kt,He}([],R([],j[ie[0]],j[ie[1]]),R([],j[ie[2]],j[ie[1]]))),Se=-((Me=ce)[0]*(Ce=j[ie[1]])[0]+Me[1]*Ce[1]+Me[2]*Ce[2]);var Me,Ce;return ce.concat(Se)});return new zs(j,J)}}class Oc{constructor(o,S){this.min=o,this.max=S,this.center=function(O,C,j){return O[0]=.5*C[0],O[1]=.5*C[1],O[2]=.5*C[2],O}([],function(O,C,j){return O[0]=C[0]+j[0],O[1]=C[1]+j[1],O[2]=C[2]+j[2],O}([],this.min,this.max))}quadrant(o){const S=[o%2==0,o<2],O=P(this.min),C=P(this.max);for(let j=0;j<S.length;j++)O[j]=S[j]?this.min[j]:this.center[j],C[j]=S[j]?this.center[j]:this.max[j];return C[2]=this.max[2],new Oc(O,C)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const S=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let O=!0;for(let C=0;C<o.planes.length;C++){const j=o.planes[C];let J=0;for(let ie=0;ie<S.length;ie++)r.b2(j,S[ie])>=0&&J++;if(J===0)return 0;J!==S.length&&(O=!1)}if(O)return 2;for(let C=0;C<3;C++){let j=Number.MAX_VALUE,J=-Number.MAX_VALUE;for(let ie=0;ie<o.points.length;ie++){const ce=o.points[ie][C]-this.min[C];j=Math.min(j,ce),J=Math.max(J,ce)}if(J<0||j>this.max[C]-this.min[C])return 0}return 1}}class Mc{constructor(o=0,S=0,O=0,C=0){if(isNaN(o)||o<0||isNaN(S)||S<0||isNaN(O)||O<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=S,this.left=O,this.right=C}interpolate(o,S,O){return S.top!=null&&o.top!=null&&(this.top=r.y.number(o.top,S.top,O)),S.bottom!=null&&o.bottom!=null&&(this.bottom=r.y.number(o.bottom,S.bottom,O)),S.left!=null&&o.left!=null&&(this.left=r.y.number(o.left,S.left,O)),S.right!=null&&o.right!=null&&(this.right=r.y.number(o.right,S.right,O)),this}getCenter(o,S){const O=r.ac((this.left+o-this.right)/2,0,o),C=r.ac((this.top+S-this.bottom)/2,0,S);return new r.P(O,C)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Mc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const vu=85.051129;class El{constructor(o,S,O,C,j){this.tileSize=512,this._renderWorldCopies=j===void 0||!!j,this._minZoom=o||0,this._maxZoom=S||22,this._minPitch=O??0,this._maxPitch=C??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new r.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Mc,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const o=new El(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.lngRange=o.lngRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this.minElevationForCurrentTile=o.minElevationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const S=-r.b3(o,-180,180)*Math.PI/180;this.angle!==S&&(this._unmodified=!1,this.angle=S,this._calcMatrices(),this.rotationMatrix=function(){var O=new r.A(4);return r.A!=Float32Array&&(O[1]=0,O[2]=0),O[0]=1,O[3]=1,O}(),function(O,C,j){var J=C[0],ie=C[1],ce=C[2],Se=C[3],Me=Math.sin(j),Ce=Math.cos(j);O[0]=J*Ce+ce*Me,O[1]=ie*Ce+Se*Me,O[2]=J*-Me+ce*Ce,O[3]=ie*-Me+Se*Ce}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const S=r.ac(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==S&&(this._unmodified=!1,this._pitch=S,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const S=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==S&&(this._unmodified=!1,this._zoom=S,this.tileZoom=Math.max(0,Math.floor(S)),this.scale=this.zoomScale(S),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,S,O){this._unmodified=!1,this._edgeInsets.interpolate(o,S,O),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const S=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,S)}getVisibleUnwrappedCoordinates(o){const S=[new r.b4(0,o)];if(this._renderWorldCopies){const O=this.pointCoordinate(new r.P(0,0)),C=this.pointCoordinate(new r.P(this.width,0)),j=this.pointCoordinate(new r.P(this.width,this.height)),J=this.pointCoordinate(new r.P(0,this.height)),ie=Math.floor(Math.min(O.x,C.x,j.x,J.x)),ce=Math.floor(Math.max(O.x,C.x,j.x,J.x)),Se=1;for(let Me=ie-Se;Me<=ce+Se;Me++)Me!==0&&S.push(new r.b4(Me,o))}return S}coveringTiles(o){var S,O;let C=this.coveringZoomLevel(o);const j=C;if(o.minzoom!==void 0&&C<o.minzoom)return[];o.maxzoom!==void 0&&C>o.maxzoom&&(C=o.maxzoom);const J=this.pointCoordinate(this.getCameraPoint()),ie=r.Z.fromLngLat(this.center),ce=Math.pow(2,C),Se=[ce*J.x,ce*J.y,0],Me=[ce*ie.x,ce*ie.y,0],Ce=zs.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,C);let He=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(He=C);const Ye=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,tt=lt=>({aabb:new Oc([lt*ce,0,0],[(lt+1)*ce,ce,0]),zoom:0,x:0,y:0,wrap:lt,fullyVisible:!1}),ht=[],yt=[],vt=C,kt=o.reparseOverscaled?j:C;if(this._renderWorldCopies)for(let lt=1;lt<=3;lt++)ht.push(tt(-lt)),ht.push(tt(lt));for(ht.push(tt(0));ht.length>0;){const lt=ht.pop(),Rt=lt.x,Nt=lt.y;let zt=lt.fullyVisible;if(!zt){const En=lt.aabb.intersects(Ce);if(En===0)continue;zt=En===2}const sn=o.terrain?Se:Me,gn=lt.aabb.distanceX(sn),Cn=lt.aabb.distanceY(sn),Fn=Math.max(Math.abs(gn),Math.abs(Cn));if(lt.zoom===vt||Fn>Ye+(1<<vt-lt.zoom)-2&&lt.zoom>=He){const En=vt-lt.zoom,Sn=Se[0]-.5-(Rt<<En),Jn=Se[1]-.5-(Nt<<En);yt.push({tileID:new r.S(lt.zoom===vt?kt:lt.zoom,lt.wrap,lt.zoom,Rt,Nt),distanceSq:M([Me[0]-.5-Rt,Me[1]-.5-Nt]),tileDistanceToCamera:Math.sqrt(Sn*Sn+Jn*Jn)})}else for(let En=0;En<4;En++){const Sn=(Rt<<1)+En%2,Jn=(Nt<<1)+(En>>1),Nr=lt.zoom+1;let An=lt.aabb.quadrant(En);if(o.terrain){const Nn=new r.S(Nr,lt.wrap,Nr,Sn,Jn),Rr=o.terrain.getMinMaxElevation(Nn),Ni=(S=Rr.minElevation)!==null&&S!==void 0?S:this.elevation,Gr=(O=Rr.maxElevation)!==null&&O!==void 0?O:this.elevation;An=new Oc([An.min[0],An.min[1],Ni],[An.max[0],An.max[1],Gr])}ht.push({aabb:An,zoom:Nr,x:Sn,y:Jn,wrap:lt.wrap,fullyVisible:zt})}}return yt.sort((lt,Rt)=>lt.distanceSq-Rt.distanceSq).map(lt=>lt.tileID)}resize(o,S){this.width=o,this.height=S,this.pixelsToGLUnits=[2/o,-2/S],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const S=r.ac(o.lat,-85.051129,vu);return new r.P(r.O(o.lng)*this.worldSize,r.Q(S)*this.worldSize)}unproject(o){return new r.Z(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const S=this.elevation,O=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,C=this.pointLocation(this.centerPoint,o),j=o.getElevationForLngLatZoom(C,this.tileZoom);if(!(this.elevation-j))return;const J=O+S-j,ie=Math.cos(this._pitch)*this.cameraToCenterDistance/J/r.b5(1,C.lat),ce=this.scaleZoom(ie/this.tileSize);this._elevation=j,this._center=C,this.zoom=ce}setLocationAtPoint(o,S){const O=this.pointCoordinate(S),C=this.pointCoordinate(this.centerPoint),j=this.locationCoordinate(o),J=new r.Z(j.x-(O.x-C.x),j.y-(O.y-C.y));this.center=this.coordinateLocation(J),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,S){return S?this.coordinatePoint(this.locationCoordinate(o),S.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,S){return this.coordinateLocation(this.pointCoordinate(o,S))}locationCoordinate(o){return r.Z.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,S){if(S){const He=S.pointCoordinate(o);if(He!=null)return He}const O=[o.x,o.y,0,1],C=[o.x,o.y,1,1];r.af(O,O,this.pixelMatrixInverse),r.af(C,C,this.pixelMatrixInverse);const j=O[3],J=C[3],ie=O[1]/j,ce=C[1]/J,Se=O[2]/j,Me=C[2]/J,Ce=Se===Me?0:(0-Se)/(Me-Se);return new r.Z(r.y.number(O[0]/j,C[0]/J,Ce)/this.worldSize,r.y.number(ie,ce,Ce)/this.worldSize)}coordinatePoint(o,S=0,O=this.pixelMatrix){const C=[o.x*this.worldSize,o.y*this.worldSize,S,1];return r.af(C,C,O),new r.P(C[0]/C[3],C[1]/C[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new te().extend(this.pointLocation(new r.P(0,o))).extend(this.pointLocation(new r.P(this.width,o))).extend(this.pointLocation(new r.P(this.width,this.height))).extend(this.pointLocation(new r.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new te([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,vu])}calculateTileMatrix(o){const S=o.canonical,O=this.worldSize/this.zoomScale(S.z),C=S.x+Math.pow(2,S.z)*o.wrap,j=r.an(new Float64Array(16));return r.J(j,j,[C*O,S.y*O,0]),r.K(j,j,[O/r.X,O/r.X,1]),j}calculatePosMatrix(o,S=!1){const O=o.key,C=S?this._alignedPosMatrixCache:this._posMatrixCache;if(C[O])return C[O];const j=this.calculateTileMatrix(o);return r.L(j,S?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,j),C[O]=new Float32Array(j),C[O]}calculateFogMatrix(o){const S=o.key,O=this._fogMatrixCache;if(O[S])return O[S];const C=this.calculateTileMatrix(o);return r.L(C,this.fogMatrix,C),O[S]=new Float32Array(C),O[S]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(o,S){S=r.ac(+S,this.minZoom,this.maxZoom);const O={center:new r.N(o.lng,o.lat),zoom:S};let C=this.lngRange;if(!this._renderWorldCopies&&C===null){const lt=179.9999999999;C=[-lt,lt]}const j=this.tileSize*this.zoomScale(O.zoom);let J=0,ie=j,ce=0,Se=j,Me=0,Ce=0;const{x:He,y:Ye}=this.size;if(this.latRange){const lt=this.latRange;J=r.Q(lt[1])*j,ie=r.Q(lt[0])*j,ie-J<Ye&&(Me=Ye/(ie-J))}C&&(ce=r.b3(r.O(C[0])*j,0,j),Se=r.b3(r.O(C[1])*j,0,j),Se<ce&&(Se+=j),Se-ce<He&&(Ce=He/(Se-ce)));const{x:tt,y:ht}=this.project.call({worldSize:j},o);let yt,vt;const kt=Math.max(Ce||0,Me||0);if(kt){const lt=new r.P(Ce?(Se+ce)/2:tt,Me?(ie+J)/2:ht);return O.center=this.unproject.call({worldSize:j},lt).wrap(),O.zoom+=this.scaleZoom(kt),O}if(this.latRange){const lt=Ye/2;ht-lt<J&&(vt=J+lt),ht+lt>ie&&(vt=ie-lt)}if(C){const lt=(ce+Se)/2;let Rt=tt;this._renderWorldCopies&&(Rt=r.b3(tt,lt-j/2,lt+j/2));const Nt=He/2;Rt-Nt<ce&&(yt=ce+Nt),Rt+Nt>Se&&(yt=Se-Nt)}if(yt!==void 0||vt!==void 0){const lt=new r.P(yt??tt,vt??ht);O.center=this.unproject.call({worldSize:j},lt).wrap()}return O}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:S,zoom:O}=this.getConstrained(this.center,this.zoom);this.center=S,this.zoom=O,this._unmodified=o,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,S=this.point.x,O=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=r.b5(1,this.center.lat)*this.worldSize;let C=r.an(new Float64Array(16));r.K(C,C,[this.width/2,-this.height/2,1]),r.J(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=r.an(new Float64Array(16)),r.K(C,C,[1,-1,1]),r.J(C,C,[-1,-1,0]),r.K(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C;const j=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),J=Math.min(this.elevation,this.minElevationForCurrentTile),ie=j-J*this._pixelPerMeter/Math.cos(this._pitch),ce=J<0?ie:j,Se=Math.PI/2+this._pitch,Me=this._fov*(.5+o.y/this.height),Ce=Math.sin(Me)*ce/Math.sin(r.ac(Math.PI-Se-Me,.01,Math.PI-.01)),He=this.getHorizon(),Ye=2*Math.atan(He/this.cameraToCenterDistance)*(.5+o.y/(2*He)),tt=Math.sin(Ye)*ce/Math.sin(r.ac(Math.PI-Se-Ye,.01,Math.PI-.01)),ht=Math.min(Ce,tt);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ht+ce),this.nearZ=this.height/50,C=new Float64Array(16),r.b6(C,this._fov,this.width/this.height,this.nearZ,this.farZ),C[8]=2*-o.x/this.width,C[9]=2*o.y/this.height,this.projectionMatrix=r.ae(C),r.K(C,C,[1,-1,1]),r.J(C,C,[0,0,-this.cameraToCenterDistance]),r.b7(C,C,this._pitch),r.ad(C,C,this.angle),r.J(C,C,[-S,-O,0]),this.mercatorMatrix=r.K([],C,[this.worldSize,this.worldSize,this.worldSize]),r.K(C,C,[1,1,this._pixelPerMeter]),this.pixelMatrix=r.L(new Float64Array(16),this.labelPlaneMatrix,C),r.J(C,C,[0,0,-this.elevation]),this.modelViewProjectionMatrix=C,this.invModelViewProjectionMatrix=r.as([],C),this.fogMatrix=new Float64Array(16),r.b6(this.fogMatrix,this._fov,this.width/this.height,j,this.farZ),this.fogMatrix[8]=2*-o.x/this.width,this.fogMatrix[9]=2*o.y/this.height,r.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),r.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),r.b7(this.fogMatrix,this.fogMatrix,this._pitch),r.ad(this.fogMatrix,this.fogMatrix,this.angle),r.J(this.fogMatrix,this.fogMatrix,[-S,-O,0]),r.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),r.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=r.L(new Float64Array(16),this.labelPlaneMatrix,C);const yt=this.width%2/2,vt=this.height%2/2,kt=Math.cos(this.angle),lt=Math.sin(this.angle),Rt=S-Math.round(S)+kt*yt+lt*vt,Nt=O-Math.round(O)+kt*vt+lt*yt,zt=new Float64Array(C);if(r.J(zt,zt,[Rt>.5?Rt-1:Rt,Nt>.5?Nt-1:Nt,0]),this.alignedModelViewProjectionMatrix=zt,C=r.as(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");this.pixelMatrixInverse=C,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new r.P(0,0)),S=[o.x*this.worldSize,o.y*this.worldSize,0,1];return r.af(S,S,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,o))}getCameraQueryGeometry(o){const S=this.getCameraPoint();if(o.length===1)return[o[0],S];{let O=S.x,C=S.y,j=S.x,J=S.y;for(const ie of o)O=Math.min(O,ie.x),C=Math.min(C,ie.y),j=Math.max(j,ie.x),J=Math.max(J,ie.y);return[new r.P(O,C),new r.P(j,C),new r.P(j,J),new r.P(O,J),new r.P(O,C)]}}lngLatToCameraDepth(o,S){const O=this.locationCoordinate(o),C=[O.x*this.worldSize,O.y*this.worldSize,S,1];return r.af(C,C,this.modelViewProjectionMatrix),C[2]/C[3]}}function Yl($,o){let S,O=!1,C=null,j=null;const J=()=>{C=null,O&&($.apply(j,S),C=setTimeout(J,o),O=!1)};return(...ie)=>(O=!0,j=this,S=ie,C||J(),C)}class _u{constructor(o){this._getCurrentHash=()=>{const S=window.location.hash.replace("#","");if(this._hashName){let O;return S.split("&").map(C=>C.split("=")).forEach(C=>{C[0]===this._hashName&&(O=C)}),(O&&O[1]||"").split("/")}return S.split("/")},this._onHashChange=()=>{const S=this._getCurrentHash();if(S.length>=3&&!S.some(O=>isNaN(O))){const O=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(S[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+S[2],+S[1]],zoom:+S[0],bearing:O,pitch:+(S[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const S=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,S)},this._removeHash=()=>{const S=this._getCurrentHash();if(S.length===0)return;const O=S.join("/");let C=O;C.split("&").length>0&&(C=C.split("&")[0]),this._hashName&&(C=`${this._hashName}=${O}`);let j=window.location.hash.replace(C,"");j.startsWith("#&")?j=j.slice(0,1)+j.slice(2):j==="#"&&(j="");let J=window.location.href.replace(/(#.+)?$/,j);J=J.replace("&&","&"),window.history.replaceState(window.history.state,null,J)},this._updateHash=Yl(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const S=this._map.getCenter(),O=Math.round(100*this._map.getZoom())/100,C=Math.ceil((O*Math.LN2+Math.log(512/360/.5))/Math.LN10),j=Math.pow(10,C),J=Math.round(S.lng*j)/j,ie=Math.round(S.lat*j)/j,ce=this._map.getBearing(),Se=this._map.getPitch();let Me="";if(Me+=o?`/${J}/${ie}/${O}`:`${O}/${ie}/${J}`,(ce||Se)&&(Me+="/"+Math.round(10*ce)/10),Se&&(Me+=`/${Math.round(Se)}`),this._hashName){const Ce=this._hashName;let He=!1;const Ye=window.location.hash.slice(1).split("&").map(tt=>{const ht=tt.split("=")[0];return ht===Ce?(He=!0,`${ht}=${Me}`):tt}).filter(tt=>tt);return He||Ye.push(`${Ce}=${Me}`),`#${Ye.join("&")}`}return`#${Me}`}}const Ih={linearity:.3,easing:r.b8(0,0,.3,1)},wu=r.e({deceleration:2500,maxSpeed:1400},Ih),I0=r.e({deceleration:20,maxSpeed:1400},Ih),Mm=r.e({deceleration:1e3,maxSpeed:360},Ih),xu=r.e({deceleration:1e3,maxSpeed:90},Ih);class hn{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:g.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,S=g.now();for(;o.length>0&&S-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const S={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:j}of this._inertiaBuffer)S.zoom+=j.zoomDelta||0,S.bearing+=j.bearingDelta||0,S.pitch+=j.pitchDelta||0,j.panDelta&&S.pan._add(j.panDelta),j.around&&(S.around=j.around),j.pinchAround&&(S.pinchAround=j.pinchAround);const O=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(S.pan.mag()){const j=Vr(S.pan.mag(),O,r.e({},wu,o||{}));C.offset=S.pan.mult(j.amount/S.pan.mag()),C.center=this._map.transform.center,Tr(C,j)}if(S.zoom){const j=Vr(S.zoom,O,I0);C.zoom=this._map.transform.zoom+j.amount,Tr(C,j)}if(S.bearing){const j=Vr(S.bearing,O,Mm);C.bearing=this._map.transform.bearing+r.ac(j.amount,-179,179),Tr(C,j)}if(S.pitch){const j=Vr(S.pitch,O,xu);C.pitch=this._map.transform.pitch+j.amount,Tr(C,j)}if(C.zoom||C.bearing){const j=S.pinchAround===void 0?S.around:S.pinchAround;C.around=j?this._map.unproject(j):this._map.getCenter()}return this.clear(),r.e(C,{noMoveStart:!0})}}function Tr($,o){(!$.duration||$.duration<o.duration)&&($.duration=o.duration,$.easing=o.easing)}function Vr($,o,S){const{maxSpeed:O,linearity:C,deceleration:j}=S,J=r.ac($*C/(o/1e3),-O,O),ie=Math.abs(J)/(j*C);return{easing:S.easing,duration:1e3*ie,amount:J*(ie/2)}}class $r extends r.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,S,O,C={}){const j=_.mousePos(S.getCanvas(),O),J=S.unproject(j);super(o,r.e({point:j,lngLat:J,originalEvent:O},C)),this._defaultPrevented=!1,this.target=S}}class Qr extends r.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,S,O){const C=o==="touchend"?O.changedTouches:O.touches,j=_.touchPos(S.getCanvasContainer(),C),J=j.map(ce=>S.unproject(ce)),ie=j.reduce((ce,Se,Me,Ce)=>ce.add(Se.div(Ce.length)),new r.P(0,0));super(o,{points:j,point:ie,lngLats:J,lngLat:S.unproject(ie),originalEvent:O}),this._defaultPrevented=!1}}class Zr extends r.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,S,O){super(o,{originalEvent:O}),this._defaultPrevented=!1}}class Ki{constructor(o,S){this._map=o,this._clickTolerance=S.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Zr(o.type,this._map,o))}mousedown(o,S){return this._mousedownPos=S,this._firePreventable(new $r(o.type,this._map,o))}mouseup(o){this._map.fire(new $r(o.type,this._map,o))}click(o,S){this._mousedownPos&&this._mousedownPos.dist(S)>=this._clickTolerance||this._map.fire(new $r(o.type,this._map,o))}dblclick(o){return this._firePreventable(new $r(o.type,this._map,o))}mouseover(o){this._map.fire(new $r(o.type,this._map,o))}mouseout(o){this._map.fire(new $r(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Qr(o.type,this._map,o))}touchmove(o){this._map.fire(new Qr(o.type,this._map,o))}touchend(o){this._map.fire(new Qr(o.type,this._map,o))}touchcancel(o){this._map.fire(new Qr(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Si{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new $r(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new $r(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class As{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(r.P.convert(o),this._map.terrain)}}class Do{constructor(o,S){this._map=o,this._tr=new As(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=S.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,S){this.isEnabled()&&o.shiftKey&&o.button===0&&(_.disableDrag(),this._startPos=this._lastPos=S,this._active=!0)}mousemoveWindow(o,S){if(!this._active)return;const O=S;if(this._lastPos.equals(O)||!this._box&&O.dist(this._startPos)<this._clickTolerance)return;const C=this._startPos;this._lastPos=O,this._box||(this._box=_.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const j=Math.min(C.x,O.x),J=Math.max(C.x,O.x),ie=Math.min(C.y,O.y),ce=Math.max(C.y,O.y);_.setTransform(this._box,`translate(${j}px,${ie}px)`),this._box.style.width=J-j+"px",this._box.style.height=ce-ie+"px"}mouseupWindow(o,S){if(!this._active||o.button!==0)return;const O=this._startPos,C=S;if(this.reset(),_.suppressClick(),O.x!==C.x||O.y!==C.y)return this._map.fire(new r.k("boxzoomend",{originalEvent:o})),{cameraAnimation:j=>j.fitScreenCoordinates(O,C,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(_.remove(this._box),this._box=null),_.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,S){return this._map.fire(new r.k(o,{originalEvent:S}))}}function Us($,o){if($.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${$.length}, points ${o.length}`);const S={};for(let O=0;O<$.length;O++)S[$[O].identifier]=o[O];return S}class Cc{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,S,O){(this.centroid||O.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),O.length===this.numTouches&&(this.centroid=function(C){const j=new r.P(0,0);for(const J of C)j._add(J);return j.div(C.length)}(S),this.touches=Us(O,S)))}touchmove(o,S,O){if(this.aborted||!this.centroid)return;const C=Us(O,S);for(const j in this.touches){const J=C[j];(!J||J.dist(this.touches[j])>30)&&(this.aborted=!0)}}touchend(o,S,O){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),O.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class Su{constructor(o){this.singleTap=new Cc(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,S,O){this.singleTap.touchstart(o,S,O)}touchmove(o,S,O){this.singleTap.touchmove(o,S,O)}touchend(o,S,O){const C=this.singleTap.touchend(o,S,O);if(C){const j=o.timeStamp-this.lastTime<500,J=!this.lastTap||this.lastTap.dist(C)<30;if(j&&J||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Ha{constructor(o){this._tr=new As(o),this._zoomIn=new Su({numTouches:1,numTaps:2}),this._zoomOut=new Su({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,S,O){this._zoomIn.touchstart(o,S,O),this._zoomOut.touchstart(o,S,O)}touchmove(o,S,O){this._zoomIn.touchmove(o,S,O),this._zoomOut.touchmove(o,S,O)}touchend(o,S,O){const C=this._zoomIn.touchend(o,S,O),j=this._zoomOut.touchend(o,S,O),J=this._tr;return C?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:ie=>ie.easeTo({duration:300,zoom:J.zoom+1,around:J.unproject(C)},{originalEvent:o})}):j?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:ie=>ie.easeTo({duration:300,zoom:J.zoom-1,around:J.unproject(j)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class os{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const S=this._moveFunction(...o);if(S.bearingDelta||S.pitchDelta||S.around||S.panDelta)return this._active=!0,S}dragStart(o,S){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=S.length?S[0]:S,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,S){if(!this.isEnabled())return;const O=this._lastPoint;if(!O)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const C=S.length?S[0]:S;return!this._moved&&C.dist(O)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=C,this._move(O,C))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&_.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const R0={0:1,2:2};class Cm{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const S=_.mouseButton(o);this._eventButton=S}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(S,O){const C=R0[O];return S.buttons===void 0||(S.buttons&C)!==C}(o,this._eventButton)}isValidEndEvent(o){return _.mouseButton(o)===this._eventButton}}class D0{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const Im=$=>{$.mousedown=$.dragStart,$.mousemoveWindow=$.dragMove,$.mouseup=$.dragEnd,$.contextmenu=o=>{o.preventDefault()}},L0=({enable:$,clickTolerance:o,bearingDegreesPerPixelMoved:S=.8})=>{const O=new Cm({checkCorrectEvent:C=>_.mouseButton(C)===0&&C.ctrlKey||_.mouseButton(C)===2});return new os({clickTolerance:o,move:(C,j)=>({bearingDelta:(j.x-C.x)*S}),moveStateManager:O,enable:$,assignEvents:Im})},j0=({enable:$,clickTolerance:o,pitchDegreesPerPixelMoved:S=-.5})=>{const O=new Cm({checkCorrectEvent:C=>_.mouseButton(C)===0&&C.ctrlKey||_.mouseButton(C)===2});return new os({clickTolerance:o,move:(C,j)=>({pitchDelta:(j.y-C.y)*S}),moveStateManager:O,enable:$,assignEvents:Im})};class Eu{constructor(o,S){this._clickTolerance=o.clickTolerance||1,this._map=S,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,S,O){return this._calculateTransform(o,S,O)}touchmove(o,S,O){if(this._active){if(!this._shouldBePrevented(O.length))return o.preventDefault(),this._calculateTransform(o,S,O);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,S,O){this._calculateTransform(o,S,O),this._active&&this._shouldBePrevented(O.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,S,O){O.length>0&&(this._active=!0);const C=Us(O,S),j=new r.P(0,0),J=new r.P(0,0);let ie=0;for(const Se in C){const Me=C[Se],Ce=this._touches[Se];Ce&&(j._add(Me),J._add(Me.sub(Ce)),ie++,C[Se]=Me)}if(this._touches=C,this._shouldBePrevented(ie)||!J.mag())return;const ce=J.div(ie);return this._sum._add(ce),this._sum.mag()<this._clickTolerance?void 0:{around:j.div(ie),panDelta:ce}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rm{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,S,O){this._firstTwoTouches||O.length<2||(this._firstTwoTouches=[O[0].identifier,O[1].identifier],this._start([S[0],S[1]]))}touchmove(o,S,O){if(!this._firstTwoTouches)return;o.preventDefault();const[C,j]=this._firstTwoTouches,J=wd(O,S,C),ie=wd(O,S,j);if(!J||!ie)return;const ce=this._aroundCenter?null:J.add(ie).div(2);return this._move([J,ie],ce,o)}touchend(o,S,O){if(!this._firstTwoTouches)return;const[C,j]=this._firstTwoTouches,J=wd(O,S,C),ie=wd(O,S,j);J&&ie||(this._active&&_.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function wd($,o,S){for(let O=0;O<$.length;O++)if($[O].identifier===S)return o[O]}function N0($,o){return Math.log($/o)/Math.LN2}class $0 extends Rm{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,S){const O=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(N0(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:N0(this._distance,O),pinchAround:S}}}function B0($,o){return 180*$.angleWith(o)/Math.PI}class F0 extends Rm{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,S,O){const C=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:B0(this._vector,C),pinchAround:S}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const S=25/(Math.PI*this._minDiameter)*360,O=B0(o,this._startVector);return Math.abs(O)<S}}function Dm($){return Math.abs($.y)>Math.abs($.x)}class Rh extends Rm{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,S,O){super.touchstart(o,S,O),this._currentTouchCount=O.length}_start(o){this._lastPoints=o,Dm(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,S,O){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const C=o[0].sub(this._lastPoints[0]),j=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,j,O.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(C.y+j.y)/2*-.5}):void 0}gestureBeginsVertically(o,S,O){if(this._valid!==void 0)return this._valid;const C=o.mag()>=2,j=S.mag()>=2;if(!C&&!j)return;if(!C||!j)return this._firstMove===void 0&&(this._firstMove=O),O-this._firstMove<100&&void 0;const J=o.y>0==S.y>0;return Dm(o)&&Dm(S)&&J}}const ow={panStep:100,bearingStep:15,pitchStep:10};class Ea{constructor(o){this._tr=new As(o);const S=ow;this._panStep=S.panStep,this._bearingStep=S.bearingStep,this._pitchStep=S.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let S=0,O=0,C=0,j=0,J=0;switch(o.keyCode){case 61:case 107:case 171:case 187:S=1;break;case 189:case 109:case 173:S=-1;break;case 37:o.shiftKey?O=-1:(o.preventDefault(),j=-1);break;case 39:o.shiftKey?O=1:(o.preventDefault(),j=1);break;case 38:o.shiftKey?C=1:(o.preventDefault(),J=-1);break;case 40:o.shiftKey?C=-1:(o.preventDefault(),J=1);break;default:return}return this._rotationDisabled&&(O=0,C=0),{cameraAnimation:ie=>{const ce=this._tr;ie.easeTo({duration:300,easeId:"keyboardHandler",easing:Al,zoom:S?Math.round(ce.zoom)+S*(o.shiftKey?2:1):ce.zoom,bearing:ce.bearing+O*this._bearingStep,pitch:ce.pitch+C*this._pitchStep,offset:[-j*this._panStep,-J*this._panStep],center:ce.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Al($){return $*(2-$)}const z0=4.000244140625;class Wa{constructor(o,S){this._onTimeout=O=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(O)},this._map=o,this._tr=new As(o),this._triggerRenderFrame=S,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let S=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const O=g.now(),C=O-(this._lastWheelEventTime||0);this._lastWheelEventTime=O,S!==0&&S%z0==0?this._type="wheel":S!==0&&Math.abs(S)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=S,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(C*S)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,S+=this._lastValue)),o.shiftKey&&S&&(S/=4),this._type&&(this._lastWheelEvent=o,this._delta-=S,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const S=_.mousePos(this._map.getCanvas(),o),O=this._tr;this._around=S.y>O.transform.height/2-O.transform.getHorizon()?r.N.convert(this._aroundCenter?O.center:O.unproject(S)):r.N.convert(O.center),this._aroundPoint=O.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(this._delta!==0){const ce=this._type==="wheel"&&Math.abs(this._delta)>z0?this._wheelZoomRate:this._defaultZoomRate;let Se=2/(1+Math.exp(-Math.abs(this._delta*ce)));this._delta<0&&Se!==0&&(Se=1/Se);const Me=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(Me*Se))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const S=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,O=this._startZoom,C=this._easing;let j,J=!1;const ie=g.now()-this._lastWheelEventTime;if(this._type==="wheel"&&O&&C&&ie){const ce=Math.min(ie/200,1),Se=C(ce);j=r.y.number(O,S,Se),ce<1?this._frameId||(this._frameId=!0):J=!0}else j=S,J=!0;return this._active=!0,J&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!J,zoomDelta:j-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let S=r.b9;if(this._prevEase){const O=this._prevEase,C=(g.now()-O.start)/O.duration,j=O.easing(C+.01)-O.easing(C),J=.27/Math.sqrt(j*j+1e-4)*.01,ie=Math.sqrt(.0729-J*J);S=r.b8(J,ie,.25,1)}return this._prevEase={start:g.now(),duration:o,easing:S},S}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Au{constructor(o,S){this._clickZoom=o,this._tapZoom=S}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class u3{constructor(o){this._tr=new As(o),this.reset()}reset(){this._active=!1}dblclick(o,S){return o.preventDefault(),{cameraAnimation:O=>{O.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(S)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class h3{constructor(){this._tap=new Su({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,S,O){if(!this._swipePoint)if(this._tapTime){const C=S[0],j=o.timeStamp-this._tapTime<500,J=this._tapPoint.dist(C)<30;j&&J?O.length>0&&(this._swipePoint=C,this._swipeTouch=O[0].identifier):this.reset()}else this._tap.touchstart(o,S,O)}touchmove(o,S,O){if(this._tapTime){if(this._swipePoint){if(O[0].identifier!==this._swipeTouch)return;const C=S[0],j=C.y-this._swipePoint.y;return this._swipePoint=C,o.preventDefault(),this._active=!0,{zoomDelta:j/128}}}else this._tap.touchmove(o,S,O)}touchend(o,S,O){if(this._tapTime)this._swipePoint&&O.length===0&&this.reset();else{const C=this._tap.touchend(o,S,O);C&&(this._tapTime=o.timeStamp,this._tapPoint=C)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sw{constructor(o,S,O){this._el=o,this._mousePan=S,this._touchPan=O}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class aw{constructor(o,S,O){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=S,this._mousePitch=O}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class U0{constructor(o,S,O,C){this._el=o,this._touchZoom=S,this._touchRotate=O,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Dh{constructor(o,S){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=o,this._options=S,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=_.create("div","maplibregl-cooperative-gesture-screen",o);let S=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(S=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const O=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),C=document.createElement("div");C.className="maplibregl-desktop-message",C.textContent=S,this._container.appendChild(C);const j=document.createElement("div");j.className="maplibregl-mobile-message",j.textContent=O,this._container.appendChild(j),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(_.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,S){this._enabled&&(this._map.fire(new r.k("cooperativegestureprevented",{gestureType:o,originalEvent:S})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Aa=$=>$.zoom||$.drag||$.pitch||$.rotate;class Vn extends r.k{}function Lm($){return $.panDelta&&$.panDelta.mag()||$.zoomDelta||$.bearingDelta||$.pitchDelta}class V0{constructor(o,S){this.handleWindowEvent=C=>{this.handleEvent(C,`${C.type}Window`)},this.handleEvent=(C,j)=>{if(C.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const J=C.type==="renderFrame"?void 0:C,ie={needsRenderFrame:!1},ce={},Se={},Me=C.touches,Ce=Me?this._getMapTouches(Me):void 0,He=Ce?_.touchPos(this._map.getCanvas(),Ce):_.mousePos(this._map.getCanvas(),C);for(const{handlerName:ht,handler:yt,allowed:vt}of this._handlers){if(!yt.isEnabled())continue;let kt;this._blockedByActive(Se,vt,ht)?yt.reset():yt[j||C.type]&&(kt=yt[j||C.type](C,He,Ce),this.mergeHandlerResult(ie,ce,kt,ht,J),kt&&kt.needsRenderFrame&&this._triggerRenderFrame()),(kt||yt.isActive())&&(Se[ht]=yt)}const Ye={};for(const ht in this._previousActiveHandlers)Se[ht]||(Ye[ht]=J);this._previousActiveHandlers=Se,(Object.keys(Ye).length||Lm(ie))&&(this._changes.push([ie,ce,Ye]),this._triggerRenderFrame()),(Object.keys(Se).length||Lm(ie))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:tt}=ie;tt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],tt(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new hn(o),this._bearingSnap=S.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(S);const O=this._el;this._listeners=[[O,"touchstart",{passive:!0}],[O,"touchmove",{passive:!1}],[O,"touchend",void 0],[O,"touchcancel",void 0],[O,"mousedown",void 0],[O,"mousemove",void 0],[O,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[O,"mouseover",void 0],[O,"mouseout",void 0],[O,"dblclick",void 0],[O,"click",void 0],[O,"keydown",{capture:!1}],[O,"keyup",void 0],[O,"wheel",{passive:!1}],[O,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,j,J]of this._listeners)_.addEventListener(C,j,C===document?this.handleWindowEvent:this.handleEvent,J)}destroy(){for(const[o,S,O]of this._listeners)_.removeEventListener(o,S,o===document?this.handleWindowEvent:this.handleEvent,O)}_addDefaultHandlers(o){const S=this._map,O=S.getCanvasContainer();this._add("mapEvent",new Ki(S,o));const C=S.boxZoom=new Do(S,o);this._add("boxZoom",C),o.interactive&&o.boxZoom&&C.enable();const j=S.cooperativeGestures=new Dh(S,o.cooperativeGestures);this._add("cooperativeGestures",j),o.cooperativeGestures&&j.enable();const J=new Ha(S),ie=new u3(S);S.doubleClickZoom=new Au(ie,J),this._add("tapZoom",J),this._add("clickZoom",ie),o.interactive&&o.doubleClickZoom&&S.doubleClickZoom.enable();const ce=new h3;this._add("tapDragZoom",ce);const Se=S.touchPitch=new Rh(S);this._add("touchPitch",Se),o.interactive&&o.touchPitch&&S.touchPitch.enable(o.touchPitch);const Me=L0(o),Ce=j0(o);S.dragRotate=new aw(o,Me,Ce),this._add("mouseRotate",Me,["mousePitch"]),this._add("mousePitch",Ce,["mouseRotate"]),o.interactive&&o.dragRotate&&S.dragRotate.enable();const He=(({enable:kt,clickTolerance:lt})=>{const Rt=new Cm({checkCorrectEvent:Nt=>_.mouseButton(Nt)===0&&!Nt.ctrlKey});return new os({clickTolerance:lt,move:(Nt,zt)=>({around:zt,panDelta:zt.sub(Nt)}),activateOnStart:!0,moveStateManager:Rt,enable:kt,assignEvents:Im})})(o),Ye=new Eu(o,S);S.dragPan=new sw(O,He,Ye),this._add("mousePan",He),this._add("touchPan",Ye,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&S.dragPan.enable(o.dragPan);const tt=new F0,ht=new $0;S.touchZoomRotate=new U0(O,ht,tt,ce),this._add("touchRotate",tt,["touchPan","touchZoom"]),this._add("touchZoom",ht,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&S.touchZoomRotate.enable(o.touchZoomRotate);const yt=S.scrollZoom=new Wa(S,()=>this._triggerRenderFrame());this._add("scrollZoom",yt,["mousePan"]),o.interactive&&o.scrollZoom&&S.scrollZoom.enable(o.scrollZoom);const vt=S.keyboard=new Ea(S);this._add("keyboard",vt),o.interactive&&o.keyboard&&S.keyboard.enable(),this._add("blockableMapEvent",new Si(S))}_add(o,S,O){this._handlers.push({handlerName:o,handler:S,allowed:O}),this._handlersById[o]=S}stop(o){if(!this._updatingCamera){for(const{handler:S}of this._handlers)S.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Aa(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,S,O){for(const C in o)if(C!==O&&(!S||S.indexOf(C)<0))return!0;return!1}_getMapTouches(o){const S=[];for(const O of o)this._el.contains(O.target)&&S.push(O);return S}mergeHandlerResult(o,S,O,C,j){if(!O)return;r.e(o,O);const J={handlerName:C,originalEvent:O.originalEvent||j};O.zoomDelta!==void 0&&(S.zoom=J),O.panDelta!==void 0&&(S.drag=J),O.pitchDelta!==void 0&&(S.pitch=J),O.bearingDelta!==void 0&&(S.rotate=J)}_applyChanges(){const o={},S={},O={};for(const[C,j,J]of this._changes)C.panDelta&&(o.panDelta=(o.panDelta||new r.P(0,0))._add(C.panDelta)),C.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+C.pitchDelta),C.around!==void 0&&(o.around=C.around),C.pinchAround!==void 0&&(o.pinchAround=C.pinchAround),C.noInertia&&(o.noInertia=C.noInertia),r.e(S,j),r.e(O,J);this._updateMapTransform(o,S,O),this._changes=[]}_updateMapTransform(o,S,O){const C=this._map,j=C._getTransformForUpdate(),J=C.terrain;if(!(Lm(o)||J&&this._terrainMovement))return this._fireEvents(S,O,!0);let{panDelta:ie,zoomDelta:ce,bearingDelta:Se,pitchDelta:Me,around:Ce,pinchAround:He}=o;He!==void 0&&(Ce=He),C._stop(!0),Ce=Ce||C.transform.centerPoint;const Ye=j.pointLocation(ie?Ce.sub(ie):Ce);Se&&(j.bearing+=Se),Me&&(j.pitch+=Me),ce&&(j.zoom+=ce),J?this._terrainMovement||!S.drag&&!S.zoom?S.drag&&this._terrainMovement?j.center=j.pointLocation(j.centerPoint.sub(ie)):j.setLocationAtPoint(Ye,Ce):(this._terrainMovement=!0,this._map._elevationFreeze=!0,j.setLocationAtPoint(Ye,Ce)):j.setLocationAtPoint(Ye,Ce),C._applyUpdatedTransform(j),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(S,O,!0)}_fireEvents(o,S,O){const C=Aa(this._eventsInProgress),j=Aa(o),J={};for(const Ce in o){const{originalEvent:He}=o[Ce];this._eventsInProgress[Ce]||(J[`${Ce}start`]=He),this._eventsInProgress[Ce]=o[Ce]}!C&&j&&this._fireEvent("movestart",j.originalEvent);for(const Ce in J)this._fireEvent(Ce,J[Ce]);j&&this._fireEvent("move",j.originalEvent);for(const Ce in o){const{originalEvent:He}=o[Ce];this._fireEvent(Ce,He)}const ie={};let ce;for(const Ce in this._eventsInProgress){const{handlerName:He,originalEvent:Ye}=this._eventsInProgress[Ce];this._handlersById[He].isActive()||(delete this._eventsInProgress[Ce],ce=S[He]||Ye,ie[`${Ce}end`]=ce)}for(const Ce in ie)this._fireEvent(Ce,ie[Ce]);const Se=Aa(this._eventsInProgress),Me=(C||j)&&!Se;if(Me&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Ce=this._map._getTransformForUpdate();Ce.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(Ce)}if(O&&Me){this._updatingCamera=!0;const Ce=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),He=Ye=>Ye!==0&&-this._bearingSnap<Ye&&Ye<this._bearingSnap;!Ce||!Ce.essential&&g.prefersReducedMotion?(this._map.fire(new r.k("moveend",{originalEvent:ce})),He(this._map.getBearing())&&this._map.resetNorth()):(He(Ce.bearing||this._map.getBearing())&&(Ce.bearing=0),Ce.freezeElevation=!0,this._map.easeTo(Ce,{originalEvent:ce})),this._updatingCamera=!1}}_fireEvent(o,S){this._map.fire(new r.k(o,S?{originalEvent:S}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Vn("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class lw extends r.E{constructor(o,S){super(),this._renderFrameCallback=()=>{const O=Math.min((g.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(O)),O<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=S.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new r.N(this.transform.center.lng,this.transform.center.lat)}setCenter(o,S){return this.jumpTo({center:o},S)}panBy(o,S,O){return o=r.P.convert(o).mult(-1),this.panTo(this.transform.center,r.e({offset:o},S),O)}panTo(o,S,O){return this.easeTo(r.e({center:o},S),O)}getZoom(){return this.transform.zoom}setZoom(o,S){return this.jumpTo({zoom:o},S),this}zoomTo(o,S,O){return this.easeTo(r.e({zoom:o},S),O)}zoomIn(o,S){return this.zoomTo(this.getZoom()+1,o,S),this}zoomOut(o,S){return this.zoomTo(this.getZoom()-1,o,S),this}getBearing(){return this.transform.bearing}setBearing(o,S){return this.jumpTo({bearing:o},S),this}getPadding(){return this.transform.padding}setPadding(o,S){return this.jumpTo({padding:o},S),this}rotateTo(o,S,O){return this.easeTo(r.e({bearing:o},S),O)}resetNorth(o,S){return this.rotateTo(0,r.e({duration:1e3},o),S),this}resetNorthPitch(o,S){return this.easeTo(r.e({bearing:0,pitch:0,duration:1e3},o),S),this}snapToNorth(o,S){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,S):this}getPitch(){return this.transform.pitch}setPitch(o,S){return this.jumpTo({pitch:o},S),this}cameraForBounds(o,S){o=te.convert(o).adjustAntiMeridian();const O=S&&S.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),O,S)}_cameraForBoxAndBearing(o,S,O,C){const j={top:0,bottom:0,right:0,left:0};if(typeof(C=r.e({padding:j,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding=="number"){const En=C.padding;C.padding={top:En,bottom:En,right:En,left:En}}C.padding=r.e(j,C.padding);const J=this.transform,ie=J.padding,ce=new te(o,S),Se=J.project(ce.getNorthWest()),Me=J.project(ce.getNorthEast()),Ce=J.project(ce.getSouthEast()),He=J.project(ce.getSouthWest()),Ye=r.ba(-O),tt=Se.rotate(Ye),ht=Me.rotate(Ye),yt=Ce.rotate(Ye),vt=He.rotate(Ye),kt=new r.P(Math.max(tt.x,ht.x,vt.x,yt.x),Math.max(tt.y,ht.y,vt.y,yt.y)),lt=new r.P(Math.min(tt.x,ht.x,vt.x,yt.x),Math.min(tt.y,ht.y,vt.y,yt.y)),Rt=kt.sub(lt),Nt=(J.width-(ie.left+ie.right+C.padding.left+C.padding.right))/Rt.x,zt=(J.height-(ie.top+ie.bottom+C.padding.top+C.padding.bottom))/Rt.y;if(zt<0||Nt<0)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const sn=Math.min(J.scaleZoom(J.scale*Math.min(Nt,zt)),C.maxZoom),gn=r.P.convert(C.offset),Cn=new r.P((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(r.ba(O)),Fn=gn.add(Cn).mult(J.scale/J.zoomScale(sn));return{center:J.unproject(Se.add(Ce).div(2).sub(Fn)),zoom:sn,bearing:O}}fitBounds(o,S,O){return this._fitInternal(this.cameraForBounds(o,S),S,O)}fitScreenCoordinates(o,S,O,C,j){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(r.P.convert(o)),this.transform.pointLocation(r.P.convert(S)),O,C),C,j)}_fitInternal(o,S,O){return o?(delete(S=r.e(o,S)).padding,S.linear?this.easeTo(S,O):this.flyTo(S,O)):this}jumpTo(o,S){this.stop();const O=this._getTransformForUpdate();let C=!1,j=!1,J=!1;return"zoom"in o&&O.zoom!==+o.zoom&&(C=!0,O.zoom=+o.zoom),o.center!==void 0&&(O.center=r.N.convert(o.center)),"bearing"in o&&O.bearing!==+o.bearing&&(j=!0,O.bearing=+o.bearing),"pitch"in o&&O.pitch!==+o.pitch&&(J=!0,O.pitch=+o.pitch),o.padding==null||O.isPaddingEqual(o.padding)||(O.padding=o.padding),this._applyUpdatedTransform(O),this.fire(new r.k("movestart",S)).fire(new r.k("move",S)),C&&this.fire(new r.k("zoomstart",S)).fire(new r.k("zoom",S)).fire(new r.k("zoomend",S)),j&&this.fire(new r.k("rotatestart",S)).fire(new r.k("rotate",S)).fire(new r.k("rotateend",S)),J&&this.fire(new r.k("pitchstart",S)).fire(new r.k("pitch",S)).fire(new r.k("pitchend",S)),this.fire(new r.k("moveend",S))}calculateCameraOptionsFromTo(o,S,O,C=0){const j=r.Z.fromLngLat(o,S),J=r.Z.fromLngLat(O,C),ie=J.x-j.x,ce=J.y-j.y,Se=J.z-j.z,Me=Math.hypot(ie,ce,Se);if(Me===0)throw new Error("Can't calculate camera options with same From and To");const Ce=Math.hypot(ie,ce),He=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Me/this.transform.tileSize),Ye=180*Math.atan2(ie,-ce)/Math.PI;let tt=180*Math.acos(Ce/Me)/Math.PI;return tt=Se<0?90-tt:90+tt,{center:J.toLngLat(),zoom:He,pitch:tt,bearing:Ye}}easeTo(o,S){var O;this._stop(!1,o.easeId),((o=r.e({offset:[0,0],duration:500,easing:r.b9},o)).animate===!1||!o.essential&&g.prefersReducedMotion)&&(o.duration=0);const C=this._getTransformForUpdate(),j=C.zoom,J=C.bearing,ie=C.pitch,ce=C.padding,Se="bearing"in o?this._normalizeBearing(o.bearing,J):J,Me="pitch"in o?+o.pitch:ie,Ce="padding"in o?o.padding:C.padding,He=r.P.convert(o.offset);let Ye=C.centerPoint.add(He);const tt=C.pointLocation(Ye),{center:ht,zoom:yt}=C.getConstrained(r.N.convert(o.center||tt),(O=o.zoom)!==null&&O!==void 0?O:j);this._normalizeCenter(ht,C);const vt=C.project(tt),kt=C.project(ht).sub(vt),lt=C.zoomScale(yt-j);let Rt,Nt;o.around&&(Rt=r.N.convert(o.around),Nt=C.locationPoint(Rt));const zt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||yt!==j,this._rotating=this._rotating||J!==Se,this._pitching=this._pitching||Me!==ie,this._padding=!C.isPaddingEqual(Ce),this._easeId=o.easeId,this._prepareEase(S,o.noMoveStart,zt),this.terrain&&this._prepareElevation(ht),this._ease(sn=>{if(this._zooming&&(C.zoom=r.y.number(j,yt,sn)),this._rotating&&(C.bearing=r.y.number(J,Se,sn)),this._pitching&&(C.pitch=r.y.number(ie,Me,sn)),this._padding&&(C.interpolatePadding(ce,Ce,sn),Ye=C.centerPoint.add(He)),this.terrain&&!o.freezeElevation&&this._updateElevation(sn),Rt)C.setLocationAtPoint(Rt,Nt);else{const gn=C.zoomScale(C.zoom-j),Cn=yt>j?Math.min(2,lt):Math.max(.5,lt),Fn=Math.pow(Cn,1-sn),En=C.unproject(vt.add(kt.mult(sn*Fn)).mult(gn));C.setLocationAtPoint(C.renderWorldCopies?En.wrap():En,Ye)}this._applyUpdatedTransform(C),this._fireMoveEvents(S)},sn=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(S,sn)},o),this}_prepareEase(o,S,O={}){this._moving=!0,S||O.moving||this.fire(new r.k("movestart",o)),this._zooming&&!O.zooming&&this.fire(new r.k("zoomstart",o)),this._rotating&&!O.rotating&&this.fire(new r.k("rotatestart",o)),this._pitching&&!O.pitching&&this.fire(new r.k("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const S=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&S!==this._elevationTarget){const O=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(O-(S-(O*o+this._elevationStart))/(1-o)),this._elevationTarget=S}this.transform.elevation=r.y.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){const S=o.getCameraPosition(),O=this.terrain.getElevationForLngLatZoom(S.lngLat,o.zoom);if(S.altitude<O){const C=this.calculateCameraOptionsFromTo(S.lngLat,O,o.center,o.elevation);return{pitch:C.pitch,zoom:C.zoom}}return{}}_applyUpdatedTransform(o){const S=[];if(this.terrain&&S.push(C=>this._elevateCameraIfInsideTerrain(C)),this.transformCameraUpdate&&S.push(C=>this.transformCameraUpdate(C)),!S.length)return;const O=o.clone();for(const C of S){const j=O.clone(),{center:J,zoom:ie,pitch:ce,bearing:Se,elevation:Me}=C(j);J&&(j.center=J),ie!==void 0&&(j.zoom=ie),ce!==void 0&&(j.pitch=ce),Se!==void 0&&(j.bearing=Se),Me!==void 0&&(j.elevation=Me),O.apply(j)}this.transform.apply(O)}_fireMoveEvents(o){this.fire(new r.k("move",o)),this._zooming&&this.fire(new r.k("zoom",o)),this._rotating&&this.fire(new r.k("rotate",o)),this._pitching&&this.fire(new r.k("pitch",o))}_afterEase(o,S){if(this._easeId&&S&&this._easeId===S)return;delete this._easeId;const O=this._zooming,C=this._rotating,j=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,O&&this.fire(new r.k("zoomend",o)),C&&this.fire(new r.k("rotateend",o)),j&&this.fire(new r.k("pitchend",o)),this.fire(new r.k("moveend",o))}flyTo(o,S){var O;if(!o.essential&&g.prefersReducedMotion){const Nn=r.M(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Nn,S)}this.stop(),o=r.e({offset:[0,0],speed:1.2,curve:1.42,easing:r.b9},o);const C=this._getTransformForUpdate(),j=C.zoom,J=C.bearing,ie=C.pitch,ce=C.padding,Se="bearing"in o?this._normalizeBearing(o.bearing,J):J,Me="pitch"in o?+o.pitch:ie,Ce="padding"in o?o.padding:C.padding,He=r.P.convert(o.offset);let Ye=C.centerPoint.add(He);const tt=C.pointLocation(Ye),{center:ht,zoom:yt}=C.getConstrained(r.N.convert(o.center||tt),(O=o.zoom)!==null&&O!==void 0?O:j);this._normalizeCenter(ht,C);const vt=C.zoomScale(yt-j),kt=C.project(tt),lt=C.project(ht).sub(kt);let Rt=o.curve;const Nt=Math.max(C.width,C.height),zt=Nt/vt,sn=lt.mag();if("minZoom"in o){const Nn=r.ac(Math.min(o.minZoom,j,yt),C.minZoom,C.maxZoom),Rr=Nt/C.zoomScale(Nn-j);Rt=Math.sqrt(Rr/sn*2)}const gn=Rt*Rt;function Cn(Nn){const Rr=(zt*zt-Nt*Nt+(Nn?-1:1)*gn*gn*sn*sn)/(2*(Nn?zt:Nt)*gn*sn);return Math.log(Math.sqrt(Rr*Rr+1)-Rr)}function Fn(Nn){return(Math.exp(Nn)-Math.exp(-Nn))/2}function En(Nn){return(Math.exp(Nn)+Math.exp(-Nn))/2}const Sn=Cn(!1);let Jn=function(Nn){return En(Sn)/En(Sn+Rt*Nn)},Nr=function(Nn){return Nt*((En(Sn)*(Fn(Rr=Sn+Rt*Nn)/En(Rr))-Fn(Sn))/gn)/sn;var Rr},An=(Cn(!0)-Sn)/Rt;if(Math.abs(sn)<1e-6||!isFinite(An)){if(Math.abs(Nt-zt)<1e-6)return this.easeTo(o,S);const Nn=zt<Nt?-1:1;An=Math.abs(Math.log(zt/Nt))/Rt,Nr=()=>0,Jn=Rr=>Math.exp(Nn*Rt*Rr)}return o.duration="duration"in o?+o.duration:1e3*An/("screenSpeed"in o?+o.screenSpeed/Rt:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=J!==Se,this._pitching=Me!==ie,this._padding=!C.isPaddingEqual(Ce),this._prepareEase(S,!1),this.terrain&&this._prepareElevation(ht),this._ease(Nn=>{const Rr=Nn*An,Ni=1/Jn(Rr);C.zoom=Nn===1?yt:j+C.scaleZoom(Ni),this._rotating&&(C.bearing=r.y.number(J,Se,Nn)),this._pitching&&(C.pitch=r.y.number(ie,Me,Nn)),this._padding&&(C.interpolatePadding(ce,Ce,Nn),Ye=C.centerPoint.add(He)),this.terrain&&!o.freezeElevation&&this._updateElevation(Nn);const Gr=Nn===1?ht:C.unproject(kt.add(lt.mult(Nr(Rr))).mult(Ni));C.setLocationAtPoint(C.renderWorldCopies?Gr.wrap():Gr,Ye),this._applyUpdatedTransform(C),this._fireMoveEvents(S)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(S)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,S){var O;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const C=this._onEaseEnd;delete this._onEaseEnd,C.call(this,S)}return o||(O=this.handlers)===null||O===void 0||O.stop(!1),this}_ease(o,S,O){O.animate===!1||O.duration===0?(o(1),S()):(this._easeStart=g.now(),this._easeOptions=O,this._onEaseFrame=o,this._onEaseEnd=S,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,S){o=r.b3(o,-180,180);const O=Math.abs(o-S);return Math.abs(o-360-S)<O&&(o-=360),Math.abs(o+360-S)<O&&(o+=360),o}_normalizeCenter(o,S){if(!S.renderWorldCopies||S.lngRange)return;const O=o.lng-S.center.lng;o.lng+=O>180?-360:O<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(r.N.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}const Lh={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class jh{constructor(o=Lh){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=S=>{!S||S.sourceDataType!=="metadata"&&S.sourceDataType!=="visibility"&&S.dataType!=="style"&&S.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=_.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=_.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=_.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){_.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,S){const O=this._map._getUIString(`AttributionControl.${S}`);o.title=O,o.setAttribute("aria-label",O)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(C=>typeof C!="string"?"":C)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const S=this._map.style.sourceCaches;for(const C in S){const j=S[C];if(j.used||j.usedForTerrain){const J=j.getSource();J.attribution&&o.indexOf(J.attribution)<0&&o.push(J.attribution)}}o=o.filter(C=>String(C).trim()),o.sort((C,j)=>C.length-j.length),o=o.filter((C,j)=>{for(let J=j+1;J<o.length;J++)if(o[J].indexOf(C)>=0)return!1;return!0});const O=o.join(" | ");O!==this._attribHTML&&(this._attribHTML=O,o.length?(this._innerContainer.innerHTML=O,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class q0{constructor(o={}){this._updateCompact=()=>{const S=this._container.children;if(S.length){const O=S[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&O.classList.add("maplibregl-compact"):O.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=_.create("div","maplibregl-ctrl");const S=_.create("a","maplibregl-ctrl-logo");return S.target="_blank",S.rel="noopener nofollow",S.href="https://maplibre.org/",S.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),S.setAttribute("rel","noopener nofollow"),this._container.appendChild(S),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){_.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ni{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const S=++this._id;return this._queue.push({callback:o,id:S,cancelled:!1}),S}remove(o){const S=this._currentlyRunning,O=S?this._queue.concat(S):this._queue;for(const C of O)if(C.id===o)return void(C.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const S=this._currentlyRunning=this._queue;this._queue=[];for(const O of S)if(!O.cancelled&&(O.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var H0=r.Y([{name:"a_pos3d",type:"Int16",components:3}]);class f3 extends r.E{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,S){this.sourceCache.update(o,S),this._renderableTilesKeys=[];const O={};for(const C of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:S}))O[C.key]=!0,this._renderableTilesKeys.push(C.key),this._tiles[C.key]||(C.posMatrix=new Float64Array(16),r.aP(C.posMatrix,0,r.X,0,r.X,0,1),this._tiles[C.key]=new Dn(C,this.tileSize));for(const C in this._tiles)O[C]||delete this._tiles[C]}freeRtt(o){for(const S in this._tiles){const O=this._tiles[S];(!o||O.tileID.equals(o)||O.tileID.isChildOf(o)||o.isChildOf(O.tileID))&&(O.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const S={};for(const O of this._renderableTilesKeys){const C=this._tiles[O].tileID;if(C.canonical.equals(o.canonical)){const j=o.clone();j.posMatrix=new Float64Array(16),r.aP(j.posMatrix,0,r.X,0,r.X,0,1),S[O]=j}else if(C.canonical.isChildOf(o.canonical)){const j=o.clone();j.posMatrix=new Float64Array(16);const J=C.canonical.z-o.canonical.z,ie=C.canonical.x-(C.canonical.x>>J<<J),ce=C.canonical.y-(C.canonical.y>>J<<J),Se=r.X>>J;r.aP(j.posMatrix,0,Se,0,Se,0,1),r.J(j.posMatrix,j.posMatrix,[-ie*Se,-ce*Se,0]),S[O]=j}else if(o.canonical.isChildOf(C.canonical)){const j=o.clone();j.posMatrix=new Float64Array(16);const J=o.canonical.z-C.canonical.z,ie=o.canonical.x-(o.canonical.x>>J<<J),ce=o.canonical.y-(o.canonical.y>>J<<J),Se=r.X>>J;r.aP(j.posMatrix,0,r.X,0,r.X,0,1),r.J(j.posMatrix,j.posMatrix,[ie*Se,ce*Se,0]),r.K(j.posMatrix,j.posMatrix,[1/2**J,1/2**J,0]),S[O]=j}}return S}getSourceTile(o,S){const O=this.sourceCache._source;let C=o.overscaledZ-this.deltaZoom;if(C>O.maxzoom&&(C=O.maxzoom),C<O.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(C).key);let j=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!j||!j.dem)&&S)for(;C>=O.minzoom&&(!j||!j.dem);)j=this.sourceCache.getTileByID(o.scaledTo(C--).key);return j}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(S=>S.timeAdded>=o)}}class W0{constructor(o,S,O){this.painter=o,this.sourceCache=new f3(S),this.options=O,this.exaggeration=typeof O.exaggeration=="number"?O.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,S,O,C=r.X){var j;if(!(S>=0&&S<C&&O>=0&&O<C))return 0;const J=this.getTerrainData(o),ie=(j=J.tile)===null||j===void 0?void 0:j.dem;if(!ie)return 0;const ce=function(tt,ht,yt){var vt=ht[0],kt=ht[1];return tt[0]=yt[0]*vt+yt[4]*kt+yt[12],tt[1]=yt[1]*vt+yt[5]*kt+yt[13],tt}([],[S/C*r.X,O/C*r.X],J.u_terrain_matrix),Se=[ce[0]*ie.dim,ce[1]*ie.dim],Me=Math.floor(Se[0]),Ce=Math.floor(Se[1]),He=Se[0]-Me,Ye=Se[1]-Ce;return ie.get(Me,Ce)*(1-He)*(1-Ye)+ie.get(Me+1,Ce)*He*(1-Ye)+ie.get(Me,Ce+1)*(1-He)*Ye+ie.get(Me+1,Ce+1)*He*Ye}getElevationForLngLatZoom(o,S){if(!r.bb(S,o.wrap()))return 0;const{tileID:O,mercatorX:C,mercatorY:j}=this._getOverscaledTileIDFromLngLatZoom(o,S);return this.getElevation(O,C%r.X,j%r.X,r.X)}getElevation(o,S,O,C=r.X){return this.getDEMElevation(o,S,O,C)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const C=this.painter.context,j=new r.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new G(C,j,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new G(C,new r.R({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=r.an([])}const S=this.sourceCache.getSourceTile(o,!0);if(S&&S.dem&&(!S.demTexture||S.needsTerrainPrepare)){const C=this.painter.context;S.demTexture=this.painter.getTileTexture(S.dem.stride),S.demTexture?S.demTexture.update(S.dem.getPixels(),{premultiply:!1}):S.demTexture=new G(C,S.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),S.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),S.needsTerrainPrepare=!1}const O=S&&S+S.tileID.key+o.key;if(O&&!this._demMatrixCache[O]){const C=this.sourceCache.sourceCache._source.maxzoom;let j=o.canonical.z-S.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=C?j=o.canonical.z-C:r.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const J=o.canonical.x-(o.canonical.x>>j<<j),ie=o.canonical.y-(o.canonical.y>>j<<j),ce=r.bc(new Float64Array(16),[1/(r.X<<j),1/(r.X<<j),0]);r.J(ce,ce,[J*r.X,ie*r.X,0]),this._demMatrixCache[o.key]={matrix:ce,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:S&&S.dem&&S.dem.dim||1,u_terrain_matrix:O?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:S&&S.dem&&S.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(S&&S.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:S}}getFramebuffer(o){const S=this.painter,O=S.width/devicePixelRatio,C=S.height/devicePixelRatio;return!this._fbo||this._fbo.width===O&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new G(S.context,{width:O,height:C,data:null},S.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(S.context.gl.NEAREST,S.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new G(S.context,{width:O,height:C,data:null},S.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(S.context.gl.NEAREST,S.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=S.context.createFramebuffer(O,C,!0,!1),this._fbo.depthAttachment.set(S.context.createRenderbuffer(S.context.gl.DEPTH_COMPONENT16,O,C))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const S=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let j=0,J=0;j<this._coordsTextureSize;j++)for(let ie=0;ie<this._coordsTextureSize;ie++,J+=4)S[J+0]=255&ie,S[J+1]=255&j,S[J+2]=ie>>8<<4|j>>8,S[J+3]=0;const O=new r.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(S.buffer)),C=new G(o,O,o.gl.RGBA,{premultiply:!1});return C.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const S=new Uint8Array(4),O=this.painter.context,C=O.gl,j=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),J=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),ie=Math.round(this.painter.height/devicePixelRatio);O.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),C.readPixels(j,ie-J-1,1,1,C.RGBA,C.UNSIGNED_BYTE,S),O.bindFramebuffer.set(null);const ce=S[0]+(S[2]>>4<<8),Se=S[1]+((15&S[2])<<8),Me=this.coordsIndex[255-S[3]],Ce=Me&&this.sourceCache.getTileByID(Me);if(!Ce)return null;const He=this._coordsTextureSize,Ye=(1<<Ce.tileID.canonical.z)*He;return new r.Z((Ce.tileID.canonical.x*He+ce)/Ye+Ce.tileID.wrap,(Ce.tileID.canonical.y*He+Se)/Ye,this.getElevation(Ce.tileID,ce,Se,He))}depthAtPoint(o){const S=new Uint8Array(4),O=this.painter.context,C=O.gl;return O.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),C.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,C.RGBA,C.UNSIGNED_BYTE,S),O.bindFramebuffer.set(null),(S[0]/16777216+S[1]/65536+S[2]/256+S[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,S=new r.bd,O=new r.aY,C=this.meshSize,j=r.X/C,J=C*C;for(let Ce=0;Ce<=C;Ce++)for(let He=0;He<=C;He++)S.emplaceBack(He*j,Ce*j,0);for(let Ce=0;Ce<J;Ce+=C+1)for(let He=0;He<C;He++)O.emplaceBack(He+Ce,C+He+Ce+1,C+He+Ce+2),O.emplaceBack(He+Ce,C+He+Ce+2,He+Ce+1);const ie=S.length,ce=ie+2*(C+1);for(const Ce of[0,1])for(let He=0;He<=C;He++)for(const Ye of[0,1])S.emplaceBack(He*j,Ce*r.X,Ye);for(let Ce=0;Ce<2*C;Ce+=2)O.emplaceBack(ce+Ce,ce+Ce+1,ce+Ce+3),O.emplaceBack(ce+Ce,ce+Ce+3,ce+Ce+2),O.emplaceBack(ie+Ce,ie+Ce+3,ie+Ce+1),O.emplaceBack(ie+Ce,ie+Ce+2,ie+Ce+3);const Se=S.length,Me=Se+2*(C+1);for(const Ce of[0,1])for(let He=0;He<=C;He++)for(const Ye of[0,1])S.emplaceBack(Ce*r.X,He*j,Ye);for(let Ce=0;Ce<2*C;Ce+=2)O.emplaceBack(Se+Ce,Se+Ce+1,Se+Ce+3),O.emplaceBack(Se+Ce,Se+Ce+3,Se+Ce+2),O.emplaceBack(Me+Ce,Me+Ce+3,Me+Ce+1),O.emplaceBack(Me+Ce,Me+Ce+2,Me+Ce+3);return this._mesh=new yu(o.createVertexBuffer(S,H0.members),o.createIndexBuffer(O),r.a0.simpleSegment(0,0,S.length,O.length)),this._mesh}getMeshFrameDelta(o){return 2*Math.PI*r.be/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,S){var O;const{tileID:C}=this._getOverscaledTileIDFromLngLatZoom(o,S);return(O=this.getMinMaxElevation(C).minElevation)!==null&&O!==void 0?O:0}getMinMaxElevation(o){const S=this.getTerrainData(o).tile,O={minElevation:null,maxElevation:null};return S&&S.dem&&(O.minElevation=S.dem.min*this.exaggeration,O.maxElevation=S.dem.max*this.exaggeration),O}_getOverscaledTileIDFromLngLatZoom(o,S){const O=r.Z.fromLngLat(o.wrap()),C=(1<<S)*r.X,j=O.x*C,J=O.y*C,ie=Math.floor(j/r.X),ce=Math.floor(J/r.X);return{tileID:new r.S(S,0,S,ie,ce),mercatorX:j,mercatorY:J}}}class d3{constructor(o,S,O){this._context=o,this._size=S,this._tileSize=O,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const S=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),O=new G(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return O.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),S.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),S.colorAttachment.set(O.texture),{id:o,fbo:S,texture:O,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(S=>o.id!==S),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const S of this._recentlyUsed)if(!this._objects[S].inUse)return this._objects[S];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const Nh={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class cw{constructor(o,S){this.painter=o,this.terrain=S,this.pool=new d3(o.context,30,S.sourceCache.tileSize*S.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,S){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(O=>!o._layers[O].isHidden(S)),this._coordsDescendingInv={};for(const O in o.sourceCaches){this._coordsDescendingInv[O]={};const C=o.sourceCaches[O].getVisibleCoordinates();for(const j of C){const J=this.terrain.sourceCache.getTerrainCoords(j);for(const ie in J)this._coordsDescendingInv[O][ie]||(this._coordsDescendingInv[O][ie]=[]),this._coordsDescendingInv[O][ie].push(J[ie])}}this._coordsDescendingInvStr={};for(const O of o._order){const C=o._layers[O],j=C.source;if(Nh[C.type]&&!this._coordsDescendingInvStr[j]){this._coordsDescendingInvStr[j]={};for(const J in this._coordsDescendingInv[j])this._coordsDescendingInvStr[j][J]=this._coordsDescendingInv[j][J].map(ie=>ie.key).sort().join()}}for(const O of this._renderableTiles)for(const C in this._coordsDescendingInvStr){const j=this._coordsDescendingInvStr[C][O.tileID.key];j&&j!==O.rttCoords[C]&&(O.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const S=o.type,O=this.painter,C=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(Nh[S]&&(this._prevType&&Nh[this._prevType]||this._stacks.push([]),this._prevType=S,this._stacks[this._stacks.length-1].push(o.id),!C))return!0;if(Nh[this._prevType]||Nh[S]&&C){this._prevType=S;const j=this._stacks.length-1,J=this._stacks[j]||[];for(const ie of this._renderableTiles){if(this.pool.isFull()&&(Ch(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(ie),ie.rtt[j]){const Se=this.pool.getObjectForId(ie.rtt[j].id);if(Se.stamp===ie.rtt[j].stamp){this.pool.useObject(Se);continue}}const ce=this.pool.getOrCreateFreeObject();this.pool.useObject(ce),this.pool.stampObject(ce),ie.rtt[j]={id:ce.id,stamp:ce.stamp},O.context.bindFramebuffer.set(ce.fbo.framebuffer),O.context.clear({color:r.aM.transparent,stencil:0}),O.currentStencilSource=void 0;for(let Se=0;Se<J.length;Se++){const Me=O.style._layers[J[Se]],Ce=Me.source?this._coordsDescendingInv[Me.source][ie.tileID.key]:[ie.tileID];O.context.viewport.set([0,0,ce.fbo.width,ce.fbo.height]),O._renderTileClippingMasks(Me,Ce),O.renderLayer(O,O.style.sourceCaches[Me.source],Me,Ce),Me.source&&(ie.rttCoords[Me.source]=this._coordsDescendingInvStr[Me.source][ie.tileID.key])}}return Ch(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Nh[S]}return!1}}const G0={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},uw=h,p3={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Lh,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:r.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},K0=$=>{$.touchstart=$.dragStart,$.touchmoveWindow=$.dragMove,$.touchend=$.dragEnd},m3={showCompass:!0,showZoom:!0,visualizePitch:!1};class g3{constructor(o,S,O=!1){this.mousedown=J=>{this.startMouse(r.e({},J,{ctrlKey:!0,preventDefault:()=>J.preventDefault()}),_.mousePos(this.element,J)),_.addEventListener(window,"mousemove",this.mousemove),_.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=J=>{this.moveMouse(J,_.mousePos(this.element,J))},this.mouseup=J=>{this.mouseRotate.dragEnd(J),this.mousePitch&&this.mousePitch.dragEnd(J),this.offTemp()},this.touchstart=J=>{J.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_.touchPos(this.element,J.targetTouches)[0],this.startTouch(J,this._startPos),_.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.addEventListener(window,"touchend",this.touchend))},this.touchmove=J=>{J.targetTouches.length!==1?this.reset():(this._lastPos=_.touchPos(this.element,J.targetTouches)[0],this.moveTouch(J,this._lastPos))},this.touchend=J=>{J.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const C=o.dragRotate._mouseRotate.getClickTolerance(),j=o.dragRotate._mousePitch.getClickTolerance();this.element=S,this.mouseRotate=L0({clickTolerance:C,enable:!0}),this.touchRotate=(({enable:J,clickTolerance:ie,bearingDegreesPerPixelMoved:ce=.8})=>{const Se=new D0;return new os({clickTolerance:ie,move:(Me,Ce)=>({bearingDelta:(Ce.x-Me.x)*ce}),moveStateManager:Se,enable:J,assignEvents:K0})})({clickTolerance:C,enable:!0}),this.map=o,O&&(this.mousePitch=j0({clickTolerance:j,enable:!0}),this.touchPitch=(({enable:J,clickTolerance:ie,pitchDegreesPerPixelMoved:ce=-.5})=>{const Se=new D0;return new os({clickTolerance:ie,move:(Me,Ce)=>({pitchDelta:(Ce.y-Me.y)*ce}),moveStateManager:Se,enable:J,assignEvents:K0})})({clickTolerance:j,enable:!0})),_.addEventListener(S,"mousedown",this.mousedown),_.addEventListener(S,"touchstart",this.touchstart,{passive:!1}),_.addEventListener(S,"touchcancel",this.reset)}startMouse(o,S){this.mouseRotate.dragStart(o,S),this.mousePitch&&this.mousePitch.dragStart(o,S),_.disableDrag()}startTouch(o,S){this.touchRotate.dragStart(o,S),this.touchPitch&&this.touchPitch.dragStart(o,S),_.disableDrag()}moveMouse(o,S){const O=this.map,{bearingDelta:C}=this.mouseRotate.dragMove(o,S)||{};if(C&&O.setBearing(O.getBearing()+C),this.mousePitch){const{pitchDelta:j}=this.mousePitch.dragMove(o,S)||{};j&&O.setPitch(O.getPitch()+j)}}moveTouch(o,S){const O=this.map,{bearingDelta:C}=this.touchRotate.dragMove(o,S)||{};if(C&&O.setBearing(O.getBearing()+C),this.touchPitch){const{pitchDelta:j}=this.touchPitch.dragMove(o,S)||{};j&&O.setPitch(O.getPitch()+j)}}off(){const o=this.element;_.removeEventListener(o,"mousedown",this.mousedown),_.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend),_.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){_.enableDrag(),_.removeEventListener(window,"mousemove",this.mousemove),_.removeEventListener(window,"mouseup",this.mouseup),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend)}}let ca;function ji($,o,S){const O=new r.N($.lng,$.lat);if($=new r.N($.lng,$.lat),o){const C=new r.N($.lng-360,$.lat),j=new r.N($.lng+360,$.lat),J=S.locationPoint($).distSqr(o);S.locationPoint(C).distSqr(o)<J?$=C:S.locationPoint(j).distSqr(o)<J&&($=j)}for(;Math.abs($.lng-S.center.lng)>180;){const C=S.locationPoint($);if(C.x>=0&&C.y>=0&&C.x<=S.width&&C.y<=S.height)break;$.lng>S.center.lng?$.lng-=360:$.lng+=360}return $.lng!==O.lng&&S.locationPoint($).y>S.height/2-S.getHorizon()?$:O}const $h={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function jm($,o,S){const O=$.classList;for(const C in $h)O.remove(`maplibregl-${S}-anchor-${C}`);O.add(`maplibregl-${S}-anchor-${o}`)}class Nm extends r.E{constructor(o){if(super(),this._onKeyPress=S=>{const O=S.code,C=S.charCode||S.keyCode;O!=="Space"&&O!=="Enter"&&C!==32&&C!==13||this.togglePopup()},this._onMapClick=S=>{const O=S.originalEvent.target,C=this._element;this._popup&&(O===C||C.contains(O))&&this.togglePopup()},this._update=S=>{var O;if(!this._map)return;const C=this._map.loaded()&&!this._map.isMoving();((S==null?void 0:S.type)==="terrain"||(S==null?void 0:S.type)==="render"&&!C)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?ji(this._lngLat,this._flatPos,this._map.transform):(O=this._lngLat)===null||O===void 0?void 0:O.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let j="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?j=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(j=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let J="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?J="rotateX(0deg)":this._pitchAlignment==="map"&&(J=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||S&&S.type!=="moveend"||(this._pos=this._pos.round()),_.setTransform(this._element,`${$h[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${J} ${j}`),g.frameAsync(new AbortController).then(()=>{this._updateOpacity(S&&S.type==="moveend")}).catch(()=>{})},this._onMove=S=>{if(!this._isDragging){const O=this._clickTolerance||this._map._clickTolerance;this._isDragging=S.point.dist(this._pointerdownPos)>=O}this._isDragging&&(this._pos=S.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.k("dragstart"))),this.fire(new r.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new r.k("dragend")),this._state="inactive"},this._addDragHandler=S=>{this._element.contains(S.originalEvent.target)&&(S.preventDefault(),this._positionDelta=S.point.sub(this._pos).add(this._offset),this._pointerdownPos=S.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(o==null?void 0:o.opacity,o==null?void 0:o.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=r.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=_.create("div");const S=_.createNS("http://www.w3.org/2000/svg","svg"),O=41,C=27;S.setAttributeNS(null,"display","block"),S.setAttributeNS(null,"height",`${O}px`),S.setAttributeNS(null,"width",`${C}px`),S.setAttributeNS(null,"viewBox",`0 0 ${C} ${O}`);const j=_.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"stroke","none"),j.setAttributeNS(null,"stroke-width","1"),j.setAttributeNS(null,"fill","none"),j.setAttributeNS(null,"fill-rule","evenodd");const J=_.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"fill-rule","nonzero");const ie=_.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ie.setAttributeNS(null,"fill","#000000");const ce=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const vt of ce){const kt=_.createNS("http://www.w3.org/2000/svg","ellipse");kt.setAttributeNS(null,"opacity","0.04"),kt.setAttributeNS(null,"cx","10.5"),kt.setAttributeNS(null,"cy","5.80029008"),kt.setAttributeNS(null,"rx",vt.rx),kt.setAttributeNS(null,"ry",vt.ry),ie.appendChild(kt)}const Se=_.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"fill",this._color);const Me=_.createNS("http://www.w3.org/2000/svg","path");Me.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Se.appendChild(Me);const Ce=_.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"opacity","0.25"),Ce.setAttributeNS(null,"fill","#000000");const He=_.createNS("http://www.w3.org/2000/svg","path");He.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ce.appendChild(He);const Ye=_.createNS("http://www.w3.org/2000/svg","g");Ye.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ye.setAttributeNS(null,"fill","#FFFFFF");const tt=_.createNS("http://www.w3.org/2000/svg","g");tt.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ht=_.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#000000"),ht.setAttributeNS(null,"opacity","0.25"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962");const yt=_.createNS("http://www.w3.org/2000/svg","circle");yt.setAttributeNS(null,"fill","#FFFFFF"),yt.setAttributeNS(null,"cx","5.5"),yt.setAttributeNS(null,"cy","5.5"),yt.setAttributeNS(null,"r","5.4999962"),tt.appendChild(ht),tt.appendChild(yt),J.appendChild(ie),J.appendChild(Se),J.appendChild(Ce),J.appendChild(Ye),J.appendChild(tt),S.appendChild(J),S.setAttributeNS(null,"height",O*this._scale+"px"),S.setAttributeNS(null,"width",C*this._scale+"px"),this._element.appendChild(S),this._offset=r.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()}),jm(this._element,this._anchor,"marker"),o&&o.className)for(const S of o.className.split(" "))this._element.classList.add(S);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),_.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=r.N.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const C=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var S,O;if(!(!((S=this._map)===null||S===void 0)&&S.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const C=this._map,j=C.terrain.depthAtPoint(this._pos),J=C.terrain.getElevationForLngLatZoom(this._lngLat,C.transform.tileZoom);if(C.transform.lngLatToCameraDepth(this._lngLat,J)-j<.006)return void(this._element.style.opacity=this._opacity);const ie=-this._offset.y/C.transform._pixelPerMeter,ce=Math.sin(C.getPitch()*Math.PI/180)*ie,Se=C.terrain.depthAtPoint(new r.P(this._pos.x,this._pos.y-this._offset.y)),Me=C.transform.lngLatToCameraDepth(this._lngLat,J+ce)-Se>.006;!((O=this._popup)===null||O===void 0)&&O.isOpen()&&Me&&this._popup.remove(),this._element.style.opacity=Me?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=r.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,S){return o===void 0&&S===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),o!==void 0&&(this._opacity=o),S!==void 0&&(this._opacityWhenCovered=S),this._map&&this._updateOpacity(!0),this}}const hw={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let xd=0,Sd=!1;const kl={maxWidth:100,unit:"metric"};function Ed($,o,S){const O=S&&S.maxWidth||100,C=$._container.clientHeight/2,j=$.unproject([0,C]),J=$.unproject([O,C]),ie=j.distanceTo(J);if(S&&S.unit==="imperial"){const ce=3.2808*ie;ce>5280?Yn(o,O,ce/5280,$._getUIString("ScaleControl.Miles")):Yn(o,O,ce,$._getUIString("ScaleControl.Feet"))}else S&&S.unit==="nautical"?Yn(o,O,ie/1852,$._getUIString("ScaleControl.NauticalMiles")):ie>=1e3?Yn(o,O,ie/1e3,$._getUIString("ScaleControl.Kilometers")):Yn(o,O,ie,$._getUIString("ScaleControl.Meters"))}function Yn($,o,S,O){const C=function(j){const J=Math.pow(10,`${Math.floor(j)}`.length-1);let ie=j/J;return ie=ie>=10?10:ie>=5?5:ie>=3?3:ie>=2?2:ie>=1?1:function(ce){const Se=Math.pow(10,Math.ceil(-Math.log(ce)/Math.LN10));return Math.round(ce*Se)/Se}(ie),J*ie}(S);$.style.width=o*(C/S)+"px",$.innerHTML=`${C}&nbsp;${O}`}const Sr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},$m=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bm($){if($){if(typeof $=="number"){const o=Math.round(Math.abs($)/Math.SQRT2);return{center:new r.P(0,0),top:new r.P(0,$),"top-left":new r.P(o,o),"top-right":new r.P(-o,o),bottom:new r.P(0,-$),"bottom-left":new r.P(o,-o),"bottom-right":new r.P(-o,-o),left:new r.P($,0),right:new r.P(-$,0)}}if($ instanceof r.P||Array.isArray($)){const o=r.P.convert($);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:r.P.convert($.center||[0,0]),top:r.P.convert($.top||[0,0]),"top-left":r.P.convert($["top-left"]||[0,0]),"top-right":r.P.convert($["top-right"]||[0,0]),bottom:r.P.convert($.bottom||[0,0]),"bottom-left":r.P.convert($["bottom-left"]||[0,0]),"bottom-right":r.P.convert($["bottom-right"]||[0,0]),left:r.P.convert($.left||[0,0]),right:r.P.convert($.right||[0,0])}}return Bm(new r.P(0,0))}const X0=h;l.AJAXError=r.bh,l.Evented=r.E,l.LngLat=r.N,l.MercatorCoordinate=r.Z,l.Point=r.P,l.addProtocol=r.bi,l.config=r.a,l.removeProtocol=r.bj,l.AttributionControl=jh,l.BoxZoomHandler=Do,l.CanvasSource=It,l.CooperativeGesturesHandler=Dh,l.DoubleClickZoomHandler=Au,l.DragPanHandler=sw,l.DragRotateHandler=aw,l.EdgeInsets=Mc,l.FullscreenControl=class extends r.E{constructor($={}){super(),this._onFullscreenChange=()=>{var o;let S=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((o=S==null?void 0:S.shadowRoot)===null||o===void 0)&&o.fullscreenElement;)S=S.shadowRoot.fullscreenElement;S===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,$&&$.container&&($.container instanceof HTMLElement?this._container=$.container:r.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd($){return this._map=$,this._container||(this._container=this._map.getContainer()),this._controlContainer=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){_.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const $=this._fullscreenButton=_.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);_.create("span","maplibregl-ctrl-icon",$).setAttribute("aria-hidden","true"),$.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const $=this._getTitle();this._fullscreenButton.setAttribute("aria-label",$),this._fullscreenButton.title=$}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new r.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new r.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},l.GeoJSONSource=Je,l.GeolocateControl=class extends r.E{constructor($){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new r.k("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new r.k("geolocate",o)),this._finish()}},this._updateCamera=o=>{const S=new r.N(o.coords.longitude,o.coords.latitude),O=o.coords.accuracy,C=this._map.getBearing(),j=r.e({bearing:C},this.options.fitBoundsOptions),J=te.fromLngLat(S,O);this._map.fitBounds(J,j,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const S=new r.N(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(S).addTo(this._map),this._userLocationDotMarker.setLngLat(S).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const S=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=S,this._geolocateButton.setAttribute("aria-label",S),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Sd)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new r.k("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=_.create("button","maplibregl-ctrl-geolocate",this._container),_.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(o===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");const S=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=S,this._geolocateButton.setAttribute("aria-label",S)}else{const S=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=S,this._geolocateButton.setAttribute("aria-label",S)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=_.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Nm({element:this._dotElement}),this._circleElement=_.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Nm({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",S=>{S.geolocateSource||this._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new r.k("trackuserlocationend")),this.fire(new r.k("userlocationlostfocus")))})}},this.options=r.e({},hw,$)}onAdd($){return this._map=$,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return r._(this,arguments,void 0,function*(o=!1){if(ca!==void 0&&!o)return ca;if(window.navigator.permissions===void 0)return ca=!!window.navigator.geolocation,ca;try{ca=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ca=!!window.navigator.geolocation}return ca})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),_.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,xd=0,Sd=!1}_isOutOfMapMaxBounds($){const o=this._map.getMaxBounds(),S=$.coords;return o&&(S.longitude<o.getWest()||S.longitude>o.getEast()||S.latitude<o.getSouth()||S.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const $=this._map.getBounds(),o=$.getSouthEast(),S=$.getNorthEast(),O=o.distanceTo(S),C=Math.ceil(this._accuracy/(O/this._map._container.clientHeight)*2);this._circleElement.style.width=`${C}px`,this._circleElement.style.height=`${C}px`}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":xd--,Sd=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new r.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.k("trackuserlocationstart")),this.fire(new r.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let $;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),xd++,xd>1?($={maximumAge:6e5,timeout:0},Sd=!0):($=this.options.positionOptions,Sd=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,$)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},l.Hash=_u,l.ImageSource=ft,l.KeyboardHandler=Ea,l.LngLatBounds=te,l.LogoControl=q0,l.Map=class extends lw{constructor($){r.bf.mark(r.bg.create);const o=Object.assign(Object.assign({},p3),$);if(o.minZoom!=null&&o.maxZoom!=null&&o.minZoom>o.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(o.minPitch!=null&&o.maxPitch!=null&&o.minPitch>o.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(o.minPitch!=null&&o.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(o.maxPitch!=null&&o.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new El(o.minZoom,o.maxZoom,o.minPitch,o.maxPitch,o.renderWorldCopies),{bearingSnap:o.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ni,this._controls=[],this._mapId=r.a4(),this._contextLost=S=>{S.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new r.k("webglcontextlost",{originalEvent:S}))},this._contextRestored=S=>{this._setupPainter(),this.resize(),this._update(),this.fire(new r.k("webglcontextrestored",{originalEvent:S}))},this._onMapScroll=S=>{if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=o.interactive,this._maxTileCacheSize=o.maxTileCacheSize,this._maxTileCacheZoomLevels=o.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=o.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=o.preserveDrawingBuffer===!0,this._antialias=o.antialias===!0,this._trackResize=o.trackResize===!0,this._bearingSnap=o.bearingSnap,this._refreshExpiredTiles=o.refreshExpiredTiles===!0,this._fadeDuration=o.fadeDuration,this._crossSourceCollisions=o.crossSourceCollisions===!0,this._collectResourceTiming=o.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},G0),o.locale),this._clickTolerance=o.clickTolerance,this._overridePixelRatio=o.pixelRatio,this._maxCanvasSize=o.maxCanvasSize,this.transformCameraUpdate=o.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=o.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=w.addThrottleControl(()=>this.isMoving()),this._requestManager=new A(o.transformRequest),typeof o.container=="string"){if(this._container=document.getElementById(o.container),!this._container)throw new Error(`Container '${o.container}' not found.`)}else{if(!(o.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=o.container}if(o.maxBounds&&this.setMaxBounds(o.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let S=!1;const O=Yl(C=>{this._trackResize&&!this._removed&&(this.resize(C),this.redraw())},50);this._resizeObserver=new ResizeObserver(C=>{S?O(C):S=!0}),this._resizeObserver.observe(this._container)}this.handlers=new V0(this,o),this._hash=o.hash&&new _u(typeof o.hash=="string"&&o.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:o.center,zoom:o.zoom,bearing:o.bearing,pitch:o.pitch}),o.bounds&&(this.resize(),this.fitBounds(o.bounds,r.e({},o.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=o.localIdeographFontFamily,this._validateStyle=o.validateStyle,o.style&&this.setStyle(o.style,{localIdeographFontFamily:o.localIdeographFontFamily}),o.attributionControl&&this.addControl(new jh(typeof o.attributionControl=="boolean"?void 0:o.attributionControl)),o.maplibreLogo&&this.addControl(new q0,o.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",S=>{this._update(S.dataType==="style"),this.fire(new r.k(`${S.dataType}data`,S))}),this.on("dataloading",S=>{this.fire(new r.k(`${S.dataType}dataloading`,S))}),this.on("dataabort",S=>{this.fire(new r.k("sourcedataabort",S))})}_getMapId(){return this._mapId}addControl($,o){if(o===void 0&&(o=$.getDefaultPosition?$.getDefaultPosition():"top-right"),!$||!$.onAdd)return this.fire(new r.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const S=$.onAdd(this);this._controls.push($);const O=this._controlPositions[o];return o.indexOf("bottom")!==-1?O.insertBefore(S,O.firstChild):O.appendChild(S),this}removeControl($){if(!$||!$.onRemove)return this.fire(new r.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf($);return o>-1&&this._controls.splice(o,1),$.onRemove(this),this}hasControl($){return this._controls.indexOf($)>-1}calculateCameraOptionsFromTo($,o,S,O){return O==null&&this.terrain&&(O=this.terrain.getElevationForLngLatZoom(S,this.transform.tileZoom)),super.calculateCameraOptionsFromTo($,o,S,O)}resize($){var o;const S=this._containerDimensions(),O=S[0],C=S[1],j=this._getClampedPixelRatio(O,C);if(this._resizeCanvas(O,C,j),this.painter.resize(O,C,j),this.painter.overLimit()){const ie=this.painter.context.gl;this._maxCanvasSize=[ie.drawingBufferWidth,ie.drawingBufferHeight];const ce=this._getClampedPixelRatio(O,C);this._resizeCanvas(O,C,ce),this.painter.resize(O,C,ce)}this.transform.resize(O,C),(o=this._requestedCameraState)===null||o===void 0||o.resize(O,C);const J=!this._moving;return J&&(this.stop(),this.fire(new r.k("movestart",$)).fire(new r.k("move",$))),this.fire(new r.k("resize",$)),J&&this.fire(new r.k("moveend",$)),this}_getClampedPixelRatio($,o){const{0:S,1:O}=this._maxCanvasSize,C=this.getPixelRatio(),j=$*C,J=o*C;return Math.min(j>S?S/j:1,J>O?O/J:1)*C}getPixelRatio(){var $;return($=this._overridePixelRatio)!==null&&$!==void 0?$:devicePixelRatio}setPixelRatio($){this._overridePixelRatio=$,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds($){return this.transform.setMaxBounds(te.convert($)),this._update()}setMinZoom($){if(($=$??-2)>=-2&&$<=this.transform.maxZoom)return this.transform.minZoom=$,this._update(),this.getZoom()<$&&this.setZoom($),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom($){if(($=$??22)>=this.transform.minZoom)return this.transform.maxZoom=$,this._update(),this.getZoom()>$&&this.setZoom($),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch($){if(($=$??0)<0)throw new Error("minPitch must be greater than or equal to 0");if($>=0&&$<=this.transform.maxPitch)return this.transform.minPitch=$,this._update(),this.getPitch()<$&&this.setPitch($),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch($){if(($=$??60)>85)throw new Error("maxPitch must be less than or equal to 85");if($>=this.transform.minPitch)return this.transform.maxPitch=$,this._update(),this.getPitch()>$&&this.setPitch($),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies($){return this.transform.renderWorldCopies=$,this._update()}project($){return this.transform.locationPoint(r.N.convert($),this.style&&this.terrain)}unproject($){return this.transform.pointLocation(r.P.convert($),this.terrain)}isMoving(){var $;return this._moving||(($=this.handlers)===null||$===void 0?void 0:$.isMoving())}isZooming(){var $;return this._zooming||(($=this.handlers)===null||$===void 0?void 0:$.isZooming())}isRotating(){var $;return this._rotating||(($=this.handlers)===null||$===void 0?void 0:$.isRotating())}_createDelegatedListener($,o,S){if($==="mouseenter"||$==="mouseover"){let O=!1;return{layers:o,listener:S,delegates:{mousemove:j=>{const J=o.filter(ce=>this.getLayer(ce)),ie=J.length!==0?this.queryRenderedFeatures(j.point,{layers:J}):[];ie.length?O||(O=!0,S.call(this,new $r($,this,j.originalEvent,{features:ie}))):O=!1},mouseout:()=>{O=!1}}}}if($==="mouseleave"||$==="mouseout"){let O=!1;return{layers:o,listener:S,delegates:{mousemove:J=>{const ie=o.filter(ce=>this.getLayer(ce));(ie.length!==0?this.queryRenderedFeatures(J.point,{layers:ie}):[]).length?O=!0:O&&(O=!1,S.call(this,new $r($,this,J.originalEvent)))},mouseout:J=>{O&&(O=!1,S.call(this,new $r($,this,J.originalEvent)))}}}}{const O=C=>{const j=o.filter(ie=>this.getLayer(ie)),J=j.length!==0?this.queryRenderedFeatures(C.point,{layers:j}):[];J.length&&(C.features=J,S.call(this,C),delete C.features)};return{layers:o,listener:S,delegates:{[$]:O}}}}_saveDelegatedListener($,o){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[$]=this._delegatedListeners[$]||[],this._delegatedListeners[$].push(o)}_removeDelegatedListener($,o,S){if(!this._delegatedListeners||!this._delegatedListeners[$])return;const O=this._delegatedListeners[$];for(let C=0;C<O.length;C++){const j=O[C];if(j.listener===S&&j.layers.length===o.length&&j.layers.every(J=>o.includes(J))){for(const J in j.delegates)this.off(J,j.delegates[J]);return void O.splice(C,1)}}}on($,o,S){if(S===void 0)return super.on($,o);const O=this._createDelegatedListener($,typeof o=="string"?[o]:o,S);this._saveDelegatedListener($,O);for(const C in O.delegates)this.on(C,O.delegates[C]);return this}once($,o,S){if(S===void 0)return super.once($,o);const O=typeof o=="string"?[o]:o,C=this._createDelegatedListener($,O,S);for(const j in C.delegates){const J=C.delegates[j];C.delegates[j]=(...ie)=>{this._removeDelegatedListener($,O,S),J(...ie)}}this._saveDelegatedListener($,C);for(const j in C.delegates)this.once(j,C.delegates[j]);return this}off($,o,S){return S===void 0?super.off($,o):(this._removeDelegatedListener($,typeof o=="string"?[o]:o,S),this)}queryRenderedFeatures($,o){if(!this.style)return[];let S;const O=$ instanceof r.P||Array.isArray($),C=O?$:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(O?{}:$)||{},C instanceof r.P||typeof C[0]=="number")S=[r.P.convert(C)];else{const j=r.P.convert(C[0]),J=r.P.convert(C[1]);S=[j,new r.P(J.x,j.y),J,new r.P(j.x,J.y),j]}return this.style.queryRenderedFeatures(S,o,this.transform)}querySourceFeatures($,o){return this.style.querySourceFeatures($,o)}setStyle($,o){return(o=r.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&$?(this._diffStyle($,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle($,o))}setTransformRequest($){return this._requestManager.setTransformRequest($),this}_getUIString($){const o=this._locale[$];if(o==null)throw new Error(`Missing UI string '${$}'`);return o}_updateStyle($,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle($,o));const S=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!$)),$?(this.style=new ki(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof $=="string"?this.style.loadURL($,o,S):this.style.loadJSON($,o,S),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ki(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle($,o){if(typeof $=="string"){const S=this._requestManager.transformRequest($,"Style");r.h(S,new AbortController).then(O=>{this._updateDiff(O.data,o)}).catch(O=>{O&&this.fire(new r.j(O))})}else typeof $=="object"&&this._updateDiff($,o)}_updateDiff($,o){try{this.style.setState($,o)&&this._update(!0)}catch(S){r.w(`Unable to perform style diff: ${S.message||S.error||S}.  Rebuilding the style from scratch.`),this._updateStyle($,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():r.w("There is no style added to the map.")}addSource($,o){return this._lazyInitEmptyStyle(),this.style.addSource($,o),this._update(!0)}isSourceLoaded($){const o=this.style&&this.style.sourceCaches[$];if(o!==void 0)return o.loaded();this.fire(new r.j(new Error(`There is no source with ID '${$}'`)))}setTerrain($){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),$){const o=this.style.sourceCaches[$.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${$.source}`);this.terrain===null&&o.reload();for(const S in this.style._layers){const O=this.style._layers[S];O.type==="hillshade"&&O.source===$.source&&r.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new W0(this.painter,o,$),this.painter.renderToTexture=new cw(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=S=>{S.dataType==="style"?this.terrain.sourceCache.freeRtt():S.dataType==="source"&&S.tile&&(S.sourceId!==$.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(S.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new r.k("terrain",{terrain:$})),this}getTerrain(){var $,o;return(o=($=this.terrain)===null||$===void 0?void 0:$.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const $=this.style&&this.style.sourceCaches;for(const o in $){const S=$[o]._tiles;for(const O in S){const C=S[O];if(C.state!=="loaded"&&C.state!=="errored")return!1}}return!0}removeSource($){return this.style.removeSource($),this._update(!0)}getSource($){return this.style.getSource($)}addImage($,o,S={}){const{pixelRatio:O=1,sdf:C=!1,stretchX:j,stretchY:J,content:ie,textFitWidth:ce,textFitHeight:Se}=S;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||r.b(o))){if(o.width===void 0||o.height===void 0)return this.fire(new r.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Me,height:Ce,data:He}=o,Ye=o;return this.style.addImage($,{data:new r.R({width:Me,height:Ce},new Uint8Array(He)),pixelRatio:O,stretchX:j,stretchY:J,content:ie,textFitWidth:ce,textFitHeight:Se,sdf:C,version:0,userImage:Ye}),Ye.onAdd&&Ye.onAdd(this,$),this}}{const{width:Me,height:Ce,data:He}=g.getImageData(o);this.style.addImage($,{data:new r.R({width:Me,height:Ce},He),pixelRatio:O,stretchX:j,stretchY:J,content:ie,textFitWidth:ce,textFitHeight:Se,sdf:C,version:0})}}updateImage($,o){const S=this.style.getImage($);if(!S)return this.fire(new r.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const O=o instanceof HTMLImageElement||r.b(o)?g.getImageData(o):o,{width:C,height:j,data:J}=O;if(C===void 0||j===void 0)return this.fire(new r.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==S.data.width||j!==S.data.height)return this.fire(new r.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const ie=!(o instanceof HTMLImageElement||r.b(o));return S.data.replace(J,ie),this.style.updateImage($,S),this}getImage($){return this.style.getImage($)}hasImage($){return $?!!this.style.getImage($):(this.fire(new r.j(new Error("Missing required image id"))),!1)}removeImage($){this.style.removeImage($)}loadImage($){return w.getImage(this._requestManager.transformRequest($,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer($,o){return this._lazyInitEmptyStyle(),this.style.addLayer($,o),this._update(!0)}moveLayer($,o){return this.style.moveLayer($,o),this._update(!0)}removeLayer($){return this.style.removeLayer($),this._update(!0)}getLayer($){return this.style.getLayer($)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange($,o,S){return this.style.setLayerZoomRange($,o,S),this._update(!0)}setFilter($,o,S={}){return this.style.setFilter($,o,S),this._update(!0)}getFilter($){return this.style.getFilter($)}setPaintProperty($,o,S,O={}){return this.style.setPaintProperty($,o,S,O),this._update(!0)}getPaintProperty($,o){return this.style.getPaintProperty($,o)}setLayoutProperty($,o,S,O={}){return this.style.setLayoutProperty($,o,S,O),this._update(!0)}getLayoutProperty($,o){return this.style.getLayoutProperty($,o)}setGlyphs($,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs($,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite($,o,S={}){return this._lazyInitEmptyStyle(),this.style.addSprite($,o,S,O=>{O||this._update(!0)}),this}removeSprite($){return this._lazyInitEmptyStyle(),this.style.removeSprite($),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite($,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite($,o,S=>{S||this._update(!0)}),this}setLight($,o={}){return this._lazyInitEmptyStyle(),this.style.setLight($,o),this._update(!0)}getLight(){return this.style.getLight()}setSky($){return this._lazyInitEmptyStyle(),this.style.setSky($),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState($,o){return this.style.setFeatureState($,o),this._update()}removeFeatureState($,o){return this.style.removeFeatureState($,o),this._update()}getFeatureState($){return this.style.getFeatureState($)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let $=0,o=0;return this._container&&($=this._container.clientWidth||400,o=this._container.clientHeight||300),[$,o]}_setupContainer(){const $=this._container;$.classList.add("maplibregl-map");const o=this._canvasContainer=_.create("div","maplibregl-canvas-container",$);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=_.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const S=this._containerDimensions(),O=this._getClampedPixelRatio(S[0],S[1]);this._resizeCanvas(S[0],S[1],O);const C=this._controlContainer=_.create("div","maplibregl-control-container",$),j=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(J=>{j[J]=_.create("div",`maplibregl-ctrl-${J} `,C)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas($,o,S){this._canvas.width=Math.floor(S*$),this._canvas.height=Math.floor(S*o),this._canvas.style.width=`${$}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const $={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",O=>{o={requestedAttributes:$},O&&(o.statusMessage=O.statusMessage,o.type=O.type)},{once:!0});const S=this._canvas.getContext("webgl2",$)||this._canvas.getContext("webgl",$);if(!S){const O="Failed to initialize WebGL";throw o?(o.message=O,new Error(JSON.stringify(o))):new Error(O)}this.painter=new bu(S,this.transform),E.testSupport(S)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update($){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||$,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame($){return this._update(),this._renderTaskQueue.add($)}_cancelRenderFrame($){this._renderTaskQueue.remove($)}_render($){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run($),this._removed)return;let S=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const C=this.transform.zoom,j=g.now();this.style.zoomHistory.update(C,j);const J=new r.z(C,{now:j,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ie=J.crossFadingFactor();ie===1&&ie===this._crossFadingFactor||(S=!0,this._crossFadingFactor=ie),this.style.update(J)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new r.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,r.bf.mark(r.bg.load),this.fire(new r.k("load"))),this.style&&(this.style.hasTransitions()||S)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const O=this._sourcesDirty||this._styleDirty||this._placementDirty;return O||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new r.k("idle")),!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,r.bf.mark(r.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var $;this._hash&&this._hash.remove();for(const S of this._controls)S.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),w.removeThrottleControl(this._imageQueueHandle),($=this._resizeObserver)===null||$===void 0||$.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o!=null&&o.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),_.remove(this._canvasContainer),_.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),r.bf.clearMetrics(),this._removed=!0,this.fire(new r.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,g.frameAsync(this._frameRequest).then($=>{r.bf.frame($),this._frameRequest=null,this._render($)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries($){this._showTileBoundaries!==$&&(this._showTileBoundaries=$,this._update())}get showPadding(){return!!this._showPadding}set showPadding($){this._showPadding!==$&&(this._showPadding=$,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes($){this._showCollisionBoxes!==$&&(this._showCollisionBoxes=$,$?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector($){this._showOverdrawInspector!==$&&(this._showOverdrawInspector=$,this._update())}get repaint(){return!!this._repaint}set repaint($){this._repaint!==$&&(this._repaint=$,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices($){this._vertices=$,this._update()}get version(){return uw}getCameraTargetElevation(){return this.transform.elevation}},l.MapMouseEvent=$r,l.MapTouchEvent=Qr,l.MapWheelEvent=Zr,l.Marker=Nm,l.NavigationControl=class{constructor($){this._updateZoomButtons=()=>{const o=this._map.getZoom(),S=o===this._map.getMaxZoom(),O=o===this._map.getMinZoom();this._zoomInButton.disabled=S,this._zoomOutButton.disabled=O,this._zoomInButton.setAttribute("aria-disabled",S.toString()),this._zoomOutButton.setAttribute("aria-disabled",O.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,S)=>{const O=this._map._getUIString(`NavigationControl.${S}`);o.title=O,o.setAttribute("aria-label",O)},this.options=r.e({},m3,$),this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),_.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),_.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=_.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd($){return this._map=$,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new g3(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){_.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton($,o){const S=_.create("button",$,this._container);return S.type="button",S.addEventListener("click",o),S}},l.Popup=class extends r.E{constructor($){super(),this.remove=()=>(this._content&&_.remove(this._content),this._container&&(_.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new r.k("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{var S;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=_.create("div","maplibregl-popup",this._map.getContainer()),this._tip=_.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const ie of this.options.className.split(" "))this._container.classList.add(ie);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?ji(this._lngLat,this._flatPos,this._map.transform):(S=this._lngLat)===null||S===void 0?void 0:S.wrap(),this._trackPointer&&!o)return;const O=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationPoint(this._lngLat));let C=this.options.anchor;const j=Bm(this.options.offset);if(!C){const ie=this._container.offsetWidth,ce=this._container.offsetHeight;let Se;Se=O.y+j.bottom.y<ce?["top"]:O.y>this._map.transform.height-ce?["bottom"]:[],O.x<ie/2?Se.push("left"):O.x>this._map.transform.width-ie/2&&Se.push("right"),C=Se.length===0?"bottom":Se.join("-")}let J=O.add(j[C]);this.options.subpixelPositioning||(J=J.round()),_.setTransform(this._container,`${$h[C]} translate(${J.x}px,${J.y}px)`),jm(this._container,C,"popup")},this._onClose=()=>{this.remove()},this.options=r.e(Object.create(Sr),$)}addTo($){return this._map&&this.remove(),this._map=$,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new r.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat($){return this._lngLat=r.N.convert($),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText($){return this.setDOMContent(document.createTextNode($))}setHTML($){const o=document.createDocumentFragment(),S=document.createElement("body");let O;for(S.innerHTML=$;O=S.firstChild,O;)o.appendChild(O);return this.setDOMContent(o)}getMaxWidth(){var $;return($=this._container)===null||$===void 0?void 0:$.style.maxWidth}setMaxWidth($){return this.options.maxWidth=$,this._update(),this}setDOMContent($){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=_.create("div","maplibregl-popup-content",this._container);return this._content.appendChild($),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName($){return this._container&&this._container.classList.add($),this}removeClassName($){return this._container&&this._container.classList.remove($),this}setOffset($){return this.options.offset=$,this._update(),this}toggleClassName($){if(this._container)return this._container.classList.toggle($)}setSubpixelPositioning($){this.options.subpixelPositioning=$}_createCloseButton(){this.options.closeButton&&(this._closeButton=_.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const $=this._container.querySelector($m);$&&$.focus()}},l.RasterDEMTileSource=ze,l.RasterTileSource=le,l.ScaleControl=class{constructor($){this._onMove=()=>{Ed(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,Ed(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},kl),$)}getDefaultPosition(){return"bottom-left"}onAdd($){return this._map=$,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-scale",$.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){_.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},l.ScrollZoomHandler=Wa,l.Style=ki,l.TerrainControl=class{constructor($){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=$}onAdd($){return this._map=$,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=_.create("button","maplibregl-ctrl-terrain",this._container),_.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){_.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},l.TwoFingersTouchPitchHandler=Rh,l.TwoFingersTouchRotateHandler=F0,l.TwoFingersTouchZoomHandler=$0,l.TwoFingersTouchZoomRotateHandler=U0,l.VectorTileSource=ge,l.VideoSource=wt,l.addSourceType=($,o)=>r._(void 0,void 0,void 0,function*(){if(tn($))throw new Error(`A source type called "${$}" already exists.`);((S,O)=>{Ct[S]=O})($,o)}),l.clearPrewarmedResources=function(){const $=Oe;$&&($.isPreloaded()&&$.numActive()===1?($.release(Y),Oe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},l.getMaxParallelImageRequests=function(){return r.a.MAX_PARALLEL_IMAGE_REQUESTS},l.getRTLTextPluginStatus=function(){return kn().getRTLTextPluginStatus()},l.getVersion=function(){return X0},l.getWorkerCount=function(){return fe.workerCount},l.getWorkerUrl=function(){return r.a.WORKER_URL},l.importScriptInWorkers=function($){return ee().broadcast("IS",$)},l.prewarm=function(){ot().acquire(Y)},l.setMaxParallelImageRequests=function($){r.a.MAX_PARALLEL_IMAGE_REQUESTS=$},l.setRTLTextPlugin=function($,o){return kn().setRTLTextPlugin($,o)},l.setWorkerCount=function($){fe.workerCount=$},l.setWorkerUrl=function($){r.a.WORKER_URL=$}});var a=t;return a})})(bR);var vV=bR.exports;const Jh=P5(vV),_V=()=>{const n=Wt.useRef(null),e=Wt.useRef(null),[t,i]=Wt.useState(1e3),[c,a]=Wt.useState([]),l=(m,v,g)=>{const _=g,E={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[r(v[0],v[1],_,64)]}}]};m.getSource("radius-circle")?m.getSource("radius-circle").setData(E):(m.addSource("radius-circle",{type:"geojson",data:E}),m.addLayer({id:"radius-circle",type:"fill",source:"radius-circle",paint:{"fill-color":"#00bf60","fill-opacity":.3}}))},r=(m,v,g,_)=>{const E=[],b=g/111320,p=g/(111.32*1e3),x=m,y=v;for(let f=0;f<_;f++){const w=f*360/_,A=x+b*Math.cos(w*Math.PI/180),P=y+p*Math.sin(w*Math.PI/180);E.push([A,P])}return E.push(E[0]),E},h=async(m,v)=>{try{const g=await fetch("/api/users/Getshops",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({latitude:m,longitude:v,maxDistance:t})});if(!g.ok)throw new Error("Failed to fetch shops");const _=await g.json();a(_.map(E=>({id:E._id,lat:E.latitude,lng:E.longitude,title:E.fullName,description:E.description||"No description available",img:E.profilePic||"https://via.placeholder.com/100"})))}catch(g){console.error("Error fetching shops: ",g.message)}};return Wt.useEffect(()=>{if(e.current)return;const m=new Jh.Map({container:n.current,style:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",center:[83.2111287,17.8177412],zoom:13});return e.current=m,navigator.geolocation?navigator.geolocation.getCurrentPosition(v=>{const g=v.coords.latitude,_=v.coords.longitude;new Jh.Marker({color:"red"}).setLngLat([_,g]).setPopup(new Jh.Popup().setText("Your Location")).addTo(m),m.once("load",()=>{m.flyTo({center:[_,g],zoom:14,speed:1.5,curve:1,essential:!0})}),l(m,[_,g],t),h(g,_)}):alert("Geolocation is not supported by this browser."),m.addControl(new Jh.NavigationControl,"bottom-right"),m.addControl(new Jh.FullscreenControl,"bottom-right"),m.addControl(new Jh.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0,container:document.getElementById("geolocate-control-container")}),"bottom-right"),()=>{m.remove(),e.current=null}},[]),Wt.useEffect(()=>{e.current&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(m=>{const v=m.coords.latitude,g=m.coords.longitude;l(e.current,[g,v],t),h(v,g)})},[t]),Wt.useEffect(()=>{if(!e.current||c.length===0)return;const m=e.current;c.forEach(v=>{new Jh.Marker({color:"blue"}).setLngLat([v.lng,v.lat]).setPopup(new Jh.Popup().setHTML(`
            <div class="px-3 z-50 text-black items-center flex flex-col">
              <img class="object-cover" src="${v.img}" alt="Shop Image" style="width: 500px; height: 200px; border-radius: 8px; margin-bottom: 8px;" />
              <h3 class="font-bold text-2xl w-full">${v.title}</h3>
              <p class="w-full">${v.description}</p>
              <a href="/chat?id=${v.id}" class="bg-blue-500 px-5 py-2 my-3 font-bold text-white">Order Shop</a>
            </div>
          `)).addTo(m).getElement().addEventListener("click",()=>{m.flyTo({center:[v.lng,v.lat],zoom:14,speed:1.5,curve:1,essential:!0})})})},[c]),Qe.jsxs("div",{className:"w-full h-full relative",children:[Qe.jsx("div",{id:"map geolocate-control-container",ref:n,className:"w-full h-full rounded-lg shadow-lg"}),Qe.jsxs("div",{className:"absolute top-2 left-2 z-10 bg-white pl-2  rounded-lg shadow-md flex  sm:flex-row justify-center items-center gap-4",style:{maxWidth:"400px"},children:[Qe.jsx("label",{className:"text-sm font-medium whitespace-nowrap text-gray-700",children:"Search Radius:"}),Qe.jsx("input",{type:"number",value:t,onChange:m=>i(parseInt(m.target.value,10)),placeholder:"Enter radius",className:"w-fit p-2 bg-white text-black border rounded-lg shadow focus:outline-none "})]})]})},wV=()=>Qe.jsxs("div",{children:[Qe.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Orders"}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[Qe.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[Qe.jsx("h2",{className:"text-xl font-bold mb-2",children:"Order 1"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Order Date: 2021-10-10"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Status: Pending"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Quantity: 2"}),Qe.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white rounded-lg px-3 py-1",children:"View"})]}),Qe.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[Qe.jsx("h2",{className:"text-xl font-bold mb-2",children:"Order 2"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Order Date: 2021-10-10"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Status: Pending"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Quantity: 2"}),Qe.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white rounded-lg px-3 py-1",children:"View"})]}),Qe.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[Qe.jsx("h2",{className:"text-xl font-bold mb-2",children:"Order 3"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Order Date: 2021-10-10"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Status: Pending"}),Qe.jsx("p",{className:"text-gray-400 mb-2",children:"Quantity: 2"}),Qe.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white rounded-lg px-3 py-1",children:"View"})]})]})]}),_R=()=>{const[n,e]=Wt.useState(!1),{setAuthUser:t}=Th();return{loading:n,logout:async()=>{e(!0);try{const a=await(await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"}})).json();if(a.error)throw new Error(a.error);localStorage.removeItem("chat-user"),t(null)}catch(c){Hl.error(c.message)}finally{e(!1)}}}};var wR={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},EO=lu.createContext&&lu.createContext(wR),xV=["attr","size","title"];function SV(n,e){if(n==null)return{};var t=EV(n,e),i,c;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(c=0;c<a.length;c++)i=a[c],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function EV(n,e){if(n==null)return{};var t={},i=Object.keys(n),c,a;for(a=0;a<i.length;a++)c=i[a],!(e.indexOf(c)>=0)&&(t[c]=n[c]);return t}function N2(){return N2=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},N2.apply(this,arguments)}function AO(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),t.push.apply(t,i)}return t}function $2(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?AO(Object(t),!0).forEach(function(i){AV(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):AO(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function AV(n,e,t){return e=kV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kV(n){var e=PV(n,"string");return typeof e=="symbol"?e:String(e)}function PV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function xR(n){return n&&n.map((e,t)=>lu.createElement(e.tag,$2({key:t},e.attr),xR(e.child)))}function fu(n){return e=>lu.createElement(TV,N2({attr:$2({},n.attr)},e),xR(n.child))}function TV(n){var e=t=>{var{attr:i,size:c,title:a}=n,l=SV(n,xV),r=c||t.size||"1em",h;return t.className&&(h=t.className),n.className&&(h=(h?h+" ":"")+n.className),lu.createElement("svg",N2({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,l,{className:h,style:$2($2({color:n.color||t.color},t.style),n.style),height:r,width:r,xmlns:"http://www.w3.org/2000/svg"}),a&&lu.createElement("title",null,a),n.children)};return EO!==void 0?lu.createElement(EO.Consumer,null,t=>e(t)):e(wR)}function SR(n){return fu({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16 13v-2H7V8l-5 4 5 4v-3z"},child:[]},{tag:"path",attr:{d:"M20 3h-9c-1.103 0-2 .897-2 2v4h2V5h9v14h-9v-4H9v4c0 1.103.897 2 2 2h9c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2z"},child:[]}]})(n)}const kO=()=>{const{authUser:n}=Th(),[e,t]=Wt.useState([]),i=X_(),{loading:c,logout:a}=_R();Wt.useEffect(()=>{l()},[]);const l=async()=>{try{const h=await fetch("/api/users/getOrders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n._id})});if(!h.ok)throw new Error("Failed to fetch orders");const m=await h.json();t(m.reverse())}catch(h){console.error("Error fetching orders:",h.message)}},r=async(h,m,v,g)=>{try{if(!(await fetch("/api/users/updateOrder",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:h,status:m})})).ok)throw new Error("Failed to update order");if(l(),m==="cancelled"||m==="completed"){alert("Deleting Files...");const E=await fetch("/api/messages/deleteChat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderId:n._id,receiverId:g})});await Promise.all(v.map(async b=>{try{const p=D8(L8,b);await QU(p),console.log(`Deleted: ${b}`)}catch(p){console.error("Error deleting PDF:",p.message)}})),alert("Order Updated Successfully")}}catch(_){console.error("Error updating order:",_.message)}};return Qe.jsxs("div",{className:"w-screen h-full bg-gray-100 px-5 py-5",children:[Qe.jsxs("div",{className:"flex justify-between items-center",children:[Qe.jsxs("h1",{className:"lg:text-2xl md:text-2xl text-sm text-gray-500 whitespace-nowrap font-semibold mb-4",children:["Welcome ",n.username]}),Qe.jsxs("div",{className:"flex gap-2",children:[n.role==="user"&&Qe.jsx("button",{onClick:()=>{i("/map")},className:"bg-blue-500 px-5 py-3 whitespace-nowrap text-white rounded-xl text-base",children:" Create Order "}),Qe.jsx("button",{className:"bg-red-500 px-5 md:block lg:block hidden text-white py-3 rounded-xl",onClick:a,children:"Logout"}),Qe.jsx("div",{className:"text-2xl bg-red-500 py-2 px-3 rounded-xl flex items-center justify-center md:hidden lg:hidden text-white",onClick:a,children:Qe.jsx(SR,{})})]})]}),Qe.jsx("h2",{className:"text-xl text-gray-500 font-semibold mb-4 ml-5",children:"Your Orders"}),e.length===0?Qe.jsx("h1",{className:"text-sm text-gray-500 font-semibold mb-4 ml-5",children:"No Orders"}):Qe.jsx(Qe.Fragment,{children:Qe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 h-[80vh] py-5 px-5 w-full overflow-auto",children:e.map(h=>Qe.jsxs("div",{className:`bg-white shadow-md rounded-lg p-4   no-scrollbar overflow-auto ${e.length<=2?"max-h-[300px]":"min-h-[30vh]"}`,children:[Qe.jsxs("div",{className:"flex items-center mb-4",children:[n.role==="user"?Qe.jsx("img",{src:h.shopPic,alt:"shop",className:"w-12 h-12 rounded-full mr-4"}):Qe.jsx("img",{src:h.userPic,alt:"user",className:"w-12 h-12 rounded-full mr-4"}),Qe.jsxs("div",{children:[n.role==="user"?Qe.jsx("h3",{className:"text-xl text-gray-700 font-semibold",children:h.shopName}):Qe.jsx("h3",{className:"text-xl text-gray-700 font-semibold",children:h.userName}),Qe.jsx("p",{className:"text-gray-500",children:new Date(h.orderDate).toLocaleDateString()})]})]}),Qe.jsxs("div",{className:"mb-2 flex justify-between",children:[Qe.jsxs("div",{className:"flex flex-col justify-between",children:[Qe.jsxs("p",{className:"text-gray-700",children:["Status: ",Qe.jsx("span",{className:`${h.status==="pending"?"text-yellow-500":h.status==="completed"?"text-green-500":"text-red-500"}`,children:h.status})," "]}),Qe.jsxs("p",{className:"text-gray-700",children:["Quantity: ",h.quantity]}),Qe.jsxs("p",{className:"text-gray-700",children:["Type: ",h.color==="white"?"color":h.color==="black"?"Black & White":"Not Mentioned"]}),Qe.jsxs("p",{className:"text-gray-700",children:["Sides: ",h.sides??"Not-Mentioned"]})]}),Qe.jsxs("div",{className:"flex flex-col gap-2",children:[h.status==="pending"&&Qe.jsx(Qe.Fragment,{children:n.role==="shop"?Qe.jsx("a",{href:`/chat?id=${h.userId}`,className:"bg-blue-500 h-fit py-2 px-3 rounded-xl font-semibold text-white cursor-pointer whitespace-nowrap text-sm",children:" Chat with User"}):Qe.jsx("a",{href:`/chat?id=${h.shopId}`,className:"bg-blue-500 h-fit py-2 px-3 rounded-xl font-semibold text-white cursor-pointer whitespace-nowrap text-sm",children:" Chat with Shop"})}),h.status==="pending"&&Qe.jsxs(Qe.Fragment,{children:[n.role=="user"?Qe.jsx("p",{onClick:()=>r(h._id,"cancelled",h.pdfId,h.shopId),className:"whitespace-nowrap text-white md:text-sm text-xs bg-red-500 px-5 py-2 rounded-xl cursor-pointer",children:"Cancel Order"}):Qe.jsx("p",{onClick:()=>r(h._id,"completed",h.pdfId,h.userId),className:"whitespace-nowrap bg-green-500 px-5 py-2 rounded-xl text-white md:text-sm text-xs cursor-pointer",children:"Complete Order"}),n.role==="shop"&&Qe.jsx("p",{onClick:()=>r(h._id,"rejected",h.pdfId,h.userId),className:"whitespace-nowrap text-white md:text-sm text-xs bg-red-500 px-5 py-2 rounded-xl cursor-pointer",children:"Reject Order"})]})]})]}),Qe.jsx("div",{children:h.pdfId.map((m,v)=>Qe.jsx(Qe.Fragment,{children:h.status==="pending"?Qe.jsxs("div",{className:"flex justify-between w-full",children:[Qe.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"whitespace-nowrap text-blue-500 hover:underline block",children:["View Document ",v+1]},v),n.role==="shop"&&Qe.jsx("a",{target:"_blank",href:m,className:"hover:underline hover:text-blue-500 text-black cursor-pointer",children:"Print"})]}):null}))})]},h._id))})})]})};var OV={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const PO=n=>{let e;const t=new Set,i=(v,g)=>{const _=typeof v=="function"?v(e):v;if(!Object.is(_,e)){const E=e;e=g??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(b=>b(e,E))}},c=()=>e,h={setState:i,getState:c,getInitialState:()=>m,subscribe:v=>(t.add(v),()=>t.delete(v)),destroy:()=>{(OV?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},m=e=n(i,c,h);return h},MV=n=>n?PO(n):PO;var ER={exports:{}},AR={},kR={exports:{}},PR={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S0=Wt;function CV(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var IV=typeof Object.is=="function"?Object.is:CV,RV=S0.useState,DV=S0.useEffect,LV=S0.useLayoutEffect,jV=S0.useDebugValue;function NV(n,e){var t=e(),i=RV({inst:{value:t,getSnapshot:e}}),c=i[0].inst,a=i[1];return LV(function(){c.value=t,c.getSnapshot=e,zA(c)&&a({inst:c})},[n,t,e]),DV(function(){return zA(c)&&a({inst:c}),n(function(){zA(c)&&a({inst:c})})},[n]),jV(t),t}function zA(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!IV(n,t)}catch{return!0}}function $V(n,e){return e()}var BV=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$V:NV;PR.useSyncExternalStore=S0.useSyncExternalStore!==void 0?S0.useSyncExternalStore:BV;kR.exports=PR;var FV=kR.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n3=Wt,zV=FV;function UV(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var VV=typeof Object.is=="function"?Object.is:UV,qV=zV.useSyncExternalStore,HV=n3.useRef,WV=n3.useEffect,GV=n3.useMemo,KV=n3.useDebugValue;AR.useSyncExternalStoreWithSelector=function(n,e,t,i,c){var a=HV(null);if(a.current===null){var l={hasValue:!1,value:null};a.current=l}else l=a.current;a=GV(function(){function h(E){if(!m){if(m=!0,v=E,E=i(E),c!==void 0&&l.hasValue){var b=l.value;if(c(b,E))return g=b}return g=E}if(b=g,VV(v,E))return b;var p=i(E);return c!==void 0&&c(b,p)?b:(v=E,g=p)}var m=!1,v,g,_=t===void 0?null:t;return[function(){return h(e())},_===null?void 0:function(){return h(_())}]},[e,t,i,c]);var r=qV(n,a[0],a[1]);return WV(function(){l.hasValue=!0,l.value=r},[r]),KV(r),r};ER.exports=AR;var XV=ER.exports;const ZV=P5(XV);var TR={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{useDebugValue:YV}=lu,{useSyncExternalStoreWithSelector:JV}=ZV;let TO=!1;const QV=n=>n;function eq(n,e=QV,t){(TR?"production":void 0)!=="production"&&t&&!TO&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),TO=!0);const i=JV(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return YV(i),i}const OO=n=>{(TR?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?MV(n):n,t=(i,c)=>eq(e,i,c);return Object.assign(t,e),t},tq=n=>n?OO(n):OO,Oh=tq(n=>({selectedConversation:null,setSelectedConversation:e=>n({selectedConversation:e}),messages:[],setMessages:e=>n({messages:e})}));function nq(n){return fu({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"},child:[]}]})(n)}function rq(n){return fu({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"},child:[]}]})(n)}function iq(n){return fu({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z"},child:[]}]})(n)}function oq(n){return fu({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"},child:[]}]})(n)}var OR={exports:{}},MR={};const sq="modulepreload",aq=function(n){return"/"+n},MO={},lq=function(e,t,i){let c=Promise.resolve();if(t&&t.length>0){const a=document.getElementsByTagName("link");c=Promise.all(t.map(l=>{if(l=aq(l),l in MO)return;MO[l]=!0;const r=l.endsWith(".css"),h=r?'[rel="stylesheet"]':"";if(!!i)for(let g=a.length-1;g>=0;g--){const _=a[g];if(_.href===l&&(!r||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${h}`))return;const v=document.createElement("link");if(v.rel=r?"stylesheet":sq,r||(v.as="script",v.crossOrigin=""),v.href=l,document.head.appendChild(v),r)return new Promise((g,_)=>{v.addEventListener("load",g),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${l}`)))})}))}return c.then(()=>e()).catch(a=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a})};var av={};av.d=(n,e)=>{for(var t in e)av.o(e,t)&&!av.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};av.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Br=globalThis.pdfjsLib={};av.d(Br,{AbortException:()=>hd,AnnotationEditorLayer:()=>m5,AnnotationEditorParamsType:()=>_i,AnnotationEditorType:()=>Yr,AnnotationEditorUIManager:()=>_m,AnnotationLayer:()=>q4,AnnotationMode:()=>af,AnnotationType:()=>Bo,ColorPicker:()=>q2,DOMSVGFactory:()=>U2,DrawLayer:()=>b5,FeatureTest:()=>Bs,GlobalWorkerOptions:()=>gh,ImageKind:()=>kx,InvalidPDFException:()=>i4,MathClamp:()=>gl,OPS:()=>ic,OutputScale:()=>kh,PDFDataRangeTransport:()=>R7,PDFDateString:()=>F8,PDFWorker:()=>jg,PasswordResponses:()=>hq,PermissionFlag:()=>uq,PixelsPerInch:()=>fd,RenderingCancelledException:()=>$8,ResponseException:()=>B2,SignatureExtractor:()=>Qo,SupportedImageMimeTypes:()=>s4,TextLayer:()=>Ov,TouchManager:()=>z2,Util:()=>vr,VerbosityLevel:()=>r3,XfaLayer:()=>L7,build:()=>RH,createValidAbsoluteUrl:()=>mq,fetchData:()=>Q_,getDocument:()=>xH,getFilenameFromUrl:()=>Eq,getPdfFilenameFromUrl:()=>Aq,getUuid:()=>RR,getXfaPageViewport:()=>kq,isDataScheme:()=>s3,isPdfFile:()=>B8,isValidExplicitDest:()=>kH,noContextMenu:()=>Ac,normalizeUnicode:()=>wq,setLayerDimensions:()=>vm,shadow:()=>di,stopEvent:()=>Fo,version:()=>IH});const Ns=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),CR=[1,0,0,1,0,0],r4=[.001,0,0,.001,0,0],UA=1.35,pl={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},af={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},cq="pdfjs_internal_editor_",Yr={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},_i={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},uq={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ys={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},kx={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Bo={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},og={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},r3={ERRORS:0,WARNINGS:1,INFOS:5},ic={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},hq={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let i3=r3.WARNINGS;function fq(n){Number.isInteger(n)&&(i3=n)}function dq(){return i3}function o3(n){i3>=r3.INFOS&&console.log(`Info: ${n}`)}function ei(n){i3>=r3.WARNINGS&&console.log(`Warning: ${n}`)}function zi(n){throw new Error(n)}function Uo(n,e){n||zi(e)}function pq(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function mq(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const c=n.match(/\./g);(c==null?void 0:c.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=_q(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return pq(i)?i:null}function di(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const Am=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class CO extends Am{constructor(e,t){super(e,"PasswordException"),this.code=t}}class VA extends Am{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class i4 extends Am{constructor(e){super(e,"InvalidPDFException")}}class B2 extends Am{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class gq extends Am{constructor(e){super(e,"FormatError")}}class hd extends Am{constructor(e){super(e,"AbortException")}}function IR(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&zi("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let c=0;c<e;c+=t){const a=Math.min(c+t,e),l=n.subarray(c,a);i.push(String.fromCharCode.apply(null,l))}return i.join("")}function J_(n){typeof n!="string"&&zi("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function yq(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function j8(n){const e=Object.create(null);for(const[t,i]of n)e[t]=i;return e}function bq(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function vq(){try{return new Function(""),!0}catch{return!1}}class Bs{static get isLittleEndian(){return di(this,"isLittleEndian",bq())}static get isEvalSupported(){return di(this,"isEvalSupported",vq())}static get isOffscreenCanvasSupported(){return di(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return di(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){if(typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"){const{platform:e,userAgent:t}=navigator;return di(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}return di(this,"platform",{isAndroid:!1,isLinux:!1,isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return di(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const qA=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var $g,Px,Cv,o4;class vr{static makeHexColor(e,t,i){return`#${qA[e]}${qA[t]}${qA[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],c=e[0]*t[1]+e[1]*t[3]+t[5];return[i,c]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],c=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,a=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[c,a]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),c=this.applyTransform(e.slice(2,4),t),a=this.applyTransform([e[0],e[3]],t),l=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],c[0],a[0],l[0]),Math.min(i[1],c[1],a[1],l[1]),Math.max(i[0],c[0],a[0],l[0]),Math.max(i[1],c[1],a[1],l[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],c=e[0]*t[1]+e[1]*t[3],a=e[2]*t[0]+e[3]*t[2],l=e[2]*t[1]+e[3]*t[3],r=(i+l)/2,h=Math.sqrt((i+l)**2-4*(i*l-a*c))/2,m=r+h||1,v=r-h||1;return[Math.sqrt(m),Math.sqrt(v)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),c=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>c)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>l?null:[i,a,c,l]}static bezierBoundingBox(e,t,i,c,a,l,r,h,m){return m?(m[0]=Math.min(m[0],e,r),m[1]=Math.min(m[1],t,h),m[2]=Math.max(m[2],e,r),m[3]=Math.max(m[3],t,h)):m=[Math.min(e,r),Math.min(t,h),Math.max(e,r),Math.max(t,h)],We(this,Cv,o4).call(this,e,i,a,r,t,c,l,h,3*(-e+3*(i-a)+r),6*(e-2*i+a),3*(i-e),m),We(this,Cv,o4).call(this,e,i,a,r,t,c,l,h,3*(-t+3*(c-l)+h),6*(t-2*c+l),3*(c-t),m),m}}$g=new WeakSet,Px=function(e,t,i,c,a,l,r,h,m,v){if(m<=0||m>=1)return;const g=1-m,_=m*m,E=_*m,b=g*(g*(g*e+3*m*t)+3*_*i)+E*c,p=g*(g*(g*a+3*m*l)+3*_*r)+E*h;v[0]=Math.min(v[0],b),v[1]=Math.min(v[1],p),v[2]=Math.max(v[2],b),v[3]=Math.max(v[3],p)},Cv=new WeakSet,o4=function(e,t,i,c,a,l,r,h,m,v,g,_){if(Math.abs(m)<1e-12){Math.abs(v)>=1e-12&&We(this,$g,Px).call(this,e,t,i,c,a,l,r,h,-g/v,_);return}const E=v**2-4*g*m;if(E<0)return;const b=Math.sqrt(E),p=2*m;We(this,$g,Px).call(this,e,t,i,c,a,l,r,h,(-v+b)/p,_),We(this,$g,Px).call(this,e,t,i,c,a,l,r,h,(-v-b)/p,_)},Pe(vr,$g),Pe(vr,Cv);function _q(n){return decodeURIComponent(escape(n))}let HA=null,IO=null;function wq(n){return HA||(HA=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,IO=new Map([["ﬅ","ſt"]])),n.replaceAll(HA,(e,t,i)=>t?t.normalize("NFKC"):IO.get(i))}function RR(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),IR(n)}const N8="pdfjs_internal_id_";function xq(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,c,...a]=t;if(!n(i)&&!Number.isInteger(i)||!e(c))return!1;const l=a.length;let r=!0;switch(c.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;r=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||r&&h===null))return!1;return!0}function gl(n,e,t){return Math.min(Math.max(n,e),t)}function DR(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(IR(n))}function Sq(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):J_(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const Ru="http://www.w3.org/2000/svg",Bd=class Bd{};Or(Bd,"CSS",96),Or(Bd,"PDF",72),Or(Bd,"PDF_TO_CSS_UNITS",Bd.CSS/Bd.PDF);let fd=Bd;async function Q_(n,e="text"){if(sg(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const c=new XMLHttpRequest;c.open("GET",n,!0),c.responseType=e,c.onreadystatechange=()=>{if(c.readyState===XMLHttpRequest.DONE){if(c.status===200||c.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(c.response);return}t(c.responseText);return}i(new Error(c.statusText))}},c.send(null)})}class ew{constructor({viewBox:e,userUnit:t,scale:i,rotation:c,offsetX:a=0,offsetY:l=0,dontFlip:r=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=c,this.offsetX=a,this.offsetY=l,i*=t;const h=(e[2]+e[0])/2,m=(e[3]+e[1])/2;let v,g,_,E;switch(c%=360,c<0&&(c+=360),c){case 180:v=-1,g=0,_=0,E=1;break;case 90:v=0,g=1,_=1,E=0;break;case 270:v=0,g=-1,_=-1,E=0;break;case 0:v=1,g=0,_=0,E=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}r&&(_=-_,E=-E);let b,p,x,y;v===0?(b=Math.abs(m-e[1])*i+a,p=Math.abs(h-e[0])*i+l,x=(e[3]-e[1])*i,y=(e[2]-e[0])*i):(b=Math.abs(h-e[0])*i+a,p=Math.abs(m-e[1])*i+l,x=(e[2]-e[0])*i,y=(e[3]-e[1])*i),this.transform=[v*i,g*i,_*i,E*i,b-v*i*h-_*i*m,p-g*i*h-E*i*m],this.width=x,this.height=y}get rawDims(){const e=this.viewBox;return di(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:c=this.offsetY,dontFlip:a=!1}={}){return new ew({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:c,dontFlip:a})}convertToViewportPoint(e,t){return vr.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=vr.applyTransform([e[0],e[1]],this.transform),i=vr.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return vr.applyInverseTransform([e,t],this.transform)}}class $8 extends Am{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function s3(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function B8(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function Eq(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function Aq(n,e="document.pdf"){if(typeof n!="string")return e;if(s3(n))return ei('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,c=t.exec(n);let a=i.exec(c[1])||i.exec(c[2])||i.exec(c[3]);if(a&&(a=a[0],a.includes("%")))try{a=i.exec(decodeURIComponent(a))[0]}catch{}return a||e}class RO{constructor(){Or(this,"started",Object.create(null));Or(this,"times",[])}time(e){e in this.started&&ei(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ei(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:c,end:a}of this.times)e.push(`${i.padEnd(t)} ${a-c}ms
`);return e.join("")}}function sg(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Ac(n){n.preventDefault()}function Fo(n){n.preventDefault(),n.stopPropagation()}var Iv;class F8{static toDateObject(e){if(!e||typeof e!="string")return null;D(this,Iv)||Ie(this,Iv,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=D(this,Iv).exec(e);if(!t)return null;const i=parseInt(t[1],10);let c=parseInt(t[2],10);c=c>=1&&c<=12?c-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let r=parseInt(t[5],10);r=r>=0&&r<=59?r:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const m=t[7]||"Z";let v=parseInt(t[8],10);v=v>=0&&v<=23?v:0;let g=parseInt(t[9],10)||0;return g=g>=0&&g<=59?g:0,m==="-"?(l+=v,r+=g):m==="+"&&(l-=v,r-=g),new Date(Date.UTC(i,c,a,l,r,h))}}Iv=new WeakMap,Pe(F8,Iv,void 0);function kq(n,{scale:e=1,rotation:t=0}){const{width:i,height:c}=n.attributes.style,a=[0,0,parseInt(i),parseInt(c)];return new ew({viewBox:a,userUnit:1,scale:e,rotation:t})}function z8(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ei(`Not a valid color format: "${n}"`),[0,0,0])}function Pq(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,z8(i))}e.remove()}function io(n){const{a:e,b:t,c:i,d:c,e:a,f:l}=n.getTransform();return[e,t,i,c,a,l]}function Bc(n){const{a:e,b:t,c:i,d:c,e:a,f:l}=n.getTransform().invertSelf();return[e,t,i,c,a,l]}function vm(n,e,t=!1,i=!0){if(e instanceof ew){const{pageWidth:c,pageHeight:a}=e.rawDims,{style:l}=n,r=Bs.isCSSRoundSupported,h=`var(--total-scale-factor) * ${c}px`,m=`var(--total-scale-factor) * ${a}px`,v=r?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,g=r?`round(down, ${m}, var(--scale-round-y))`:`calc(${m})`;!t||e.rotation%180===0?(l.width=v,l.height=g):(l.width=g,l.height=v)}i&&n.setAttribute("data-main-rotation",e.rotation)}class kh{constructor(){const{pixelRatio:e}=kh;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,c){let a=1/0,l=1/0,r=1/0;i>0&&(a=Math.sqrt(i/(e*t))),c!==-1&&(l=c/e,r=c/t);const h=Math.min(a,l,r);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}}const s4=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var lf,qd,Cl,cf,Rv,Bg,Dv,G2,LR,K2,jR,X2,NR,Hd,Rb,Z2,$R,Fg,Tx;const Nu=class Nu{constructor(e){Pe(this,K2);Pe(this,X2);Pe(this,Hd);Pe(this,Z2);Pe(this,Fg);Pe(this,lf,null);Pe(this,qd,null);Pe(this,Cl,void 0);Pe(this,cf,null);Pe(this,Rv,null);Pe(this,Bg,null);Ie(this,Cl,e),D(Nu,Dv)||Ie(Nu,Dv,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=Ie(this,lf,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=D(this,Cl)._uiManager._signal;e.addEventListener("contextmenu",Ac,{signal:t}),e.addEventListener("pointerdown",We(Nu,G2,LR),{signal:t});const i=Ie(this,cf,document.createElement("div"));i.className="buttons",e.append(i);const c=D(this,Cl).toolbarPosition;if(c){const{style:a}=e,l=D(this,Cl)._uiManager.direction==="ltr"?1-c[0]:c[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*c[1]}% + var(--editor-toolbar-vert-offset))`}return We(this,Z2,$R).call(this),e}get div(){return D(this,lf)}hide(){var e;D(this,lf).classList.add("hidden"),(e=D(this,qd))==null||e.hideDropdown()}show(){var e;D(this,lf).classList.remove("hidden"),(e=D(this,Rv))==null||e.shown()}async addAltText(e){const t=await e.render();We(this,Hd,Rb).call(this,t),D(this,cf).prepend(t,D(this,Fg,Tx)),Ie(this,Rv,e)}addColorPicker(e){Ie(this,qd,e);const t=e.renderButton();We(this,Hd,Rb).call(this,t),D(this,cf).prepend(t,D(this,Fg,Tx))}async addEditSignatureButton(e){const t=Ie(this,Bg,await e.renderEditButton(D(this,Cl)));We(this,Hd,Rb).call(this,t),D(this,cf).prepend(t,D(this,Fg,Tx))}updateEditSignatureButton(e){D(this,Bg)&&(D(this,Bg).title=e)}remove(){var e;D(this,lf).remove(),(e=D(this,qd))==null||e.destroy(),Ie(this,qd,null)}};lf=new WeakMap,qd=new WeakMap,Cl=new WeakMap,cf=new WeakMap,Rv=new WeakMap,Bg=new WeakMap,Dv=new WeakMap,G2=new WeakSet,LR=function(e){e.stopPropagation()},K2=new WeakSet,jR=function(e){D(this,Cl)._focusEventsAllowed=!1,Fo(e)},X2=new WeakSet,NR=function(e){D(this,Cl)._focusEventsAllowed=!0,Fo(e)},Hd=new WeakSet,Rb=function(e){const t=D(this,Cl)._uiManager._signal;e.addEventListener("focusin",We(this,K2,jR).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",We(this,X2,NR).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ac,{signal:t})},Z2=new WeakSet,$R=function(){const{editorType:e,_uiManager:t}=D(this,Cl),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",D(Nu,Dv)[e]),We(this,Hd,Rb).call(this,i),i.addEventListener("click",c=>{t.delete()},{signal:t._signal}),D(this,cf).append(i)},Fg=new WeakSet,Tx=function(){const e=document.createElement("div");return e.className="divider",e},Pe(Nu,G2),Pe(Nu,Dv,null);let a4=Nu;var Lv,Wd,Gd,Y2,BR,J2,FR,Q2,zR;class Tq{constructor(e){Pe(this,Y2);Pe(this,J2);Pe(this,Q2);Pe(this,Lv,null);Pe(this,Wd,null);Pe(this,Gd,void 0);Ie(this,Gd,e)}show(e,t,i){const[c,a]=We(this,J2,FR).call(this,t,i),{style:l}=D(this,Wd)||Ie(this,Wd,We(this,Y2,BR).call(this));e.append(D(this,Wd)),l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){D(this,Wd).remove()}}Lv=new WeakMap,Wd=new WeakMap,Gd=new WeakMap,Y2=new WeakSet,BR=function(){const e=Ie(this,Wd,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ac,{signal:D(this,Gd)._signal});const t=Ie(this,Lv,document.createElement("div"));return t.className="buttons",e.append(t),We(this,Q2,zR).call(this),e},J2=new WeakSet,FR=function(e,t){let i=0,c=0;for(const a of e){const l=a.y+a.height;if(l<i)continue;const r=a.x+(t?a.width:0);if(l>i){c=r,i=l;continue}t?r>c&&(c=r):r<c&&(c=r)}return[t?1-c:c,i]},Q2=new WeakSet,zR=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=D(this,Gd)._signal;e.addEventListener("contextmenu",Ac,{signal:i}),e.addEventListener("click",()=>{D(this,Gd).highlightSelection("floating_button")},{signal:i}),D(this,Lv).append(e)};function U8(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var eS;class Oq{constructor(){Pe(this,eS,0)}get id(){return`${cq}${da(this,eS)._++}`}}eS=new WeakMap;var zg,jv,Qs,Ug,Ox;const tk=class tk{constructor(){Pe(this,Ug);Pe(this,zg,RR());Pe(this,jv,0);Pe(this,Qs,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),c=new Image;c.src=e;const a=c.decode().then(()=>(i.drawImage(c,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return di(this,"_isSVGFittingCanvas",a)}async getFromFile(e){const{lastModified:t,name:i,size:c,type:a}=e;return We(this,Ug,Ox).call(this,`${t}_${i}_${c}_${a}`,e)}async getFromUrl(e){return We(this,Ug,Ox).call(this,e,e)}async getFromBlob(e,t){const i=await t;return We(this,Ug,Ox).call(this,e,i)}async getFromId(e){D(this,Qs)||Ie(this,Qs,new Map);const t=D(this,Qs).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){D(this,Qs)||Ie(this,Qs,new Map);let i=D(this,Qs).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const c=new OffscreenCanvas(t.width,t.height);return c.getContext("2d").drawImage(t,0,0),i={bitmap:c.transferToImageBitmap(),id:`image_${D(this,zg)}_${da(this,jv)._++}`,refCounter:1,isSvg:!1},D(this,Qs).set(e,i),D(this,Qs).set(i.id,i),i}getSvgUrl(e){const t=D(this,Qs).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var c;D(this,Qs)||Ie(this,Qs,new Map);const t=D(this,Qs).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const a=new OffscreenCanvas(i.width,i.height);a.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=a.convertToBlob()}(c=i.close)==null||c.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${D(this,zg)}_`)}};zg=new WeakMap,jv=new WeakMap,Qs=new WeakMap,Ug=new WeakSet,Ox=async function(e,t){D(this,Qs)||Ie(this,Qs,new Map);let i=D(this,Qs).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${D(this,zg)}_${da(this,jv)._++}`,refCounter:0,isSvg:!1});let c;if(typeof t=="string"?(i.url=t,c=await Q_(t,"blob")):t instanceof File?c=i.file=t:t instanceof Blob&&(c=t),c.type==="image/svg+xml"){const a=tk._isSVGFittingCanvas,l=new FileReader,r=new Image,h=new Promise((m,v)=>{r.onload=()=>{i.bitmap=r,i.isSvg=!0,m()},l.onload=async()=>{const g=i.svgUrl=l.result;r.src=await a?`${g}#svgView(preserveAspectRatio(none))`:g},r.onerror=l.onerror=v});l.readAsDataURL(c),await h}else i.bitmap=await createImageBitmap(c);i.refCounter=1}catch(c){ei(c),i=null}return D(this,Qs).set(e,i),i&&D(this,Qs).set(i.id,i),i};let l4=tk;var Po,uf,Nv,fo;class Mq{constructor(e=128){Pe(this,Po,[]);Pe(this,uf,!1);Pe(this,Nv,void 0);Pe(this,fo,-1);Ie(this,Nv,e)}add({cmd:e,undo:t,post:i,mustExec:c,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:r=!1}){if(c&&e(),D(this,uf))return;const h={cmd:e,undo:t,post:i,type:a};if(D(this,fo)===-1){D(this,Po).length>0&&(D(this,Po).length=0),Ie(this,fo,0),D(this,Po).push(h);return}if(l&&D(this,Po)[D(this,fo)].type===a){r&&(h.undo=D(this,Po)[D(this,fo)].undo),D(this,Po)[D(this,fo)]=h;return}const m=D(this,fo)+1;m===D(this,Nv)?D(this,Po).splice(0,1):(Ie(this,fo,m),m<D(this,Po).length&&D(this,Po).splice(m)),D(this,Po).push(h)}undo(){if(D(this,fo)===-1)return;Ie(this,uf,!0);const{undo:e,post:t}=D(this,Po)[D(this,fo)];e(),t==null||t(),Ie(this,uf,!1),Ie(this,fo,D(this,fo)-1)}redo(){if(D(this,fo)<D(this,Po).length-1){Ie(this,fo,D(this,fo)+1),Ie(this,uf,!0);const{cmd:e,post:t}=D(this,Po)[D(this,fo)];e(),t==null||t(),Ie(this,uf,!1)}}hasSomethingToUndo(){return D(this,fo)!==-1}hasSomethingToRedo(){return D(this,fo)<D(this,Po).length-1}cleanType(e){if(D(this,fo)!==-1){for(let t=D(this,fo);t>=0;t--)if(D(this,Po)[t].type!==e){D(this,Po).splice(t+1,D(this,fo)-t),Ie(this,fo,t);return}D(this,Po).length=0,Ie(this,fo,-1)}}destroy(){Ie(this,Po,null)}}Po=new WeakMap,uf=new WeakMap,Nv=new WeakMap,fo=new WeakMap;var tS,UR;class tw{constructor(e){Pe(this,tS);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Bs.platform;for(const[i,c,a={}]of e)for(const l of i){const r=l.startsWith("mac+");t&&r?(this.callbacks.set(l.slice(4),{callback:c,options:a}),this.allKeys.add(l.split("+").at(-1))):!t&&!r&&(this.callbacks.set(l,{callback:c,options:a}),this.allKeys.add(l.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(We(this,tS,UR).call(this,t));if(!i)return;const{callback:c,options:{bubbles:a=!1,args:l=[],checker:r=null}}=i;r&&!r(e,t)||(c.bind(e,...l,t)(),a||Fo(t))}}tS=new WeakSet,UR=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const nS=class nS{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Pq(e),di(this,"_colors",e)}convert(e){const t=z8(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,c]of this._colors)if(c.every((a,l)=>a===t[l]))return nS._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?vr.makeHexColor(...t):e}};Or(nS,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let c4=nS;var Vg,tl,Yo,Cs,qg,Fu,Hg,Il,hf,Kd,Wg,Xd,Vc,oc,Zd,$v,Bv,Gg,Fv,qc,ff,Kg,df,Hc,rS,pf,zv,mf,Yd,Jd,gf,Uv,ds,Ci,zu,yf,Qd,Vv,qv,bf,Wc,Uu,Hv,Rl,Xg,Mx,Wv,u4,iS,VR,oS,qR,Zg,Cx,sS,HR,aS,WR,lS,GR,Gv,h4,cS,KR,Kv,f4,Xv,d4,uS,XR,Is,ma,sc,Du,hS,ZR,fS,YR,Zv,p4,dS,JR,ep,Db,Yv,m4;const kg=class kg{constructor(e,t,i,c,a,l,r,h,m,v,g,_,E,b){Pe(this,Xg);Pe(this,Wv);Pe(this,iS);Pe(this,oS);Pe(this,Zg);Pe(this,sS);Pe(this,aS);Pe(this,lS);Pe(this,Gv);Pe(this,cS);Pe(this,Kv);Pe(this,Xv);Pe(this,uS);Pe(this,Is);Pe(this,sc);Pe(this,hS);Pe(this,fS);Pe(this,Zv);Pe(this,dS);Pe(this,ep);Pe(this,Yv);Pe(this,Vg,new AbortController);Pe(this,tl,null);Pe(this,Yo,new Map);Pe(this,Cs,new Map);Pe(this,qg,null);Pe(this,Fu,null);Pe(this,Hg,null);Pe(this,Il,new Mq);Pe(this,hf,null);Pe(this,Kd,null);Pe(this,Wg,0);Pe(this,Xd,new Set);Pe(this,Vc,null);Pe(this,oc,null);Pe(this,Zd,new Set);Or(this,"_editorUndoBar",null);Pe(this,$v,!1);Pe(this,Bv,!1);Pe(this,Gg,!1);Pe(this,Fv,null);Pe(this,qc,null);Pe(this,ff,null);Pe(this,Kg,null);Pe(this,df,!1);Pe(this,Hc,null);Pe(this,rS,new Oq);Pe(this,pf,!1);Pe(this,zv,!1);Pe(this,mf,null);Pe(this,Yd,null);Pe(this,Jd,null);Pe(this,gf,null);Pe(this,Uv,null);Pe(this,ds,Yr.NONE);Pe(this,Ci,new Set);Pe(this,zu,null);Pe(this,yf,null);Pe(this,Qd,null);Pe(this,Vv,null);Pe(this,qv,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});Pe(this,bf,[0,0]);Pe(this,Wc,null);Pe(this,Uu,null);Pe(this,Hv,null);Pe(this,Rl,null);const p=this._signal=D(this,Vg).signal;Ie(this,Uu,e),Ie(this,Hv,t),Ie(this,qg,i),Ie(this,yf,c),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:p}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:p}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:p}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:p}),a._on("setpreference",this.onSetPreference.bind(this),{signal:p}),a._on("switchannotationeditorparams",x=>this.updateParams(x.type,x.value),{signal:p}),We(this,sS,HR).call(this),We(this,uS,XR).call(this),We(this,Gv,h4).call(this),Ie(this,Fu,l.annotationStorage),Ie(this,Fv,l.filterFactory),Ie(this,Qd,r),Ie(this,Kg,h||null),Ie(this,$v,m),Ie(this,Bv,v),Ie(this,Gg,g),Ie(this,Uv,_||null),this.viewParameters={realScale:fd.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=E||null,this._supportsPinchToZoom=b!==!1}static get _keyboardManager(){const e=kg.prototype,t=l=>D(l,Uu).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),i=(l,{target:r})=>{if(r instanceof HTMLInputElement){const{type:h}=r;return h!=="text"&&h!=="number"}return!0},c=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return di(this,"_keyboardManager",new tw([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:r})=>!(r instanceof HTMLButtonElement)&&D(l,Uu).contains(r)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:r})=>!(r instanceof HTMLButtonElement)&&D(l,Uu).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-c,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[c,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-c],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,c],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}destroy(){var e,t,i,c,a,l,r,h;(e=D(this,Rl))==null||e.resolve(),Ie(this,Rl,null),(t=D(this,Vg))==null||t.abort(),Ie(this,Vg,null),this._signal=null;for(const m of D(this,Cs).values())m.destroy();D(this,Cs).clear(),D(this,Yo).clear(),D(this,Zd).clear(),(i=D(this,gf))==null||i.clear(),Ie(this,tl,null),D(this,Ci).clear(),D(this,Il).destroy(),(c=D(this,qg))==null||c.destroy(),(a=D(this,yf))==null||a.destroy(),(l=D(this,Hc))==null||l.hide(),Ie(this,Hc,null),(r=D(this,Jd))==null||r.destroy(),Ie(this,Jd,null),D(this,qc)&&(clearTimeout(D(this,qc)),Ie(this,qc,null)),D(this,Wc)&&(clearTimeout(D(this,Wc)),Ie(this,Wc,null)),(h=this._editorUndoBar)==null||h.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return D(this,Uv)}get useNewAltTextFlow(){return D(this,Bv)}get useNewAltTextWhenAddingImage(){return D(this,Gg)}get hcmFilter(){return di(this,"hcmFilter",D(this,Qd)?D(this,Fv).addHCMFilter(D(this,Qd).foreground,D(this,Qd).background):"none")}get direction(){return di(this,"direction",getComputedStyle(D(this,Uu)).direction)}get highlightColors(){return di(this,"highlightColors",D(this,Kg)?new Map(D(this,Kg).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return di(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),Ie(this,Kd,e)}setMainHighlightColorPicker(e){Ie(this,Jd,e)}editAltText(e,t=!1){var i;(i=D(this,qg))==null||i.editAltText(this,e,t)}getSignature(e){var t;(t=D(this,yf))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return D(this,yf)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":Ie(this,Gg,t);break}}onPageChanging({pageNumber:e}){Ie(this,Wg,e-1)}focusMainContainer(){D(this,Uu).focus()}findParent(e,t){for(const i of D(this,Cs).values()){const{x:c,y:a,width:l,height:r}=i.div.getBoundingClientRect();if(e>=c&&e<=c+l&&t>=a&&t<=a+r)return i}return null}disableUserSelect(e=!1){D(this,Hv).classList.toggle("noUserSelect",e)}addShouldRescale(e){D(this,Zd).add(e)}removeShouldRescale(e){D(this,Zd).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*fd.PDF_TO_CSS_UNITS;for(const i of D(this,Zd))i.onScaleChanging();(t=D(this,Kd))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:c,focusNode:a,focusOffset:l}=t,r=t.toString(),m=We(this,Xg,Mx).call(this,t).closest(".textLayer"),v=this.getSelectionBoxes(m);if(!v)return;t.empty();const g=We(this,Wv,u4).call(this,m),_=D(this,ds)===Yr.NONE,E=()=>{g==null||g.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:v,anchorNode:i,anchorOffset:c,focusNode:a,focusOffset:l,text:r}),_&&this.showAllEditors("highlight",!0,!0)};if(_){this.switchToMode(Yr.HIGHLIGHT,E);return}E()}addToAnnotationStorage(e){!e.isEmpty()&&D(this,Fu)&&!D(this,Fu).has(e.id)&&D(this,Fu).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,D(this,df)&&(Ie(this,df,!1),We(this,Zg,Cx).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of D(this,Ci))if(t.div.contains(e)){Ie(this,Yd,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!D(this,Yd))return;const[e,t]=D(this,Yd);Ie(this,Yd,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){We(this,Gv,h4).call(this),We(this,Kv,f4).call(this)}removeEditListeners(){We(this,cS,KR).call(this),We(this,Xv,d4).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of D(this,oc))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of D(this,oc))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=D(this,tl))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const c of D(this,Ci)){const a=c.serialize(!0);a&&t.push(a)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const l of D(this,oc))if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(a){ei(`paste: "${a.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const c=this.currentLayer;try{const a=[];for(const h of i){const m=await c.deserialize(h);if(!m)return;a.push(m)}const l=()=>{for(const h of a)We(this,Zv,p4).call(this,h);We(this,Yv,m4).call(this,a)},r=()=>{for(const h of a)h.remove()};this.addCommands({cmd:l,undo:r,mustExec:!0})}catch(a){ei(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),D(this,ds)!==Yr.NONE&&!this.isEditorHandlingKeyboard&&kg._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,D(this,df)&&(Ie(this,df,!1),We(this,Zg,Cx).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(We(this,aS,WR).call(this),We(this,Kv,f4).call(this),We(this,Is,ma).call(this,{isEditing:D(this,ds)!==Yr.NONE,isEmpty:We(this,ep,Db).call(this),hasSomethingToUndo:D(this,Il).hasSomethingToUndo(),hasSomethingToRedo:D(this,Il).hasSomethingToRedo(),hasSelectedEditor:!1})):(We(this,lS,GR).call(this),We(this,Xv,d4).call(this),We(this,Is,ma).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!D(this,oc)){Ie(this,oc,e);for(const t of D(this,oc))We(this,sc,Du).call(this,t.defaultPropertiesToUpdate)}}getId(){return D(this,rS).id}get currentLayer(){return D(this,Cs).get(D(this,Wg))}getLayer(e){return D(this,Cs).get(e)}get currentPageIndex(){return D(this,Wg)}addLayer(e){D(this,Cs).set(e.pageIndex,e),D(this,pf)?e.enable():e.disable()}removeLayer(e){D(this,Cs).delete(e.pageIndex)}async updateMode(e,t=null,i=!1){var c,a;if(D(this,ds)!==e&&!(D(this,Rl)&&(await D(this,Rl).promise,!D(this,Rl)))){if(Ie(this,Rl,Promise.withResolvers()),Ie(this,ds,e),e===Yr.NONE){this.setEditingState(!1),We(this,fS,YR).call(this),(c=this._editorUndoBar)==null||c.hide(),D(this,Rl).resolve();return}e===Yr.SIGNATURE&&await((a=D(this,yf))==null?void 0:a.loadSignatures()),this.setEditingState(!0),await We(this,hS,ZR).call(this),this.unselectAll();for(const l of D(this,Cs).values())l.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),D(this,Rl).resolve();return}for(const l of D(this,Yo).values())l.annotationElementId===t?(this.setSelected(l),l.enterInEditMode()):l.unselect();D(this,Rl).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==D(this,ds)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var i;if(D(this,oc)){switch(e){case _i.CREATE:this.currentLayer.addNewEditor(t);return;case _i.HIGHLIGHT_DEFAULT_COLOR:(i=D(this,Jd))==null||i.updateColor(t);break;case _i.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(D(this,Vv)||Ie(this,Vv,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const c of D(this,Ci))c.updateParams(e,t);for(const c of D(this,oc))c.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var a;for(const l of D(this,Yo).values())l.editorType===e&&l.show(t);(((a=D(this,Vv))==null?void 0:a.get(_i.HIGHLIGHT_SHOW_ALL))??!0)!==t&&We(this,sc,Du).call(this,[[_i.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(D(this,zv)!==e){Ie(this,zv,e);for(const t of D(this,Cs).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of D(this,Yo).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return D(this,Yo).get(e)}addEditor(e){D(this,Yo).set(e.id,e)}removeEditor(e){var t,i;e.div.contains(document.activeElement)&&(D(this,qc)&&clearTimeout(D(this,qc)),Ie(this,qc,setTimeout(()=>{this.focusMainContainer(),Ie(this,qc,null)},0))),D(this,Yo).delete(e.id),e.annotationElementId&&((t=D(this,gf))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!D(this,Xd).has(e.annotationElementId))&&((i=D(this,Fu))==null||i.remove(e.id))}addDeletedAnnotationElement(e){D(this,Xd).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return D(this,Xd).has(e)}removeDeletedAnnotationElement(e){D(this,Xd).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){D(this,tl)!==e&&(Ie(this,tl,e),e&&We(this,sc,Du).call(this,e.propertiesToUpdate))}updateUI(e){D(this,dS,JR)===e&&We(this,sc,Du).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){We(this,sc,Du).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(D(this,Ci).has(e)){D(this,Ci).delete(e),e.unselect(),We(this,Is,ma).call(this,{hasSelectedEditor:this.hasSelection});return}D(this,Ci).add(e),e.select(),We(this,sc,Du).call(this,e.propertiesToUpdate),We(this,Is,ma).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=D(this,Kd))==null||t.commitOrRemove();for(const i of D(this,Ci))i!==e&&i.unselect();D(this,Ci).clear(),D(this,Ci).add(e),e.select(),We(this,sc,Du).call(this,e.propertiesToUpdate),We(this,Is,ma).call(this,{hasSelectedEditor:!0})}isSelected(e){return D(this,Ci).has(e)}get firstSelectedEditor(){return D(this,Ci).values().next().value}unselect(e){e.unselect(),D(this,Ci).delete(e),We(this,Is,ma).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return D(this,Ci).size!==0}get isEnterHandled(){return D(this,Ci).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;D(this,Il).undo(),We(this,Is,ma).call(this,{hasSomethingToUndo:D(this,Il).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:We(this,ep,Db).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){D(this,Il).redo(),We(this,Is,ma).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:D(this,Il).hasSomethingToRedo(),isEmpty:We(this,ep,Db).call(this)})}addCommands(e){D(this,Il).add(e),We(this,Is,ma).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:We(this,ep,Db).call(this)})}cleanUndoStack(e){D(this,Il).cleanType(e)}delete(){var a;this.commitOrRemove();const e=(a=this.currentLayer)==null?void 0:a.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...D(this,Ci)],i=()=>{var l;(l=this._editorUndoBar)==null||l.show(c,t.length===1?t[0].editorType:t.length);for(const r of t)r.remove()},c=()=>{for(const l of t)We(this,Zv,p4).call(this,l)};this.addCommands({cmd:i,undo:c,mustExec:!0})}commitOrRemove(){var e;(e=D(this,tl))==null||e.commitOrRemove()}hasSomethingToControl(){return D(this,tl)||this.hasSelection}selectAll(){for(const e of D(this,Ci))e.commit();We(this,Yv,m4).call(this,D(this,Yo).values())}unselectAll(){var e;if(!(D(this,tl)&&(D(this,tl).commitOrRemove(),D(this,ds)!==Yr.NONE))&&!((e=D(this,Kd))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of D(this,Ci))t.unselect();D(this,Ci).clear(),We(this,Is,ma).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;D(this,bf)[0]+=e,D(this,bf)[1]+=t;const[c,a]=D(this,bf),l=[...D(this,Ci)],r=1e3;D(this,Wc)&&clearTimeout(D(this,Wc)),Ie(this,Wc,setTimeout(()=>{Ie(this,Wc,null),D(this,bf)[0]=D(this,bf)[1]=0,this.addCommands({cmd:()=>{for(const h of l)D(this,Yo).has(h.id)&&(h.translateInPage(c,a),h.translationDone())},undo:()=>{for(const h of l)D(this,Yo).has(h.id)&&(h.translateInPage(-c,-a),h.translationDone())},mustExec:!1})},r));for(const h of l)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Ie(this,Vc,new Map);for(const e of D(this,Ci))D(this,Vc).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!D(this,Vc))return!1;this.disableUserSelect(!1);const e=D(this,Vc);Ie(this,Vc,null);let t=!1;for(const[{x:c,y:a,pageIndex:l},r]of e)r.newX=c,r.newY=a,r.newPageIndex=l,t||(t=c!==r.savedX||a!==r.savedY||l!==r.savedPageIndex);if(!t)return!1;const i=(c,a,l,r)=>{if(D(this,Yo).has(c.id)){const h=D(this,Cs).get(r);h?c._setParentAndPosition(h,a,l):(c.pageIndex=r,c.x=a,c.y=l)}};return this.addCommands({cmd:()=>{for(const[c,{newX:a,newY:l,newPageIndex:r}]of e)i(c,a,l,r)},undo:()=>{for(const[c,{savedX:a,savedY:l,savedPageIndex:r}]of e)i(c,a,l,r)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(D(this,Vc))for(const i of D(this,Vc).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||D(this,Ci).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return D(this,tl)===e}getActive(){return D(this,tl)}getMode(){return D(this,ds)}get imageManager(){return di(this,"imageManager",new l4)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let m=0,v=t.rangeCount;m<v;m++)if(!e.contains(t.getRangeAt(m).commonAncestorContainer))return null;const{x:i,y:c,width:a,height:l}=e.getBoundingClientRect();let r;switch(e.getAttribute("data-main-rotation")){case"90":r=(m,v,g,_)=>({x:(v-c)/l,y:1-(m+g-i)/a,width:_/l,height:g/a});break;case"180":r=(m,v,g,_)=>({x:1-(m+g-i)/a,y:1-(v+_-c)/l,width:g/a,height:_/l});break;case"270":r=(m,v,g,_)=>({x:1-(v+_-c)/l,y:(m-i)/a,width:_/l,height:g/a});break;default:r=(m,v,g,_)=>({x:(m-i)/a,y:(v-c)/l,width:g/a,height:_/l});break}const h=[];for(let m=0,v=t.rangeCount;m<v;m++){const g=t.getRangeAt(m);if(!g.collapsed)for(const{x:_,y:E,width:b,height:p}of g.getClientRects())b===0||p===0||h.push(r(_,E,b,p))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(D(this,Hg)||Ie(this,Hg,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=D(this,Hg))==null||t.delete(e)}renderAnnotationElement(e){var c;const t=(c=D(this,Hg))==null?void 0:c.get(e.data.id);if(!t)return;const i=D(this,Fu).getRawValue(t);i&&(D(this,ds)===Yr.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){var a;const c=(a=D(this,gf))==null?void 0:a.get(e);c&&(c.setCanvas(t,i),D(this,gf).delete(e))}addMissingCanvas(e,t){(D(this,gf)||Ie(this,gf,new Map)).set(e,t)}};Vg=new WeakMap,tl=new WeakMap,Yo=new WeakMap,Cs=new WeakMap,qg=new WeakMap,Fu=new WeakMap,Hg=new WeakMap,Il=new WeakMap,hf=new WeakMap,Kd=new WeakMap,Wg=new WeakMap,Xd=new WeakMap,Vc=new WeakMap,oc=new WeakMap,Zd=new WeakMap,$v=new WeakMap,Bv=new WeakMap,Gg=new WeakMap,Fv=new WeakMap,qc=new WeakMap,ff=new WeakMap,Kg=new WeakMap,df=new WeakMap,Hc=new WeakMap,rS=new WeakMap,pf=new WeakMap,zv=new WeakMap,mf=new WeakMap,Yd=new WeakMap,Jd=new WeakMap,gf=new WeakMap,Uv=new WeakMap,ds=new WeakMap,Ci=new WeakMap,zu=new WeakMap,yf=new WeakMap,Qd=new WeakMap,Vv=new WeakMap,qv=new WeakMap,bf=new WeakMap,Wc=new WeakMap,Uu=new WeakMap,Hv=new WeakMap,Rl=new WeakMap,Xg=new WeakSet,Mx=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Wv=new WeakSet,u4=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of D(this,Cs).values())if(i.hasTextLayer(e))return i;return null},iS=new WeakSet,VR=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=We(this,Xg,Mx).call(this,e).closest(".textLayer"),c=this.getSelectionBoxes(i);c&&(D(this,Hc)||Ie(this,Hc,new Tq(this)),D(this,Hc).show(i,c,this.direction==="ltr"))},oS=new WeakSet,qR=function(){var a,l,r;const e=document.getSelection();if(!e||e.isCollapsed){D(this,zu)&&((a=D(this,Hc))==null||a.hide(),Ie(this,zu,null),We(this,Is,ma).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===D(this,zu))return;const c=We(this,Xg,Mx).call(this,e).closest(".textLayer");if(!c){D(this,zu)&&((l=D(this,Hc))==null||l.hide(),Ie(this,zu,null),We(this,Is,ma).call(this,{hasSelectedText:!1}));return}if((r=D(this,Hc))==null||r.hide(),Ie(this,zu,t),We(this,Is,ma).call(this,{hasSelectedText:!0}),!(D(this,ds)!==Yr.HIGHLIGHT&&D(this,ds)!==Yr.NONE)&&(D(this,ds)===Yr.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),Ie(this,df,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=D(this,ds)===Yr.HIGHLIGHT?We(this,Wv,u4).call(this,c):null;h==null||h.toggleDrawing();const m=new AbortController,v=this.combinedSignal(m),g=_=>{_.type==="pointerup"&&_.button!==0||(m.abort(),h==null||h.toggleDrawing(!0),_.type==="pointerup"&&We(this,Zg,Cx).call(this,"main_toolbar"))};window.addEventListener("pointerup",g,{signal:v}),window.addEventListener("blur",g,{signal:v})}},Zg=new WeakSet,Cx=function(e=""){D(this,ds)===Yr.HIGHLIGHT?this.highlightSelection(e):D(this,$v)&&We(this,iS,VR).call(this)},sS=new WeakSet,HR=function(){document.addEventListener("selectionchange",We(this,oS,qR).bind(this),{signal:this._signal})},aS=new WeakSet,WR=function(){if(D(this,ff))return;Ie(this,ff,new AbortController);const e=this.combinedSignal(D(this,ff));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},lS=new WeakSet,GR=function(){var e;(e=D(this,ff))==null||e.abort(),Ie(this,ff,null)},Gv=new WeakSet,h4=function(){if(D(this,mf))return;Ie(this,mf,new AbortController);const e=this.combinedSignal(D(this,mf));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},cS=new WeakSet,KR=function(){var e;(e=D(this,mf))==null||e.abort(),Ie(this,mf,null)},Kv=new WeakSet,f4=function(){if(D(this,hf))return;Ie(this,hf,new AbortController);const e=this.combinedSignal(D(this,hf));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Xv=new WeakSet,d4=function(){var e;(e=D(this,hf))==null||e.abort(),Ie(this,hf,null)},uS=new WeakSet,XR=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Is=new WeakSet,ma=function(e){Object.entries(e).some(([i,c])=>D(this,qv)[i]!==c)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(D(this,qv),e)}),D(this,ds)===Yr.HIGHLIGHT&&e.hasSelectedEditor===!1&&We(this,sc,Du).call(this,[[_i.HIGHLIGHT_FREE,!0]]))},sc=new WeakSet,Du=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},hS=new WeakSet,ZR=async function(){if(!D(this,pf)){Ie(this,pf,!0);const e=[];for(const t of D(this,Cs).values())e.push(t.enable());await Promise.all(e);for(const t of D(this,Yo).values())t.enable()}},fS=new WeakSet,YR=function(){if(this.unselectAll(),D(this,pf)){Ie(this,pf,!1);for(const e of D(this,Cs).values())e.disable();for(const e of D(this,Yo).values())e.disable()}},Zv=new WeakSet,p4=function(e){const t=D(this,Cs).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},dS=new WeakSet,JR=function(){let e=null;for(e of D(this,Ci));return e},ep=new WeakSet,Db=function(){if(D(this,Yo).size===0)return!0;if(D(this,Yo).size===1)for(const e of D(this,Yo).values())return e.isEmpty();return!1},Yv=new WeakSet,m4=function(e){for(const t of D(this,Ci))t.unselect();D(this,Ci).clear();for(const t of e)t.isEmpty()||(D(this,Ci).add(t),t.select());We(this,Is,ma).call(this,{hasSelectedEditor:this.hasSelection})},Or(kg,"TRANSLATE_SMALL",1),Or(kg,"TRANSLATE_BIG",10);let _m=kg;var ps,Gc,ac,Yg,Kc,nl,Jg,Xc,Ia,Vu,tp,Zc,vf,np,Lb,Qg,Ix;const ga=class ga{constructor(e){Pe(this,np);Pe(this,Qg);Pe(this,ps,null);Pe(this,Gc,!1);Pe(this,ac,null);Pe(this,Yg,null);Pe(this,Kc,null);Pe(this,nl,null);Pe(this,Jg,!1);Pe(this,Xc,null);Pe(this,Ia,null);Pe(this,Vu,null);Pe(this,tp,null);Pe(this,Zc,!1);Ie(this,Ia,e),Ie(this,Zc,e._uiManager.useNewAltTextFlow),D(ga,vf)||Ie(ga,vf,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){ga._l10n??(ga._l10n=e)}async render(){const e=Ie(this,ac,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=Ie(this,Yg,document.createElement("span"));e.append(t),D(this,Zc)?(e.classList.add("new"),e.setAttribute("data-l10n-id",D(ga,vf).missing),t.setAttribute("data-l10n-id",D(ga,vf)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=D(this,Ia)._uiManager._signal;e.addEventListener("contextmenu",Ac,{signal:i}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const c=a=>{a.preventDefault(),D(this,Ia)._uiManager.editAltText(D(this,Ia)),D(this,Zc)&&D(this,Ia)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:D(this,np,Lb)}})};return e.addEventListener("click",c,{capture:!0,signal:i}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(Ie(this,Jg,!0),c(a))},{signal:i}),await We(this,Qg,Ix).call(this),e}finish(){D(this,ac)&&(D(this,ac).focus({focusVisible:D(this,Jg)}),Ie(this,Jg,!1))}isEmpty(){return D(this,Zc)?D(this,ps)===null:!D(this,ps)&&!D(this,Gc)}hasData(){return D(this,Zc)?D(this,ps)!==null||!!D(this,Vu):this.isEmpty()}get guessedText(){return D(this,Vu)}async setGuessedText(e){D(this,ps)===null&&(Ie(this,Vu,e),Ie(this,tp,await ga._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),We(this,Qg,Ix).call(this))}toggleAltTextBadge(e=!1){var t;if(!D(this,Zc)||D(this,ps)){(t=D(this,Xc))==null||t.remove(),Ie(this,Xc,null);return}if(!D(this,Xc)){const i=Ie(this,Xc,document.createElement("div"));i.className="noAltTextBadge",D(this,Ia).div.append(i)}D(this,Xc).classList.toggle("hidden",!e)}serialize(e){let t=D(this,ps);return!e&&D(this,Vu)===t&&(t=D(this,tp)),{altText:t,decorative:D(this,Gc),guessedText:D(this,Vu),textWithDisclaimer:D(this,tp)}}get data(){return{altText:D(this,ps),decorative:D(this,Gc)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:c,cancel:a=!1}){i&&(Ie(this,Vu,i),Ie(this,tp,c)),!(D(this,ps)===e&&D(this,Gc)===t)&&(a||(Ie(this,ps,e),Ie(this,Gc,t)),We(this,Qg,Ix).call(this))}toggle(e=!1){D(this,ac)&&(!e&&D(this,nl)&&(clearTimeout(D(this,nl)),Ie(this,nl,null)),D(this,ac).disabled=!e)}shown(){D(this,Ia)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:D(this,np,Lb)}})}destroy(){var e,t;(e=D(this,ac))==null||e.remove(),Ie(this,ac,null),Ie(this,Yg,null),Ie(this,Kc,null),(t=D(this,Xc))==null||t.remove(),Ie(this,Xc,null)}};ps=new WeakMap,Gc=new WeakMap,ac=new WeakMap,Yg=new WeakMap,Kc=new WeakMap,nl=new WeakMap,Jg=new WeakMap,Xc=new WeakMap,Ia=new WeakMap,Vu=new WeakMap,tp=new WeakMap,Zc=new WeakMap,vf=new WeakMap,np=new WeakSet,Lb=function(){return D(this,ps)&&"added"||D(this,ps)===null&&this.guessedText&&"review"||"missing"},Qg=new WeakSet,Ix=async function(){var c,a,l;const e=D(this,ac);if(!e)return;if(D(this,Zc)){if(e.classList.toggle("done",!!D(this,ps)),e.setAttribute("data-l10n-id",D(ga,vf)[D(this,np,Lb)]),(c=D(this,Yg))==null||c.setAttribute("data-l10n-id",D(ga,vf)[`${D(this,np,Lb)}-label`]),!D(this,ps)){(a=D(this,Kc))==null||a.remove();return}}else{if(!D(this,ps)&&!D(this,Gc)){e.classList.remove("done"),(l=D(this,Kc))==null||l.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=D(this,Kc);if(!t){Ie(this,Kc,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${D(this,Ia).id}`;const r=100,h=D(this,Ia)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(D(this,nl)),Ie(this,nl,null)},{once:!0}),e.addEventListener("mouseenter",()=>{Ie(this,nl,setTimeout(()=>{Ie(this,nl,null),D(this,Kc).classList.add("show"),D(this,Ia)._reportTelemetry({action:"alt_text_tooltip"})},r))},{signal:h}),e.addEventListener("mouseleave",()=>{var m;D(this,nl)&&(clearTimeout(D(this,nl)),Ie(this,nl,null)),(m=D(this,Kc))==null||m.classList.remove("show")},{signal:h})}D(this,Gc)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=D(this,ps)),t.parentNode||e.append(t);const i=D(this,Ia).getElementForAltText();i==null||i.setAttribute("aria-describedby",t.id)},Pe(ga,vf,null),Or(ga,"_l10n",null);let F2=ga;var ey,rp,Jv,Qv,e1,t1,n1,qu,ip,Hu,op,_f,pS,QR,mS,e7,gS,t7;const nk=class nk{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:c=null,onPinching:a=null,onPinchEnd:l=null,signal:r}){Pe(this,pS);Pe(this,mS);Pe(this,gS);Pe(this,ey,void 0);Pe(this,rp,!1);Pe(this,Jv,null);Pe(this,Qv,void 0);Pe(this,e1,void 0);Pe(this,t1,void 0);Pe(this,n1,void 0);Pe(this,qu,null);Pe(this,ip,void 0);Pe(this,Hu,null);Pe(this,op,void 0);Pe(this,_f,null);Ie(this,ey,e),Ie(this,Jv,i),Ie(this,Qv,t),Ie(this,e1,c),Ie(this,t1,a),Ie(this,n1,l),Ie(this,op,new AbortController),Ie(this,ip,AbortSignal.any([r,D(this,op).signal])),e.addEventListener("touchstart",We(this,pS,QR).bind(this),{passive:!1,signal:D(this,ip)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/kh.pixelRatio}destroy(){var e,t;(e=D(this,op))==null||e.abort(),Ie(this,op,null),(t=D(this,qu))==null||t.abort(),Ie(this,qu,null)}};ey=new WeakMap,rp=new WeakMap,Jv=new WeakMap,Qv=new WeakMap,e1=new WeakMap,t1=new WeakMap,n1=new WeakMap,qu=new WeakMap,ip=new WeakMap,Hu=new WeakMap,op=new WeakMap,_f=new WeakMap,pS=new WeakSet,QR=function(e){var c,a,l;if((c=D(this,Qv))!=null&&c.call(this))return;if(e.touches.length===1){if(D(this,qu))return;const r=Ie(this,qu,new AbortController),h=AbortSignal.any([D(this,ip),r.signal]),m=D(this,ey),v={capture:!0,signal:h,passive:!1},g=_=>{var E;_.pointerType==="touch"&&((E=D(this,qu))==null||E.abort(),Ie(this,qu,null))};m.addEventListener("pointerdown",_=>{_.pointerType==="touch"&&(Fo(_),g(_))},v),m.addEventListener("pointerup",g,v),m.addEventListener("pointercancel",g,v);return}if(!D(this,_f)){Ie(this,_f,new AbortController);const r=AbortSignal.any([D(this,ip),D(this,_f).signal]),h=D(this,ey),m={signal:r,capture:!1,passive:!1};h.addEventListener("touchmove",We(this,mS,e7).bind(this),m);const v=We(this,gS,t7).bind(this);h.addEventListener("touchend",v,m),h.addEventListener("touchcancel",v,m),m.capture=!0,h.addEventListener("pointerdown",Fo,m),h.addEventListener("pointermove",Fo,m),h.addEventListener("pointercancel",Fo,m),h.addEventListener("pointerup",Fo,m),(a=D(this,e1))==null||a.call(this)}if(Fo(e),e.touches.length!==2||(l=D(this,Jv))!=null&&l.call(this)){Ie(this,Hu,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),Ie(this,Hu,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},mS=new WeakSet,e7=function(e){var A;if(!D(this,Hu)||e.touches.length!==2)return;Fo(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:c,screenY:a}=t,{screenX:l,screenY:r}=i,h=D(this,Hu),{touch0X:m,touch0Y:v,touch1X:g,touch1Y:_}=h,E=g-m,b=_-v,p=l-c,x=r-a,y=Math.hypot(p,x)||1,f=Math.hypot(E,b)||1;if(!D(this,rp)&&Math.abs(f-y)<=nk.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=c,h.touch0Y=a,h.touch1X=l,h.touch1Y=r,!D(this,rp)){Ie(this,rp,!0);return}const w=[(c+l)/2,(a+r)/2];(A=D(this,t1))==null||A.call(this,w,f,y)},gS=new WeakSet,t7=function(e){var t;e.touches.length>=2||(D(this,_f).abort(),Ie(this,_f,null),(t=D(this,n1))==null||t.call(this),D(this,Hu)&&(Fo(e),Ie(this,Hu,null),Ie(this,rp,!1)))};let z2=nk;var sp,lc,Yi,ty,wf,r1,ap,Rs,lp,Wu,xf,i1,cp,rl,o1,up,Gu,Yc,ny,ry,Dl,hp,s1,yS,a1,g4,l1,y4,iy,Rx,bS,n7,vS,r7,c1,b4,oy,Dx,u1,v4,_S,i7,wS,o7,xS,s7,h1,_4,SS,a7,f1,w4,ES,l7,AS,c7,kS,u7,d1,x4,fp,jb;const ii=class ii{constructor(e){Pe(this,a1);Pe(this,iy);Pe(this,bS);Pe(this,vS);Pe(this,c1);Pe(this,oy);Pe(this,u1);Pe(this,_S);Pe(this,wS);Pe(this,xS);Pe(this,h1);Pe(this,SS);Pe(this,f1);Pe(this,ES);Pe(this,AS);Pe(this,kS);Pe(this,d1);Pe(this,fp);Pe(this,sp,null);Pe(this,lc,null);Pe(this,Yi,null);Pe(this,ty,!1);Pe(this,wf,null);Pe(this,r1,"");Pe(this,ap,!1);Pe(this,Rs,null);Pe(this,lp,null);Pe(this,Wu,null);Pe(this,xf,null);Pe(this,i1,"");Pe(this,cp,!1);Pe(this,rl,null);Pe(this,o1,!1);Pe(this,up,!1);Pe(this,Gu,!1);Pe(this,Yc,null);Pe(this,ny,0);Pe(this,ry,0);Pe(this,Dl,null);Pe(this,hp,null);Or(this,"_isCopy",!1);Or(this,"_editToolbar",null);Or(this,"_initialOptions",Object.create(null));Or(this,"_initialData",null);Or(this,"_isVisible",!0);Or(this,"_uiManager",null);Or(this,"_focusEventsAllowed",!0);Pe(this,s1,!1);Pe(this,yS,ii._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:c,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,c],this.pageTranslation=[a,l];const[r,h]=this.parentDimensions;this.x=e.x/r,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ii.prototype._resizeWithKeyboard,t=_m.TRANSLATE_SMALL,i=_m.TRANSLATE_BIG;return di(this,"_resizerKeyboardManager",new tw([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],ii.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return di(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Cq({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ii._l10n??(ii._l10n=e),ii._l10nResizer||(ii._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ii._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);ii._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){zi("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return D(this,s1)}set _isDraggable(e){var t;Ie(this,s1,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=D(this,yS)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):We(this,fp,jb).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(D(this,cp)?Ie(this,cp,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,c){const[a,l]=this.parentDimensions;[i,c]=this.screenToPageTranslation(i,c),this.x=(e+i)/a,this.y=(t+c)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,c]=this.parentDimensions;this.setAt(e*i,t*c,this.width*i,this.height*c),this._onTranslated()}translate(e,t){We(this,a1,g4).call(this,this.parentDimensions,e,t)}translateInPage(e,t){D(this,rl)||Ie(this,rl,[this.x,this.y,this.width,this.height]),We(this,a1,g4).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){D(this,rl)||Ie(this,rl,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[c,a]}=this;if(this.x+=e/c,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:_}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,_)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:r}=this;const[h,m]=this.getBaseTranslation();l+=h,r+=m;const{style:v}=i;v.left=`${(100*l).toFixed(2)}%`,v.top=`${(100*r).toFixed(2)}%`,this._onTranslating(l,r),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!D(this,rl)&&(D(this,rl)[0]!==this.x||D(this,rl)[1]!==this.y)}get _hasBeenResized(){return!!D(this,rl)&&(D(this,rl)[2]!==this.width||D(this,rl)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=ii,c=i/e,a=i/t;switch(this.rotation){case 90:return[-c,a];case 180:return[c,a];case 270:return[c,-a];default:return[-c,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,c]}=this;let{x:a,y:l,width:r,height:h}=this;if(r*=i,h*=c,a*=i,l*=c,this._mustFixPosition)switch(e){case 0:a=gl(a,0,i-r),l=gl(l,0,c-h);break;case 90:a=gl(a,0,i-h),l=gl(l,r,c);break;case 180:a=gl(a,r,i),l=gl(l,h,c);break;case 270:a=gl(a,h,i),l=gl(l,0,c-r);break}this.x=a/=i,this.y=l/=c;const[m,v]=this.getBaseTranslation();a+=m,l+=v,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return We(i=ii,l1,y4).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return We(i=ii,l1,y4).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,c]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*e/i).toFixed(2)}%`,D(this,ap)||(a.height=`${(100*t/c).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,c=i.endsWith("%"),a=!D(this,ap)&&t.endsWith("%");if(c&&a)return;const[l,r]=this.parentDimensions;c||(e.width=`${(100*parseFloat(i)/l).toFixed(2)}%`),!D(this,ap)&&!a&&(e.height=`${(100*parseFloat(t)/r).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=D(this,Yi))==null||e.finish()}async addEditToolbar(){return this._editToolbar||D(this,up)?this._editToolbar:(this._editToolbar=new a4(this),this.div.append(this._editToolbar.render()),D(this,Yi)&&await this._editToolbar.addAltText(D(this,Yi)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=D(this,Yi))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){D(this,Yi)||(F2.initialize(ii._l10n),Ie(this,Yi,new F2(this)),D(this,sp)&&(D(this,Yi).data=D(this,sp),Ie(this,sp,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=D(this,Yi))==null?void 0:e.data}set altTextData(e){D(this,Yi)&&(D(this,Yi).data=e)}get guessedAltText(){var e;return(e=D(this,Yi))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=D(this,Yi))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=D(this,Yi))==null?void 0:t.serialize(e)}hasAltText(){return!!D(this,Yi)&&!D(this,Yi).isEmpty()}hasAltTextData(){var e;return((e=D(this,Yi))==null?void 0:e.hasData())??!1}render(){var l;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=D(this,ty)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),We(this,f1,w4).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[c,a]=this.getInitialTranslation();return this.translate(c,a),U8(this,e,["keydown","pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(D(this,hp)||Ie(this,hp,new z2({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:We(this,_S,i7).bind(this),onPinching:We(this,wS,o7).bind(this),onPinchEnd:We(this,xS,s7).bind(this),signal:this._uiManager._signal}))),(l=this._uiManager._editorUndoBar)==null||l.hide(),e}pointerdown(e){const{isMac:t}=Bs.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(Ie(this,cp,!0),this._isDraggable){We(this,SS,a7).call(this,e);return}We(this,h1,_4).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){D(this,Yc)&&clearTimeout(D(this,Yc)),Ie(this,Yc,setTimeout(()=>{var e;Ie(this,Yc,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const c=this.parentScale,[a,l]=this.pageDimensions,[r,h]=this.pageTranslation,m=e/c,v=t/c,g=this.x*a,_=this.y*l,E=this.width*a,b=this.height*l;switch(i){case 0:return[g+m+r,l-_-v-b+h,g+m+E+r,l-_-v+h];case 90:return[g+v+r,l-_+m+h,g+v+b+r,l-_+m+E+h];case 180:return[g-m-E+r,l-_+v+h,g-m+r,l-_+v+b+h];case 270:return[g-v-b+r,l-_-m-E+h,g-v+r,l-_-m+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,c,a,l]=e,r=a-i,h=l-c;switch(this.rotation){case 0:return[i,t-l,r,h];case 90:return[i,t-c,h,r];case 180:return[a,t-c,r,h];case 270:return[a,t-l,h,r];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){Ie(this,up,!0)}disableEditMode(){Ie(this,up,!1)}isInEditMode(){return D(this,up)}shouldGetKeyboardEvents(){return D(this,Gu)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:c}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return t<l&&c>0&&e<a&&i>0}rebuild(){We(this,f1,w4).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){zi("An editor must be serializable")}static async deserialize(e,t,i){const c=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});c.rotation=e.rotation,Ie(c,sp,e.accessibilityData),c._isCopy=e.isCopy||!1;const[a,l]=c.pageDimensions,[r,h,m,v]=c.getRectInCurrentCoords(e.rect,l);return c.x=r/a,c.y=h/l,c.width=m/a,c.height=v/l,c}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=D(this,xf))==null||e.abort(),Ie(this,xf,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),D(this,Yc)&&(clearTimeout(D(this,Yc)),Ie(this,Yc,null)),We(this,fp,jb).call(this),this.removeEditToolbar(),D(this,Dl)){for(const i of D(this,Dl).values())clearTimeout(i);Ie(this,Dl,null)}this.parent=null,(t=D(this,hp))==null||t.destroy(),Ie(this,hp,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(We(this,bS,n7).call(this),D(this,Rs).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),Ie(this,Wu,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=D(this,Rs).children;if(!D(this,lc)){Ie(this,lc,Array.from(t));const l=We(this,ES,l7).bind(this),r=We(this,AS,c7).bind(this),h=this._uiManager._signal;for(const m of D(this,lc)){const v=m.getAttribute("data-resizer-name");m.setAttribute("role","spinbutton"),m.addEventListener("keydown",l,{signal:h}),m.addEventListener("blur",r,{signal:h}),m.addEventListener("focus",We(this,kS,u7).bind(this,v),{signal:h}),m.setAttribute("data-l10n-id",ii._l10nResizer[v])}}const i=D(this,lc)[0];let c=0;for(const l of t){if(l===i)break;c++}const a=(360-this.rotation+this.parentRotation)%360/90*(D(this,lc).length/4);if(a!==c){if(a<c)for(let r=0;r<c-a;r++)D(this,Rs).append(D(this,Rs).firstChild);else if(a>c)for(let r=0;r<a-c;r++)D(this,Rs).firstChild.before(D(this,Rs).lastChild);let l=0;for(const r of t){const m=D(this,lc)[l++].getAttribute("data-resizer-name");r.setAttribute("data-l10n-id",ii._l10nResizer[m])}}We(this,d1,x4).call(this,0),Ie(this,Gu,!0),D(this,Rs).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){D(this,Gu)&&We(this,u1,v4).call(this,D(this,i1),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){We(this,fp,jb).call(this),this.div.focus()}select(){var e,t,i;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var c,a;(c=this.div)!=null&&c.classList.contains("selectedEditor")&&((a=this._editToolbar)==null||a.show())});return}(t=this._editToolbar)==null||t.show(),(i=D(this,Yi))==null||i.toggleAltTextBadge(!1)}unselect(){var e,t,i,c,a;(e=D(this,Rs))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(c=this._editToolbar)==null||c.hide(),(a=D(this,Yi))==null||a.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return D(this,o1)}set isEditing(e){Ie(this,o1,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){Ie(this,ap,!0);const i=e/t,{style:c}=this.div;c.aspectRatio=i,c.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){D(this,Dl)||Ie(this,Dl,new Map);const{action:i}=e;let c=D(this,Dl).get(i);c&&clearTimeout(c),c=setTimeout(()=>{this._reportTelemetry(e),D(this,Dl).delete(i),D(this,Dl).size===0&&Ie(this,Dl,null)},ii._telemetryTimeout),D(this,Dl).set(i,c);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),Ie(this,ty,!1)}disable(){this.div&&(this.div.tabIndex=-1),Ie(this,ty,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};sp=new WeakMap,lc=new WeakMap,Yi=new WeakMap,ty=new WeakMap,wf=new WeakMap,r1=new WeakMap,ap=new WeakMap,Rs=new WeakMap,lp=new WeakMap,Wu=new WeakMap,xf=new WeakMap,i1=new WeakMap,cp=new WeakMap,rl=new WeakMap,o1=new WeakMap,up=new WeakMap,Gu=new WeakMap,Yc=new WeakMap,ny=new WeakMap,ry=new WeakMap,Dl=new WeakMap,hp=new WeakMap,s1=new WeakMap,yS=new WeakMap,a1=new WeakSet,g4=function([e,t],i,c){[i,c]=this.screenToPageTranslation(i,c),this.x+=i/e,this.y+=c/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},l1=new WeakSet,y4=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},iy=new WeakSet,Rx=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},bS=new WeakSet,n7=function(){if(D(this,Rs))return;Ie(this,Rs,document.createElement("div")),D(this,Rs).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const c=document.createElement("div");D(this,Rs).append(c),c.classList.add("resizer",i),c.setAttribute("data-resizer-name",i),c.addEventListener("pointerdown",We(this,vS,r7).bind(this,i),{signal:t}),c.addEventListener("contextmenu",Ac,{signal:t}),c.tabIndex=-1}this.div.prepend(D(this,Rs))},vS=new WeakSet,r7=function(e,t){var v;t.preventDefault();const{isMac:i}=Bs.platform;if(t.button!==0||t.ctrlKey&&i)return;(v=D(this,Yi))==null||v.toggle(!1);const c=this._isDraggable;this._isDraggable=!1,Ie(this,lp,[t.screenX,t.screenY]);const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",We(this,u1,v4).bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Fo,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ac,{signal:l}),Ie(this,Wu,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const r=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const m=()=>{var g;a.abort(),this.parent.togglePointerEvents(!0),(g=D(this,Yi))==null||g.toggle(!0),this._isDraggable=c,this.parent.div.style.cursor=r,this.div.style.cursor=h,We(this,oy,Dx).call(this)};window.addEventListener("pointerup",m,{signal:l}),window.addEventListener("blur",m,{signal:l})},c1=new WeakSet,b4=function(e,t,i,c){this.width=i,this.height=c,this.x=e,this.y=t;const[a,l]=this.parentDimensions;this.setDims(a*i,l*c),this.fixAndSetPosition(),this._onResized()},oy=new WeakSet,Dx=function(){if(!D(this,Wu))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:c}=D(this,Wu);Ie(this,Wu,null);const a=this.x,l=this.y,r=this.width,h=this.height;a===e&&l===t&&r===i&&h===c||this.addCommands({cmd:We(this,c1,b4).bind(this,a,l,r,h),undo:We(this,c1,b4).bind(this,e,t,i,c),mustExec:!0})},u1=new WeakSet,v4=function(e,t){const[i,c]=this.parentDimensions,a=this.x,l=this.y,r=this.width,h=this.height,m=ii.MIN_SIZE/i,v=ii.MIN_SIZE/c,g=We(this,iy,Rx).call(this,this.rotation),_=(de,be)=>[g[0]*de+g[2]*be,g[1]*de+g[3]*be],E=We(this,iy,Rx).call(this,360-this.rotation),b=(de,be)=>[E[0]*de+E[2]*be,E[1]*de+E[3]*be];let p,x,y=!1,f=!1;switch(e){case"topLeft":y=!0,p=(de,be)=>[0,0],x=(de,be)=>[de,be];break;case"topMiddle":p=(de,be)=>[de/2,0],x=(de,be)=>[de/2,be];break;case"topRight":y=!0,p=(de,be)=>[de,0],x=(de,be)=>[0,be];break;case"middleRight":f=!0,p=(de,be)=>[de,be/2],x=(de,be)=>[0,be/2];break;case"bottomRight":y=!0,p=(de,be)=>[de,be],x=(de,be)=>[0,0];break;case"bottomMiddle":p=(de,be)=>[de/2,be],x=(de,be)=>[de/2,0];break;case"bottomLeft":y=!0,p=(de,be)=>[0,be],x=(de,be)=>[de,0];break;case"middleLeft":f=!0,p=(de,be)=>[0,be/2],x=(de,be)=>[de,be/2];break}const w=p(r,h),A=x(r,h);let P=_(...A);const T=ii._round(a+P[0]),R=ii._round(l+P[1]);let M=1,L=1,W,G;if(t.fromKeyboard)({deltaX:W,deltaY:G}=t);else{const{screenX:de,screenY:be}=t,[pe,U]=D(this,lp);[W,G]=this.screenToPageTranslation(de-pe,be-U),D(this,lp)[0]=de,D(this,lp)[1]=be}if([W,G]=b(W/i,G/c),y){const de=Math.hypot(r,h);M=L=Math.max(Math.min(Math.hypot(A[0]-w[0]-W,A[1]-w[1]-G)/de,1/r,1/h),m/r,v/h)}else f?M=Math.max(m,Math.min(1,Math.abs(A[0]-w[0]-W)))/r:L=Math.max(v,Math.min(1,Math.abs(A[1]-w[1]-G)))/h;const re=ii._round(r*M),Q=ii._round(h*L);P=_(...x(re,Q));const oe=T-P[0],ae=R-P[1];D(this,rl)||Ie(this,rl,[this.x,this.y,this.width,this.height]),this.width=re,this.height=Q,this.x=oe,this.y=ae,this.setDims(i*re,c*Q),this.fixAndSetPosition(),this._onResizing()},_S=new WeakSet,i7=function(){var e;Ie(this,Wu,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=D(this,Yi))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},wS=new WeakSet,o7=function(e,t,i){let a=.7*(i/t)+1-.7;if(a===1)return;const l=We(this,iy,Rx).call(this,this.rotation),r=(T,R)=>[l[0]*T+l[2]*R,l[1]*T+l[3]*R],[h,m]=this.parentDimensions,v=this.x,g=this.y,_=this.width,E=this.height,b=ii.MIN_SIZE/h,p=ii.MIN_SIZE/m;a=Math.max(Math.min(a,1/_,1/E),b/_,p/E);const x=ii._round(_*a),y=ii._round(E*a);if(x===_&&y===E)return;D(this,rl)||Ie(this,rl,[v,g,_,E]);const f=r(_/2,E/2),w=ii._round(v+f[0]),A=ii._round(g+f[1]),P=r(x/2,y/2);this.x=w-P[0],this.y=A-P[1],this.width=x,this.height=y,this.setDims(h*x,m*y),this.fixAndSetPosition(),this._onResizing()},xS=new WeakSet,s7=function(){var e;(e=D(this,Yi))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),We(this,oy,Dx).call(this)},h1=new WeakSet,_4=function(e){const{isMac:t}=Bs.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},SS=new WeakSet,a7=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const c=new AbortController,a=this._uiManager.combinedSignal(c),l={capture:!0,passive:!1,signal:a},r=m=>{c.abort(),Ie(this,wf,null),Ie(this,cp,!1),this._uiManager.endDragSession()||We(this,h1,_4).call(this,m),i&&this._onStopDragging()};t&&(Ie(this,ny,e.clientX),Ie(this,ry,e.clientY),Ie(this,wf,e.pointerId),Ie(this,r1,e.pointerType),window.addEventListener("pointermove",m=>{i||(i=!0,this._onStartDragging());const{clientX:v,clientY:g,pointerId:_}=m;if(_!==D(this,wf)){Fo(m);return}const[E,b]=this.screenToPageTranslation(v-D(this,ny),g-D(this,ry));Ie(this,ny,v),Ie(this,ry,g),this._uiManager.dragSelectedEditors(E,b)},l),window.addEventListener("touchmove",Fo,l),window.addEventListener("pointerdown",m=>{m.pointerType===D(this,r1)&&(D(this,hp)||m.isPrimary)&&r(m),Fo(m)},l));const h=m=>{if(!D(this,wf)||D(this,wf)===m.pointerId){r(m);return}Fo(m)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})},f1=new WeakSet,w4=function(){if(D(this,xf)||!this.div)return;Ie(this,xf,new AbortController);const e=this._uiManager.combinedSignal(D(this,xf));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},ES=new WeakSet,l7=function(e){ii._resizerKeyboardManager.exec(this,e)},AS=new WeakSet,c7=function(e){var t;D(this,Gu)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==D(this,Rs)&&We(this,fp,jb).call(this)},kS=new WeakSet,u7=function(e){Ie(this,i1,D(this,Gu)?e:"")},d1=new WeakSet,x4=function(e){if(D(this,lc))for(const t of D(this,lc))t.tabIndex=e},fp=new WeakSet,jb=function(){Ie(this,Gu,!1),We(this,d1,x4).call(this,-1),We(this,oy,Dx).call(this)},Pe(ii,l1),Or(ii,"_l10n",null),Or(ii,"_l10nResizer",null),Or(ii,"_borderLineWidth",-1),Or(ii,"_colorManager",new c4),Or(ii,"_zIndex",1),Or(ii,"_telemetryTimeout",1e3);let so=ii;class Cq extends so{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const DO=3285377520,Ml=4294901760,Fc=65535;class h7{constructor(e){this.h1=e?e&4294967295:DO,this.h2=e?e&4294967295:DO}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let p=0,x=e.length;p<x;p++){const y=e.charCodeAt(p);y<=255?t[i++]=y:(t[i++]=y>>>8,t[i++]=y&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const c=i>>2,a=i-c*4,l=new Uint32Array(t.buffer,0,c);let r=0,h=0,m=this.h1,v=this.h2;const g=3432918353,_=461845907,E=g&Fc,b=_&Fc;for(let p=0;p<c;p++)p&1?(r=l[p],r=r*g&Ml|r*E&Fc,r=r<<15|r>>>17,r=r*_&Ml|r*b&Fc,m^=r,m=m<<13|m>>>19,m=m*5+3864292196):(h=l[p],h=h*g&Ml|h*E&Fc,h=h<<15|h>>>17,h=h*_&Ml|h*b&Fc,v^=h,v=v<<13|v>>>19,v=v*5+3864292196);switch(r=0,a){case 3:r^=t[c*4+2]<<16;case 2:r^=t[c*4+1]<<8;case 1:r^=t[c*4],r=r*g&Ml|r*E&Fc,r=r<<15|r>>>17,r=r*_&Ml|r*b&Fc,c&1?m^=r:v^=r}this.h1=m,this.h2=v}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ml|e*36045&Fc,t=t*4283543511&Ml|((t<<16|e>>>16)*2950163797&Ml)>>>16,e^=t>>>1,e=e*444984403&Ml|e*60499&Fc,t=t*3301882366&Ml|((t<<16|e>>>16)*3120437893&Ml)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const S4=Object.freeze({map:null,hash:"",transfer:void 0});var dp,pp,ms,PS,f7;class V8{constructor(){Pe(this,PS);Pe(this,dp,!1);Pe(this,pp,null);Pe(this,ms,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=D(this,ms).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return D(this,ms).get(e)}remove(e){if(D(this,ms).delete(e),D(this,ms).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of D(this,ms).values())if(t instanceof so)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=D(this,ms).get(e);let c=!1;if(i!==void 0)for(const[a,l]of Object.entries(t))i[a]!==l&&(c=!0,i[a]=l);else c=!0,D(this,ms).set(e,t);c&&We(this,PS,f7).call(this),t instanceof so&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return D(this,ms).has(e)}getAll(){return D(this,ms).size>0?j8(D(this,ms)):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return D(this,ms).size}resetModified(){D(this,dp)&&(Ie(this,dp,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new d7(this)}get serializable(){if(D(this,ms).size===0)return S4;const e=new Map,t=new h7,i=[],c=Object.create(null);let a=!1;for(const[l,r]of D(this,ms)){const h=r instanceof so?r.serialize(!1,c):r;h&&(e.set(l,h),t.update(`${l}:${JSON.stringify(h)}`),a||(a=!!h.bitmap))}if(a)for(const l of e.values())l.bitmap&&i.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:S4}get editorStats(){let e=null;const t=new Map;for(const i of D(this,ms).values()){if(!(i instanceof so))continue;const c=i.telemetryFinalData;if(!c)continue;const{type:a}=c;t.has(a)||t.set(a,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const l=e[a]||(e[a]=new Map);for(const[r,h]of Object.entries(c)){if(r==="type")continue;let m=l.get(r);m||(m=new Map,l.set(r,m));const v=m.get(h)??0;m.set(h,v+1)}}for(const[i,c]of t)e[i]=c.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){Ie(this,pp,null)}get modifiedIds(){if(D(this,pp))return D(this,pp);const e=[];for(const t of D(this,ms).values())!(t instanceof so)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return Ie(this,pp,{ids:new Set(e),hash:e.join(",")})}}dp=new WeakMap,pp=new WeakMap,ms=new WeakMap,PS=new WeakSet,f7=function(){D(this,dp)||(Ie(this,dp,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var p1;class d7 extends V8{constructor(t){super();Pe(this,p1,void 0);const{map:i,hash:c,transfer:a}=t.serializable,l=structuredClone(i,a?{transfer:a}:null);Ie(this,p1,{map:l,hash:c,transfer:a})}get print(){zi("Should not call PrintAnnotationStorage.print")}get serializable(){return D(this,p1)}get modifiedIds(){return di(this,"modifiedIds",{ids:new Set,hash:""})}}p1=new WeakMap;var sy;class Iq{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){Pe(this,sy,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),D(this,sy).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||D(this,sy).has(e.loadedName))){if(Uo(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:c,src:a,style:l}=e,r=new FontFace(c,a,l);this.addNativeFontFace(r);try{await r.load(),D(this,sy).add(c),i==null||i(e)}catch{ei(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}return}zi("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(c){throw ei(`Failed to load font '${i.family}': '${c}'.`),e.disableFontFace=!0,c}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const c=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,c)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return di(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return di(this,"isSyncFontLoadingSupported",Ns||Bs.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Uo(!c.done,"completeRequest() cannot be called twice."),c.done=!0;i.length>0&&i[0].done;){const a=i.shift();setTimeout(a.callback,0)}}const{loadingRequests:i}=this,c={done:!1,complete:t,callback:e};return i.push(c),c}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return di(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(A,P){return A.charCodeAt(P)<<24|A.charCodeAt(P+1)<<16|A.charCodeAt(P+2)<<8|A.charCodeAt(P+3)&255}function c(A,P,T,R){const M=A.substring(0,P),L=A.substring(P+T);return M+R+L}let a,l;const r=this._document.createElement("canvas");r.width=1,r.height=1;const h=r.getContext("2d");let m=0;function v(A,P){if(++m>30){ei("Load test font never loaded."),P();return}if(h.font="30px "+A,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){P();return}setTimeout(v.bind(null,A,P))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let _=this._loadTestFont;_=c(_,976,g.length,g);const b=16,p=1482184792;let x=i(_,b);for(a=0,l=g.length-3;a<l;a+=4)x=x-p+i(g,a)|0;a<g.length&&(x=x-p+i(g+"XXX",a)|0),_=c(_,b,4,yq(x));const y=`url(data:font/opentype;base64,${btoa(_)});`,f=`@font-face {font-family:"${g}";src:${y}}`;this.insertRule(f);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const A of[e.loadedName,g]){const P=this._document.createElement("span");P.textContent="Hi",P.style.fontFamily=A,w.append(P)}this._document.body.append(w),v(g,()=>{w.remove(),t.complete()})}}sy=new WeakMap;class Rq{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${DR(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let c=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(c+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${c}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let c;try{c=e.get(i)}catch(l){ei(`getPathGenerator - ignoring character: "${l}".`)}const a=new Path2D(c||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=a}}const tx={DATA:1,ERROR:2},$o={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function LO(){}function Ma(n){if(n instanceof hd||n instanceof i4||n instanceof CO||n instanceof B2||n instanceof VA)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||zi('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new hd(n.message);case"InvalidPDFException":return new i4(n.message);case"PasswordException":return new CO(n.message,n.code);case"ResponseException":return new B2(n.message,n.status,n.missing);case"UnknownErrorException":return new VA(n.message,n.details)}return new VA(n.message,n.toString())}var ay,TS,p7,OS,m7,MS,g7,ly,Lx;class Nb{constructor(e,t,i){Pe(this,TS);Pe(this,OS);Pe(this,MS);Pe(this,ly);Pe(this,ay,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",We(this,TS,p7).bind(this),{signal:D(this,ay).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const c=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[c]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:c,data:t},i)}catch(l){a.reject(l)}return a.promise}sendWithStream(e,t,i,c){const a=this.streamId++,l=this.sourceName,r=this.targetName,h=this.comObj;return new ReadableStream({start:m=>{const v=Promise.withResolvers();return this.streamControllers[a]={controller:m,startCall:v,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:r,action:e,streamId:a,data:t,desiredSize:m.desiredSize},c),v.promise},pull:m=>{const v=Promise.withResolvers();return this.streamControllers[a].pullCall=v,h.postMessage({sourceName:l,targetName:r,stream:$o.PULL,streamId:a,desiredSize:m.desiredSize}),v.promise},cancel:m=>{Uo(m instanceof Error,"cancel must have a valid reason");const v=Promise.withResolvers();return this.streamControllers[a].cancelCall=v,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:l,targetName:r,stream:$o.CANCEL,streamId:a,reason:Ma(m)}),v.promise}},i)}destroy(){var e;(e=D(this,ay))==null||e.abort(),Ie(this,ay,null)}}ay=new WeakMap,TS=new WeakSet,p7=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){We(this,MS,g7).call(this,e);return}if(e.callback){const i=e.callbackId,c=this.callbackCapabilities[i];if(!c)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===tx.DATA)c.resolve(e.data);else if(e.callback===tx.ERROR)c.reject(Ma(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,c=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(l){a.postMessage({sourceName:i,targetName:c,callback:tx.DATA,callbackId:e.callbackId,data:l})},function(l){a.postMessage({sourceName:i,targetName:c,callback:tx.ERROR,callbackId:e.callbackId,reason:Ma(l)})});return}if(e.streamId){We(this,OS,m7).call(this,e);return}t(e.data)},OS=new WeakSet,m7=function(e){const t=e.streamId,i=this.sourceName,c=e.sourceName,a=this.comObj,l=this,r=this.actionHandler[e.action],h={enqueue(m,v=1,g){if(this.isCancelled)return;const _=this.desiredSize;this.desiredSize-=v,_>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:i,targetName:c,stream:$o.ENQUEUE,streamId:t,chunk:m},g)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:c,stream:$o.CLOSE,streamId:t}),delete l.streamSinks[t])},error(m){Uo(m instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:c,stream:$o.ERROR,streamId:t,reason:Ma(m)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(r,e.data,h).then(function(){a.postMessage({sourceName:i,targetName:c,stream:$o.START_COMPLETE,streamId:t,success:!0})},function(m){a.postMessage({sourceName:i,targetName:c,stream:$o.START_COMPLETE,streamId:t,reason:Ma(m)})})},MS=new WeakSet,g7=function(e){const t=e.streamId,i=this.sourceName,c=e.sourceName,a=this.comObj,l=this.streamControllers[t],r=this.streamSinks[t];switch(e.stream){case $o.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(Ma(e.reason));break;case $o.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(Ma(e.reason));break;case $o.PULL:if(!r){a.postMessage({sourceName:i,targetName:c,stream:$o.PULL_COMPLETE,streamId:t,success:!0});break}r.desiredSize<=0&&e.desiredSize>0&&r.sinkCapability.resolve(),r.desiredSize=e.desiredSize,Promise.try(r.onPull||LO).then(function(){a.postMessage({sourceName:i,targetName:c,stream:$o.PULL_COMPLETE,streamId:t,success:!0})},function(m){a.postMessage({sourceName:i,targetName:c,stream:$o.PULL_COMPLETE,streamId:t,reason:Ma(m)})});break;case $o.ENQUEUE:if(Uo(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case $o.CLOSE:if(Uo(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),We(this,ly,Lx).call(this,l,t);break;case $o.ERROR:Uo(l,"error should have stream controller"),l.controller.error(Ma(e.reason)),We(this,ly,Lx).call(this,l,t);break;case $o.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(Ma(e.reason)),We(this,ly,Lx).call(this,l,t);break;case $o.CANCEL:if(!r)break;const h=Ma(e.reason);Promise.try(r.onCancel||LO,h).then(function(){a.postMessage({sourceName:i,targetName:c,stream:$o.CANCEL_COMPLETE,streamId:t,success:!0})},function(m){a.postMessage({sourceName:i,targetName:c,stream:$o.CANCEL_COMPLETE,streamId:t,reason:Ma(m)})}),r.sinkCapability.reject(h),r.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},ly=new WeakSet,Lx=async function(e,t){var i,c,a;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(c=e.pullCall)==null?void 0:c.promise,(a=e.cancelCall)==null?void 0:a.promise]),delete this.streamControllers[t]};var m1;class y7{constructor({enableHWA:e=!1}){Pe(this,m1,!1);Ie(this,m1,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!D(this,m1)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){zi("Abstract method `_createCanvas` called.")}}m1=new WeakMap;class Dq extends y7{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class b7{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){zi("Abstract method `_fetch` called.")}}class jO extends b7{async _fetch(e){const t=await Q_(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):J_(t)}}class v7{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,c,a){return"none"}destroy(e=!1){}}var mp,cy,Ku,Xu,ea,gp,yp,gs,Js,bp,$b,Sf,ag,uy,jx,Ef,lg,CS,_7,g1,E4,Af,cg,vp,Bb,_p,Fb,y1,A4,wp,zb;class Lq extends v7{constructor({docId:t,ownerDocument:i=globalThis.document}){super();Pe(this,gs);Pe(this,bp);Pe(this,Sf);Pe(this,uy);Pe(this,Ef);Pe(this,CS);Pe(this,g1);Pe(this,Af);Pe(this,vp);Pe(this,_p);Pe(this,y1);Pe(this,wp);Pe(this,mp,void 0);Pe(this,cy,void 0);Pe(this,Ku,void 0);Pe(this,Xu,void 0);Pe(this,ea,void 0);Pe(this,gp,void 0);Pe(this,yp,0);Ie(this,Xu,t),Ie(this,ea,i)}addFilter(t){if(!t)return"none";let i=D(this,gs,Js).get(t);if(i)return i;const[c,a,l]=We(this,uy,jx).call(this,t),r=t.length===1?c:`${c}${a}${l}`;if(i=D(this,gs,Js).get(r),i)return D(this,gs,Js).set(t,i),i;const h=`g_${D(this,Xu)}_transfer_map_${da(this,yp)._++}`,m=We(this,Ef,lg).call(this,h);D(this,gs,Js).set(t,m),D(this,gs,Js).set(r,m);const v=We(this,Af,cg).call(this,h);return We(this,_p,Fb).call(this,c,a,l,v),m}addHCMFilter(t,i){var b;const c=`${t}-${i}`,a="base";let l=D(this,bp,$b).get(a);if((l==null?void 0:l.key)===c||(l?((b=l.filter)==null||b.remove(),l.key=c,l.url="none",l.filter=null):(l={key:c,url:"none",filter:null},D(this,bp,$b).set(a,l)),!t||!i))return l.url;const r=We(this,wp,zb).call(this,t);t=vr.makeHexColor(...r);const h=We(this,wp,zb).call(this,i);if(i=vr.makeHexColor(...h),D(this,Sf,ag).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return l.url;const m=new Array(256);for(let p=0;p<=255;p++){const x=p/255;m[p]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const v=m.join(","),g=`g_${D(this,Xu)}_hcm_filter`,_=l.filter=We(this,Af,cg).call(this,g);We(this,_p,Fb).call(this,v,v,v,_),We(this,g1,E4).call(this,_);const E=(p,x)=>{const y=r[p]/255,f=h[p]/255,w=new Array(x+1);for(let A=0;A<=x;A++)w[A]=y+A/x*(f-y);return w.join(",")};return We(this,_p,Fb).call(this,E(0,5),E(1,5),E(2,5),_),l.url=We(this,Ef,lg).call(this,g),l.url}addAlphaFilter(t){let i=D(this,gs,Js).get(t);if(i)return i;const[c]=We(this,uy,jx).call(this,[t]),a=`alpha_${c}`;if(i=D(this,gs,Js).get(a),i)return D(this,gs,Js).set(t,i),i;const l=`g_${D(this,Xu)}_alpha_map_${da(this,yp)._++}`,r=We(this,Ef,lg).call(this,l);D(this,gs,Js).set(t,r),D(this,gs,Js).set(a,r);const h=We(this,Af,cg).call(this,l);return We(this,y1,A4).call(this,c,h),r}addLuminosityFilter(t){let i=D(this,gs,Js).get(t||"luminosity");if(i)return i;let c,a;if(t?([c]=We(this,uy,jx).call(this,[t]),a=`luminosity_${c}`):a="luminosity",i=D(this,gs,Js).get(a),i)return D(this,gs,Js).set(t,i),i;const l=`g_${D(this,Xu)}_luminosity_map_${da(this,yp)._++}`,r=We(this,Ef,lg).call(this,l);D(this,gs,Js).set(t,r),D(this,gs,Js).set(a,r);const h=We(this,Af,cg).call(this,l);return We(this,CS,_7).call(this,h),t&&We(this,y1,A4).call(this,c,h),r}addHighlightHCMFilter(t,i,c,a,l){var f;const r=`${i}-${c}-${a}-${l}`;let h=D(this,bp,$b).get(t);if((h==null?void 0:h.key)===r||(h?((f=h.filter)==null||f.remove(),h.key=r,h.url="none",h.filter=null):(h={key:r,url:"none",filter:null},D(this,bp,$b).set(t,h)),!i||!c))return h.url;const[m,v]=[i,c].map(We(this,wp,zb).bind(this));let g=Math.round(.2126*m[0]+.7152*m[1]+.0722*m[2]),_=Math.round(.2126*v[0]+.7152*v[1]+.0722*v[2]),[E,b]=[a,l].map(We(this,wp,zb).bind(this));_<g&&([g,_,E,b]=[_,g,b,E]),D(this,Sf,ag).style.color="";const p=(w,A,P)=>{const T=new Array(256),R=(_-g)/P,M=w/255,L=(A-w)/(255*P);let W=0;for(let G=0;G<=P;G++){const re=Math.round(g+G*R),Q=M+G*L;for(let oe=W;oe<=re;oe++)T[oe]=Q;W=re+1}for(let G=W;G<256;G++)T[G]=T[W-1];return T.join(",")},x=`g_${D(this,Xu)}_hcm_${t}_filter`,y=h.filter=We(this,Af,cg).call(this,x);return We(this,g1,E4).call(this,y),We(this,_p,Fb).call(this,p(E[0],b[0],5),p(E[1],b[1],5),p(E[2],b[2],5),y),h.url=We(this,Ef,lg).call(this,x),h.url}destroy(t=!1){var i,c,a,l;t&&((i=D(this,gp))!=null&&i.size)||((c=D(this,Ku))==null||c.parentNode.parentNode.remove(),Ie(this,Ku,null),(a=D(this,cy))==null||a.clear(),Ie(this,cy,null),(l=D(this,gp))==null||l.clear(),Ie(this,gp,null),Ie(this,yp,0))}}mp=new WeakMap,cy=new WeakMap,Ku=new WeakMap,Xu=new WeakMap,ea=new WeakMap,gp=new WeakMap,yp=new WeakMap,gs=new WeakSet,Js=function(){return D(this,cy)||Ie(this,cy,new Map)},bp=new WeakSet,$b=function(){return D(this,gp)||Ie(this,gp,new Map)},Sf=new WeakSet,ag=function(){if(!D(this,Ku)){const t=D(this,ea).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const c=D(this,ea).createElementNS(Ru,"svg");c.setAttribute("width",0),c.setAttribute("height",0),Ie(this,Ku,D(this,ea).createElementNS(Ru,"defs")),t.append(c),c.append(D(this,Ku)),D(this,ea).body.append(t)}return D(this,Ku)},uy=new WeakSet,jx=function(t){if(t.length===1){const m=t[0],v=new Array(256);for(let _=0;_<256;_++)v[_]=m[_]/255;const g=v.join(",");return[g,g,g]}const[i,c,a]=t,l=new Array(256),r=new Array(256),h=new Array(256);for(let m=0;m<256;m++)l[m]=i[m]/255,r[m]=c[m]/255,h[m]=a[m]/255;return[l.join(","),r.join(","),h.join(",")]},Ef=new WeakSet,lg=function(t){if(D(this,mp)===void 0){Ie(this,mp,"");const i=D(this,ea).URL;i!==D(this,ea).baseURI&&(s3(i)?ei('#createUrl: ignore "data:"-URL for performance reasons.'):Ie(this,mp,i.split("#",1)[0]))}return`url(${D(this,mp)}#${t})`},CS=new WeakSet,_7=function(t){const i=D(this,ea).createElementNS(Ru,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},g1=new WeakSet,E4=function(t){const i=D(this,ea).createElementNS(Ru,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},Af=new WeakSet,cg=function(t){const i=D(this,ea).createElementNS(Ru,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),D(this,Sf,ag).append(i),i},vp=new WeakSet,Bb=function(t,i,c){const a=D(this,ea).createElementNS(Ru,i);a.setAttribute("type","discrete"),a.setAttribute("tableValues",c),t.append(a)},_p=new WeakSet,Fb=function(t,i,c,a){const l=D(this,ea).createElementNS(Ru,"feComponentTransfer");a.append(l),We(this,vp,Bb).call(this,l,"feFuncR",t),We(this,vp,Bb).call(this,l,"feFuncG",i),We(this,vp,Bb).call(this,l,"feFuncB",c)},y1=new WeakSet,A4=function(t,i){const c=D(this,ea).createElementNS(Ru,"feComponentTransfer");i.append(c),We(this,vp,Bb).call(this,c,"feFuncA",t)},wp=new WeakSet,zb=function(t){return D(this,Sf,ag).style.color=t,z8(getComputedStyle(D(this,Sf,ag)).getPropertyValue("color"))};class w7{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){zi("Abstract method `_fetch` called.")}}class NO extends w7{async _fetch(e){const t=await Q_(e,"arraybuffer");return new Uint8Array(t)}}class x7{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){zi("Abstract method `_fetch` called.")}}class $O extends x7{async _fetch(e){const t=await Q_(e,"arraybuffer");return new Uint8Array(t)}}Ns&&ei("Please use the `legacy` build in Node.js environments.");async function q8(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class jq extends v7{}class Nq extends y7{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class $q extends b7{async _fetch(e){return q8(e)}}class Bq extends w7{async _fetch(e){return q8(e)}}class Fq extends x7{async _fetch(e){return q8(e)}}const ra={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function k4(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],c=new Path2D;c.rect(e[0],e[1],t,i),n.clip(c)}class H8{getPattern(){zi("Abstract method `getPattern` called.")}}class zq extends H8{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,c){let a;if(c===ra.STROKE||c===ra.FILL){const l=t.current.getClippedPathBoundingBox(c,io(e))||[0,0,0,0],r=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,m=t.cachedCanvases.getCanvas("pattern",r,h),v=m.context;v.clearRect(0,0,v.canvas.width,v.canvas.height),v.beginPath(),v.rect(0,0,v.canvas.width,v.canvas.height),v.translate(-l[0],-l[1]),i=vr.transform(i,[1,0,0,1,l[0],l[1]]),v.transform(...t.baseTransform),this.matrix&&v.transform(...this.matrix),k4(v,this._bbox),v.fillStyle=this._createGradient(v),v.fill(),a=e.createPattern(m.canvas,"no-repeat");const g=new DOMMatrix(i);a.setTransform(g)}else k4(e,this._bbox),a=this._createGradient(e);return a}}function WA(n,e,t,i,c,a,l,r){const h=e.coords,m=e.colors,v=n.data,g=n.width*4;let _;h[t+1]>h[i+1]&&(_=t,t=i,i=_,_=a,a=l,l=_),h[i+1]>h[c+1]&&(_=i,i=c,c=_,_=l,l=r,r=_),h[t+1]>h[i+1]&&(_=t,t=i,i=_,_=a,a=l,l=_);const E=(h[t]+e.offsetX)*e.scaleX,b=(h[t+1]+e.offsetY)*e.scaleY,p=(h[i]+e.offsetX)*e.scaleX,x=(h[i+1]+e.offsetY)*e.scaleY,y=(h[c]+e.offsetX)*e.scaleX,f=(h[c+1]+e.offsetY)*e.scaleY;if(b>=f)return;const w=m[a],A=m[a+1],P=m[a+2],T=m[l],R=m[l+1],M=m[l+2],L=m[r],W=m[r+1],G=m[r+2],re=Math.round(b),Q=Math.round(f);let oe,ae,de,be,pe,U,B,N;for(let z=re;z<=Q;z++){if(z<x){const Oe=z<b?0:(b-z)/(b-x);oe=E-(E-p)*Oe,ae=w-(w-T)*Oe,de=A-(A-R)*Oe,be=P-(P-M)*Oe}else{let Oe;z>f?Oe=1:x===f?Oe=0:Oe=(x-z)/(x-f),oe=p-(p-y)*Oe,ae=T-(T-L)*Oe,de=R-(R-W)*Oe,be=M-(M-G)*Oe}let H;z<b?H=0:z>f?H=1:H=(b-z)/(b-f),pe=E-(E-y)*H,U=w-(w-L)*H,B=A-(A-W)*H,N=P-(P-G)*H;const Y=Math.round(Math.min(oe,pe)),fe=Math.round(Math.max(oe,pe));let Re=g*z+Y*4;for(let Oe=Y;Oe<=fe;Oe++)H=(oe-Oe)/(oe-pe),H<0?H=0:H>1&&(H=1),v[Re++]=ae-(ae-U)*H|0,v[Re++]=de-(de-B)*H|0,v[Re++]=be-(be-N)*H|0,v[Re++]=255}}function Uq(n,e,t){const i=e.coords,c=e.colors;let a,l;switch(e.type){case"lattice":const r=e.verticesPerRow,h=Math.floor(i.length/r)-1,m=r-1;for(a=0;a<h;a++){let v=a*r;for(let g=0;g<m;g++,v++)WA(n,t,i[v],i[v+1],i[v+r],c[v],c[v+1],c[v+r]),WA(n,t,i[v+r+1],i[v+1],i[v+r],c[v+r+1],c[v+1],c[v+r])}break;case"triangles":for(a=0,l=i.length;a<l;a+=3)WA(n,t,i[a],i[a+1],i[a+2],c[a],c[a+1],c[a+2]);break;default:throw new Error("illegal figure")}}class Vq extends H8{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const r=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),m=Math.ceil(this._bounds[2])-r,v=Math.ceil(this._bounds[3])-h,g=Math.min(Math.ceil(Math.abs(m*e[0]*1.1)),3e3),_=Math.min(Math.ceil(Math.abs(v*e[1]*1.1)),3e3),E=m/g,b=v/_,p={coords:this._coords,colors:this._colors,offsetX:-r,offsetY:-h,scaleX:1/E,scaleY:1/b},x=g+2*2,y=_+2*2,f=i.getCanvas("mesh",x,y),w=f.context,A=w.createImageData(g,_);if(t){const T=A.data;for(let R=0,M=T.length;R<M;R+=4)T[R]=t[0],T[R+1]=t[1],T[R+2]=t[2],T[R+3]=255}for(const T of this._figures)Uq(A,T,p);return w.putImageData(A,2,2),{canvas:f.canvas,offsetX:r-2*E,offsetY:h-2*b,scaleX:E,scaleY:b}}getPattern(e,t,i,c){k4(e,this._bbox);let a;if(c===ra.SHADING)a=vr.singularValueDecompose2dScale(io(e));else if(a=vr.singularValueDecompose2dScale(t.baseTransform),this.matrix){const r=vr.singularValueDecompose2dScale(this.matrix);a=[a[0]*r[0],a[1]*r[1]]}const l=this._createMeshCanvas(a,c===ra.SHADING?null:this._background,t.cachedCanvases);return c!==ra.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class qq extends H8{getPattern(){return"hotpink"}}function Hq(n){switch(n[0]){case"RadialAxial":return new zq(n);case"Mesh":return new Vq(n);case"Dummy":return new qq}throw new Error(`Unknown IR type: ${n[0]}`)}const BO={COLORED:1,UNCOLORED:2},IS=class IS{constructor(e,t,i,c,a){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=c,this.baseTransform=a}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:c,tilingType:a,color:l,canvasGraphicsFactory:r}=this;let{xstep:h,ystep:m}=this;h=Math.abs(h),m=Math.abs(m),o3("TilingType: "+a);const v=t[0],g=t[1],_=t[2],E=t[3],b=_-v,p=E-g,x=vr.singularValueDecompose2dScale(this.matrix),y=vr.singularValueDecompose2dScale(this.baseTransform),f=x[0]*y[0],w=x[1]*y[1];let A=b,P=p,T=!1,R=!1;const M=Math.ceil(h*f),L=Math.ceil(m*w),W=Math.ceil(b*f),G=Math.ceil(p*w);M>=W?A=h:T=!0,L>=G?P=m:R=!0;const re=this.getSizeAndScale(A,this.ctx.canvas.width,f),Q=this.getSizeAndScale(P,this.ctx.canvas.height,w),oe=e.cachedCanvases.getCanvas("pattern",re.size,Q.size),ae=oe.context,de=r.createCanvasGraphics(ae);if(de.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(de,c,l),ae.translate(-re.scale*v,-Q.scale*g),de.transform(re.scale,0,0,Q.scale,0,0),ae.save(),this.clipBbox(de,v,g,_,E),de.baseTransform=io(de.ctx),de.executeOperatorList(i),de.endDrawing(),ae.restore(),T||R){const be=oe.canvas;T&&(A=h),R&&(P=m);const pe=this.getSizeAndScale(A,this.ctx.canvas.width,f),U=this.getSizeAndScale(P,this.ctx.canvas.height,w),B=pe.size,N=U.size,z=e.cachedCanvases.getCanvas("pattern-workaround",B,N),H=z.context,Y=T?Math.floor(b/h):0,fe=R?Math.floor(p/m):0;for(let Re=0;Re<=Y;Re++)for(let Oe=0;Oe<=fe;Oe++)H.drawImage(be,B*Re,N*Oe,B,N,0,0,B,N);return{canvas:z.canvas,scaleX:pe.scale,scaleY:U.scale,offsetX:v,offsetY:g}}return{canvas:oe.canvas,scaleX:re.scale,scaleY:Q.scale,offsetX:v,offsetY:g}}getSizeAndScale(e,t,i){const c=Math.max(IS.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*i);return a>=c?a=c:i=a/e,{scale:i,size:a}}clipBbox(e,t,i,c,a){const l=c-t,r=a-i;e.ctx.rect(t,i,l,r),e.current.updateRectMinMax(io(e.ctx),[t,i,c,a]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const c=e.ctx,a=e.current;switch(t){case BO.COLORED:const l=this.ctx;c.fillStyle=l.fillStyle,c.strokeStyle=l.strokeStyle,a.fillColor=l.fillStyle,a.strokeColor=l.strokeStyle;break;case BO.UNCOLORED:const r=vr.makeHexColor(i[0],i[1],i[2]);c.fillStyle=r,c.strokeStyle=r,a.fillColor=r,a.strokeColor=r;break;default:throw new gq(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,c){let a=i;c!==ra.SHADING&&(a=vr.transform(a,t.baseTransform),this.matrix&&(a=vr.transform(a,this.matrix)));const l=this.createPatternCanvas(t);let r=new DOMMatrix(a);r=r.translate(l.offsetX,l.offsetY),r=r.scale(1/l.scaleX,1/l.scaleY);const h=e.createPattern(l.canvas,"repeat");return h.setTransform(r),h}};Or(IS,"MAX_PATTERN_SIZE",3e3);let P4=IS;function Wq({src:n,srcPos:e=0,dest:t,width:i,height:c,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const r=Bs.isLittleEndian?4278190080:255,[h,m]=l?[a,r]:[r,a],v=i>>3,g=i&7,_=n.length;t=new Uint32Array(t.buffer);let E=0;for(let b=0;b<c;b++){for(const x=e+v;e<x;e++){const y=e<_?n[e]:255;t[E++]=y&128?m:h,t[E++]=y&64?m:h,t[E++]=y&32?m:h,t[E++]=y&16?m:h,t[E++]=y&8?m:h,t[E++]=y&4?m:h,t[E++]=y&2?m:h,t[E++]=y&1?m:h}if(g===0)continue;const p=e<_?n[e++]:255;for(let x=0;x<g;x++)t[E++]=p&1<<7-x?m:h}return{srcPos:e,destPos:E}}const FO=16,zO=100,Gq=15,UO=10,VO=1e3,La=16;function Kq(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(i,c){e.translate(i,c),this.__originalTranslate(i,c)},n.scale=function(i,c){e.scale(i,c),this.__originalScale(i,c)},n.transform=function(i,c,a,l,r,h){e.transform(i,c,a,l,r,h),this.__originalTransform(i,c,a,l,r,h)},n.setTransform=function(i,c,a,l,r,h){e.setTransform(i,c,a,l,r,h),this.__originalSetTransform(i,c,a,l,r,h)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){e.rotate(i),this.__originalRotate(i)},n.clip=function(i){e.clip(i),this.__originalClip(i)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,c,a,l,r){e.bezierCurveTo(t,i,c,a,l,r),this.__originalBezierCurveTo(t,i,c,a,l,r)},n.rect=function(t,i,c,a){e.rect(t,i,c,a),this.__originalRect(t,i,c,a)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Xq{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let c;return this.cache[e]!==void 0?(c=this.cache[e],this.canvasFactory.reset(c,t,i)):(c=this.canvasFactory.create(t,i),this.cache[e]=c),c}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function nx(n,e,t,i,c,a,l,r,h,m){const[v,g,_,E,b,p]=io(n);if(g===0&&_===0){const f=l*v+b,w=Math.round(f),A=r*E+p,P=Math.round(A),T=(l+h)*v+b,R=Math.abs(Math.round(T)-w)||1,M=(r+m)*E+p,L=Math.abs(Math.round(M)-P)||1;return n.setTransform(Math.sign(v),0,0,Math.sign(E),w,P),n.drawImage(e,t,i,c,a,0,0,R,L),n.setTransform(v,g,_,E,b,p),[R,L]}if(v===0&&E===0){const f=r*_+b,w=Math.round(f),A=l*g+p,P=Math.round(A),T=(r+m)*_+b,R=Math.abs(Math.round(T)-w)||1,M=(l+h)*g+p,L=Math.abs(Math.round(M)-P)||1;return n.setTransform(0,Math.sign(g),Math.sign(_),0,w,P),n.drawImage(e,t,i,c,a,0,0,L,R),n.setTransform(v,g,_,E,b,p),[L,R]}n.drawImage(e,t,i,c,a,l,r,h,m);const x=Math.hypot(v,g),y=Math.hypot(_,E);return[x*h,y*m]}function Zq(n){const{width:e,height:t}=n;if(e>VO||t>VO)return null;const i=1e3,c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=e+1;let l=new Uint8Array(a*(t+1)),r,h,m;const v=e+7&-8;let g=new Uint8Array(v*t),_=0;for(const y of n.data){let f=128;for(;f>0;)g[_++]=y&f?0:255,f>>=1}let E=0;for(_=0,g[_]!==0&&(l[0]=1,++E),h=1;h<e;h++)g[_]!==g[_+1]&&(l[h]=g[_]?2:1,++E),_++;for(g[_]!==0&&(l[h]=2,++E),r=1;r<t;r++){_=r*v,m=r*a,g[_-v]!==g[_]&&(l[m]=g[_]?1:8,++E);let y=(g[_]?4:0)+(g[_-v]?8:0);for(h=1;h<e;h++)y=(y>>2)+(g[_+1]?4:0)+(g[_-v+1]?8:0),c[y]&&(l[m+h]=c[y],++E),_++;if(g[_-v]!==g[_]&&(l[m+h]=g[_]?2:4,++E),E>i)return null}for(_=v*(t-1),m=r*a,g[_]!==0&&(l[m]=8,++E),h=1;h<e;h++)g[_]!==g[_+1]&&(l[m+h]=g[_]?4:8,++E),_++;if(g[_]!==0&&(l[m+h]=4,++E),E>i)return null;const b=new Int32Array([0,a,-1,0,-a,0,0,0,1]),p=new Path2D;for(r=0;E&&r<=t;r++){let y=r*a;const f=y+e;for(;y<f&&!l[y];)y++;if(y===f)continue;p.moveTo(y%a,r);const w=y;let A=l[y];do{const P=b[A];do y+=P;while(!l[y]);const T=l[y];T!==5&&T!==10?(A=T,l[y]=0):(A=T&51*A>>4,l[y]&=A>>2|A<<2),p.lineTo(y%a,y/a|0),l[y]||--E}while(w!==y);--r}return g=null,l=null,function(y){y.save(),y.scale(1/e,-1/t),y.translate(0,-t),y.fill(p),y.beginPath(),y.restore()}}class qO{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=CR,this.textMatrixScale=1,this.fontMatrix=r4,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ys.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=vr.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=vr.applyTransform(t,e),c=vr.applyTransform(t.slice(2),e),a=vr.applyTransform([t[0],t[3]],e),l=vr.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],c[0],a[0],l[0]),this.minY=Math.min(this.minY,i[1],c[1],a[1],l[1]),this.maxX=Math.max(this.maxX,i[0],c[0],a[0],l[0]),this.maxY=Math.max(this.maxY,i[1],c[1],a[1],l[1])}updateScalingPathMinMax(e,t){vr.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,c,a,l,r,h,m,v){const g=vr.bezierBoundingBox(t,i,c,a,l,r,h,m,v);v||this.updateRectMinMax(e,g)}getPathBoundingBox(e=ra.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===ra.STROKE){t||zi("Stroke bounding box must include transform.");const c=vr.singularValueDecompose2dScale(t),a=c[0]*this.lineWidth/2,l=c[1]*this.lineWidth/2;i[0]-=a,i[1]-=l,i[2]+=a,i[3]+=l}return i}updateClipFromPath(){const e=vr.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=ra.FILL,t=null){return vr.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function HO(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,c=t%La,a=(t-c)/La,l=c===0?a:a+1,r=n.createImageData(i,La);let h=0,m;const v=e.data,g=r.data;let _,E,b,p;if(e.kind===kx.GRAYSCALE_1BPP){const x=v.byteLength,y=new Uint32Array(g.buffer,0,g.byteLength>>2),f=y.length,w=i+7>>3,A=4294967295,P=Bs.isLittleEndian?4278190080:255;for(_=0;_<l;_++){for(b=_<a?La:c,m=0,E=0;E<b;E++){const T=x-h;let R=0;const M=T>w?i:T*8-7,L=M&-8;let W=0,G=0;for(;R<L;R+=8)G=v[h++],y[m++]=G&128?A:P,y[m++]=G&64?A:P,y[m++]=G&32?A:P,y[m++]=G&16?A:P,y[m++]=G&8?A:P,y[m++]=G&4?A:P,y[m++]=G&2?A:P,y[m++]=G&1?A:P;for(;R<M;R++)W===0&&(G=v[h++],W=128),y[m++]=G&W?A:P,W>>=1}for(;m<f;)y[m++]=0;n.putImageData(r,0,_*La)}}else if(e.kind===kx.RGBA_32BPP){for(E=0,p=i*La*4,_=0;_<a;_++)g.set(v.subarray(h,h+p)),h+=p,n.putImageData(r,0,E),E+=La;_<l&&(p=i*c*4,g.set(v.subarray(h,h+p)),n.putImageData(r,0,E))}else if(e.kind===kx.RGB_24BPP)for(b=La,p=i*b,_=0;_<l;_++){for(_>=a&&(b=c,p=i*b),m=0,E=p;E--;)g[m++]=v[h++],g[m++]=v[h++],g[m++]=v[h++],g[m++]=255;n.putImageData(r,0,_*La)}else throw new Error(`bad image kind: ${e.kind}`)}function WO(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,c=t%La,a=(t-c)/La,l=c===0?a:a+1,r=n.createImageData(i,La);let h=0;const m=e.data,v=r.data;for(let g=0;g<l;g++){const _=g<a?La:c;({srcPos:h}=Wq({src:m,srcPos:h,dest:v,width:i,height:_,nonBlackColor:0})),n.putImageData(r,0,g*La)}}function Eb(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function rx(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Ns){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function GO(n,e){if(e)return!0;const t=vr.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround(kh.pixelRatio*fd.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const Yq=["butt","round","square"],Jq=["miter","round","bevel"],Qq={},KO={};var b1,T4,v1,O4,_1,M4;const rk=class rk{constructor(e,t,i,c,a,{optionalContentConfig:l,markedContentStack:r=null},h,m){Pe(this,b1);Pe(this,v1);Pe(this,_1);this.ctx=e,this.current=new qO(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=c,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=r||[],this.optionalContentConfig=l,this.cachedCanvases=new Xq(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=m,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:c=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,r=this.ctx.fillStyle;if(this.ctx.fillStyle=c||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=r,i){const h=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...io(this.compositeCtx))}this.ctx.save(),rx(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=io(this.ctx)}executeOperatorList(e,t,i,c){const a=e.argsArray,l=e.fnArray;let r=t||0;const h=a.length;if(h===r)return r;const m=h-r>UO&&typeof i=="function",v=m?Date.now()+Gq:0;let g=0;const _=this.commonObjs,E=this.objs;let b;for(;;){if(c!==void 0&&r===c.nextBreakPoint)return c.breakIt(r,i),r;if(b=l[r],b!==ic.dependency)this[b].apply(this,a[r]);else for(const p of a[r]){const x=p.startsWith("g_")?_:E;if(!x.has(p))return x.get(p,i),r}if(r++,r===h)return r;if(m&&++g>UO){if(Date.now()>v)return i(),r;g=0}}}endDrawing(){We(this,b1,T4).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),We(this,v1,O4).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,c=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),r=i,h=c,m="prescale1",v,g;for(;a>2&&r>1||l>2&&h>1;){let _=r,E=h;a>2&&r>1&&(_=r>=16384?Math.floor(r/2)-1||1:Math.ceil(r/2),a/=r/_),l>2&&h>1&&(E=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/E),v=this.cachedCanvases.getCanvas(m,_,E),g=v.context,g.clearRect(0,0,_,E),g.drawImage(e,0,0,r,h,0,0,_,E),e=v.canvas,r=_,h=E,m=m==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:r,paintHeight:h}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:c}=e,a=this.current.fillColor,l=this.current.patternFill,r=io(t);let h,m,v,g;if((e.bitmap||e.data)&&e.count>1){const M=e.bitmap||e.data.buffer;m=JSON.stringify(l?r:[r.slice(0,4),a]),h=this._cachedBitmapsMap.get(M),h||(h=new Map,this._cachedBitmapsMap.set(M,h));const L=h.get(m);if(L&&!l){const W=Math.round(Math.min(r[0],r[2])+r[4]),G=Math.round(Math.min(r[1],r[3])+r[5]);return{canvas:L,offsetX:W,offsetY:G}}v=L}v||(g=this.cachedCanvases.getCanvas("maskCanvas",i,c),WO(g.context,e));let _=vr.transform(r,[1/i,0,0,-1/c,0,0]);_=vr.transform(_,[1,0,0,1,0,-c]);const[E,b,p,x]=vr.getAxialAlignedBoundingBox([0,0,i,c],_),y=Math.round(p-E)||1,f=Math.round(x-b)||1,w=this.cachedCanvases.getCanvas("fillCanvas",y,f),A=w.context,P=E,T=b;A.translate(-P,-T),A.transform(..._),v||(v=this._scaleImage(g.canvas,Bc(A)),v=v.img,h&&l&&h.set(m,v)),A.imageSmoothingEnabled=GO(io(A),e.interpolate),nx(A,v,0,0,v.width,v.height,0,0,i,c),A.globalCompositeOperation="source-in";const R=vr.transform(Bc(A),[1,0,0,1,-P,-T]);return A.fillStyle=l?a.getPattern(t,this,R,ra.FILL):a,A.fillRect(0,0,i,c),h&&!l&&(this.cachedCanvases.delete("fillCanvas"),h.set(m,w.canvas)),{canvas:w.canvas,offsetX:Math.round(P),offsetY:Math.round(T)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Yq[e]}setLineJoin(e){this.ctx.lineJoin=Jq[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,c=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=c.context;const a=this.ctx;a.setTransform(...io(this.suspendedCtx)),Eb(this.suspendedCtx,a),Kq(a,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Eb(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,c){const a=c[0],l=c[1],r=c[2]-a,h=c[3]-l;r===0||h===0||(this.genericComposeSMask(t.context,i,r,h,t.subtype,t.backdrop,t.transferMap,a,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,c,a,l,r,h,m,v,g){let _=e.canvas,E=h-v,b=m-g;if(l){const x=vr.makeHexColor(...l);if(E<0||b<0||E+i>_.width||b+c>_.height){const y=this.cachedCanvases.getCanvas("maskExtension",i,c),f=y.context;f.drawImage(_,-E,-b),f.globalCompositeOperation="destination-atop",f.fillStyle=x,f.fillRect(0,0,i,c),f.globalCompositeOperation="source-over",_=y.canvas,E=b=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(E,b,i,c),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=x,e.fillRect(E,b,i,c),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&r?t.filter=this.filterFactory.addAlphaFilter(r):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(r));const p=new Path2D;p.rect(h,m,i,c),t.clip(p),t.globalCompositeOperation="destination-in",t.drawImage(_,E,b,i,c,h,m,i,c),t.restore()}save(){this.inSMaskMode?(Eb(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Eb(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,c,a,l){this.ctx.transform(e,t,i,c,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const c=this.ctx,a=this.current;let l=a.x,r=a.y,h,m;const v=io(c),g=v[0]===0&&v[3]===0||v[1]===0&&v[2]===0,_=g?i.slice(0):null;for(let E=0,b=0,p=e.length;E<p;E++)switch(e[E]|0){case ic.rectangle:l=t[b++],r=t[b++];const x=t[b++],y=t[b++],f=l+x,w=r+y;c.moveTo(l,r),x===0||y===0?c.lineTo(f,w):(c.lineTo(f,r),c.lineTo(f,w),c.lineTo(l,w)),g||a.updateRectMinMax(v,[l,r,f,w]),c.closePath();break;case ic.moveTo:l=t[b++],r=t[b++],c.moveTo(l,r),g||a.updatePathMinMax(v,l,r);break;case ic.lineTo:l=t[b++],r=t[b++],c.lineTo(l,r),g||a.updatePathMinMax(v,l,r);break;case ic.curveTo:h=l,m=r,l=t[b+4],r=t[b+5],c.bezierCurveTo(t[b],t[b+1],t[b+2],t[b+3],l,r),a.updateCurvePathMinMax(v,h,m,t[b],t[b+1],t[b+2],t[b+3],l,r,_),b+=6;break;case ic.curveTo2:h=l,m=r,c.bezierCurveTo(l,r,t[b],t[b+1],t[b+2],t[b+3]),a.updateCurvePathMinMax(v,h,m,l,r,t[b],t[b+1],t[b+2],t[b+3],_),l=t[b+2],r=t[b+3],b+=4;break;case ic.curveTo3:h=l,m=r,l=t[b+2],r=t[b+3],c.bezierCurveTo(t[b],t[b+1],l,r,l,r),a.updateCurvePathMinMax(v,h,m,t[b],t[b+1],l,r,l,r,_),b+=4;break;case ic.closePath:c.closePath();break}g&&a.updateScalingPathMinMax(v,_),a.setCurrentPoint(l,r)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(t.save(),t.strokeStyle=i.getPattern(t,this,Bc(t),ra.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,c=this.current.patternFill;let a=!1;c&&(t.save(),t.fillStyle=i.getPattern(t,this,Bc(t),ra.FILL),a=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),a&&t.restore(),e&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Qq}eoClip(){this.pendingClip=KO}beginText(){this.current.textMatrix=CR,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const i=new Path2D,c=t.getTransform().invertSelf();for(const{transform:a,x:l,y:r,fontSize:h,path:m}of e)i.addPath(m,new DOMMatrix(a).preMultiplySelf(c).translate(l,r).scale(h,-h));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var v;const i=this.commonObjs.get(e),c=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(c.fontMatrix=i.fontMatrix||r4,(c.fontMatrix[0]===0||c.fontMatrix[3]===0)&&ei("Invalid font matrix for font "+e),t<0?(t=-t,c.fontDirection=-1):c.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const a=i.loadedName||"sans-serif",l=((v=i.systemFontInfo)==null?void 0:v.css)||`"${a}", ${i.fallbackName}`;let r="normal";i.black?r="900":i.bold&&(r="bold");const h=i.italic?"italic":"normal";let m=t;t<FO?m=FO:t>zO&&(m=zO),this.current.fontSizeScale=t/m,this.ctx.font=`${h} ${r} ${m}px ${l}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,c,a,l){this.current.textMatrix=[e,t,i,c,a,l],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,c,a){const l=this.ctx,r=this.current,h=r.font,m=r.textRenderingMode,v=r.fontSize/r.fontSizeScale,g=m&Ys.FILL_STROKE_MASK,_=!!(m&Ys.ADD_TO_PATH_FLAG),E=r.patternFill&&!h.missingFile,b=r.patternStroke&&!h.missingFile;let p;if((h.disableFontFace||_||E||b)&&(p=h.getPathGenerator(this.commonObjs,e)),h.disableFontFace||E||b){l.save(),l.translate(t,i),l.scale(v,-v);let x;if((g===Ys.FILL||g===Ys.FILL_STROKE)&&(c?(x=l.getTransform(),l.setTransform(...c),l.fill(We(this,_1,M4).call(this,p,x,c))):l.fill(p)),g===Ys.STROKE||g===Ys.FILL_STROKE)if(a){x||(x=l.getTransform()),l.setTransform(...a);const{a:y,b:f,c:w,d:A}=x,P=vr.inverseTransform(a),T=vr.transform([y,f,w,A,0,0],P),[R,M]=vr.singularValueDecompose2dScale(T);l.lineWidth*=Math.max(R,M)/v,l.stroke(We(this,_1,M4).call(this,p,x,a))}else l.lineWidth/=v,l.stroke(p);l.restore()}else(g===Ys.FILL||g===Ys.FILL_STROKE)&&l.fillText(e,t,i),(g===Ys.STROKE||g===Ys.FILL_STROKE)&&l.strokeText(e,t,i);_&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:io(l),x:t,y:i,fontSize:v,path:p})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let c=3;c<t.length;c+=4)if(t[c]>0&&t[c]<255){i=!0;break}return di(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const c=t.fontSize;if(c===0)return;const a=this.ctx,l=t.fontSizeScale,r=t.charSpacing,h=t.wordSpacing,m=t.fontDirection,v=t.textHScale*m,g=e.length,_=i.vertical,E=_?1:-1,b=i.defaultVMetrics,p=c*t.fontMatrix[0],x=t.textRenderingMode===Ys.FILL&&!i.disableFontFace&&!t.patternFill;a.save(),a.transform(...t.textMatrix),a.translate(t.x,t.y+t.textRise),m>0?a.scale(v,-1):a.scale(v,1);let y,f;if(t.patternFill){a.save();const R=t.fillColor.getPattern(a,this,Bc(a),ra.FILL);y=io(a),a.restore(),a.fillStyle=R}if(t.patternStroke){a.save();const R=t.strokeColor.getPattern(a,this,Bc(a),ra.STROKE);f=io(a),a.restore(),a.strokeStyle=R}let w=t.lineWidth;const A=t.textMatrixScale;if(A===0||w===0){const R=t.textRenderingMode&Ys.FILL_STROKE_MASK;(R===Ys.STROKE||R===Ys.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=A;if(l!==1&&(a.scale(l,l),w/=l),a.lineWidth=w,i.isInvalidPDFjsFont){const R=[];let M=0;for(const L of e)R.push(L.unicode),M+=L.width;a.fillText(R.join(""),0,0),t.x+=M*p*v,a.restore(),this.compose();return}let P=0,T;for(T=0;T<g;++T){const R=e[T];if(typeof R=="number"){P+=E*R*c/1e3;continue}let M=!1;const L=(R.isSpace?h:0)+r,W=R.fontChar,G=R.accent;let re,Q,oe=R.width;if(_){const de=R.vmetric||b,be=-(R.vmetric?de[1]:oe*.5)*p,pe=de[2]*p;oe=de?-de[0]:oe,re=be/l,Q=(P+pe)/l}else re=P/l,Q=0;if(i.remeasure&&oe>0){const de=a.measureText(W).width*1e3/c*l;if(oe<de&&this.isFontSubpixelAAEnabled){const be=oe/de;M=!0,a.save(),a.scale(be,1),re/=be}else oe!==de&&(re+=(oe-de)/2e3*c/l)}if(this.contentVisible&&(R.isInFont||i.missingFile)){if(x&&!G)a.fillText(W,re,Q);else if(this.paintChar(W,re,Q,y,f),G){const de=re+c*G.offset.x/l,be=Q-c*G.offset.y/l;this.paintChar(G.fontChar,de,be,y,f)}}const ae=_?oe*p-L*m:oe*p+L*m;P+=ae,M&&a.restore()}_?t.y-=P:t.x+=P*v,a.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,c=i.font,a=i.fontSize,l=i.fontDirection,r=c.vertical?1:-1,h=i.charSpacing,m=i.wordSpacing,v=i.textHScale*l,g=i.fontMatrix||r4,_=e.length,E=i.textRenderingMode===Ys.INVISIBLE;let b,p,x,y;if(!(E||a===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y+i.textRise),t.scale(v,l),b=0;b<_;++b){if(p=e[b],typeof p=="number"){y=r*p*a/1e3,this.ctx.translate(y,0),i.x+=y*v;continue}const f=(p.isSpace?m:0)+h,w=c.charProcOperatorList[p.operatorListId];if(!w){ei(`Type3 character "${p.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=p,this.save(),t.scale(a,a),t.transform(...g),this.executeOperatorList(w),this.restore()),x=vr.applyTransform([p.width,0],g)[0]*a+f,t.translate(x,0),i.x+=x*v}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,c,a,l){this.ctx.rect(i,c,a-i,l-c),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],c=this.baseTransform||io(this.ctx),a={createCanvasGraphics:l=>new rk(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new P4(e,i,this.ctx,a,c)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=vr.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=vr.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=Hq(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,Bc(t),ra.SHADING);const c=Bc(t);if(c){const{width:a,height:l}=t.canvas,[r,h,m,v]=vr.getAxialAlignedBoundingBox([0,0,a,l],c);this.ctx.fillRect(r,h,m-r,v-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){zi("Should not call beginInlineImage")}beginImageData(){zi("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=io(this.ctx),t)){const i=t[2]-t[0],c=t[3]-t[1];this.ctx.rect(t[0],t[1],i,c),this.current.updateRectMinMax(io(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||o3("TODO: Support non-isolated groups."),e.knockout&&ei("Knockout groups not supported.");const i=io(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let c=vr.getAxialAlignedBoundingBox(e.bbox,io(t));const a=[0,0,t.canvas.width,t.canvas.height];c=vr.intersect(c,a)||[0,0,0,0];const l=Math.floor(c[0]),r=Math.floor(c[1]),h=Math.max(Math.ceil(c[2])-l,1),m=Math.max(Math.ceil(c[3])-r,1);this.current.startNewPathAndClipBox([0,0,h,m]);let v="groupAt"+this.groupLevel;e.smask&&(v+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(v,h,m),_=g.context;_.translate(-l,-r),_.transform(...i),e.smask?this.smaskStack.push({canvas:g.canvas,context:_,offsetX:l,offsetY:r,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,r),t.save()),Eb(t,_),this.ctx=_,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const c=io(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...c);const a=vr.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],c);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,i,c,a){if(We(this,b1,T4).call(this),rx(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const l=t[2]-t[0],r=t[3]-t[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=l,t[3]=r;const[h,m]=vr.singularValueDecompose2dScale(io(this.ctx)),{viewportScale:v}=this,g=Math.ceil(l*this.outputScaleX*v),_=Math.ceil(r*this.outputScaleY*v);this.annotationCanvas=this.canvasFactory.create(g,_);const{canvas:E,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,E),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(h,0,0,-m,0,r*m),rx(this.ctx)}else rx(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],l,r),this.ctx.clip(),this.ctx.beginPath()}this.current=new qO(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...c)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),We(this,v1,O4).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,c=this.processingType3;if(c&&(c.compiled===void 0&&(c.compiled=Zq(e)),c.compiled)){c.compiled(i);return}const a=this._createMaskCanvas(e),l=a.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(l,a.offsetX,a.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,c=0,a,l){if(!this.contentVisible)return;e=this.getObject(e.data,e);const r=this.ctx;r.save();const h=io(r);r.transform(t,i,c,a,0,0);const m=this._createMaskCanvas(e);r.setTransform(1,0,0,1,m.offsetX-h[4],m.offsetY-h[5]);for(let v=0,g=l.length;v<g;v+=2){const _=vr.transform(h,[t,i,c,a,l[v],l[v+1]]),[E,b]=vr.applyTransform([0,0],_);r.drawImage(m.canvas,E,b)}r.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,c=this.current.patternFill;for(const a of e){const{data:l,width:r,height:h,transform:m}=a,v=this.cachedCanvases.getCanvas("maskCanvas",r,h),g=v.context;g.save();const _=this.getObject(l,a);WO(g,_),g.globalCompositeOperation="source-in",g.fillStyle=c?i.getPattern(g,this,Bc(t),ra.FILL):i,g.fillRect(0,0,r,h),g.restore(),t.save(),t.transform(...m),t.scale(1,-1),nx(t,v.canvas,0,0,r,h,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){ei("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,c){if(!this.contentVisible)return;const a=this.getObject(e);if(!a){ei("Dependent image isn't ready yet");return}const l=a.width,r=a.height,h=[];for(let m=0,v=c.length;m<v;m+=2)h.push({transform:[t,0,0,i,c[m],c[m+1]],x:0,y:0,w:l,h:r});this.paintInlineImageXObjectGroup(a,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:c}=e,a=this.cachedCanvases.getCanvas("inlineImage",i,c),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",a.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,c=this.ctx;if(this.save(),!Ns){const{filter:r}=c;r!=="none"&&r!==""&&(c.filter="none")}c.scale(1/t,-1/i);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const h=this.cachedCanvases.getCanvas("inlineImage",t,i).context;HO(h,e),a=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(a,Bc(c));c.imageSmoothingEnabled=GO(io(c),e.interpolate),nx(c,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let c;if(e.bitmap)c=e.bitmap;else{const a=e.width,l=e.height,h=this.cachedCanvases.getCanvas("inlineImage",a,l).context;HO(h,e),c=this.applyTransferMapsToCanvas(h)}for(const a of t)i.save(),i.transform(...a.transform),i.scale(1,-1),nx(i,c,a.x,a.y,a.w,a.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===KO?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=io(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),c=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,c)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c,d:a}=this.ctx.getTransform();let l,r;if(i===0&&c===0){const h=Math.abs(t),m=Math.abs(a);if(h===m)if(e===0)l=r=1/h;else{const v=h*e;l=r=v<1?1/v:1}else if(e===0)l=1/h,r=1/m;else{const v=h*e,g=m*e;l=v<1?1/v:1,r=g<1?1/g:1}}else{const h=Math.abs(t*a-i*c),m=Math.hypot(t,i),v=Math.hypot(c,a);if(e===0)l=v/h,r=m/h;else{const g=e*h;l=v>g?v/g:1,r=m>g?m/g:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=r}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[c,a]=this.getScaleForStroking();if(t.lineWidth=i||1,c===1&&a===1){t.stroke();return}const l=t.getLineDash();if(e&&t.save(),t.scale(c,a),l.length>0){const r=Math.max(c,a);t.setLineDash(l.map(h=>h/r)),t.lineDashOffset/=r}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};b1=new WeakSet,T4=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},v1=new WeakSet,O4=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},_1=new WeakSet,M4=function(e,t,i){const c=new Path2D;return c.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),c};let Lg=rk;for(const n in ic)Lg.prototype[n]!==void 0&&(Lg.prototype[ic[n]]=Lg.prototype[n]);var w1,x1;class gh{static get workerPort(){return D(this,w1)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");Ie(this,w1,e)}static get workerSrc(){return D(this,x1)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");Ie(this,x1,e)}}w1=new WeakMap,x1=new WeakMap,Pe(gh,w1,null),Pe(gh,x1,"");var xp,S1;class eH{constructor({parsedData:e,rawData:t}){Pe(this,xp,void 0);Pe(this,S1,void 0);Ie(this,xp,e),Ie(this,S1,t)}getRaw(){return D(this,S1)}get(e){return D(this,xp).get(e)??null}getAll(){return j8(D(this,xp))}has(e){return D(this,xp).has(e)}}xp=new WeakMap,S1=new WeakMap;const ug=Symbol("INTERNAL");var E1,A1,k1,hy;class tH{constructor(e,{name:t,intent:i,usage:c,rbGroups:a}){Pe(this,E1,!1);Pe(this,A1,!1);Pe(this,k1,!1);Pe(this,hy,!0);Ie(this,E1,!!(e&pl.DISPLAY)),Ie(this,A1,!!(e&pl.PRINT)),this.name=t,this.intent=i,this.usage=c,this.rbGroups=a}get visible(){if(D(this,k1))return D(this,hy);if(!D(this,hy))return!1;const{print:e,view:t}=this.usage;return D(this,E1)?(t==null?void 0:t.viewState)!=="OFF":D(this,A1)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==ug&&zi("Internal method `_setVisible` called."),Ie(this,k1,i),Ie(this,hy,t)}}E1=new WeakMap,A1=new WeakMap,k1=new WeakMap,hy=new WeakMap;var kf,Ii,fy,dy,P1,C4;class nH{constructor(e,t=pl.DISPLAY){Pe(this,P1);Pe(this,kf,null);Pe(this,Ii,new Map);Pe(this,fy,null);Pe(this,dy,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,Ie(this,dy,e.order);for(const i of e.groups)D(this,Ii).set(i.id,new tH(t,i));if(e.baseState==="OFF")for(const i of D(this,Ii).values())i._setVisible(ug,!1);for(const i of e.on)D(this,Ii).get(i)._setVisible(ug,!0);for(const i of e.off)D(this,Ii).get(i)._setVisible(ug,!1);Ie(this,fy,this.getHash())}}isVisible(e){if(D(this,Ii).size===0)return!0;if(!e)return o3("Optional content group not defined."),!0;if(e.type==="OCG")return D(this,Ii).has(e.id)?D(this,Ii).get(e.id).visible:(ei(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return We(this,P1,C4).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!D(this,Ii).has(t))return ei(`Optional content group not found: ${t}`),!0;if(D(this,Ii).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!D(this,Ii).has(t))return ei(`Optional content group not found: ${t}`),!0;if(!D(this,Ii).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!D(this,Ii).has(t))return ei(`Optional content group not found: ${t}`),!0;if(!D(this,Ii).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!D(this,Ii).has(t))return ei(`Optional content group not found: ${t}`),!0;if(D(this,Ii).get(t).visible)return!1}return!0}return ei(`Unknown optional content policy ${e.policy}.`),!0}return ei(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var a;const c=D(this,Ii).get(e);if(!c){ei(`Optional content group not found: ${e}`);return}if(i&&t&&c.rbGroups.length)for(const l of c.rbGroups)for(const r of l)r!==e&&((a=D(this,Ii).get(r))==null||a._setVisible(ug,!1,!0));c._setVisible(ug,!!t,!0),Ie(this,kf,null)}setOCGState({state:e,preserveRB:t}){let i;for(const c of e){switch(c){case"ON":case"OFF":case"Toggle":i=c;continue}const a=D(this,Ii).get(c);if(a)switch(i){case"ON":this.setVisibility(c,!0,t);break;case"OFF":this.setVisibility(c,!1,t);break;case"Toggle":this.setVisibility(c,!a.visible,t);break}}Ie(this,kf,null)}get hasInitialVisibility(){return D(this,fy)===null||this.getHash()===D(this,fy)}getOrder(){return D(this,Ii).size?D(this,dy)?D(this,dy).slice():[...D(this,Ii).keys()]:null}getGroups(){return D(this,Ii).size>0?j8(D(this,Ii)):null}getGroup(e){return D(this,Ii).get(e)||null}getHash(){if(D(this,kf)!==null)return D(this,kf);const e=new h7;for(const[t,i]of D(this,Ii))e.update(`${t}:${i.visible}`);return Ie(this,kf,e.hexdigest())}}kf=new WeakMap,Ii=new WeakMap,fy=new WeakMap,dy=new WeakMap,P1=new WeakSet,C4=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let c=1;c<t;c++){const a=e[c];let l;if(Array.isArray(a))l=We(this,P1,C4).call(this,a);else if(D(this,Ii).has(a))l=D(this,Ii).get(a).visible;else return ei(`Optional content group not found: ${a}`),!0;switch(i){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return i==="And"};class rH{constructor(e,{disableRange:t=!1,disableStream:i=!1}){Uo(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:c,initialData:a,progressiveDone:l,contentDispositionFilename:r}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=r,(a==null?void 0:a.length)>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=c,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,m)=>{this._onReceiveData({begin:h,chunk:m})}),e.addProgressListener((h,m)=>{this._onProgress({loaded:h,total:m})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const c=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(i),!0)});Uo(c,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,c,a;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(a=(c=this._fullRequestReader)==null?void 0:c.onProgress)==null||a.call(c,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Uo(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new iH(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new oH(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class iH{constructor(e,t,i=!1,c=null){this._stream=e,this._done=i||!1,this._filename=B8(c)?c:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class oH{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function sH(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let v=r(t);return v=unescape(v),v=h(v),v=m(v),a(v)}if(t=l(n),t){const v=m(t);return a(v)}if(t=i("filename","i").exec(n),t){t=t[1];let v=r(t);return v=m(v),a(v)}function i(v,g){return new RegExp("(?:^|;)\\s*"+v+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function c(v,g){if(v){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const _=new TextDecoder(v,{fatal:!0}),E=J_(g);g=_.decode(E),e=!1}catch{}}return g}function a(v){return e&&/[\x80-\xff]/.test(v)&&(v=c("utf-8",v),e&&(v=c("iso-8859-1",v))),v}function l(v){const g=[];let _;const E=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=E.exec(v))!==null;){let[,p,x,y]=_;if(p=parseInt(p,10),p in g){if(p===0)break;continue}g[p]=[x,y]}const b=[];for(let p=0;p<g.length&&p in g;++p){let[x,y]=g[p];y=r(y),x&&(y=unescape(y),p===0&&(y=h(y))),b.push(y)}return b.join("")}function r(v){if(v.startsWith('"')){const g=v.slice(1).split('\\"');for(let _=0;_<g.length;++_){const E=g[_].indexOf('"');E!==-1&&(g[_]=g[_].slice(0,E),g.length=_+1),g[_]=g[_].replaceAll(/\\(.)/g,"$1")}v=g.join('"')}return v}function h(v){const g=v.indexOf("'");if(g===-1)return v;const _=v.slice(0,g),b=v.slice(g+1).replace(/^[^']*'/,"");return c(_,b)}function m(v){return!v.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(v)?v:v.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,_,E,b){if(E==="q"||E==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(p,x){return String.fromCharCode(parseInt(x,16))}),c(_,b);try{b=atob(b)}catch{}return c(_,b)})}return""}function S7(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const c=e[i];c!==void 0&&t.append(i,c)}return t}function a3(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function E7({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const c={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(n.get("Content-Length"),10);return!Number.isInteger(a)||(c.suggestedLength=a,a<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(c.allowRangeRequests=!0),c}function A7(n){const e=n.get("Content-Disposition");if(e){let t=sH(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(B8(t))return t}return null}function nw(n,e){return new B2(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function k7(n){return n===200||n===206}function P7(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function T7(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ei(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class XO{constructor(e){Or(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=S7(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Uo(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new aH(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new lH(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class aH{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),c=t.url;fetch(c,P7(i,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=a3(a.url),!k7(a.status))throw nw(a.status,c);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:r,suggestedLength:h}=E7({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=h||this._contentLength,this._filename=A7(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new hd("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:T7(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class lH{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const c=e.source;this._withCredentials=c.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!c.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${i-1}`);const l=c.url;fetch(l,P7(a,this._withCredentials,this._abortController)).then(r=>{const h=a3(r.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!k7(r.status))throw nw(r.status,l);this._readCapability.resolve(),this._reader=r.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:T7(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const GA=200,KA=206;function cH(n){const e=n.response;return typeof e!="string"?e:J_(e).buffer}class uH{constructor({url:e,httpHeaders:t,withCredentials:i}){Or(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=S7(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,c=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,l]of this.headers)t.setRequestHeader(a,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),c.expectedStatus=KA):c.expectedStatus=GA,t.responseType="arraybuffer",Uo(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),c.onHeadersReceived=e.onHeadersReceived,c.onDone=e.onDone,c.onError=e.onError,c.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var c;const i=this.pendingRequests[e];i&&((c=i.onProgress)==null||c.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const c=i.xhr;if(c.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),c.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],c.status===0&&this.isHttp){i.onError(c.status);return}const a=c.status||GA;if(!(a===GA&&i.expectedStatus===KA)&&a!==i.expectedStatus){i.onError(c.status);return}const r=cH(c);if(a===KA){const h=c.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);m?i.onDone({begin:parseInt(m[1],10),chunk:r}):(ei('Missing or invalid "Content-Range" header.'),i.onError(0))}else r?i.onDone({begin:0,chunk:r}):i.onError(c.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class hH{constructor(e){this._source=e,this._manager=new uH(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Uo(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new fH(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new dH(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class fH{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=a3(t.responseURL);const i=t.getAllResponseHeaders(),c=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(r=>{const[h,...m]=r.split(": ");return[h,m.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=E7({responseHeaders:c,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=A7(c),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=nw(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class dH{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=a3((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=nw(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const pH=/^[a-z][a-z0-9\-+.]+:/i;function mH(n){if(pH.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class gH{constructor(e){this.source=e,this.url=mH(e.url),Uo(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Uo(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new yH(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new bH(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class yH{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(c=>{this._contentLength=c.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},c=>{c.code==="ENOENT"&&(c=nw(0,this._url.href)),this._storedError=c,this._headersCapability.reject(c)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new hd("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class bH{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const c=e.source;this._isStreamingSupported=!c.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const vH=1e5,ZO=30;var pM,Pf,Ra,T1,O1,Sp,Zu,M1,C1,Ep,py,my,Tf,gy,I1,yy,Ap,R1,D1,by,kp,L1,Of,vy,RS,O7,DS,M7,j1,I4,_y,Nx,N1,R4,LS,C7,jS,I7;const _o=class _o{constructor({textContentSource:e,container:t,viewport:i}){Pe(this,RS);Pe(this,DS);Pe(this,j1);Pe(this,Pf,Promise.withResolvers());Pe(this,Ra,null);Pe(this,T1,!1);Pe(this,O1,!!((pM=globalThis.FontInspector)!=null&&pM.enabled));Pe(this,Sp,null);Pe(this,Zu,null);Pe(this,M1,0);Pe(this,C1,0);Pe(this,Ep,null);Pe(this,py,null);Pe(this,my,0);Pe(this,Tf,0);Pe(this,gy,Object.create(null));Pe(this,I1,[]);Pe(this,yy,null);Pe(this,Ap,[]);Pe(this,R1,new WeakMap);Pe(this,D1,null);var h;if(e instanceof ReadableStream)Ie(this,yy,e);else if(typeof e=="object")Ie(this,yy,new ReadableStream({start(m){m.enqueue(e),m.close()}}));else throw new Error('No "textContentSource" parameter specified.');Ie(this,Ra,Ie(this,py,t)),Ie(this,Tf,i.scale*kh.pixelRatio),Ie(this,my,i.rotation),Ie(this,Zu,{div:null,properties:null,ctx:null});const{pageWidth:c,pageHeight:a,pageX:l,pageY:r}=i.rawDims;Ie(this,D1,[1,0,0,-1,-l,r+a]),Ie(this,C1,c),Ie(this,M1,a),We(h=_o,LS,C7).call(h),vm(t,i),D(this,Pf).promise.finally(()=>{D(_o,vy).delete(this),Ie(this,Zu,null),Ie(this,gy,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Bs.platform;return di(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{D(this,Ep).read().then(({value:t,done:i})=>{if(i){D(this,Pf).resolve();return}D(this,Sp)??Ie(this,Sp,t.lang),Object.assign(D(this,gy),t.styles),We(this,RS,O7).call(this,t.items),e()},D(this,Pf).reject)};return Ie(this,Ep,D(this,yy).getReader()),D(_o,vy).add(this),e(),D(this,Pf).promise}update({viewport:e,onBefore:t=null}){var a;const i=e.scale*kh.pixelRatio,c=e.rotation;if(c!==D(this,my)&&(t==null||t(),Ie(this,my,c),vm(D(this,py),{rotation:c})),i!==D(this,Tf)){t==null||t(),Ie(this,Tf,i);const l={div:null,properties:null,ctx:We(a=_o,_y,Nx).call(a,D(this,Sp))};for(const r of D(this,Ap))l.properties=D(this,R1).get(r),l.div=r,We(this,j1,I4).call(this,l)}}cancel(){var t;const e=new hd("TextLayer task cancelled.");(t=D(this,Ep))==null||t.cancel(e).catch(()=>{}),Ie(this,Ep,null),D(this,Pf).reject(e)}get textDivs(){return D(this,Ap)}get textContentItemsStr(){return D(this,I1)}static cleanup(){if(!(D(this,vy).size>0)){D(this,by).clear();for(const{canvas:e}of D(this,kp).values())e.remove();D(this,kp).clear()}}};Pf=new WeakMap,Ra=new WeakMap,T1=new WeakMap,O1=new WeakMap,Sp=new WeakMap,Zu=new WeakMap,M1=new WeakMap,C1=new WeakMap,Ep=new WeakMap,py=new WeakMap,my=new WeakMap,Tf=new WeakMap,gy=new WeakMap,I1=new WeakMap,yy=new WeakMap,Ap=new WeakMap,R1=new WeakMap,D1=new WeakMap,by=new WeakMap,kp=new WeakMap,L1=new WeakMap,Of=new WeakMap,vy=new WeakMap,RS=new WeakSet,O7=function(e){var c,a;if(D(this,T1))return;(a=D(this,Zu)).ctx??(a.ctx=We(c=_o,_y,Nx).call(c,D(this,Sp)));const t=D(this,Ap),i=D(this,I1);for(const l of e){if(t.length>vH){ei("Ignoring additional textDivs for performance reasons."),Ie(this,T1,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const r=D(this,Ra);Ie(this,Ra,document.createElement("span")),D(this,Ra).classList.add("markedContent"),l.id!==null&&D(this,Ra).setAttribute("id",`${l.id}`),r.append(D(this,Ra))}else l.type==="endMarkedContent"&&Ie(this,Ra,D(this,Ra).parentNode);continue}i.push(l.str),We(this,DS,M7).call(this,l)}},DS=new WeakSet,M7=function(e){var p;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};D(this,Ap).push(t);const c=vr.transform(D(this,D1),e.transform);let a=Math.atan2(c[1],c[0]);const l=D(this,gy)[e.fontName];l.vertical&&(a+=Math.PI/2);let r=D(this,O1)&&l.fontSubstitution||l.fontFamily;r=_o.fontFamilyMap.get(r)||r;const h=Math.hypot(c[2],c[3]),m=h*We(p=_o,jS,I7).call(p,r,l,D(this,Sp));let v,g;a===0?(v=c[4],g=c[5]-m):(v=c[4]+m*Math.sin(a),g=c[5]-m*Math.cos(a));const _="calc(var(--total-scale-factor) *",E=t.style;D(this,Ra)===D(this,py)?(E.left=`${(100*v/D(this,C1)).toFixed(2)}%`,E.top=`${(100*g/D(this,M1)).toFixed(2)}%`):(E.left=`${_}${v.toFixed(2)}px)`,E.top=`${_}${g.toFixed(2)}px)`),E.fontSize=`${_}${(D(_o,Of)*h).toFixed(2)}px)`,E.fontFamily=r,i.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,D(this,O1)&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),a!==0&&(i.angle=a*(180/Math.PI));let b=!1;if(e.str.length>1)b=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),y=Math.abs(e.transform[3]);x!==y&&Math.max(x,y)/Math.min(x,y)>1.5&&(b=!0)}if(b&&(i.canvasWidth=l.vertical?e.height:e.width),D(this,R1).set(t,i),D(this,Zu).div=t,D(this,Zu).properties=i,We(this,j1,I4).call(this,D(this,Zu)),i.hasText&&D(this,Ra).append(t),i.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),D(this,Ra).append(x)}},j1=new WeakSet,I4=function(e){var r;const{div:t,properties:i,ctx:c}=e,{style:a}=t;let l="";if(D(_o,Of)>1&&(l=`scale(${1/D(_o,Of)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:h}=a,{canvasWidth:m,fontSize:v}=i;We(r=_o,N1,R4).call(r,c,v*D(this,Tf),h);const{width:g}=c.measureText(t.textContent);g>0&&(l=`scaleX(${m*D(this,Tf)/g}) ${l}`)}i.angle!==0&&(l=`rotate(${i.angle}deg) ${l}`),l.length>0&&(a.transform=l)},_y=new WeakSet,Nx=function(e=null){let t=D(this,kp).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),D(this,kp).set(e,t),D(this,L1).set(t,{size:0,family:""})}return t},N1=new WeakSet,R4=function(e,t,i){const c=D(this,L1).get(e);t===c.size&&i===c.family||(e.font=`${t}px ${i}`,c.size=t,c.family=i)},LS=new WeakSet,C7=function(){if(D(this,Of)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),Ie(this,Of,e.getBoundingClientRect().height),e.remove()},jS=new WeakSet,I7=function(e,t,i){const c=D(this,by).get(e);if(c)return c;const a=We(this,_y,Nx).call(this,i);a.canvas.width=a.canvas.height=ZO,We(this,N1,R4).call(this,a,ZO,e);const l=a.measureText(""),r=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let m=.8;return r?m=r/(r+h):(Bs.platform.isFirefox&&ei("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?m=t.ascent:t.descent&&(m=1+t.descent)),D(this,by).set(e,m),m},Pe(_o,_y),Pe(_o,N1),Pe(_o,LS),Pe(_o,jS),Pe(_o,by,new Map),Pe(_o,kp,new Map),Pe(_o,L1,new WeakMap),Pe(_o,Of,null),Pe(_o,vy,new Set);let Ov=_o;class Mv{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function c(a){var h;if(!a)return;let l=null;const r=a.name;if(r==="#text")l=a.value;else if(Mv.shouldBuildText(r))(h=a==null?void 0:a.attributes)!=null&&h.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&t.push({str:l}),!!a.children)for(const m of a.children)c(m)}return c(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const _H=65536,wH=100;function xH(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new L4,{docId:t}=e,i=n.url?SH(n.url):null,c=n.data?EH(n.data):null,a=n.httpHeaders||null,l=n.withCredentials===!0,r=n.password??null,h=n.range instanceof R7?n.range:null,m=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:_H;let v=n.worker instanceof jg?n.worker:null;const g=n.verbosity,_=typeof n.docBaseUrl=="string"&&!s3(n.docBaseUrl)?n.docBaseUrl:null,E=ix(n.cMapUrl),b=n.cMapPacked!==!1,p=n.CMapReaderFactory||(Ns?$q:jO),x=ix(n.iccUrl),y=ix(n.standardFontDataUrl),f=n.StandardFontDataFactory||(Ns?Bq:NO),w=ix(n.wasmUrl),A=n.WasmFactory||(Ns?Fq:$O),P=n.stopAtErrors!==!0,T=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,R=n.isEvalSupported!==!1,M=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Ns,L=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Ns&&(Bs.platform.isFirefox||!globalThis.chrome),W=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,G=typeof n.disableFontFace=="boolean"?n.disableFontFace:Ns,re=n.fontExtraProperties===!0,Q=n.enableXfa===!0,oe=n.ownerDocument||globalThis.document,ae=n.disableRange===!0,de=n.disableStream===!0,be=n.disableAutoFetch===!0,pe=n.pdfBug===!0,U=n.CanvasFactory||(Ns?Nq:Dq),B=n.FilterFactory||(Ns?jq:Lq),N=n.enableHWA===!0,z=n.useWasm!==!1,H=h?h.length:n.length??NaN,Y=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Ns&&!G,fe=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(p===jO&&f===NO&&A===$O&&E&&y&&w&&sg(E,document.baseURI)&&sg(y,document.baseURI)&&sg(w,document.baseURI)),Re=null;fq(g);const Oe={canvasFactory:new U({ownerDocument:oe,enableHWA:N}),filterFactory:new B({docId:t,ownerDocument:oe}),cMapReaderFactory:fe?null:new p({baseUrl:E,isCompressed:b}),standardFontDataFactory:fe?null:new f({baseUrl:y}),wasmFactory:fe?null:new A({baseUrl:w})};if(!v){const X={verbosity:g,port:gh.workerPort};v=X.port?jg.fromPort(X):new jg(X),e._worker=v}const De={docId:t,apiVersion:"5.0.375",data:c,password:r,disableAutoFetch:be,rangeChunkSize:m,length:H,docBaseUrl:_,enableXfa:Q,evaluatorOptions:{maxImageSize:T,disableFontFace:G,ignoreErrors:P,isEvalSupported:R,isOffscreenCanvasSupported:M,isImageDecoderSupported:L,canvasMaxAreaInBytes:W,fontExtraProperties:re,useSystemFonts:Y,useWasm:z,useWorkerFetch:fe,cMapUrl:E,iccUrl:x,standardFontDataUrl:y,wasmUrl:w}},ot={ownerDocument:oe,pdfBug:pe,styleElement:Re,loadingParams:{disableAutoFetch:be,enableXfa:Q}};return v.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(v.destroyed)throw new Error("Worker was destroyed");const X=v.messageHandler.sendWithPromise("GetDocRequest",De,c?[c.buffer]:null);let ee;if(h)ee=new rH(h,{disableRange:ae,disableStream:de});else if(!c){if(!i)throw new Error("getDocument - no `url` parameter provided.");let Le;if(Ns)if(sg(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Le=XO}else Le=gH;else Le=sg(i)?XO:hH;ee=new Le({url:i,length:H,httpHeaders:a,withCredentials:l,rangeChunkSize:m,disableRange:ae,disableStream:de})}return X.then(Le=>{if(e.destroyed)throw new Error("Loading aborted");if(v.destroyed)throw new Error("Worker was destroyed");const Be=new Nb(t,Le,v.port),se=new MH(Be,e,ee,ot,Oe);e._transport=se,Be.send("Ready",null)})}).catch(e._capability.reject),e}function SH(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Ns)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function EH(n){if(Ns&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return J_(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function ix(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const D4=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,AH=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",kH=xq.bind(null,D4,AH);var NS;const $S=class $S{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${da($S,NS)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,i,c;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(a){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,a}this._transport=null,(c=this._worker)==null||c.destroy(),this._worker=null}};NS=new WeakMap,Pe($S,NS,0);let L4=$S;class R7{constructor(e,t,i=!1,c=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=c,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){zi("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class PH{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return di(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Yu,Pp,Ub;class TH{constructor(e,t,i,c=!1){Pe(this,Pp);Pe(this,Yu,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=c?new RO:null,this._pdfBug=c,this.commonObjs=i.commonObjs,this.objs=new D7,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:c=0,dontFlip:a=!1}={}){return new ew({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:c,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return di(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:c=af.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:r=null,annotationCanvasMap:h=null,pageColors:m=null,printAnnotationStorage:v=null,isEditing:g=!1}){var A,P;(A=this._stats)==null||A.time("Overall");const _=this._transport.getRenderingIntent(i,c,v,g),{renderingIntent:E,cacheKey:b}=_;Ie(this,Yu,!1),r||(r=this._transport.getOptionalContentConfig(E));let p=this._intentStates.get(b);p||(p=Object.create(null),this._intentStates.set(b,p)),p.streamReaderCancelTimeout&&(clearTimeout(p.streamReaderCancelTimeout),p.streamReaderCancelTimeout=null);const x=!!(E&pl.PRINT);p.displayReadyCapability||(p.displayReadyCapability=Promise.withResolvers(),p.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(P=this._stats)==null||P.time("Page Request"),this._pumpOperatorList(_));const y=T=>{var R;p.renderTasks.delete(f),x&&Ie(this,Yu,!0),We(this,Pp,Ub).call(this),T?(f.capability.reject(T),this._abortOperatorList({intentState:p,reason:T instanceof Error?T:new Error(T)})):f.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(R=globalThis.Stats)!=null&&R.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},f=new N4({callback:y,params:{canvasContext:e,viewport:t,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:p.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:m});(p.renderTasks||(p.renderTasks=new Set)).add(f);const w=f.task;return Promise.all([p.displayReadyCapability.promise,r]).then(([T,R])=>{var M;if(this.destroyed){y();return}if((M=this._stats)==null||M.time("Rendering"),!(R.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");f.initializeGraphics({transparency:T,optionalContentConfig:R}),f.operatorListChanged()}).catch(y),w}getOperatorList({intent:e="display",annotationMode:t=af.ENABLE,printAnnotationStorage:i=null,isEditing:c=!1}={}){var m;function a(){r.operatorList.lastChunk&&(r.opListReadCapability.resolve(r.operatorList),r.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(e,t,i,c,!0);let r=this._intentStates.get(l.cacheKey);r||(r=Object.create(null),this._intentStates.set(l.cacheKey,r));let h;return r.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,r.opListReadCapability=Promise.withResolvers(),(r.renderTasks||(r.renderTasks=new Set)).add(h),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(m=this._stats)==null||m.time("Page Request"),this._pumpOperatorList(l)),r.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(c){return c.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Mv.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,c){function a(){l.read().then(function({value:h,done:m}){if(m){i(r);return}r.lang??(r.lang=h.lang),Object.assign(r.styles,h.styles),r.items.push(...h.items),a()},c)}const l=t.getReader(),r={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),Ie(this,Yu,!1),Promise.all(e)}cleanup(e=!1){Ie(this,Yu,!0);const t=We(this,Pp,Ub).call(this);return e&&t&&this._stats&&(this._stats=new RO),t}_startRenderPage(e,t){var c,a;const i=this._intentStates.get(t);i&&((c=this._stats)==null||c.timeEnd("Page Request"),(a=i.displayReadyCapability)==null||a.resolve(e))}_renderPageChunk(e,t){for(let i=0,c=e.length;i<c;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&We(this,Pp,Ub).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:c}){const{map:a,transfer:l}=i,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:c},l).getReader(),m=this._intentStates.get(t);m.streamReader=h;const v=()=>{h.read().then(({value:g,done:_})=>{if(_){m.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,m),v())},g=>{if(m.streamReader=null,!this._transport.destroyed){if(m.operatorList){m.operatorList.lastChunk=!0;for(const _ of m.renderTasks)_.operatorListChanged();We(this,Pp,Ub).call(this)}if(m.displayReadyCapability)m.displayReadyCapability.reject(g);else if(m.opListReadCapability)m.opListReadCapability.reject(g);else throw g}})};v()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof $8){let c=wH;t.extraDelay>0&&t.extraDelay<1e3&&(c+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},c);return}}if(e.streamReader.cancel(new hd(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[c,a]of this._intentStates)if(a===e){this._intentStates.delete(c);break}this.cleanup()}}}get stats(){return this._stats}}Yu=new WeakMap,Pp=new WeakSet,Ub=function(){if(!D(this,Yu)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Ie(this,Yu,!1),!0};var Ju,BS;class OH{constructor(){Pe(this,Ju,new Map);Pe(this,BS,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};D(this,BS).then(()=>{for(const[c]of D(this,Ju))c.call(this,i)})}addEventListener(e,t,i=null){let c=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:a}=i;if(a.aborted){ei("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);c=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}D(this,Ju).set(t,c)}removeEventListener(e,t){const i=D(this,Ju).get(t);i==null||i(),D(this,Ju).delete(t)}terminate(){for(const[,e]of D(this,Ju))e==null||e();D(this,Ju).clear()}}Ju=new WeakMap,BS=new WeakMap;var FS,Tp,Op,wy,$x,xy,Bx;const no=class no{constructor({name:e=null,port:t=null,verbosity:i=dq()}={}){Pe(this,wy);var c;if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((c=D(no,Op))!=null&&c.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(D(no,Op)||Ie(no,Op,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Nb("main","worker",e),this._messageHandler.on("ready",function(){}),We(this,wy,$x).call(this)}_initialize(){if(D(no,Tp)||D(no,xy,Bx)){this._setupFakeWorker();return}let{workerSrc:e}=no;try{no._isSameOrigin(window.location,e)||(e=no._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Nb("main","worker",t),c=()=>{a.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=new AbortController;t.addEventListener("error",()=>{this._webWorker||c()},{signal:a.signal}),i.on("test",r=>{if(a.abort(),this.destroyed||!r){c();return}this._messageHandler=i,this._port=t,this._webWorker=t,We(this,wy,$x).call(this)}),i.on("ready",r=>{if(a.abort(),this.destroyed){c();return}try{l()}catch{this._setupFakeWorker()}});const l=()=>{const r=new Uint8Array;i.send("test",r,[r.buffer])};l();return}catch{o3("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){D(no,Tp)||(ei("Setting up fake worker."),Ie(no,Tp,!0)),no._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new OH;this._port=t;const i=`fake${da(no,FS)._++}`,c=new Nb(i+"_worker",i,t);e.setup(c,t),this._messageHandler=new Nb(i,i+"_worker",t),We(this,wy,$x).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,i;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=D(no,Op))==null||t.delete(this._port),this._port=null,(i=this._messageHandler)==null||i.destroy(),this._messageHandler=null}static fromPort(e){var i;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(i=D(this,Op))==null?void 0:i.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new no(e)}static get workerSrc(){if(gh.workerSrc)return gh.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return di(this,"_setupFakeWorkerGlobal",(async()=>D(this,xy,Bx)?D(this,xy,Bx):(await lq(()=>import(this.workerSrc),__vite__mapDeps([]))).WorkerMessageHandler)())}};FS=new WeakMap,Tp=new WeakMap,Op=new WeakMap,wy=new WeakSet,$x=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},xy=new WeakSet,Bx=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},Pe(no,xy),Pe(no,FS,0),Pe(no,Tp,!1),Pe(no,Op,void 0),Ns&&(Ie(no,Tp,!0),gh.workerSrc||(gh.workerSrc="./pdf.worker.mjs")),no._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const c=new URL(t,i);return i.origin===c.origin},no._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let jg=no;var Qu,Jc,Sy,Ey,eh,Mp,Vb;class MH{constructor(e,t,i,c,a){Pe(this,Mp);Pe(this,Qu,new Map);Pe(this,Jc,new Map);Pe(this,Sy,new Map);Pe(this,Ey,new Map);Pe(this,eh,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new D7,this.fontLoader=new Iq({ownerDocument:c.ownerDocument,styleElement:c.styleElement}),this.loadingParams=c.loadingParams,this._params=c,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return di(this,"annotationStorage",new V8)}getRenderingIntent(e,t=af.ENABLE,i=null,c=!1,a=!1){let l=pl.DISPLAY,r=S4;switch(e){case"any":l=pl.ANY;break;case"display":break;case"print":l=pl.PRINT;break;default:ei(`getRenderingIntent - invalid intent: ${e}`)}const h=l&pl.PRINT&&i instanceof d7?i:this.annotationStorage;switch(t){case af.DISABLE:l+=pl.ANNOTATIONS_DISABLE;break;case af.ENABLE:break;case af.ENABLE_FORMS:l+=pl.ANNOTATIONS_FORMS;break;case af.ENABLE_STORAGE:l+=pl.ANNOTATIONS_STORAGE,r=h.serializable;break;default:ei(`getRenderingIntent - invalid annotationMode: ${t}`)}c&&(l+=pl.IS_EDITING),a&&(l+=pl.OPLIST);const{ids:m,hash:v}=h.modifiedIds,g=[l,r.hash,v];return{renderingIntent:l,cacheKey:g.join("_"),annotationStorageSerializable:r,modifiedIds:m}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=D(this,eh))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const c of D(this,Jc).values())e.push(c._destroy());D(this,Jc).clear(),D(this,Sy).clear(),D(this,Ey).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var c,a;this.commonObjs.clear(),this.fontLoader.clear(),D(this,Qu).clear(),this.filterFactory.destroy(),Ov.cleanup(),(c=this._networkStream)==null||c.cancelAllRequests(new hd("Worker was terminated.")),(a=this.messageHandler)==null||a.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,c)=>{Uo(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},c.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){c.close();return}Uo(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),c.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{c.error(a)})},c.onCancel=a=>{this._fullReader.cancel(a),c.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async i=>{var r;await this._fullReader.headersReady;const{isStreamingSupported:c,isRangeSupported:a,contentLength:l}=this._fullReader;return(!c||!a)&&(this._lastProgress&&((r=t.onProgress)==null||r.call(t,this._lastProgress)),this._fullReader.onProgress=h=>{var m;(m=t.onProgress)==null||m.call(t,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:c,isRangeSupported:a,contentLength:l}}),e.on("GetRangeReader",(i,c)=>{Uo(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(i.begin,i.end);if(!a){c.close();return}c.onPull=()=>{a.read().then(function({value:l,done:r}){if(r){c.close();return}Uo(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),c.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{c.error(l)})},c.onCancel=l=>{a.cancel(l),c.ready.catch(r=>{if(!this.destroyed)throw r})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new PH(i,this))}),e.on("DocException",i=>{t._capability.reject(Ma(i))}),e.on("PasswordRequest",i=>{Ie(this,eh,Promise.withResolvers());try{if(!t.onPassword)throw Ma(i);const c=a=>{a instanceof Error?D(this,eh).reject(a):D(this,eh).resolve({password:a})};t.onPassword(c,i.code)}catch(c){D(this,eh).reject(c)}return D(this,eh).promise}),e.on("DataLoaded",i=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;D(this,Jc).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,c,a])=>{var l;if(this.destroyed||this.commonObjs.has(i))return null;switch(c){case"Font":if("error"in a){const v=a.error;ei(`Error during font loading: ${v}`),this.commonObjs.resolve(i,v);break}const r=this._params.pdfBug&&((l=globalThis.FontInspector)!=null&&l.enabled)?(v,g)=>globalThis.FontInspector.fontAdded(v,g):null,h=new Rq(a,r);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!h.fontExtraProperties&&h.data&&(h.data=null),this.commonObjs.resolve(i,h)});break;case"CopyLocalImage":const{imageRef:m}=a;Uo(m,"The imageRef must be defined.");for(const v of D(this,Jc).values())for(const[,g]of v.objs)if((g==null?void 0:g.ref)===m)return g.dataLen?(this.commonObjs.resolve(i,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,a);break;default:throw new Error(`Got unknown common object type ${c}`)}return null}),e.on("obj",([i,c,a,l])=>{var h;if(this.destroyed)return;const r=D(this,Jc).get(c);if(!r.objs.has(i)){if(r._intentStates.size===0){(h=l==null?void 0:l.bitmap)==null||h.close();return}switch(a){case"Image":case"Pattern":r.objs.resolve(i,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",i=>{var c;this.destroyed||(c=t.onProgress)==null||c.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const c=this[i.type];if(!c)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return c.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&ei("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=D(this,Sy).get(t);if(i)return i;const c=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&D(this,Ey).set(a.refStr,e);const l=new TH(t,a,this,this._params.pdfBug);return D(this,Jc).set(t,l),l});return D(this,Sy).set(t,c),c}getPageIndex(e){return D4(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return We(this,Mp,Vb).call(this,"GetFieldObjects")}hasJSActions(){return We(this,Mp,Vb).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return We(this,Mp,Vb).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return We(this,Mp,Vb).call(this,"GetOptionalContentConfig").then(t=>new nH(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=D(this,Qu).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(c=>{var a,l;return{info:c[0],metadata:c[1]?new eH(c[1]):null,contentDispositionFilename:((a=this._fullReader)==null?void 0:a.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return D(this,Qu).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of D(this,Jc).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),D(this,Qu).clear(),this.filterFactory.destroy(!0),Ov.cleanup()}}cachedPageNumber(e){if(!D4(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return D(this,Ey).get(t)??null}}Qu=new WeakMap,Jc=new WeakMap,Sy=new WeakMap,Ey=new WeakMap,eh=new WeakMap,Mp=new WeakSet,Vb=function(e,t=null){const i=D(this,Qu).get(e);if(i)return i;const c=this.messageHandler.sendWithPromise(e,t);return D(this,Qu).set(e,c),c};const Ab=Symbol("INITIAL_DATA");var il,$1,j4;class D7{constructor(){Pe(this,$1);Pe(this,il,Object.create(null))}get(e,t=null){if(t){const c=We(this,$1,j4).call(this,e);return c.promise.then(()=>t(c.data)),null}const i=D(this,il)[e];if(!i||i.data===Ab)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=D(this,il)[e];return!!t&&t.data!==Ab}delete(e){const t=D(this,il)[e];return!t||t.data===Ab?!1:(delete D(this,il)[e],!0)}resolve(e,t=null){const i=We(this,$1,j4).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in D(this,il)){const{data:i}=D(this,il)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}Ie(this,il,Object.create(null))}*[Symbol.iterator](){for(const e in D(this,il)){const{data:t}=D(this,il)[e];t!==Ab&&(yield[e,t])}}}il=new WeakMap,$1=new WeakSet,j4=function(e){var t;return(t=D(this,il))[e]||(t[e]={...Promise.withResolvers(),data:Ab})};var Mf;class CH{constructor(e){Pe(this,Mf,null);Or(this,"onContinue",null);Or(this,"onError",null);Ie(this,Mf,e)}get promise(){return D(this,Mf).capability.promise}cancel(e=0){D(this,Mf).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=D(this,Mf).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=D(this,Mf);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Mf=new WeakMap;var Cf,Cp;const Fd=class Fd{constructor({callback:e,params:t,objs:i,commonObjs:c,annotationCanvasMap:a,operatorList:l,pageIndex:r,canvasFactory:h,filterFactory:m,useRequestAnimationFrame:v=!1,pdfBug:g=!1,pageColors:_=null}){Pe(this,Cf,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=c,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=r,this.canvasFactory=h,this.filterFactory=m,this._pdfBug=g,this.pageColors=_,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=v===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new CH(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var r,h;if(this.cancelled)return;if(this._canvas){if(D(Fd,Cp).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");D(Fd,Cp).add(this._canvas)}this._pdfBug&&((r=globalThis.StepperManager)!=null&&r.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:c,transform:a,background:l}=this.params;this.gfx=new Lg(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:c,transparency:e,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(e=null,t=0){var i,c,a;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),D(this,Cf)&&(window.cancelAnimationFrame(D(this,Cf)),Ie(this,Cf,null)),D(Fd,Cp).delete(this._canvas),e||(e=new $8(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(a=(c=this.task).onError)==null||a.call(c,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?Ie(this,Cf,window.requestAnimationFrame(()=>{Ie(this,Cf,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),D(Fd,Cp).delete(this._canvas),this.callback())))}};Cf=new WeakMap,Cp=new WeakMap,Pe(Fd,Cp,new WeakSet);let N4=Fd;const IH="5.0.375",RH="23972e194";function YO(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function kb(n){return Math.max(0,Math.min(255,255*n))}class JO{static CMYK_G([e,t,i,c]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+c)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=kb(e),[e,e,e]}static G_HTML([e]){const t=YO(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(kb)}static RGB_HTML(e){return`#${e.map(YO).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,c]){return["RGB",1-Math.min(1,e+c),1-Math.min(1,i+c),1-Math.min(1,t+c)]}static CMYK_rgb([e,t,i,c]){return[kb(1-Math.min(1,e+c)),kb(1-Math.min(1,i+c)),kb(1-Math.min(1,t+c))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const c=1-e,a=1-t,l=1-i,r=Math.min(c,a,l);return["CMYK",c,a,l,r]}}class DH{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const c=this._createSVG("svg:svg");return c.setAttribute("version","1.1"),i||(c.setAttribute("width",`${e}px`),c.setAttribute("height",`${t}px`)),c.setAttribute("preserveAspectRatio","none"),c.setAttribute("viewBox",`0 0 ${e} ${t}`),c}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){zi("Abstract method `_createSVG` called.")}}class U2 extends DH{_createSVG(e){return document.createElementNS(Ru,e)}}class L7{static setupStorage(e,t,i,c,a){const l=c.getValue(t,{value:null});switch(i.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),a==="print")break;e.addEventListener("input",r=>{c.setValue(t,{value:r.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(l.value===i.attributes.xfaOn?e.setAttribute("checked",!0):l.value===i.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",r=>{c.setValue(t,{value:r.target.checked?r.target.getAttribute("xfaOn"):r.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),a==="print")break;e.addEventListener("input",r=>{c.setValue(t,{value:r.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const r of i.children)r.attributes.value===l.value?r.attributes.selected=!0:r.attributes.hasOwnProperty("selected")&&delete r.attributes.selected}e.addEventListener("input",r=>{const h=r.target.options,m=h.selectedIndex===-1?"":h[h.selectedIndex].value;c.setValue(t,{value:m})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:c,linkService:a}){const{attributes:l}=t,r=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${c}`);for(const[h,m]of Object.entries(l))if(m!=null)switch(h){case"class":m.length&&e.setAttribute(h,m.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",m);break;case"style":Object.assign(e.style,m);break;case"textContent":e.textContent=m;break;default:(!r||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,m)}r&&a.addLinkAttributes(e,l.href,l.newWindow),i&&l.dataId&&this.setupStorage(e,l.dataId,t,i)}static render(e){var g,_;const t=e.annotationStorage,i=e.linkService,c=e.xfaHtml,a=e.intent||"display",l=document.createElement(c.name);c.attributes&&this.setAttributes({html:l,element:c,intent:a,linkService:i});const r=a!=="richText",h=e.div;if(h.append(l),e.viewport){const E=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=E}r&&h.setAttribute("class","xfaLayer xfaFont");const m=[];if(c.children.length===0){if(c.value){const E=document.createTextNode(c.value);l.append(E),r&&Mv.shouldBuildText(c.name)&&m.push(E)}return{textDivs:m}}const v=[[c,-1,l]];for(;v.length>0;){const[E,b,p]=v.at(-1);if(b+1===E.children.length){v.pop();continue}const x=E.children[++v.at(-1)[1]];if(x===null)continue;const{name:y}=x;if(y==="#text"){const w=document.createTextNode(x.value);m.push(w),p.append(w);continue}const f=(g=x==null?void 0:x.attributes)!=null&&g.xmlns?document.createElementNS(x.attributes.xmlns,y):document.createElement(y);if(p.append(f),x.attributes&&this.setAttributes({html:f,element:x,storage:t,intent:a,linkService:i}),((_=x.children)==null?void 0:_.length)>0)v.push([x,-1,f]);else if(x.value){const w=document.createTextNode(x.value);r&&Mv.shouldBuildText(y)&&m.push(w),f.append(w)}}for(const E of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))E.setAttribute("readOnly",!0);return{textDivs:m}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const rw=1e3,LH=9,wm=new WeakSet;class QO{static create(e){switch(e.data.annotationType){case Bo.LINK:return new j7(e);case Bo.TEXT:return new jH(e);case Bo.WIDGET:switch(e.data.fieldType){case"Tx":return new NH(e);case"Btn":return e.data.radioButton?new B7(e):e.data.checkBox?new BH(e):new FH(e);case"Ch":return new zH(e);case"Sig":return new $H(e)}return new km(e);case Bo.POPUP:return new B4(e);case Bo.FREETEXT:return new q7(e);case Bo.LINE:return new VH(e);case Bo.SQUARE:return new qH(e);case Bo.CIRCLE:return new HH(e);case Bo.POLYLINE:return new H7(e);case Bo.CARET:return new GH(e);case Bo.INK:return new W8(e);case Bo.POLYGON:return new WH(e);case Bo.HIGHLIGHT:return new W7(e);case Bo.UNDERLINE:return new KH(e);case Bo.SQUIGGLY:return new XH(e);case Bo.STRIKEOUT:return new ZH(e);case Bo.STAMP:return new G7(e);case Bo.FILEATTACHMENT:return new YH(e);default:return new Co(e)}}}var Ip,Ay,ky,B1,$4;const ik=class ik{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:c=!1}={}){Pe(this,B1);Pe(this,Ip,null);Pe(this,Ay,!1);Pe(this,ky,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),c&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e!=null&&e.str||t!=null&&t.str||i!=null&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ik._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;D(this,Ip)||Ie(this,Ip,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&We(this,B1,$4).call(this,t),(i=D(this,ky))==null||i.popup.updateEdited(e)}resetEdited(){var e;D(this,Ip)&&(We(this,B1,$4).call(this,D(this,Ip).rect),(e=D(this,ky))==null||e.popup.resetEdited(),Ie(this,Ip,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:c}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),this instanceof km||(a.tabIndex=rw);const{style:l}=a;if(l.zIndex=this.parent.zIndex++,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof B4){const{rotation:p}=t;return!t.hasOwnCanvas&&p!==0&&this.setRotation(p,a),a}const{width:r,height:h}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const p=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(p>0||x>0){const f=`calc(${p}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;l.borderRadius=f}else if(this instanceof B7){const f=`calc(${r}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=f}switch(t.borderStyle.style){case og.SOLID:l.borderStyle="solid";break;case og.DASHED:l.borderStyle="dashed";break;case og.BEVELED:ei("Unimplemented border style: beveled");break;case og.INSET:ei("Unimplemented border style: inset");break;case og.UNDERLINE:l.borderBottomStyle="solid";break}const y=t.borderColor||null;y?(Ie(this,Ay,!0),l.borderColor=vr.makeHexColor(y[0]|0,y[1]|0,y[2]|0)):l.borderWidth=0}const m=vr.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:v,pageHeight:g,pageX:_,pageY:E}=c.rawDims;l.left=`${100*(m[0]-_)/v}%`,l.top=`${100*(m[1]-E)/g}%`;const{rotation:b}=t;return t.hasOwnCanvas||b===0?(l.width=`${100*r/v}%`,l.height=`${100*h/g}%`):this.setRotation(b,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:c}=this.parent.viewport.rawDims;let{width:a,height:l}=this;e%180!==0&&([a,l]=[l,a]),t.style.width=`${100*a/i}%`,t.style.height=`${100*l/c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,c)=>{const a=c.detail[t],l=a[0],r=a.slice(1);c.target.style[i]=JO[`${l}_HTML`](r),this.annotationStorage.setValue(this.data.id,{[i]:JO[`${l}_rgb`](r)})};return di(this,"_commonActions",{display:t=>{const{display:i}=t.detail,c=i%2===1;this.container.style.visibility=c?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:c,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const c of Object.keys(t.detail)){const a=e[c]||i[c];a==null||a(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[c,a]of Object.entries(t)){const l=i[c];if(l){const r={detail:{[c]:a},target:e};l(r),delete t[c]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,c,a]=this.data.rect.map(p=>Math.fround(p));if(e.length===8){const[p,x,y,f]=e.subarray(2,6);if(c===p&&a===x&&t===y&&i===f)return}const{style:l}=this.container;let r;if(D(this,Ay)){const{borderColor:p,borderWidth:x}=l;l.borderWidth=0,r=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${p}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const h=c-t,m=a-i,{svgFactory:v}=this,g=v.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0);const _=v.createElement("defs");g.append(_);const E=v.createElement("clipPath"),b=`clippath_${this.data.id}`;E.setAttribute("id",b),E.setAttribute("clipPathUnits","objectBoundingBox"),_.append(E);for(let p=2,x=e.length;p<x;p+=8){const y=e[p],f=e[p+1],w=e[p+2],A=e[p+3],P=v.createElement("rect"),T=(w-t)/h,R=(a-f)/m,M=(y-w)/h,L=(f-A)/m;P.setAttribute("x",T),P.setAttribute("y",R),P.setAttribute("width",M),P.setAttribute("height",L),E.append(P),r==null||r.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${R}" width="${M}" height="${L}"/>`)}D(this,Ay)&&(r.push("</g></svg>')"),l.backgroundImage=r.join("")),this.container.append(g),this.container.style.clipPath=`url(#${b})`}_createPopup(){const{data:e}=this,t=Ie(this,ky,new B4({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){zi("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const c=this._fieldObjects[e];if(c)for(const{page:a,id:l,exportValues:r}of c){if(a===-1||l===t)continue;const h=typeof r=="string"?r:null,m=document.querySelector(`[data-element-id="${l}"]`);if(m&&!wm.has(m)){ei(`_getElementsByName - element not allowed: ${l}`);continue}i.push({id:l,exportValue:h,domElement:m})}return i}for(const c of document.getElementsByName(e)){const{exportValue:a}=c,l=c.getAttribute("data-element-id");l!==t&&wm.has(c)&&i.push({id:l,exportValue:a,domElement:c})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Ip=new WeakMap,Ay=new WeakMap,ky=new WeakMap,B1=new WeakSet,$4=function(e){const{container:{style:t},data:{rect:i,rotation:c},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:r,pageY:h}}}}=this;i==null||i.splice(0,4,...e),t.left=`${100*(e[0]-r)/a}%`,t.top=`${100*(l-e[3]+h)/l}%`,c===0?(t.width=`${100*(e[2]-e[0])/a}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(c)};let Co=ik;var th,jd,zS,N7,US,$7;class j7 extends Co{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});Pe(this,th);Pe(this,zS);Pe(this,US);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,c=document.createElement("a");c.setAttribute("data-element-id",t.id);let a=!1;return t.url?(i.addLinkAttributes(c,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(c,t.action),a=!0):t.attachment?(We(this,zS,N7).call(this,c,t.attachment,t.attachmentDest),a=!0):t.setOCGState?(We(this,US,$7).call(this,c,t.setOCGState),a=!0):t.dest?(this._bindLink(c,t.dest),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(c,t),a=!0),t.resetForm?(this._bindResetFormAction(c,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(c,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&this.container.append(c),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&We(this,th,jd).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),We(this,th,jd).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const c=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(i.actions)){const l=c.get(a);l&&(t[l]=()=>{var r;return(r=this.linkService.eventBus)==null||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:a}}),!1})}t.onclick||(t.onclick=()=>!1),We(this,th,jd).call(this)}_bindResetFormAction(t,i){const c=t.onclick;if(c||(t.href=this.linkService.getAnchorUrl("")),We(this,th,jd).call(this),!this._fieldObjects){ei('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),c||(t.onclick=()=>!1);return}t.onclick=()=>{var g;c==null||c();const{fields:a,refs:l,include:r}=i,h=[];if(a.length!==0||l.length!==0){const _=new Set(l);for(const E of a){const b=this._fieldObjects[E]||[];for(const{id:p}of b)_.add(p)}for(const E of Object.values(this._fieldObjects))for(const b of E)_.has(b.id)===r&&h.push(b)}else for(const _ of Object.values(this._fieldObjects))h.push(..._);const m=this.annotationStorage,v=[];for(const _ of h){const{id:E}=_;switch(v.push(E),_.type){case"text":{const p=_.defaultValue||"";m.setValue(E,{value:p});break}case"checkbox":case"radiobutton":{const p=_.defaultValue===_.exportValues;m.setValue(E,{value:p});break}case"combobox":case"listbox":{const p=_.defaultValue||"";m.setValue(E,{value:p});break}default:continue}const b=document.querySelector(`[data-element-id="${E}"]`);if(b){if(!wm.has(b)){ei(`_bindResetFormAction - element not allowed: ${E}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:v,name:"ResetForm"}})),!1}}}th=new WeakSet,jd=function(){this.container.setAttribute("data-internal-link","")},zS=new WeakSet,N7=function(t,i,c=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(i.content,i.filename,c),!1},We(this,th,jd).call(this)},US=new WeakSet,$7=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),We(this,th,jd).call(this)};class jH extends Co{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class km extends Co{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Bs.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,c,a){i.includes("mouse")?e.addEventListener(i,l=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:c,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(i,l=>{var r;if(i==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}a&&((r=this.linkService.eventBus)==null||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:c,value:a(l)}}))})}_setEventListeners(e,t,i,c){var a,l,r;for(const[h,m]of i)(m==="Action"||(a=this.data.actions)!=null&&a[m])&&((m==="Focus"||m==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,h,m,c),m==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(e,t,"blur","Blur",null):m==="Blur"&&!((r=this.data.actions)!=null&&r.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":vr.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,c=this.data.defaultAppearanceData.fontSize||LH,a=e.style;let l;const r=2,h=m=>Math.round(10*m)/10;if(this.data.multiLine){const m=Math.abs(this.data.rect[3]-this.data.rect[1]-r),v=Math.round(m/(UA*c))||1,g=m/v;l=Math.min(c,h(g/UA))}else{const m=Math.abs(this.data.rect[3]-this.data.rect[1]-r);l=Math.min(c,h(m/UA))}a.fontSize=`calc(${l}px * var(--total-scale-factor))`,a.color=vr.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class NH extends km{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,c){const a=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=i),a.setValue(l.id,{[c]:i})}render(){var c,a;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const l=e.getValue(t,{value:this.data.fieldValue});let r=l.value||"";const h=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;h&&r.length>h&&(r=r.slice(0,h));let m=l.formattedValue||((c=this.data.textContent)==null?void 0:c.join(`
`))||null;m&&this.data.comb&&(m=m.replaceAll(/\s+/g,""));const v={userValue:r,formattedValue:m,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=m??r,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",m??r),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),wm.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=rw,this._setRequired(i,this.data.required),h&&(i.maxLength=h),i.addEventListener("input",_=>{e.setValue(t,{value:_.target.value}),this.setPropertyOnSiblings(i,"value",_.target.value,"value"),v.formattedValue=null}),i.addEventListener("resetform",_=>{const E=this.data.defaultFieldValue??"";i.value=v.userValue=E,v.formattedValue=null});let g=_=>{const{formattedValue:E}=v;E!=null&&(_.target.value=E),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",E=>{var p;if(v.focused)return;const{target:b}=E;v.userValue&&(b.value=v.userValue),v.lastCommittedValue=b.value,v.commitKey=1,(p=this.data.actions)!=null&&p.Focus||(v.focused=!0)}),i.addEventListener("updatefromsandbox",E=>{this.showElementAndHideCanvas(E.target);const b={value(p){v.userValue=p.detail.value??"",e.setValue(t,{value:v.userValue.toString()}),p.target.value=v.userValue},formattedValue(p){const{formattedValue:x}=p.detail;v.formattedValue=x,x!=null&&p.target!==document.activeElement&&(p.target.value=x),e.setValue(t,{formattedValue:x})},selRange(p){p.target.setSelectionRange(...p.detail.selRange)},charLimit:p=>{var w;const{charLimit:x}=p.detail,{target:y}=p;if(x===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",x);let f=v.userValue;!f||f.length<=x||(f=f.slice(0,x),y.value=v.userValue=f,e.setValue(t,{value:f}),(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(b,E)}),i.addEventListener("keydown",E=>{var x;v.commitKey=1;let b=-1;if(E.key==="Escape"?b=0:E.key==="Enter"&&!this.data.multiLine?b=2:E.key==="Tab"&&(v.commitKey=3),b===-1)return;const{value:p}=E.target;v.lastCommittedValue!==p&&(v.lastCommittedValue=p,v.userValue=p,(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,willCommit:!0,commitKey:b,selStart:E.target.selectionStart,selEnd:E.target.selectionEnd}}))});const _=g;g=null,i.addEventListener("blur",E=>{var p,x;if(!v.focused||!E.relatedTarget)return;(p=this.data.actions)!=null&&p.Blur||(v.focused=!1);const{value:b}=E.target;v.userValue=b,v.lastCommittedValue!==b&&((x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:v.commitKey,selStart:E.target.selectionStart,selEnd:E.target.selectionEnd}})),_(E)}),(a=this.data.actions)!=null&&a.Keystroke&&i.addEventListener("beforeinput",E=>{var P;v.lastCommittedValue=null;const{data:b,target:p}=E,{value:x,selectionStart:y,selectionEnd:f}=p;let w=y,A=f;switch(E.inputType){case"deleteWordBackward":{const T=x.substring(0,y).match(/\w*[^\w]*$/);T&&(w-=T[0].length);break}case"deleteWordForward":{const T=x.substring(y).match(/^[^\w]*\w*/);T&&(A+=T[0].length);break}case"deleteContentBackward":y===f&&(w-=1);break;case"deleteContentForward":y===f&&(A+=1);break}E.preventDefault(),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,change:b||"",willCommit:!1,selStart:w,selEnd:A}})}),this._setEventListeners(i,v,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],E=>E.target.value)}if(g&&i.addEventListener("blur",g),this.data.comb){const E=(this.data.rect[2]-this.data.rect[0])/h;i.classList.add("comb"),i.style.letterSpacing=`calc(${E}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class $H extends km{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class BH extends km{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let c=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof c=="string"&&(c=c!=="Off",e.setValue(i,{value:c})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return wm.add(a),a.setAttribute("data-element-id",i),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,c&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=rw,a.addEventListener("change",l=>{const{name:r,checked:h}=l.target;for(const m of this._getElementsByName(r,i)){const v=h&&m.exportValue===t.exportValue;m.domElement&&(m.domElement.checked=v),e.setValue(m.id,{value:v})}e.setValue(i,{value:h})}),a.addEventListener("resetform",l=>{const r=t.defaultFieldValue||"Off";l.target.checked=r===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const r={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(i,{value:h.target.checked})}};this._dispatchEventFromSandbox(r,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class B7 extends km{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let c=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof c=="string"&&(c=c!==t.buttonValue,e.setValue(i,{value:c})),c)for(const l of this._getElementsByName(t.fieldName,i))e.setValue(l.id,{value:!1});const a=document.createElement("input");if(wm.add(a),a.setAttribute("data-element-id",i),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,c&&a.setAttribute("checked",!0),a.tabIndex=rw,a.addEventListener("change",l=>{const{name:r,checked:h}=l.target;for(const m of this._getElementsByName(r,i))e.setValue(m.id,{value:!1});e.setValue(i,{value:h})}),a.addEventListener("resetform",l=>{const r=t.defaultFieldValue;l.target.checked=r!=null&&r===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;a.addEventListener("updatefromsandbox",r=>{const h={value:m=>{const v=l===m.detail.value;for(const g of this._getElementsByName(m.target.name)){const _=v&&g.id===i;g.domElement&&(g.domElement.checked=_),e.setValue(g.id,{value:_})}}};this._dispatchEventFromSandbox(h,r)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],r=>r.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class FH extends j7{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class zH extends km{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),c=document.createElement("select");wm.add(c),c.setAttribute("data-element-id",t),c.disabled=this.data.readOnly,this._setRequired(c,this.data.required),c.name=this.data.fieldName,c.tabIndex=rw;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(c.size=this.data.options.length,this.data.multiSelect&&(c.multiple=!0)),c.addEventListener("resetform",v=>{const g=this.data.defaultFieldValue;for(const _ of c.options)_.selected=_.value===g});for(const v of this.data.options){const g=document.createElement("option");g.textContent=v.displayValue,g.value=v.exportValue,i.value.includes(v.exportValue)&&(g.setAttribute("selected",!0),a=!1),c.append(g)}let l=null;if(a){const v=document.createElement("option");v.value=" ",v.setAttribute("hidden",!0),v.setAttribute("selected",!0),c.prepend(v),l=()=>{v.remove(),c.removeEventListener("input",l),l=null},c.addEventListener("input",l)}const r=v=>{const g=v?"value":"textContent",{options:_,multiple:E}=c;return E?Array.prototype.filter.call(_,b=>b.selected).map(b=>b[g]):_.selectedIndex===-1?null:_[_.selectedIndex][g]};let h=r(!1);const m=v=>{const g=v.target.options;return Array.prototype.map.call(g,_=>({displayValue:_.textContent,exportValue:_.value}))};return this.enableScripting&&this.hasJSActions?(c.addEventListener("updatefromsandbox",v=>{const g={value(_){l==null||l();const E=_.detail.value,b=new Set(Array.isArray(E)?E:[E]);for(const p of c.options)p.selected=b.has(p.value);e.setValue(t,{value:r(!0)}),h=r(!1)},multipleSelection(_){c.multiple=!0},remove(_){const E=c.options,b=_.detail.remove;E[b].selected=!1,c.remove(b),E.length>0&&Array.prototype.findIndex.call(E,x=>x.selected)===-1&&(E[0].selected=!0),e.setValue(t,{value:r(!0),items:m(_)}),h=r(!1)},clear(_){for(;c.length!==0;)c.remove(0);e.setValue(t,{value:null,items:[]}),h=r(!1)},insert(_){const{index:E,displayValue:b,exportValue:p}=_.detail.insert,x=c.children[E],y=document.createElement("option");y.textContent=b,y.value=p,x?x.before(y):c.append(y),e.setValue(t,{value:r(!0),items:m(_)}),h=r(!1)},items(_){const{items:E}=_.detail;for(;c.length!==0;)c.remove(0);for(const b of E){const{displayValue:p,exportValue:x}=b,y=document.createElement("option");y.textContent=p,y.value=x,c.append(y)}c.options.length>0&&(c.options[0].selected=!0),e.setValue(t,{value:r(!0),items:m(_)}),h=r(!1)},indices(_){const E=new Set(_.detail.indices);for(const b of _.target.options)b.selected=E.has(b.index);e.setValue(t,{value:r(!0)}),h=r(!1)},editable(_){_.target.disabled=!_.detail.editable}};this._dispatchEventFromSandbox(g,v)}),c.addEventListener("input",v=>{var E;const g=r(!0),_=r(!1);e.setValue(t,{value:g}),v.preventDefault(),(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:_,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(c,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],v=>v.target.value)):c.addEventListener("input",function(v){e.setValue(t,{value:r(!0)})}),this.data.combo&&this._setTextStyle(c),this._setBackgroundColor(c),this._setDefaultPropertiesFromJS(c),this.container.append(c),this.container}}class B4 extends Co{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:Co._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new UH({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${N8}${i}`).join(",")),this.container}}var Py,VS,qS,Ty,Oy,wo,nh,My,F1,z1,Cy,rh,cc,ih,U1,oh,V1,Rp,Dp,Iy,Fx,q1,F4,HS,F7,WS,z7,GS,U7,KS,V7,Ry,zx,Dy,Ux,H1,z4;class UH{constructor({container:e,color:t,elements:i,titleObj:c,modificationDate:a,contentsObj:l,richText:r,parent:h,rect:m,parentRect:v,open:g}){Pe(this,Iy);Pe(this,q1);Pe(this,HS);Pe(this,WS);Pe(this,GS);Pe(this,KS);Pe(this,Ry);Pe(this,Dy);Pe(this,H1);Pe(this,Py,We(this,GS,U7).bind(this));Pe(this,VS,We(this,H1,z4).bind(this));Pe(this,qS,We(this,Dy,Ux).bind(this));Pe(this,Ty,We(this,Ry,zx).bind(this));Pe(this,Oy,null);Pe(this,wo,null);Pe(this,nh,null);Pe(this,My,null);Pe(this,F1,null);Pe(this,z1,null);Pe(this,Cy,null);Pe(this,rh,!1);Pe(this,cc,null);Pe(this,ih,null);Pe(this,U1,null);Pe(this,oh,null);Pe(this,V1,null);Pe(this,Rp,null);Pe(this,Dp,!1);var _;Ie(this,wo,e),Ie(this,V1,c),Ie(this,nh,l),Ie(this,oh,r),Ie(this,z1,h),Ie(this,Oy,t),Ie(this,U1,m),Ie(this,Cy,v),Ie(this,F1,i),Ie(this,My,F8.toDateObject(a)),this.trigger=i.flatMap(E=>E.getElementsToTriggerPopup());for(const E of this.trigger)E.addEventListener("click",D(this,Ty)),E.addEventListener("mouseenter",D(this,qS)),E.addEventListener("mouseleave",D(this,VS)),E.classList.add("popupTriggerArea");for(const E of i)(_=E.container)==null||_.addEventListener("keydown",D(this,Py));D(this,wo).hidden=!0,g&&We(this,Ry,zx).call(this)}render(){if(D(this,cc))return;const e=Ie(this,cc,document.createElement("div"));if(e.className="popup",D(this,Oy)){const a=e.style.outlineColor=vr.makeHexColor(...D(this,Oy));e.style.backgroundColor=`color-mix(in srgb, ${a} 30%, white)`}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=D(this,V1),e.append(t),D(this,My)){const a=document.createElement("span");a.classList.add("popupDate"),a.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),a.setAttribute("data-l10n-args",JSON.stringify({dateObj:D(this,My).valueOf()})),t.append(a)}const c=D(this,Iy,Fx);if(c)L7.render({xfaHtml:c,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const a=this._formatContents(D(this,nh));e.append(a)}D(this,wo).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const c=e.split(/(?:\r\n?|\n)/);for(let a=0,l=c.length;a<l;++a){const r=c[a];i.append(document.createTextNode(r)),a<l-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){var i;D(this,Rp)||Ie(this,Rp,{contentsObj:D(this,nh),richText:D(this,oh)}),e&&Ie(this,ih,null),t&&(Ie(this,oh,We(this,WS,z7).call(this,t)),Ie(this,nh,null)),(i=D(this,cc))==null||i.remove(),Ie(this,cc,null)}resetEdited(){var e;D(this,Rp)&&({contentsObj:da(this,nh)._,richText:da(this,oh)._}=D(this,Rp),Ie(this,Rp,null),(e=D(this,cc))==null||e.remove(),Ie(this,cc,null),Ie(this,ih,null))}forceHide(){Ie(this,Dp,this.isVisible),D(this,Dp)&&(D(this,wo).hidden=!0)}maybeShow(){D(this,Dp)&&(D(this,cc)||We(this,Dy,Ux).call(this),Ie(this,Dp,!1),D(this,wo).hidden=!1)}get isVisible(){return D(this,wo).hidden===!1}}Py=new WeakMap,VS=new WeakMap,qS=new WeakMap,Ty=new WeakMap,Oy=new WeakMap,wo=new WeakMap,nh=new WeakMap,My=new WeakMap,F1=new WeakMap,z1=new WeakMap,Cy=new WeakMap,rh=new WeakMap,cc=new WeakMap,ih=new WeakMap,U1=new WeakMap,oh=new WeakMap,V1=new WeakMap,Rp=new WeakMap,Dp=new WeakMap,Iy=new WeakSet,Fx=function(){const e=D(this,oh),t=D(this,nh);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&D(this,oh).html||null},q1=new WeakSet,F4=function(){var e,t,i;return((i=(t=(e=D(this,Iy,Fx))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},HS=new WeakSet,F7=function(){var e,t,i;return((i=(t=(e=D(this,Iy,Fx))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},WS=new WeakSet,z7=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},c={style:{color:D(this,HS,F7),fontSize:D(this,q1,F4)?`calc(${D(this,q1,F4)}px * var(--total-scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:c});return i},GS=new WeakSet,U7=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&D(this,rh))&&We(this,Ry,zx).call(this)},KS=new WeakSet,V7=function(){if(D(this,ih)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:c,pageY:a}}}=D(this,z1);let l=!!D(this,Cy),r=l?D(this,Cy):D(this,U1);for(const b of D(this,F1))if(!r||vr.intersect(b.data.rect,r)!==null){r=b.data.rect,l=!0;break}const h=vr.normalizeRect([r[0],e[3]-r[1]+e[1],r[2],e[3]-r[3]+e[1]]),v=l?r[2]-r[0]+5:0,g=h[0]+v,_=h[1];Ie(this,ih,[100*(g-c)/t,100*(_-a)/i]);const{style:E}=D(this,wo);E.left=`${D(this,ih)[0]}%`,E.top=`${D(this,ih)[1]}%`},Ry=new WeakSet,zx=function(){Ie(this,rh,!D(this,rh)),D(this,rh)?(We(this,Dy,Ux).call(this),D(this,wo).addEventListener("click",D(this,Ty)),D(this,wo).addEventListener("keydown",D(this,Py))):(We(this,H1,z4).call(this),D(this,wo).removeEventListener("click",D(this,Ty)),D(this,wo).removeEventListener("keydown",D(this,Py)))},Dy=new WeakSet,Ux=function(){D(this,cc)||this.render(),this.isVisible?D(this,rh)&&D(this,wo).classList.add("focused"):(We(this,KS,V7).call(this),D(this,wo).hidden=!1,D(this,wo).style.zIndex=parseInt(D(this,wo).style.zIndex)+1e3)},H1=new WeakSet,z4=function(){D(this,wo).classList.remove("focused"),!(D(this,rh)||!this.isVisible)&&(D(this,wo).hidden=!0,D(this,wo).style.zIndex=parseInt(D(this,wo).style.zIndex)-1e3)};class q7 extends Co{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Yr.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var W1;class VH extends Co{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Pe(this,W1,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:c}=this,a=this.svgFactory.create(i,c,!0),l=Ie(this,W1,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return D(this,W1)}addHighlightArea(){this.container.classList.add("highlightArea")}}W1=new WeakMap;var G1;class qH extends Co{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Pe(this,G1,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:c}=this,a=this.svgFactory.create(i,c,!0),l=t.borderStyle.width,r=Ie(this,G1,this.svgFactory.createElement("svg:rect"));return r.setAttribute("x",l/2),r.setAttribute("y",l/2),r.setAttribute("width",i-l),r.setAttribute("height",c-l),r.setAttribute("stroke-width",l||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),a.append(r),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return D(this,G1)}addHighlightArea(){this.container.classList.add("highlightArea")}}G1=new WeakMap;var K1;class HH extends Co{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Pe(this,K1,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:c}=this,a=this.svgFactory.create(i,c,!0),l=t.borderStyle.width,r=Ie(this,K1,this.svgFactory.createElement("svg:ellipse"));return r.setAttribute("cx",i/2),r.setAttribute("cy",c/2),r.setAttribute("rx",i/2-l/2),r.setAttribute("ry",c/2-l/2),r.setAttribute("stroke-width",l||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),a.append(r),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return D(this,K1)}addHighlightArea(){this.container.classList.add("highlightArea")}}K1=new WeakMap;var X1;class H7 extends Co{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Pe(this,X1,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:c,popupRef:a},width:l,height:r}=this;if(!i)return this.container;const h=this.svgFactory.create(l,r,!0);let m=[];for(let g=0,_=i.length;g<_;g+=2){const E=i[g]-t[0],b=t[3]-i[g+1];m.push(`${E},${b}`)}m=m.join(" ");const v=Ie(this,X1,this.svgFactory.createElement(this.svgElementName));return v.setAttribute("points",m),v.setAttribute("stroke-width",c.width||1),v.setAttribute("stroke","transparent"),v.setAttribute("fill","transparent"),h.append(v),this.container.append(h),!a&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return D(this,X1)}addHighlightArea(){this.container.classList.add("highlightArea")}}X1=new WeakMap;class WH extends H7{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class GH extends Co{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Z1,Lp,Y1,U4;class W8 extends Co{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Pe(this,Y1);Pe(this,Z1,null);Pe(this,Lp,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Yr.HIGHLIGHT:Yr.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:c,borderStyle:a,popupRef:l}}=this,{transform:r,width:h,height:m}=We(this,Y1,U4).call(this,i,t),v=this.svgFactory.create(h,m,!0),g=Ie(this,Z1,this.svgFactory.createElement("svg:g"));v.append(g),g.setAttribute("stroke-width",a.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",r);for(let _=0,E=c.length;_<E;_++){const b=this.svgFactory.createElement(this.svgElementName);D(this,Lp).push(b),b.setAttribute("points",c[_].join(",")),g.append(b)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(v),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:c,rect:a}=t,l=D(this,Z1);if(i>=0&&l.setAttribute("stroke-width",i||1),c)for(let r=0,h=D(this,Lp).length;r<h;r++)D(this,Lp)[r].setAttribute("points",c[r].join(","));if(a){const{transform:r,width:h,height:m}=We(this,Y1,U4).call(this,this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${h} ${m}`),l.setAttribute("transform",r)}}getElementsToTriggerPopup(){return D(this,Lp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Z1=new WeakMap,Lp=new WeakMap,Y1=new WeakSet,U4=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class W7 extends Co{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Yr.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class KH extends Co{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class XH extends Co{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ZH extends Co{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class G7 extends Co{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Yr.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var J1,Q1,V4;class YH extends Co{constructor(t){var c;super(t,{isRenderable:!0});Pe(this,Q1);Pe(this,J1,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(c=this.linkService.eventBus)==null||c.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let c;i.hasAppearance||i.fillAlpha===0?c=document.createElement("div"):(c=document.createElement("img"),c.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(c.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),c.addEventListener("dblclick",We(this,Q1,V4).bind(this)),Ie(this,J1,c);const{isMac:a}=Bs.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&We(this,Q1,V4).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():c.classList.add("popupTriggerArea"),t.append(c),t}getElementsToTriggerPopup(){return D(this,J1)}addHighlightArea(){this.container.classList.add("highlightArea")}}J1=new WeakMap,Q1=new WeakSet,V4=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var e_,jp,If,t_,n_,H4,r_,W4;const ok=class ok{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:c,page:a,viewport:l,structTreeLayer:r}){Pe(this,n_);Pe(this,r_);Pe(this,e_,null);Pe(this,jp,null);Pe(this,If,new Map);Pe(this,t_,null);this.div=e,Ie(this,e_,t),Ie(this,jp,i),Ie(this,t_,r||null),this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=c}hasEditableAnnotations(){return D(this,If).size>0}async render(e){var l;const{annotations:t}=e,i=this.div;vm(i,this.viewport);const c=new Map,a={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new U2,annotationStorage:e.annotationStorage||new V8,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const r of t){if(r.noHTML)continue;const h=r.annotationType===Bo.POPUP;if(h){const g=c.get(r.id);if(!g)continue;a.elements=g}else if(r.rect[2]===r.rect[0]||r.rect[3]===r.rect[1])continue;a.data=r;const m=QO.create(a);if(!m.isRenderable)continue;if(!h&&r.popupRef){const g=c.get(r.popupRef);g?g.push(m):c.set(r.popupRef,[m])}const v=m.render();r.hidden&&(v.style.visibility="hidden"),await We(this,n_,H4).call(this,v,r.id),m._isEditable&&(D(this,If).set(m.data.id,m),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(m))}We(this,r_,W4).call(this)}async addLinkAnnotations(e,t){const i={data:null,layer:this.div,linkService:t,svgFactory:new U2,parent:this};for(const c of e){c.borderStyle||(c.borderStyle=ok._defaultBorderStyle),i.data=c;const a=QO.create(i);if(!a.isRenderable)continue;const l=a.render();await We(this,n_,H4).call(this,l,c.id)}}update({viewport:e}){const t=this.div;this.viewport=e,vm(t,{rotation:e.rotation}),We(this,r_,W4).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(D(this,If).values())}getEditableAnnotation(e){return D(this,If).get(e)}static get _defaultBorderStyle(){return di(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:og.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};e_=new WeakMap,jp=new WeakMap,If=new WeakMap,t_=new WeakMap,n_=new WeakSet,H4=async function(e,t){var l,r;const i=e.firstChild||e,c=i.id=`${N8}${t}`,a=await((l=D(this,t_))==null?void 0:l.getAriaAttributes(c));if(a)for(const[h,m]of a)i.setAttribute(h,m);this.div.append(e),(r=D(this,e_))==null||r.moveElementInDOM(this.div,e,i,!1)},r_=new WeakSet,W4=function(){var t;if(!D(this,jp))return;const e=this.div;for(const[i,c]of D(this,jp)){const a=e.querySelector(`[data-annotation-id="${i}"]`);if(!a)continue;c.className="annotationContent";const{firstChild:l}=a;l?l.nodeName==="CANVAS"?l.replaceWith(c):l.classList.contains("annotationContent")?l.after(c):l.before(c):a.append(c);const r=D(this,If).get(i);r&&(r._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(i,a.id,c),r._hasNoCanvas=!1):r.canvas=c)}D(this,jp).clear()};let q4=ok;const ox=/\r\n?|\n/g;var uc,ol,i_,Np,sl,XS,K7,ZS,X7,YS,Z7,Ly,Vx,jy,qx,Ny,Hx,JS,Y7,o_,K4,QS,J7;const Vi=class Vi extends so{constructor(t){super({...t,name:"freeTextEditor"});Pe(this,XS);Pe(this,ZS);Pe(this,YS);Pe(this,Ly);Pe(this,Ny);Pe(this,JS);Pe(this,QS);Pe(this,uc,void 0);Pe(this,ol,"");Pe(this,i_,`${this.id}-editor`);Pe(this,Np,null);Pe(this,sl,void 0);Ie(this,uc,t.color||Vi._defaultColor||so._defaultLineColor),Ie(this,sl,t.fontSize||Vi._defaultFontSize)}static get _keyboardManager(){const t=Vi.prototype,i=l=>l.isEmpty(),c=_m.TRANSLATE_SMALL,a=_m.TRANSLATE_BIG;return di(this,"_keyboardManager",new tw([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-c,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[c,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-c],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,c],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:i}]]))}static initialize(t,i){so.initialize(t,i);const c=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(c.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case _i.FREETEXT_SIZE:Vi._defaultFontSize=i;break;case _i.FREETEXT_COLOR:Vi._defaultColor=i;break}}updateParams(t,i){switch(t){case _i.FREETEXT_SIZE:We(this,XS,K7).call(this,i);break;case _i.FREETEXT_COLOR:We(this,ZS,X7).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[_i.FREETEXT_SIZE,Vi._defaultFontSize],[_i.FREETEXT_COLOR,Vi._defaultColor||so._defaultLineColor]]}get propertiesToUpdate(){return[[_i.FREETEXT_SIZE,D(this,sl)],[_i.FREETEXT_COLOR,D(this,uc)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-Vi._internalPadding*t,-(Vi._internalPadding+D(this,sl))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Yr.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),Ie(this,Np,new AbortController);const t=this._uiManager.combinedSignal(D(this,Np));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",D(this,i_)),this._isDraggable=!0,(t=D(this,Np))==null||t.abort(),Ie(this,Np,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=D(this,ol),i=Ie(this,ol,We(this,YS,Z7).call(this).trimEnd());if(t===i)return;const c=a=>{if(Ie(this,ol,a),!a){this.remove();return}We(this,Ny,Hx).call(this),this._uiManager.rebuild(this),We(this,Ly,Vx).call(this)};this.addCommands({cmd:()=>{c(i)},undo:()=>{c(t)},mustExec:!1}),We(this,Ly,Vx).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Vi._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",D(this,i_)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:c}=this.editorDiv;if(c.fontSize=`calc(${D(this,sl)}px * var(--total-scale-factor))`,c.color=D(this,uc),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),U8(this,this.div,["dblclick","keydown"]),this._isCopy||this.annotationElementId){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:r}=this._initialData;let[h,m]=this.getInitialTranslation();[h,m]=this.pageTranslationToScreen(h,m);const[v,g]=this.pageDimensions,[_,E]=this.pageTranslation;let b,p;switch(this.rotation){case 0:b=t+(r[0]-_)/v,p=i+this.height-(r[1]-E)/g;break;case 90:b=t+(r[0]-_)/v,p=i-(r[1]-E)/g,[h,m]=[m,-h];break;case 180:b=t-this.width+(r[0]-_)/v,p=i-(r[1]-E)/g,[h,m]=[-h,-m];break;case 270:b=t+(r[0]-_-this.height*g)/v,p=i+(r[1]-E-this.width*v)/g,[h,m]=[-m,h];break}this.setAt(b*a,p*l,h,m)}else this._moveAfterPaste(t,i);We(this,Ny,Hx).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var b,p,x;const i=t.clipboardData||window.clipboardData,{types:c}=i;if(c.length===1&&c[0]==="text/plain")return;t.preventDefault();const a=We(b=Vi,o_,K4).call(b,i.getData("text")||"").replaceAll(ox,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const r=l.getRangeAt(0);if(!a.includes(`
`)){r.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:h,startOffset:m}=r,v=[],g=[];if(h.nodeType===Node.TEXT_NODE){const y=h.parentElement;if(g.push(h.nodeValue.slice(m).replaceAll(ox,"")),y!==this.editorDiv){let f=v;for(const w of this.editorDiv.childNodes){if(w===y){f=g;continue}f.push(We(p=Vi,jy,qx).call(p,w))}}v.push(h.nodeValue.slice(0,m).replaceAll(ox,""))}else if(h===this.editorDiv){let y=v,f=0;for(const w of this.editorDiv.childNodes)f++===m&&(y=g),y.push(We(x=Vi,jy,qx).call(x,w))}Ie(this,ol,`${v.join(`
`)}${a}${g.join(`
`)}`),We(this,Ny,Hx).call(this);const _=new Range;let E=v.reduce((y,f)=>y+f.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const f=y.nodeValue.length;if(E<=f){_.setStart(y,E),_.setEnd(y,E);break}E-=f}l.removeAllRanges(),l.addRange(_)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,c){var r;let a=null;if(t instanceof q7){const{data:{defaultAppearanceData:{fontSize:h,fontColor:m},rect:v,rotation:g,id:_,popupRef:E},textContent:b,textPosition:p,parent:{page:{pageNumber:x}}}=t;if(!b||b.length===0)return null;a=t={annotationType:Yr.FREETEXT,color:Array.from(m),fontSize:h,value:b.join(`
`),position:p,pageIndex:x-1,rect:v.slice(0),rotation:g,id:_,deleted:!1,popupRef:E}}const l=await super.deserialize(t,i,c);return Ie(l,sl,t.fontSize),Ie(l,uc,vr.makeHexColor(...t.color)),Ie(l,ol,We(r=Vi,o_,K4).call(r,t.value)),l.annotationElementId=t.id||null,l._initialData=a,l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Vi._internalPadding*this.parentScale,c=this.getRect(i,i),a=so._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:D(this,uc)),l={annotationType:Yr.FREETEXT,color:a,fontSize:D(this,sl),value:We(this,JS,Y7).call(this),pageIndex:this.pageIndex,rect:c,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(l.isCopy=!0,l):this.annotationElementId&&!We(this,QS,J7).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:c}=i;c.fontSize=`calc(${D(this,sl)}px * var(--total-scale-factor))`,c.color=D(this,uc),i.replaceChildren();for(const l of D(this,ol).split(`
`)){const r=document.createElement("div");r.append(l?document.createTextNode(l):document.createElement("br")),i.append(r)}const a=Vi._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(a,a),popupContent:D(this,ol)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};uc=new WeakMap,ol=new WeakMap,i_=new WeakMap,Np=new WeakMap,sl=new WeakMap,XS=new WeakSet,K7=function(t){const i=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-D(this,sl))*this.parentScale),Ie(this,sl,a),We(this,Ly,Vx).call(this)},c=D(this,sl);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,c),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:_i.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ZS=new WeakSet,X7=function(t){const i=a=>{Ie(this,uc,this.editorDiv.style.color=a)},c=D(this,uc);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,c),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:_i.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},YS=new WeakSet,Z7=function(){var c;const t=[];this.editorDiv.normalize();let i=null;for(const a of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&a.nodeName==="BR"||(t.push(We(c=Vi,jy,qx).call(c,a)),i=a);return t.join(`
`)},Ly=new WeakSet,Vx=function(){const[t,i]=this.parentDimensions;let c;if(this.isAttachedToDOM)c=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,r=l.style.display,h=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),c=l.getBoundingClientRect(),l.remove(),l.style.display=r,l.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=c.width/t,this.height=c.height/i):(this.width=c.height/t,this.height=c.width/i),this.fixAndSetPosition()},jy=new WeakSet,qx=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ox,"")},Ny=new WeakSet,Hx=function(){if(this.editorDiv.replaceChildren(),!!D(this,ol))for(const t of D(this,ol).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},JS=new WeakSet,Y7=function(){return D(this,ol).replaceAll(" "," ")},o_=new WeakSet,K4=function(t){return t.replaceAll(" "," ")},QS=new WeakSet,J7=function(t){const{value:i,fontSize:c,color:a,pageIndex:l}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==c||t.color.some((r,h)=>r!==a[h])||t.pageIndex!==l},Pe(Vi,jy),Pe(Vi,o_),Or(Vi,"_freeTextDefaultContent",""),Or(Vi,"_internalPadding",0),Or(Vi,"_defaultColor",null),Or(Vi,"_defaultFontSize",10),Or(Vi,"_type","freetext"),Or(Vi,"_editorType",Yr.FREETEXT);let G4=Vi;class lr{toSVGPath(){zi("Abstract method `toSVGPath` must be implemented.")}get box(){zi("Abstract getter `box` must be implemented.")}serialize(e,t){zi("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,c,a,l){l||(l=new Float32Array(e.length));for(let r=0,h=e.length;r<h;r+=2)l[r]=t+e[r]*c,l[r+1]=i+e[r+1]*a;return l}static _rescaleAndSwap(e,t,i,c,a,l){l||(l=new Float32Array(e.length));for(let r=0,h=e.length;r<h;r+=2)l[r]=t+e[r+1]*c,l[r+1]=i+e[r]*a;return l}static _translate(e,t,i,c){c||(c=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)c[a]=t+e[a],c[a+1]=i+e[a+1];return c}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,c,a){switch(a){case 90:return[1-t/i,e/c];case 180:return[1-e/i,1-t/c];case 270:return[t/i,1-e/c];default:return[e/i,t/c]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,c,a,l){return[(e+5*i)/6,(t+5*c)/6,(5*i+a)/6,(5*c+l)/6,(i+a)/2,(c+l)/2]}}Or(lr,"PRECISION",1e-4);var al,hc,$y,By,Qc,ci,$p,Bp,s_,a_,Fy,zy,Rf,l_,eE,tE,Fp,qb,nE,Q7,rE,e9,iE,t9,oE,n9,sE,r9,aE,i9;const $u=class $u{constructor({x:e,y:t},i,c,a,l,r=0){Pe(this,Fp);Pe(this,nE);Pe(this,rE);Pe(this,iE);Pe(this,oE);Pe(this,sE);Pe(this,aE);Pe(this,al,void 0);Pe(this,hc,[]);Pe(this,$y,void 0);Pe(this,By,void 0);Pe(this,Qc,[]);Pe(this,ci,new Float32Array(18));Pe(this,$p,void 0);Pe(this,Bp,void 0);Pe(this,s_,void 0);Pe(this,a_,void 0);Pe(this,Fy,void 0);Pe(this,zy,void 0);Pe(this,Rf,[]);Ie(this,al,i),Ie(this,zy,a*c),Ie(this,By,l),D(this,ci).set([NaN,NaN,NaN,NaN,e,t],6),Ie(this,$y,r),Ie(this,a_,D($u,l_)*c),Ie(this,s_,D($u,tE)*c),Ie(this,Fy,c),D(this,Rf).push(e,t)}isEmpty(){return isNaN(D(this,ci)[8])}add({x:e,y:t}){var L;Ie(this,$p,e),Ie(this,Bp,t);const[i,c,a,l]=D(this,al);let[r,h,m,v]=D(this,ci).subarray(8,12);const g=e-m,_=t-v,E=Math.hypot(g,_);if(E<D(this,s_))return!1;const b=E-D(this,a_),p=b/E,x=p*g,y=p*_;let f=r,w=h;r=m,h=v,m+=x,v+=y,(L=D(this,Rf))==null||L.push(e,t);const A=-y/b,P=x/b,T=A*D(this,zy),R=P*D(this,zy);return D(this,ci).set(D(this,ci).subarray(2,8),0),D(this,ci).set([m+T,v+R],4),D(this,ci).set(D(this,ci).subarray(14,18),12),D(this,ci).set([m-T,v-R],16),isNaN(D(this,ci)[6])?(D(this,Qc).length===0&&(D(this,ci).set([r+T,h+R],2),D(this,Qc).push(NaN,NaN,NaN,NaN,(r+T-i)/a,(h+R-c)/l),D(this,ci).set([r-T,h-R],14),D(this,hc).push(NaN,NaN,NaN,NaN,(r-T-i)/a,(h-R-c)/l)),D(this,ci).set([f,w,r,h,m,v],6),!this.isEmpty()):(D(this,ci).set([f,w,r,h,m,v],6),Math.abs(Math.atan2(w-h,f-r)-Math.atan2(y,x))<Math.PI/2?([r,h,m,v]=D(this,ci).subarray(2,6),D(this,Qc).push(NaN,NaN,NaN,NaN,((r+m)/2-i)/a,((h+v)/2-c)/l),[r,h,f,w]=D(this,ci).subarray(14,18),D(this,hc).push(NaN,NaN,NaN,NaN,((f+r)/2-i)/a,((w+h)/2-c)/l),!0):([f,w,r,h,m,v]=D(this,ci).subarray(0,6),D(this,Qc).push(((f+5*r)/6-i)/a,((w+5*h)/6-c)/l,((5*r+m)/6-i)/a,((5*h+v)/6-c)/l,((r+m)/2-i)/a,((h+v)/2-c)/l),[m,v,r,h,f,w]=D(this,ci).subarray(12,18),D(this,hc).push(((f+5*r)/6-i)/a,((w+5*h)/6-c)/l,((5*r+m)/6-i)/a,((5*h+v)/6-c)/l,((r+m)/2-i)/a,((h+v)/2-c)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=D(this,Qc),t=D(this,hc);if(isNaN(D(this,ci)[6])&&!this.isEmpty())return We(this,nE,Q7).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let c=6;c<e.length;c+=6)isNaN(e[c])?i.push(`L${e[c+4]} ${e[c+5]}`):i.push(`C${e[c]} ${e[c+1]} ${e[c+2]} ${e[c+3]} ${e[c+4]} ${e[c+5]}`);We(this,iE,t9).call(this,i);for(let c=t.length-6;c>=6;c-=6)isNaN(t[c])?i.push(`L${t[c+4]} ${t[c+5]}`):i.push(`C${t[c]} ${t[c+1]} ${t[c+2]} ${t[c+3]} ${t[c+4]} ${t[c+5]}`);return We(this,rE,e9).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,c,a,l){return new o9(e,t,i,c,a,l)}getOutlines(){var g;const e=D(this,Qc),t=D(this,hc),i=D(this,ci),[c,a,l,r]=D(this,al),h=new Float32Array((((g=D(this,Rf))==null?void 0:g.length)??0)+2);for(let _=0,E=h.length-2;_<E;_+=2)h[_]=(D(this,Rf)[_]-c)/l,h[_+1]=(D(this,Rf)[_+1]-a)/r;if(h[h.length-2]=(D(this,$p)-c)/l,h[h.length-1]=(D(this,Bp)-a)/r,isNaN(i[6])&&!this.isEmpty())return We(this,oE,n9).call(this,h);const m=new Float32Array(D(this,Qc).length+24+D(this,hc).length);let v=e.length;for(let _=0;_<v;_+=2){if(isNaN(e[_])){m[_]=m[_+1]=NaN;continue}m[_]=e[_],m[_+1]=e[_+1]}v=We(this,aE,i9).call(this,m,v);for(let _=t.length-6;_>=6;_-=6)for(let E=0;E<6;E+=2){if(isNaN(t[_+E])){m[v]=m[v+1]=NaN,v+=2;continue}m[v]=t[_+E],m[v+1]=t[_+E+1],v+=2}return We(this,sE,r9).call(this,m,v),this.newFreeDrawOutline(m,h,D(this,al),D(this,Fy),D(this,$y),D(this,By))}};al=new WeakMap,hc=new WeakMap,$y=new WeakMap,By=new WeakMap,Qc=new WeakMap,ci=new WeakMap,$p=new WeakMap,Bp=new WeakMap,s_=new WeakMap,a_=new WeakMap,Fy=new WeakMap,zy=new WeakMap,Rf=new WeakMap,l_=new WeakMap,eE=new WeakMap,tE=new WeakMap,Fp=new WeakSet,qb=function(){const e=D(this,ci).subarray(4,6),t=D(this,ci).subarray(16,18),[i,c,a,l]=D(this,al);return[(D(this,$p)+(e[0]-t[0])/2-i)/a,(D(this,Bp)+(e[1]-t[1])/2-c)/l,(D(this,$p)+(t[0]-e[0])/2-i)/a,(D(this,Bp)+(t[1]-e[1])/2-c)/l]},nE=new WeakSet,Q7=function(){const[e,t,i,c]=D(this,al),[a,l,r,h]=We(this,Fp,qb).call(this);return`M${(D(this,ci)[2]-e)/i} ${(D(this,ci)[3]-t)/c} L${(D(this,ci)[4]-e)/i} ${(D(this,ci)[5]-t)/c} L${a} ${l} L${r} ${h} L${(D(this,ci)[16]-e)/i} ${(D(this,ci)[17]-t)/c} L${(D(this,ci)[14]-e)/i} ${(D(this,ci)[15]-t)/c} Z`},rE=new WeakSet,e9=function(e){const t=D(this,hc);e.push(`L${t[4]} ${t[5]} Z`)},iE=new WeakSet,t9=function(e){const[t,i,c,a]=D(this,al),l=D(this,ci).subarray(4,6),r=D(this,ci).subarray(16,18),[h,m,v,g]=We(this,Fp,qb).call(this);e.push(`L${(l[0]-t)/c} ${(l[1]-i)/a} L${h} ${m} L${v} ${g} L${(r[0]-t)/c} ${(r[1]-i)/a}`)},oE=new WeakSet,n9=function(e){const t=D(this,ci),[i,c,a,l]=D(this,al),[r,h,m,v]=We(this,Fp,qb).call(this),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(t[2]-i)/a,(t[3]-c)/l,NaN,NaN,NaN,NaN,(t[4]-i)/a,(t[5]-c)/l,NaN,NaN,NaN,NaN,r,h,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(t[16]-i)/a,(t[17]-c)/l,NaN,NaN,NaN,NaN,(t[14]-i)/a,(t[15]-c)/l],0),this.newFreeDrawOutline(g,e,D(this,al),D(this,Fy),D(this,$y),D(this,By))},sE=new WeakSet,r9=function(e,t){const i=D(this,hc);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},aE=new WeakSet,i9=function(e,t){const i=D(this,ci).subarray(4,6),c=D(this,ci).subarray(16,18),[a,l,r,h]=D(this,al),[m,v,g,_]=We(this,Fp,qb).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-a)/r,(i[1]-l)/h,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,g,_,NaN,NaN,NaN,NaN,(c[0]-a)/r,(c[1]-l)/h],t),t+=24},Pe($u,l_,8),Pe($u,eE,2),Pe($u,tE,D($u,l_)+D($u,eE));let V2=$u;var Uy,zp,sh,c_,ll,u_,To,lE,s9;class o9 extends lr{constructor(t,i,c,a,l,r){super();Pe(this,lE);Pe(this,Uy,void 0);Pe(this,zp,new Float32Array(4));Pe(this,sh,void 0);Pe(this,c_,void 0);Pe(this,ll,void 0);Pe(this,u_,void 0);Pe(this,To,void 0);Ie(this,To,t),Ie(this,ll,i),Ie(this,Uy,c),Ie(this,u_,a),Ie(this,sh,l),Ie(this,c_,r),this.lastPoint=[NaN,NaN],We(this,lE,s9).call(this,r);const[h,m,v,g]=D(this,zp);for(let _=0,E=t.length;_<E;_+=2)t[_]=(t[_]-h)/v,t[_+1]=(t[_+1]-m)/g;for(let _=0,E=i.length;_<E;_+=2)i[_]=(i[_]-h)/v,i[_+1]=(i[_+1]-m)/g}toSVGPath(){const t=[`M${D(this,To)[4]} ${D(this,To)[5]}`];for(let i=6,c=D(this,To).length;i<c;i+=6){if(isNaN(D(this,To)[i])){t.push(`L${D(this,To)[i+4]} ${D(this,To)[i+5]}`);continue}t.push(`C${D(this,To)[i]} ${D(this,To)[i+1]} ${D(this,To)[i+2]} ${D(this,To)[i+3]} ${D(this,To)[i+4]} ${D(this,To)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,c,a],l){const r=c-t,h=a-i;let m,v;switch(l){case 0:m=lr._rescale(D(this,To),t,a,r,-h),v=lr._rescale(D(this,ll),t,a,r,-h);break;case 90:m=lr._rescaleAndSwap(D(this,To),t,i,r,h),v=lr._rescaleAndSwap(D(this,ll),t,i,r,h);break;case 180:m=lr._rescale(D(this,To),c,i,-r,h),v=lr._rescale(D(this,ll),c,i,-r,h);break;case 270:m=lr._rescaleAndSwap(D(this,To),c,a,-r,-h),v=lr._rescaleAndSwap(D(this,ll),c,a,-r,-h);break}return{outline:Array.from(m),points:[Array.from(v)]}}get box(){return D(this,zp)}newOutliner(t,i,c,a,l,r=0){return new V2(t,i,c,a,l,r)}getNewOutline(t,i){const[c,a,l,r]=D(this,zp),[h,m,v,g]=D(this,Uy),_=l*v,E=r*g,b=c*v+h,p=a*g+m,x=this.newOutliner({x:D(this,ll)[0]*_+b,y:D(this,ll)[1]*E+p},D(this,Uy),D(this,u_),t,D(this,c_),i??D(this,sh));for(let y=2;y<D(this,ll).length;y+=2)x.add({x:D(this,ll)[y]*_+b,y:D(this,ll)[y+1]*E+p});return x.getOutlines()}}Uy=new WeakMap,zp=new WeakMap,sh=new WeakMap,c_=new WeakMap,ll=new WeakMap,u_=new WeakMap,To=new WeakMap,lE=new WeakSet,s9=function(t){const i=D(this,To);let c=i[4],a=i[5],l=c,r=a,h=c,m=a,v=c,g=a;const _=t?Math.max:Math.min;for(let b=6,p=i.length;b<p;b+=6){if(isNaN(i[b]))l=Math.min(l,i[b+4]),r=Math.min(r,i[b+5]),h=Math.max(h,i[b+4]),m=Math.max(m,i[b+5]),g<i[b+5]?(v=i[b+4],g=i[b+5]):g===i[b+5]&&(v=_(v,i[b+4]));else{const x=vr.bezierBoundingBox(c,a,...i.slice(b,b+6));l=Math.min(l,x[0]),r=Math.min(r,x[1]),h=Math.max(h,x[2]),m=Math.max(m,x[3]),g<x[3]?(v=x[2],g=x[3]):g===x[3]&&(v=_(v,x[2]))}c=i[b+4],a=i[b+5]}const E=D(this,zp);E[0]=l-D(this,sh),E[1]=r-D(this,sh),E[2]=h-l+2*D(this,sh),E[3]=m-r+2*D(this,sh),this.lastPoint=[v,g]};var h_,f_,Df,fc,cE,a9,Vy,Wx,uE,l9,hE,c9,d_,Z4;class X4{constructor(e,t=0,i=0,c=!0){Pe(this,cE);Pe(this,Vy);Pe(this,uE);Pe(this,hE);Pe(this,d_);Pe(this,h_,void 0);Pe(this,f_,void 0);Pe(this,Df,[]);Pe(this,fc,[]);let a=1/0,l=-1/0,r=1/0,h=-1/0;const v=10**-4;for(const{x:y,y:f,width:w,height:A}of e){const P=Math.floor((y-t)/v)*v,T=Math.ceil((y+w+t)/v)*v,R=Math.floor((f-t)/v)*v,M=Math.ceil((f+A+t)/v)*v,L=[P,R,M,!0],W=[T,R,M,!1];D(this,Df).push(L,W),a=Math.min(a,P),l=Math.max(l,T),r=Math.min(r,R),h=Math.max(h,M)}const g=l-a+2*i,_=h-r+2*i,E=a-i,b=r-i,p=D(this,Df).at(c?-1:-2),x=[p[0],p[2]];for(const y of D(this,Df)){const[f,w,A]=y;y[0]=(f-E)/g,y[1]=(w-b)/_,y[2]=(A-b)/_}Ie(this,h_,new Float32Array([E,b,g,_])),Ie(this,f_,x)}getOutlines(){D(this,Df).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of D(this,Df))t[3]?(e.push(...We(this,d_,Z4).call(this,t)),We(this,uE,l9).call(this,t)):(We(this,hE,c9).call(this,t),e.push(...We(this,d_,Z4).call(this,t)));return We(this,cE,a9).call(this,e)}}h_=new WeakMap,f_=new WeakMap,Df=new WeakMap,fc=new WeakMap,cE=new WeakSet,a9=function(e){const t=[],i=new Set;for(const l of e){const[r,h,m]=l;t.push([r,h,l],[r,m,l])}t.sort((l,r)=>l[1]-r[1]||l[0]-r[0]);for(let l=0,r=t.length;l<r;l+=2){const h=t[l][2],m=t[l+1][2];h.push(m),m.push(h),i.add(h),i.add(m)}const c=[];let a;for(;i.size>0;){const l=i.values().next().value;let[r,h,m,v,g]=l;i.delete(l);let _=r,E=h;for(a=[r,m],c.push(a);;){let b;if(i.has(v))b=v;else if(i.has(g))b=g;else break;i.delete(b),[r,h,m,v,g]=b,_!==r&&(a.push(_,E,r,E===h?h:m),_=r),E=E===h?m:h}a.push(_,E)}return new JH(c,D(this,h_),D(this,f_))},Vy=new WeakSet,Wx=function(e){const t=D(this,fc);let i=0,c=t.length-1;for(;i<=c;){const a=i+c>>1,l=t[a][0];if(l===e)return a;l<e?i=a+1:c=a-1}return c+1},uE=new WeakSet,l9=function([,e,t]){const i=We(this,Vy,Wx).call(this,e);D(this,fc).splice(i,0,[e,t])},hE=new WeakSet,c9=function([,e,t]){const i=We(this,Vy,Wx).call(this,e);for(let c=i;c<D(this,fc).length;c++){const[a,l]=D(this,fc)[c];if(a!==e)break;if(a===e&&l===t){D(this,fc).splice(c,1);return}}for(let c=i-1;c>=0;c--){const[a,l]=D(this,fc)[c];if(a!==e)break;if(a===e&&l===t){D(this,fc).splice(c,1);return}}},d_=new WeakSet,Z4=function(e){const[t,i,c]=e,a=[[t,i,c]],l=We(this,Vy,Wx).call(this,c);for(let r=0;r<l;r++){const[h,m]=D(this,fc)[r];for(let v=0,g=a.length;v<g;v++){const[,_,E]=a[v];if(!(m<=_||E<=h)){if(_>=h){if(E>m)a[v][1]=m;else{if(g===1)return[];a.splice(v,1),v--,g--}continue}a[v][2]=h,E>m&&a.push([t,m,E])}}}return a};var p_,qy;class JH extends lr{constructor(t,i,c){super();Pe(this,p_,void 0);Pe(this,qy,void 0);Ie(this,qy,t),Ie(this,p_,i),this.lastPoint=c}toSVGPath(){const t=[];for(const i of D(this,qy)){let[c,a]=i;t.push(`M${c} ${a}`);for(let l=2;l<i.length;l+=2){const r=i[l],h=i[l+1];r===c?(t.push(`V${h}`),a=h):h===a&&(t.push(`H${r}`),c=r)}t.push("Z")}return t.join(" ")}serialize([t,i,c,a],l){const r=[],h=c-t,m=a-i;for(const v of D(this,qy)){const g=new Array(v.length);for(let _=0;_<v.length;_+=2)g[_]=t+v[_]*h,g[_+1]=a-v[_+1]*m;r.push(g)}return r}get box(){return D(this,p_)}get classNamesForOutlining(){return["highlightOutline"]}}p_=new WeakMap,qy=new WeakMap;class Y4 extends V2{newFreeDrawOutline(e,t,i,c,a,l){return new QH(e,t,i,c,a,l)}}class QH extends o9{newOutliner(e,t,i,c,a,l=0){return new Y4(e,t,i,c,a,l)}}var dc,Up,Hy,Jo,m_,Wy,g_,y_,Lf,pc,Gy,b_,v_,J4,__,Q4,w_,e5,ah,Nd,fE,u9,eu,Qh;const Ca=class Ca{constructor({editor:e=null,uiManager:t=null}){Pe(this,v_);Pe(this,__);Pe(this,w_);Pe(this,ah);Pe(this,fE);Pe(this,eu);Pe(this,dc,null);Pe(this,Up,null);Pe(this,Hy,void 0);Pe(this,Jo,null);Pe(this,m_,!1);Pe(this,Wy,!1);Pe(this,g_,null);Pe(this,y_,void 0);Pe(this,Lf,null);Pe(this,pc,null);Pe(this,Gy,void 0);var i;e?(Ie(this,Wy,!1),Ie(this,Gy,_i.HIGHLIGHT_COLOR),Ie(this,g_,e)):(Ie(this,Wy,!0),Ie(this,Gy,_i.HIGHLIGHT_DEFAULT_COLOR)),Ie(this,pc,(e==null?void 0:e._uiManager)||t),Ie(this,y_,D(this,pc)._eventBus),Ie(this,Hy,(e==null?void 0:e.color)||((i=D(this,pc))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),D(Ca,b_)||Ie(Ca,b_,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return di(this,"_keyboardManager",new tw([[["Escape","mac+Escape"],Ca.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ca.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ca.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ca.prototype._moveToPrevious],[["Home","mac+Home"],Ca.prototype._moveToBeginning],[["End","mac+End"],Ca.prototype._moveToEnd]]))}renderButton(){const e=Ie(this,dc,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=D(this,pc)._signal;e.addEventListener("click",We(this,ah,Nd).bind(this),{signal:t}),e.addEventListener("keydown",We(this,w_,e5).bind(this),{signal:t});const i=Ie(this,Up,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=D(this,Hy),e.append(i),e}renderMainDropdown(){const e=Ie(this,Jo,We(this,v_,J4).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===D(this,dc)){We(this,ah,Nd).call(this,e);return}const t=e.target.getAttribute("data-color");t&&We(this,__,Q4).call(this,t,e)}_moveToNext(e){var t,i;if(!D(this,eu,Qh)){We(this,ah,Nd).call(this,e);return}if(e.target===D(this,dc)){(t=D(this,Jo).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=D(this,Jo))==null?void 0:t.firstChild)||e.target===D(this,dc)){D(this,eu,Qh)&&this._hideDropdownFromKeyboard();return}D(this,eu,Qh)||We(this,ah,Nd).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!D(this,eu,Qh)){We(this,ah,Nd).call(this,e);return}(t=D(this,Jo).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!D(this,eu,Qh)){We(this,ah,Nd).call(this,e);return}(t=D(this,Jo).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=D(this,Jo))==null||e.classList.add("hidden"),(t=D(this,Lf))==null||t.abort(),Ie(this,Lf,null)}_hideDropdownFromKeyboard(){var e;if(!D(this,Wy)){if(!D(this,eu,Qh)){(e=D(this,g_))==null||e.unselect();return}this.hideDropdown(),D(this,dc).focus({preventScroll:!0,focusVisible:D(this,m_)})}}updateColor(e){if(D(this,Up)&&(D(this,Up).style.backgroundColor=e),!D(this,Jo))return;const t=D(this,pc).highlightColors.values();for(const i of D(this,Jo).children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=D(this,dc))==null||e.remove(),Ie(this,dc,null),Ie(this,Up,null),(t=D(this,Jo))==null||t.remove(),Ie(this,Jo,null)}};dc=new WeakMap,Up=new WeakMap,Hy=new WeakMap,Jo=new WeakMap,m_=new WeakMap,Wy=new WeakMap,g_=new WeakMap,y_=new WeakMap,Lf=new WeakMap,pc=new WeakMap,Gy=new WeakMap,b_=new WeakMap,v_=new WeakSet,J4=function(){const e=document.createElement("div"),t=D(this,pc)._signal;e.addEventListener("contextmenu",Ac,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,c]of D(this,pc).highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",c),a.title=i,a.setAttribute("data-l10n-id",D(Ca,b_)[i]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=c,a.setAttribute("aria-selected",c===D(this,Hy)),a.addEventListener("click",We(this,__,Q4).bind(this,c),{signal:t}),e.append(a)}return e.addEventListener("keydown",We(this,w_,e5).bind(this),{signal:t}),e},__=new WeakSet,Q4=function(e,t){t.stopPropagation(),D(this,y_).dispatch("switchannotationeditorparams",{source:this,type:D(this,Gy),value:e})},w_=new WeakSet,e5=function(e){Ca._keyboardManager.exec(this,e)},ah=new WeakSet,Nd=function(e){if(D(this,eu,Qh)){this.hideDropdown();return}if(Ie(this,m_,e.detail===0),D(this,Lf)||(Ie(this,Lf,new AbortController),window.addEventListener("pointerdown",We(this,fE,u9).bind(this),{signal:D(this,pc).combinedSignal(D(this,Lf))})),D(this,Jo)){D(this,Jo).classList.remove("hidden");return}const t=Ie(this,Jo,We(this,v_,J4).call(this));D(this,dc).append(t)},fE=new WeakSet,u9=function(e){var t;(t=D(this,Jo))!=null&&t.contains(e.target)||this.hideDropdown()},eu=new WeakSet,Qh=function(){return D(this,Jo)&&!D(this,Jo).classList.contains("hidden")},Pe(Ca,b_,null);let q2=Ca;var Ky,x_,lh,Vp,Xy,Da,S_,E_,qp,Ll,cl,Ds,Zy,ch,ta,Yy,jl,A_,k_,t5,Jy,Gx,dE,h9,pE,f9,mE,d9,P_,n5,uh,$d,jf,hg,gE,p9,Qy,Kx,Hp,Hb,yE,m9,bE,g9,vE,y9,_E,b9,wE,v9;const Ei=class Ei extends so{constructor(t){super({...t,name:"highlightEditor"});Pe(this,k_);Pe(this,Jy);Pe(this,dE);Pe(this,pE);Pe(this,mE);Pe(this,P_);Pe(this,uh);Pe(this,gE);Pe(this,Qy);Pe(this,Hp);Pe(this,yE);Pe(this,bE);Pe(this,wE);Pe(this,Ky,null);Pe(this,x_,0);Pe(this,lh,void 0);Pe(this,Vp,null);Pe(this,Xy,null);Pe(this,Da,null);Pe(this,S_,null);Pe(this,E_,0);Pe(this,qp,null);Pe(this,Ll,null);Pe(this,cl,null);Pe(this,Ds,!1);Pe(this,Zy,null);Pe(this,ch,void 0);Pe(this,ta,null);Pe(this,Yy,"");Pe(this,jl,void 0);Pe(this,A_,"");this.color=t.color||Ei._defaultColor,Ie(this,jl,t.thickness||Ei._defaultThickness),Ie(this,ch,t.opacity||Ei._defaultOpacity),Ie(this,lh,t.boxes||null),Ie(this,A_,t.methodOfCreation||""),Ie(this,Yy,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(Ie(this,Ds,!0),We(this,Jy,Gx).call(this,t),We(this,uh,$d).call(this)):D(this,lh)&&(Ie(this,Ky,t.anchorNode),Ie(this,x_,t.anchorOffset),Ie(this,S_,t.focusNode),Ie(this,E_,t.focusOffset),We(this,k_,t5).call(this),We(this,uh,$d).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=Ei.prototype;return di(this,"_keyboardManager",new tw([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:D(this,Ds)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:D(this,jl),methodOfCreation:D(this,A_)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var c;so.initialize(t,i),Ei._defaultColor||(Ei._defaultColor=((c=i.highlightColors)==null?void 0:c.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case _i.HIGHLIGHT_DEFAULT_COLOR:Ei._defaultColor=i;break;case _i.HIGHLIGHT_THICKNESS:Ei._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return D(this,Zy)}updateParams(t,i){switch(t){case _i.HIGHLIGHT_COLOR:We(this,dE,h9).call(this,i);break;case _i.HIGHLIGHT_THICKNESS:We(this,pE,f9).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[_i.HIGHLIGHT_DEFAULT_COLOR,Ei._defaultColor],[_i.HIGHLIGHT_THICKNESS,Ei._defaultThickness]]}get propertiesToUpdate(){return[[_i.HIGHLIGHT_COLOR,this.color||Ei._defaultColor],[_i.HIGHLIGHT_THICKNESS,D(this,jl)||Ei._defaultThickness],[_i.HIGHLIGHT_FREE,D(this,Ds)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(Ie(this,Xy,new q2({editor:this})),t.addColorPicker(D(this,Xy))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(We(this,Hp,Hb).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,We(this,Hp,Hb).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){We(this,P_,n5).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(We(this,uh,$d).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var c;let i=!1;this.parent&&!t?We(this,P_,n5).call(this):t&&(We(this,uh,$d).call(this,t),i=!this.parent&&((c=this.div)==null?void 0:c.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var a,l,r;const{drawLayer:i}=this.parent;let c;D(this,Ds)?(t=(t-this.rotation+360)%360,c=We(a=Ei,jf,hg).call(a,D(this,Ll).box,t)):c=We(l=Ei,jf,hg).call(l,[this.x,this.y,this.width,this.height],t),i.updateProperties(D(this,cl),{bbox:c,root:{"data-main-rotation":t}}),i.updateProperties(D(this,ta),{bbox:We(r=Ei,jf,hg).call(r,D(this,Da).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();D(this,Yy)&&(t.setAttribute("aria-label",D(this,Yy)),t.setAttribute("role","mark")),D(this,Ds)?t.classList.add("free"):this.div.addEventListener("keydown",We(this,gE,p9).bind(this),{signal:this._uiManager._signal});const i=Ie(this,qp,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=D(this,Vp);const[c,a]=this.parentDimensions;return this.setDims(this.width*c,this.height*a),U8(this,D(this,qp),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(D(this,ta),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(D(this,ta),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:We(this,Qy,Kx).call(this,!0);break;case 1:case 3:We(this,Qy,Kx).call(this,!1);break}}select(){var t;super.select(),D(this,ta)&&((t=this.parent)==null||t.drawLayer.updateProperties(D(this,ta),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),D(this,ta)&&((t=this.parent)==null||t.drawLayer.updateProperties(D(this,ta),{rootClass:{selected:!1}}),D(this,Ds)||We(this,Qy,Kx).call(this,!1))}get _mustFixPosition(){return!D(this,Ds)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(D(this,cl),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(D(this,ta),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:c,x:a,y:l}){const{x:r,y:h,width:m,height:v}=c.getBoundingClientRect(),g=new AbortController,_=t.combinedSignal(g),E=b=>{g.abort(),We(this,_E,b9).call(this,t,b)};window.addEventListener("blur",E,{signal:_}),window.addEventListener("pointerup",E,{signal:_}),window.addEventListener("pointerdown",Fo,{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",Ac,{signal:_}),c.addEventListener("pointermove",We(this,vE,y9).bind(this,t),{signal:_}),this._freeHighlight=new Y4({x:a,y:l},[r,h,m,v],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,c){var p,x,y,f;let a=null;if(t instanceof W7){const{data:{quadPoints:w,rect:A,rotation:P,id:T,color:R,opacity:M,popupRef:L},parent:{page:{pageNumber:W}}}=t;a=t={annotationType:Yr.HIGHLIGHT,color:Array.from(R),opacity:M,quadPoints:w,boxes:null,pageIndex:W-1,rect:A.slice(0),rotation:P,id:T,deleted:!1,popupRef:L}}else if(t instanceof W8){const{data:{inkLists:w,rect:A,rotation:P,id:T,color:R,borderStyle:{rawWidth:M},popupRef:L},parent:{page:{pageNumber:W}}}=t;a=t={annotationType:Yr.HIGHLIGHT,color:Array.from(R),thickness:M,inkLists:w,boxes:null,pageIndex:W-1,rect:A.slice(0),rotation:P,id:T,deleted:!1,popupRef:L}}const{color:l,quadPoints:r,inkLists:h,opacity:m}=t,v=await super.deserialize(t,i,c);v.color=vr.makeHexColor(...l),Ie(v,ch,m||1),h&&Ie(v,jl,t.thickness),v.annotationElementId=t.id||null,v._initialData=a;const[g,_]=v.pageDimensions,[E,b]=v.pageTranslation;if(r){const w=Ie(v,lh,[]);for(let A=0;A<r.length;A+=8)w.push({x:(r[A]-E)/g,y:1-(r[A+1]-b)/_,width:(r[A+2]-r[A])/g,height:(r[A+1]-r[A+5])/_});We(p=v,k_,t5).call(p),We(x=v,uh,$d).call(x),v.rotate(v.rotation)}else if(h){Ie(v,Ds,!0);const w=h[0],A={x:w[0]-E,y:_-(w[1]-b)},P=new Y4(A,[0,0,g,_],1,D(v,jl)/2,!0,.001);for(let M=0,L=w.length;M<L;M+=2)A.x=w[M]-E,A.y=_-(w[M+1]-b),P.add(A);const{id:T,clipPathId:R}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:v.color,"fill-opacity":v._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:P.toSVGPath()}},!0,!0);We(y=v,Jy,Gx).call(y,{highlightOutlines:P.getOutlines(),highlightId:T,clipPathId:R}),We(f=v,uh,$d).call(f)}return v}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),c=so._colorManager.convert(this.color),a={annotationType:Yr.HIGHLIGHT,color:c,opacity:D(this,ch),thickness:D(this,jl),quadPoints:We(this,yE,m9).call(this),outlines:We(this,bE,g9).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:We(this,Hp,Hb).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!We(this,wE,v9).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ky=new WeakMap,x_=new WeakMap,lh=new WeakMap,Vp=new WeakMap,Xy=new WeakMap,Da=new WeakMap,S_=new WeakMap,E_=new WeakMap,qp=new WeakMap,Ll=new WeakMap,cl=new WeakMap,Ds=new WeakMap,Zy=new WeakMap,ch=new WeakMap,ta=new WeakMap,Yy=new WeakMap,jl=new WeakMap,A_=new WeakMap,k_=new WeakSet,t5=function(){const t=new X4(D(this,lh),.001);Ie(this,Ll,t.getOutlines()),[this.x,this.y,this.width,this.height]=D(this,Ll).box;const i=new X4(D(this,lh),.0025,.001,this._uiManager.direction==="ltr");Ie(this,Da,i.getOutlines());const{lastPoint:c}=D(this,Da);Ie(this,Zy,[(c[0]-this.x)/this.width,(c[1]-this.y)/this.height])},Jy=new WeakSet,Gx=function({highlightOutlines:t,highlightId:i,clipPathId:c}){var g,_;if(Ie(this,Ll,t),Ie(this,Da,t.getNewOutline(D(this,jl)/2+1.5,.0025)),i>=0)Ie(this,cl,i),Ie(this,Vp,c),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),Ie(this,ta,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:D(this,Da).box,path:{d:D(this,Da).toSVGPath()}},!0));else if(this.parent){const E=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(D(this,cl),{bbox:We(g=Ei,jf,hg).call(g,D(this,Ll).box,(E-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(D(this,ta),{bbox:We(_=Ei,jf,hg).call(_,D(this,Da).box,E),path:{d:D(this,Da).toSVGPath()}})}const[l,r,h,m]=t.box;switch(this.rotation){case 0:this.x=l,this.y=r,this.width=h,this.height=m;break;case 90:{const[E,b]=this.parentDimensions;this.x=r,this.y=1-l,this.width=h*b/E,this.height=m*E/b;break}case 180:this.x=1-l,this.y=1-r,this.width=h,this.height=m;break;case 270:{const[E,b]=this.parentDimensions;this.x=1-r,this.y=l,this.width=h*b/E,this.height=m*E/b;break}}const{lastPoint:v}=D(this,Da);Ie(this,Zy,[(v[0]-l)/h,(v[1]-r)/m])},dE=new WeakSet,h9=function(t){const i=(l,r)=>{var h,m;this.color=l,Ie(this,ch,r),(h=this.parent)==null||h.drawLayer.updateProperties(D(this,cl),{root:{fill:l,"fill-opacity":r}}),(m=D(this,Xy))==null||m.updateColor(l)},c=this.color,a=D(this,ch);this.addCommands({cmd:i.bind(this,t,Ei._defaultOpacity),undo:i.bind(this,c,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:_i.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},pE=new WeakSet,f9=function(t){const i=D(this,jl),c=a=>{Ie(this,jl,a),We(this,mE,d9).call(this,a)};this.addCommands({cmd:c.bind(this,t),undo:c.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:_i.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},mE=new WeakSet,d9=function(t){if(!D(this,Ds))return;We(this,Jy,Gx).call(this,{highlightOutlines:D(this,Ll).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,c]=this.parentDimensions;this.setDims(this.width*i,this.height*c)},P_=new WeakSet,n5=function(){D(this,cl)===null||!this.parent||(this.parent.drawLayer.remove(D(this,cl)),Ie(this,cl,null),this.parent.drawLayer.remove(D(this,ta)),Ie(this,ta,null))},uh=new WeakSet,$d=function(t=this.parent){D(this,cl)===null&&({id:da(this,cl)._,clipPathId:da(this,Vp)._}=t.drawLayer.draw({bbox:D(this,Ll).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":D(this,ch)},rootClass:{highlight:!0,free:D(this,Ds)},path:{d:D(this,Ll).toSVGPath()}},!1,!0),Ie(this,ta,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:D(this,Ds)},bbox:D(this,Da).box,path:{d:D(this,Da).toSVGPath()}},D(this,Ds))),D(this,qp)&&(D(this,qp).style.clipPath=D(this,Vp)))},jf=new WeakSet,hg=function([t,i,c,a],l){switch(l){case 90:return[1-i-a,t,a,c];case 180:return[1-t-c,1-i-a,c,a];case 270:return[i,1-t-c,a,c]}return[t,i,c,a]},gE=new WeakSet,p9=function(t){Ei._keyboardManager.exec(this,t)},Qy=new WeakSet,Kx=function(t){if(!D(this,Ky))return;const i=window.getSelection();t?i.setPosition(D(this,Ky),D(this,x_)):i.setPosition(D(this,S_),D(this,E_))},Hp=new WeakSet,Hb=function(){return D(this,Ds)?this.rotation:0},yE=new WeakSet,m9=function(){if(D(this,Ds))return null;const[t,i]=this.pageDimensions,[c,a]=this.pageTranslation,l=D(this,lh),r=new Float32Array(l.length*8);let h=0;for(const{x:m,y:v,width:g,height:_}of l){const E=m*t+c,b=(1-v)*i+a;r[h]=r[h+4]=E,r[h+1]=r[h+3]=b,r[h+2]=r[h+6]=E+g*t,r[h+5]=r[h+7]=b-_*i,h+=8}return r},bE=new WeakSet,g9=function(t){return D(this,Ll).serialize(t,We(this,Hp,Hb).call(this))},vE=new WeakSet,y9=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},_E=new WeakSet,b9=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},wE=new WeakSet,v9=function(t){const{color:i}=this._initialData;return t.color.some((c,a)=>c!==i[a])},Pe(Ei,jf),Pe(Ei,vE),Pe(Ei,_E),Or(Ei,"_defaultColor",null),Or(Ei,"_defaultOpacity",1),Or(Ei,"_defaultThickness",12),Or(Ei,"_type","highlight"),Or(Ei,"_editorType",Yr.HIGHLIGHT),Or(Ei,"_freeHighlightId",-1),Or(Ei,"_freeHighlight",null),Or(Ei,"_freeHighlightClipId","");let H2=Ei;var Wp;class _9{constructor(){Pe(this,Wp,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){D(this,Wp)[e]=t}toSVGProperties(){const e=D(this,Wp);return Ie(this,Wp,Object.create(null)),{root:e}}reset(){Ie(this,Wp,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){zi("Not implemented")}}Wp=new WeakMap;var ul,e0,ys,Gp,Kp,Nf,$f,Bf,Xp,T_,r5,O_,i5,M_,o5,Zp,Wb,xE,w9,t0,Xx,Yp,Gb,Ff,fg;const fr=class fr extends so{constructor(t){super(t);Pe(this,T_);Pe(this,O_);Pe(this,M_);Pe(this,Zp);Pe(this,xE);Pe(this,t0);Pe(this,Yp);Pe(this,Ff);Pe(this,ul,null);Pe(this,e0,void 0);Or(this,"_drawId",null);Ie(this,e0,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(We(this,T_,r5).call(this,t),We(this,Zp,Wb).call(this))}static _mergeSVGProperties(t,i){const c=new Set(Object.keys(t));for(const[a,l]of Object.entries(i))c.has(a)?Object.assign(t[a],l):t[a]=l;return t}static getDefaultDrawingOptions(t){zi("Not implemented")}static get typesMap(){zi("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const c=this.typesMap.get(t);c&&this._defaultDrawingOptions.updateProperty(c,i),this._currentParent&&(D(fr,ys).updateProperty(c,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const c=this.constructor.typesMap.get(t);c&&this._updateProperty(t,c,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[c,a]of this.typesMap)t.push([c,i[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[c,a]of this.constructor.typesMap)t.push([c,i[a]]);return t}_updateProperty(t,i,c){const a=this._drawingOptions,l=a[i],r=h=>{var v;a.updateProperty(i,h);const m=D(this,ul).updateProperty(i,h);m&&We(this,Yp,Gb).call(this,m),(v=this.parent)==null||v.drawLayer.updateProperties(this._drawId,a.toSVGProperties())};this.addCommands({cmd:r.bind(this,c),undo:r.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,fr._mergeSVGProperties(D(this,ul).getPathResizingSVGProperties(We(this,t0,Xx).call(this)),{bbox:We(this,Ff,fg).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,fr._mergeSVGProperties(D(this,ul).getPathResizedSVGProperties(We(this,t0,Xx).call(this)),{bbox:We(this,Ff,fg).call(this)}))}_onTranslating(t,i){var c;(c=this.parent)==null||c.drawLayer.updateProperties(this._drawId,{bbox:We(this,Ff,fg).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,fr._mergeSVGProperties(D(this,ul).getPathTranslatedSVGProperties(We(this,t0,Xx).call(this),this.parentDimensions),{bbox:We(this,Ff,fg).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,D(this,e0)&&(Ie(this,e0,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){We(this,M_,o5).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(We(this,Zp,Wb).call(this),We(this,Yp,Gb).call(this,D(this,ul).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var c;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),We(this,M_,o5).call(this)):t&&(this._uiManager.addShouldRescale(this),We(this,Zp,Wb).call(this,t),i=!this.parent&&((c=this.div)==null?void 0:c.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,fr._mergeSVGProperties({bbox:We(this,Ff,fg).call(this)},D(this,ul).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&We(this,Yp,Gb).call(this,D(this,ul).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const c=super.render();c.classList.add("draw");const a=document.createElement("div");c.append(a),a.setAttribute("aria-hidden","true"),a.className="internal";const[l,r]=this.parentDimensions;return this.setDims(this.width*l,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),c}static createDrawerInstance(t,i,c,a,l){zi("Not implemented")}static startDrawing(t,i,c,a){var x;const{target:l,offsetX:r,offsetY:h,pointerId:m,pointerType:v}=a;if(D(fr,$f)&&D(fr,$f)!==v)return;const{viewport:{rotation:g}}=t,{width:_,height:E}=l.getBoundingClientRect(),b=Ie(fr,Gp,new AbortController),p=t.combinedSignal(b);if(D(fr,Nf)||Ie(fr,Nf,m),D(fr,$f)??Ie(fr,$f,v),window.addEventListener("pointerup",y=>{var f;D(fr,Nf)===y.pointerId?this._endDraw(y):(f=D(fr,Bf))==null||f.delete(y.pointerId)},{signal:p}),window.addEventListener("pointercancel",y=>{var f;D(fr,Nf)===y.pointerId?this._currentParent.endDrawingSession():(f=D(fr,Bf))==null||f.delete(y.pointerId)},{signal:p}),window.addEventListener("pointerdown",y=>{D(fr,$f)===y.pointerType&&((D(fr,Bf)||Ie(fr,Bf,new Set)).add(y.pointerId),D(fr,ys).isCancellable()&&(D(fr,ys).removeLastElement(),D(fr,ys).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Ac,{signal:p}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:p}),l.addEventListener("touchmove",y=>{y.timeStamp===D(fr,Xp)&&Fo(y)},{signal:p}),t.toggleDrawing(),(x=i._editorUndoBar)==null||x.hide(),D(fr,ys)){t.drawLayer.updateProperties(this._currentDrawId,D(fr,ys).startNew(r,h,_,E,g));return}i.updateUIForDefaultProperties(this),Ie(fr,ys,this.createDrawerInstance(r,h,_,E,g)),Ie(fr,Kp,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(D(fr,Kp).toSVGProperties(),D(fr,ys).defaultSVGProperties),!0,!1)}static _drawMove(t){var l;if(Ie(fr,Xp,-1),!D(fr,ys))return;const{offsetX:i,offsetY:c,pointerId:a}=t;if(D(fr,Nf)===a){if(((l=D(fr,Bf))==null?void 0:l.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,D(fr,ys).add(i,c)),Ie(fr,Xp,t.timeStamp),Fo(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Ie(fr,ys,null),Ie(fr,Kp,null),Ie(fr,$f,null),Ie(fr,Xp,NaN)),D(fr,Gp)&&(D(fr,Gp).abort(),Ie(fr,Gp,null),Ie(fr,Nf,NaN),Ie(fr,Bf,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,D(fr,ys).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const c=D(fr,ys),a=this._currentDrawId,l=c.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(a,c.setLastElement(l))},undo:()=>{i.drawLayer.updateProperties(a,c.removeLastElement())},mustExec:!1,type:_i.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(_i.DRAW_STEP),!D(fr,ys).isEmpty()){const{pageDimensions:[c,a],scale:l}=i,r=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:D(fr,ys).getOutlines(c*l,a*l,l,this._INNER_MARGIN),drawingOptions:D(fr,Kp),mustBeCommitted:!t});return this._cleanup(!0),r}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,c,a,l,r){zi("Not implemented")}static async deserialize(t,i,c){var g,_;const{rawDims:{pageWidth:a,pageHeight:l,pageX:r,pageY:h}}=i.viewport,m=this.deserializeDraw(r,h,a,l,this._INNER_MARGIN,t),v=await super.deserialize(t,i,c);return v.createDrawingOptions(t),We(g=v,T_,r5).call(g,{drawOutlines:m}),We(_=v,Zp,Wb).call(_),v.onScaleChanging(),v.rotate(),v}serializeDraw(t){const[i,c]=this.pageTranslation,[a,l]=this.pageDimensions;return D(this,ul).serialize([i,c,a,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ul=new WeakMap,e0=new WeakMap,ys=new WeakMap,Gp=new WeakMap,Kp=new WeakMap,Nf=new WeakMap,$f=new WeakMap,Bf=new WeakMap,Xp=new WeakMap,T_=new WeakSet,r5=function({drawOutlines:t,drawId:i,drawingOptions:c}){Ie(this,ul,t),this._drawingOptions||(this._drawingOptions=c),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=We(this,O_,i5).call(this,t,this.parent),We(this,Yp,Gb).call(this,t.box)},O_=new WeakSet,i5=function(t,i){const{id:c}=i.drawLayer.draw(fr._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return c},M_=new WeakSet,o5=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Zp=new WeakSet,Wb=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=We(this,O_,i5).call(this,D(this,ul),t)}},xE=new WeakSet,w9=function([t,i,c,a]){const{parentDimensions:[l,r],rotation:h}=this;switch(h){case 90:return[i,1-t,c*(r/l),a*(l/r)];case 180:return[1-t,1-i,c,a];case 270:return[1-i,t,c*(r/l),a*(l/r)];default:return[t,i,c,a]}},t0=new WeakSet,Xx=function(){const{x:t,y:i,width:c,height:a,parentDimensions:[l,r],rotation:h}=this;switch(h){case 90:return[1-i,t,c*(l/r),a*(r/l)];case 180:return[1-t,1-i,c,a];case 270:return[i,1-t,c*(l/r),a*(r/l)];default:return[t,i,c,a]}},Yp=new WeakSet,Gb=function(t){if([this.x,this.y,this.width,this.height]=We(this,xE,w9).call(this,t),this.div){this.fixAndSetPosition();const[i,c]=this.parentDimensions;this.setDims(this.width*i,this.height*c)}this._onResized()},Ff=new WeakSet,fg=function(){const{x:t,y:i,width:c,height:a,rotation:l,parentRotation:r,parentDimensions:[h,m]}=this;switch((l*4+r)/90){case 1:return[1-i-a,t,a,c];case 2:return[1-t-c,1-i-a,c,a];case 3:return[i,1-t-c,a,c];case 4:return[t,i-c*(h/m),a*(m/h),c*(h/m)];case 5:return[1-i,t,c*(h/m),a*(m/h)];case 6:return[1-t-a*(m/h),1-i,a*(m/h),c*(h/m)];case 7:return[i-c*(h/m),1-t-a*(m/h),c*(h/m),a*(m/h)];case 8:return[t-c,i-a,c,a];case 9:return[1-i,t-c,a,c];case 10:return[1-t,1-i,c,a];case 11:return[i-a,1-t,a,c];case 12:return[t-a*(m/h),i,a*(m/h),c*(h/m)];case 13:return[1-i-c*(h/m),t-a*(m/h),c*(h/m),a*(m/h)];case 14:return[1-t,1-i-c*(h/m),a*(m/h),c*(h/m)];case 15:return[i,1-t,c*(h/m),a*(m/h)];default:return[t,i,c,a]}},Or(fr,"_currentDrawId",-1),Or(fr,"_currentParent",null),Pe(fr,ys,null),Pe(fr,Gp,null),Pe(fr,Kp,null),Pe(fr,Nf,NaN),Pe(fr,$f,null),Pe(fr,Bf,null),Pe(fr,Xp,NaN),Or(fr,"_INNER_MARGIN",3);let W2=fr;var tu,bs,vs,Jp,n0,ya,Ls,Nl,Qp,em,tm,r0,Zx;class eW{constructor(e,t,i,c,a,l){Pe(this,r0);Pe(this,tu,new Float64Array(6));Pe(this,bs,void 0);Pe(this,vs,void 0);Pe(this,Jp,void 0);Pe(this,n0,void 0);Pe(this,ya,void 0);Pe(this,Ls,"");Pe(this,Nl,0);Pe(this,Qp,new iw);Pe(this,em,void 0);Pe(this,tm,void 0);Ie(this,em,i),Ie(this,tm,c),Ie(this,Jp,a),Ie(this,n0,l),[e,t]=We(this,r0,Zx).call(this,e,t);const r=Ie(this,bs,[NaN,NaN,NaN,NaN,e,t]);Ie(this,ya,[e,t]),Ie(this,vs,[{line:r,points:D(this,ya)}]),D(this,tu).set(r,0)}updateProperty(e,t){e==="stroke-width"&&Ie(this,n0,t)}isEmpty(){return!D(this,vs)||D(this,vs).length===0}isCancellable(){return D(this,ya).length<=10}add(e,t){[e,t]=We(this,r0,Zx).call(this,e,t);const[i,c,a,l]=D(this,tu).subarray(2,6),r=e-a,h=t-l;return Math.hypot(D(this,em)*r,D(this,tm)*h)<=2?null:(D(this,ya).push(e,t),isNaN(i)?(D(this,tu).set([a,l,e,t],2),D(this,bs).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(D(this,tu)[0])&&D(this,bs).splice(6,6),D(this,tu).set([i,c,a,l,e,t],0),D(this,bs).push(...lr.createBezierPoints(i,c,a,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(D(this,ya).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,c,a){Ie(this,em,i),Ie(this,tm,c),Ie(this,Jp,a),[e,t]=We(this,r0,Zx).call(this,e,t);const l=Ie(this,bs,[NaN,NaN,NaN,NaN,e,t]);Ie(this,ya,[e,t]);const r=D(this,vs).at(-1);return r&&(r.line=new Float32Array(r.line),r.points=new Float32Array(r.points)),D(this,vs).push({line:l,points:D(this,ya)}),D(this,tu).set(l,0),Ie(this,Nl,0),this.toSVGPath(),null}getLastElement(){return D(this,vs).at(-1)}setLastElement(e){return D(this,vs)?(D(this,vs).push(e),Ie(this,bs,e.line),Ie(this,ya,e.points),Ie(this,Nl,0),{path:{d:this.toSVGPath()}}):D(this,Qp).setLastElement(e)}removeLastElement(){if(!D(this,vs))return D(this,Qp).removeLastElement();D(this,vs).pop(),Ie(this,Ls,"");for(let e=0,t=D(this,vs).length;e<t;e++){const{line:i,points:c}=D(this,vs)[e];Ie(this,bs,i),Ie(this,ya,c),Ie(this,Nl,0),this.toSVGPath()}return{path:{d:D(this,Ls)}}}toSVGPath(){const e=lr.svgRound(D(this,bs)[4]),t=lr.svgRound(D(this,bs)[5]);if(D(this,ya).length===2)return Ie(this,Ls,`${D(this,Ls)} M ${e} ${t} Z`),D(this,Ls);if(D(this,ya).length<=6){const c=D(this,Ls).lastIndexOf("M");Ie(this,Ls,`${D(this,Ls).slice(0,c)} M ${e} ${t}`),Ie(this,Nl,6)}if(D(this,ya).length===4){const c=lr.svgRound(D(this,bs)[10]),a=lr.svgRound(D(this,bs)[11]);return Ie(this,Ls,`${D(this,Ls)} L ${c} ${a}`),Ie(this,Nl,12),D(this,Ls)}const i=[];D(this,Nl)===0&&(i.push(`M ${e} ${t}`),Ie(this,Nl,6));for(let c=D(this,Nl),a=D(this,bs).length;c<a;c+=6){const[l,r,h,m,v,g]=D(this,bs).slice(c,c+6).map(lr.svgRound);i.push(`C${l} ${r} ${h} ${m} ${v} ${g}`)}return Ie(this,Ls,D(this,Ls)+i.join(" ")),Ie(this,Nl,D(this,bs).length),D(this,Ls)}getOutlines(e,t,i,c){const a=D(this,vs).at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),D(this,Qp).build(D(this,vs),e,t,i,D(this,Jp),D(this,n0),c),Ie(this,tu,null),Ie(this,bs,null),Ie(this,vs,null),Ie(this,Ls,null),D(this,Qp)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}tu=new WeakMap,bs=new WeakMap,vs=new WeakMap,Jp=new WeakMap,n0=new WeakMap,ya=new WeakMap,Ls=new WeakMap,Nl=new WeakMap,Qp=new WeakMap,em=new WeakMap,tm=new WeakMap,r0=new WeakSet,Zx=function(e,t){return lr._normalizePoint(e,t,D(this,em),D(this,tm),D(this,Jp))};var ba,C_,I_,hl,nu,ru,i0,o0,nm,mc,Lu,SE,x9,EE,S9,AE,E9;class iw extends lr{constructor(){super(...arguments);Pe(this,mc);Pe(this,SE);Pe(this,EE);Pe(this,AE);Pe(this,ba,void 0);Pe(this,C_,0);Pe(this,I_,void 0);Pe(this,hl,void 0);Pe(this,nu,void 0);Pe(this,ru,void 0);Pe(this,i0,void 0);Pe(this,o0,void 0);Pe(this,nm,void 0)}build(t,i,c,a,l,r,h){Ie(this,nu,i),Ie(this,ru,c),Ie(this,i0,a),Ie(this,o0,l),Ie(this,nm,r),Ie(this,I_,h??0),Ie(this,hl,t),We(this,EE,S9).call(this)}get thickness(){return D(this,nm)}setLastElement(t){return D(this,hl).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return D(this,hl).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of D(this,hl)){if(t.push(`M${lr.svgRound(i[4])} ${lr.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${lr.svgRound(i[10])} ${lr.svgRound(i[11])}`);continue}for(let c=6,a=i.length;c<a;c+=6){const[l,r,h,m,v,g]=i.subarray(c,c+6).map(lr.svgRound);t.push(`C${l} ${r} ${h} ${m} ${v} ${g}`)}}return t.join("")}serialize([t,i,c,a],l){const r=[],h=[],[m,v,g,_]=We(this,SE,x9).call(this);let E,b,p,x,y,f,w,A,P;switch(D(this,o0)){case 0:P=lr._rescale,E=t,b=i+a,p=c,x=-a,y=t+m*c,f=i+(1-v-_)*a,w=t+(m+g)*c,A=i+(1-v)*a;break;case 90:P=lr._rescaleAndSwap,E=t,b=i,p=c,x=a,y=t+v*c,f=i+m*a,w=t+(v+_)*c,A=i+(m+g)*a;break;case 180:P=lr._rescale,E=t+c,b=i,p=-c,x=a,y=t+(1-m-g)*c,f=i+v*a,w=t+(1-m)*c,A=i+(v+_)*a;break;case 270:P=lr._rescaleAndSwap,E=t+c,b=i+a,p=-c,x=-a,y=t+(1-v-_)*c,f=i+(1-m-g)*a,w=t+(1-v)*c,A=i+(1-m)*a;break}for(const{line:T,points:R}of D(this,hl))r.push(P(T,E,b,p,x,l?new Array(T.length):null)),h.push(P(R,E,b,p,x,l?new Array(R.length):null));return{lines:r,points:h,rect:[y,f,w,A]}}static deserialize(t,i,c,a,l,{paths:{lines:r,points:h},rotation:m,thickness:v}){const g=[];let _,E,b,p,x;switch(m){case 0:x=lr._rescale,_=-t/c,E=i/a+1,b=1/c,p=-1/a;break;case 90:x=lr._rescaleAndSwap,_=-i/a,E=-t/c,b=1/a,p=1/c;break;case 180:x=lr._rescale,_=t/c+1,E=-i/a,b=-1/c,p=1/a;break;case 270:x=lr._rescaleAndSwap,_=i/a+1,E=t/c+1,b=-1/a,p=-1/c;break}if(!r){r=[];for(const f of h){const w=f.length;if(w===2){r.push(new Float32Array([NaN,NaN,NaN,NaN,f[0],f[1]]));continue}if(w===4){r.push(new Float32Array([NaN,NaN,NaN,NaN,f[0],f[1],NaN,NaN,NaN,NaN,f[2],f[3]]));continue}const A=new Float32Array(3*(w-2));r.push(A);let[P,T,R,M]=f.subarray(0,4);A.set([NaN,NaN,NaN,NaN,P,T],0);for(let L=4;L<w;L+=2){const W=f[L],G=f[L+1];A.set(lr.createBezierPoints(P,T,R,M,W,G),(L-2)*3),[P,T,R,M]=[R,M,W,G]}}}for(let f=0,w=r.length;f<w;f++)g.push({line:x(r[f].map(A=>A??NaN),_,E,b,p),points:x(h[f].map(A=>A??NaN),_,E,b,p)});const y=new this.prototype.constructor;return y.build(g,c,a,1,m,v,l),y}get box(){return D(this,ba)}updateProperty(t,i){return t==="stroke-width"?We(this,AE,E9).call(this,i):null}updateParentDimensions([t,i],c){const[a,l]=We(this,mc,Lu).call(this);Ie(this,nu,t),Ie(this,ru,i),Ie(this,i0,c);const[r,h]=We(this,mc,Lu).call(this),m=r-a,v=h-l,g=D(this,ba);return g[0]-=m,g[1]-=v,g[2]+=2*m,g[3]+=2*v,g}updateRotation(t){return Ie(this,C_,t),{path:{transform:this.rotationTransform}}}get viewBox(){return D(this,ba).map(lr.svgRound).join(" ")}get defaultProperties(){const[t,i]=D(this,ba);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${lr.svgRound(t)} ${lr.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=D(this,ba);let c=0,a=0,l=0,r=0,h=0,m=0;switch(D(this,C_)){case 90:a=i/t,l=-t/i,h=t;break;case 180:c=-1,r=-1,h=t,m=i;break;case 270:a=-i/t,l=t/i,m=i;break;default:return""}return`matrix(${c} ${a} ${l} ${r} ${lr.svgRound(h)} ${lr.svgRound(m)})`}getPathResizingSVGProperties([t,i,c,a]){const[l,r]=We(this,mc,Lu).call(this),[h,m,v,g]=D(this,ba);if(Math.abs(v-l)<=lr.PRECISION||Math.abs(g-r)<=lr.PRECISION){const x=t+c/2-(h+v/2),y=i+a/2-(m+g/2);return{path:{"transform-origin":`${lr.svgRound(t)} ${lr.svgRound(i)}`,transform:`${this.rotationTransform} translate(${x} ${y})`}}}const _=(c-2*l)/(v-2*l),E=(a-2*r)/(g-2*r),b=v/c,p=g/a;return{path:{"transform-origin":`${lr.svgRound(h)} ${lr.svgRound(m)}`,transform:`${this.rotationTransform} scale(${b} ${p}) translate(${lr.svgRound(l)} ${lr.svgRound(r)}) scale(${_} ${E}) translate(${lr.svgRound(-l)} ${lr.svgRound(-r)})`}}}getPathResizedSVGProperties([t,i,c,a]){const[l,r]=We(this,mc,Lu).call(this),h=D(this,ba),[m,v,g,_]=h;if(h[0]=t,h[1]=i,h[2]=c,h[3]=a,Math.abs(g-l)<=lr.PRECISION||Math.abs(_-r)<=lr.PRECISION){const y=t+c/2-(m+g/2),f=i+a/2-(v+_/2);for(const{line:w,points:A}of D(this,hl))lr._translate(w,y,f,w),lr._translate(A,y,f,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${lr.svgRound(t)} ${lr.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const E=(c-2*l)/(g-2*l),b=(a-2*r)/(_-2*r),p=-E*(m+l)+t+l,x=-b*(v+r)+i+r;if(E!==1||b!==1||p!==0||x!==0)for(const{line:y,points:f}of D(this,hl))lr._rescale(y,p,x,E,b,y),lr._rescale(f,p,x,E,b,f);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${lr.svgRound(t)} ${lr.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],c){const[a,l]=c,r=D(this,ba),h=t-r[0],m=i-r[1];if(D(this,nu)===a&&D(this,ru)===l)for(const{line:v,points:g}of D(this,hl))lr._translate(v,h,m,v),lr._translate(g,h,m,g);else{const v=D(this,nu)/a,g=D(this,ru)/l;Ie(this,nu,a),Ie(this,ru,l);for(const{line:_,points:E}of D(this,hl))lr._rescale(_,h,m,v,g,_),lr._rescale(E,h,m,v,g,E);r[2]*=v,r[3]*=g}return r[0]=t,r[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${lr.svgRound(t)} ${lr.svgRound(i)}`}}}get defaultSVGProperties(){const t=D(this,ba);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${lr.svgRound(t[0])} ${lr.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}ba=new WeakMap,C_=new WeakMap,I_=new WeakMap,hl=new WeakMap,nu=new WeakMap,ru=new WeakMap,i0=new WeakMap,o0=new WeakMap,nm=new WeakMap,mc=new WeakSet,Lu=function(t=D(this,nm)){const i=D(this,I_)+t/2*D(this,i0);return D(this,o0)%180===0?[i/D(this,nu),i/D(this,ru)]:[i/D(this,ru),i/D(this,nu)]},SE=new WeakSet,x9=function(){const[t,i,c,a]=D(this,ba),[l,r]=We(this,mc,Lu).call(this,0);return[t+l,i+r,c-2*l,a-2*r]},EE=new WeakSet,S9=function(){const t=Ie(this,ba,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:a}of D(this,hl)){if(a.length<=12){for(let h=4,m=a.length;h<m;h+=6){const[v,g]=a.subarray(h,h+2);t[0]=Math.min(t[0],v),t[1]=Math.min(t[1],g),t[2]=Math.max(t[2],v),t[3]=Math.max(t[3],g)}continue}let l=a[4],r=a[5];for(let h=6,m=a.length;h<m;h+=6){const[v,g,_,E,b,p]=a.subarray(h,h+6);vr.bezierBoundingBox(l,r,v,g,_,E,b,p,t),l=b,r=p}}const[i,c]=We(this,mc,Lu).call(this);t[0]=gl(t[0]-i,0,1),t[1]=gl(t[1]-c,0,1),t[2]=gl(t[2]+i,0,1),t[3]=gl(t[3]+c,0,1),t[2]-=t[0],t[3]-=t[1]},AE=new WeakSet,E9=function(t){const[i,c]=We(this,mc,Lu).call(this);Ie(this,nm,t);const[a,l]=We(this,mc,Lu).call(this),[r,h]=[a-i,l-c],m=D(this,ba);return m[0]-=r,m[1]-=h,m[2]+=2*r,m[3]+=2*h,m};class l3 extends _9{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:so._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new l3(this._viewParameters);return e.updateAll(this),e}}var kE,A9;const Pg=class Pg extends W2{constructor(t){super({...t,name:"inkEditor"});Pe(this,kE);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){so.initialize(t,i),this._defaultDrawingOptions=new l3(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return di(this,"typesMap",new Map([[_i.INK_THICKNESS,"stroke-width"],[_i.INK_COLOR,"stroke"],[_i.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,c,a,l){return new eW(t,i,c,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,c,a,l,r){return iw.deserialize(t,i,c,a,l,r)}static async deserialize(t,i,c){let a=null;if(t instanceof W8){const{data:{inkLists:r,rect:h,rotation:m,id:v,color:g,opacity:_,borderStyle:{rawWidth:E},popupRef:b},parent:{page:{pageNumber:p}}}=t;a=t={annotationType:Yr.INK,color:Array.from(g),thickness:E,opacity:_,paths:{points:r},boxes:null,pageIndex:p-1,rect:h.slice(0),rotation:m,id:v,deleted:!1,popupRef:b}}const l=await super.deserialize(t,i,c);return l.annotationElementId=t.id||null,l._initialData=a,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:c}=this;i.updateSVGProperty("stroke-width"),c.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:c}){this._drawingOptions=Pg.getDefaultDrawingOptions({stroke:vr.makeHexColor(...t),"stroke-width":i,"stroke-opacity":c})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:c,rect:a}=this.serializeDraw(t),{_drawingOptions:{stroke:l,"stroke-opacity":r,"stroke-width":h}}=this,m={annotationType:Yr.INK,color:so._colorManager.convert(l),opacity:r,thickness:h,paths:{lines:i,points:c},pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(m.isCopy=!0,m):this.annotationElementId&&!We(this,kE,A9).call(this,m)?null:(m.id=this.annotationElementId,m)}renderAnnotationElement(t){const{points:i,rect:c}=this.serializeDraw(!1);return t.updateEdited({rect:c,thickness:this._drawingOptions["stroke-width"],points:i}),null}};kE=new WeakSet,A9=function(t){const{color:i,thickness:c,opacity:a,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((r,h)=>r!==i[h])||t.thickness!==c||t.opacity!==a||t.pageIndex!==l},Or(Pg,"_type","ink"),Or(Pg,"_editorType",Yr.INK),Or(Pg,"_defaultDrawingOptions",null);let s5=Pg;class a5 extends iw{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const sx=8,Pb=3;var rm,R_,l5,gc,PE,k9,TE,P9,D_,c5,s0,Yx,OE,T9,ME,O9,CE,M9,L_,u5,j_,h5,IE,C9;class Qo{static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:c},a,l,r,h){let m=new OffscreenCanvas(1,1),v=m.getContext("2d",{alpha:!1});const g=200,_=v.font=`${i} ${c} ${g}px ${t}`,{actualBoundingBoxLeft:E,actualBoundingBoxRight:b,actualBoundingBoxAscent:p,actualBoundingBoxDescent:x,fontBoundingBoxAscent:y,fontBoundingBoxDescent:f,width:w}=v.measureText(e),A=1.5,P=Math.ceil(Math.max(Math.abs(E)+Math.abs(b)||0,w)*A),T=Math.ceil(Math.max(Math.abs(p)+Math.abs(x)||g,Math.abs(y)+Math.abs(f)||g)*A);m=new OffscreenCanvas(P,T),v=m.getContext("2d",{alpha:!0,willReadFrequently:!0}),v.font=_,v.filter="grayscale(1)",v.fillStyle="white",v.fillRect(0,0,P,T),v.fillStyle="black",v.fillText(e,P*(A-1)/2,T*(3-A)/2);const R=We(this,L_,u5).call(this,v.getImageData(0,0,P,T).data),M=We(this,CE,M9).call(this,R),L=We(this,j_,h5).call(this,M),W=We(this,D_,c5).call(this,R,P,T,L);return this.processDrawnLines({lines:{curves:W,width:P,height:T},pageWidth:a,pageHeight:l,rotation:r,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,i,c,a){const[l,r,h]=We(this,IE,C9).call(this,e),[m,v]=We(this,ME,O9).call(this,l,r,h,Math.hypot(r,h)*D(this,rm).sigmaSFactor,D(this,rm).sigmaR,D(this,rm).kernelSize),g=We(this,j_,h5).call(this,v),_=We(this,D_,c5).call(this,m,r,h,g);return this.processDrawnLines({lines:{curves:_,width:r,height:h},pageWidth:t,pageHeight:i,rotation:c,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:c,innerMargin:a,mustSmooth:l,areContours:r}){c%180!==0&&([t,i]=[i,t]);const{curves:h,width:m,height:v}=e,g=e.thickness??0,_=[],E=Math.min(t/m,i/v),b=E/t,p=E/i,x=[];for(const{points:f}of h){const w=l?We(this,OE,T9).call(this,f):f;if(!w)continue;x.push(w);const A=w.length,P=new Float32Array(A),T=new Float32Array(3*(A===2?2:A-2));if(_.push({line:T,points:P}),A===2){P[0]=w[0]*b,P[1]=w[1]*p,T.set([NaN,NaN,NaN,NaN,P[0],P[1]],0);continue}let[R,M,L,W]=w;R*=b,M*=p,L*=b,W*=p,P.set([R,M,L,W],0),T.set([NaN,NaN,NaN,NaN,R,M],0);for(let G=4;G<A;G+=2){const re=P[G]=w[G]*b,Q=P[G+1]=w[G+1]*p;T.set(lr.createBezierPoints(R,M,L,W,re,Q),(G-2)*3),[R,M,L,W]=[L,W,re,Q]}}if(_.length===0)return null;const y=r?new a5:new iw;return y.build(_,t,i,1,c,r?0:g,a),{outline:y,newCurves:x,areContours:r,thickness:g,width:m,height:v}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:c,height:a}){let l=1/0,r=-1/0,h=0;for(const w of e){h+=w.length;for(let A=2,P=w.length;A<P;A++){const T=w[A]-w[A-2];l=Math.min(l,T),r=Math.max(r,T)}}let m;l>=-128&&r<=127?m=Int8Array:l>=-32768&&r<=32767?m=Int16Array:m=Int32Array;const v=e.length,g=sx+Pb*v,_=new Uint32Array(g);let E=0;_[E++]=g*Uint32Array.BYTES_PER_ELEMENT+(h-2*v)*m.BYTES_PER_ELEMENT,_[E++]=0,_[E++]=c,_[E++]=a,_[E++]=t?0:1,_[E++]=Math.max(0,Math.floor(i??0)),_[E++]=v,_[E++]=m.BYTES_PER_ELEMENT;for(const w of e)_[E++]=w.length-2,_[E++]=w[0],_[E++]=w[1];const b=new CompressionStream("deflate-raw"),p=b.writable.getWriter();await p.ready,p.write(_);const x=m.prototype.constructor;for(const w of e){const A=new x(w.length-2);for(let P=2,T=w.length;P<T;P++)A[P-2]=w[P]-w[P-2];p.write(A)}p.close();const y=await new Response(b.readable).arrayBuffer(),f=new Uint8Array(y);return DR(f)}static async decompressSignature(e){try{const t=Sq(e),{readable:i,writable:c}=new DecompressionStream("deflate-raw"),a=c.getWriter();await a.ready,a.write(t).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let l=null,r=0;for await(const w of i)l||(l=new Uint8Array(new Uint32Array(w.buffer,0,4)[0])),l.set(w,r),r+=w.length;const h=new Uint32Array(l.buffer,0,l.length>>2),m=h[1];if(m!==0)throw new Error(`Invalid version: ${m}`);const v=h[2],g=h[3],_=h[4]===0,E=h[5],b=h[6],p=h[7],x=[],y=(sx+Pb*b)*Uint32Array.BYTES_PER_ELEMENT;let f;switch(p){case Int8Array.BYTES_PER_ELEMENT:f=new Int8Array(l.buffer,y);break;case Int16Array.BYTES_PER_ELEMENT:f=new Int16Array(l.buffer,y);break;case Int32Array.BYTES_PER_ELEMENT:f=new Int32Array(l.buffer,y);break}r=0;for(let w=0;w<b;w++){const A=h[Pb*w+sx],P=new Float32Array(A+2);x.push(P);for(let T=0;T<Pb-1;T++)P[T]=h[Pb*w+sx+T+1];for(let T=0;T<A;T++)P[T+2]=P[T]+f[r++]}return{areContours:_,thickness:E,outlines:x,width:v,height:g}}catch(t){return ei(`decompressSignature: ${t}`),null}}}rm=new WeakMap,R_=new WeakSet,l5=function(e,t,i,c){return i-=e,c-=t,i===0?c>0?0:4:i===1?c+6:2-c},gc=new WeakMap,PE=new WeakSet,k9=function(e,t,i,c,a,l,r){const h=We(this,R_,l5).call(this,i,c,a,l);for(let m=0;m<8;m++){const v=(-m+h-r+16)%8,g=D(this,gc)[2*v],_=D(this,gc)[2*v+1];if(e[(i+g)*t+(c+_)]!==0)return v}return-1},TE=new WeakSet,P9=function(e,t,i,c,a,l,r){const h=We(this,R_,l5).call(this,i,c,a,l);for(let m=0;m<8;m++){const v=(m+h+r+16)%8,g=D(this,gc)[2*v],_=D(this,gc)[2*v+1];if(e[(i+g)*t+(c+_)]!==0)return v}return-1},D_=new WeakSet,c5=function(e,t,i,c){const a=e.length,l=new Int32Array(a);for(let v=0;v<a;v++)l[v]=e[v]<=c?1:0;for(let v=1;v<i-1;v++)l[v*t]=l[v*t+t-1]=0;for(let v=0;v<t;v++)l[v]=l[t*i-1-v]=0;let r=1,h;const m=[];for(let v=1;v<i-1;v++){h=1;for(let g=1;g<t-1;g++){const _=v*t+g,E=l[_];if(E===0)continue;let b=v,p=g;if(E===1&&l[_-1]===0)r+=1,p-=1;else if(E>=1&&l[_+1]===0)r+=1,p+=1,E>1&&(h=E);else{E!==1&&(h=Math.abs(E));continue}const x=[g,v],y=p===g+1,f={isHole:y,points:x,id:r,parent:0};m.push(f);let w;for(const G of m)if(G.id===h){w=G;break}w?w.isHole?f.parent=y?w.parent:h:f.parent=y?h:w.parent:f.parent=y?h:0;const A=We(this,PE,k9).call(this,l,t,v,g,b,p,0);if(A===-1){l[_]=-r,l[_]!==1&&(h=Math.abs(l[_]));continue}let P=D(this,gc)[2*A],T=D(this,gc)[2*A+1];const R=v+P,M=g+T;b=R,p=M;let L=v,W=g;for(;;){const G=We(this,TE,P9).call(this,l,t,L,W,b,p,1);P=D(this,gc)[2*G],T=D(this,gc)[2*G+1];const re=L+P,Q=W+T;x.push(Q,re);const oe=L*t+W;if(l[oe+1]===0?l[oe]=-r:l[oe]===1&&(l[oe]=r),re===v&&Q===g&&L===R&&W===M){l[_]!==1&&(h=Math.abs(l[_]));break}else b=L,p=W,L=re,W=Q}}}return m},s0=new WeakSet,Yx=function(e,t,i,c){if(i-t<=4){for(let R=t;R<i-2;R+=2)c.push(e[R],e[R+1]);return}const a=e[t],l=e[t+1],r=e[i-4]-a,h=e[i-3]-l,m=Math.hypot(r,h),v=r/m,g=h/m,_=v*l-g*a,E=h/r,b=1/m,p=Math.atan(E),x=Math.cos(p),y=Math.sin(p),f=b*(Math.abs(x)+Math.abs(y)),w=b*(1-f+f**2),A=Math.max(Math.atan(Math.abs(y+x)*w),Math.atan(Math.abs(y-x)*w));let P=0,T=t;for(let R=t+2;R<i-2;R+=2){const M=Math.abs(_-v*e[R+1]+g*e[R]);M>P&&(T=R,P=M)}P>(m*A)**2?(We(this,s0,Yx).call(this,e,t,T+2,c),We(this,s0,Yx).call(this,e,T,i,c)):c.push(a,l)},OE=new WeakSet,T9=function(e){const t=[],i=e.length;return We(this,s0,Yx).call(this,e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t},ME=new WeakSet,O9=function(e,t,i,c,a,l){const r=new Float32Array(l**2),h=-2*c**2,m=l>>1;for(let p=0;p<l;p++){const x=(p-m)**2;for(let y=0;y<l;y++)r[p*l+y]=Math.exp((x+(y-m)**2)/h)}const v=new Float32Array(256),g=-2*a**2;for(let p=0;p<256;p++)v[p]=Math.exp(p**2/g);const _=e.length,E=new Uint8Array(_),b=new Uint32Array(256);for(let p=0;p<i;p++)for(let x=0;x<t;x++){const y=p*t+x,f=e[y];let w=0,A=0;for(let T=0;T<l;T++){const R=p+T-m;if(!(R<0||R>=i))for(let M=0;M<l;M++){const L=x+M-m;if(L<0||L>=t)continue;const W=e[R*t+L],G=r[T*l+M]*v[Math.abs(W-f)];w+=W*G,A+=G}}const P=E[y]=Math.round(w/A);b[P]++}return[E,b]},CE=new WeakSet,M9=function(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t},L_=new WeakSet,u5=function(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let c=-1/0,a=1/0;for(let r=0,h=i.length;r<h;r++){if(e[(r<<2)+3]===0){c=i[r]=255;continue}const v=i[r]=e[r<<2];v>c&&(c=v),v<a&&(a=v)}const l=255/(c-a);for(let r=0;r<t;r++)i[r]=(i[r]-a)*l;return i},j_=new WeakSet,h5=function(e){let t,i=-1/0,c=-1/0;const a=e.findIndex(h=>h!==0);let l=a,r=a;for(t=a;t<256;t++){const h=e[t];h>i&&(t-l>c&&(c=t-l,r=t-1),i=h,l=t)}for(t=r-1;t>=0&&!(e[t]>e[t+1]);t--);return t},IE=new WeakSet,C9=function(e){const t=e,{width:i,height:c}=e,{maxDim:a}=D(this,rm);let l=i,r=c;if(i>a||c>a){let _=i,E=c,b=Math.log2(Math.max(i,c)/a);const p=Math.floor(b);b=b===p?p-1:p;for(let y=0;y<b;y++){l=_,r=E,l>a&&(l=Math.ceil(l/2)),r>a&&(r=Math.ceil(r/2));const f=new OffscreenCanvas(l,r);f.getContext("2d").drawImage(e,0,0,_,E,0,0,l,r),_=l,E=r,e!==t&&e.close(),e=f.transferToImageBitmap()}const x=Math.min(a/l,a/r);l=Math.round(l*x),r=Math.round(r*x)}const m=new OffscreenCanvas(l,r).getContext("2d",{willReadFrequently:!0});m.filter="grayscale(1)",m.drawImage(e,0,0,e.width,e.height,0,0,l,r);const v=m.getImageData(0,0,l,r).data;return[We(this,L_,u5).call(this,v),l,r]},Pe(Qo,R_),Pe(Qo,PE),Pe(Qo,TE),Pe(Qo,D_),Pe(Qo,s0),Pe(Qo,OE),Pe(Qo,ME),Pe(Qo,CE),Pe(Qo,L_),Pe(Qo,j_),Pe(Qo,IE),Pe(Qo,rm,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),Pe(Qo,gc,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class G8 extends _9{constructor(){super(),super.updateProperties({fill:"CanvasText","stroke-width":0})}clone(){const e=new G8;return e.updateAll(this),e}}class K8 extends l3{constructor(e){super(e),super.updateProperties({stroke:"CanvasText","stroke-width":1})}clone(){const e=new K8(this._viewParameters);return e.updateAll(this),e}}var zf,fl,Uf,Vf;const el=class el extends W2{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});Pe(this,zf,!1);Pe(this,fl,null);Pe(this,Uf,null);Pe(this,Vf,null);this._willKeepAspectRatio=!0,Ie(this,Uf,t.signatureData||null),Ie(this,fl,null),this.defaultL10nId="pdfjs-editor-signature-editor"}static initialize(t,i){so.initialize(t,i),this._defaultDrawingOptions=new G8,this._defaultDrawnSignatureOptions=new K8(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return di(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!D(this,fl)}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:c}=this;if(c&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(D(this,Uf)){const{lines:a,mustSmooth:l,areContours:r,description:h,uuid:m,heightInPage:v}=D(this,Uf),{rawDims:{pageWidth:g,pageHeight:_},rotation:E}=this.parent.viewport,b=Qo.processDrawnLines({lines:a,pageWidth:g,pageHeight:_,rotation:E,innerMargin:el._INNER_MARGIN,mustSmooth:l,areContours:r});this.addSignature(b,v,h,m)}else this.div.hidden=!0,this._uiManager.getSignature(this);return c&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){Ie(this,Vf,t),this.addEditToolbar()}getUuid(){return D(this,Vf)}get description(){return D(this,fl)}set description(t){Ie(this,fl,t),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:c,width:a,height:l}=D(this,Uf),r=Math.max(a,l),h=Qo.processDrawnLines({lines:{curves:t.map(m=>({points:m})),thickness:c,width:a,height:l},pageWidth:r,pageHeight:r,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:h.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&D(this,fl)!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,D(this,Vf),D(this,fl)),t.show()),t):null}addSignature(t,i,c,a){const{x:l,y:r}=this,{outline:h}=Ie(this,Uf,t);Ie(this,zf,h instanceof a5),Ie(this,fl,c),this.div.setAttribute("aria-description",c);let m;D(this,zf)?m=el.getDefaultDrawingOptions():(m=el._defaultDrawnSignatureOptions.clone(),m.updateProperties({"stroke-width":h.thickness})),this._addOutlines({drawOutlines:h,drawingOptions:m});const[v,g]=this.parentDimensions,[,_]=this.pageDimensions;let E=i/_;E=E>=1?.5:E,this.width*=E/this.height,this.width>=1&&(E*=.9/this.width,this.width=.9),this.height=E,this.setDims(v*this.width,g*this.height),this.x=l,this.y=r,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!c}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:c},rotation:a}=this.parent.viewport;return Qo.process(t,i,c,a,el._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:c,pageHeight:a},rotation:l}=this.parent.viewport;return Qo.extractContoursFromText(t,i,c,a,l,el._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:c},rotation:a}=this.parent.viewport;return Qo.processDrawnLines({lines:t,pageWidth:i,pageHeight:c,rotation:a,innerMargin:el._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=el.getDefaultDrawingOptions():(this._drawingOptions=el._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:c,rect:a}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":l}}=this,r={annotationType:Yr.SIGNATURE,isSignature:!0,areContours:D(this,zf),color:[0,0,0],thickness:D(this,zf)?0:l,pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(r.paths={lines:i,points:c},r.uuid=D(this,Vf),r.isCopy=!0):r.lines=i,D(this,fl)&&(r.accessibilityData={type:"Figure",alt:D(this,fl)}),r}static deserializeDraw(t,i,c,a,l,r){return r.areContours?a5.deserialize(t,i,c,a,l,r):iw.deserialize(t,i,c,a,l,r)}static async deserialize(t,i,c){var l;const a=await super.deserialize(t,i,c);return Ie(a,zf,t.areContours),Ie(a,fl,((l=t.accessibilityData)==null?void 0:l.alt)||""),Ie(a,Vf,t.uuid),a}};zf=new WeakMap,fl=new WeakMap,Uf=new WeakMap,Vf=new WeakMap,Or(el,"_type","signature"),Or(el,"_editorType",Yr.SIGNATURE),Or(el,"_defaultDrawingOptions",null);let f5=el;var ro,_s,qf,hh,Hf,a0,fh,im,iu,dl,l0,om,Kb,sm,Xb,c0,Jx,u0,Qx,h0,e2,N_,p5,f0,t2,RE,I9;class d5 extends so{constructor(t){super({...t,name:"stampEditor"});Pe(this,om);Pe(this,sm);Pe(this,c0);Pe(this,u0);Pe(this,h0);Pe(this,N_);Pe(this,f0);Pe(this,RE);Pe(this,ro,null);Pe(this,_s,null);Pe(this,qf,null);Pe(this,hh,null);Pe(this,Hf,null);Pe(this,a0,"");Pe(this,fh,null);Pe(this,im,!1);Pe(this,iu,null);Pe(this,dl,!1);Pe(this,l0,!1);Ie(this,hh,t.bitmapUrl),Ie(this,Hf,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){so.initialize(t,i)}static isHandlingMimeForPasting(t){return s4.includes(t)}static paste(t,i){i.pasteEditor(Yr.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:c}=this._uiManager;if(!c)throw new Error("No ML.");if(!await c.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:r}=t||this.copyCanvas(null,null,!0).imageData,h=await c.guess({name:"altText",request:{data:a,width:l,height:r,channels:a.length/(l*r)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const m=h.output;return await this.setGuessedAltText(m),i&&!this.hasAltTextData()&&(this.altTextData={alt:m,decorative:!1}),m}remove(){var t;D(this,_s)&&(Ie(this,ro,null),this._uiManager.imageManager.deleteId(D(this,_s)),(t=D(this,fh))==null||t.remove(),Ie(this,fh,null),D(this,iu)&&(clearTimeout(D(this,iu)),Ie(this,iu,null))),super.remove()}rebuild(){if(!this.parent){D(this,_s)&&We(this,c0,Jx).call(this);return}super.rebuild(),this.div!==null&&(D(this,_s)&&D(this,fh)===null&&We(this,c0,Jx).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(D(this,qf)||D(this,ro)||D(this,hh)||D(this,Hf)||D(this,_s)||D(this,im))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),D(this,im)||(D(this,ro)?We(this,u0,Qx).call(this):We(this,c0,Jx).call(this)),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:c,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),c&&this._uiManager.imageManager.isValidId(c)&&(Ie(this,_s,c),a&&Ie(this,ro,a),Ie(this,im,!1),We(this,u0,Qx).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;D(this,iu)!==null&&clearTimeout(D(this,iu)),Ie(this,iu,setTimeout(()=>{Ie(this,iu,null),We(this,N_,p5).call(this)},200))}copyCanvas(t,i,c=!1){var E;t||(t=224);const{width:a,height:l}=D(this,ro),r=new kh;let h=D(this,ro),m=a,v=l,g=null;if(i){if(a>i||l>i){const M=Math.min(i/a,i/l);m=Math.floor(a*M),v=Math.floor(l*M)}g=document.createElement("canvas");const b=g.width=Math.ceil(m*r.sx),p=g.height=Math.ceil(v*r.sy);D(this,dl)||(h=We(this,h0,e2).call(this,b,p));const x=g.getContext("2d");x.filter=this._uiManager.hcmFilter;let y="white",f="#cfcfd8";this._uiManager.hcmFilter!=="none"?f="black":(E=window.matchMedia)!=null&&E.call(window,"(prefers-color-scheme: dark)").matches&&(y="#8f8f9d",f="#42414d");const w=15,A=w*r.sx,P=w*r.sy,T=new OffscreenCanvas(A*2,P*2),R=T.getContext("2d");R.fillStyle=y,R.fillRect(0,0,A*2,P*2),R.fillStyle=f,R.fillRect(0,0,A,P),R.fillRect(A,P,A,P),x.fillStyle=x.createPattern(T,"repeat"),x.fillRect(0,0,b,p),x.drawImage(h,0,0,h.width,h.height,0,0,b,p)}let _=null;if(c){let b,p;if(r.symmetric&&h.width<t&&h.height<t)b=h.width,p=h.height;else if(h=D(this,ro),a>t||l>t){const f=Math.min(t/a,t/l);b=Math.floor(a*f),p=Math.floor(l*f),D(this,dl)||(h=We(this,h0,e2).call(this,b,p))}const y=new OffscreenCanvas(b,p).getContext("2d",{willReadFrequently:!0});y.drawImage(h,0,0,h.width,h.height,0,0,b,p),_={width:b,height:p,data:y.getImageData(0,0,b,p).data}}return{canvas:g,width:m,height:v,imageData:_}}static async deserialize(t,i,c){var x;let a=null,l=!1;if(t instanceof G7){const{data:{rect:y,rotation:f,id:w,structParent:A,popupRef:P},container:T,parent:{page:{pageNumber:R}},canvas:M}=t;let L,W;M?(delete t.canvas,{id:L,bitmap:W}=c.imageManager.getFromCanvas(T.id,M),M.remove()):(l=!0,t._hasNoCanvas=!0);const G=((x=await i._structTree.getAriaAttributes(`${N8}${w}`))==null?void 0:x.get("aria-label"))||"";a=t={annotationType:Yr.STAMP,bitmapId:L,bitmap:W,pageIndex:R-1,rect:y.slice(0),rotation:f,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:G},isSvg:!1,structParent:A,popupRef:P}}const r=await super.deserialize(t,i,c),{rect:h,bitmap:m,bitmapUrl:v,bitmapId:g,isSvg:_,accessibilityData:E}=t;l?(c.addMissingCanvas(t.id,r),Ie(r,im,!0)):g&&c.imageManager.isValidId(g)?(Ie(r,_s,g),m&&Ie(r,ro,m)):Ie(r,hh,v),Ie(r,dl,_);const[b,p]=r.pageDimensions;return r.width=(h[2]-h[0])/b,r.height=(h[3]-h[1])/p,r.annotationElementId=t.id||null,E&&(r.altTextData=E),r._initialData=a,Ie(r,l0,!!a),r}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const c={annotationType:Yr.STAMP,bitmapId:D(this,_s),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:D(this,dl),structTreeParentId:this._structTreeParentId};if(t)return c.bitmapUrl=We(this,f0,t2).call(this,!0),c.accessibilityData=this.serializeAltText(!0),c.isCopy=!0,c;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(c.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const h=We(this,RE,I9).call(this,c);if(h.isSame)return null;h.isSameAltText?delete c.accessibilityData:c.accessibilityData.structParent=this._initialData.structParent??-1}if(c.id=this.annotationElementId,i===null)return c;i.stamps||(i.stamps=new Map);const r=D(this,dl)?(c.rect[2]-c.rect[0])*(c.rect[3]-c.rect[1]):null;if(!i.stamps.has(D(this,_s)))i.stamps.set(D(this,_s),{area:r,serialized:c}),c.bitmap=We(this,f0,t2).call(this,!1);else if(D(this,dl)){const h=i.stamps.get(D(this,_s));r>h.area&&(h.area=r,h.serialized.bitmap.close(),h.serialized.bitmap=We(this,f0,t2).call(this,!1))}return c}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}ro=new WeakMap,_s=new WeakMap,qf=new WeakMap,hh=new WeakMap,Hf=new WeakMap,a0=new WeakMap,fh=new WeakMap,im=new WeakMap,iu=new WeakMap,dl=new WeakMap,l0=new WeakMap,om=new WeakSet,Kb=function(t,i=!1){if(!t){this.remove();return}Ie(this,ro,t.bitmap),i||(Ie(this,_s,t.id),Ie(this,dl,t.isSvg)),t.file&&Ie(this,a0,t.file.name),We(this,u0,Qx).call(this)},sm=new WeakSet,Xb=function(){if(Ie(this,qf,null),this._uiManager.enableWaiting(!1),!!D(this,fh)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&D(this,ro)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&D(this,ro)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},c0=new WeakSet,Jx=function(){if(D(this,_s)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(D(this,_s)).then(c=>We(this,om,Kb).call(this,c,!0)).finally(()=>We(this,sm,Xb).call(this));return}if(D(this,hh)){const c=D(this,hh);Ie(this,hh,null),this._uiManager.enableWaiting(!0),Ie(this,qf,this._uiManager.imageManager.getFromUrl(c).then(a=>We(this,om,Kb).call(this,a)).finally(()=>We(this,sm,Xb).call(this)));return}if(D(this,Hf)){const c=D(this,Hf);Ie(this,Hf,null),this._uiManager.enableWaiting(!0),Ie(this,qf,this._uiManager.imageManager.getFromFile(c).then(a=>We(this,om,Kb).call(this,a)).finally(()=>We(this,sm,Xb).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=s4.join(",");const i=this._uiManager._signal;Ie(this,qf,new Promise(c=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),We(this,om,Kb).call(this,a)}c()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),c()},{signal:i})}).finally(()=>We(this,sm,Xb).call(this))),t.click()},u0=new WeakSet,Qx=function(){var g;const{div:t}=this;let{width:i,height:c}=D(this,ro);const[a,l]=this.pageDimensions,r=.75;if(this.width)i=this.width*a,c=this.height*l;else if(i>r*a||c>r*l){const _=Math.min(r*a/i,r*l/c);i*=_,c*=_}const[h,m]=this.parentDimensions;this.setDims(i*h/a,c*m/l),this._uiManager.enableWaiting(!1);const v=Ie(this,fh,document.createElement("canvas"));v.setAttribute("role","img"),this.addContainer(v),this.width=i/a,this.height=c/l,(g=this._initialOptions)!=null&&g.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),We(this,N_,p5).call(this),D(this,l0)||(this.parent.addUndoableEditor(this),Ie(this,l0,!0)),this._reportTelemetry({action:"inserted_image"}),D(this,a0)&&this.div.setAttribute("aria-description",D(this,a0))},h0=new WeakSet,e2=function(t,i){const{width:c,height:a}=D(this,ro);let l=c,r=a,h=D(this,ro);for(;l>2*t||r>2*i;){const m=l,v=r;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),r>2*i&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const g=new OffscreenCanvas(l,r);g.getContext("2d").drawImage(h,0,0,m,v,0,0,l,r),h=g.transferToImageBitmap()}return h},N_=new WeakSet,p5=function(){const[t,i]=this.parentDimensions,{width:c,height:a}=this,l=new kh,r=Math.ceil(c*t*l.sx),h=Math.ceil(a*i*l.sy),m=D(this,fh);if(!m||m.width===r&&m.height===h)return;m.width=r,m.height=h;const v=D(this,dl)?D(this,ro):We(this,h0,e2).call(this,r,h),g=m.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(v,0,0,v.width,v.height,0,0,r,h)},f0=new WeakSet,t2=function(t){if(t){if(D(this,dl)){const a=this._uiManager.imageManager.getSvgUrl(D(this,_s));if(a)return a}const i=document.createElement("canvas");return{width:i.width,height:i.height}=D(this,ro),i.getContext("2d").drawImage(D(this,ro),0,0),i.toDataURL()}if(D(this,dl)){const[i,c]=this.pageDimensions,a=Math.round(this.width*i*fd.PDF_TO_CSS_UNITS),l=Math.round(this.height*c*fd.PDF_TO_CSS_UNITS),r=new OffscreenCanvas(a,l);return r.getContext("2d").drawImage(D(this,ro),0,0,D(this,ro).width,D(this,ro).height,0,0,a,l),r.transferToImageBitmap()}return structuredClone(D(this,ro))},RE=new WeakSet,I9=function(t){var r;const{pageIndex:i,accessibilityData:{altText:c}}=this._initialData,a=t.pageIndex===i,l=(((r=t.accessibilityData)==null?void 0:r.alt)||"")===c;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}},Or(d5,"_type","stamp"),Or(d5,"_editorType",Yr.STAMP);var am,d0,ou,Wf,dh,$l,Gf,p0,lm,yc,ph,na,mh,Er,Kf,DE,R9,Bl,zc,$_,g5,B_,y5,m0,n2;const nc=class nc{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:c,accessibilityManager:a,annotationLayer:l,drawLayer:r,textLayer:h,viewport:m,l10n:v}){Pe(this,DE);Pe(this,Bl);Pe(this,$_);Pe(this,B_);Pe(this,m0);Pe(this,am,void 0);Pe(this,d0,!1);Pe(this,ou,null);Pe(this,Wf,null);Pe(this,dh,null);Pe(this,$l,new Map);Pe(this,Gf,!1);Pe(this,p0,!1);Pe(this,lm,!1);Pe(this,yc,null);Pe(this,ph,null);Pe(this,na,null);Pe(this,mh,null);Pe(this,Er,void 0);const g=[...D(nc,Kf).values()];if(!nc._initialized){nc._initialized=!0;for(const _ of g)_.initialize(v,e)}e.registerEditorTypes(g),Ie(this,Er,e),this.pageIndex=t,this.div=i,Ie(this,am,a),Ie(this,ou,l),this.viewport=m,Ie(this,na,h),this.drawLayer=r,this._structTree=c,D(this,Er).addLayer(this)}get isEmpty(){return D(this,$l).size===0}get isInvisible(){return this.isEmpty&&D(this,Er).getMode()===Yr.NONE}updateToolbar(e){D(this,Er).updateToolbar(e)}updateMode(e=D(this,Er).getMode()){switch(We(this,m0,n2).call(this),e){case Yr.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Yr.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Yr.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of D(nc,Kf).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=D(this,na))==null?void 0:t.div)}setEditingState(e){D(this,Er).setEditingState(e)}addCommands(e){D(this,Er).addCommands(e)}cleanUndoStack(e){D(this,Er).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=D(this,ou))==null||t.div.classList.toggle("disabled",!e)}async enable(){Ie(this,lm,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of D(this,$l).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(D(this,Er).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!D(this,ou)){Ie(this,lm,!1);return}const t=D(this,ou).getEditableAnnotations();for(const i of t){if(i.hide(),D(this,Er).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const c=await this.deserialize(i);c&&(this.addOrRebuild(c),c.enableEditing())}Ie(this,lm,!1)}disable(){var c;Ie(this,p0,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const a of D(this,$l).values())if(a.disableEditing(),!!a.annotationElementId){if(a.serialize()!==null){e.set(a.annotationElementId,a);continue}else t.set(a.annotationElementId,a);(c=this.getEditableAnnotation(a.annotationElementId))==null||c.show(),a.remove()}if(D(this,ou)){const a=D(this,ou).getEditableAnnotations();for(const l of a){const{id:r}=l.data;if(D(this,Er).isDeletedAnnotationElement(r))continue;let h=t.get(r);if(h){h.resetAnnotationElement(l),h.show(!1),l.show();continue}h=e.get(r),h&&(D(this,Er).addChangedExistingAnnotation(h),h.renderAnnotationElement(l)&&h.show(!1)),l.show()}}We(this,m0,n2).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const a of D(nc,Kf).values())i.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),Ie(this,p0,!1)}getEditableAnnotation(e){var t;return((t=D(this,ou))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){D(this,Er).getActive()!==e&&D(this,Er).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=D(this,na))!=null&&e.div&&!D(this,mh)){Ie(this,mh,new AbortController);const t=D(this,Er).combinedSignal(D(this,mh));D(this,na).div.addEventListener("pointerdown",We(this,DE,R9).bind(this),{signal:t}),D(this,na).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=D(this,na))!=null&&e.div&&D(this,mh)&&(D(this,mh).abort(),Ie(this,mh,null),D(this,na).div.classList.remove("highlighting"))}enableClick(){if(D(this,Wf))return;Ie(this,Wf,new AbortController);const e=D(this,Er).combinedSignal(D(this,Wf));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=D(this,Wf))==null||e.abort(),Ie(this,Wf,null)}attach(e){D(this,$l).set(e.id,e);const{annotationElementId:t}=e;t&&D(this,Er).isDeletedAnnotationElement(t)&&D(this,Er).removeDeletedAnnotationElement(e)}detach(e){var t;D(this,$l).delete(e.id),(t=D(this,am))==null||t.removePointerInTextLayer(e.contentDiv),!D(this,p0)&&e.annotationElementId&&D(this,Er).addDeletedAnnotationElement(e)}remove(e){this.detach(e),D(this,Er).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(D(this,Er).addDeletedAnnotationElement(e.annotationElementId),so.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),D(this,Er).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!D(this,lm)),D(this,Er).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!D(this,dh)&&(e._focusEventsAllowed=!1,Ie(this,dh,setTimeout(()=>{Ie(this,dh,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:D(this,Er)._signal}),t.focus())},0))),e._structTreeParentId=(i=D(this,am))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return D(this,Er).getId()}combinedSignal(e){return D(this,Er).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=D(this,Bl,zc))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){D(this,Er).updateToolbar(e),await D(this,Er).updateMode(e);const{offsetX:i,offsetY:c}=We(this,B_,y5).call(this),a=this.getNextId(),l=We(this,$_,g5).call(this,{parent:this,id:a,x:i,y:c,uiManager:D(this,Er),isCentered:!0,...t});l&&this.add(l)}async deserialize(e){var t;return await((t=D(nc,Kf).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,D(this,Er)))||null}createAndAddNewEditor(e,t,i={}){const c=this.getNextId(),a=We(this,$_,g5).call(this,{parent:this,id:c,x:e.offsetX,y:e.offsetY,uiManager:D(this,Er),isCentered:t,...i});return a&&this.add(a),a}addNewEditor(e={}){this.createAndAddNewEditor(We(this,B_,y5).call(this),!0,e)}setSelected(e){D(this,Er).setSelected(e)}toggleSelected(e){D(this,Er).toggleSelected(e)}unselect(e){D(this,Er).unselect(e)}pointerup(e){var c;const{isMac:t}=Bs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!D(this,Gf)||(Ie(this,Gf,!1),(c=D(this,Bl,zc))!=null&&c.isDrawer&&D(this,Bl,zc).supportMultipleDrawings))return;if(!D(this,d0)){Ie(this,d0,!0);return}const i=D(this,Er).getMode();if(i===Yr.STAMP||i===Yr.SIGNATURE){D(this,Er).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var c;if(D(this,Er).getMode()===Yr.HIGHLIGHT&&this.enableTextSelection(),D(this,Gf)){Ie(this,Gf,!1);return}const{isMac:t}=Bs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(Ie(this,Gf,!0),(c=D(this,Bl,zc))!=null&&c.isDrawer){this.startDrawingSession(e);return}const i=D(this,Er).getActive();Ie(this,d0,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),D(this,yc)){D(this,Bl,zc).startDrawing(this,D(this,Er),!1,e);return}D(this,Er).setCurrentDrawingSession(this),Ie(this,yc,new AbortController);const t=D(this,Er).combinedSignal(D(this,yc));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(Ie(this,ph,null),this.commitOrRemove())},{signal:t}),D(this,Bl,zc).startDrawing(this,D(this,Er),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&Ie(this,ph,t);return}D(this,ph)&&setTimeout(()=>{var t;(t=D(this,ph))==null||t.focus(),Ie(this,ph,null)},0)}endDrawingSession(e=!1){return D(this,yc)?(D(this,Er).setCurrentDrawingSession(null),D(this,yc).abort(),Ie(this,yc,null),Ie(this,ph,null),D(this,Bl,zc).endDrawing(e)):null}findNewParent(e,t,i){const c=D(this,Er).findParent(t,i);return c===null||c===this?!1:(c.changeParent(e),!0)}commitOrRemove(){return D(this,yc)?(this.endDrawingSession(),!0):!1}onScaleChanging(){D(this,yc)&&D(this,Bl,zc).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=D(this,Er).getActive())==null?void 0:e.parent)===this&&(D(this,Er).commitOrRemove(),D(this,Er).setActiveEditor(null)),D(this,dh)&&(clearTimeout(D(this,dh)),Ie(this,dh,null));for(const i of D(this,$l).values())(t=D(this,am))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,D(this,$l).clear(),D(this,Er).removeLayer(this)}render({viewport:e}){this.viewport=e,vm(this.div,e);for(const t of D(this,Er).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){D(this,Er).commitOrRemove(),We(this,m0,n2).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,vm(this.div,{rotation:i}),t!==i)for(const c of D(this,$l).values())c.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return D(this,Er).viewParameters.realScale}};am=new WeakMap,d0=new WeakMap,ou=new WeakMap,Wf=new WeakMap,dh=new WeakMap,$l=new WeakMap,Gf=new WeakMap,p0=new WeakMap,lm=new WeakMap,yc=new WeakMap,ph=new WeakMap,na=new WeakMap,mh=new WeakMap,Er=new WeakMap,Kf=new WeakMap,DE=new WeakSet,R9=function(e){D(this,Er).unselectAll();const{target:t}=e;if(t===D(this,na).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&D(this,na).div.contains(t)){const{isMac:i}=Bs.platform;if(e.button!==0||e.ctrlKey&&i)return;D(this,Er).showAllEditors("highlight",!0,!0),D(this,na).div.classList.add("free"),this.toggleDrawing(),H2.startHighlighting(this,D(this,Er).direction==="ltr",{target:D(this,na).div,x:e.x,y:e.y}),D(this,na).div.addEventListener("pointerup",()=>{D(this,na).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:D(this,Er)._signal}),e.preventDefault()}},Bl=new WeakSet,zc=function(){return D(nc,Kf).get(D(this,Er).getMode())},$_=new WeakSet,g5=function(e){const t=D(this,Bl,zc);return t?new t.prototype.constructor(e):null},B_=new WeakSet,y5=function(){const{x:e,y:t,width:i,height:c}=this.div.getBoundingClientRect(),a=Math.max(0,e),l=Math.max(0,t),r=Math.min(window.innerWidth,e+i),h=Math.min(window.innerHeight,t+c),m=(a+r)/2-e,v=(l+h)/2-t,[g,_]=this.viewport.rotation%180===0?[m,v]:[v,m];return{offsetX:g,offsetY:_}},m0=new WeakSet,n2=function(){for(const e of D(this,$l).values())e.isEmpty()&&e.remove()},Or(nc,"_initialized",!1),Pe(nc,Kf,new Map([G4,s5,d5,H2,f5].map(e=>[e._editorType,e])));let m5=nc;var bc,va,cm,F_,LE,D9,z_,v5,jE,L9,U_,_5;const Zo=class Zo{constructor({pageIndex:e}){Pe(this,z_);Pe(this,jE);Pe(this,U_);Pe(this,bc,null);Pe(this,va,new Map);Pe(this,cm,new Map);this.pageIndex=e}setParent(e){if(!D(this,bc)){Ie(this,bc,e);return}if(D(this,bc)!==e){if(D(this,va).size>0)for(const t of D(this,va).values())t.remove(),e.append(t);Ie(this,bc,e)}}static get _svgFactory(){return di(this,"_svgFactory",new U2)}draw(e,t=!1,i=!1){const c=da(Zo,F_)._++,a=We(this,z_,v5).call(this),l=Zo._svgFactory.createElement("defs");a.append(l);const r=Zo._svgFactory.createElement("path");l.append(r);const h=`path_p${this.pageIndex}_${c}`;r.setAttribute("id",h),r.setAttribute("vector-effect","non-scaling-stroke"),t&&D(this,cm).set(c,r);const m=i?We(this,jE,L9).call(this,l,h):null,v=Zo._svgFactory.createElement("use");return a.append(v),v.setAttribute("href",`#${h}`),this.updateProperties(a,e),D(this,va).set(c,a),{id:c,clipPathId:`url(#${m})`}}drawOutline(e,t){const i=da(Zo,F_)._++,c=We(this,z_,v5).call(this),a=Zo._svgFactory.createElement("defs");c.append(a);const l=Zo._svgFactory.createElement("path");a.append(l);const r=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",r),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const g=Zo._svgFactory.createElement("mask");a.append(g),h=`mask_p${this.pageIndex}_${i}`,g.setAttribute("id",h),g.setAttribute("maskUnits","objectBoundingBox");const _=Zo._svgFactory.createElement("rect");g.append(_),_.setAttribute("width","1"),_.setAttribute("height","1"),_.setAttribute("fill","white");const E=Zo._svgFactory.createElement("use");g.append(E),E.setAttribute("href",`#${r}`),E.setAttribute("stroke","none"),E.setAttribute("fill","black"),E.setAttribute("fill-rule","nonzero"),E.classList.add("mask")}const m=Zo._svgFactory.createElement("use");c.append(m),m.setAttribute("href",`#${r}`),h&&m.setAttribute("mask",`url(#${h})`);const v=m.cloneNode();return c.append(v),m.classList.add("mainOutline"),v.classList.add("secondaryOutline"),this.updateProperties(c,e),D(this,va).set(i,c),i}finalizeDraw(e,t){D(this,cm).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var h;if(!t)return;const{root:i,bbox:c,rootClass:a,path:l}=t,r=typeof e=="number"?D(this,va).get(e):e;if(r){if(i&&We(this,U_,_5).call(this,r,i),c&&We(h=Zo,LE,D9).call(h,r,c),a){const{classList:m}=r;for(const[v,g]of Object.entries(a))m.toggle(v,g)}if(l){const v=r.firstChild.firstChild;We(this,U_,_5).call(this,v,l)}}}updateParent(e,t){if(t===this)return;const i=D(this,va).get(e);i&&(D(t,bc).append(i),D(this,va).delete(e),D(t,va).set(e,i))}remove(e){D(this,cm).delete(e),D(this,bc)!==null&&(D(this,va).get(e).remove(),D(this,va).delete(e))}destroy(){Ie(this,bc,null);for(const e of D(this,va).values())e.remove();D(this,va).clear(),D(this,cm).clear()}};bc=new WeakMap,va=new WeakMap,cm=new WeakMap,F_=new WeakMap,LE=new WeakSet,D9=function(e,[t,i,c,a]){const{style:l}=e;l.top=`${100*i}%`,l.left=`${100*t}%`,l.width=`${100*c}%`,l.height=`${100*a}%`},z_=new WeakSet,v5=function(){const e=Zo._svgFactory.create(1,1,!0);return D(this,bc).append(e),e.setAttribute("aria-hidden",!0),e},jE=new WeakSet,L9=function(e,t){const i=Zo._svgFactory.createElement("clipPath");e.append(i);const c=`clip_${t}`;i.setAttribute("id",c),i.setAttribute("clipPathUnits","objectBoundingBox");const a=Zo._svgFactory.createElement("use");return i.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),c},U_=new WeakSet,_5=function(e,t){for(const[i,c]of Object.entries(t))c===null?e.removeAttribute(i):e.setAttribute(i,c)},Pe(Zo,LE),Pe(Zo,F_,0);let b5=Zo;globalThis.pdfjsTestingUtils={HighlightOutliner:X4};var tW=Br.AbortException,nW=Br.AnnotationEditorLayer,rW=Br.AnnotationEditorParamsType,iW=Br.AnnotationEditorType,oW=Br.AnnotationEditorUIManager,sW=Br.AnnotationLayer,aW=Br.AnnotationMode,lW=Br.AnnotationType,cW=Br.ColorPicker,uW=Br.DOMSVGFactory,hW=Br.DrawLayer,fW=Br.FeatureTest,dW=Br.GlobalWorkerOptions,pW=Br.ImageKind,mW=Br.InvalidPDFException,gW=Br.MathClamp,yW=Br.OPS,bW=Br.OutputScale,vW=Br.PDFDataRangeTransport,_W=Br.PDFDateString,wW=Br.PDFWorker,xW=Br.PasswordResponses,SW=Br.PermissionFlag,EW=Br.PixelsPerInch,AW=Br.RenderingCancelledException,kW=Br.ResponseException,PW=Br.SignatureExtractor,TW=Br.SupportedImageMimeTypes,OW=Br.TextLayer,MW=Br.TouchManager,CW=Br.Util,IW=Br.VerbosityLevel,RW=Br.XfaLayer,DW=Br.build,LW=Br.createValidAbsoluteUrl,jW=Br.fetchData,NW=Br.getDocument,$W=Br.getFilenameFromUrl,BW=Br.getPdfFilenameFromUrl,FW=Br.getUuid,zW=Br.getXfaPageViewport,UW=Br.isDataScheme,VW=Br.isPdfFile,qW=Br.isValidExplicitDest,HW=Br.noContextMenu,WW=Br.normalizeUnicode,GW=Br.setLayerDimensions,KW=Br.shadow,XW=Br.stopEvent,ZW=Br.version;const YW=Object.freeze(Object.defineProperty({__proto__:null,AbortException:tW,AnnotationEditorLayer:nW,AnnotationEditorParamsType:rW,AnnotationEditorType:iW,AnnotationEditorUIManager:oW,AnnotationLayer:sW,AnnotationMode:aW,AnnotationType:lW,ColorPicker:cW,DOMSVGFactory:uW,DrawLayer:hW,FeatureTest:fW,GlobalWorkerOptions:dW,ImageKind:pW,InvalidPDFException:mW,MathClamp:gW,OPS:yW,OutputScale:bW,PDFDataRangeTransport:vW,PDFDateString:_W,PDFWorker:wW,PasswordResponses:xW,PermissionFlag:SW,PixelsPerInch:EW,RenderingCancelledException:AW,ResponseException:kW,SignatureExtractor:PW,SupportedImageMimeTypes:TW,TextLayer:OW,TouchManager:MW,Util:CW,VerbosityLevel:IW,XfaLayer:RW,build:DW,createValidAbsoluteUrl:LW,fetchData:jW,getDocument:NW,getFilenameFromUrl:$W,getPdfFilenameFromUrl:BW,getUuid:FW,getXfaPageViewport:zW,isDataScheme:UW,isPdfFile:VW,isValidExplicitDest:qW,noContextMenu:HW,normalizeUnicode:WW,setLayerDimensions:GW,shadow:KW,stopEvent:XW,version:ZW},Symbol.toStringTag,{value:"Module"})),JW=GL(YW);(function(n){var e=Wt,t=JW;function i(ke){var Ve=Object.create(null);return ke&&Object.keys(ke).forEach(function(nt){if(nt!=="default"){var ut=Object.getOwnPropertyDescriptor(ke,nt);Object.defineProperty(Ve,nt,ut.get?ut:{enumerable:!0,get:function(){return ke[nt]}})}}),Ve.default=ke,Object.freeze(Ve)}var c,a=i(e),l=i(t);n.AnnotationType=void 0,(c=n.AnnotationType||(n.AnnotationType={}))[c.Text=1]="Text",c[c.Link=2]="Link",c[c.FreeText=3]="FreeText",c[c.Line=4]="Line",c[c.Square=5]="Square",c[c.Circle=6]="Circle",c[c.Polygon=7]="Polygon",c[c.Polyline=8]="Polyline",c[c.Highlight=9]="Highlight",c[c.Underline=10]="Underline",c[c.Squiggly=11]="Squiggly",c[c.StrikeOut=12]="StrikeOut",c[c.Stamp=13]="Stamp",c[c.Caret=14]="Caret",c[c.Ink=15]="Ink",c[c.Popup=16]="Popup",c[c.FileAttachment=17]="FileAttachment";var r=function(ke,Ve){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(nt,ut){nt.__proto__=ut}||function(nt,ut){for(var _t in ut)Object.prototype.hasOwnProperty.call(ut,_t)&&(nt[_t]=ut[_t])},r(ke,Ve)};function h(ke,Ve){if(typeof Ve!="function"&&Ve!==null)throw new TypeError("Class extends value "+String(Ve)+" is not a constructor or null");function nt(){this.constructor=ke}r(ke,Ve),ke.prototype=Ve===null?Object.create(Ve):(nt.prototype=Ve.prototype,new nt)}var m,v=function(){return v=Object.assign||function(ke){for(var Ve,nt=1,ut=arguments.length;nt<ut;nt++)for(var _t in Ve=arguments[nt])Object.prototype.hasOwnProperty.call(Ve,_t)&&(ke[_t]=Ve[_t]);return ke},v.apply(this,arguments)};n.TextDirection=void 0,(m=n.TextDirection||(n.TextDirection={})).RightToLeft="RTL",m.LeftToRight="LTR";var g,_=a.createContext({currentTheme:"light",direction:n.TextDirection.LeftToRight,setCurrentTheme:function(){}}),E=function(ke){var Ve=[];return Object.keys(ke).forEach(function(nt){nt&&ke[nt]&&Ve.push(nt)}),Ve.join(" ")},b=typeof window<"u"?a.useLayoutEffect:a.useEffect,p=function(ke){var Ve=a.useRef(null),nt=ke.once,ut=ke.threshold,_t=ke.onVisibilityChanged;return b(function(){var St=Ve.current;if(St){var Dt=new IntersectionObserver(function(Mt){Mt.forEach(function(pt){var Lt=pt.isIntersecting,Z=pt.intersectionRatio;_t({isVisible:Lt,ratio:Z}),Lt&&nt&&(Dt.unobserve(St),Dt.disconnect())})},{threshold:ut||0});return Dt.observe(St),function(){Dt.unobserve(St),Dt.disconnect()}}},[]),Ve},x=function(ke){var Ve=ke.children,nt=ke.ignoreDirection,ut=nt!==void 0&&nt,_t=ke.size,St=_t===void 0?24:_t,Dt=a.useContext(_).direction,Mt=!ut&&Dt===n.TextDirection.RightToLeft,pt="".concat(St||24,"px");return a.createElement("svg",{"aria-hidden":"true",className:E({"rpv-core__icon":!0,"rpv-core__icon--rtl":Mt}),focusable:"false",height:pt,viewBox:"0 0 24 24",width:pt},Ve)},y=function(){return a.createElement(x,{size:16},a.createElement("path",{d:"M23.5,0.499l-16.5,23l-6.5-6.5"}))},f=function(ke){var Ve=ke.children,nt=ke.testId,ut=ke.onClick,_t=a.useContext(_).direction===n.TextDirection.RightToLeft,St=nt?{"data-testid":nt}:{};return a.createElement("button",v({className:E({"rpv-core__primary-button":!0,"rpv-core__primary-button--rtl":_t}),type:"button",onClick:ut},St),Ve)},w=function(ke){var Ve=ke.size,nt=Ve===void 0?"4rem":Ve,ut=ke.testId,_t=a.useState(!1),St=_t[0],Dt=_t[1],Mt=ut?{"data-testid":ut}:{},pt=p({onVisibilityChanged:function(Lt){Dt(Lt.isVisible)}});return a.createElement("div",v({},Mt,{className:E({"rpv-core__spinner":!0,"rpv-core__spinner--animating":St}),ref:pt,style:{height:nt,width:nt}}))},A=function(ke){var Ve=ke.ariaLabel,nt=Ve===void 0?"":Ve,ut=ke.autoFocus,_t=ut!==void 0&&ut,St=ke.placeholder,Dt=St===void 0?"":St,Mt=ke.testId,pt=ke.type,Lt=pt===void 0?"text":pt,Z=ke.value,q=Z===void 0?"":Z,Ee=ke.onChange,ye=ke.onKeyDown,it=ye===void 0?function(){}:ye,st=a.useContext(_).direction,At=a.useRef(),qt=st===n.TextDirection.RightToLeft,gt={ref:At,"data-testid":"","aria-label":nt,className:E({"rpv-core__textbox":!0,"rpv-core__textbox--rtl":qt}),placeholder:Dt,value:q,onChange:function(Xt){return Ee(Xt.target.value)},onKeyDown:it};return Mt&&(gt["data-testid"]=Mt),b(function(){if(_t){var Xt=At.current;if(Xt){var Vt=window.scrollX,Ot=window.scrollY;Xt.focus(),window.scrollTo(Vt,Ot)}}},[]),Lt==="text"?a.createElement("input",v({type:"text"},gt)):a.createElement("input",v({type:"password"},gt))};(function(ke){ke[ke.ExitFullScreen=0]="ExitFullScreen",ke[ke.FullScreenChange=1]="FullScreenChange",ke[ke.FullScreenElement=2]="FullScreenElement",ke[ke.FullScreenEnabled=3]="FullScreenEnabled",ke[ke.RequestFullScreen=4]="RequestFullScreen"})(g||(g={}));var P,T={ExitFullScreen:"exitFullscreen",FullScreenChange:"fullscreenchange",FullScreenElement:"fullscreenElement",FullScreenEnabled:"fullscreenEnabled",RequestFullScreen:"requestFullscreen"},R={ExitFullScreen:"webkitExitFullscreen",FullScreenChange:"webkitfullscreenchange",FullScreenElement:"webkitFullscreenElement",FullScreenEnabled:"webkitFullscreenEnabled",RequestFullScreen:"webkitRequestFullscreen"},M={ExitFullScreen:"msExitFullscreen",FullScreenChange:"msFullscreenChange",FullScreenElement:"msFullscreenElement",FullScreenEnabled:"msFullscreenEnabled",RequestFullScreen:"msRequestFullscreen"},L=typeof window<"u",W=L&&(g.FullScreenEnabled in document&&T||R.FullScreenEnabled in document&&R||M.FullScreenEnabled in document&&M)||T,G=function(){return L&&W.FullScreenEnabled in document&&document[W.FullScreenEnabled]===!0},re=function(ke){return L?ke[W.ExitFullScreen]():Promise.resolve({})},Q=function(){return L?document[W.FullScreenElement]:null},oe=function(ke,Ve){var nt=a.useRef(),ut=function(){nt.current&&clearTimeout(nt.current)};return a.useEffect(function(){return function(){return ut()}},[]),a.useCallback(function(){for(var _t=[],St=0;St<arguments.length;St++)_t[St]=arguments[St];ut(),nt.current=setTimeout(function(){ke.apply(void 0,_t)},Ve)},[ke,Ve])},ae=function(){var ke=a.useRef(!1);return a.useEffect(function(){return ke.current=!0,function(){ke.current=!1}},[]),ke},de=function(ke){var Ve=a.useRef(ke);return a.useEffect(function(){Ve.current=ke},[ke]),Ve.current};(function(ke){ke.NotRenderedYet="NotRenderedYet",ke.Rendering="Rendering",ke.Rendered="Rendered"})(P||(P={}));var be,pe=-9999,U=function(ke){var Ve=ke.doc,nt=Ve.numPages,ut=Ve.loadingTask.docId,_t=a.useMemo(function(){return Array(nt).fill(null).map(function(Mt,pt){return{pageIndex:pt,renderStatus:P.NotRenderedYet,visibility:pe}})},[ut]),St=a.useRef({currentRenderingPage:-1,startRange:0,endRange:nt-1,visibilities:_t}),Dt=function(Mt,pt){St.current.visibilities[Mt].visibility=pt};return{getHighestPriorityPage:function(){var Mt=St.current.visibilities.slice(St.current.startRange,St.current.endRange+1).filter(function(Ee){return Ee.visibility>pe});if(!Mt.length)return-1;for(var pt=Mt[0].pageIndex,Lt=Mt[Mt.length-1].pageIndex,Z=Mt.length,q=0;q<Z;q++){if(Mt[q].renderStatus===P.Rendering)return-1;if(Mt[q].renderStatus===P.NotRenderedYet)return Mt[q].pageIndex}return Lt+1<nt&&St.current.visibilities[Lt+1].renderStatus!==P.Rendered?Lt+1:pt-1>=0&&St.current.visibilities[pt-1].renderStatus!==P.Rendered?pt-1:-1},isInRange:function(Mt){return Mt>=St.current.startRange&&Mt<=St.current.endRange},markNotRendered:function(){for(var Mt=0;Mt<nt;Mt++)St.current.visibilities[Mt].renderStatus=P.NotRenderedYet},markRendered:function(Mt){St.current.visibilities[Mt].renderStatus=P.Rendered},markRendering:function(Mt){St.current.currentRenderingPage!==-1&&St.current.currentRenderingPage!==Mt&&St.current.visibilities[St.current.currentRenderingPage].renderStatus===P.Rendering&&(St.current.visibilities[St.current.currentRenderingPage].renderStatus=P.NotRenderedYet),St.current.visibilities[Mt].renderStatus=P.Rendering,St.current.currentRenderingPage=Mt},setOutOfRange:function(Mt){Dt(Mt,pe)},setRange:function(Mt,pt){St.current.startRange=Mt,St.current.endRange=pt;for(var Lt=0;Lt<nt;Lt++)(Lt<Mt||Lt>pt)&&(St.current.visibilities[Lt].visibility=pe,St.current.visibilities[Lt].renderStatus=P.NotRenderedYet)},setVisibility:Dt}},B={core:{askingPassword:{requirePasswordToOpen:"This document requires a password to open",submit:"Submit"},wrongPassword:{tryAgain:"The password is wrong. Please try again"},pageLabel:"Page {{pageIndex}}"}},N=a.createContext({l10n:B,setL10n:function(){}}),z=0,H=function(){return z++},Y=function(ke,Ve,nt){var ut=function(_t){var St=Ve.current;if(St){var Dt=_t.target;if(Dt instanceof Element&&Dt.shadowRoot){var Mt=_t.composedPath();Mt.length>0&&!St.contains(Mt[0])&&nt()}else St.contains(Dt)||nt()}};a.useEffect(function(){if(ke){var _t={capture:!0};return document.addEventListener("click",ut,_t),function(){document.removeEventListener("click",ut,_t)}}},[])},fe=function(ke){var Ve=function(nt){nt.key==="Escape"&&ke()};a.useEffect(function(){return document.addEventListener("keyup",Ve),function(){document.removeEventListener("keyup",Ve)}},[])},Re=function(ke){var Ve=ke.ariaControlsSuffix,nt=ke.children,ut=ke.closeOnClickOutside,_t=ke.closeOnEscape,St=ke.onToggle,Dt=a.useRef(),Mt=a.useContext(_).direction===n.TextDirection.RightToLeft;return a.useEffect(function(){var pt=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",function(){document.body.style.overflow=pt}},[]),fe(function(){Dt.current&&_t&&St()}),Y(ut,Dt,St),b(function(){var pt=Dt.current;if(pt){var Lt=.75*document.body.clientHeight;pt.getBoundingClientRect().height>=Lt&&(pt.style.overflow="auto",pt.style.maxHeight="".concat(Lt,"px"))}},[]),a.createElement("div",{"aria-modal":"true",className:E({"rpv-core__modal-body":!0,"rpv-core__modal-body--rtl":Mt}),id:"rpv-core__modal-body-".concat(Ve),ref:Dt,role:"dialog",tabIndex:-1},nt)},Oe=function(ke){var Ve=ke.children;return a.createElement("div",{className:"rpv-core__modal-overlay"},Ve)};n.ToggleStatus=void 0,(be=n.ToggleStatus||(n.ToggleStatus={})).Close="Close",be.Open="Open",be.Toggle="Toggle";var De,ot=function(ke){var Ve=a.useState(ke),nt=Ve[0],ut=Ve[1];return{opened:nt,toggle:function(_t){switch(_t){case n.ToggleStatus.Close:ut(!1);break;case n.ToggleStatus.Open:ut(!0);break;case n.ToggleStatus.Toggle:default:ut(function(St){return!St})}}}},X=function(ke){var Ve=ke.content,nt=ke.isOpened,ut=nt!==void 0&&nt,_t=ke.target,St=ot(ut),Dt=St.opened,Mt=St.toggle;return a.createElement(a.Fragment,null,_t&&_t(Mt,Dt),Dt&&Ve(Mt))};n.Position=void 0,(De=n.Position||(n.Position={})).TopLeft="TOP_LEFT",De.TopCenter="TOP_CENTER",De.TopRight="TOP_RIGHT",De.RightTop="RIGHT_TOP",De.RightCenter="RIGHT_CENTER",De.RightBottom="RIGHT_BOTTOM",De.BottomLeft="BOTTOM_LEFT",De.BottomCenter="BOTTOM_CENTER",De.BottomRight="BOTTOM_RIGHT",De.LeftTop="LEFT_TOP",De.LeftCenter="LEFT_CENTER",De.LeftBottom="LEFT_BOTTOM";var ee,Le,Be,se,_e,te,$e,ge,le=function(ke,Ve,nt,ut,_t){b(function(){var St=Ve.current,Dt=ke.current,Mt=nt.current;if(Dt&&St&&Mt){var pt=Mt.getBoundingClientRect(),Lt=function(Ee,ye,it,st){var At=ye.getBoundingClientRect(),qt=Ee.getBoundingClientRect(),gt=qt.height,Xt=qt.width,Vt=0,Ot=0;switch(it){case n.Position.TopLeft:Vt=At.top-gt,Ot=At.left;break;case n.Position.TopCenter:Vt=At.top-gt,Ot=At.left+At.width/2-Xt/2;break;case n.Position.TopRight:Vt=At.top-gt,Ot=At.left+At.width-Xt;break;case n.Position.RightTop:Vt=At.top,Ot=At.left+At.width;break;case n.Position.RightCenter:Vt=At.top+At.height/2-gt/2,Ot=At.left+At.width;break;case n.Position.RightBottom:Vt=At.top+At.height-gt,Ot=At.left+At.width;break;case n.Position.BottomLeft:Vt=At.top+At.height,Ot=At.left;break;case n.Position.BottomCenter:Vt=At.top+At.height,Ot=At.left+At.width/2-Xt/2;break;case n.Position.BottomRight:Vt=At.top+At.height,Ot=At.left+At.width-Xt;break;case n.Position.LeftTop:Vt=At.top,Ot=At.left-Xt;break;case n.Position.LeftCenter:Vt=At.top+At.height/2-gt/2,Ot=At.left-Xt;break;case n.Position.LeftBottom:Vt=At.top+At.height-gt,Ot=At.left-Xt}return{left:Ot+(st.left||0),top:Vt+(st.top||0)}}(Dt,St,ut,_t),Z=Lt.top,q=Lt.left;Dt.style.top="".concat(Z-pt.top,"px"),Dt.style.left="".concat(q-pt.left,"px")}},[])},ze=function(ke){var Ve,nt=ke.customClassName,ut=ke.position;return a.createElement("div",{className:E((Ve={"rpv-core__arrow":!0,"rpv-core__arrow--tl":ut===n.Position.TopLeft,"rpv-core__arrow--tc":ut===n.Position.TopCenter,"rpv-core__arrow--tr":ut===n.Position.TopRight,"rpv-core__arrow--rt":ut===n.Position.RightTop,"rpv-core__arrow--rc":ut===n.Position.RightCenter,"rpv-core__arrow--rb":ut===n.Position.RightBottom,"rpv-core__arrow--bl":ut===n.Position.BottomLeft,"rpv-core__arrow--bc":ut===n.Position.BottomCenter,"rpv-core__arrow--br":ut===n.Position.BottomRight,"rpv-core__arrow--lt":ut===n.Position.LeftTop,"rpv-core__arrow--lc":ut===n.Position.LeftCenter,"rpv-core__arrow--lb":ut===n.Position.LeftBottom},Ve["".concat(nt)]=nt!=="",Ve))})},Je=function(ke){var Ve=ke.ariaControlsSuffix,nt=ke.children,ut=ke.closeOnClickOutside,_t=ke.offset,St=ke.position,Dt=ke.targetRef,Mt=ke.onClose,pt=a.useRef(),Lt=a.useRef(),Z=a.useRef(),q=a.useContext(_).direction===n.TextDirection.RightToLeft;Y(ut,pt,Mt),le(pt,Dt,Z,St,_t),b(function(){var ye=Lt.current;if(ye){var it=.75*document.body.clientHeight;ye.getBoundingClientRect().height>=it&&(ye.style.overflow="auto",ye.style.maxHeight="".concat(it,"px"))}},[]);var Ee="rpv-core__popover-body-inner-".concat(Ve);return a.createElement(a.Fragment,null,a.createElement("div",{ref:Z,style:{left:0,position:"absolute",top:0}}),a.createElement("div",{"aria-describedby":Ee,className:E({"rpv-core__popover-body":!0,"rpv-core__popover-body--rtl":q}),id:"rpv-core__popover-body-".concat(Ve),ref:pt,role:"dialog",tabIndex:-1},a.createElement(ze,{customClassName:"rpv-core__popover-body-arrow",position:St}),a.createElement("div",{id:Ee,ref:Lt},nt)))},et=function(ke){var Ve=ke.closeOnEscape,nt=ke.onClose,ut=a.useRef();return fe(function(){ut.current&&Ve&&nt()}),a.createElement("div",{className:"rpv-core__popover-overlay",ref:ut})},ft=function(ke){var Ve=ke.ariaControlsSuffix,nt=ke.children,ut=ke.contentRef,_t=ke.offset,St=ke.position,Dt=ke.targetRef,Mt=a.useRef(),pt=a.useContext(_).direction===n.TextDirection.RightToLeft;return le(ut,Dt,Mt,St,_t),a.createElement(a.Fragment,null,a.createElement("div",{ref:Mt,style:{left:0,position:"absolute",top:0}}),a.createElement("div",{className:E({"rpv-core__tooltip-body":!0,"rpv-core__tooltip-body--rtl":pt}),id:"rpv-core__tooltip-body-".concat(Ve),ref:ut,role:"tooltip"},a.createElement(ze,{customClassName:"rpv-core__tooltip-body-arrow",position:St}),a.createElement("div",{className:"rpv-core__tooltip-body-content"},nt)))};n.FullScreenMode=void 0,(ee=n.FullScreenMode||(n.FullScreenMode={})).Normal="Normal",ee.Entering="Entering",ee.Entered="Entered",ee.EnteredCompletely="EnteredCompletely",ee.Exitting="Exitting",ee.Exited="Exited",n.LayerRenderStatus=void 0,(Le=n.LayerRenderStatus||(n.LayerRenderStatus={}))[Le.PreRender=0]="PreRender",Le[Le.DidRender=1]="DidRender",n.PageMode=void 0,(Be=n.PageMode||(n.PageMode={})).Attachments="UseAttachments",Be.Bookmarks="UseOutlines",Be.ContentGroup="UseOC",Be.Default="UserNone",Be.FullScreen="FullScreen",Be.Thumbnails="UseThumbs",n.PasswordStatus=void 0,(se=n.PasswordStatus||(n.PasswordStatus={})).RequiredPassword="RequiredPassword",se.WrongPassword="WrongPassword",n.RotateDirection=void 0,(_e=n.RotateDirection||(n.RotateDirection={})).Backward="Backward",_e.Forward="Forward",n.ScrollMode=void 0,(te=n.ScrollMode||(n.ScrollMode={})).Page="Page",te.Horizontal="Horizontal",te.Vertical="Vertical",te.Wrapped="Wrapped",n.SpecialZoomLevel=void 0,($e=n.SpecialZoomLevel||(n.SpecialZoomLevel={})).ActualSize="ActualSize",$e.PageFit="PageFit",$e.PageWidth="PageWidth",n.ViewMode=void 0,(ge=n.ViewMode||(n.ViewMode={})).DualPage="DualPage",ge.DualPageWithCover="DualPageWithCover",ge.SinglePage="SinglePage";var wt,It=function(ke,Ve){return ke.reduce(function(nt,ut,_t){return _t%Ve?nt[nt.length-1].push(ut):nt.push([ut]),nt},[])},Ct=function(ke,Ve){switch(Ve[1].name){case"XYZ":return{bottomOffset:function(nt,ut){return Ve[3]===null?ut:Ve[3]},leftOffset:function(nt,ut){return Ve[2]===null?0:Ve[2]},pageIndex:ke,scaleTo:Ve[4]};case"Fit":case"FitB":return{bottomOffset:0,leftOffset:0,pageIndex:ke,scaleTo:n.SpecialZoomLevel.PageFit};case"FitH":case"FitBH":return{bottomOffset:Ve[2],leftOffset:0,pageIndex:ke,scaleTo:n.SpecialZoomLevel.PageWidth};default:return{bottomOffset:0,leftOffset:0,pageIndex:ke,scaleTo:1}}},tn=new Map,xt=new Map,Ht=function(ke,Ve){return"".concat(ke.loadingTask.docId,"___").concat(Ve.num,"R").concat(Ve.gen===0?"":Ve.gen)},en=function(ke,Ve,nt){tn.set(Ht(ke,Ve),nt)},kn=function(ke,Ve){if(!ke)return Promise.reject("The document is not loaded yet");var nt="".concat(ke.loadingTask.docId,"___").concat(Ve),ut=xt.get(nt);return ut?Promise.resolve(ut):new Promise(function(_t,St){ke.getPage(Ve+1).then(function(Dt){xt.set(nt,Dt),Dt.ref&&en(ke,Dt.ref,Ve),_t(Dt)})})},Dn=function(ke,Ve){return new Promise(function(nt){new Promise(function(ut){typeof Ve=="string"?ke.getDestination(Ve).then(function(_t){ut(_t)}):ut(Ve)}).then(function(ut){if(typeof ut[0]=="object"&&ut[0]!==null){var _t=ut[0],St=function(Mt,pt){var Lt=Ht(Mt,pt);return tn.has(Lt)?tn.get(Lt):null}(ke,_t);St===null?ke.getPageIndex(_t).then(function(Mt){en(ke,_t,Mt),Dn(ke,Ve).then(function(pt){return nt(pt)})}):nt(Ct(St,ut))}else{var Dt=Ct(ut[0],ut);nt(Dt)}})})};(function(ke){ke[ke.Solid=1]="Solid",ke[ke.Dashed=2]="Dashed",ke[ke.Beveled=3]="Beveled",ke[ke.Inset=4]="Inset",ke[ke.Underline=5]="Underline"})(wt||(wt={}));var Ft,Tt=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),rn=function(ke,Ve,nt,ut){var _t=parseInt(ke,10);return _t>=Ve&&_t<=nt?_t:ut},dt=function(ke){return ke.contentsObj?ke.contentsObj.str:ke.contents||""},qn=function(ke){return ke.titleObj?ke.titleObj.str:ke.title||""},fn=function(ke){var Ve=ke.annotation,nt=a.useContext(_).direction,ut=qn(Ve),_t=dt(Ve),St=nt===n.TextDirection.RightToLeft,Dt=a.useRef(),Mt="";if(Ve.modificationDate){var pt=function(Lt){var Z=Tt.exec(Lt);if(!Z)return null;var q=parseInt(Z[1],10),Ee=rn(Z[2],1,12,1)-1,ye=rn(Z[3],1,31,1),it=rn(Z[4],0,23,0),st=rn(Z[5],0,59,0),At=rn(Z[6],0,59,0),qt=Z[7]||"Z",gt=rn(Z[8],0,23,0),Xt=rn(Z[9],0,59,0);switch(qt){case"-":it+=gt,st+=Xt;break;case"+":it-=gt,st-=Xt}return new Date(Date.UTC(q,Ee,ye,it,st,At))}(Ve.modificationDate);Mt=pt?"".concat(pt.toLocaleDateString(),", ").concat(pt.toLocaleTimeString()):""}return a.useLayoutEffect(function(){if(Dt.current){var Lt=document.querySelector('[data-annotation-id="'.concat(Ve.id,'"]'));if(Lt){var Z=Lt;return Z.style.zIndex+=1,function(){Z.style.zIndex="".concat(parseInt(Z.style.zIndex,10)-1)}}}},[]),a.createElement("div",{ref:Dt,className:E({"rpv-core__annotation-popup-wrapper":!0,"rpv-core__annotation-popup-wrapper--rtl":St}),style:{top:Ve.annotationType===n.AnnotationType.Popup?"":"100%"}},ut&&a.createElement(a.Fragment,null,a.createElement("div",{className:E({"rpv-core__annotation-popup-title":!0,"rpv-core__annotation-popup-title--ltr":!St,"rpv-core__annotation-popup-title--rtl":St})},ut),a.createElement("div",{className:"rpv-core__annotation-popup-date"},Mt)),_t&&a.createElement("div",{className:"rpv-core__annotation-popup-content"},_t.split(`
`).map(function(Lt,Z){return a.createElement(a.Fragment,{key:Z},Lt,a.createElement("br",null))})))};(function(ke){ke.Click="Click",ke.Hover="Hover"})(Ft||(Ft={}));var dr,Xn=function(ke){var Ve,nt=ke.annotation,ut=ke.children,_t=ke.ignoreBorder,St=ke.hasPopup,Dt=ke.isRenderable,Mt=ke.page,pt=ke.viewport,Lt=nt.rect,Z=function(){var an=ot(!1),pn=an.opened,Ln=an.toggle,or=a.useState(Ft.Hover),gr=or[0],nr=or[1];return{opened:pn,closeOnHover:function(){gr===Ft.Hover&&Ln(n.ToggleStatus.Close)},openOnHover:function(){gr===Ft.Hover&&Ln(n.ToggleStatus.Open)},toggleOnClick:function(){switch(gr){case Ft.Click:pn&&nr(Ft.Hover),Ln(n.ToggleStatus.Toggle);break;case Ft.Hover:nr(Ft.Click),Ln(n.ToggleStatus.Open)}}}}(),q=Z.closeOnHover,Ee=Z.opened,ye=Z.openOnHover,it=Z.toggleOnClick,st=(Ve=[Lt[0],Mt.view[3]+Mt.view[1]-Lt[1],Lt[2],Mt.view[3]+Mt.view[1]-Lt[3]],[Math.min(Ve[0],Ve[2]),Math.min(Ve[1],Ve[3]),Math.max(Ve[0],Ve[2]),Math.max(Ve[1],Ve[3])]),At=Lt[2]-Lt[0],qt=Lt[3]-Lt[1],gt={borderColor:"",borderRadius:"",borderStyle:"",borderWidth:""};if(!_t&&nt.borderStyle.width>0){switch(nt.borderStyle.style){case wt.Dashed:gt.borderStyle="dashed";break;case wt.Solid:gt.borderStyle="solid";break;case wt.Underline:gt=Object.assign({borderBottomStyle:"solid"},gt);case wt.Beveled:case wt.Inset:}var Xt=nt.borderStyle.width;gt.borderWidth="".concat(Xt,"px"),nt.borderStyle.style!==wt.Underline&&(At-=2*Xt,qt-=2*Xt);var Vt=nt.borderStyle,Ot=Vt.horizontalCornerRadius,Ut=Vt.verticalCornerRadius;(Ot>0||Ut>0)&&(gt.borderRadius="".concat(Ot,"px / ").concat(Ut,"px")),nt.color?gt.borderColor="rgb(".concat(0|nt.color[0],", ").concat(0|nt.color[1],", ").concat(0|nt.color[2],")"):gt.borderWidth="0"}return a.createElement(a.Fragment,null,Dt&&ut({popup:{opened:Ee,closeOnHover:q,openOnHover:ye,toggleOnClick:it},slot:{attrs:{style:Object.assign({height:"".concat(qt,"px"),left:"".concat(st[0],"px"),top:"".concat(st[1],"px"),transform:"matrix(".concat(pt.transform.join(","),")"),transformOrigin:"-".concat(st[0],"px -").concat(st[1],"px"),width:"".concat(At,"px")},gt)},children:a.createElement(a.Fragment,null,St&&Ee&&a.createElement(fn,{annotation:nt}))}}))},Ir=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt);return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(pt){return a.createElement("div",v({},pt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--caret","data-annotation-id":Ve.id,onClick:pt.popup.toggleOnClick,onMouseEnter:pt.popup.openOnHover,onMouseLeave:pt.popup.closeOnHover}),pt.slot.children)})},Ae=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt),pt=Ve.rect,Lt=pt[2]-pt[0],Z=pt[3]-pt[1],q=Ve.borderStyle.width;return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(Ee){return a.createElement("div",v({},Ee.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--circle","data-annotation-id":Ve.id,onClick:Ee.popup.toggleOnClick,onMouseEnter:Ee.popup.openOnHover,onMouseLeave:Ee.popup.closeOnHover}),a.createElement("svg",{height:"".concat(Z,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(Lt," ").concat(Z),width:"".concat(Lt,"px")},a.createElement("circle",{cy:Z/2,fill:"none",rx:Lt/2-q/2,ry:Z/2-q/2,stroke:"transparent",strokeWidth:q||1})),Ee.slot.children)})},ve=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=qn(Ve),St=dt(Ve),Dt=!(Ve.hasPopup!==!1||!_t&&!St),Mt=function(){var pt,Lt,Z,q,Ee=Ve.file;Ee&&(pt=Ee.filename,Lt=Ee.content,Z=typeof Lt=="string"?"":URL.createObjectURL(new Blob([Lt],{type:""})),(q=document.createElement("a")).style.display="none",q.href=Z||pt,q.setAttribute("download",function(ye){var it=ye.split("/").pop();return it?it.split("#")[0].split("?")[0]:ye}(pt)),document.body.appendChild(q),q.click(),document.body.removeChild(q),Z&&URL.revokeObjectURL(Z))};return a.createElement(Xn,{annotation:Ve,hasPopup:Dt,ignoreBorder:!0,isRenderable:!0,page:nt,viewport:ut},function(pt){return a.createElement("div",v({},pt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--file-attachment","data-annotation-id":Ve.id,onClick:pt.popup.toggleOnClick,onDoubleClick:Mt,onMouseEnter:pt.popup.openOnHover,onMouseLeave:pt.popup.closeOnHover}),pt.slot.children)})},he=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt);return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(pt){return a.createElement("div",v({},pt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--free-text","data-annotation-id":Ve.id,onClick:pt.popup.toggleOnClick,onMouseEnter:pt.popup.openOnHover,onMouseLeave:pt.popup.closeOnHover}),pt.slot.children)})},me=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=qn(Ve),St=dt(Ve),Dt=!(!_t&&!St),Mt=!Ve.parentType||["Circle","Ink","Line","Polygon","PolyLine","Square"].indexOf(Ve.parentType)!==-1;return b(function(){if(Ve.parentId){var pt=document.querySelector('[data-annotation-id="'.concat(Ve.parentId,'"]')),Lt=document.querySelector('[data-annotation-id="'.concat(Ve.id,'"]'));if(pt&&Lt){var Z=parseFloat(pt.style.left),q=parseFloat(pt.style.top)+parseFloat(pt.style.height);Lt.style.left="".concat(Z,"px"),Lt.style.top="".concat(q,"px"),Lt.style.transformOrigin="-".concat(Z,"px -").concat(q,"px")}}},[]),a.createElement(Xn,{annotation:Ve,hasPopup:Mt,ignoreBorder:!1,isRenderable:Dt,page:nt,viewport:ut},function(pt){return a.createElement("div",v({},pt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--popup","data-annotation-id":Ve.id}),a.createElement(fn,{annotation:Ve}))})},we=function(ke){var Ve=ke.annotation,nt=ke.childAnnotation,ut=ke.page,_t=ke.viewport,St=Ve.hasPopup===!1,Dt=qn(Ve),Mt=dt(Ve),pt=!!(Ve.hasPopup||Dt||Mt);if(Ve.quadPoints&&Ve.quadPoints.length>0){var Lt=Ve.quadPoints.map(function(Z){return Object.assign({},Ve,{rect:[Z[2].x,Z[2].y,Z[1].x,Z[1].y],quadPoints:[]})});return a.createElement(a.Fragment,null,Lt.map(function(Z,q){return a.createElement(we,{key:q,annotation:Z,childAnnotation:nt,page:ut,viewport:_t})}))}return a.createElement(Xn,{annotation:Ve,hasPopup:St,ignoreBorder:!0,isRenderable:pt,page:ut,viewport:_t},function(Z){return a.createElement(a.Fragment,null,a.createElement("div",v({},Z.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--highlight","data-annotation-id":Ve.id,onClick:Z.popup.toggleOnClick,onMouseEnter:Z.popup.openOnHover,onMouseLeave:Z.popup.closeOnHover}),Z.slot.children),nt&&nt.annotationType===n.AnnotationType.Popup&&Z.popup.opened&&a.createElement(me,{annotation:nt,page:ut,viewport:_t}))})},je=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt),pt=Ve.rect,Lt=pt[2]-pt[0],Z=pt[3]-pt[1],q=Ve.borderStyle.width;return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(Ee){return a.createElement("div",v({},Ee.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--ink","data-annotation-id":Ve.id,onClick:Ee.popup.toggleOnClick,onMouseEnter:Ee.popup.openOnHover,onMouseLeave:Ee.popup.closeOnHover}),Ve.inkLists&&Ve.inkLists.length&&a.createElement("svg",{height:"".concat(Z,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(Lt," ").concat(Z),width:"".concat(Lt,"px")},Ve.inkLists.map(function(ye,it){return a.createElement("polyline",{key:it,fill:"none",stroke:"transparent",strokeWidth:q||1,points:ye.map(function(st){return"".concat(st.x-pt[0],",").concat(pt[3]-st.y)}).join(" ")})})),Ee.slot.children)})},qe=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt),pt=Ve.rect,Lt=pt[2]-pt[0],Z=pt[3]-pt[1],q=Ve.borderStyle.width;return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(Ee){return a.createElement("div",v({},Ee.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--line","data-annotation-id":Ve.id,onClick:Ee.popup.toggleOnClick,onMouseEnter:Ee.popup.openOnHover,onMouseLeave:Ee.popup.closeOnHover}),a.createElement("svg",{height:"".concat(Z,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(Lt," ").concat(Z),width:"".concat(Lt,"px")},a.createElement("line",{stroke:"transparent",strokeWidth:q||1,x1:pt[2]-Ve.lineCoordinates[0],x2:pt[2]-Ve.lineCoordinates[2],y1:pt[3]-Ve.lineCoordinates[1],y2:pt[3]-Ve.lineCoordinates[3]})),Ee.slot.children)})},Fe=/^([^\w]*)(javascript|data|vbscript)/im,Xe=/&#(\w+)(^\w|;)?/g,Ge=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,rt=/^([^:]+):/gm,bt=function(ke,Ve){Ve===void 0&&(Ve="about:blank");var nt,ut=(nt=ke||"",nt.replace(Xe,function(Mt,pt){return String.fromCharCode(pt)})).replace(Ge,"").trim();if(!ut)return Ve;var _t=ut[0];if(_t==="."||_t==="/")return ut;var St=ut.match(rt);if(!St)return ut;var Dt=St[0];return Fe.test(Dt)?Ve:ut},at=function(ke){var Ve,nt=ke.annotation,ut=ke.annotationContainerRef,_t=ke.doc,St=ke.outlines,Dt=ke.page,Mt=ke.pageIndex,pt=ke.scale,Lt=ke.viewport,Z=ke.onExecuteNamedAction,q=ke.onJumpFromLinkAnnotation,Ee=ke.onJumpToDest,ye=a.useRef(),it=St&&St.length&&nt.dest&&typeof nt.dest=="string"?(Ve=St.find(function(gt){return gt.dest===nt.dest}))===null||Ve===void 0?void 0:Ve.title:"",st=!!(nt.url||nt.dest||nt.action||nt.unsafeUrl),At={};if(nt.url||nt.unsafeUrl){var qt=bt(nt.url||nt.unsafeUrl,"");qt?At={"data-target":"external",href:qt,rel:"noopener noreferrer nofollow",target:nt.newWindow?"_blank":"",title:qt}:st=!1}else At={href:"","data-annotation-link":nt.id,onClick:function(gt){gt.preventDefault(),nt.action?Z(nt.action):Dn(_t,nt.dest).then(function(Xt){var Vt=ye.current,Ot=ut.current;if(Vt&&Ot){var Ut=Vt.getBoundingClientRect();Ot.style.setProperty("height","100%"),Ot.style.setProperty("width","100%");var an=Ot.getBoundingClientRect();Ot.style.removeProperty("height"),Ot.style.removeProperty("width");var pn=(Ut.left-an.left)/pt,Ln=(an.bottom-Ut.bottom+Ut.height)/pt;q({bottomOffset:Ln,label:it,leftOffset:pn,pageIndex:Mt})}Ee(Xt)})}};return it&&(At=Object.assign({},At,{title:it,"aria-label":it})),a.createElement(Xn,{annotation:nt,hasPopup:!1,ignoreBorder:!1,isRenderable:st,page:Dt,viewport:Lt},function(gt){return a.createElement("div",v({},gt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--link","data-annotation-id":nt.id,"data-testid":"core__annotation--link-".concat(nt.id)}),a.createElement("a",v({ref:ye},At)))})},Et=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt),pt=Ve.rect,Lt=pt[2]-pt[0],Z=pt[3]-pt[1],q=Ve.borderStyle.width;return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(Ee){return a.createElement("div",v({},Ee.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polygon","data-annotation-id":Ve.id,onClick:Ee.popup.toggleOnClick,onMouseEnter:Ee.popup.openOnHover,onMouseLeave:Ee.popup.closeOnHover}),Ve.vertices&&Ve.vertices.length&&a.createElement("svg",{height:"".concat(Z,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(Lt," ").concat(Z),width:"".concat(Lt,"px")},a.createElement("polygon",{fill:"none",stroke:"transparent",strokeWidth:q||1,points:Ve.vertices.map(function(ye){return"".concat(ye.x-pt[0],",").concat(pt[3]-ye.y)}).join(" ")})),Ee.slot.children)})},jt=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt),pt=Ve.rect,Lt=pt[2]-pt[0],Z=pt[3]-pt[1],q=Ve.borderStyle.width;return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(Ee){return a.createElement("div",v({},Ee.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polyline","data-annotation-id":Ve.id,onClick:Ee.popup.toggleOnClick,onMouseEnter:Ee.popup.openOnHover,onMouseLeave:Ee.popup.closeOnHover}),Ve.vertices&&Ve.vertices.length&&a.createElement("svg",{height:"".concat(Z,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(Lt," ").concat(Z),width:"".concat(Lt,"px")},a.createElement("polyline",{fill:"none",stroke:"transparent",strokeWidth:q||1,points:Ve.vertices.map(function(ye){return"".concat(ye.x-pt[0],",").concat(pt[3]-ye.y)}).join(" ")})),Ee.slot.children)})},Kt=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt),pt=Ve.rect,Lt=pt[2]-pt[0],Z=pt[3]-pt[1],q=Ve.borderStyle.width;return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(Ee){return a.createElement("div",v({},Ee.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--square","data-annotation-id":Ve.id,onClick:Ee.popup.toggleOnClick,onMouseEnter:Ee.popup.openOnHover,onMouseLeave:Ee.popup.closeOnHover}),a.createElement("svg",{height:"".concat(Z,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(Lt," ").concat(Z),width:"".concat(Lt,"px")},a.createElement("rect",{height:Z-q,fill:"none",stroke:"transparent",strokeWidth:q||1,x:q/2,y:q/2,width:Lt-q})),Ee.slot.children)})},Yt=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt);return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(pt){return a.createElement("div",v({},pt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--squiggly","data-annotation-id":Ve.id,onClick:pt.popup.toggleOnClick,onMouseEnter:pt.popup.openOnHover,onMouseLeave:pt.popup.closeOnHover}),pt.slot.children)})},Zt=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt);return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(pt){return a.createElement("div",v({},pt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--stamp","data-annotation-id":Ve.id,onClick:pt.popup.toggleOnClick,onMouseEnter:pt.popup.openOnHover,onMouseLeave:pt.popup.closeOnHover}),pt.slot.children)})},Jt=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt);return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(pt){return a.createElement("div",v({},pt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--strike-out","data-annotation-id":Ve.id,onClick:pt.popup.toggleOnClick,onMouseEnter:pt.popup.openOnHover,onMouseLeave:pt.popup.closeOnHover}),pt.slot.children)})},ln=function(){return a.createElement(x,{size:16},a.createElement("path",{d:"M.5,16.5a1,1,0,0,0,1,1h2v4l4-4h15a1,1,0,0,0,1-1V3.5a1,1,0,0,0-1-1H1.5a1,1,0,0,0-1,1Z"}),a.createElement("path",{d:"M7.25,9.75A.25.25,0,1,1,7,10a.25.25,0,0,1,.25-.25"}),a.createElement("path",{d:"M12,9.75a.25.25,0,1,1-.25.25A.25.25,0,0,1,12,9.75"}),a.createElement("path",{d:"M16.75,9.75a.25.25,0,1,1-.25.25.25.25,0,0,1,.25-.25"}))},vn=function(){return a.createElement(x,{size:16},a.createElement("path",{d:"M0.500 12.001 A11.500 11.500 0 1 0 23.500 12.001 A11.500 11.500 0 1 0 0.500 12.001 Z"}),a.createElement("path",{d:"M6.000 12.001 A6.000 6.000 0 1 0 18.000 12.001 A6.000 6.000 0 1 0 6.000 12.001 Z"}),a.createElement("path",{d:"M21.423 5.406L17.415 9.414"}),a.createElement("path",{d:"M14.587 6.585L18.607 2.565"}),a.createElement("path",{d:"M5.405 21.424L9.413 17.416"}),a.createElement("path",{d:"M6.585 14.588L2.577 18.596"}),a.createElement("path",{d:"M18.602 21.419L14.595 17.412"}),a.createElement("path",{d:"M17.419 14.58L21.428 18.589"}),a.createElement("path",{d:"M2.582 5.399L6.588 9.406"}),a.createElement("path",{d:"M9.421 6.581L5.412 2.572"}))},wn=function(){return a.createElement(x,{size:16},a.createElement("path",{d:"M4.000 18.500 A1.500 1.500 0 1 0 7.000 18.500 A1.500 1.500 0 1 0 4.000 18.500 Z"}),a.createElement("path",{d:"M20.5.5l-9.782,9.783a7,7,0,1,0,3,3L17,10h1.5V8.5L19,8h1.5V6.5L21,6h1.5V4.5l1-1V.5Z"}))},cn=function(){return a.createElement(x,{size:16},a.createElement("path",{d:"M2.000 2.500 L22.000 2.500 L22.000 23.500 L2.000 23.500 Z"}),a.createElement("path",{d:"M6 4.5L6 0.5"}),a.createElement("path",{d:"M18 4.5L18 0.5"}),a.createElement("path",{d:"M10 4.5L10 0.5"}),a.createElement("path",{d:"M14 4.5L14 0.5"}))},xn=function(){return a.createElement(x,{size:16},a.createElement("path",{d:"M17.5 0.498L17.5 23.498"}),a.createElement("path",{d:"M10.5 0.498L10.5 23.498"}),a.createElement("path",{d:"M23.5.5H6.5a6,6,0,0,0,0,12h4"}))},cr=function(){return a.createElement(x,{size:16},a.createElement("path",{d:"M2.5 22.995L12 6.005 21.5 22.995 2.5 22.995z"}))},br=function(ke){var Ve=ke.annotation,nt=ke.childAnnotation,ut=ke.page,_t=ke.viewport,St=Ve.hasPopup===!1,Dt=qn(Ve),Mt=dt(Ve),pt=!!(Ve.hasPopup||Dt||Mt),Lt=Ve.name?Ve.name.toLowerCase():"";return a.createElement(Xn,{annotation:Ve,hasPopup:St,ignoreBorder:!1,isRenderable:pt,page:ut,viewport:_t},function(Z){return a.createElement(a.Fragment,null,a.createElement("div",v({},Z.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--text","data-annotation-id":Ve.id,onClick:Z.popup.toggleOnClick,onMouseEnter:Z.popup.openOnHover,onMouseLeave:Z.popup.closeOnHover}),Lt&&a.createElement("div",{className:"rpv-core__annotation-text-icon"},Lt==="check"&&a.createElement(y,null),Lt==="comment"&&a.createElement(ln,null),Lt==="help"&&a.createElement(vn,null),Lt==="insert"&&a.createElement(cr,null),Lt==="key"&&a.createElement(wn,null),Lt==="note"&&a.createElement(cn,null),(Lt==="newparagraph"||Lt==="paragraph")&&a.createElement(xn,null)),Z.slot.children),nt&&nt.annotationType===n.AnnotationType.Popup&&Z.popup.opened&&a.createElement(me,{annotation:nt,page:ut,viewport:_t}))})},hr=function(ke){var Ve=ke.annotation,nt=ke.page,ut=ke.viewport,_t=Ve.hasPopup===!1,St=qn(Ve),Dt=dt(Ve),Mt=!!(Ve.hasPopup||St||Dt);return a.createElement(Xn,{annotation:Ve,hasPopup:_t,ignoreBorder:!0,isRenderable:Mt,page:nt,viewport:ut},function(pt){return a.createElement("div",v({},pt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--underline","data-annotation-id":Ve.id,onClick:pt.popup.toggleOnClick,onMouseEnter:pt.popup.openOnHover,onMouseLeave:pt.popup.closeOnHover}),pt.slot.children)})},pr=function(ke){var Ve=ke.annotations,nt=ke.doc,ut=ke.outlines,_t=ke.page,St=ke.pageIndex,Dt=ke.plugins,Mt=ke.rotation,pt=ke.scale,Lt=ke.onExecuteNamedAction,Z=ke.onJumpFromLinkAnnotation,q=ke.onJumpToDest,Ee=a.useRef(),ye=_t.getViewport({rotation:Mt,scale:pt}).clone({dontFlip:!0}),it=Ve.filter(function(st){return!st.parentId});return b(function(){var st=Ee.current;st&&Dt.forEach(function(At){At.onAnnotationLayerRender&&At.onAnnotationLayerRender({annotations:it,container:st,pageIndex:St,rotation:Mt,scale:pt})})},[]),a.createElement("div",{ref:Ee,className:"rpv-core__annotation-layer","data-testid":"core__annotation-layer-".concat(St)},it.map(function(st){var At=Ve.find(function(qt){return qt.parentId===st.id});switch(st.annotationType){case n.AnnotationType.Caret:return a.createElement(Ir,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Circle:return a.createElement(Ae,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.FileAttachment:return a.createElement(ve,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.FreeText:return a.createElement(he,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Highlight:return a.createElement(we,{key:st.id,annotation:st,childAnnotation:At,page:_t,viewport:ye});case n.AnnotationType.Ink:return a.createElement(je,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Line:return a.createElement(qe,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Link:return a.createElement(at,{key:st.id,annotation:st,annotationContainerRef:Ee,doc:nt,outlines:ut,page:_t,pageIndex:St,scale:pt,viewport:ye,onExecuteNamedAction:Lt,onJumpFromLinkAnnotation:Z,onJumpToDest:q});case n.AnnotationType.Polygon:return a.createElement(Et,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Polyline:return a.createElement(jt,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Popup:return a.createElement(me,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Square:return a.createElement(Kt,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Squiggly:return a.createElement(Yt,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Stamp:return a.createElement(Zt,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.StrikeOut:return a.createElement(Jt,{key:st.id,annotation:st,page:_t,viewport:ye});case n.AnnotationType.Text:return a.createElement(br,{key:st.id,annotation:st,childAnnotation:At,page:_t,viewport:ye});case n.AnnotationType.Underline:return a.createElement(hr,{key:st.id,annotation:st,page:_t,viewport:ye});default:return a.createElement(a.Fragment,{key:st.id})}}))},Kr=function(ke){var Ve=ke.page,nt=ke.renderAnnotations,ut=ae(),_t=a.useState({loading:!0,annotations:[]}),St=_t[0],Dt=_t[1];return a.useEffect(function(){Ve.getAnnotations({intent:"display"}).then(function(Mt){ut.current&&Dt({loading:!1,annotations:Mt})})},[]),St.loading?a.createElement(a.Fragment,null):nt(St.annotations)},mn=function(ke){var Ve=ke.doc,nt=ke.outlines,ut=ke.page,_t=ke.pageIndex,St=ke.plugins,Dt=ke.rotation,Mt=ke.scale,pt=ke.onExecuteNamedAction,Lt=ke.onJumpFromLinkAnnotation,Z=ke.onJumpToDest;return a.createElement(Kr,{page:ut,renderAnnotations:function(q){return a.createElement(pr,{annotations:q,doc:Ve,outlines:nt,page:ut,pageIndex:_t,plugins:St,rotation:Dt,scale:Mt,onExecuteNamedAction:pt,onJumpFromLinkAnnotation:Lt,onJumpToDest:Z})}})},oi=function(ke,Ve){var nt=ke%Ve;return nt===0?ke:Math.floor(ke-nt)},eo=function(ke){var Ve=ke.canvasLayerRef,nt=ke.height,ut=ke.page,_t=ke.pageIndex,St=ke.plugins,Dt=ke.rotation,Mt=ke.scale,pt=ke.width,Lt=ke.onRenderCanvasCompleted,Z=a.useRef();return b(function(){var q=Z.current;q&&q.cancel();var Ee=Ve.current;Ee.removeAttribute("data-testid"),St.forEach(function(an){an.onCanvasLayerRender&&an.onCanvasLayerRender({ele:Ee,pageIndex:_t,rotation:Dt,scale:Mt,status:n.LayerRenderStatus.PreRender})});var ye=ut.getViewport({rotation:Dt,scale:Mt}),it=window.devicePixelRatio||1,st=Math.sqrt(16777216/(ye.width*ye.height)),At=it>st;At?Ee.style.transform="scale(1, 1)":Ee.style.removeProperty("transform");var qt=Math.min(st,it),gt=function(an,pn){var Ln,or;if(Math.floor(an)===an)return[an,1];var gr=1/an;if(gr>pn)return[1,pn];if(Math.floor(gr)===gr)return[1,gr];for(var nr=an>1?gr:an,wr=0,jn=1,yi=1,Qn=1;;){var In=wr+yi,Wr=jn+Qn;if(Wr>pn)break;nr<=In/Wr?(yi=(Ln=[In,Wr])[0],Qn=Ln[1]):(wr=(or=[In,Wr])[0],jn=or[1])}return nr<(wr/jn+yi/Qn)/2?nr===an?[wr,jn]:[jn,wr]:nr===an?[yi,Qn]:[Qn,yi]}(qt,8),Xt=gt[0],Vt=gt[1];Ee.width=oi(ye.width*qt,Xt),Ee.height=oi(ye.height*qt,Xt),Ee.style.width="".concat(oi(ye.width,Vt),"px"),Ee.style.height="".concat(oi(ye.height,Vt),"px"),Ee.hidden=!0;var Ot=Ee.getContext("2d",{alpha:!1}),Ut=At||it!==1?[qt,0,0,qt,0,0]:null;return Z.current=ut.render({canvasContext:Ot,transform:Ut,viewport:ye}),Z.current.promise.then(function(){Ee.hidden=!1,Ee.setAttribute("data-testid","core__canvas-layer-".concat(_t)),St.forEach(function(an){an.onCanvasLayerRender&&an.onCanvasLayerRender({ele:Ee,pageIndex:_t,rotation:Dt,scale:Mt,status:n.LayerRenderStatus.DidRender})}),Lt()},function(){Lt()}),function(){Ee&&(Ee.width=0,Ee.height=0)}},[]),a.createElement("div",{className:"rpv-core__canvas-layer",style:{height:"".concat(nt,"px"),width:"".concat(pt,"px")}},a.createElement("canvas",{ref:Ve}))},nn=function(ke){var Ve=ke.height,nt=ke.page,ut=ke.rotation,_t=ke.scale,St=ke.width,Dt=a.useRef();return b(function(){var Mt=Dt.current,pt=nt.getViewport({rotation:ut,scale:_t});nt.getOperatorList().then(function(Lt){(function(){var Z=Dt.current;Z&&(Z.innerHTML="")})(),new l.SVGGraphics(nt.commonObjs,nt.objs).getSVG(Lt,pt).then(function(Z){Z.style.height="".concat(Ve,"px"),Z.style.width="".concat(St,"px"),Mt.appendChild(Z)})})},[]),a.createElement("div",{className:"rpv-core__svg-layer",ref:Dt})},on=function(ke){var Ve=ke.containerRef,nt=ke.page,ut=ke.pageIndex,_t=ke.plugins,St=ke.rotation,Dt=ke.scale,Mt=ke.onRenderTextCompleted,pt=a.useRef(),Lt=function(){var Z=Ve.current;Z&&([].slice.call(Z.querySelectorAll(".rpv-core__text-layer-text")).forEach(function(q){return Z.removeChild(q)}),[].slice.call(Z.querySelectorAll('br[role="presentation"]')).forEach(function(q){return Z.removeChild(q)}))};return b(function(){var Z=pt.current;Z&&Z.cancel();var q=Ve.current;if(q){q.removeAttribute("data-testid");var Ee=nt.getViewport({rotation:St,scale:Dt});return _t.forEach(function(ye){ye.onTextLayerRender&&ye.onTextLayerRender({ele:q,pageIndex:ut,scale:Dt,status:n.LayerRenderStatus.PreRender})}),nt.getTextContent().then(function(ye){Lt(),pt.current=l.renderTextLayer({container:q,textContent:ye,textContentSource:ye,viewport:Ee}),pt.current.promise.then(function(){q.setAttribute("data-testid","core__text-layer-".concat(ut)),[].slice.call(q.children).forEach(function(it){it.classList.contains("rpv-core__text-layer-text--not")||it.classList.add("rpv-core__text-layer-text")}),_t.forEach(function(it){it.onTextLayerRender&&it.onTextLayerRender({ele:q,pageIndex:ut,scale:Dt,status:n.LayerRenderStatus.DidRender})}),Mt()},function(){q.removeAttribute("data-testid"),Mt()})}),function(){var ye;Lt(),(ye=pt.current)===null||ye===void 0||ye.cancel()}}},[]),a.createElement("div",{className:"rpv-core__text-layer",ref:Ve})},bn=function(ke){var Ve=ke.doc,nt=ke.measureRef,ut=ke.outlines,_t=ke.pageIndex,St=ke.pageRotation,Dt=ke.pageSize,Mt=ke.plugins,pt=ke.renderPage,Lt=ke.renderQueueKey,Z=ke.rotation,q=ke.scale,Ee=ke.shouldRender,ye=ke.viewMode,it=ke.onExecuteNamedAction,st=ke.onJumpFromLinkAnnotation,At=ke.onJumpToDest,qt=ke.onRenderCompleted,gt=ke.onRotatePage,Xt=ae(),Vt=a.useState(null),Ot=Vt[0],Ut=Vt[1],an=a.useState(!1),pn=an[0],Ln=an[1],or=a.useState(!1),gr=or[0],nr=or[1],wr=a.useRef(),jn=a.useRef(),yi=Math.abs(Z+St)%180==0,Qn=Dt.pageWidth*q,In=Dt.pageHeight*q,Wr=yi?Qn:In,yn=yi?In:Qn,qr=(Dt.rotation+Z+St)%360,un=a.useRef(0),er=pt||function(mr){return a.createElement(a.Fragment,null,mr.canvasLayer.children,mr.textLayer.children,mr.annotationLayer.children)};return a.useEffect(function(){Ut(null),Ln(!1),nr(!1)},[St,Z,q]),a.useEffect(function(){Ee&&Xt.current&&!Ot&&kn(Ve,_t).then(function(mr){Xt.current&&(un.current=Lt,Ut(mr))})},[Ee,Ot]),a.useEffect(function(){pn&&gr&&(Lt!==un.current?(Ut(null),Ln(!1),nr(!1)):qt(_t))},[pn,gr]),a.createElement("div",{className:E({"rpv-core__page-layer":!0,"rpv-core__page-layer--dual":ye===n.ViewMode.DualPage,"rpv-core__page-layer--dual-cover":ye===n.ViewMode.DualPageWithCover,"rpv-core__page-layer--single":ye===n.ViewMode.SinglePage}),"data-testid":"core__page-layer-".concat(_t),ref:nt,style:{height:"".concat(yn,"px"),width:"".concat(Wr,"px")}},Ot?a.createElement(a.Fragment,null,er({annotationLayer:{attrs:{},children:a.createElement(mn,{doc:Ve,outlines:ut,page:Ot,pageIndex:_t,plugins:Mt,rotation:qr,scale:q,onExecuteNamedAction:it,onJumpFromLinkAnnotation:st,onJumpToDest:At})},canvasLayer:{attrs:{},children:a.createElement(eo,{canvasLayerRef:wr,height:yn,page:Ot,pageIndex:_t,plugins:Mt,rotation:qr,scale:q,width:Wr,onRenderCanvasCompleted:function(){Xt.current&&Ln(!0)}})},canvasLayerRendered:pn,doc:Ve,height:yn,pageIndex:_t,rotation:qr,scale:q,svgLayer:{attrs:{},children:a.createElement(nn,{height:yn,page:Ot,rotation:qr,scale:q,width:Wr})},textLayer:{attrs:{},children:a.createElement(on,{containerRef:jn,page:Ot,pageIndex:_t,plugins:Mt,rotation:qr,scale:q,onRenderTextCompleted:function(){Xt.current&&nr(!0)}})},textLayerRendered:gr,width:Wr,markRendered:qt,onRotatePage:function(mr){return gt(_t,mr)}}),Mt.map(function(mr,Lr){return mr.renderPageLayer?a.createElement(a.Fragment,{key:Lr},mr.renderPageLayer({canvasLayerRef:wr,canvasLayerRendered:pn,doc:Ve,height:yn,pageIndex:_t,rotation:qr,scale:q,textLayerRef:jn,textLayerRendered:gr,width:Wr})):a.createElement(a.Fragment,{key:Lr})})):a.createElement(w,{testId:"core__page-layer-loading-".concat(_t)}))},ir=function(ke,Ve){var nt=Ve.rect;return ke.height!==nt.height||ke.width!==nt.width?nt:ke};(function(ke){ke.Horizontal="Horizontal",ke.Vertical="Vertical",ke.Both="Both"})(dr||(dr={}));var On=function(ke){return 1-Math.pow(1-ke,4)},Ar=1e-4,zr={left:0,top:0},kr={capture:!1,passive:!0},ui=function(ke){var Ve=ke.elementRef,nt=ke.enableSmoothScroll,ut=ke.isRtl,_t=ke.scrollDirection,St=ke.onSmoothScroll,Dt=a.useState(zr),Mt=Dt[0],pt=Dt[1],Lt=a.useState(Ve.current),Z=Lt[0],q=Lt[1],Ee=ut?-1:1,ye=a.useRef(_t);ye.current=_t;var it=a.useRef(zr),st=a.useRef(!0),At=a.useCallback(function(){st.current=!0,nt&&pt(it.current),St(!1)},[]),qt=a.useCallback(function(){if(Z){switch(ye.current){case dr.Horizontal:it.current={left:Ee*Z.scrollLeft,top:0};break;case dr.Both:it.current={left:Ee*Z.scrollLeft,top:Z.scrollTop};break;case dr.Vertical:default:it.current={left:0,top:Z.scrollTop}}nt&&!st.current||pt(it.current)}},[Z]);b(function(){q(Ve.current)}),b(function(){if(Z)return Z.addEventListener("scroll",qt,kr),function(){Z.removeEventListener("scroll",qt,kr)}},[Z]);var gt=a.useCallback(function(Xt,Vt){var Ot=Ve.current;if(!Ot)return Promise.resolve();var Ut={left:0,top:0};switch(ye.current){case dr.Horizontal:Ut.left=Ee*Xt.left;break;case dr.Both:Ut.left=Ee*Xt.left,Ut.top=Xt.top;break;case dr.Vertical:default:Ut.top=Xt.top}return Vt?(st.current=!1,St(!0),new Promise(function(an,pn){(function(Ln,or,gr,nr,wr,jn){wr===void 0&&(wr=function(Lr){return Lr}),jn===void 0&&(jn=function(){});var yi=0,Qn=0,In=!1;switch(or){case dr.Horizontal:Qn=Ln.scrollLeft,yi=0;case dr.Both:Qn=Ln.scrollLeft,yi=Ln.scrollTop;break;case dr.Vertical:default:Qn=0,yi=Ln.scrollTop}var Wr=function(){In||(In=!0,Ln.scrollLeft=gr.left,Ln.scrollTop=gr.top,jn())};if(Math.abs(yi-gr.top)<=Ar&&or===dr.Vertical)Wr();else if(Math.abs(Qn-gr.left)<=Ar&&or===dr.Horizontal)Wr();else{var yn,qr=-1,un=Qn-gr.left,er=yi-gr.top,mr=function(Lr){qr===-1&&(qr=Lr);var bo=Lr-qr,sr=Math.min(bo/nr,1),Gn=wr(sr),Mn={left:Qn-un*Gn,top:yi-er*Gn};switch(or){case dr.Horizontal:Ln.scrollLeft=Mn.left;break;case dr.Both:Ln.scrollLeft=Mn.left,Ln.scrollTop=Mn.top;break;case dr.Vertical:default:Ln.scrollTop=Mn.top}Math.abs(Mn.top-gr.top)<=Ar&&Math.abs(Mn.left-gr.left)<=Ar&&!In&&(window.cancelAnimationFrame(yn),Wr()),bo<nr?yn=window.requestAnimationFrame(mr):window.cancelAnimationFrame(yn)};yn=window.requestAnimationFrame(mr)}})(Ot,ye.current,Ut,400,On,function(){At(),an()})})):new Promise(function(an,pn){switch(ye.current){case dr.Horizontal:Ot.scrollLeft=Ut.left;break;case dr.Both:Ot.scrollLeft=Ut.left,Ot.scrollTop=Ut.top;break;case dr.Vertical:default:Ot.scrollTop=Ut.top}an()})},[Ve]);return{scrollOffset:Mt,scrollTo:gt}},Jr=function(ke,Ve,nt){return Math.max(ke,Math.min(nt,Ve))},Xr=function(ke,Ve){if(Ve!==n.ViewMode.DualPageWithCover)return 0;if(!function(_t){var St=_t.length;if(St===1)return!1;for(var Dt=1;Dt<St;Dt++)if(_t[Dt].height!==_t[0].height||_t[Dt].width!==_t[0].width)return!0;return!1}(ke))return 2*ke[0].width;var nt=It(ke.slice(1),2).map(function(_t){return _t.length===2?_t[0].width+_t[1].width:_t[0].width}),ut=[ke[0].width].concat(nt);return Math.max.apply(Math,ut)},wi={left:0,top:0},Wn={left:0,top:0},hi={left:0,top:0},pi={left:0,top:0},ns={height:0,width:0},ki={left:0,top:0},Di="data-virtual-index",Hi=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],Ur=function(ke){var Ve=ke.enableSmoothScroll,nt=ke.isRtl,ut=ke.numberOfItems,_t=ke.parentRef,St=ke.setRenderRange,Dt=ke.sizes,Mt=ke.scrollMode,pt=ke.viewMode,Lt=a.useState(!1),Z=Lt[0],q=Lt[1],Ee=a.useCallback(function(sr){return q(sr)},[]),ye=a.useRef(Mt);ye.current=Mt;var it=a.useRef(pt);it.current=pt;var st=Mt===n.ScrollMode.Wrapped||pt===n.ViewMode.DualPageWithCover||pt===n.ViewMode.DualPage?dr.Both:Mt===n.ScrollMode.Horizontal?dr.Horizontal:dr.Vertical,At=ui({elementRef:_t,enableSmoothScroll:Ve,isRtl:nt,scrollDirection:st,onSmoothScroll:Ee}),qt=At.scrollOffset,gt=At.scrollTo,Xt=function(sr){var Gn=sr.elementRef,Mn=a.useState(Gn.current),Kn=Mn[0],Bn=Mn[1],xr=a.useRef(!1),Pr=a.useReducer(ir,{height:0,width:0}),Zn=Pr[0],Pn=Pr[1];return b(function(){Gn.current!==Kn&&Bn(Gn.current)}),b(function(){if(Kn&&!xr.current){xr.current=!0;var Cr=Kn.getBoundingClientRect(),Hr=Cr.height,jr=Cr.width;Pn({rect:{height:Hr,width:jr}})}},[Kn]),a.useEffect(function(){if(Kn){var Cr=new ResizeObserver(function(Hr,jr){Hr.forEach(function(xi){if(xi.target===Kn){var yr=xi.contentRect,Ro=yr.height,zn=yr.width;Pn({rect:{height:Ro,width:zn}})}})});return Cr.observe(Kn),function(){Cr.unobserve(Kn)}}},[Kn]),Zn}({elementRef:_t}),Vt=a.useRef({scrollOffset:ki,measurements:[]});Vt.current.scrollOffset=qt;var Ot=a.useMemo(function(){return Array(ut).fill(-1)},[]),Ut=a.useState(Ot),an=Ut[0],pn=Ut[1],Ln=a.useMemo(function(){var sr=new IntersectionObserver(function(Gn){Gn.forEach(function(Mn){var Kn=Mn.isIntersecting?Mn.intersectionRatio:-1,Bn=Mn.target.getAttribute(Di);if(Bn){var xr=parseInt(Bn,10);0<=xr&&xr<ut&&pn(function(Pr){return Pr[xr]=Kn,function(Zn,Pn,Cr){if(Cr||arguments.length===2)for(var Hr,jr=0,xi=Pn.length;jr<xi;jr++)!Hr&&jr in Pn||(Hr||(Hr=Array.prototype.slice.call(Pn,0,jr)),Hr[jr]=Pn[jr]);return Zn.concat(Hr||Array.prototype.slice.call(Pn))}([],Pr,!0)})}})},{threshold:Hi});return sr},[]),or=a.useMemo(function(){return Mt===n.ScrollMode.Page&&pt===n.ViewMode.SinglePage?function(sr,Gn,Mn){for(var Kn=[],Bn=0;Bn<sr;Bn++){var xr={height:Math.max(Gn.height,Mn[Bn].height),width:Math.max(Gn.width,Mn[Bn].width)},Pr=Bn===0?pi:Kn[Bn-1].end,Zn={left:Pr.left+xr.width,top:Pr.top+xr.height};Kn[Bn]={index:Bn,start:Pr,size:xr,end:Zn,visibility:-1}}return Kn}(ut,Xt,Dt):pt===n.ViewMode.DualPageWithCover?function(sr,Gn,Mn,Kn){for(var Bn=[],xr=0,Pr=0,Zn=hi,Pn=0;Pn<sr;Pn++){var Cr=Pn===0?{height:Kn===n.ScrollMode.Page?Math.max(Gn.height,Mn[Pn].height):Mn[Pn].height,width:Kn===n.ScrollMode.Page?Math.max(Gn.width,Mn[Pn].width):Mn[Pn].width}:{height:Kn===n.ScrollMode.Page?Math.max(Gn.height,Mn[Pn].height):Mn[Pn].height,width:Math.max(Gn.width/2,Mn[Pn].width)};Kn===n.ScrollMode.Page?Zn=Pn===0?hi:{left:Pn%2==0?Cr.width:0,top:Math.floor((Pn-1)/2)*Cr.height+Bn[0].end.top}:Pn===0?(Zn=hi,xr=Mn[0].height,Pr=0):Pn%2==1?(Zn={left:0,top:xr+=Pr},Pr=Pn===sr-1?Mn[Pn].height:Math.max(Mn[Pn].height,Mn[Pn+1].height)):Zn={left:Bn[Pn-1].end.left,top:xr};var Hr={left:Zn.left+Cr.width,top:Zn.top+Cr.height};Bn[Pn]={index:Pn,start:Zn,size:Cr,end:Hr,visibility:-1}}return Bn}(ut,Xt,Dt,Mt):pt===n.ViewMode.DualPage?function(sr,Gn,Mn,Kn){for(var Bn=[],xr=0,Pr=0,Zn=Wn,Pn=0;Pn<sr;Pn++){var Cr={height:Kn===n.ScrollMode.Page?Math.max(Gn.height,Mn[Pn].height):Mn[Pn].height,width:Math.max(Gn.width/2,Mn[Pn].width)};Kn===n.ScrollMode.Page?Zn={left:Pn%2==0?0:Cr.width,top:Math.floor(Pn/2)*Cr.height}:Pn%2==0?(Zn={left:0,top:xr+=Pr},Pr=Pn===sr-1?Mn[Pn].height:Math.max(Mn[Pn].height,Mn[Pn+1].height)):Zn={left:Bn[Pn-1].end.left,top:xr};var Hr={left:Zn.left+Cr.width,top:Zn.top+Cr.height};Bn[Pn]={index:Pn,start:Zn,size:Cr,end:Hr,visibility:-1}}return Bn}(ut,Xt,Dt,Mt):function(sr,Gn,Mn,Kn){for(var Bn=[],xr=0,Pr={left:0,top:0},Zn=0,Pn=wi,Cr=0;Cr<sr;Cr++){var Hr=Mn[Cr];if(Cr===0)xr=Hr.width,Pr={left:0,top:0},Zn=Hr.height;else switch(Kn){case n.ScrollMode.Wrapped:(xr+=Hr.width)<Gn.width?(Pn={left:Bn[Cr-1].end.left,top:Pr.top},Zn=Math.max(Zn,Hr.height)):(xr=Hr.width,Pr={left:(Pn={left:Pr.left,top:Pr.top+Zn}).left,top:Pn.top},Zn=Hr.height);break;case n.ScrollMode.Horizontal:case n.ScrollMode.Vertical:default:Pn=Bn[Cr-1].end}var jr={left:Pn.left+Hr.width,top:Pn.top+Hr.height};Bn[Cr]={index:Cr,start:Pn,size:Hr,end:jr,visibility:-1}}return Bn}(ut,Xt,Dt,Mt)},[Mt,Dt,pt,Xt]),gr=or[ut-1]?{height:or[ut-1].end.top,width:or[ut-1].end.left}:ns;Vt.current.measurements=or;var nr=a.useMemo(function(){var sr=function(Cr,Hr,jr,xi){var yr=0;switch(Cr){case dr.Horizontal:yr=xi.left;break;case dr.Vertical:default:yr=xi.top}var Ro=Hr.length-1,zn=function(fi,is,aa,Go){for(;fi<=is;){var qa=(fi+is)/2|0,Zl=Go(qa);if(Zl<aa)fi=qa+1;else{if(!(Zl>aa))return qa;is=qa-1}}return fi>0?fi-1:0}(0,Ro,yr,function(fi){switch(Cr){case dr.Horizontal:return Hr[fi].start.left;case dr.Both:case dr.Vertical:default:return Hr[fi].start.top}});if(Cr===dr.Both)for(var Fr=Hr[zn].start.top;zn-1>=0&&Hr[zn-1].start.top===Fr&&Hr[zn-1].start.left>=xi.left;)zn--;for(var ai=zn;ai<=Ro;){var bi={top:Hr[ai].start.top-xi.top,left:Hr[ai].start.left-xi.left},Li={height:jr.height-bi.top,width:jr.width-bi.left};if(Cr===dr.Horizontal&&Li.width<0||Cr===dr.Vertical&&Li.height<0||Cr===dr.Both&&(Li.width<0||Li.height<0))break;ai++}return{start:zn,end:ai}}(st,or,Xt,qt),Gn=sr.start,Mn=sr.end,Kn=an.slice(Jr(0,ut,Gn),Jr(0,ut,Mn)),Bn=Gn+Kn.reduce(function(Cr,Hr,jr,xi){return Hr>xi[Cr]?jr:Cr},0),xr=Bn=Jr(0,ut-1,Bn),Pr=St({endPage:Mn,numPages:ut,startPage:Gn}),Zn=Pr.startPage,Pn=Pr.endPage;switch(Zn=Math.max(Zn,0),Pn=Math.min(Pn,ut-1),pt){case n.ViewMode.DualPageWithCover:Bn>0&&(xr=Bn%2==1?Bn:Bn-1),Zn=Zn===0?0:Zn%2==1?Zn:Zn-1,ut-(Pn=Pn%2==1?Pn-1:Pn)<=2&&(Pn=ut-1);break;case n.ViewMode.DualPage:xr=Bn%2==0?Bn:Bn-1,Zn=Zn%2==0?Zn:Zn-1,Pn=Pn%2==1?Pn:Pn-1;break;case n.ViewMode.SinglePage:default:xr=Bn}return{startPage:Zn,endPage:Pn,maxVisbilityIndex:xr}},[or,Xt,qt,pt,an]),wr=nr.startPage,jn=nr.endPage,yi=nr.maxVisbilityIndex,Qn=a.useMemo(function(){for(var sr=[],Gn=function(Kn){var Bn=or[Kn],xr=v(v({},Bn),{visibility:an[Kn]!==void 0?an[Kn]:-1,measureRef:function(Pr){Pr&&(Pr.setAttribute(Di,"".concat(Kn)),Ln.observe(Pr))}});sr.push(xr)},Mn=wr;Mn<=jn;Mn++)Gn(Mn);return sr},[wr,jn,an,or]),In=a.useCallback(function(sr,Gn){var Mn=Vt.current.measurements[Jr(0,ut-1,sr)],Kn=ye.current===n.ScrollMode.Page?ki:Gn;return Mn?gt({left:Kn.left+Mn.start.left,top:Kn.top+Mn.start.top},Ve):Promise.resolve()},[gt,Ve]),Wr=a.useCallback(function(sr,Gn){var Mn=Vt.current.measurements,Kn=Mn[sr].start,Bn=Mn.find(function(Pr){return Pr.start.top-Kn.top>1e-12});if(!Bn)return Promise.resolve();var xr=Bn.index;switch(it.current){case n.ViewMode.DualPage:xr=xr%2==0?xr:xr+1;break;case n.ViewMode.DualPageWithCover:xr=xr%2==1?xr:xr+1}return In(xr,Gn)},[]),yn=a.useCallback(function(sr,Gn){for(var Mn=Vt.current.measurements,Kn=Mn[sr].start,Bn=sr,xr=!1,Pr=ut-1;Pr>=0;Pr--)if(Kn.top-Mn[Pr].start.top>1e-12){xr=!0,Bn=Mn[Pr].index;break}if(!xr)return Promise.resolve();switch(it.current){case n.ViewMode.DualPage:Bn=Bn%2==0?Bn:Bn-1;break;case n.ViewMode.DualPageWithCover:Bn=Bn%2==0?Bn-1:Bn}return Bn===sr&&(Bn=sr-1),In(Bn,Gn)},[]),qr=a.useCallback(function(sr,Gn){if(it.current===n.ViewMode.DualPageWithCover||it.current===n.ViewMode.DualPage)return Wr(sr,Gn);switch(ye.current){case n.ScrollMode.Wrapped:return Wr(sr,Gn);case n.ScrollMode.Horizontal:case n.ScrollMode.Vertical:default:return In(sr+1,Gn)}},[]),un=a.useCallback(function(sr,Gn){if(it.current===n.ViewMode.DualPageWithCover||it.current===n.ViewMode.DualPage)return yn(sr,Gn);switch(ye.current){case n.ScrollMode.Wrapped:return yn(sr,Gn);case n.ScrollMode.Horizontal:case n.ScrollMode.Vertical:default:return In(sr-1,Gn)}},[]),er=a.useCallback(function(){return function(sr,Gn){switch(Gn){case n.ScrollMode.Horizontal:return{position:"relative",height:"100%",width:"".concat(sr.width,"px")};case n.ScrollMode.Vertical:default:return{position:"relative",height:"".concat(sr.height,"px"),width:"100%"}}}(gr,ye.current)},[gr]),mr=a.useCallback(function(sr){return function(Gn,Mn,Kn){return Kn!==n.ScrollMode.Page?{}:{height:"".concat(Mn.height,"px"),width:"100%",position:"absolute",top:0,transform:"translateY(".concat(Gn.start.top,"px)")}}(sr,Xt,ye.current)},[Xt]),Lr=a.useCallback(function(sr){return function(Gn,Mn,Kn,Bn,xr){var Pr,Zn,Pn,Cr,Hr,jr,xi,yr=Mn?"right":"left",Ro=Mn?-1:1,zn=Kn.length,Fr=Gn.start.left*Ro,ai=Gn.size,bi=ai.height,Li=ai.width;if(Bn===n.ViewMode.DualPageWithCover){var fi=xr===n.ScrollMode.Page?0:Gn.start.top;return Gn.index===0||zn%2==0&&Gn.index===zn-1?((Pr={height:"".concat(bi,"px"),minWidth:"".concat(Xr(Kn,Bn),"px"),width:"100%"})[yr]=0,Pr.position="absolute",Pr.top=0,Pr.transform="translate(".concat(Fr,"px, ").concat(fi,"px)"),Pr):((Zn={height:"".concat(bi,"px"),width:"".concat(Li,"px")})[yr]=0,Zn.position="absolute",Zn.top=0,Zn.transform="translate(".concat(Fr,"px, ").concat(fi,"px)"),Zn)}if(Bn===n.ViewMode.DualPage)return(Pn={height:"".concat(bi,"px"),width:"".concat(Li,"px")})[yr]=0,Pn.position="absolute",Pn.top=0,Pn.transform="translate(".concat(Fr,"px, ").concat(xr===n.ScrollMode.Page?0:Gn.start.top,"px)"),Pn;switch(xr){case n.ScrollMode.Horizontal:return(Cr={height:"100%",width:"".concat(Li,"px")})[yr]=0,Cr.position="absolute",Cr.top=0,Cr.transform="translateX(".concat(Fr,"px)"),Cr;case n.ScrollMode.Page:return(Hr={height:"".concat(bi,"px"),width:"".concat(Li,"px")})[yr]=0,Hr.position="absolute",Hr.top=0,Hr;case n.ScrollMode.Wrapped:return(jr={height:"".concat(bi,"px"),width:"".concat(Li,"px")})[yr]=0,jr.position="absolute",jr.top=0,jr.transform="translate(".concat(Fr,"px, ").concat(Gn.start.top,"px)"),jr;case n.ScrollMode.Vertical:default:return(xi={height:"".concat(bi,"px"),width:"100%"})[yr]=0,xi.position="absolute",xi.top=0,xi.transform="translateY(".concat(Gn.start.top,"px)"),xi}}(sr,nt,Dt,it.current,ye.current)},[nt,Dt]),bo=a.useCallback(function(sr,Gn){var Mn=Vt.current,Kn=Mn.measurements,Bn=Mn.scrollOffset,xr=Kn[Jr(0,ut-1,Gn)];if(xr){var Pr=ye.current===n.ScrollMode.Page?{left:xr.start.left,top:xr.start.top}:{left:Bn.left*sr,top:Bn.top*sr};return gt(Pr,!1)}return Promise.resolve()},[]);return a.useEffect(function(){return function(){Ln.disconnect()}},[]),{boundingClientRect:Xt,isSmoothScrolling:Z,startPage:wr,endPage:jn,maxVisbilityIndex:yi,virtualItems:Qn,getContainerStyles:er,getItemContainerStyles:mr,getItemStyles:Lr,scrollToItem:In,scrollToNextItem:qr,scrollToPreviousItem:un,zoom:bo}},Io=function(ke,Ve,nt,ut,_t,St){var Dt=nt;switch(!0){case(_t===n.ViewMode.DualPageWithCover&&St>=3):case(_t===n.ViewMode.DualPage&&St>=3):Dt=2*nt;break;default:Dt=nt}switch(ut){case n.SpecialZoomLevel.ActualSize:return 1;case n.SpecialZoomLevel.PageFit:return Math.min((ke.clientWidth-17)/Dt,(ke.clientHeight-16)/Ve);case n.SpecialZoomLevel.PageWidth:return(ke.clientWidth-17)/Dt}},rs=function(ke){var Ve,nt,ut=ke.getCurrentPage,_t=(Ve=50,nt=a.useRef([]),a.useEffect(function(){return function(){nt.current=[]}},[]),{push:function(Lt){var Z=nt.current;Z.length+1>Ve&&Z.shift(),Z.push(Lt),nt.current=Z},map:function(Lt){return nt.current.map(function(Z){return Lt(Z)})},pop:function(){var Lt=nt.current;if(Lt.length===0)return null;var Z=Lt.pop();return nt.current=Lt,Z}}),St=function(Lt){var Z=a.useRef([]);return a.useEffect(function(){return function(){Z.current=[]}},[]),{dequeue:function(){var q=Z.current;if(q.length===0)return null;var Ee=q.shift();return Z.current=q,Ee||null},enqueue:function(q){var Ee=Z.current;Ee.length+1>Lt&&Ee.pop(),Z.current=[q].concat(Ee)},map:function(q){return Z.current.map(function(Ee){return q(Ee)})}}}(50),Dt=function(){var Lt=St.dequeue();return Lt&&_t.push(Lt),Lt&&Lt.pageIndex===ut()?Dt():Lt},Mt=function(){var Lt=_t.pop();return Lt&&St.enqueue(Lt),Lt&&Lt.pageIndex===ut()?Mt():Lt},pt=a.useCallback(function(Lt){_t.push(Lt)},[]);return{getNextDestination:Dt,getPreviousDestination:Mt,markVisitedDestination:pt}},ao=function(ke){var Ve=[];return ke.map(function(nt){Ve=Ve.concat(nt).concat(function(ut){var _t=[];return ut.items&&ut.items.length>0&&(_t=_t.concat(ao(ut.items))),_t}(nt))}),Ve},qo={capture:!1,passive:!0},yo={height:0,width:0},lo={height:0,width:0},Ao=function(ke){var Ve=ke.getCurrentPage,nt=ke.getCurrentScrollMode,ut=ke.jumpToPage,_t=ke.targetRef,St=a.useState(n.FullScreenMode.Normal),Dt=St[0],Mt=St[1],pt=function(){var an=a.useState(yo),pn=an[0],Ln=an[1],or=oe(function(){Ln({height:window.innerHeight,width:window.innerWidth})},100);return b(function(){return window.addEventListener("resize",or,qo),function(){window.removeEventListener("resize",or,qo)}},[]),pn}(),Lt=a.useState(lo),Z=Lt[0],q=Lt[1],Ee=a.useRef(lo),ye=a.useRef(Ve()),it=a.useRef(lo),st=a.useState(_t.current),At=st[0],qt=st[1],gt=a.useRef();b(function(){_t.current!==At&&qt(_t.current)},[]),b(function(){if(At){var an=new ResizeObserver(function(pn){pn.forEach(function(Ln){var or=Ln.target.getBoundingClientRect(),gr=or.height,nr=or.width;q({height:gr,width:nr})})});return an.observe(At),function(){an.unobserve(At),an.disconnect()}}},[At]);var Xt=a.useCallback(function(an){var pn=Q();return pn&&pn!==an?(Mt(n.FullScreenMode.Normal),re(pn)):Promise.resolve()},[]),Vt=a.useCallback(function(an){an&&G()&&(qt(an),Xt(an).then(function(){gt.current=an,Mt(n.FullScreenMode.Entering),function(pn){L&&pn[W.RequestFullScreen]()}(an)}))},[]),Ot=a.useCallback(function(){Q()&&(Mt(n.FullScreenMode.Exitting),re(document))},[]),Ut=a.useCallback(function(){At&&Q()!==At&&Mt(n.FullScreenMode.Exitting)},[At]);return a.useEffect(function(){switch(Dt){case n.FullScreenMode.Entering:gt.current&&(gt.current.style.backgroundColor="var(--rpv-core__full-screen-target-background-color)"),ye.current=Ve(),Ee.current={height:window.innerHeight,width:window.innerWidth};break;case n.FullScreenMode.Entered:nt()===n.ScrollMode.Page?ut(ye.current).then(function(){Mt(n.FullScreenMode.EnteredCompletely)}):Mt(n.FullScreenMode.EnteredCompletely);break;case n.FullScreenMode.Exitting:gt.current&&(gt.current.style.backgroundColor="",gt.current=null),ye.current=Ve();break;case n.FullScreenMode.Exited:Mt(n.FullScreenMode.Normal),nt()===n.ScrollMode.Page&&ut(ye.current)}},[Dt]),a.useEffect(function(){if(Dt!==n.FullScreenMode.Normal)return Dt===n.FullScreenMode.Entering&&pt.height===Z.height&&pt.width===Z.width&&pt.height>0&&pt.width>0&&(it.current.height===0||pt.height==it.current.height)?(it.current={height:window.innerHeight,width:window.innerWidth},void Mt(n.FullScreenMode.Entered)):void(Dt===n.FullScreenMode.Exitting&&Ee.current.height===pt.height&&Ee.current.width===pt.width&&pt.height>0&&pt.width>0&&Mt(n.FullScreenMode.Exited))},[Dt,pt,Z]),a.useEffect(function(){var an;return an=Ut,L&&document.addEventListener(W.FullScreenChange,an),function(){(function(pn){L&&document.removeEventListener(W.FullScreenChange,pn)})(Ut)}},[At]),{enterFullScreenMode:Vt,exitFullScreenMode:Ot,fullScreenMode:Dt}},Ss={buildPageStyles:function(){return{}},transformSize:function(ke){return ke.size}},Ho={left:0,top:0},Kl=function(ke){var Ve=ke.currentFile,nt=ke.defaultScale,ut=ke.doc,_t=ke.enableSmoothScroll,St=ke.initialPage,Dt=ke.initialRotation,Mt=ke.initialScale,pt=ke.pageLayout,Lt=ke.pageSizes,Z=ke.plugins,q=ke.renderPage,Ee=ke.scrollMode,ye=ke.setRenderRange,it=ke.viewMode,st=ke.viewerState,At=ke.onDocumentLoad,qt=ke.onOpenFile,gt=ke.onPageChange,Xt=ke.onRotate,Vt=ke.onRotatePage,Ot=ke.onZoom,Ut=ut.numPages,an=ut.loadingTask.docId,pn=a.useContext(N).l10n,Ln=a.useContext(_),or=Ln.direction===n.TextDirection.RightToLeft,gr=a.useRef(),nr=a.useRef(),wr=a.useState(St),jn=wr[0],yi=wr[1],Qn=a.useRef(null),In=rs({getCurrentPage:function(){return zn.current.pageIndex}}),Wr=a.useState(Dt),yn=Wr[0],qr=Wr[1],un=de(yn),er=a.useState(!1),mr=er[0],Lr=er[1],bo=a.useState(new Map),sr=bo[0],Gn=bo[1],Mn=a.useState(Ee),Kn=Mn[0],Bn=Mn[1],xr=de(Kn),Pr=a.useState(it),Zn=Pr[0],Pn=Pr[1],Cr=de(Zn),Hr=function(hn){var Tr=ae(),Vr=a.useState([]),$r=Vr[0],Qr=Vr[1];return a.useEffect(function(){hn.getOutline().then(function(Zr){if(Tr.current&&Zr!==null){var Ki=ao(Zr);Qr(Ki)}})},[]),$r}(ut),jr=a.useState(Mt),xi=jr[0],yr=jr[1],Ro=de(xi),zn=a.useRef(st),Fr=a.useRef(typeof nt=="string"?nt:null),ai=a.useRef(-1),bi=a.useRef(-1),Li=a.useRef(St),fi=Ao({getCurrentPage:function(){return zn.current.pageIndex},getCurrentScrollMode:function(){return zn.current.scrollMode},jumpToPage:function(hn){return Es(hn)},targetRef:nr}),is=a.useState(-1),aa=is[0],Go=is[1],qa=a.useState(0),Zl=qa[0],vd=qa[1],uo=U({doc:ut});a.useEffect(function(){return function(){tn.clear(),xt.clear()}},[an]);var kc=a.useMemo(function(){return Object.assign({},Ss,pt)},[]),du=a.useMemo(function(){return Array(Ut).fill(0).map(function(hn,Tr){var Vr=[Lt[Tr].pageHeight,Lt[Tr].pageWidth],$r=Math.abs(yn)%180==0?{height:Vr[0],width:Vr[1]}:{height:Vr[1],width:Vr[0]},Qr={height:$r.height*xi,width:$r.width*xi};return kc.transformSize({numPages:Ut,pageIndex:Tr,size:Qr})})},[yn,xi]),li=Ur({enableSmoothScroll:_t,isRtl:or,numberOfItems:Ut,parentRef:nr,scrollMode:Kn,setRenderRange:ye,sizes:du,viewMode:Zn}),pu=oe(function(){!Fr.current||zn.current.fullScreenMode!==n.FullScreenMode.Normal||St>0&&Li.current===St||zs(Fr.current)},200);(function(hn){var Tr=hn.targetRef,Vr=hn.onResize;b(function(){var $r=new ResizeObserver(function(Zr){Zr.forEach(function(Ki){Vr(Ki.target)})}),Qr=Tr.current;if(Qr)return $r.observe(Qr),function(){$r.unobserve(Qr)}},[])})({targetRef:nr,onResize:pu});var la=function(hn){var Tr=hn;Z.forEach(function(Vr){Vr.onViewerStateChange&&(Tr=Vr.onViewerStateChange(Tr))}),zn.current=Tr},Pc=function(){return nr.current},Tc=function(){return zn.current},Pm=a.useCallback(function(hn){In.markVisitedDestination(hn)},[]),mu=a.useCallback(function(hn){var Tr=hn.pageIndex,Vr=hn.bottomOffset,$r=hn.leftOffset,Qr=hn.scaleTo,Zr=nr.current,Ki=zn.current;return Zr&&Ki?new Promise(function(Si,As){kn(ut,Tr).then(function(Do){var Us=Do.getViewport({scale:1}),Cc=0,Su=(typeof Vr=="function"?Vr(Us.width,Us.height):Vr)||0,Ha=(typeof $r=="function"?$r(Us.width,Us.height):$r)||0,os=Ki.scale;switch(Qr){case n.SpecialZoomLevel.PageFit:Cc=0,Ha=0,zs(n.SpecialZoomLevel.PageFit);break;case n.SpecialZoomLevel.PageWidth:os=Io(Zr,Lt[Tr].pageHeight,Lt[Tr].pageWidth,n.SpecialZoomLevel.PageWidth,it,Ut),Cc=(Us.height-Su)*os,Ha*=os,zs(os);break;default:Cc=(Us.height-Su)*os,Ha*=os}switch(Ki.scrollMode){case n.ScrollMode.Horizontal:li.scrollToItem(Tr,{left:Ha,top:0}).then(function(){Si()});break;case n.ScrollMode.Vertical:default:li.scrollToItem(Tr,{left:0,top:Cc}).then(function(){Si()})}})}):Promise.resolve()},[]),si=a.useCallback(function(hn){return In.markVisitedDestination(hn),mu(hn)},[]),Mh=a.useCallback(function(){var hn=In.getNextDestination();return hn?mu(hn):Promise.resolve()},[]),C0=a.useCallback(function(){var hn=In.getPreviousDestination();return hn?mu(hn):Promise.resolve()},[]),Tm=a.useCallback(function(){return li.scrollToNextItem(zn.current.pageIndex,Ho)},[]),Es=a.useCallback(function(hn){return 0<=hn&&hn<Ut?li.scrollToItem(hn,Ho):Promise.resolve()},[]),Om=a.useCallback(function(){return li.scrollToPreviousItem(zn.current.pageIndex,Ho)},[]),gu=a.useCallback(function(hn){var Tr,Vr;(Tr=hn.name,Vr=Tr.split(/\./).pop(),Vr?Vr.toLowerCase():"").toLowerCase()==="pdf"&&new Promise(function($r){var Qr=new FileReader;Qr.readAsArrayBuffer(hn),Qr.onload=function(){var Zr=new Uint8Array(Qr.result);$r(Zr)}}).then(function($r){qt(hn.name,$r)})},[qt]),_d=a.useCallback(function(hn){var Tr=hn===n.RotateDirection.Backward?-90:90,Vr=zn.current.rotation,$r=Vr===360||Vr===-360?Tr:Vr+Tr;uo.markNotRendered(),qr($r),la(v(v({},zn.current),{rotation:$r})),Xt({direction:hn,doc:ut,rotation:$r})},[]),Ch=a.useCallback(function(hn,Tr){var Vr=Tr===n.RotateDirection.Backward?-90:90,$r=zn.current.pagesRotation,Qr=($r.has(hn)?$r.get(hn):Dt)+Vr,Zr=$r.set(hn,Qr);Gn(Zr),Lr(function(Ki){return!Ki}),la(v(v({},zn.current),{pagesRotation:Zr,rotatedPage:hn})),Vt({direction:Tr,doc:ut,pageIndex:hn,rotation:Qr}),uo.markRendering(hn),Go(hn)},[]),yu=a.useCallback(function(hn){la(v(v({},zn.current),{scrollMode:hn})),Bn(hn)},[]),bu=a.useCallback(function(hn){la(v(v({},zn.current),{viewMode:hn})),Pn(hn)},[]),zs=a.useCallback(function(hn){var Tr=nr.current,Vr=zn.current.pageIndex;if(!(Vr<0||Vr>=Ut)){var $r=Lt[Vr].pageHeight,Qr=Lt[Vr].pageWidth,Zr=Tr?typeof hn=="string"?Io(Tr,$r,Qr,hn,zn.current.viewMode,Ut):hn:1;Fr.current=typeof hn=="string"?hn:null,Zr!==zn.current.scale&&(vd(function(Ki){return Ki+1}),uo.markNotRendered(),yr(Zr),Ot({doc:ut,scale:Zr}),la(v(v({},zn.current),{scale:Zr})))}},[]),Oc=a.useCallback(function(hn){fi.enterFullScreenMode(hn)},[]),Mc=a.useCallback(function(){fi.exitFullScreenMode()},[]);a.useEffect(function(){la(v(v({},zn.current),{fullScreenMode:fi.fullScreenMode}))},[fi.fullScreenMode]),a.useEffect(function(){var hn={enterFullScreenMode:Oc,exitFullScreenMode:Mc,getPagesContainer:Pc,getViewerState:Tc,jumpToDestination:si,jumpToNextDestination:Mh,jumpToPreviousDestination:C0,jumpToNextPage:Tm,jumpToPreviousPage:Om,jumpToPage:Es,openFile:gu,rotate:_d,rotatePage:Ch,setViewerState:la,switchScrollMode:yu,switchViewMode:bu,zoom:zs};return Z.forEach(function(Tr){Tr.install&&Tr.install(hn)}),function(){Z.forEach(function(Tr){Tr.uninstall&&Tr.uninstall(hn)})}},[an]),a.useEffect(function(){At({doc:ut,file:Ve}),Z.forEach(function(hn){hn.onDocumentLoad&&hn.onDocumentLoad({doc:ut,file:Ve})})},[an]);var vu,El,Yl,_u=li.boundingClientRect;vu=function(){St&&Es(St)},El=_u.height>0&&_u.width>0,Yl=a.useRef(!1),b(function(){El&&!Yl.current&&(Yl.current=!0,vu())},[vu,El]),b(function(){var hn=zn.current.pageIndex;hn>-1&&xr!==Kn&&li.scrollToItem(hn,Ho).then(function(){fi.fullScreenMode===n.FullScreenMode.EnteredCompletely&&(_t||uo.markNotRendered(),ai.current=-1)})},[Kn]),b(function(){var hn=zn.current.pageIndex;hn>-1&&un!==yn&&li.scrollToItem(hn,Ho)},[yn]),b(function(){Ro!=0&&Ro!=zn.current.scale&&li.zoom(zn.current.scale/Ro,zn.current.pageIndex).then(function(){fi.fullScreenMode===n.FullScreenMode.EnteredCompletely&&(bi.current=-1)})},[xi]),b(function(){if(Cr!==zn.current.viewMode){var hn=li.startPage,Tr=li.endPage,Vr=li.virtualItems;uo.markNotRendered(),uo.setRange(hn,Tr);for(var $r=function(Zr){var Ki=Vr.find(function(Si){return Si.index===Zr});Ki&&uo.setVisibility(Zr,Ki.visibility)},Qr=hn;Qr<=Tr;Qr++)$r(Qr);wu()}},[Zn]),b(function(){var hn=zn.current.pageIndex;hn>-1&&Cr!==Zn&&li.scrollToItem(hn,Ho)},[Zn]),b(function(){var hn=zn.current.pageIndex;hn>0&&hn===St&&Li.current===St&&Fr.current&&(Li.current=-1,zs(Fr.current))},[jn]),a.useEffect(function(){li.isSmoothScrolling||Qn.current!==null&&Qn.current===jn||(Qn.current=jn,gt({currentPage:jn,doc:ut}))},[jn,li.isSmoothScrolling]),a.useEffect(function(){fi.fullScreenMode===n.FullScreenMode.Entering&&zn.current.scrollMode===n.ScrollMode.Page&&(ai.current=zn.current.pageIndex),fi.fullScreenMode===n.FullScreenMode.EnteredCompletely&&zn.current.scrollMode===n.ScrollMode.Page&&_t&&(ai.current=-1),fi.fullScreenMode===n.FullScreenMode.EnteredCompletely&&Fr.current&&(bi.current=zn.current.pageIndex,zs(Fr.current))},[fi.fullScreenMode]),a.useEffect(function(){if(fi.fullScreenMode!==n.FullScreenMode.Entering&&fi.fullScreenMode!==n.FullScreenMode.Exitting&&!li.isSmoothScrolling){var hn=li.startPage,Tr=li.endPage,Vr=li.maxVisbilityIndex,$r=li.virtualItems,Qr=Vr,Zr=fi.fullScreenMode===n.FullScreenMode.Entered||fi.fullScreenMode===n.FullScreenMode.EnteredCompletely;if(!(Zr&&Qr!==ai.current&&ai.current>-1||Zr&&Qr!==bi.current&&bi.current>-1)){yi(Qr),la(v(v({},zn.current),{pageIndex:Qr})),uo.setRange(hn,Tr);for(var Ki=function(As){var Do=$r.find(function(Us){return Us.index===As});Do&&uo.setVisibility(As,Do.visibility)},Si=hn;Si<=Tr;Si++)Ki(Si);wu()}}},[li.startPage,li.endPage,li.isSmoothScrolling,li.maxVisbilityIndex,fi.fullScreenMode,mr,yn,xi]);var Ih=a.useCallback(function(hn){uo.markRendered(hn),wu()},[Zl]),wu=function(){var hn=uo.getHighestPriorityPage();hn>-1&&uo.isInRange(hn)&&(uo.markRendering(hn),Go(hn))},I0=function(hn){var Tr=jn-1,Vr=jn+1;switch(hn){case"FirstPage":Es(0);break;case"LastPage":Es(Ut-1);break;case"NextPage":Vr<Ut&&Es(Vr);break;case"PrevPage":Tr>=0&&Es(Tr)}},Mm=a.useCallback(function(){var hn=li.virtualItems,Tr=[];switch(Zn){case n.ViewMode.DualPage:Tr=It(hn,2);break;case n.ViewMode.DualPageWithCover:hn.length&&(Tr=hn[0].index===0?[[hn[0]]].concat(It(hn.slice(1),2)):It(hn,2));break;case n.ViewMode.SinglePage:default:Tr=It(hn,1)}var Vr=pn&&pn.core?pn.core.pageLabel:"Page {{pageIndex}}",$r={attrs:{className:"rpv-core__inner-container","data-testid":"core__inner-container",ref:gr,style:{height:"100%"}},children:a.createElement(a.Fragment,null),subSlot:{attrs:{"data-testid":"core__inner-pages",className:E({"rpv-core__inner-pages":!0,"rpv-core__inner-pages--horizontal":Kn===n.ScrollMode.Horizontal,"rpv-core__inner-pages--rtl":or,"rpv-core__inner-pages--single":Kn===n.ScrollMode.Page,"rpv-core__inner-pages--vertical":Kn===n.ScrollMode.Vertical,"rpv-core__inner-pages--wrapped":Kn===n.ScrollMode.Wrapped}),ref:nr,style:{height:"100%",position:"relative"}},children:a.createElement("div",{"data-testid":"core__inner-current-page-".concat(jn),style:Object.assign({"--scale-factor":xi},li.getContainerStyles())},Tr.map(function(Qr){return a.createElement("div",{className:E({"rpv-core__inner-page-container":!0,"rpv-core__inner-page-container--single":Kn===n.ScrollMode.Page}),style:li.getItemContainerStyles(Qr[0]),key:"".concat(Qr[0].index,"-").concat(Zn)},Qr.map(function(Zr){var Ki=Zn===n.ViewMode.DualPageWithCover&&(Zr.index===0||Ut%2==0&&Zr.index===Ut-1);return a.createElement("div",{"aria-label":Vr.replace("{{pageIndex}}","".concat(Zr.index+1)),className:E({"rpv-core__inner-page":!0,"rpv-core__inner-page--dual-even":Zn===n.ViewMode.DualPage&&Zr.index%2==0,"rpv-core__inner-page--dual-odd":Zn===n.ViewMode.DualPage&&Zr.index%2==1,"rpv-core__inner-page--dual-cover":Ki,"rpv-core__inner-page--dual-cover-even":Zn===n.ViewMode.DualPageWithCover&&!Ki&&Zr.index%2==0,"rpv-core__inner-page--dual-cover-odd":Zn===n.ViewMode.DualPageWithCover&&!Ki&&Zr.index%2==1,"rpv-core__inner-page--single":Zn===n.ViewMode.SinglePage&&Kn===n.ScrollMode.Page}),role:"region",key:"".concat(Zr.index,"-").concat(Zn),style:Object.assign({},li.getItemStyles(Zr),kc.buildPageStyles({numPages:Ut,pageIndex:Zr.index,scrollMode:Kn,viewMode:Zn}))},a.createElement(bn,{doc:ut,measureRef:Zr.measureRef,outlines:Hr,pageIndex:Zr.index,pageRotation:sr.has(Zr.index)?sr.get(Zr.index):0,pageSize:Lt[Zr.index],plugins:Z,renderPage:q,renderQueueKey:Zl,rotation:yn,scale:xi,shouldRender:aa===Zr.index,viewMode:Zn,onExecuteNamedAction:I0,onJumpFromLinkAnnotation:Pm,onJumpToDest:si,onRenderCompleted:Ih,onRotatePage:Ch}))}))}))}};return Z.forEach(function(Qr){Qr.renderViewer&&($r=Qr.renderViewer({containerRef:gr,doc:ut,pagesContainerRef:nr,pagesRotation:sr,pageSizes:Lt,rotation:yn,slot:$r,themeContext:Ln,jumpToPage:Es,openFile:gu,rotate:_d,rotatePage:Ch,switchScrollMode:yu,switchViewMode:bu,zoom:zs}))}),$r},[Z,li]),xu=a.useCallback(function(hn){return a.createElement("div",v({},hn.attrs,{style:hn.attrs&&hn.attrs.style?hn.attrs.style:{}}),hn.children,hn.subSlot&&xu(hn.subSlot))},[]);return xu(Mm())},za=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],Ua=function(ke){var Ve=ke.defaultScale,nt=ke.doc,ut=ke.render,_t=ke.scrollMode,St=ke.viewMode,Dt=a.useRef(),Mt=a.useState({pageSizes:[],scale:0}),pt=Mt[0],Lt=Mt[1];return a.useLayoutEffect(function(){var Z=Array(nt.numPages).fill(0).map(function(q,Ee){return new Promise(function(ye,it){kn(nt,Ee).then(function(st){var At=st.getViewport({scale:1});ye({pageHeight:At.height,pageWidth:At.width,rotation:At.rotation})})})});Promise.all(Z).then(function(q){var Ee=Dt.current;if(Ee&&q.length!==0){var ye=q[0].pageWidth,it=q[0].pageHeight,st=Ee.parentElement,At=(st.clientWidth-45)/ye,qt=(st.clientHeight-45)/it,gt=At;switch(_t){case n.ScrollMode.Horizontal:gt=Math.min(At,qt);break;case n.ScrollMode.Vertical:default:gt=At}var Xt,Vt,Ot=Ve?typeof Ve=="string"?Io(st,it,ye,Ve,St,nt.numPages):Ve:(Xt=gt,(Vt=za.findIndex(function(Ut){return Ut>=Xt}))===-1||Vt===0?Xt:za[Vt-1]);Lt({pageSizes:q,scale:Ot})}})},[nt.loadingTask.docId]),pt.pageSizes.length===0||pt.scale===0?a.createElement("div",{className:"rpv-core__page-size-calculator","data-testid":"core__page-size-calculating",ref:Dt},a.createElement(w,null)):ut(pt.pageSizes,pt.scale)},co=function(){},Wo=function(ke){function Ve(nt,ut){var _t=ke.call(this)||this;return _t.verifyPassword=nt,_t.passwordStatus=ut,_t}return h(Ve,ke),Ve}(co),Wi=function(ke){var Ve=ke.passwordStatus,nt=ke.renderProtectedView,ut=ke.verifyPassword,_t=ke.onDocumentAskPassword,St=a.useContext(N).l10n,Dt=a.useState(""),Mt=Dt[0],pt=Dt[1],Lt=a.useContext(_).direction===n.TextDirection.RightToLeft,Z=function(){return ut(Mt)};return a.useEffect(function(){_t&&_t({verifyPassword:ut})},[]),nt?nt({passwordStatus:Ve,verifyPassword:ut}):a.createElement("div",{className:"rpv-core__asking-password-wrapper"},a.createElement("div",{className:E({"rpv-core__asking-password":!0,"rpv-core__asking-password--rtl":Lt})},a.createElement("div",{className:"rpv-core__asking-password-message"},Ve===n.PasswordStatus.RequiredPassword&&St.core.askingPassword.requirePasswordToOpen,Ve===n.PasswordStatus.WrongPassword&&St.core.wrongPassword.tryAgain),a.createElement("div",{className:"rpv-core__asking-password-body"},a.createElement("div",{className:E({"rpv-core__asking-password-input":!0,"rpv-core__asking-password-input--ltr":!Lt,"rpv-core__asking-password-input--rtl":Lt})},a.createElement(A,{testId:"core__asking-password-input",type:"password",value:Mt,onChange:pt,onKeyDown:function(q){q.key==="Enter"&&Z()}})),a.createElement(f,{onClick:Z},St.core.askingPassword.submit))))},Ui=function(ke){function Ve(nt){var ut=ke.call(this)||this;return ut.doc=nt,ut}return h(Ve,ke),Ve}(co),Gi=function(ke){function Ve(nt){var ut=ke.call(this)||this;return ut.error=nt,ut}return h(Ve,ke),Ve}(co),sa=function(ke){function Ve(nt){var ut=ke.call(this)||this;return ut.percentages=nt,ut}return h(Ve,ke),Ve}(co),Va=function(ke){var Ve=ke.characterMap,nt=ke.file,ut=ke.httpHeaders,_t=ke.render,St=ke.renderError,Dt=ke.renderLoader,Mt=ke.renderProtectedView,pt=ke.transformGetDocumentParams,Lt=ke.withCredentials,Z=ke.onDocumentAskPassword,q=a.useContext(_).direction===n.TextDirection.RightToLeft,Ee=a.useState(new sa(0)),ye=Ee[0],it=Ee[1],st=a.useRef(""),At=ae();return a.useEffect(function(){st.current="",it(new sa(0));var qt=new l.PDFWorker({name:"PDFWorker_".concat(Date.now())}),gt=Object.assign({httpHeaders:ut,withCredentials:Lt,worker:qt},typeof nt=="string"?{url:nt}:{data:nt},Ve?{cMapUrl:Ve.url,cMapPacked:Ve.isCompressed}:{}),Xt=pt?pt(gt):gt,Vt=l.getDocument(Xt);return Vt.onPassword=function(Ot,Ut){switch(Ut){case l.PasswordResponses.NEED_PASSWORD:At.current&&it(new Wo(Ot,n.PasswordStatus.RequiredPassword));break;case l.PasswordResponses.INCORRECT_PASSWORD:At.current&&it(new Wo(Ot,n.PasswordStatus.WrongPassword))}},Vt.onProgress=function(Ot){var Ut=Ot.total>0?Math.min(100,100*Ot.loaded/Ot.total):100;At.current&&st.current===""&&it(new sa(Ut))},Vt.promise.then(function(Ot){st.current=Ot.loadingTask.docId,At.current&&it(new Ui(Ot))},function(Ot){return At.current&&!qt.destroyed&&it(new Gi({message:Ot.message||"Cannot load document",name:Ot.name}))}),function(){Vt.destroy(),qt.destroy()}},[nt]),ye instanceof Wo?a.createElement(Wi,{passwordStatus:ye.passwordStatus,renderProtectedView:Mt,verifyPassword:ye.verifyPassword,onDocumentAskPassword:Z}):ye instanceof Ui?_t(ye.doc):ye instanceof Gi?St?St(ye.error):a.createElement("div",{className:E({"rpv-core__doc-error":!0,"rpv-core__doc-error--rtl":q})},a.createElement("div",{className:"rpv-core__doc-error-text"},ye.error.message)):a.createElement("div",{"data-testid":"core__doc-loading",className:E({"rpv-core__doc-loading":!0,"rpv-core__doc-loading--rtl":q})},Dt?Dt(ye.percentages):a.createElement(w,null))},Xl=function(ke,Ve){var nt=a.useMemo(function(){return ke==="auto"?typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":ke},[]),ut=a.useState(nt),_t=ut[0],St=ut[1],Dt=de(_t);return a.useEffect(function(){if(ke==="auto"){var Mt=window.matchMedia("(prefers-color-scheme: dark)"),pt=function(Lt){St(Lt.matches?"dark":"light")};return Mt.addEventListener("change",pt),function(){return Mt.removeEventListener("change",pt)}}},[]),a.useEffect(function(){_t!==Dt&&Ve&&Ve(_t)},[_t]),a.useEffect(function(){ke!==_t&&St(ke)},[ke]),{currentTheme:_t,setCurrentTheme:St}},Mr=function(ke){return{startPage:ke.startPage-3,endPage:ke.endPage+3}};n.Button=function(ke){var Ve=ke.children,nt=ke.testId,ut=ke.onClick,_t=a.useContext(_).direction===n.TextDirection.RightToLeft,St=nt?{"data-testid":nt}:{};return a.createElement("button",v({className:E({"rpv-core__button":!0,"rpv-core__button--rtl":_t}),type:"button",onClick:ut},St),Ve)},n.Icon=x,n.LazyRender=function(ke){var Ve=ke.attrs,nt=ke.children,ut=ke.testId,_t=a.useState(!1),St=_t[0],Dt=_t[1],Mt=ut?v(v({},Ve),{"data-testid":ut}):Ve,pt=p({once:!0,onVisibilityChanged:function(Lt){Lt.isVisible&&Dt(!0)}});return a.createElement("div",v({ref:pt},Mt),St&&nt)},n.LocalizationContext=N,n.Menu=function(ke){var Ve=ke.children,nt=a.useRef(),ut=a.useRef([]),_t=a.useContext(_).direction===n.TextDirection.RightToLeft,St=function(Mt){if(nt.current)switch(Mt.key){case"Tab":Mt.preventDefault();break;case"ArrowDown":Mt.preventDefault(),Dt(function(pt,Lt){return Lt+1});break;case"ArrowUp":Mt.preventDefault(),Dt(function(pt,Lt){return Lt-1});break;case"End":Mt.preventDefault(),Dt(function(pt,Lt){return pt.length-1});break;case"Home":Mt.preventDefault(),Dt(function(pt,Lt){return 0})}},Dt=function(Mt){if(nt.current){var pt=ut.current,Lt=pt.findIndex(function(q){return q.getAttribute("tabindex")==="0"}),Z=Math.min(pt.length-1,Math.max(0,Mt(pt,Lt)));Lt>=0&&Lt<=pt.length-1&&pt[Lt].setAttribute("tabindex","-1"),pt[Z].setAttribute("tabindex","0"),pt[Z].focus()}};return b(function(){var Mt=nt.current;if(Mt){var pt=function(Lt){var Z=[];return Lt.querySelectorAll('.rpv-core__menu-item[role="menuitem"]').forEach(function(q){if(q instanceof HTMLElement){var Ee=q.parentElement;(Ee===Lt||window.getComputedStyle(Ee).display!=="none")&&Z.push(q)}}),Z}(Mt);ut.current=pt}},[]),b(function(){return document.addEventListener("keydown",St),function(){document.removeEventListener("keydown",St)}},[]),a.createElement("div",{ref:nt,"aria-orientation":"vertical",className:E({"rpv-core__menu":!0,"rpv-core__menu--rtl":_t}),role:"menu",tabIndex:0},Ve)},n.MenuDivider=function(){return a.createElement("div",{"aria-orientation":"horizontal",className:"rpv-core__menu-divider",role:"separator"})},n.MenuItem=function(ke){var Ve=ke.checked,nt=Ve!==void 0&&Ve,ut=ke.children,_t=ke.icon,St=_t===void 0?null:_t,Dt=ke.isDisabled,Mt=Dt!==void 0&&Dt,pt=ke.testId,Lt=ke.onClick,Z=a.useContext(_).direction===n.TextDirection.RightToLeft,q=pt?{"data-testid":pt}:{};return a.createElement("button",v({className:E({"rpv-core__menu-item":!0,"rpv-core__menu-item--disabled":Mt,"rpv-core__menu-item--ltr":!Z,"rpv-core__menu-item--rtl":Z}),role:"menuitem",tabIndex:-1,type:"button",onClick:Lt},q),a.createElement("div",{className:E({"rpv-core__menu-item-icon":!0,"rpv-core__menu-item-icon--ltr":!Z,"rpv-core__menu-item-icon--rtl":Z})},St),a.createElement("div",{className:E({"rpv-core__menu-item-label":!0,"rpv-core__menu-item-label--ltr":!Z,"rpv-core__menu-item-label--rtl":Z})},ut),a.createElement("div",{className:E({"rpv-core__menu-item-check":!0,"rpv-core__menu-item-check--ltr":!Z,"rpv-core__menu-item-check--rtl":Z})},nt&&a.createElement(y,null)))},n.MinimalButton=function(ke){var Ve=ke.ariaLabel,nt=Ve===void 0?"":Ve,ut=ke.ariaKeyShortcuts,_t=ut===void 0?"":ut,St=ke.children,Dt=ke.isDisabled,Mt=Dt!==void 0&&Dt,pt=ke.isSelected,Lt=pt!==void 0&&pt,Z=ke.testId,q=ke.onClick,Ee=a.useContext(_).direction===n.TextDirection.RightToLeft,ye=Z?{"data-testid":Z}:{};return a.createElement("button",v({"aria-label":nt},_t&&{"aria-keyshortcuts":_t},Mt&&{"aria-disabled":!0},{className:E({"rpv-core__minimal-button":!0,"rpv-core__minimal-button--disabled":Mt,"rpv-core__minimal-button--rtl":Ee,"rpv-core__minimal-button--selected":Lt}),type:"button",onClick:q},ye),St)},n.Modal=function(ke){var Ve=ke.ariaControlsSuffix,nt=ke.closeOnClickOutside,ut=ke.closeOnEscape,_t=ke.content,St=ke.isOpened,Dt=St!==void 0&&St,Mt=ke.target,pt=Ve||"".concat(H());return a.createElement(X,{target:Mt?function(Lt,Z){return a.createElement("div",{"aria-expanded":Z?"true":"false","aria-haspopup":"dialog","aria-controls":"rpv-core__modal-body-".concat(pt)},Mt(Lt,Z))}:null,content:function(Lt){return a.createElement(Oe,null,a.createElement(Re,{ariaControlsSuffix:pt,closeOnClickOutside:nt,closeOnEscape:ut,onToggle:Lt},_t(Lt)))},isOpened:Dt})},n.Popover=function(ke){var Ve=ke.ariaHasPopup,nt=Ve===void 0?"dialog":Ve,ut=ke.ariaControlsSuffix,_t=ke.closeOnClickOutside,St=ke.closeOnEscape,Dt=ke.content,Mt=ke.lockScroll,pt=Mt===void 0||Mt,Lt=ke.offset,Z=ke.position,q=ke.target,Ee=ot(!1),ye=Ee.opened,it=Ee.toggle,st=a.useRef(),At=a.useMemo(function(){return ut||"".concat(H())},[]);return a.createElement("div",{ref:st,"aria-expanded":ye?"true":"false","aria-haspopup":nt,"aria-controls":"rpv-core__popver-body-".concat(At)},q(it,ye),ye&&a.createElement(a.Fragment,null,pt&&a.createElement(et,{closeOnEscape:St,onClose:it}),a.createElement(Je,{ariaControlsSuffix:At,closeOnClickOutside:_t,offset:Lt,position:Z,targetRef:st,onClose:it},Dt(it))))},n.PrimaryButton=f,n.ProgressBar=function(ke){var Ve=ke.progress,nt=a.useContext(_).direction===n.TextDirection.RightToLeft;return a.createElement("div",{className:E({"rpv-core__progress-bar":!0,"rpv-core__progress-bar--rtl":nt})},a.createElement("div",{className:"rpv-core__progress-bar-progress",style:{width:"".concat(Ve,"%")}},Ve,"%"))},n.Separator=function(){return a.createElement("div",{className:"rpv-core__separator"})},n.Spinner=w,n.Splitter=function(ke){var Ve=ke.constrain,nt=a.useContext(_).direction===n.TextDirection.RightToLeft,ut=a.useRef(),_t=a.useRef(),St=a.useRef(),Dt=a.useRef(0),Mt=a.useRef(0),pt=a.useRef(0),Lt=a.useRef(0),Z={capture:!0},q=function(ye){var it=ut.current,st=_t.current,At=St.current;if(it&&st&&At){var qt=Lt.current,gt=ye.clientX-Dt.current,Xt=pt.current+(nt?-gt:gt),Vt=it.parentElement.getBoundingClientRect().width,Ot=100*Xt/Vt;if(it.classList.add("rpv-core__splitter--resizing"),Ve){var Ut=Vt-Xt-qt;if(!Ve({firstHalfPercentage:Ot,firstHalfSize:Xt,secondHalfPercentage:100*Ut/Vt,secondHalfSize:Ut}))return}st.style.width="".concat(Ot,"%"),document.body.classList.add("rpv-core__splitter-body--resizing"),st.classList.add("rpv-core__splitter-sibling--resizing"),At.classList.add("rpv-core__splitter-sibling--resizing")}},Ee=function(ye){var it=ut.current,st=_t.current,At=St.current;it&&st&&At&&(document.body.classList.remove("rpv-core__splitter-body--resizing"),it.classList.remove("rpv-core__splitter--resizing"),st.classList.remove("rpv-core__splitter-sibling--resizing"),At.classList.remove("rpv-core__splitter-sibling--resizing"),document.removeEventListener("mousemove",q,Z),document.removeEventListener("mouseup",Ee,Z))};return a.useEffect(function(){var ye=ut.current;ye&&(Lt.current=ye.getBoundingClientRect().width,_t.current=ye.previousElementSibling,St.current=ye.nextElementSibling)},[]),a.createElement("div",{ref:ut,className:"rpv-core__splitter",onMouseDown:function(ye){var it=_t.current;it&&(Dt.current=ye.clientX,Mt.current=ye.clientY,pt.current=it.getBoundingClientRect().width,document.addEventListener("mousemove",q,Z),document.addEventListener("mouseup",Ee,Z))}})},n.TextBox=A,n.ThemeContext=_,n.Tooltip=function(ke){var Ve=ke.ariaControlsSuffix,nt=ke.content,ut=ke.offset,_t=ke.position,St=ke.target,Dt=ot(!1),Mt=Dt.opened,pt=Dt.toggle,Lt=a.useRef(),Z=a.useRef(),q=a.useMemo(function(){return Ve||"".concat(H())},[]);fe(function(){Lt.current&&document.activeElement&&Lt.current.contains(document.activeElement)&&ye()});var Ee=function(){pt(n.ToggleStatus.Open)},ye=function(){pt(n.ToggleStatus.Close)};return a.createElement(a.Fragment,null,a.createElement("div",{ref:Lt,"aria-describedby":"rpv-core__tooltip-body-".concat(q),onBlur:function(it){it.relatedTarget instanceof HTMLElement&&it.currentTarget.parentElement&&it.currentTarget.parentElement.contains(it.relatedTarget)?Z.current&&(Z.current.style.display="none"):ye()},onFocus:Ee,onMouseEnter:Ee,onMouseLeave:ye},St),Mt&&a.createElement(ft,{ariaControlsSuffix:q,contentRef:Z,offset:ut,position:_t,targetRef:Lt},nt()))},n.Viewer=function(ke){var Ve=ke.characterMap,nt=ke.defaultScale,ut=ke.enableSmoothScroll,_t=ut===void 0||ut,St=ke.fileUrl,Dt=ke.httpHeaders,Mt=Dt===void 0?{}:Dt,pt=ke.initialPage,Lt=pt===void 0?0:pt,Z=ke.pageLayout,q=ke.initialRotation,Ee=q===void 0?0:q,ye=ke.localization,it=ke.plugins,st=it===void 0?[]:it,At=ke.renderError,qt=ke.renderLoader,gt=ke.renderPage,Xt=ke.renderProtectedView,Vt=ke.scrollMode,Ot=Vt===void 0?n.ScrollMode.Vertical:Vt,Ut=ke.setRenderRange,an=Ut===void 0?Mr:Ut,pn=ke.transformGetDocumentParams,Ln=ke.theme,or=Ln===void 0?{direction:n.TextDirection.LeftToRight,theme:"light"}:Ln,gr=ke.viewMode,nr=gr===void 0?n.ViewMode.SinglePage:gr,wr=ke.withCredentials,jn=wr!==void 0&&wr,yi=ke.onDocumentAskPassword,Qn=ke.onDocumentLoad,In=Qn===void 0?function(){}:Qn,Wr=ke.onPageChange,yn=Wr===void 0?function(){}:Wr,qr=ke.onRotate,un=qr===void 0?function(){}:qr,er=ke.onRotatePage,mr=er===void 0?function(){}:er,Lr=ke.onSwitchTheme,bo=Lr===void 0?function(){}:Lr,sr=ke.onZoom,Gn=sr===void 0?function(){}:sr,Mn=a.useState({data:St,name:typeof St=="string"?St:"",shouldLoad:!1}),Kn=Mn[0],Bn=Mn[1],xr=function(ai,bi){Bn({data:bi,name:ai,shouldLoad:!0})},Pr=a.useState(!1),Zn=Pr[0],Pn=Pr[1],Cr=de(Kn);a.useEffect(function(){var ai,bi,Li,fi;ai=Cr.data,fi=typeof(bi=St),(Li=typeof ai)=="string"&&fi==="string"&&ai===bi||Li==="object"&&fi==="object"&&ai.length===bi.length&&ai.every(function(is,aa){return is===bi[aa]})||Bn({data:St,name:typeof St=="string"?St:"",shouldLoad:Zn})},[St,Zn]);var Hr=p({onVisibilityChanged:function(ai){Pn(ai.isVisible),ai.isVisible&&Bn(function(bi){return Object.assign({},bi,{shouldLoad:!0})})}}),jr=typeof or=="string"?{direction:n.TextDirection.LeftToRight,theme:or}:or,xi=a.useState(ye||B),yr=xi[0],Ro=xi[1],zn={l10n:yr,setL10n:Ro},Fr=Object.assign({},{direction:jr.direction},Xl(jr.theme||"light",bo));return a.useEffect(function(){ye&&Ro(ye)},[ye]),a.createElement(N.Provider,{value:zn},a.createElement(_.Provider,{value:Fr},a.createElement("div",{ref:Hr,className:"rpv-core__viewer rpv-core__viewer--".concat(Fr.currentTheme),"data-testid":"core__viewer",style:{height:"100%",width:"100%"}},Kn.shouldLoad&&a.createElement(Va,{characterMap:Ve,file:Kn.data,httpHeaders:Mt,render:function(ai){return a.createElement(Ua,{defaultScale:nt,doc:ai,render:function(bi,Li){return a.createElement(Kl,{currentFile:{data:Kn.data,name:Kn.name},defaultScale:nt,doc:ai,enableSmoothScroll:_t,initialPage:Lt,initialRotation:Ee,initialScale:Li,pageLayout:Z,pageSizes:bi,plugins:st,renderPage:gt,scrollMode:Ot,setRenderRange:an,viewMode:nr,viewerState:{file:Kn,fullScreenMode:n.FullScreenMode.Normal,pageIndex:-1,pageHeight:bi[0].pageHeight,pageWidth:bi[0].pageWidth,pagesRotation:new Map,rotation:Ee,scale:Li,scrollMode:Ot,viewMode:nr},onDocumentLoad:In,onOpenFile:xr,onPageChange:yn,onRotate:un,onRotatePage:mr,onZoom:Gn})},scrollMode:Ot,viewMode:nr})},renderError:At,renderLoader:qt,renderProtectedView:Xt,transformGetDocumentParams:pn,withCredentials:jn,onDocumentAskPassword:yi}))))},n.Worker=function(ke){var Ve=ke.children,nt=ke.workerUrl;return l.GlobalWorkerOptions.workerSrc=nt,a.createElement(a.Fragment,null,Ve)},n.chunk=It,n.classNames=E,n.createStore=function(ke){var Ve=ke||{},nt={},ut=function(St,Dt){var Mt;Ve=v(v({},Ve),((Mt={})[St]=Dt,Mt)),(nt[St]||[]).forEach(function(pt){return pt(Ve[St])})},_t=function(St){return Ve[St]};return{subscribe:function(St,Dt){nt[St]=(nt[St]||[]).concat(Dt)},unsubscribe:function(St,Dt){nt[St]=(nt[St]||[]).filter(function(Mt){return Mt!==Dt})},update:function(St,Dt){ut(St,Dt)},updateCurrentValue:function(St,Dt){var Mt=_t(St);Mt!==void 0&&ut(St,Dt(Mt))},get:function(St){return _t(St)}}},n.getDestination=Dn,n.getPage=kn,n.isFullScreenEnabled=G,n.isMac=function(){return typeof window<"u"&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)},n.useDebounceCallback=oe,n.useIntersectionObserver=p,n.useIsMounted=ae,n.useIsomorphicLayoutEffect=b,n.usePrevious=de,n.useRenderQueue=U})(MR);/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */OR.exports=MR;var eM=OR.exports;const QW=()=>{const[n,e]=Wt.useState(!1),{messages:t,setMessages:i,selectedConversation:c}=Oh();return{sendMessage:async l=>{e(!0);try{const h=await(await fetch(`/api/messages/send/${c._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:l})})).json();if(h.error)throw new Error(h.error);i([...t,h])}catch(r){Hl.error(r.message)}finally{e(!1)}},loading:n}};function eG(n){return fu({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.125 48 48 141.125 48 256s93.125 208 208 208 208-93.125 208-208S370.875 48 256 48zm107 229h-86v86h-42v-86h-86v-42h86v-86h42v86h86v42z"},child:[]}]})(n)}const tG=()=>{const[n,e]=Wt.useState(""),[t,i]=Wt.useState([]),[c,a]=Wt.useState(0),[l,r]=Wt.useState(!1),{selectedConversation:h}=Oh(),{authUser:m}=Th(),[v,g]=Wt.useState({paperSize:"A4",copies:1,sides:1,color:"black"}),{loading:_,sendMessage:E}=QW(),b=A=>{const T=Array.from(A.target.files).map(R=>({file:R,preview:R.type.startsWith("image/")?URL.createObjectURL(R):null,textContent:null}));T.forEach((R,M)=>{if(R.file.type==="text/plain"){const L=new FileReader;L.onload=()=>{T[M].textContent=L.result,i([...T])},L.readAsText(R.file)}}),i(T),r(!0),a(0)},p=A=>{const{name:P,value:T}=A.target;g(R=>({...R,[P]:T}))},x=async A=>{A.preventDefault(),n&&(await E(n),e(""))},y=async()=>{const A=[];try{for(const R of t){const M=R.file,L=D8(L8,`files/${M.name}-${yR()}`),W=await mR(L,M),G=await gR(W.ref);A.push({file_url:G,paper_size:v.paperSize,copies:v.copies,sides:v.sides,color:v.color})}const P=await fetch("/api/files/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(!P.ok)throw new Error(`HTTP error! status: ${P.status}`);const T=await P.json();if(console.log("Files uploaded successfully to the server:",T.map(R=>R.file_url)),T){const R={userId:m._id,pdfId:[],quantity:0,shopId:h._id,sides:v.sides,color:v.color};R.pdfId=T.map(L=>L.file_url.toString()),R.quantity=v.copies,console.log("Order body:",R),await E("ThisIsAFileCode"+JSON.stringify(T));const M=await fetch("/api/users/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});console.log("Order created successfully:",M)}}catch(P){console.error("Error uploading files:",P)}},f=()=>{r(!1),i([])},w=A=>{a(A==="prev"?P=>P===0?t.length-1:P-1:P=>P===t.length-1?0:P+1)};return Qe.jsxs(Qe.Fragment,{children:[Qe.jsx("form",{className:"px-4 my-3",onSubmit:x,children:Qe.jsxs("div",{className:"w-full relative",children:[Qe.jsx("input",{type:"text",className:"border text-sm rounded-lg block w-full p-2.5 pr-20 bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Send a message",value:n,onChange:A=>e(A.target.value)}),Qe.jsxs("div",{className:"absolute inset-y-0 end-0 flex items-center pe-3 gap-3",children:[Qe.jsxs("label",{htmlFor:"file-upload",className:"flex items-center justify-center cursor-pointer text-gray-400 hover:text-blue-500",children:[Qe.jsx(eG,{}),Qe.jsx("input",{id:"file-upload",type:"file",multiple:!0,className:"hidden",onChange:b})]}),Qe.jsx("button",{type:"submit",className:"flex items-center justify-center text-gray-400 hover:text-blue-500",children:_?Qe.jsx("div",{className:"loading loading-spinner"}):Qe.jsx(iq,{className:"text-lg"})})]})]})}),l&&t.length>0&&Qe.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:Qe.jsxs("div",{className:"bg-gray-800 z-50 text-white rounded-lg p-5 w-96",children:[Qe.jsxs("div",{className:"flex justify-between items-center",children:[Qe.jsx("h3",{className:"text-lg font-semibold",children:"File Options"}),Qe.jsx("button",{onClick:f,className:"text-gray-400 hover:text-red-500",children:Qe.jsx(oq,{className:"text-xl"})})]}),Qe.jsxs("div",{className:"mt-4",children:[Qe.jsxs("p",{className:"text-sm mb-2 truncate",children:[Qe.jsx("strong",{children:"File:"})," ",t[c].file.name]}),Qe.jsx("div",{className:"mb-4 h-[30vh] overflow-auto border border-gray-600 rounded-lg bg-gray-700",children:t[c].file.type.startsWith("image/")?Qe.jsx("img",{src:t[c].preview,alt:"Preview",className:"w-full h-auto rounded-t-lg"}):t[c].file.type==="application/pdf"?Qe.jsx(eM.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:Qe.jsx(eM.Viewer,{fileUrl:URL.createObjectURL(t[c].file),className:"w-full h-[28vh]"})}):t[c].textContent?Qe.jsx("textarea",{value:t[c].textContent,readOnly:!0,className:"w-full h-[28vh] bg-gray-700 border-none text-white p-2"}):Qe.jsx("p",{className:"text-sm text-gray-400 p-2",children:"No preview available for this file type."})}),t.length>1&&Qe.jsxs("div",{className:"flex justify-between mb-4",children:[Qe.jsx("button",{onClick:()=>w("prev"),className:"bg-gray-700 hover:bg-gray-600 text-white rounded-lg px-3 py-1",children:Qe.jsx(nq,{})}),Qe.jsx("button",{onClick:()=>w("next"),className:"bg-gray-700 hover:bg-gray-600 text-white rounded-lg px-3 py-1",children:Qe.jsx(rq,{})})]}),Qe.jsxs("div",{className:"mb-4",children:[Qe.jsx("label",{className:"block text-sm mb-1",children:"Paper Size"}),Qe.jsxs("select",{name:"paperSize",value:v.paperSize,onChange:p,className:"block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",children:[Qe.jsx("option",{value:"A4",children:"A4"}),Qe.jsx("option",{value:"A3",children:"A3"}),Qe.jsx("option",{value:"Letter",children:"Letter"})]})]}),Qe.jsxs("div",{className:"mb-4",children:[Qe.jsx("label",{className:"block text-sm mb-1",children:"Type"}),Qe.jsxs("select",{name:"color",defaultValue:v.color,onChange:p,className:"block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",children:[Qe.jsx("option",{value:"black",children:"Black and White"}),Qe.jsx("option",{value:"white",children:"Color"})]})]}),Qe.jsxs("div",{className:"mb-4",children:[Qe.jsx("label",{className:"block text-sm mb-1",children:"Sides"}),Qe.jsxs("select",{name:"paperSize",defaultValue:v.sides,onChange:p,className:"block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",children:[Qe.jsx("option",{value:"1",children:"1"}),Qe.jsx("option",{value:"2",children:"2"})]})]}),Qe.jsxs("div",{className:"mb-4",children:[Qe.jsx("label",{className:"block text-sm mb-1",children:"Number of Copies"}),Qe.jsx("input",{type:"number",name:"copies",defaultValue:v.copies,min:"1",onChange:p,className:"block w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"})]}),Qe.jsx("button",{onClick:()=>{alert(`Printing ${v.copies} copies on ${v.paperSize} paper.`),f(),y()},className:"w-full bg-blue-500 hover:bg-blue-600 text-white rounded-lg py-2",children:"Create Print Order"})]})]})})]})},nG=()=>{const[n,e]=Wt.useState(!1),{messages:t,setMessages:i,selectedConversation:c}=Oh();return Wt.useEffect(()=>{const a=async()=>{e(!0);try{const r=await(await fetch(`/api/messages/${c._id}`)).json();if(r.error)throw new Error(r.error);i(r)}catch(l){Hl.error(l.message)}finally{e(!1)}};c!=null&&c._id&&a()},[c==null?void 0:c._id,i]),{messages:t,loading:n}},rG=()=>Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("div",{className:"flex gap-3 items-center",children:[Qe.jsx("div",{className:"skeleton w-10 h-10 rounded-full shrink-0"}),Qe.jsxs("div",{className:"flex flex-col gap-1",children:[Qe.jsx("div",{className:"skeleton h-4 w-40"}),Qe.jsx("div",{className:"skeleton h-4 w-40"})]})]}),Qe.jsxs("div",{className:"flex gap-3 items-center justify-end",children:[Qe.jsx("div",{className:"flex flex-col gap-1",children:Qe.jsx("div",{className:"skeleton h-4 w-40"})}),Qe.jsx("div",{className:"skeleton w-10 h-10 rounded-full shrink-0"})]})]});function iG(n){const e=new Date(n),t=tM(e.getHours()),i=tM(e.getMinutes());return`${t}:${i}`}function tM(n){return n.toString().padStart(2,"0")}const oG=({message:n})=>{const{authUser:e}=Th(),{selectedConversation:t}=Oh(),i=n.senderId===e._id,c=iG(n.createdAt),a=i?"chat-end":"chat-start",l=i?e.profilePic:t==null?void 0:t.profilePic,r=i?"bg-blue-500":"",h=n.shouldShake?"shake":"";return Wt.useEffect(()=>{(async()=>{try{const g=await(await fetch(`/api/messages/update/${n._id}`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();console.log("updateMessage data",g)}catch(v){console.error("Error in updateMessage:",v)}})()},[]),Qe.jsxs("div",{className:`chat ${a}`,children:[Qe.jsx("div",{className:"chat-image avatar",children:Qe.jsx("div",{className:"w-10 rounded-full",children:Qe.jsx("img",{alt:"Profile Pic",src:l})})}),Qe.jsx("div",{className:`chat-bubble text-white ${r} ${h} pb-2`,children:n.message.startsWith("ThisIsAFileCode")?Qe.jsxs("div",{children:[Qe.jsx("p",{children:"  Order Created "}),Qe.jsx("div",{className:"flex flex-col gap-2",children:JSON.parse(n.message.replace("ThisIsAFileCode","")).map((m,v)=>Qe.jsxs("div",{className:"mt-2 bg-white overflow-hidden h-52 relative flex w-44 md:w-72 lg:w-72 rounded-t-xl rounded-b-lg",children:[Qe.jsx("div",{className:"absolute ",children:m.file_url&&(m.file_url.includes(".jpg")||m.file_url.includes(".jpeg")||m.file_url.includes(".png")||m.file_url.includes(".gif")?Qe.jsx("img",{src:m.file_url,alt:"File deleted",className:" cursor-pointer h-52   md:w-72 lg:w-72 w-44 object-cover rounded shadow hover:opacity-80 transition-opacity duration-300"}):m.file_url.includes(".pdf")?Qe.jsx("iframe",{src:m.file_url,className:"w-full border cursor-pointer h-52 rounded shadow hover:opacity-80 transition-opacity duration-300",title:"PDF Preview",href:m.file_url}):null)}),Qe.jsx("a",{href:m.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-white-500 z-10 w-full bg-white border-t border-blue-500 px-5 py-3 mt-auto truncate underline text-blue-500",children:"File"})]},v))})]}):n.message}),Qe.jsx("div",{className:"chat-footer opacity-50 text-xs flex gap-1 items-center",children:c})]})},hu=Object.create(null);hu.open="0";hu.close="1";hu.ping="2";hu.pong="3";hu.message="4";hu.upgrade="5";hu.noop="6";const r2=Object.create(null);Object.keys(hu).forEach(n=>{r2[hu[n]]=n});const w5={type:"error",data:"parser error"},j9=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",N9=typeof ArrayBuffer=="function",$9=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,X8=({type:n,data:e},t,i)=>j9&&e instanceof Blob?t?i(e):nM(e,i):N9&&(e instanceof ArrayBuffer||$9(e))?t?i(e):nM(new Blob([e]),i):i(hu[n]+(e||"")),nM=(n,e)=>{const t=new FileReader;return t.onload=function(){const i=t.result.split(",")[1];e("b"+(i||""))},t.readAsDataURL(n)};function rM(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let XA;function sG(n,e){if(j9&&n.data instanceof Blob)return n.data.arrayBuffer().then(rM).then(e);if(N9&&(n.data instanceof ArrayBuffer||$9(n.data)))return e(rM(n.data));X8(n,!1,t=>{XA||(XA=new TextEncoder),e(XA.encode(t))})}const iM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zb=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<iM.length;n++)Zb[iM.charCodeAt(n)]=n;const aG=n=>{let e=n.length*.75,t=n.length,i,c=0,a,l,r,h;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const m=new ArrayBuffer(e),v=new Uint8Array(m);for(i=0;i<t;i+=4)a=Zb[n.charCodeAt(i)],l=Zb[n.charCodeAt(i+1)],r=Zb[n.charCodeAt(i+2)],h=Zb[n.charCodeAt(i+3)],v[c++]=a<<2|l>>4,v[c++]=(l&15)<<4|r>>2,v[c++]=(r&3)<<6|h&63;return m},lG=typeof ArrayBuffer=="function",Z8=(n,e)=>{if(typeof n!="string")return{type:"message",data:B9(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:cG(n.substring(1),e)}:r2[t]?n.length>1?{type:r2[t],data:n.substring(1)}:{type:r2[t]}:w5},cG=(n,e)=>{if(lG){const t=aG(n);return B9(t,e)}else return{base64:!0,data:n}},B9=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},F9="",uG=(n,e)=>{const t=n.length,i=new Array(t);let c=0;n.forEach((a,l)=>{X8(a,!1,r=>{i[l]=r,++c===t&&e(i.join(F9))})})},hG=(n,e)=>{const t=n.split(F9),i=[];for(let c=0;c<t.length;c++){const a=Z8(t[c],e);if(i.push(a),a.type==="error")break}return i};function fG(){return new TransformStream({transform(n,e){sG(n,t=>{const i=t.length;let c;if(i<126)c=new Uint8Array(1),new DataView(c.buffer).setUint8(0,i);else if(i<65536){c=new Uint8Array(3);const a=new DataView(c.buffer);a.setUint8(0,126),a.setUint16(1,i)}else{c=new Uint8Array(9);const a=new DataView(c.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(i))}n.data&&typeof n.data!="string"&&(c[0]|=128),e.enqueue(c),e.enqueue(t)})}})}let ZA;function ax(n){return n.reduce((e,t)=>e+t.length,0)}function lx(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let i=0;for(let c=0;c<e;c++)t[c]=n[0][i++],i===n[0].length&&(n.shift(),i=0);return n.length&&i<n[0].length&&(n[0]=n[0].slice(i)),t}function dG(n,e){ZA||(ZA=new TextDecoder);const t=[];let i=0,c=-1,a=!1;return new TransformStream({transform(l,r){for(t.push(l);;){if(i===0){if(ax(t)<1)break;const h=lx(t,1);a=(h[0]&128)===128,c=h[0]&127,c<126?i=3:c===126?i=1:i=2}else if(i===1){if(ax(t)<2)break;const h=lx(t,2);c=new DataView(h.buffer,h.byteOffset,h.length).getUint16(0),i=3}else if(i===2){if(ax(t)<8)break;const h=lx(t,8),m=new DataView(h.buffer,h.byteOffset,h.length),v=m.getUint32(0);if(v>Math.pow(2,21)-1){r.enqueue(w5);break}c=v*Math.pow(2,32)+m.getUint32(4),i=3}else{if(ax(t)<c)break;const h=lx(t,c);r.enqueue(Z8(a?h:ZA.decode(h),e)),i=0}if(c===0||c>n){r.enqueue(w5);break}}}})}const z9=4;function Vo(n){if(n)return pG(n)}function pG(n){for(var e in Vo.prototype)n[e]=Vo.prototype[e];return n}Vo.prototype.on=Vo.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};Vo.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};Vo.prototype.off=Vo.prototype.removeListener=Vo.prototype.removeAllListeners=Vo.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var i,c=0;c<t.length;c++)if(i=t[c],i===e||i.fn===e){t.splice(c,1);break}return t.length===0&&delete this._callbacks["$"+n],this};Vo.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,c=t.length;i<c;++i)t[i].apply(this,e)}return this};Vo.prototype.emitReserved=Vo.prototype.emit;Vo.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};Vo.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Ul=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function U9(n,...e){return e.reduce((t,i)=>(n.hasOwnProperty(i)&&(t[i]=n[i]),t),{})}const mG=Ul.setTimeout,gG=Ul.clearTimeout;function c3(n,e){e.useNativeTimers?(n.setTimeoutFn=mG.bind(Ul),n.clearTimeoutFn=gG.bind(Ul)):(n.setTimeoutFn=Ul.setTimeout.bind(Ul),n.clearTimeoutFn=Ul.clearTimeout.bind(Ul))}const yG=1.33;function bG(n){return typeof n=="string"?vG(n):Math.ceil((n.byteLength||n.size)*yG)}function vG(n){let e=0,t=0;for(let i=0,c=n.length;i<c;i++)e=n.charCodeAt(i),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(i++,t+=4);return t}function _G(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function wG(n){let e={},t=n.split("&");for(let i=0,c=t.length;i<c;i++){let a=t[i].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class xG extends Error{constructor(e,t,i){super(e),this.description=t,this.context=i,this.type="TransportError"}}class Y8 extends Vo{constructor(e){super(),this.writable=!1,c3(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,i){return super.emitReserved("error",new xG(e,t,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Z8(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=_G(e);return t.length?"?"+t:""}}const V9="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),x5=64,SG={};let oM=0,cx=0,sM;function aM(n){let e="";do e=V9[n%x5]+e,n=Math.floor(n/x5);while(n>0);return e}function q9(){const n=aM(+new Date);return n!==sM?(oM=0,sM=n):n+"."+aM(oM++)}for(;cx<x5;cx++)SG[V9[cx]]=cx;let H9=!1;try{H9=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const EG=H9;function W9(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||EG))return new XMLHttpRequest}catch{}if(!e)try{return new Ul[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function AG(){}const kG=function(){return new W9({xdomain:!1}).responseType!=null}();class PG extends Y8{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const i=location.protocol==="https:";let c=location.port;c||(c=i?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||c!==e.port}const t=e&&e.forceBase64;this.supportsBinary=kG&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||t()})),this.writable||(i++,this.once("drain",function(){--i||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};hG(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,uG(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=q9()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Ng(this.uri(),e)}doWrite(e,t){const i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",(c,a)=>{this.onError("xhr post error",c,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=e}}let Ng=class i2 extends Vo{constructor(e,t){super(),c3(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=t.data!==void 0?t.data:null,this.create()}create(){var e;const t=U9(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const i=this.xhr=new W9(t);try{i.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let c in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(c)&&i.setRequestHeader(c,this.opts.extraHeaders[c])}}catch{}if(this.method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this.opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(i.timeout=this.opts.requestTimeout),i.onreadystatechange=()=>{var c;i.readyState===3&&((c=this.opts.cookieJar)===null||c===void 0||c.parseCookies(i)),i.readyState===4&&(i.status===200||i.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof i.status=="number"?i.status:0)},0))},i.send(this.data)}catch(c){this.setTimeoutFn(()=>{this.onError(c)},0);return}typeof document<"u"&&(this.index=i2.requestsCount++,i2.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=AG,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete i2.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};Ng.requestsCount=0;Ng.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",lM);else if(typeof addEventListener=="function"){const n="onpagehide"in Ul?"pagehide":"unload";addEventListener(n,lM,!1)}}function lM(){for(let n in Ng.requests)Ng.requests.hasOwnProperty(n)&&Ng.requests[n].abort()}const J8=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),ux=Ul.WebSocket||Ul.MozWebSocket,cM=!0,TG="arraybuffer",uM=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class OG extends Y8{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,i=uM?{}:U9(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=cM&&!uM?t?new ux(e,t):new ux(e):new ux(e,t,i)}catch(c){return this.emitReserved("error",c)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],c=t===e.length-1;X8(i,this.supportsBinary,a=>{const l={};try{cM&&this.ws.send(a)}catch{}c&&J8(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=q9()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!ux}}class MG extends Y8{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{const t=dG(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(t).getReader(),c=fG();c.readable.pipeTo(e.writable),this.writer=c.writable.getWriter();const a=()=>{i.read().then(({done:r,value:h})=>{r||(this.onPacket(h),a())}).catch(r=>{})};a();const l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this.writer.write(l).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],c=t===e.length-1;this.writer.write(i).then(()=>{c&&J8(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}}const CG={websocket:OG,webtransport:MG,polling:PG},IG=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,RG=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function S5(n){if(n.length>2e3)throw"URI too long";const e=n,t=n.indexOf("["),i=n.indexOf("]");t!=-1&&i!=-1&&(n=n.substring(0,t)+n.substring(t,i).replace(/:/g,";")+n.substring(i,n.length));let c=IG.exec(n||""),a={},l=14;for(;l--;)a[RG[l]]=c[l]||"";return t!=-1&&i!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=DG(a,a.path),a.queryKey=LG(a,a.query),a}function DG(n,e){const t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function LG(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,c,a){c&&(t[c]=a)}),t}let G9=class dg extends Vo{constructor(e,t={}){super(),this.binaryType=TG,this.writeBuffer=[],e&&typeof e=="object"&&(t=e,e=null),e?(e=S5(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=S5(t.host).host),c3(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=wG(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=z9,t.transport=e,this.id&&(t.sid=this.id);const i=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new CG[e](i)}open(){let e;if(this.opts.rememberUpgrade&&dg.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){let t=this.createTransport(e),i=!1;dg.priorWebsocketSuccess=!1;const c=()=>{i||(t.send([{type:"ping",data:"probe"}]),t.once("packet",g=>{if(!i)if(g.type==="pong"&&g.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;dg.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(v(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const _=new Error("probe error");_.transport=t.name,this.emitReserved("upgradeError",_)}}))};function a(){i||(i=!0,v(),t.close(),t=null)}const l=g=>{const _=new Error("probe error: "+g);_.transport=t.name,a(),this.emitReserved("upgradeError",_)};function r(){l("transport closed")}function h(){l("socket closed")}function m(g){t&&g.name!==t.name&&a()}const v=()=>{t.removeListener("open",c),t.removeListener("error",l),t.removeListener("close",r),this.off("close",h),this.off("upgrading",m)};t.once("open",c),t.once("error",l),t.once("close",r),this.once("close",h),this.once("upgrading",m),this.upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{i||t.open()},200):t.open()}onOpen(){if(this.readyState="open",dg.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){const c=this.writeBuffer[i].data;if(c&&(t+=bG(c)),i>0&&t>this.maxPayload)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer}write(e,t,i){return this.sendPacket("message",e,t,i),this}send(e,t,i){return this.sendPacket("message",e,t,i),this}sendPacket(e,t,i,c){if(typeof t=="function"&&(c=t,t=void 0),typeof i=="function"&&(c=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const a={type:e,data:t,options:i};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),c&&this.once("flush",c),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){dg.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let i=0;const c=e.length;for(;i<c;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}};G9.protocol=z9;function jG(n,e="",t){let i=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),i=S5(n)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const a=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+a+":"+i.port+e,i.href=i.protocol+"://"+a+(t&&t.port===i.port?"":":"+i.port),i}const NG=typeof ArrayBuffer=="function",$G=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,K9=Object.prototype.toString,BG=typeof Blob=="function"||typeof Blob<"u"&&K9.call(Blob)==="[object BlobConstructor]",FG=typeof File=="function"||typeof File<"u"&&K9.call(File)==="[object FileConstructor]";function Q8(n){return NG&&(n instanceof ArrayBuffer||$G(n))||BG&&n instanceof Blob||FG&&n instanceof File}function o2(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,i=n.length;t<i;t++)if(o2(n[t]))return!0;return!1}if(Q8(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return o2(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&o2(n[t]))return!0;return!1}function zG(n){const e=[],t=n.data,i=n;return i.data=E5(t,e),i.attachments=e.length,{packet:i,buffers:e}}function E5(n,e){if(!n)return n;if(Q8(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let i=0;i<n.length;i++)t[i]=E5(n[i],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=E5(n[i],e));return t}return n}function UG(n,e){return n.data=A5(n.data,e),delete n.attachments,n}function A5(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=A5(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=A5(n[t],e));return n}const VG=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],qG=5;var vi;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(vi||(vi={}));class HG{constructor(e){this.replacer=e}encode(e){return(e.type===vi.EVENT||e.type===vi.ACK)&&o2(e)?this.encodeAsBinary({type:e.type===vi.EVENT?vi.BINARY_EVENT:vi.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===vi.BINARY_EVENT||e.type===vi.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=zG(e),i=this.encodeAsString(t.packet),c=t.buffers;return c.unshift(i),c}}function hM(n){return Object.prototype.toString.call(n)==="[object Object]"}class ek extends Vo{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const i=t.type===vi.BINARY_EVENT;i||t.type===vi.BINARY_ACK?(t.type=i?vi.EVENT:vi.ACK,this.reconstructor=new WG(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Q8(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const i={type:Number(e.charAt(0))};if(vi[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===vi.BINARY_EVENT||i.type===vi.BINARY_ACK){const a=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const l=e.substring(a,t);if(l!=Number(l)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(l)}if(e.charAt(t+1)==="/"){const a=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(a,t)}else i.nsp="/";const c=e.charAt(t+1);if(c!==""&&Number(c)==c){const a=t+1;for(;++t;){const l=e.charAt(t);if(l==null||Number(l)!=l){--t;break}if(t===e.length)break}i.id=Number(e.substring(a,t+1))}if(e.charAt(++t)){const a=this.tryParse(e.substr(t));if(ek.isPayloadValid(i.type,a))i.data=a;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case vi.CONNECT:return hM(t);case vi.DISCONNECT:return t===void 0;case vi.CONNECT_ERROR:return typeof t=="string"||hM(t);case vi.EVENT:case vi.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&VG.indexOf(t[0])===-1);case vi.ACK:case vi.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class WG{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=UG(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const GG=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ek,Encoder:HG,get PacketType(){return vi},protocol:qG},Symbol.toStringTag,{value:"Module"}));function _c(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const KG=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class X9 extends Vo{constructor(e,t,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[_c(e,"open",this.onopen.bind(this)),_c(e,"packet",this.onpacket.bind(this)),_c(e,"error",this.onerror.bind(this)),_c(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(KG.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const i={type:vi.EVENT,data:t};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const l=this.ids++,r=t.pop();this._registerAckCallback(l,r),i.id=l}const c=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!c||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){var i;const c=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(c===void 0){this.acks[e]=t;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},c);this.acks[e]=(...l)=>{this.io.clearTimeoutFn(a),t.apply(this,[null,...l])}}emitWithAck(e,...t){const i=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((c,a)=>{t.push((l,r)=>i?l?a(l):c(r):c(l)),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((c,...a)=>i!==this._queue[0]?void 0:(c!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(c)):(this._queue.shift(),t&&t(null,...a)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:vi.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case vi.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case vi.EVENT:case vi.BINARY_EVENT:this.onevent(e);break;case vi.ACK:case vi.BINARY_ACK:this.onack(e);break;case vi.DISCONNECT:this.ondisconnect();break;case vi.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const i of t)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let i=!1;return function(...c){i||(i=!0,t.packet({type:vi.ACK,id:e,data:c}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:vi.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const i of t)i.apply(this,e.data)}}}function M0(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}M0.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};M0.prototype.reset=function(){this.attempts=0};M0.prototype.setMin=function(n){this.ms=n};M0.prototype.setMax=function(n){this.max=n};M0.prototype.setJitter=function(n){this.jitter=n};class k5 extends Vo{constructor(e,t){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,c3(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new M0({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const c=t.parser||GG;this.encoder=new c.Encoder,this.decoder=new c.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new G9(this.uri,this.opts);const t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const c=_c(t,"open",function(){i.onopen(),e&&e()}),a=r=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",r),e?e(r):this.maybeReconnectOnOpen()},l=_c(t,"error",a);if(this._timeout!==!1){const r=this._timeout,h=this.setTimeoutFn(()=>{c(),a(new Error("timeout")),t.close()},r);this.opts.autoUnref&&h.unref(),this.subs.push(()=>{this.clearTimeoutFn(h)})}return this.subs.push(c),this.subs.push(l),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(_c(e,"ping",this.onping.bind(this)),_c(e,"data",this.ondata.bind(this)),_c(e,"error",this.onerror.bind(this)),_c(e,"close",this.onclose.bind(this)),_c(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){J8(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new X9(this,e,t),this.nsps[e]=i),i}_destroy(e){const t=Object.keys(this.nsps);for(const i of t)if(this.nsps[i].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(c=>{c?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",c)):e.onreconnect()}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Tb={};function s2(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=jG(n,e.path||"/socket.io"),i=t.source,c=t.id,a=t.path,l=Tb[c]&&a in Tb[c].nsps,r=e.forceNew||e["force new connection"]||e.multiplex===!1||l;let h;return r?h=new k5(i,e):(Tb[c]||(Tb[c]=new k5(i,e)),h=Tb[c]),t.query&&!e.query&&(e.query=t.queryKey),h.socket(t.path,e)}Object.assign(s2,{Manager:k5,Socket:X9,io:s2,connect:s2});const Z9=Wt.createContext(),Y9=()=>Wt.useContext(Z9),XG=({children:n})=>{const[e,t]=Wt.useState(null),[i,c]=Wt.useState([]),{authUser:a}=Th();return Wt.useEffect(()=>{if(a){const l=s2("http://localhost:5000",{query:{userId:a._id}});return t(l),l.on("getOnlineUsers",r=>{c(r)}),()=>l.close()}else e&&(e.close(),t(null))},[a]),Qe.jsx(Z9.Provider,{value:{socket:e,onlineUsers:i},children:n})},ZG="/assets/notification-KoQ3t5UR.mp3",YG=n=>{const{socket:e}=Y9(),{messages:t,setMessages:i}=Oh();Wt.useEffect(()=>(e==null||e.on("newMessage",c=>{c.shouldShake=!0,new Audio(ZG).play(),console.log("newMessage",c),console.log("selectedConversation",n),(n==null?void 0:n._id)===(c==null?void 0:c.senderId)&&i([...t,c])}),()=>e==null?void 0:e.off("newMessage")),[e,i,t])},JG=({selectedConversation:n})=>{const{messages:e,loading:t}=nG();YG(n);const i=Wt.useRef();return Wt.useEffect(()=>{var c;(c=i.current)==null||c.scrollIntoView({behavior:"smooth"})},[e]),Qe.jsxs("div",{className:"flex-1 px-4 overflow-x-hidden h-full",style:{maxHeight:"calc(100vh - 150px)"},children:[!t&&e.length>0&&e.map((c,a)=>Qe.jsx("div",{ref:a===e.length-1?i:null,children:Qe.jsx(oG,{message:c})},c._id)),t&&[...Array(3)].map((c,a)=>Qe.jsx(rG,{},a)),!t&&e.length===0&&Qe.jsx("p",{className:"text-center text-gray-500",children:"Send a message to start the conversation"})]})};function QG(n){return fu({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M21 7h-3c0-1.65-1.35-3-3-3h-12c-1.65 0-3 1.35-3 3v7c0 1.65 1.35 3 3 3v3l3-3c0 1.65 1.35 3 3 3h8l3 3v-3h1c1.65 0 3-1.35 3-3v-7c0-1.65-1.35-3-3-3zm-18 8c-.542 0-1-.458-1-1v-7c0-.542.458-1 1-1h12c.542 0 1 .458 1 1v1h-6.5c-1.379 0-2.5 1.121-2.5 2.5v4.5h-4zm19 2c0 .542-.458 1-1 1h-12c-.542 0-1-.458-1-1v-6.5c0-.827.673-1.5 1.5-1.5h11.5c.542 0 1 .458 1 1v7z"},child:[]}]})(n)}function eK(n){return fu({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(n)}function tK(n){return fu({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"},child:[]}]})(n)}const nK=()=>{const{selectedConversation:n,setSelectedConversation:e}=Oh();Wt.useEffect(()=>()=>e(null),[e]);const t=X_();return Qe.jsx("div",{className:"flex-grow flex flex-col md:min-w-[450px] bg-gray-100",children:n?Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("div",{className:"bg-blue-600 flex justify-between items-center text-white px-4 py-2 mb-2 rounded-b-lg",children:[Qe.jsxs("div",{children:[Qe.jsx("span",{className:"label-text",children:"To:"})," ",Qe.jsx("span",{className:"font-bold",children:n.fullName})]}),Qe.jsxs("div",{className:"flex items-center gap-4 ",children:[Qe.jsx(tK,{className:"hover:text-green-500",onClick:()=>t("/")}),Qe.jsx(eK,{className:"hover:text-red-500",onClick:()=>t("/map")})]})]}),Qe.jsx(JG,{selectedConversation:n}),Qe.jsx(tG,{})]}):Qe.jsx(rK,{})})},rK=()=>{const{authUser:n}=Th();return Qe.jsx("div",{className:"flex items-center justify-center w-full h-full",children:Qe.jsxs("div",{className:"px-4 text-center sm:text-lg md:text-xl text-gray-700 font-semibold flex flex-col items-center gap-4",children:[Qe.jsxs("p",{children:["Welcome 👋 ",n.fullName," ❄"]}),Qe.jsx("p",{children:"Select a chat to start messaging"}),Qe.jsx(QG,{className:"text-5xl text-blue-600"})]})})},iK=()=>{const[n,e]=Wt.useState(!1),[t,i]=Wt.useState([]);return Wt.useEffect(()=>{(async()=>{e(!0);try{const l=await(await fetch("/api/users")).json();if(l.error)throw new Error(l.error);i(l)}catch(a){Hl.error(a.message)}finally{e(!1)}})()},[]),{loading:n,conversations:t}},fM=["👾","⭐","🌟","🎉","🎊","🎈","🎁","🎂","🎄","🎃","🎗","🎟","🎫","🎖","🏆","🏅","🥇","🥈","🥉","⚽","🏀","🏈","⚾","🎾","🏐","🏉","🎱","🏓","🏸","🥅","🏒","🏑","🏏","⛳","🏹","🎣","🥊","🥋","🎽","⛸","🥌","🛷","🎿","⛷","🏂","🏋️","🤼","🤸","🤺","⛹️","🤾","🏌️","🏇","🧘"],oK=()=>fM[Math.floor(Math.random()*fM.length)],sK=({conversation:n,lastIdx:e,emoji:t})=>{const{selectedConversation:i,setSelectedConversation:c}=Oh(),{onlineUsers:a}=Y9(),l=(i==null?void 0:i._id)===n._id,r=a.includes(n._id);return Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("div",{className:`flex gap-4 items-center p-3 rounded-lg cursor-pointer transition-all duration-300 
				${l?"bg-sky-500 text-white":"hover:bg-sky-100"}
			`,onClick:()=>c(n),children:[Qe.jsx("div",{className:`avatar ${r?"online":""}`,children:Qe.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-gray-300 overflow-hidden",children:Qe.jsx("img",{src:n.profilePic,alt:`${n.fullName}'s avatar`,className:"object-cover w-full h-full"})})}),Qe.jsx("div",{className:"flex flex-col flex-1",children:Qe.jsxs("div",{className:"flex justify-between items-center",children:[Qe.jsx("p",{className:`font-bold ${l?"text-white":"text-gray-800"} truncate`,children:n.fullName}),Qe.jsx("span",{className:`text-xl ${l?"text-white":"text-gray-600"}`,children:t})]})})]}),!e&&Qe.jsx("div",{className:"divider border-t border-gray-300 mx-2"})]})},aK=()=>{const{loading:n,conversations:e}=iK();return Qe.jsxs("div",{className:"py-2 flex flex-col overflow-auto",children:[e.map((t,i)=>Qe.jsx(sK,{conversation:t,emoji:oK(),lastIdx:i===e.length-1},t._id)),n?Qe.jsx("span",{className:"loading loading-spinner mx-auto"}):null]})},lK=()=>{const{loading:n,logout:e}=_R();return Qe.jsx("div",{className:"mt-auto",children:n?Qe.jsx("span",{className:"loading loading-spinner"}):Qe.jsx(SR,{className:"w-6 h-6 text-black cursor-pointer",onClick:e})})};function cK(n){return fu({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 428 339.92 303.9a160.48 160.48 0 0 0 30.72-94.58C370.64 120.37 298.27 48 209.32 48S48 120.37 48 209.32s72.37 161.32 161.32 161.32a160.48 160.48 0 0 0 94.58-30.72L428 464zM209.32 319.69a110.38 110.38 0 1 1 110.37-110.37 110.5 110.5 0 0 1-110.37 110.37z"},child:[]}]})(n)}const uK=()=>{const[n,e]=Wt.useState(""),{setSelectedConversation:t}=Oh(),[i,c]=Wt.useState([]),a=l=>{if(l.preventDefault(),c([]),!n)return;if(n.length<3)return Hl.error("Search term must be at least 3 characters long");(async()=>{try{const m=await(await fetch(`/api/users/${n}`)).json();if(m.error)throw new Error(m.error);c([m]),t(m),e("")}catch(h){Hl.error(h.message)}})()};return Qe.jsxs("form",{onSubmit:a,className:"flex items-center gap-2",children:[Qe.jsxs("div",{children:[Qe.jsx("input",{type:"text",placeholder:"Search…",className:"input input-bordered rounded-full",value:n,onChange:l=>e(l.target.value)}),i.length>0&&Qe.jsx("div",{className:"border-2 border-gray-300 cursor-pointer hover:bg-blue-500 hover:text-white rounded-md p-2 text-black",children:i.map(l=>Qe.jsx("div",{onClick:()=>{t(l),c([]),console.log(l)},children:l.username},l._id))})]}),Qe.jsx("button",{type:"submit",className:"btn btn-circle bg-sky-500 text-white",children:Qe.jsx(cK,{className:"w-6 h-6 outline-none"})})]})},dM=()=>Qe.jsxs("div",{className:"w-full md:w-fit border-r h-[100vh] border-gray-300 bg-white p-4 flex flex-col",children:[Qe.jsx(uK,{}),Qe.jsx("div",{className:"divider border-t border-gray-300 my-4"}),Qe.jsx(aK,{}),Qe.jsx("div",{className:"mt-auto",children:Qe.jsx(lK,{})})]}),hK=()=>{const[n,e]=Wt.useState(!1),[t,i]=Wt.useState(!1),{selectedConversation:c,setSelectedConversation:a}=Oh();return Wt.useEffect(()=>{const l=()=>{window.innerWidth<768?i(!0):i(!1)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),Wt.useEffect(()=>{const r=new URLSearchParams(window.location.search).get("id");r&&(async()=>{try{const v=await(await fetch(`/api/users/user/${r}`)).json();if(v.error)throw new Error(v.error);a([v]),a(v),setSearch("")}catch(m){toast.error(m.message)}})().then(()=>{console.log("Conversation fetched")})},[]),Qe.jsxs("div",{className:"relative flex flex-col md:flex-row h-screen",children:[t&&Qe.jsxs("div",{className:"flex items-center justify-between bg-blue-600 text-white p-2 shadow-md md:hidden",children:[Qe.jsx("h1",{className:"text-xl font-semibold",children:"Print On Go"}),Qe.jsx("button",{className:"p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-white",onClick:()=>e(!0),children:Qe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16m-7 6h7"})})})]}),t&&Qe.jsxs("div",{className:`fixed inset-y-0 left-0 w-[95vw] bg-gray-800 text-white z-50 transform transition-transform duration-300 ease-in-out md:static md:translate-x-0 ${n?"translate-x-0":"-translate-x-full"}`,children:[Qe.jsx(dM,{}),Qe.jsx("button",{className:"absolute top-4 right-4 p-2 bg-gray-700 rounded-full text-white md:hidden",onClick:()=>e(!1),children:Qe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),Qe.jsx("div",{className:"flex-1 bg-gray-100 h-[100vh] w-[100vw] rounded-xl",children:Qe.jsxs("div",{className:"flex h-full rounded-lg overflow-hidden bg-gray-400 bg-clip-padding backdrop-filter backdrop-blur-lg bg-opacity-0",children:[!t&&Qe.jsx(dM,{}),Qe.jsx(nK,{})]})}),t&&n&&Qe.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>e(!1)})]})};function fK(){const{authUser:n}=Th();return Qe.jsxs("div",{className:"h-screen flex items-center bg-white justify-center",children:[Qe.jsxs(cB,{children:[Qe.jsx(Iu,{path:"/home",element:Qe.jsx(_B,{})}),Qe.jsx(Iu,{path:"/",element:n?Qe.jsx(Qe.Fragment,{children:Qe.jsx(kO,{})}):Qe.jsx(ig,{to:"/home"})}),Qe.jsx(Iu,{path:"/login",element:n?Qe.jsx(ig,{to:"/"}):Qe.jsx(pF,{})}),Qe.jsx(Iu,{path:"/signup",element:n?Qe.jsx(ig,{to:"/"}):Qe.jsx(bV,{})}),Qe.jsx(Iu,{path:"/map",element:n?Qe.jsx(_V,{}):Qe.jsx(ig,{to:"/"})}),Qe.jsx(Iu,{path:"/orders",element:n?Qe.jsx(wV,{}):Qe.jsx(ig,{to:"/"})}),Qe.jsx(Iu,{path:"/",element:n?Qe.jsx(kO,{}):Qe.jsx(ig,{to:"/"})}),Qe.jsx(Iu,{path:"/chat",element:Qe.jsx(hK,{})})]}),Qe.jsx(uF,{})]})}YA.createRoot(document.getElementById("root")).render(Qe.jsx(lu.StrictMode,{children:Qe.jsx(mB,{children:Qe.jsx(hF,{children:Qe.jsx(XG,{children:Qe.jsx(fK,{})})})})}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
